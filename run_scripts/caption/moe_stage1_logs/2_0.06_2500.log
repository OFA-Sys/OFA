2022-05-07 20:25:41 - utils.py[line:263] - INFO: distributed init (rank 0): env://
2022-05-07 20:25:41 - utils.py[line:269] - INFO: Start init
2022-05-07 20:25:41 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2022-05-07 20:25:41 - utils.py[line:279] - INFO: initialized host heming-ng1 as rank 0
single-machine distributed training is initialized.
2022-05-07 20:25:51 - train.py[line:78] - INFO: nvidia-smi stats: {'gpu_0_mem_used_gb': 0.8349609375, 'gpu_1_mem_used_gb': 0.001953125, 'gpu_2_mem_used_gb': 0.001953125, 'gpu_3_mem_used_gb': 0.8349609375}
2022-05-07 20:25:51 - train.py[line:81] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../ofa_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None, 'is_moe': False}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 8, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 5000, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 8, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 2, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [4], 'lr': [1e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './moe_stage1_checkpoints/2_0.06_2500', 'restore_file': '../../checkpoints/ofa_base.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 5000, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'cider', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '-rank-0', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807, 'stats_path': None, 'max_valid_steps': None}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='ofa_moe_base', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, alternate_ffn_embed_dim=0, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='ofa_moe_base', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=8, batch_size_valid=8, best_checkpoint_metric='cider', bf16=False, block_wise=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=0.0, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_moe_cross_entropy', cross_self_attention=False, curriculum=0, data='../../dataset/caption_data/caption_stage1_train.tsv,../../dataset/caption_data/caption_val.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_moe_freq=1, decoder_normalize_before=True, decoder_output_dim=768, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=1, distributed_port=-1, distributed_rank=0, distributed_world_size=1, drop_worst_after=2500, drop_worst_ratio=0.2, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_moe_freq=1, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_args='{"beam":1,"max_len_b":16,"no_repeat_ngram_size":3}', eval_bleu=False, eval_cider=True, eval_cider_cached_tokens='../../dataset/caption_data/cider_cached_tokens/coco-valid-words.p', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=True, freeze_encoder_embedding=True, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, log_nvidia_smi=False, lr=[1e-05], lr_scheduler='polynomial_decay', max_epoch=2, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=20, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, moe_eval_capacity_token_fraction=0.25, moe_expert_count=4, moe_expert_ffn_dim=0, moe_freq=1, moe_gate_loss_combine_method='average', moe_gate_loss_transform='none', moe_gate_loss_wt=1.0, moe_gating_use_fp32=True, moe_normalize_expert_grad='', moe_normalize_gate_prob_before_dropping=True, moe_second_expert_policy='all', moe_top1_expert=True, no_best_checkpoints=False, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_save_optimizer_state_on_training_finished=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=1, num_bins=1000, num_shards=1, num_workers=0, num_workers_valid=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patch_image_size=480, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, resnet_type='resnet101', restore_file='../../checkpoints/ofa_base.pt', s3_upload_path=None, sample_patch_num=196, save_dir='./moe_stage1_checkpoints/2_0.06_2500', save_interval=1, save_interval_updates=5000, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,4,2', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, symlink_best_and_last_checkpoints=False, sync_bn=False, task='caption', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[4], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_moe_pad_mask=True, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../ofa_module', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=5000, wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'caption', 'data': '../../dataset/caption_data/caption_stage1_train.tsv,../../dataset/caption_data/caption_val.tsv', 'selected_cols': '0,4,2', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 20, 'code_dict_size': 8192, 'patch_image_size': 480, 'num_bins': 1000, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_bleu': False, 'eval_cider': True, 'eval_args': '{"beam":1,"max_len_b":16,"no_repeat_ngram_size":3}', 'eval_print_samples': False, 'eval_cider_cached_tokens': '../../dataset/caption_data/cider_cached_tokens/coco-valid-words.p', 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_moe_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.2, 'drop_worst_after': 2500, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None, 'moe_gate_loss_wt': 1.0, 'moe_gate_loss_combine_method': 'average', 'moe_gate_loss_transform': 'none'}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [1e-05], 'block_wise': False}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [1e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2022-05-07 20:25:52 - ofa_task.py[line:103] - INFO: source dictionary: 59457 types
2022-05-07 20:25:52 - ofa_task.py[line:104] - INFO: target dictionary: 59457 types
2022-05-07 20:25:53 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2022-05-07 20:25:53 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:3 to store for rank: 0
2022-05-07 20:25:53 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:4 to store for rank: 0
2022-05-07 20:25:59 - train.py[line:119] - INFO: OFAModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(59457, 768, padding_idx=1)
    (layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
      (layer2): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (3): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
      (layer3): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (3): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (4): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (5): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (6): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (7): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (8): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (9): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (10): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (11): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (12): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (13): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (14): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (15): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (16): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (17): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (18): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (19): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (20): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (21): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (22): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(59457, 768, padding_idx=1)
    (layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (output_projection): Linear(in_features=768, out_features=59457, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2022-05-07 20:25:59 - train.py[line:120] - INFO: task: CaptionTask
2022-05-07 20:25:59 - train.py[line:121] - INFO: model: OFAModel
2022-05-07 20:25:59 - train.py[line:122] - INFO: criterion: AdjustLabelSmoothedMOECrossEntropyCriterion
2022-05-07 20:25:59 - train.py[line:123] - INFO: num. shared model params: 125,606,216 (num. trained: 79,943,240)
2022-05-07 20:25:59 - train.py[line:130] - INFO: num. expert model params: 226676736 (num. trained: 226676736)
local datafile ../../dataset/caption_data/caption_val.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_val.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_val.tsv slice_id 0 row count 5000 total row count 5000
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/transforms.py:257: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  warnings.warn(
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.output_projection.weight
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.downsample.0.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.downsample.0.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.downsample.0.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv1.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv2.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv3.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.0.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.1.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.2.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.3.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.4.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.5.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.0.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.1.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.2.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.3.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.4.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.5.moe_layer.gate.wg.bias
2022-05-07 20:25:59 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.output_projection.bias
2022-05-07 20:25:59 - utils.py[line:779] - INFO: ***********************CUDA enviroments for all 1 workers***********************
2022-05-07 20:25:59 - utils.py[line:781] - INFO: rank   0: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2022-05-07 20:25:59 - utils.py[line:787] - INFO: ***********************CUDA enviroments for all 1 workers***********************
2022-05-07 20:25:59 - train.py[line:161] - INFO: training on 1 devices (GPUs/TPUs)
2022-05-07 20:25:59 - train.py[line:166] - INFO: max tokens per device = None and max sentences per device = 8
2022-05-07 20:25:59 - train.py[line:172] - INFO: nvidia-smi stats: {'gpu_0_mem_used_gb': 1.5810546875, 'gpu_1_mem_used_gb': 0.8349609375, 'gpu_2_mem_used_gb': 0.8349609375, 'gpu_3_mem_used_gb': 3.1474609375}
2022-05-07 20:25:59 - trainer.py[line:547] - INFO: Preparing to load checkpoint ../../checkpoints/ofa_base-rank-0.pt
2022-05-07 20:26:02 - trainer.py[line:569] - INFO: Loaded state for ../../checkpoints/ofa_base-rank-0.pt
2022-05-07 20:26:04 - adam.py[line:70] - INFO: using FusedAdam
2022-05-07 20:26:04 - trainer.py[line:721] - INFO: Loaded checkpoint ../../checkpoints/ofa_base-rank-0.pt (epoch 48 @ 0 updates)
2022-05-07 20:26:04 - trainer.py[line:743] - INFO: loading train data for epoch 1
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 row count 566747 total row count 566747
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/transforms.py:257: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  warnings.warn(
slice_id 0 seek offset 0
Total steps 35422, warmup steps 2125, warmup_factor 0.00047058823529411766
2022-05-07 20:26:28 - trainer.py[line:807] - INFO: begin training epoch 1
2022-05-07 20:26:28 - train.py[line:315] - INFO: Start iterating over samples
2022-05-07 20:26:38 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-07 20:26:43 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-07 20:26:47 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-05-07 20:27:08 - progress_bar.py[line:272] - INFO: epoch 001:     13 / 17711 loss=13.488, loss_v1=0, loss_v2=0, nll_loss=12.093, ntokens=383.4, nsentences=32, sample_size=383.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.992023, inner_loss_v1=0, inner_loss_v2=0, inner_loss=13.488, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=69.036, expert1_balance_bottom=2.211, unused_expert1_count=0.306, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4368.13, wps=180.1, ups=0.47, wpb=383.4, bsz=32, num_updates=10, lr=4.70588e-08, gnorm=24.686, loss_scale=16, train_wall=38, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=69
2022-05-07 20:27:27 - progress_bar.py[line:272] - INFO: epoch 001:     23 / 17711 loss=13.237, loss_v1=0, loss_v2=0, nll_loss=11.779, ntokens=382.9, nsentences=32, sample_size=382.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.01394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=13.237, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=70.046, expert1_balance_bottom=2.18, unused_expert1_count=0.344, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3515.36, wps=201.8, ups=0.53, wpb=382.9, bsz=32, num_updates=20, lr=9.41176e-08, gnorm=24.426, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=88
2022-05-07 20:27:46 - progress_bar.py[line:272] - INFO: epoch 001:     33 / 17711 loss=13.222, loss_v1=0, loss_v2=0, nll_loss=11.773, ntokens=376.9, nsentences=32, sample_size=376.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.00513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=13.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=69.082, expert1_balance_bottom=2.156, unused_expert1_count=0.312, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3500.69, wps=197.5, ups=0.52, wpb=376.9, bsz=32, num_updates=30, lr=1.41176e-07, gnorm=24.863, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=107
2022-05-07 20:28:05 - progress_bar.py[line:272] - INFO: epoch 001:     43 / 17711 loss=13.309, loss_v1=0, loss_v2=0, nll_loss=11.868, ntokens=378.7, nsentences=32, sample_size=378.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.00259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=13.309, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=69.932, expert1_balance_bottom=2.042, unused_expert1_count=0.333, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3737.98, wps=199.2, ups=0.53, wpb=378.7, bsz=32, num_updates=40, lr=1.88235e-07, gnorm=25.036, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=126
2022-05-07 20:28:24 - progress_bar.py[line:272] - INFO: epoch 001:     53 / 17711 loss=13.203, loss_v1=0, loss_v2=0, nll_loss=11.744, ntokens=385.4, nsentences=32, sample_size=385.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.01527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=13.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=69.765, expert1_balance_bottom=2.292, unused_expert1_count=0.321, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3430.99, wps=205.5, ups=0.53, wpb=385.4, bsz=32, num_updates=50, lr=2.35294e-07, gnorm=24.785, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=145
2022-05-07 20:28:43 - progress_bar.py[line:272] - INFO: epoch 001:     63 / 17711 loss=13.167, loss_v1=0, loss_v2=0, nll_loss=11.723, ntokens=382.6, nsentences=32, sample_size=382.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.00242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=13.167, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=69.014, expert1_balance_bottom=2.205, unused_expert1_count=0.348, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3379.98, wps=202.2, ups=0.53, wpb=382.6, bsz=32, num_updates=60, lr=2.82353e-07, gnorm=24.09, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=163
2022-05-07 20:29:01 - progress_bar.py[line:272] - INFO: epoch 001:     73 / 17711 loss=13.164, loss_v1=0, loss_v2=0, nll_loss=11.721, ntokens=373.5, nsentences=32, sample_size=373.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.996361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=13.164, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=69.126, expert1_balance_bottom=2.247, unused_expert1_count=0.308, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3375.34, wps=201.4, ups=0.54, wpb=373.5, bsz=32, num_updates=70, lr=3.29412e-07, gnorm=24.572, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=182
2022-05-07 20:29:22 - progress_bar.py[line:272] - INFO: epoch 001:     83 / 17711 loss=12.976, loss_v1=0, loss_v2=0, nll_loss=11.506, ntokens=382.8, nsentences=32, sample_size=382.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=12.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=70.087, expert1_balance_bottom=2.078, unused_expert1_count=0.346, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2907.87, wps=188.7, ups=0.49, wpb=382.8, bsz=32, num_updates=80, lr=3.76471e-07, gnorm=22.877, loss_scale=16, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=202
2022-05-07 20:29:41 - progress_bar.py[line:272] - INFO: epoch 001:     93 / 17711 loss=12.764, loss_v1=0, loss_v2=0, nll_loss=11.263, ntokens=388.7, nsentences=32, sample_size=388.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.01384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=12.764, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=69.259, expert1_balance_bottom=2.287, unused_expert1_count=0.323, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2457.42, wps=203.3, ups=0.52, wpb=388.7, bsz=32, num_updates=90, lr=4.23529e-07, gnorm=22.765, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=221
2022-05-07 20:30:00 - progress_bar.py[line:272] - INFO: epoch 001:    103 / 17711 loss=12.602, loss_v1=0, loss_v2=0, nll_loss=11.115, ntokens=390.3, nsentences=32, sample_size=390.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.992153, inner_loss_v1=0, inner_loss_v2=0, inner_loss=12.602, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=69.463, expert1_balance_bottom=2.302, unused_expert1_count=0.321, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2218.09, wps=202.8, ups=0.52, wpb=390.3, bsz=32, num_updates=100, lr=4.70588e-07, gnorm=24.246, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=241
2022-05-07 20:30:19 - progress_bar.py[line:272] - INFO: epoch 001:    113 / 17711 loss=12.337, loss_v1=0, loss_v2=0, nll_loss=10.811, ntokens=390.3, nsentences=32, sample_size=390.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.00794, inner_loss_v1=0, inner_loss_v2=0, inner_loss=12.337, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=69.46, expert1_balance_bottom=2.326, unused_expert1_count=0.34, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1796.58, wps=207.3, ups=0.53, wpb=390.3, bsz=32, num_updates=110, lr=5.17647e-07, gnorm=21.309, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=259
2022-05-07 20:30:37 - progress_bar.py[line:272] - INFO: epoch 001:    123 / 17711 loss=12.183, loss_v1=0, loss_v2=0, nll_loss=10.641, ntokens=379.3, nsentences=32, sample_size=379.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.00462, inner_loss_v1=0, inner_loss_v2=0, inner_loss=12.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=68.528, expert1_balance_bottom=2.299, unused_expert1_count=0.317, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1597.37, wps=202, ups=0.53, wpb=379.3, bsz=32, num_updates=120, lr=5.64706e-07, gnorm=21.681, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=278
2022-05-07 20:30:56 - progress_bar.py[line:272] - INFO: epoch 001:    133 / 17711 loss=11.76, loss_v1=0, loss_v2=0, nll_loss=10.193, ntokens=378.6, nsentences=32, sample_size=378.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.99934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=11.76, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=68.115, expert1_balance_bottom=2.33, unused_expert1_count=0.319, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1170.27, wps=204.8, ups=0.54, wpb=378.6, bsz=32, num_updates=130, lr=6.11765e-07, gnorm=22.55, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=297
2022-05-07 20:31:15 - progress_bar.py[line:272] - INFO: epoch 001:    143 / 17711 loss=11.492, loss_v1=0, loss_v2=0, nll_loss=9.885, ntokens=383.4, nsentences=32, sample_size=383.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.00362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=11.492, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=68.123, expert1_balance_bottom=2.499, unused_expert1_count=0.271, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=945.8, wps=200.4, ups=0.52, wpb=383.4, bsz=32, num_updates=140, lr=6.58824e-07, gnorm=20.156, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=316
2022-05-07 20:31:34 - progress_bar.py[line:272] - INFO: epoch 001:    153 / 17711 loss=11.291, loss_v1=0, loss_v2=0, nll_loss=9.668, ntokens=380.3, nsentences=32, sample_size=380.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.998245, inner_loss_v1=0, inner_loss_v2=0, inner_loss=11.291, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=67.598, expert1_balance_bottom=2.67, unused_expert1_count=0.283, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=813.38, wps=205.1, ups=0.54, wpb=380.3, bsz=32, num_updates=150, lr=7.05882e-07, gnorm=19.51, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=334
2022-05-07 20:31:53 - progress_bar.py[line:272] - INFO: epoch 001:    163 / 17711 loss=11.008, loss_v1=0, loss_v2=0, nll_loss=9.354, ntokens=379.6, nsentences=32, sample_size=379.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.998455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=11.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=67.083, expert1_balance_bottom=2.742, unused_expert1_count=0.277, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=654.42, wps=194.4, ups=0.51, wpb=379.6, bsz=32, num_updates=160, lr=7.52941e-07, gnorm=20.066, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=354
2022-05-07 20:32:12 - progress_bar.py[line:272] - INFO: epoch 001:    173 / 17711 loss=10.795, loss_v1=0, loss_v2=0, nll_loss=9.118, ntokens=381, nsentences=32, sample_size=381, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=1.00408, inner_loss_v1=0, inner_loss_v2=0, inner_loss=10.795, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=66.528, expert1_balance_bottom=2.7, unused_expert1_count=0.277, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=555.71, wps=202.8, ups=0.53, wpb=381, bsz=32, num_updates=170, lr=8e-07, gnorm=19.387, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=373
2022-05-07 20:32:30 - progress_bar.py[line:272] - INFO: epoch 001:    183 / 17711 loss=10.57, loss_v1=0, loss_v2=0, nll_loss=8.892, ntokens=380.7, nsentences=32, sample_size=380.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.986976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=10.57, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=65.772, expert1_balance_bottom=2.888, unused_expert1_count=0.246, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=475.13, wps=214.6, ups=0.56, wpb=380.7, bsz=32, num_updates=180, lr=8.47059e-07, gnorm=19.45, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=390
2022-05-07 20:32:48 - progress_bar.py[line:272] - INFO: epoch 001:    193 / 17711 loss=10.235, loss_v1=0, loss_v2=0, nll_loss=8.506, ntokens=386.3, nsentences=32, sample_size=386.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.982117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=10.235, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=66.285, expert1_balance_bottom=2.935, unused_expert1_count=0.269, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=363.43, wps=209, ups=0.54, wpb=386.3, bsz=32, num_updates=190, lr=8.94118e-07, gnorm=17.751, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=409
2022-05-07 20:33:05 - progress_bar.py[line:272] - INFO: epoch 001:    203 / 17711 loss=9.95, loss_v1=0, loss_v2=0, nll_loss=8.19, ntokens=383.3, nsentences=32, sample_size=383.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.983889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=9.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=65.092, expert1_balance_bottom=3.137, unused_expert1_count=0.248, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=291.94, wps=224.4, ups=0.59, wpb=383.3, bsz=32, num_updates=200, lr=9.41176e-07, gnorm=18, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=426
2022-05-07 20:33:23 - progress_bar.py[line:272] - INFO: epoch 001:    213 / 17711 loss=9.548, loss_v1=0, loss_v2=0, nll_loss=7.753, ntokens=380.8, nsentences=32, sample_size=380.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.977265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=9.548, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=63.838, expert1_balance_bottom=3.385, unused_expert1_count=0.229, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=215.76, wps=216.1, ups=0.57, wpb=380.8, bsz=32, num_updates=210, lr=9.88235e-07, gnorm=17.072, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=444
2022-05-07 20:33:40 - progress_bar.py[line:272] - INFO: epoch 001:    223 / 17711 loss=9.286, loss_v1=0, loss_v2=0, nll_loss=7.43, ntokens=376.2, nsentences=32, sample_size=376.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.985406, inner_loss_v1=0, inner_loss_v2=0, inner_loss=9.286, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=64.224, expert1_balance_bottom=3.336, unused_expert1_count=0.208, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=172.42, wps=213.9, ups=0.57, wpb=376.2, bsz=32, num_updates=220, lr=1.03529e-06, gnorm=15.64, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=461
2022-05-07 20:33:58 - progress_bar.py[line:272] - INFO: epoch 001:    233 / 17711 loss=8.971, loss_v1=0, loss_v2=0, nll_loss=7.081, ntokens=373.2, nsentences=32, sample_size=373.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.979209, inner_loss_v1=0, inner_loss_v2=0, inner_loss=8.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=63.466, expert1_balance_bottom=3.541, unused_expert1_count=0.183, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=135.36, wps=212, ups=0.57, wpb=373.2, bsz=32, num_updates=230, lr=1.08235e-06, gnorm=15.626, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=479
2022-05-07 20:34:16 - progress_bar.py[line:272] - INFO: epoch 001:    243 / 17711 loss=8.862, loss_v1=0, loss_v2=0, nll_loss=6.995, ntokens=387.7, nsentences=32, sample_size=387.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.95123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=8.862, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=63.54, expert1_balance_bottom=3.794, unused_expert1_count=0.169, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=127.59, wps=211.5, ups=0.55, wpb=387.7, bsz=32, num_updates=240, lr=1.12941e-06, gnorm=14.89, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=497
2022-05-07 20:34:34 - progress_bar.py[line:272] - INFO: epoch 001:    253 / 17711 loss=8.494, loss_v1=0, loss_v2=0, nll_loss=6.557, ntokens=383.9, nsentences=32, sample_size=383.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.969476, inner_loss_v1=0, inner_loss_v2=0, inner_loss=8.494, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=62.709, expert1_balance_bottom=4.025, unused_expert1_count=0.179, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=94.15, wps=219.5, ups=0.57, wpb=383.9, bsz=32, num_updates=250, lr=1.17647e-06, gnorm=12.992, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=515
2022-05-07 20:34:51 - progress_bar.py[line:272] - INFO: epoch 001:    263 / 17711 loss=8.207, loss_v1=0, loss_v2=0, nll_loss=6.231, ntokens=386.2, nsentences=32, sample_size=386.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.954336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=8.207, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=63.621, expert1_balance_bottom=3.877, unused_expert1_count=0.146, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=75.09, wps=220.9, ups=0.57, wpb=386.2, bsz=32, num_updates=260, lr=1.22353e-06, gnorm=13.393, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=532
2022-05-07 20:35:09 - progress_bar.py[line:272] - INFO: epoch 001:    273 / 17711 loss=8.043, loss_v1=0, loss_v2=0, nll_loss=6.041, ntokens=382.4, nsentences=32, sample_size=382.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.968379, inner_loss_v1=0, inner_loss_v2=0, inner_loss=8.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=61.771, expert1_balance_bottom=4.049, unused_expert1_count=0.15, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=65.85, wps=215.9, ups=0.56, wpb=382.4, bsz=32, num_updates=270, lr=1.27059e-06, gnorm=11.051, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=550
2022-05-07 20:35:27 - progress_bar.py[line:272] - INFO: epoch 001:    283 / 17711 loss=7.692, loss_v1=0, loss_v2=0, nll_loss=5.657, ntokens=385.1, nsentences=32, sample_size=385.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.971426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.692, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=61.836, expert1_balance_bottom=4.151, unused_expert1_count=0.148, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=50.46, wps=215.8, ups=0.56, wpb=385.1, bsz=32, num_updates=280, lr=1.31765e-06, gnorm=8.949, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=568
2022-05-07 20:35:44 - progress_bar.py[line:272] - INFO: epoch 001:    293 / 17711 loss=7.639, loss_v1=0, loss_v2=0, nll_loss=5.623, ntokens=376.4, nsentences=32, sample_size=376.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.972532, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.639, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=61.715, expert1_balance_bottom=4.284, unused_expert1_count=0.14, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=49.28, wps=216.7, ups=0.58, wpb=376.4, bsz=32, num_updates=290, lr=1.36471e-06, gnorm=7.847, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=585
2022-05-07 20:36:02 - progress_bar.py[line:272] - INFO: epoch 001:    303 / 17711 loss=7.596, loss_v1=0, loss_v2=0, nll_loss=5.6, ntokens=379.9, nsentences=32, sample_size=379.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.965339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.596, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=62.415, expert1_balance_bottom=4.2, unused_expert1_count=0.15, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=48.5, wps=218, ups=0.57, wpb=379.9, bsz=32, num_updates=300, lr=1.41176e-06, gnorm=7.177, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=603
2022-05-07 20:36:19 - progress_bar.py[line:272] - INFO: epoch 001:    313 / 17711 loss=7.589, loss_v1=0, loss_v2=0, nll_loss=5.593, ntokens=379.6, nsentences=32, sample_size=379.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.97233, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.589, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=62.752, expert1_balance_bottom=4.305, unused_expert1_count=0.15, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=48.27, wps=216.2, ups=0.57, wpb=379.6, bsz=32, num_updates=310, lr=1.45882e-06, gnorm=7.205, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=620
2022-05-07 20:36:37 - progress_bar.py[line:272] - INFO: epoch 001:    323 / 17711 loss=7.507, loss_v1=0, loss_v2=0, nll_loss=5.542, ntokens=385.2, nsentences=32, sample_size=385.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.949497, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.507, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=62.083, expert1_balance_bottom=4.735, unused_expert1_count=0.129, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=46.6, wps=217.5, ups=0.56, wpb=385.2, bsz=32, num_updates=320, lr=1.50588e-06, gnorm=6.358, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=638
2022-05-07 20:36:55 - progress_bar.py[line:272] - INFO: epoch 001:    333 / 17711 loss=7.346, loss_v1=0, loss_v2=0, nll_loss=5.362, ntokens=388, nsentences=32, sample_size=388, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.968153, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.346, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=62.267, expert1_balance_bottom=4.844, unused_expert1_count=0.146, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=41.13, wps=217.2, ups=0.56, wpb=388, bsz=32, num_updates=330, lr=1.55294e-06, gnorm=6.733, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=656
2022-05-07 20:37:12 - progress_bar.py[line:272] - INFO: epoch 001:    343 / 17711 loss=7.311, loss_v1=0, loss_v2=0, nll_loss=5.342, ntokens=379.2, nsentences=32, sample_size=379.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.961717, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.311, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=61.823, expert1_balance_bottom=4.665, unused_expert1_count=0.102, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=40.56, wps=215.8, ups=0.57, wpb=379.2, bsz=32, num_updates=340, lr=1.6e-06, gnorm=6.908, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=673
2022-05-07 20:37:30 - progress_bar.py[line:272] - INFO: epoch 001:    353 / 17711 loss=7.331, loss_v1=0, loss_v2=0, nll_loss=5.363, ntokens=379.6, nsentences=32, sample_size=379.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.974123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.331, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=60.739, expert1_balance_bottom=4.813, unused_expert1_count=0.16, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=41.17, wps=216.5, ups=0.57, wpb=379.6, bsz=32, num_updates=350, lr=1.64706e-06, gnorm=6.797, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=691
2022-05-07 20:37:47 - progress_bar.py[line:272] - INFO: epoch 001:    363 / 17711 loss=7.322, loss_v1=0, loss_v2=0, nll_loss=5.367, ntokens=382.2, nsentences=32, sample_size=382.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.960796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.322, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=60.173, expert1_balance_bottom=4.777, unused_expert1_count=0.135, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=41.28, wps=218.5, ups=0.57, wpb=382.2, bsz=32, num_updates=360, lr=1.69412e-06, gnorm=6.819, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=708
2022-05-07 20:38:05 - progress_bar.py[line:272] - INFO: epoch 001:    373 / 17711 loss=7.196, loss_v1=0, loss_v2=0, nll_loss=5.243, ntokens=391.6, nsentences=32, sample_size=391.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.955998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.196, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=59.573, expert1_balance_bottom=5.019, unused_expert1_count=0.123, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=37.86, wps=223.9, ups=0.57, wpb=391.6, bsz=32, num_updates=370, lr=1.74118e-06, gnorm=5.81, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=726
2022-05-07 20:38:23 - progress_bar.py[line:272] - INFO: epoch 001:    383 / 17711 loss=7.139, loss_v1=0, loss_v2=0, nll_loss=5.18, ntokens=386.4, nsentences=32, sample_size=386.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.956279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=59.372, expert1_balance_bottom=5.079, unused_expert1_count=0.131, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=36.25, wps=219.8, ups=0.57, wpb=386.4, bsz=32, num_updates=380, lr=1.78824e-06, gnorm=6.309, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=743
2022-05-07 20:38:40 - progress_bar.py[line:272] - INFO: epoch 001:    393 / 17711 loss=7.184, loss_v1=0, loss_v2=0, nll_loss=5.262, ntokens=391.9, nsentences=32, sample_size=391.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.936887, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=58.849, expert1_balance_bottom=5.306, unused_expert1_count=0.104, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=38.37, wps=223.4, ups=0.57, wpb=391.9, bsz=32, num_updates=390, lr=1.83529e-06, gnorm=5.781, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=761
2022-05-07 20:38:58 - progress_bar.py[line:272] - INFO: epoch 001:    403 / 17711 loss=7.097, loss_v1=0, loss_v2=0, nll_loss=5.179, ntokens=386.8, nsentences=32, sample_size=386.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.932415, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=57.583, expert1_balance_bottom=5.631, unused_expert1_count=0.108, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=36.22, wps=219.1, ups=0.57, wpb=386.8, bsz=32, num_updates=400, lr=1.88235e-06, gnorm=5.485, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=779
2022-05-07 20:39:15 - progress_bar.py[line:272] - INFO: epoch 001:    413 / 17711 loss=7.107, loss_v1=0, loss_v2=0, nll_loss=5.183, ntokens=380.9, nsentences=32, sample_size=380.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.936983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=57.608, expert1_balance_bottom=5.335, unused_expert1_count=0.131, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=36.32, wps=215, ups=0.56, wpb=380.9, bsz=32, num_updates=410, lr=1.92941e-06, gnorm=5.608, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=796
2022-05-07 20:39:33 - progress_bar.py[line:272] - INFO: epoch 001:    423 / 17711 loss=6.931, loss_v1=0, loss_v2=0, nll_loss=4.98, ntokens=377.4, nsentences=32, sample_size=377.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.948583, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.931, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=57.347, expert1_balance_bottom=5.699, unused_expert1_count=0.115, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=31.56, wps=214.4, ups=0.57, wpb=377.4, bsz=32, num_updates=420, lr=1.97647e-06, gnorm=5.576, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=814
2022-05-07 20:39:51 - progress_bar.py[line:272] - INFO: epoch 001:    433 / 17711 loss=7.049, loss_v1=0, loss_v2=0, nll_loss=5.135, ntokens=385, nsentences=32, sample_size=385, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.925998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=7.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=56.892, expert1_balance_bottom=5.674, unused_expert1_count=0.092, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=35.13, wps=218.7, ups=0.57, wpb=385, bsz=32, num_updates=430, lr=2.02353e-06, gnorm=6.272, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=831
2022-05-07 20:40:08 - progress_bar.py[line:272] - INFO: epoch 001:    443 / 17711 loss=6.938, loss_v1=0, loss_v2=0, nll_loss=5.002, ntokens=378.6, nsentences=32, sample_size=378.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.937006, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=55.295, expert1_balance_bottom=6.246, unused_expert1_count=0.096, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=32.05, wps=215.9, ups=0.57, wpb=378.6, bsz=32, num_updates=440, lr=2.07059e-06, gnorm=5.62, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=849
2022-05-07 20:40:26 - progress_bar.py[line:272] - INFO: epoch 001:    453 / 17711 loss=6.875, loss_v1=0, loss_v2=0, nll_loss=4.934, ntokens=375.5, nsentences=32, sample_size=375.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.943441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.875, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=55.912, expert1_balance_bottom=5.981, unused_expert1_count=0.102, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=30.57, wps=213.8, ups=0.57, wpb=375.5, bsz=32, num_updates=450, lr=2.11765e-06, gnorm=6.589, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=867
2022-05-07 20:40:43 - progress_bar.py[line:272] - INFO: epoch 001:    463 / 17711 loss=6.866, loss_v1=0, loss_v2=0, nll_loss=4.936, ntokens=380, nsentences=32, sample_size=380, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.926551, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.866, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=54.205, expert1_balance_bottom=6.354, unused_expert1_count=0.088, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=30.62, wps=216.6, ups=0.57, wpb=380, bsz=32, num_updates=460, lr=2.16471e-06, gnorm=6.327, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=884
2022-05-07 20:41:01 - progress_bar.py[line:272] - INFO: epoch 001:    473 / 17711 loss=6.732, loss_v1=0, loss_v2=0, nll_loss=4.772, ntokens=381.1, nsentences=32, sample_size=381.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.941926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.732, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=53.694, expert1_balance_bottom=6.107, unused_expert1_count=0.09, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=27.32, wps=220.4, ups=0.58, wpb=381.1, bsz=32, num_updates=470, lr=2.21176e-06, gnorm=5.855, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=901
2022-05-07 20:41:18 - progress_bar.py[line:272] - INFO: epoch 001:    483 / 17711 loss=6.732, loss_v1=0, loss_v2=0, nll_loss=4.772, ntokens=376.9, nsentences=32, sample_size=376.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.941941, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.732, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=53.864, expert1_balance_bottom=6.619, unused_expert1_count=0.106, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=27.31, wps=218, ups=0.58, wpb=376.9, bsz=32, num_updates=480, lr=2.25882e-06, gnorm=6.056, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=919
2022-05-07 20:41:36 - progress_bar.py[line:272] - INFO: epoch 001:    493 / 17711 loss=6.554, loss_v1=0, loss_v2=0, nll_loss=4.597, ntokens=388.9, nsentences=32, sample_size=388.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.924868, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.554, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=52.576, expert1_balance_bottom=6.703, unused_expert1_count=0.09, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=24.21, wps=219.2, ups=0.56, wpb=388.9, bsz=32, num_updates=490, lr=2.30588e-06, gnorm=5.904, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=936
2022-05-07 20:41:53 - progress_bar.py[line:272] - INFO: epoch 001:    503 / 17711 loss=6.552, loss_v1=0, loss_v2=0, nll_loss=4.576, ntokens=380.9, nsentences=32, sample_size=380.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.938289, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.552, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=51.712, expert1_balance_bottom=6.58, unused_expert1_count=0.077, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=23.86, wps=220.9, ups=0.58, wpb=380.9, bsz=32, num_updates=500, lr=2.35294e-06, gnorm=5.828, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=954
2022-05-07 20:42:10 - progress_bar.py[line:272] - INFO: epoch 001:    513 / 17711 loss=6.504, loss_v1=0, loss_v2=0, nll_loss=4.523, ntokens=384.8, nsentences=32, sample_size=384.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.926674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.504, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=50.934, expert1_balance_bottom=6.901, unused_expert1_count=0.088, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=22.99, wps=218.8, ups=0.57, wpb=384.8, bsz=32, num_updates=510, lr=2.4e-06, gnorm=6.147, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=971
2022-05-07 20:42:28 - progress_bar.py[line:272] - INFO: epoch 001:    523 / 17711 loss=6.467, loss_v1=0, loss_v2=0, nll_loss=4.498, ntokens=383.2, nsentences=32, sample_size=383.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.927936, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.467, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=50.767, expert1_balance_bottom=7.109, unused_expert1_count=0.077, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=22.59, wps=216.9, ups=0.57, wpb=383.2, bsz=32, num_updates=520, lr=2.44706e-06, gnorm=6.065, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=989
2022-05-07 20:42:46 - progress_bar.py[line:272] - INFO: epoch 001:    533 / 17711 loss=6.444, loss_v1=0, loss_v2=0, nll_loss=4.466, ntokens=381, nsentences=32, sample_size=381, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.921456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.444, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=50.699, expert1_balance_bottom=7.256, unused_expert1_count=0.058, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=22.1, wps=218.8, ups=0.57, wpb=381, bsz=32, num_updates=530, lr=2.49412e-06, gnorm=7.199, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1006
2022-05-07 20:43:03 - progress_bar.py[line:272] - INFO: epoch 001:    543 / 17711 loss=6.29, loss_v1=0, loss_v2=0, nll_loss=4.282, ntokens=376.1, nsentences=32, sample_size=376.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.922636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.29, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=49.587, expert1_balance_bottom=7.307, unused_expert1_count=0.075, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=19.45, wps=216.4, ups=0.58, wpb=376.1, bsz=32, num_updates=540, lr=2.54118e-06, gnorm=6.014, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1024
2022-05-07 20:43:20 - progress_bar.py[line:272] - INFO: epoch 001:    553 / 17711 loss=6.232, loss_v1=0, loss_v2=0, nll_loss=4.225, ntokens=387.6, nsentences=32, sample_size=387.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.926262, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.232, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=49.618, expert1_balance_bottom=7.226, unused_expert1_count=0.065, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=18.71, wps=223.7, ups=0.58, wpb=387.6, bsz=32, num_updates=550, lr=2.58824e-06, gnorm=6.286, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1041
2022-05-07 20:43:38 - progress_bar.py[line:272] - INFO: epoch 001:    563 / 17711 loss=6.232, loss_v1=0, loss_v2=0, nll_loss=4.244, ntokens=394.4, nsentences=32, sample_size=394.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.924507, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.232, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=49.035, expert1_balance_bottom=7.226, unused_expert1_count=0.054, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=18.95, wps=223.1, ups=0.57, wpb=394.4, bsz=32, num_updates=560, lr=2.63529e-06, gnorm=6.564, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1059
2022-05-07 20:43:55 - progress_bar.py[line:272] - INFO: epoch 001:    573 / 17711 loss=6.206, loss_v1=0, loss_v2=0, nll_loss=4.202, ntokens=380.5, nsentences=32, sample_size=380.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.915834, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.206, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=48.873, expert1_balance_bottom=7.621, unused_expert1_count=0.054, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=18.4, wps=220.1, ups=0.58, wpb=380.5, bsz=32, num_updates=570, lr=2.68235e-06, gnorm=6.271, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1076
2022-05-07 20:44:13 - progress_bar.py[line:272] - INFO: epoch 001:    583 / 17711 loss=6.138, loss_v1=0, loss_v2=0, nll_loss=4.115, ntokens=388.4, nsentences=32, sample_size=388.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.922949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=48.126, expert1_balance_bottom=7.687, unused_expert1_count=0.038, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=17.33, wps=220.6, ups=0.57, wpb=388.4, bsz=32, num_updates=580, lr=2.72941e-06, gnorm=6.165, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1094
2022-05-07 20:44:31 - progress_bar.py[line:272] - INFO: epoch 001:    593 / 17711 loss=6.085, loss_v1=0, loss_v2=0, nll_loss=4.086, ntokens=383.6, nsentences=32, sample_size=383.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89991, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=46.567, expert1_balance_bottom=8.025, unused_expert1_count=0.04, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=16.99, wps=216.7, ups=0.56, wpb=383.6, bsz=32, num_updates=590, lr=2.77647e-06, gnorm=6.487, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1111
2022-05-07 20:44:48 - progress_bar.py[line:272] - INFO: epoch 001:    603 / 17711 loss=6.053, loss_v1=0, loss_v2=0, nll_loss=4.026, ntokens=383.6, nsentences=32, sample_size=383.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.920601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=46.715, expert1_balance_bottom=8.195, unused_expert1_count=0.035, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=16.3, wps=215.9, ups=0.56, wpb=383.6, bsz=32, num_updates=600, lr=2.82353e-06, gnorm=6.057, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1129
2022-05-07 20:45:06 - progress_bar.py[line:272] - INFO: epoch 001:    613 / 17711 loss=6.099, loss_v1=0, loss_v2=0, nll_loss=4.094, ntokens=380.7, nsentences=32, sample_size=380.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.915008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=6.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=46.569, expert1_balance_bottom=8.21, unused_expert1_count=0.033, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=17.07, wps=218.5, ups=0.57, wpb=380.7, bsz=32, num_updates=610, lr=2.87059e-06, gnorm=5.8, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1146
2022-05-07 20:45:23 - progress_bar.py[line:272] - INFO: epoch 001:    623 / 17711 loss=5.976, loss_v1=0, loss_v2=0, nll_loss=3.935, ntokens=376.1, nsentences=32, sample_size=376.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.919149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=46.683, expert1_balance_bottom=7.99, unused_expert1_count=0.05, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=15.3, wps=218, ups=0.58, wpb=376.1, bsz=32, num_updates=620, lr=2.91765e-06, gnorm=7.461, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1164
2022-05-07 20:45:40 - progress_bar.py[line:272] - INFO: epoch 001:    633 / 17711 loss=5.899, loss_v1=0, loss_v2=0, nll_loss=3.855, ntokens=385.2, nsentences=32, sample_size=385.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.915474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.899, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=47.132, expert1_balance_bottom=8.181, unused_expert1_count=0.04, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=14.47, wps=220.4, ups=0.57, wpb=385.2, bsz=32, num_updates=630, lr=2.96471e-06, gnorm=5.645, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1181
2022-05-07 20:45:58 - progress_bar.py[line:272] - INFO: epoch 001:    643 / 17711 loss=5.909, loss_v1=0, loss_v2=0, nll_loss=3.878, ntokens=381, nsentences=32, sample_size=381, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905238, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.909, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=46.792, expert1_balance_bottom=8.284, unused_expert1_count=0.021, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=14.71, wps=214.9, ups=0.56, wpb=381, bsz=32, num_updates=640, lr=3.01176e-06, gnorm=5.209, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1199
2022-05-07 20:46:16 - progress_bar.py[line:272] - INFO: epoch 001:    653 / 17711 loss=5.83, loss_v1=0, loss_v2=0, nll_loss=3.783, ntokens=383.9, nsentences=32, sample_size=383.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.916194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.83, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=46.32, expert1_balance_bottom=8.285, unused_expert1_count=0.019, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=13.76, wps=219.2, ups=0.57, wpb=383.9, bsz=32, num_updates=650, lr=3.05882e-06, gnorm=5.447, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1216
2022-05-07 20:46:33 - progress_bar.py[line:272] - INFO: epoch 001:    663 / 17711 loss=5.793, loss_v1=0, loss_v2=0, nll_loss=3.742, ntokens=388.2, nsentences=32, sample_size=388.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.911865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.793, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=45.863, expert1_balance_bottom=8.463, unused_expert1_count=0.029, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=13.38, wps=220.2, ups=0.57, wpb=388.2, bsz=32, num_updates=660, lr=3.10588e-06, gnorm=5.552, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1234
2022-05-07 20:46:51 - progress_bar.py[line:272] - INFO: epoch 001:    673 / 17711 loss=5.647, loss_v1=0, loss_v2=0, nll_loss=3.556, ntokens=387.8, nsentences=32, sample_size=387.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.911454, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.647, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=45.264, expert1_balance_bottom=8.461, unused_expert1_count=0.013, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=11.76, wps=223.4, ups=0.58, wpb=387.8, bsz=32, num_updates=670, lr=3.15294e-06, gnorm=6.567, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1251
2022-05-07 20:47:08 - progress_bar.py[line:272] - INFO: epoch 001:    683 / 17711 loss=5.623, loss_v1=0, loss_v2=0, nll_loss=3.549, ntokens=392.4, nsentences=32, sample_size=392.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896894, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.623, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=45.177, expert1_balance_bottom=9.006, unused_expert1_count=0.015, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=11.7, wps=222.9, ups=0.57, wpb=392.4, bsz=32, num_updates=680, lr=3.2e-06, gnorm=4.962, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1269
2022-05-07 20:47:26 - progress_bar.py[line:272] - INFO: epoch 001:    693 / 17711 loss=5.61, loss_v1=0, loss_v2=0, nll_loss=3.536, ntokens=379.4, nsentences=32, sample_size=379.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.908175, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.61, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=44.74, expert1_balance_bottom=8.72, unused_expert1_count=0.015, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=11.6, wps=214.3, ups=0.56, wpb=379.4, bsz=32, num_updates=690, lr=3.24706e-06, gnorm=5.566, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1287
2022-05-07 20:47:44 - progress_bar.py[line:272] - INFO: epoch 001:    703 / 17711 loss=5.739, loss_v1=0, loss_v2=0, nll_loss=3.703, ntokens=387.8, nsentences=32, sample_size=387.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.739, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=44.573, expert1_balance_bottom=9.057, unused_expert1_count=0.015, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=13.03, wps=218.5, ups=0.56, wpb=387.8, bsz=32, num_updates=700, lr=3.29412e-06, gnorm=5.684, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1305
2022-05-07 20:48:01 - progress_bar.py[line:272] - INFO: epoch 001:    713 / 17711 loss=5.721, loss_v1=0, loss_v2=0, nll_loss=3.667, ntokens=384, nsentences=32, sample_size=384, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.909821, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.721, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=44.476, expert1_balance_bottom=9.267, unused_expert1_count=0.015, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=12.7, wps=219.5, ups=0.57, wpb=384, bsz=32, num_updates=710, lr=3.34118e-06, gnorm=5.245, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1322
2022-05-07 20:48:19 - progress_bar.py[line:272] - INFO: epoch 001:    723 / 17711 loss=5.538, loss_v1=0, loss_v2=0, nll_loss=3.441, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.9142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.538, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=44.078, expert1_balance_bottom=9.315, unused_expert1_count=0.015, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.86, wps=215.1, ups=0.56, wpb=382.5, bsz=32, num_updates=720, lr=3.38824e-06, gnorm=5.155, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1340
2022-05-07 20:48:37 - progress_bar.py[line:272] - INFO: epoch 001:    733 / 17711 loss=5.716, loss_v1=0, loss_v2=0, nll_loss=3.672, ntokens=385.1, nsentences=32, sample_size=385.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904055, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.716, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=43.678, expert1_balance_bottom=9.534, unused_expert1_count=0.01, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=12.75, wps=219.6, ups=0.57, wpb=385.1, bsz=32, num_updates=730, lr=3.43529e-06, gnorm=5.222, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1357
2022-05-07 20:48:54 - progress_bar.py[line:272] - INFO: epoch 001:    743 / 17711 loss=5.484, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=376, nsentences=32, sample_size=376, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.913189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.484, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=43.4, expert1_balance_bottom=9.623, unused_expert1_count=0.004, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.48, wps=210.6, ups=0.56, wpb=376, bsz=32, num_updates=740, lr=3.48235e-06, gnorm=4.945, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=1375
2022-05-07 20:49:12 - progress_bar.py[line:272] - INFO: epoch 001:    753 / 17711 loss=5.508, loss_v1=0, loss_v2=0, nll_loss=3.427, ntokens=382.4, nsentences=32, sample_size=382.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896438, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.508, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=43.752, expert1_balance_bottom=9.522, unused_expert1_count=0.01, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.75, wps=214.2, ups=0.56, wpb=382.4, bsz=32, num_updates=750, lr=3.52941e-06, gnorm=5.603, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=1393
2022-05-07 20:49:30 - progress_bar.py[line:272] - INFO: epoch 001:    763 / 17711 loss=5.512, loss_v1=0, loss_v2=0, nll_loss=3.415, ntokens=376.7, nsentences=32, sample_size=376.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.91878, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.512, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=43.632, expert1_balance_bottom=9.284, unused_expert1_count=0.015, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.67, wps=214, ups=0.57, wpb=376.7, bsz=32, num_updates=760, lr=3.57647e-06, gnorm=6.142, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1411
2022-05-07 20:49:47 - progress_bar.py[line:272] - INFO: epoch 001:    773 / 17711 loss=5.495, loss_v1=0, loss_v2=0, nll_loss=3.424, ntokens=385.3, nsentences=32, sample_size=385.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902241, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.495, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=43.192, expert1_balance_bottom=9.661, unused_expert1_count=0.01, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.74, wps=219.1, ups=0.57, wpb=385.3, bsz=32, num_updates=770, lr=3.62353e-06, gnorm=5.174, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1428
2022-05-07 20:50:05 - progress_bar.py[line:272] - INFO: epoch 001:    783 / 17711 loss=5.405, loss_v1=0, loss_v2=0, nll_loss=3.32, ntokens=394, nsentences=32, sample_size=394, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896047, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.405, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=43.298, expert1_balance_bottom=9.756, unused_expert1_count=0.013, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=9.98, wps=221.6, ups=0.56, wpb=394, bsz=32, num_updates=780, lr=3.67059e-06, gnorm=4.969, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1446
2022-05-07 20:50:23 - progress_bar.py[line:272] - INFO: epoch 001:    793 / 17711 loss=5.46, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=388.1, nsentences=32, sample_size=388.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902449, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.46, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=43.391, expert1_balance_bottom=9.876, unused_expert1_count=0.008, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.36, wps=219.9, ups=0.57, wpb=388.1, bsz=32, num_updates=790, lr=3.71765e-06, gnorm=5.427, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1464
2022-05-07 20:50:40 - progress_bar.py[line:272] - INFO: epoch 001:    803 / 17711 loss=5.515, loss_v1=0, loss_v2=0, nll_loss=3.446, ntokens=380.1, nsentences=32, sample_size=380.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903554, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.515, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=42.157, expert1_balance_bottom=10.257, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.9, wps=215.6, ups=0.57, wpb=380.1, bsz=32, num_updates=800, lr=3.76471e-06, gnorm=5.328, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1481
2022-05-07 20:50:58 - progress_bar.py[line:272] - INFO: epoch 001:    813 / 17711 loss=5.417, loss_v1=0, loss_v2=0, nll_loss=3.326, ntokens=377, nsentences=32, sample_size=377, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.914133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.417, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=42.298, expert1_balance_bottom=10.178, unused_expert1_count=0.013, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.03, wps=211.2, ups=0.56, wpb=377, bsz=32, num_updates=810, lr=3.81176e-06, gnorm=5.398, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1499
2022-05-07 20:51:16 - progress_bar.py[line:272] - INFO: epoch 001:    823 / 17711 loss=5.465, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=382.7, nsentences=32, sample_size=382.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.909639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.465, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=42.376, expert1_balance_bottom=10.292, unused_expert1_count=0.004, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.32, wps=221.6, ups=0.58, wpb=382.7, bsz=32, num_updates=820, lr=3.85882e-06, gnorm=5.094, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1516
2022-05-07 20:51:33 - progress_bar.py[line:272] - INFO: epoch 001:    833 / 17711 loss=5.333, loss_v1=0, loss_v2=0, nll_loss=3.238, ntokens=379.9, nsentences=32, sample_size=379.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898349, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.333, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.697, expert1_balance_bottom=10.574, unused_expert1_count=0.013, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=9.44, wps=217.1, ups=0.57, wpb=379.9, bsz=32, num_updates=830, lr=3.90588e-06, gnorm=5.457, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1534
2022-05-07 20:51:51 - progress_bar.py[line:272] - INFO: epoch 001:    843 / 17711 loss=5.435, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=378.6, nsentences=32, sample_size=378.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903452, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.435, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.188, expert1_balance_bottom=11.065, unused_expert1_count=0.004, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.31, wps=213.8, ups=0.56, wpb=378.6, bsz=32, num_updates=840, lr=3.95294e-06, gnorm=5.01, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1552
2022-05-07 20:52:08 - progress_bar.py[line:272] - INFO: epoch 001:    853 / 17711 loss=5.452, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=390.7, nsentences=32, sample_size=390.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.452, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.442, expert1_balance_bottom=11.039, unused_expert1_count=0.006, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=10.48, wps=221.2, ups=0.57, wpb=390.7, bsz=32, num_updates=850, lr=4e-06, gnorm=5.061, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1569
2022-05-07 20:52:26 - progress_bar.py[line:272] - INFO: epoch 001:    863 / 17711 loss=5.343, loss_v1=0, loss_v2=0, nll_loss=3.263, ntokens=378.4, nsentences=32, sample_size=378.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88847, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.343, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.269, expert1_balance_bottom=11.097, unused_expert1_count=0.006, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=9.6, wps=214.7, ups=0.57, wpb=378.4, bsz=32, num_updates=860, lr=4.04706e-06, gnorm=5.304, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1587
2022-05-07 20:52:44 - progress_bar.py[line:272] - INFO: epoch 001:    873 / 17711 loss=5.244, loss_v1=0, loss_v2=0, nll_loss=3.138, ntokens=377.5, nsentences=32, sample_size=377.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.910067, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.217, expert1_balance_bottom=10.762, unused_expert1_count=0.01, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.81, wps=214.9, ups=0.57, wpb=377.5, bsz=32, num_updates=870, lr=4.09412e-06, gnorm=5.07, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1604
2022-05-07 20:53:01 - progress_bar.py[line:272] - INFO: epoch 001:    883 / 17711 loss=5.309, loss_v1=0, loss_v2=0, nll_loss=3.212, ntokens=386, nsentences=32, sample_size=386, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.906767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.309, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.272, expert1_balance_bottom=11.122, unused_expert1_count=0.015, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=9.27, wps=220.6, ups=0.57, wpb=386, bsz=32, num_updates=880, lr=4.14118e-06, gnorm=4.712, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1622
2022-05-07 20:53:19 - progress_bar.py[line:272] - INFO: epoch 001:    893 / 17711 loss=5.274, loss_v1=0, loss_v2=0, nll_loss=3.193, ntokens=375.9, nsentences=32, sample_size=375.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.274, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.293, expert1_balance_bottom=11.506, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=9.15, wps=212.2, ups=0.56, wpb=375.9, bsz=32, num_updates=890, lr=4.18824e-06, gnorm=4.977, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=1640
2022-05-07 20:53:37 - progress_bar.py[line:272] - INFO: epoch 001:    903 / 17711 loss=5.266, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=378.6, nsentences=32, sample_size=378.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.909811, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.266, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.579, expert1_balance_bottom=11.217, unused_expert1_count=0.006, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.94, wps=212.7, ups=0.56, wpb=378.6, bsz=32, num_updates=900, lr=4.23529e-06, gnorm=5.426, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1657
2022-05-07 20:53:54 - progress_bar.py[line:272] - INFO: epoch 001:    913 / 17711 loss=5.215, loss_v1=0, loss_v2=0, nll_loss=3.111, ntokens=386.7, nsentences=32, sample_size=386.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89615, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.167, expert1_balance_bottom=11.199, unused_expert1_count=0.004, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.64, wps=219.9, ups=0.57, wpb=386.7, bsz=32, num_updates=910, lr=4.28235e-06, gnorm=5.187, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1675
2022-05-07 20:54:12 - progress_bar.py[line:272] - INFO: epoch 001:    923 / 17711 loss=5.314, loss_v1=0, loss_v2=0, nll_loss=3.243, ntokens=387.3, nsentences=32, sample_size=387.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.314, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.427, expert1_balance_bottom=11.124, unused_expert1_count=0.01, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=9.47, wps=219.3, ups=0.57, wpb=387.3, bsz=32, num_updates=920, lr=4.32941e-06, gnorm=4.753, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1693
2022-05-07 20:54:30 - progress_bar.py[line:272] - INFO: epoch 001:    933 / 17711 loss=5.223, loss_v1=0, loss_v2=0, nll_loss=3.133, ntokens=386.9, nsentences=32, sample_size=386.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=42.145, expert1_balance_bottom=11.126, unused_expert1_count=0.004, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.78, wps=216.7, ups=0.56, wpb=386.9, bsz=32, num_updates=930, lr=4.37647e-06, gnorm=5.242, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1711
2022-05-07 20:54:48 - progress_bar.py[line:272] - INFO: epoch 001:    943 / 17711 loss=5.259, loss_v1=0, loss_v2=0, nll_loss=3.147, ntokens=384, nsentences=32, sample_size=384, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905243, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.259, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=40.798, expert1_balance_bottom=11.771, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.86, wps=215.1, ups=0.56, wpb=384, bsz=32, num_updates=940, lr=4.42353e-06, gnorm=4.523, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1728
2022-05-07 20:55:05 - progress_bar.py[line:272] - INFO: epoch 001:    953 / 17711 loss=5.217, loss_v1=0, loss_v2=0, nll_loss=3.118, ntokens=381.5, nsentences=32, sample_size=381.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902558, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.217, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.075, expert1_balance_bottom=11.683, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.68, wps=216.3, ups=0.57, wpb=381.5, bsz=32, num_updates=950, lr=4.47059e-06, gnorm=4.826, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=1746
2022-05-07 20:55:23 - progress_bar.py[line:272] - INFO: epoch 001:    963 / 17711 loss=5.208, loss_v1=0, loss_v2=0, nll_loss=3.104, ntokens=379.2, nsentences=32, sample_size=379.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=40.721, expert1_balance_bottom=12.149, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.6, wps=214.4, ups=0.57, wpb=379.2, bsz=32, num_updates=960, lr=4.51765e-06, gnorm=5.253, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=1764
2022-05-07 20:55:41 - progress_bar.py[line:272] - INFO: epoch 001:    973 / 17711 loss=5.277, loss_v1=0, loss_v2=0, nll_loss=3.187, ntokens=379.4, nsentences=32, sample_size=379.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.277, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=41.196, expert1_balance_bottom=11.907, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=9.11, wps=215.5, ups=0.57, wpb=379.4, bsz=32, num_updates=970, lr=4.56471e-06, gnorm=4.553, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1781
2022-05-07 20:55:58 - progress_bar.py[line:272] - INFO: epoch 001:    983 / 17711 loss=5.235, loss_v1=0, loss_v2=0, nll_loss=3.155, ntokens=392.6, nsentences=32, sample_size=392.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.235, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=40.76, expert1_balance_bottom=12.011, unused_expert1_count=0.004, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.91, wps=225.7, ups=0.57, wpb=392.6, bsz=32, num_updates=980, lr=4.61176e-06, gnorm=4.479, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1799
2022-05-07 20:56:16 - progress_bar.py[line:272] - INFO: epoch 001:    993 / 17711 loss=5.259, loss_v1=0, loss_v2=0, nll_loss=3.186, ntokens=390.6, nsentences=32, sample_size=390.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.259, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=40.315, expert1_balance_bottom=12.141, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=9.1, wps=222.7, ups=0.57, wpb=390.6, bsz=32, num_updates=990, lr=4.65882e-06, gnorm=4.629, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1816
2022-05-07 20:56:33 - progress_bar.py[line:272] - INFO: epoch 001:   1003 / 17711 loss=5.146, loss_v1=0, loss_v2=0, nll_loss=3.044, ntokens=383.4, nsentences=32, sample_size=383.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=40.389, expert1_balance_bottom=12.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.25, wps=217.2, ups=0.57, wpb=383.4, bsz=32, num_updates=1000, lr=4.70588e-06, gnorm=4.696, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1834
2022-05-07 20:56:51 - progress_bar.py[line:272] - INFO: epoch 001:   1013 / 17711 loss=5.058, loss_v1=0, loss_v2=0, nll_loss=2.946, ntokens=387.6, nsentences=32, sample_size=387.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=40.489, expert1_balance_bottom=12.026, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.7, wps=222.7, ups=0.57, wpb=387.6, bsz=32, num_updates=1010, lr=4.75294e-06, gnorm=4.75, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1851
2022-05-07 20:57:08 - progress_bar.py[line:272] - INFO: epoch 001:   1023 / 17711 loss=5.06, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=385.7, nsentences=32, sample_size=385.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898579, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=40.428, expert1_balance_bottom=11.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.64, wps=216.6, ups=0.56, wpb=385.7, bsz=32, num_updates=1020, lr=4.8e-06, gnorm=4.356, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1869
2022-05-07 20:57:26 - progress_bar.py[line:272] - INFO: epoch 001:   1033 / 17711 loss=5.054, loss_v1=0, loss_v2=0, nll_loss=2.935, ntokens=382.6, nsentences=32, sample_size=382.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.737, expert1_balance_bottom=12.281, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.65, wps=219.2, ups=0.57, wpb=382.6, bsz=32, num_updates=1030, lr=4.84706e-06, gnorm=4.893, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1887
2022-05-07 20:57:44 - progress_bar.py[line:272] - INFO: epoch 001:   1043 / 17711 loss=5.151, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=377.5, nsentences=32, sample_size=377.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900024, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=40.064, expert1_balance_bottom=12.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.29, wps=212.7, ups=0.56, wpb=377.5, bsz=32, num_updates=1040, lr=4.89412e-06, gnorm=4.647, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1904
2022-05-07 20:58:02 - progress_bar.py[line:272] - INFO: epoch 001:   1053 / 17711 loss=5.045, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=374.4, nsentences=32, sample_size=374.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896701, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.528, expert1_balance_bottom=12.367, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.63, wps=208.7, ups=0.56, wpb=374.4, bsz=32, num_updates=1050, lr=4.94118e-06, gnorm=4.846, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1922
2022-05-07 20:58:19 - progress_bar.py[line:272] - INFO: epoch 001:   1063 / 17711 loss=5.067, loss_v1=0, loss_v2=0, nll_loss=2.96, ntokens=375.6, nsentences=32, sample_size=375.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.802, expert1_balance_bottom=12.633, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.78, wps=213, ups=0.57, wpb=375.6, bsz=32, num_updates=1060, lr=4.98824e-06, gnorm=4.753, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1940
2022-05-07 20:58:36 - progress_bar.py[line:272] - INFO: epoch 001:   1073 / 17711 loss=5.159, loss_v1=0, loss_v2=0, nll_loss=3.059, ntokens=382.7, nsentences=32, sample_size=382.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.599, expert1_balance_bottom=13.098, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.33, wps=222, ups=0.58, wpb=382.7, bsz=32, num_updates=1070, lr=5.03529e-06, gnorm=5.008, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1957
2022-05-07 20:58:53 - progress_bar.py[line:272] - INFO: epoch 001:   1083 / 17711 loss=5.105, loss_v1=0, loss_v2=0, nll_loss=2.993, ntokens=378.9, nsentences=32, sample_size=378.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.912784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.231, expert1_balance_bottom=13.031, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.96, wps=223.3, ups=0.59, wpb=378.9, bsz=32, num_updates=1080, lr=5.08235e-06, gnorm=4.5, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1974
2022-05-07 20:59:11 - progress_bar.py[line:272] - INFO: epoch 001:   1093 / 17711 loss=5.105, loss_v1=0, loss_v2=0, nll_loss=3.016, ntokens=383.9, nsentences=32, sample_size=383.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.773, expert1_balance_bottom=12.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.09, wps=223.3, ups=0.58, wpb=383.9, bsz=32, num_updates=1090, lr=5.12941e-06, gnorm=5.067, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=1991
2022-05-07 20:59:28 - progress_bar.py[line:272] - INFO: epoch 001:   1103 / 17711 loss=5.091, loss_v1=0, loss_v2=0, nll_loss=2.998, ntokens=380.5, nsentences=32, sample_size=380.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.289, expert1_balance_bottom=13.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.99, wps=222.1, ups=0.58, wpb=380.5, bsz=32, num_updates=1100, lr=5.17647e-06, gnorm=5.126, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2008
2022-05-07 20:59:45 - progress_bar.py[line:272] - INFO: epoch 001:   1113 / 17711 loss=5.037, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=381.7, nsentences=32, sample_size=381.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.589, expert1_balance_bottom=12.621, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.63, wps=220, ups=0.58, wpb=381.7, bsz=32, num_updates=1110, lr=5.22353e-06, gnorm=4.569, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2026
2022-05-07 21:00:02 - progress_bar.py[line:272] - INFO: epoch 001:   1123 / 17711 loss=5.029, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=382.4, nsentences=32, sample_size=382.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.118, expert1_balance_bottom=13.193, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.58, wps=222, ups=0.58, wpb=382.4, bsz=32, num_updates=1120, lr=5.27059e-06, gnorm=4.923, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2043
2022-05-07 21:00:20 - progress_bar.py[line:272] - INFO: epoch 001:   1133 / 17711 loss=5.112, loss_v1=0, loss_v2=0, nll_loss=3.005, ntokens=378.6, nsentences=32, sample_size=378.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.910378, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.035, expert1_balance_bottom=13.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.03, wps=213.4, ups=0.56, wpb=378.6, bsz=32, num_updates=1130, lr=5.31765e-06, gnorm=4.586, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2061
2022-05-07 21:00:37 - progress_bar.py[line:272] - INFO: epoch 001:   1143 / 17711 loss=5.116, loss_v1=0, loss_v2=0, nll_loss=3.03, ntokens=392.4, nsentences=32, sample_size=392.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.895, expert1_balance_bottom=12.981, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.17, wps=226.8, ups=0.58, wpb=392.4, bsz=32, num_updates=1140, lr=5.36471e-06, gnorm=4.416, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2078
2022-05-07 21:00:54 - progress_bar.py[line:272] - INFO: epoch 001:   1153 / 17711 loss=5.028, loss_v1=0, loss_v2=0, nll_loss=2.921, ntokens=385, nsentences=32, sample_size=385, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.826, expert1_balance_bottom=13.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.58, wps=225.7, ups=0.59, wpb=385, bsz=32, num_updates=1150, lr=5.41176e-06, gnorm=4.351, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2095
2022-05-07 21:01:12 - progress_bar.py[line:272] - INFO: epoch 001:   1163 / 17711 loss=4.975, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=396.4, nsentences=32, sample_size=396.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873406, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.331, expert1_balance_bottom=13.122, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.35, wps=226.1, ups=0.57, wpb=396.4, bsz=32, num_updates=1160, lr=5.45882e-06, gnorm=4.707, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2113
2022-05-07 21:01:29 - progress_bar.py[line:272] - INFO: epoch 001:   1173 / 17711 loss=5.126, loss_v1=0, loss_v2=0, nll_loss=3.052, ntokens=381.1, nsentences=32, sample_size=381.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897352, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.744, expert1_balance_bottom=13.673, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.29, wps=217.8, ups=0.57, wpb=381.1, bsz=32, num_updates=1170, lr=5.50588e-06, gnorm=4.825, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2130
2022-05-07 21:01:47 - progress_bar.py[line:272] - INFO: epoch 001:   1183 / 17711 loss=4.998, loss_v1=0, loss_v2=0, nll_loss=2.892, ntokens=388.3, nsentences=32, sample_size=388.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89226, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.631, expert1_balance_bottom=13.671, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.42, wps=223.7, ups=0.58, wpb=388.3, bsz=32, num_updates=1180, lr=5.55294e-06, gnorm=4.936, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2148
2022-05-07 21:02:04 - progress_bar.py[line:272] - INFO: epoch 001:   1193 / 17711 loss=4.95, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=388.7, nsentences=32, sample_size=388.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.014, expert1_balance_bottom=13.126, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.13, wps=226.4, ups=0.58, wpb=388.7, bsz=32, num_updates=1190, lr=5.6e-06, gnorm=4.969, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2165
2022-05-07 21:02:21 - progress_bar.py[line:272] - INFO: epoch 001:   1203 / 17711 loss=5.004, loss_v1=0, loss_v2=0, nll_loss=2.904, ntokens=383.9, nsentences=32, sample_size=383.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89578, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.229, expert1_balance_bottom=12.892, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.49, wps=223.8, ups=0.58, wpb=383.9, bsz=32, num_updates=1200, lr=5.64706e-06, gnorm=4.99, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2182
2022-05-07 21:02:39 - progress_bar.py[line:272] - INFO: epoch 001:   1213 / 17711 loss=5.031, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=378.9, nsentences=32, sample_size=378.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892137, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.743, expert1_balance_bottom=13.128, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.64, wps=216.7, ups=0.57, wpb=378.9, bsz=32, num_updates=1210, lr=5.69412e-06, gnorm=4.723, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2199
2022-05-07 21:02:56 - progress_bar.py[line:272] - INFO: epoch 001:   1223 / 17711 loss=4.986, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=386.5, nsentences=32, sample_size=386.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=39.189, expert1_balance_bottom=12.896, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.38, wps=223.6, ups=0.58, wpb=386.5, bsz=32, num_updates=1220, lr=5.74118e-06, gnorm=4.59, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2217
2022-05-07 21:03:13 - progress_bar.py[line:272] - INFO: epoch 001:   1233 / 17711 loss=4.952, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=371.3, nsentences=32, sample_size=371.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.910887, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.795, expert1_balance_bottom=13.09, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.12, wps=213.4, ups=0.57, wpb=371.3, bsz=32, num_updates=1230, lr=5.78824e-06, gnorm=4.74, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2234
2022-05-07 21:03:31 - progress_bar.py[line:272] - INFO: epoch 001:   1243 / 17711 loss=4.94, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=385.2, nsentences=32, sample_size=385.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894173, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.94, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.412, expert1_balance_bottom=13.454, unused_expert1_count=0.004, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.06, wps=219.6, ups=0.57, wpb=385.2, bsz=32, num_updates=1240, lr=5.83529e-06, gnorm=4.941, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2252
2022-05-07 21:03:48 - progress_bar.py[line:272] - INFO: epoch 001:   1253 / 17711 loss=5.113, loss_v1=0, loss_v2=0, nll_loss=3.028, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894888, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.616, expert1_balance_bottom=13.664, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=8.16, wps=220.9, ups=0.58, wpb=382.5, bsz=32, num_updates=1250, lr=5.88235e-06, gnorm=5.153, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2269
2022-05-07 21:04:05 - progress_bar.py[line:272] - INFO: epoch 001:   1263 / 17711 loss=4.998, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=382.7, nsentences=32, sample_size=382.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893624, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38, expert1_balance_bottom=13.745, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.51, wps=220.3, ups=0.58, wpb=382.7, bsz=32, num_updates=1260, lr=5.92941e-06, gnorm=4.244, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2286
2022-05-07 21:04:23 - progress_bar.py[line:272] - INFO: epoch 001:   1273 / 17711 loss=4.876, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=397.9, nsentences=32, sample_size=397.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.876, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.437, expert1_balance_bottom=13.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.77, wps=226.9, ups=0.57, wpb=397.9, bsz=32, num_updates=1270, lr=5.97647e-06, gnorm=4.545, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2304
2022-05-07 21:04:40 - progress_bar.py[line:272] - INFO: epoch 001:   1283 / 17711 loss=4.799, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=380.3, nsentences=32, sample_size=380.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.799, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=38.491, expert1_balance_bottom=13.406, unused_expert1_count=0.004, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.27, wps=220.6, ups=0.58, wpb=380.3, bsz=32, num_updates=1280, lr=6.02353e-06, gnorm=4.272, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2321
2022-05-07 21:04:58 - progress_bar.py[line:272] - INFO: epoch 001:   1293 / 17711 loss=4.96, loss_v1=0, loss_v2=0, nll_loss=2.858, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=37.804, expert1_balance_bottom=14.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.25, wps=221.2, ups=0.58, wpb=382.5, bsz=32, num_updates=1290, lr=6.07059e-06, gnorm=4.608, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2338
2022-05-07 21:05:15 - progress_bar.py[line:272] - INFO: epoch 001:   1303 / 17711 loss=4.85, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=382.6, nsentences=32, sample_size=382.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.85, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.158, expert1_balance_bottom=14.031, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.64, wps=220, ups=0.58, wpb=382.6, bsz=32, num_updates=1300, lr=6.11765e-06, gnorm=4.631, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2356
2022-05-07 21:05:32 - progress_bar.py[line:272] - INFO: epoch 001:   1313 / 17711 loss=4.839, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=379, nsentences=32, sample_size=379, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.839, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=38.066, expert1_balance_bottom=13.684, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.5, wps=216.9, ups=0.57, wpb=379, bsz=32, num_updates=1310, lr=6.16471e-06, gnorm=4.343, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2373
2022-05-07 21:05:50 - progress_bar.py[line:272] - INFO: epoch 001:   1323 / 17711 loss=4.918, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891209, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.918, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.05, expert1_balance_bottom=13.862, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.05, wps=219.4, ups=0.57, wpb=382.5, bsz=32, num_updates=1320, lr=6.21176e-06, gnorm=4.477, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2391
2022-05-07 21:06:07 - progress_bar.py[line:272] - INFO: epoch 001:   1333 / 17711 loss=4.895, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=384.6, nsentences=32, sample_size=384.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.895, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=37.839, expert1_balance_bottom=14.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.88, wps=219.9, ups=0.57, wpb=384.6, bsz=32, num_updates=1330, lr=6.25882e-06, gnorm=4.244, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2408
2022-05-07 21:06:25 - progress_bar.py[line:272] - INFO: epoch 001:   1343 / 17711 loss=4.901, loss_v1=0, loss_v2=0, nll_loss=2.795, ntokens=382.4, nsentences=32, sample_size=382.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.901, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=38.766, expert1_balance_bottom=13.742, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.94, wps=218.9, ups=0.57, wpb=382.4, bsz=32, num_updates=1340, lr=6.30588e-06, gnorm=4.657, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2426
2022-05-07 21:06:42 - progress_bar.py[line:272] - INFO: epoch 001:   1353 / 17711 loss=4.97, loss_v1=0, loss_v2=0, nll_loss=2.876, ntokens=383.5, nsentences=32, sample_size=383.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891143, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.602, expert1_balance_bottom=14.72, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.34, wps=221.3, ups=0.58, wpb=383.5, bsz=32, num_updates=1350, lr=6.35294e-06, gnorm=5.032, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2443
2022-05-07 21:06:59 - progress_bar.py[line:272] - INFO: epoch 001:   1363 / 17711 loss=4.931, loss_v1=0, loss_v2=0, nll_loss=2.825, ntokens=386.2, nsentences=32, sample_size=386.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900042, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.931, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=37.908, expert1_balance_bottom=14.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.08, wps=227.2, ups=0.59, wpb=386.2, bsz=32, num_updates=1360, lr=6.4e-06, gnorm=5.187, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=2460
2022-05-07 21:07:17 - progress_bar.py[line:272] - INFO: epoch 001:   1373 / 17711 loss=5.012, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=384.9, nsentences=32, sample_size=384.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891063, inner_loss_v1=0, inner_loss_v2=0, inner_loss=5.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=37.001, expert1_balance_bottom=14.676, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.59, wps=220.5, ups=0.57, wpb=384.9, bsz=32, num_updates=1370, lr=6.44706e-06, gnorm=4.391, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2477
2022-05-07 21:07:34 - progress_bar.py[line:272] - INFO: epoch 001:   1383 / 17711 loss=4.93, loss_v1=0, loss_v2=0, nll_loss=2.837, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.93, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=37.564, expert1_balance_bottom=14.167, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.15, wps=220, ups=0.58, wpb=382.5, bsz=32, num_updates=1380, lr=6.49412e-06, gnorm=4.768, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2495
2022-05-07 21:07:51 - progress_bar.py[line:272] - INFO: epoch 001:   1393 / 17711 loss=4.91, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=386.1, nsentences=32, sample_size=386.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892488, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.91, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=38.35, expert1_balance_bottom=13.939, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7, wps=221.7, ups=0.57, wpb=386.1, bsz=32, num_updates=1390, lr=6.54118e-06, gnorm=4.287, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2512
2022-05-07 21:08:09 - progress_bar.py[line:272] - INFO: epoch 001:   1403 / 17711 loss=4.93, loss_v1=0, loss_v2=0, nll_loss=2.824, ntokens=380, nsentences=32, sample_size=380, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901986, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.93, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.823, expert1_balance_bottom=14.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.08, wps=216, ups=0.57, wpb=380, bsz=32, num_updates=1400, lr=6.58824e-06, gnorm=4.575, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2530
2022-05-07 21:08:26 - progress_bar.py[line:272] - INFO: epoch 001:   1413 / 17711 loss=4.838, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=380.7, nsentences=32, sample_size=380.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896497, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.838, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=38.308, expert1_balance_bottom=14.003, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.58, wps=221.4, ups=0.58, wpb=380.7, bsz=32, num_updates=1410, lr=6.63529e-06, gnorm=4.172, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2547
2022-05-07 21:08:44 - progress_bar.py[line:272] - INFO: epoch 001:   1423 / 17711 loss=4.878, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=388.7, nsentences=32, sample_size=388.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890529, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.878, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=38.619, expert1_balance_bottom=13.916, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.85, wps=222.9, ups=0.57, wpb=388.7, bsz=32, num_updates=1420, lr=6.68235e-06, gnorm=4.326, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2564
2022-05-07 21:09:01 - progress_bar.py[line:272] - INFO: epoch 001:   1433 / 17711 loss=4.816, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=384.2, nsentences=32, sample_size=384.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901558, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.816, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.653, expert1_balance_bottom=14.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.45, wps=223.8, ups=0.58, wpb=384.2, bsz=32, num_updates=1430, lr=6.72941e-06, gnorm=4.609, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2582
2022-05-07 21:09:18 - progress_bar.py[line:272] - INFO: epoch 001:   1443 / 17711 loss=4.777, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=384.3, nsentences=32, sample_size=384.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.907696, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.777, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.595, expert1_balance_bottom=14.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.22, wps=220.4, ups=0.57, wpb=384.3, bsz=32, num_updates=1440, lr=6.77647e-06, gnorm=4.786, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2599
2022-05-07 21:09:36 - progress_bar.py[line:272] - INFO: epoch 001:   1453 / 17711 loss=4.841, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=383.8, nsentences=32, sample_size=383.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.841, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.417, expert1_balance_bottom=14.499, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.62, wps=216.9, ups=0.57, wpb=383.8, bsz=32, num_updates=1450, lr=6.82353e-06, gnorm=4.141, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2617
2022-05-07 21:09:53 - progress_bar.py[line:272] - INFO: epoch 001:   1463 / 17711 loss=4.926, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=388.9, nsentences=32, sample_size=388.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.926, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.959, expert1_balance_bottom=14.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=7.24, wps=224.8, ups=0.58, wpb=388.9, bsz=32, num_updates=1460, lr=6.87059e-06, gnorm=4.589, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=2634
2022-05-07 21:10:11 - progress_bar.py[line:272] - INFO: epoch 001:   1473 / 17711 loss=4.871, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=378.7, nsentences=32, sample_size=378.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.871, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.719, expert1_balance_bottom=14.247, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.8, wps=217.8, ups=0.58, wpb=378.7, bsz=32, num_updates=1470, lr=6.91765e-06, gnorm=4.366, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2651
2022-05-07 21:10:28 - progress_bar.py[line:272] - INFO: epoch 001:   1483 / 17711 loss=4.726, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=386.6, nsentences=32, sample_size=386.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.726, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.608, expert1_balance_bottom=14.477, unused_expert1_count=0.004, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.05, wps=226, ups=0.58, wpb=386.6, bsz=32, num_updates=1480, lr=6.96471e-06, gnorm=4.367, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2668
2022-05-07 21:10:45 - progress_bar.py[line:272] - INFO: epoch 001:   1493 / 17711 loss=4.85, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=374.3, nsentences=32, sample_size=374.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890768, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.85, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.844, expert1_balance_bottom=14.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.7, wps=216.6, ups=0.58, wpb=374.3, bsz=32, num_updates=1490, lr=7.01176e-06, gnorm=4.374, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2686
2022-05-07 21:11:02 - progress_bar.py[line:272] - INFO: epoch 001:   1503 / 17711 loss=4.767, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=381.2, nsentences=32, sample_size=381.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.906005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.767, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.719, expert1_balance_bottom=14.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.19, wps=222, ups=0.58, wpb=381.2, bsz=32, num_updates=1500, lr=7.05882e-06, gnorm=5.387, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2703
2022-05-07 21:11:20 - progress_bar.py[line:272] - INFO: epoch 001:   1513 / 17711 loss=4.78, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=383.5, nsentences=32, sample_size=383.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.78, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.927, expert1_balance_bottom=14.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.39, wps=219.6, ups=0.57, wpb=383.5, bsz=32, num_updates=1510, lr=7.10588e-06, gnorm=4.246, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2720
2022-05-07 21:11:37 - progress_bar.py[line:272] - INFO: epoch 001:   1523 / 17711 loss=4.802, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=384.4, nsentences=32, sample_size=384.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894528, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.802, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=38.074, expert1_balance_bottom=14.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.43, wps=224.7, ups=0.58, wpb=384.4, bsz=32, num_updates=1520, lr=7.15294e-06, gnorm=4.013, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2738
2022-05-07 21:11:54 - progress_bar.py[line:272] - INFO: epoch 001:   1533 / 17711 loss=4.863, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=387.7, nsentences=32, sample_size=387.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.863, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.97, expert1_balance_bottom=14.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.75, wps=223.9, ups=0.58, wpb=387.7, bsz=32, num_updates=1530, lr=7.2e-06, gnorm=4.089, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2755
2022-05-07 21:12:12 - progress_bar.py[line:272] - INFO: epoch 001:   1543 / 17711 loss=4.741, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=378.4, nsentences=32, sample_size=378.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.741, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.723, expert1_balance_bottom=14.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.16, wps=216.3, ups=0.57, wpb=378.4, bsz=32, num_updates=1540, lr=7.24706e-06, gnorm=4.358, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2772
2022-05-07 21:12:29 - progress_bar.py[line:272] - INFO: epoch 001:   1553 / 17711 loss=4.725, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=378.6, nsentences=32, sample_size=378.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.725, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.268, expert1_balance_bottom=14.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6, wps=216.8, ups=0.57, wpb=378.6, bsz=32, num_updates=1550, lr=7.29412e-06, gnorm=4.052, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2790
2022-05-07 21:12:46 - progress_bar.py[line:272] - INFO: epoch 001:   1563 / 17711 loss=4.84, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=387.9, nsentences=32, sample_size=387.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885608, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.84, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.717, expert1_balance_bottom=14.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.72, wps=222.1, ups=0.57, wpb=387.9, bsz=32, num_updates=1560, lr=7.34118e-06, gnorm=4.49, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2807
2022-05-07 21:13:04 - progress_bar.py[line:272] - INFO: epoch 001:   1573 / 17711 loss=4.772, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=380.3, nsentences=32, sample_size=380.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884663, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.772, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.768, expert1_balance_bottom=14.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.36, wps=221.9, ups=0.58, wpb=380.3, bsz=32, num_updates=1570, lr=7.38824e-06, gnorm=4.264, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2824
2022-05-07 21:13:21 - progress_bar.py[line:272] - INFO: epoch 001:   1583 / 17711 loss=4.786, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=387.2, nsentences=32, sample_size=387.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886434, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.786, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=38.162, expert1_balance_bottom=14.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.4, wps=223.1, ups=0.58, wpb=387.2, bsz=32, num_updates=1580, lr=7.43529e-06, gnorm=4.066, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2842
2022-05-07 21:13:38 - progress_bar.py[line:272] - INFO: epoch 001:   1593 / 17711 loss=4.753, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=379.9, nsentences=32, sample_size=379.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889874, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.753, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.512, expert1_balance_bottom=14.407, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.23, wps=220.6, ups=0.58, wpb=379.9, bsz=32, num_updates=1590, lr=7.48235e-06, gnorm=4.785, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2859
2022-05-07 21:13:55 - progress_bar.py[line:272] - INFO: epoch 001:   1603 / 17711 loss=4.653, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=386, nsentences=32, sample_size=386, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894015, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.653, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.747, expert1_balance_bottom=14.704, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.71, wps=224.3, ups=0.58, wpb=386, bsz=32, num_updates=1600, lr=7.52941e-06, gnorm=4.182, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2876
2022-05-07 21:14:12 - progress_bar.py[line:272] - INFO: epoch 001:   1613 / 17711 loss=4.701, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=380.7, nsentences=32, sample_size=380.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.906515, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.701, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.324, expert1_balance_bottom=14.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.89, wps=222.8, ups=0.59, wpb=380.7, bsz=32, num_updates=1610, lr=7.57647e-06, gnorm=4.268, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2893
2022-05-07 21:14:30 - progress_bar.py[line:272] - INFO: epoch 001:   1623 / 17711 loss=4.782, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=384.6, nsentences=32, sample_size=384.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891411, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.782, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.658, expert1_balance_bottom=14.586, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.36, wps=220.4, ups=0.57, wpb=384.6, bsz=32, num_updates=1620, lr=7.62353e-06, gnorm=4.605, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2911
2022-05-07 21:14:47 - progress_bar.py[line:272] - INFO: epoch 001:   1633 / 17711 loss=4.717, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=380.5, nsentences=32, sample_size=380.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.717, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.494, expert1_balance_bottom=14.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.09, wps=222.9, ups=0.59, wpb=380.5, bsz=32, num_updates=1630, lr=7.67059e-06, gnorm=4.114, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2928
2022-05-07 21:15:04 - progress_bar.py[line:272] - INFO: epoch 001:   1643 / 17711 loss=4.832, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=379, nsentences=32, sample_size=379, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879065, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.832, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.787, expert1_balance_bottom=15.029, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.71, wps=221.8, ups=0.59, wpb=379, bsz=32, num_updates=1640, lr=7.71765e-06, gnorm=4.19, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2945
2022-05-07 21:15:21 - progress_bar.py[line:272] - INFO: epoch 001:   1653 / 17711 loss=4.847, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=378.1, nsentences=32, sample_size=378.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892853, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.847, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.954, expert1_balance_bottom=14.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.76, wps=220.7, ups=0.58, wpb=378.1, bsz=32, num_updates=1650, lr=7.76471e-06, gnorm=4.17, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2962
2022-05-07 21:15:39 - progress_bar.py[line:272] - INFO: epoch 001:   1663 / 17711 loss=4.864, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=386.8, nsentences=32, sample_size=386.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875599, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.864, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.203, expert1_balance_bottom=14.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.84, wps=223.8, ups=0.58, wpb=386.8, bsz=32, num_updates=1660, lr=7.81176e-06, gnorm=4.781, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=2979
2022-05-07 21:15:56 - progress_bar.py[line:272] - INFO: epoch 001:   1673 / 17711 loss=4.788, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.788, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.193, expert1_balance_bottom=14.794, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.42, wps=219.6, ups=0.57, wpb=382.5, bsz=32, num_updates=1670, lr=7.85882e-06, gnorm=4.327, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=2997
2022-05-07 21:16:14 - progress_bar.py[line:272] - INFO: epoch 001:   1683 / 17711 loss=4.646, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=387.8, nsentences=32, sample_size=387.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895203, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.646, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.301, expert1_balance_bottom=14.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.71, wps=219.4, ups=0.57, wpb=387.8, bsz=32, num_updates=1680, lr=7.90588e-06, gnorm=5.284, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3014
2022-05-07 21:16:32 - progress_bar.py[line:272] - INFO: epoch 001:   1693 / 17711 loss=4.737, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=388.3, nsentences=32, sample_size=388.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888585, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.737, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.705, expert1_balance_bottom=14.632, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.14, wps=212.3, ups=0.55, wpb=388.3, bsz=32, num_updates=1690, lr=7.95294e-06, gnorm=5.404, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3033
2022-05-07 21:16:41 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-07 21:16:51 - progress_bar.py[line:272] - INFO: epoch 001:   1704 / 17711 loss=4.732, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=379.8, nsentences=32, sample_size=379.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90063, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.732, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.307, expert1_balance_bottom=14.844, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.11, wps=198.3, ups=0.52, wpb=379.8, bsz=32, num_updates=1700, lr=8e-06, gnorm=4.593, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3052
2022-05-07 21:17:09 - progress_bar.py[line:272] - INFO: epoch 001:   1714 / 17711 loss=4.82, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=385.1, nsentences=32, sample_size=385.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.82, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.373, expert1_balance_bottom=14.741, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.58, wps=219.7, ups=0.57, wpb=385.1, bsz=32, num_updates=1710, lr=8.04706e-06, gnorm=4.68, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3069
2022-05-07 21:17:26 - progress_bar.py[line:272] - INFO: epoch 001:   1724 / 17711 loss=4.685, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=383.3, nsentences=32, sample_size=383.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.685, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.14, expert1_balance_bottom=14.876, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.91, wps=222.2, ups=0.58, wpb=383.3, bsz=32, num_updates=1720, lr=8.09412e-06, gnorm=4.043, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=3087
2022-05-07 21:17:43 - progress_bar.py[line:272] - INFO: epoch 001:   1734 / 17711 loss=4.797, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=388.4, nsentences=32, sample_size=388.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.797, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.815, expert1_balance_bottom=15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.41, wps=221.4, ups=0.57, wpb=388.4, bsz=32, num_updates=1730, lr=8.14118e-06, gnorm=4.693, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=3104
2022-05-07 21:18:01 - progress_bar.py[line:272] - INFO: epoch 001:   1744 / 17711 loss=4.681, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=383.3, nsentences=32, sample_size=383.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889092, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.681, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.852, expert1_balance_bottom=14.649, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.91, wps=220.5, ups=0.58, wpb=383.3, bsz=32, num_updates=1740, lr=8.18824e-06, gnorm=4.526, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3122
2022-05-07 21:18:19 - progress_bar.py[line:272] - INFO: epoch 001:   1754 / 17711 loss=4.665, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=383.6, nsentences=32, sample_size=383.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.665, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.046, expert1_balance_bottom=14.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.84, wps=215.3, ups=0.56, wpb=383.6, bsz=32, num_updates=1750, lr=8.23529e-06, gnorm=4.238, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3139
2022-05-07 21:18:36 - progress_bar.py[line:272] - INFO: epoch 001:   1764 / 17711 loss=4.727, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=384.3, nsentences=32, sample_size=384.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88936, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.727, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.297, expert1_balance_bottom=15.004, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.13, wps=218.3, ups=0.57, wpb=384.3, bsz=32, num_updates=1760, lr=8.28235e-06, gnorm=4.027, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3157
2022-05-07 21:18:54 - progress_bar.py[line:272] - INFO: epoch 001:   1774 / 17711 loss=4.784, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=374.8, nsentences=32, sample_size=374.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894546, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.784, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.559, expert1_balance_bottom=15.004, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.4, wps=215.3, ups=0.57, wpb=374.8, bsz=32, num_updates=1770, lr=8.32941e-06, gnorm=4.34, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3174
2022-05-07 21:19:11 - progress_bar.py[line:272] - INFO: epoch 001:   1784 / 17711 loss=4.695, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=380, nsentences=32, sample_size=380, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.907098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.695, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.064, expert1_balance_bottom=15.142, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.91, wps=216.7, ups=0.57, wpb=380, bsz=32, num_updates=1780, lr=8.37647e-06, gnorm=4.212, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3192
2022-05-07 21:19:29 - progress_bar.py[line:272] - INFO: epoch 001:   1794 / 17711 loss=4.708, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=382.8, nsentences=32, sample_size=382.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893172, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.708, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.756, expert1_balance_bottom=14.83, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.03, wps=220.1, ups=0.57, wpb=382.8, bsz=32, num_updates=1790, lr=8.42353e-06, gnorm=4.365, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3209
2022-05-07 21:19:46 - progress_bar.py[line:272] - INFO: epoch 001:   1804 / 17711 loss=4.664, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=385.9, nsentences=32, sample_size=385.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892232, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.664, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.115, expert1_balance_bottom=15.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.81, wps=215.8, ups=0.56, wpb=385.9, bsz=32, num_updates=1800, lr=8.47059e-06, gnorm=4.259, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3227
2022-05-07 21:20:04 - progress_bar.py[line:272] - INFO: epoch 001:   1814 / 17711 loss=4.692, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=384.1, nsentences=32, sample_size=384.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.692, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.935, expert1_balance_bottom=14.633, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.96, wps=215.6, ups=0.56, wpb=384.1, bsz=32, num_updates=1810, lr=8.51765e-06, gnorm=5.06, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3245
2022-05-07 21:20:22 - progress_bar.py[line:272] - INFO: epoch 001:   1824 / 17711 loss=4.651, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=391.1, nsentences=32, sample_size=391.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.651, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.118, expert1_balance_bottom=15.111, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.78, wps=219.7, ups=0.56, wpb=391.1, bsz=32, num_updates=1820, lr=8.56471e-06, gnorm=4.064, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3263
2022-05-07 21:20:40 - progress_bar.py[line:272] - INFO: epoch 001:   1834 / 17711 loss=4.659, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=381.7, nsentences=32, sample_size=381.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.659, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.049, expert1_balance_bottom=14.697, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.81, wps=216.2, ups=0.57, wpb=381.7, bsz=32, num_updates=1830, lr=8.61176e-06, gnorm=4.346, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3280
2022-05-07 21:20:57 - progress_bar.py[line:272] - INFO: epoch 001:   1844 / 17711 loss=4.72, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=377.8, nsentences=32, sample_size=377.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.72, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.55, expert1_balance_bottom=14.704, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.19, wps=213.6, ups=0.57, wpb=377.8, bsz=32, num_updates=1840, lr=8.65882e-06, gnorm=4.184, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3298
2022-05-07 21:21:15 - progress_bar.py[line:272] - INFO: epoch 001:   1854 / 17711 loss=4.642, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=387.1, nsentences=32, sample_size=387.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890807, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.642, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.933, expert1_balance_bottom=15.022, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.7, wps=220.9, ups=0.57, wpb=387.1, bsz=32, num_updates=1850, lr=8.70588e-06, gnorm=3.834, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3316
2022-05-07 21:21:32 - progress_bar.py[line:272] - INFO: epoch 001:   1864 / 17711 loss=4.776, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=393.1, nsentences=32, sample_size=393.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894941, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.776, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.082, expert1_balance_bottom=14.798, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.37, wps=224.5, ups=0.57, wpb=393.1, bsz=32, num_updates=1860, lr=8.75294e-06, gnorm=3.925, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3333
2022-05-07 21:21:50 - progress_bar.py[line:272] - INFO: epoch 001:   1874 / 17711 loss=4.646, loss_v1=0, loss_v2=0, nll_loss=2.513, ntokens=371.8, nsentences=32, sample_size=371.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900628, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.646, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.307, expert1_balance_bottom=14.871, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.71, wps=209.4, ups=0.56, wpb=371.8, bsz=32, num_updates=1870, lr=8.8e-06, gnorm=4.39, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3351
2022-05-07 21:22:08 - progress_bar.py[line:272] - INFO: epoch 001:   1884 / 17711 loss=4.694, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=382.8, nsentences=32, sample_size=382.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888944, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.694, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.325, expert1_balance_bottom=14.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.97, wps=218.8, ups=0.57, wpb=382.8, bsz=32, num_updates=1880, lr=8.84706e-06, gnorm=4.17, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3368
2022-05-07 21:22:25 - progress_bar.py[line:272] - INFO: epoch 001:   1894 / 17711 loss=4.683, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=384.3, nsentences=32, sample_size=384.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.683, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.069, expert1_balance_bottom=15.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.93, wps=219.7, ups=0.57, wpb=384.3, bsz=32, num_updates=1890, lr=8.89412e-06, gnorm=4.157, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3386
2022-05-07 21:22:43 - progress_bar.py[line:272] - INFO: epoch 001:   1904 / 17711 loss=4.671, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=396, nsentences=32, sample_size=396, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.671, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=38.144, expert1_balance_bottom=14.631, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.9, wps=223.3, ups=0.56, wpb=396, bsz=32, num_updates=1900, lr=8.94118e-06, gnorm=4.359, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3404
2022-05-07 21:23:00 - progress_bar.py[line:272] - INFO: epoch 001:   1914 / 17711 loss=4.678, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=384.5, nsentences=32, sample_size=384.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.678, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.033, expert1_balance_bottom=15.14, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.99, wps=219.3, ups=0.57, wpb=384.5, bsz=32, num_updates=1910, lr=8.98824e-06, gnorm=4.162, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3421
2022-05-07 21:23:18 - progress_bar.py[line:272] - INFO: epoch 001:   1924 / 17711 loss=4.606, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=378.2, nsentences=32, sample_size=378.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.606, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.095, expert1_balance_bottom=14.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.6, wps=211.5, ups=0.56, wpb=378.2, bsz=32, num_updates=1920, lr=9.03529e-06, gnorm=4.945, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3439
2022-05-07 21:23:36 - progress_bar.py[line:272] - INFO: epoch 001:   1934 / 17711 loss=4.6, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=382, nsentences=32, sample_size=382, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890477, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.6, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.608, expert1_balance_bottom=15.552, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.53, wps=216.8, ups=0.57, wpb=382, bsz=32, num_updates=1930, lr=9.08235e-06, gnorm=3.953, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3457
2022-05-07 21:23:53 - progress_bar.py[line:272] - INFO: epoch 001:   1944 / 17711 loss=4.673, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=372.6, nsentences=32, sample_size=372.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.673, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.52, expert1_balance_bottom=14.973, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.88, wps=212.6, ups=0.57, wpb=372.6, bsz=32, num_updates=1940, lr=9.12941e-06, gnorm=4.088, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3474
2022-05-07 21:24:11 - progress_bar.py[line:272] - INFO: epoch 001:   1954 / 17711 loss=4.71, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=389.8, nsentences=32, sample_size=389.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.71, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.909, expert1_balance_bottom=15.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.11, wps=223.9, ups=0.57, wpb=389.8, bsz=32, num_updates=1950, lr=9.17647e-06, gnorm=4.192, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3492
2022-05-07 21:24:28 - progress_bar.py[line:272] - INFO: epoch 001:   1964 / 17711 loss=4.635, loss_v1=0, loss_v2=0, nll_loss=2.503, ntokens=373.4, nsentences=32, sample_size=373.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.635, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.623, expert1_balance_bottom=15.219, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.67, wps=211.9, ups=0.57, wpb=373.4, bsz=32, num_updates=1960, lr=9.22353e-06, gnorm=3.842, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3509
2022-05-07 21:24:46 - progress_bar.py[line:272] - INFO: epoch 001:   1974 / 17711 loss=4.673, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=380.4, nsentences=32, sample_size=380.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.673, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.715, expert1_balance_bottom=15.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.91, wps=219.5, ups=0.58, wpb=380.4, bsz=32, num_updates=1970, lr=9.27059e-06, gnorm=5.059, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3527
2022-05-07 21:25:03 - progress_bar.py[line:272] - INFO: epoch 001:   1984 / 17711 loss=4.64, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=380.3, nsentences=32, sample_size=380.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.64, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=36.731, expert1_balance_bottom=15.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.72, wps=218.3, ups=0.57, wpb=380.3, bsz=32, num_updates=1980, lr=9.31765e-06, gnorm=4.089, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3544
2022-05-07 21:25:21 - progress_bar.py[line:272] - INFO: epoch 001:   1994 / 17711 loss=4.594, loss_v1=0, loss_v2=0, nll_loss=2.459, ntokens=384.5, nsentences=32, sample_size=384.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.9008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.594, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.632, expert1_balance_bottom=15.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.5, wps=218.8, ups=0.57, wpb=384.5, bsz=32, num_updates=1990, lr=9.36471e-06, gnorm=4.243, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3562
2022-05-07 21:25:38 - progress_bar.py[line:272] - INFO: epoch 001:   2004 / 17711 loss=4.654, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=389.9, nsentences=32, sample_size=389.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887209, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.654, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.289, expert1_balance_bottom=14.944, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.85, wps=222.7, ups=0.57, wpb=389.9, bsz=32, num_updates=2000, lr=9.41176e-06, gnorm=4.689, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3579
2022-05-07 21:25:56 - progress_bar.py[line:272] - INFO: epoch 001:   2014 / 17711 loss=4.609, loss_v1=0, loss_v2=0, nll_loss=2.494, ntokens=392.9, nsentences=32, sample_size=392.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882959, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.609, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=37.421, expert1_balance_bottom=15.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.63, wps=224.7, ups=0.57, wpb=392.9, bsz=32, num_updates=2010, lr=9.45882e-06, gnorm=4.436, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3597
2022-05-07 21:26:13 - progress_bar.py[line:272] - INFO: epoch 001:   2024 / 17711 loss=4.604, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=376.8, nsentences=32, sample_size=376.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.604, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.356, expert1_balance_bottom=15.283, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.54, wps=217.5, ups=0.58, wpb=376.8, bsz=32, num_updates=2020, lr=9.50588e-06, gnorm=3.96, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3614
2022-05-07 21:26:31 - progress_bar.py[line:272] - INFO: epoch 001:   2034 / 17711 loss=4.721, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=379.9, nsentences=32, sample_size=379.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.721, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.827, expert1_balance_bottom=15.193, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.17, wps=218, ups=0.57, wpb=379.9, bsz=32, num_updates=2030, lr=9.55294e-06, gnorm=4.083, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3631
2022-05-07 21:26:48 - progress_bar.py[line:272] - INFO: epoch 001:   2044 / 17711 loss=4.825, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=383.8, nsentences=32, sample_size=383.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.825, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.575, expert1_balance_bottom=15.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.7, wps=216.1, ups=0.56, wpb=383.8, bsz=32, num_updates=2040, lr=9.6e-06, gnorm=5.267, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3649
2022-05-07 21:27:06 - progress_bar.py[line:272] - INFO: epoch 001:   2054 / 17711 loss=4.649, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=384.5, nsentences=32, sample_size=384.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.649, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.545, expert1_balance_bottom=15.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.76, wps=218, ups=0.57, wpb=384.5, bsz=32, num_updates=2050, lr=9.64706e-06, gnorm=3.873, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3667
2022-05-07 21:27:24 - progress_bar.py[line:272] - INFO: epoch 001:   2064 / 17711 loss=4.611, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=390.2, nsentences=32, sample_size=390.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.611, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.726, expert1_balance_bottom=15.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.64, wps=221.8, ups=0.57, wpb=390.2, bsz=32, num_updates=2060, lr=9.69412e-06, gnorm=4.121, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3684
2022-05-07 21:27:41 - progress_bar.py[line:272] - INFO: epoch 001:   2074 / 17711 loss=4.58, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=379.1, nsentences=32, sample_size=379.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.58, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.426, expert1_balance_bottom=15.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.45, wps=215.3, ups=0.57, wpb=379.1, bsz=32, num_updates=2070, lr=9.74118e-06, gnorm=4.281, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3702
2022-05-07 21:27:59 - progress_bar.py[line:272] - INFO: epoch 001:   2084 / 17711 loss=4.598, loss_v1=0, loss_v2=0, nll_loss=2.471, ntokens=379.3, nsentences=32, sample_size=379.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897947, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.598, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.051, expert1_balance_bottom=15.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.54, wps=212.7, ups=0.56, wpb=379.3, bsz=32, num_updates=2080, lr=9.78824e-06, gnorm=4.178, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3720
2022-05-07 21:28:17 - progress_bar.py[line:272] - INFO: epoch 001:   2094 / 17711 loss=4.706, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=395.3, nsentences=32, sample_size=395.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.706, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=37.514, expert1_balance_bottom=15.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.11, wps=216.4, ups=0.55, wpb=395.3, bsz=32, num_updates=2090, lr=9.83529e-06, gnorm=3.672, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3738
2022-05-07 21:28:35 - progress_bar.py[line:272] - INFO: epoch 001:   2104 / 17711 loss=4.798, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=393.4, nsentences=32, sample_size=393.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891643, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.798, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.532, expert1_balance_bottom=15.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=6.54, wps=220.4, ups=0.56, wpb=393.4, bsz=32, num_updates=2100, lr=9.88235e-06, gnorm=4.868, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3756
2022-05-07 21:28:53 - progress_bar.py[line:272] - INFO: epoch 001:   2114 / 17711 loss=4.588, loss_v1=0, loss_v2=0, nll_loss=2.466, ntokens=379.6, nsentences=32, sample_size=379.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895072, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.588, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=37.279, expert1_balance_bottom=14.928, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.53, wps=213.2, ups=0.56, wpb=379.6, bsz=32, num_updates=2110, lr=9.92941e-06, gnorm=4.14, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3774
2022-05-07 21:29:10 - progress_bar.py[line:272] - INFO: epoch 001:   2124 / 17711 loss=4.69, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=378.4, nsentences=32, sample_size=378.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.69, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.917, expert1_balance_bottom=15.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.99, wps=217.8, ups=0.58, wpb=378.4, bsz=32, num_updates=2120, lr=9.97647e-06, gnorm=4.497, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3791
2022-05-07 21:29:28 - progress_bar.py[line:272] - INFO: epoch 001:   2134 / 17711 loss=4.511, loss_v1=0, loss_v2=0, nll_loss=2.368, ntokens=387.5, nsentences=32, sample_size=387.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.511, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.719, expert1_balance_bottom=14.954, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.16, wps=219.7, ups=0.57, wpb=387.5, bsz=32, num_updates=2130, lr=9.9985e-06, gnorm=3.868, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3809
2022-05-07 21:29:46 - progress_bar.py[line:272] - INFO: epoch 001:   2144 / 17711 loss=4.572, loss_v1=0, loss_v2=0, nll_loss=2.445, ntokens=382.1, nsentences=32, sample_size=382.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896063, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.572, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.771, expert1_balance_bottom=15.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.44, wps=215.7, ups=0.56, wpb=382.1, bsz=32, num_updates=2140, lr=9.9955e-06, gnorm=3.922, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3826
2022-05-07 21:30:03 - progress_bar.py[line:272] - INFO: epoch 001:   2154 / 17711 loss=4.623, loss_v1=0, loss_v2=0, nll_loss=2.517, ntokens=381.6, nsentences=32, sample_size=381.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891501, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.623, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.469, expert1_balance_bottom=15.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.73, wps=218, ups=0.57, wpb=381.6, bsz=32, num_updates=2150, lr=9.99249e-06, gnorm=3.712, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3844
2022-05-07 21:30:21 - progress_bar.py[line:272] - INFO: epoch 001:   2164 / 17711 loss=4.57, loss_v1=0, loss_v2=0, nll_loss=2.431, ntokens=376.1, nsentences=32, sample_size=376.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.907432, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.57, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.635, expert1_balance_bottom=15.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.39, wps=210.4, ups=0.56, wpb=376.1, bsz=32, num_updates=2160, lr=9.98949e-06, gnorm=4.372, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3862
2022-05-07 21:30:39 - progress_bar.py[line:272] - INFO: epoch 001:   2174 / 17711 loss=4.582, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=374.7, nsentences=32, sample_size=374.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898681, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.582, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=37.128, expert1_balance_bottom=15.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.49, wps=211.9, ups=0.57, wpb=374.7, bsz=32, num_updates=2170, lr=9.98649e-06, gnorm=4.16, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=3879
2022-05-07 21:30:56 - progress_bar.py[line:272] - INFO: epoch 001:   2184 / 17711 loss=4.609, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=378, nsentences=32, sample_size=378, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.609, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=37.506, expert1_balance_bottom=14.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.64, wps=213.8, ups=0.57, wpb=378, bsz=32, num_updates=2180, lr=9.98348e-06, gnorm=3.815, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3897
2022-05-07 21:31:14 - progress_bar.py[line:272] - INFO: epoch 001:   2194 / 17711 loss=4.59, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=388.2, nsentences=32, sample_size=388.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885646, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.59, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.686, expert1_balance_bottom=15.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.57, wps=217.4, ups=0.56, wpb=388.2, bsz=32, num_updates=2190, lr=9.98048e-06, gnorm=3.914, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3915
2022-05-07 21:31:32 - progress_bar.py[line:272] - INFO: epoch 001:   2204 / 17711 loss=4.599, loss_v1=0, loss_v2=0, nll_loss=2.476, ntokens=383.3, nsentences=32, sample_size=383.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.599, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=35.834, expert1_balance_bottom=15.912, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.56, wps=216.8, ups=0.57, wpb=383.3, bsz=32, num_updates=2200, lr=9.97748e-06, gnorm=4.707, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3933
2022-05-07 21:31:49 - progress_bar.py[line:272] - INFO: epoch 001:   2214 / 17711 loss=4.622, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=383, nsentences=32, sample_size=383, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.622, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.167, expert1_balance_bottom=15.737, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.62, wps=219.4, ups=0.57, wpb=383, bsz=32, num_updates=2210, lr=9.97447e-06, gnorm=5.284, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3950
2022-05-07 21:32:07 - progress_bar.py[line:272] - INFO: epoch 001:   2224 / 17711 loss=4.529, loss_v1=0, loss_v2=0, nll_loss=2.402, ntokens=379.6, nsentences=32, sample_size=379.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894785, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.529, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=35.993, expert1_balance_bottom=15.619, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.29, wps=216.5, ups=0.57, wpb=379.6, bsz=32, num_updates=2220, lr=9.97147e-06, gnorm=4.066, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3968
2022-05-07 21:32:24 - progress_bar.py[line:272] - INFO: epoch 001:   2234 / 17711 loss=4.468, loss_v1=0, loss_v2=0, nll_loss=2.343, ntokens=389.5, nsentences=32, sample_size=389.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.468, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.124, expert1_balance_bottom=15.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.07, wps=222.4, ups=0.57, wpb=389.5, bsz=32, num_updates=2230, lr=9.96847e-06, gnorm=4.004, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=3985
2022-05-07 21:32:42 - progress_bar.py[line:272] - INFO: epoch 001:   2244 / 17711 loss=4.517, loss_v1=0, loss_v2=0, nll_loss=2.387, ntokens=380.9, nsentences=32, sample_size=380.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892038, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.517, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.525, expert1_balance_bottom=15.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.23, wps=218.2, ups=0.57, wpb=380.9, bsz=32, num_updates=2240, lr=9.96546e-06, gnorm=4.457, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4003
2022-05-07 21:32:59 - progress_bar.py[line:272] - INFO: epoch 001:   2254 / 17711 loss=4.669, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=379.2, nsentences=32, sample_size=379.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.669, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.481, expert1_balance_bottom=15.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.9, wps=219.8, ups=0.58, wpb=379.2, bsz=32, num_updates=2250, lr=9.96246e-06, gnorm=3.994, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4020
2022-05-07 21:33:17 - progress_bar.py[line:272] - INFO: epoch 001:   2264 / 17711 loss=4.572, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=380.9, nsentences=32, sample_size=380.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.572, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=35.832, expert1_balance_bottom=15.918, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.48, wps=217.4, ups=0.57, wpb=380.9, bsz=32, num_updates=2260, lr=9.95946e-06, gnorm=4.042, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4037
2022-05-07 21:33:34 - progress_bar.py[line:272] - INFO: epoch 001:   2274 / 17711 loss=4.583, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=377.9, nsentences=32, sample_size=377.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.583, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.486, expert1_balance_bottom=15.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.54, wps=215.9, ups=0.57, wpb=377.9, bsz=32, num_updates=2270, lr=9.95645e-06, gnorm=4.217, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4055
2022-05-07 21:33:52 - progress_bar.py[line:272] - INFO: epoch 001:   2284 / 17711 loss=4.584, loss_v1=0, loss_v2=0, nll_loss=2.463, ntokens=380, nsentences=32, sample_size=380, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.584, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.092, expert1_balance_bottom=15.664, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.51, wps=216.6, ups=0.57, wpb=380, bsz=32, num_updates=2280, lr=9.95345e-06, gnorm=4.168, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4072
2022-05-07 21:34:09 - progress_bar.py[line:272] - INFO: epoch 001:   2294 / 17711 loss=4.566, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=389.8, nsentences=32, sample_size=389.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895049, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.566, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.048, expert1_balance_bottom=15.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.46, wps=223.8, ups=0.57, wpb=389.8, bsz=32, num_updates=2290, lr=9.95045e-06, gnorm=4.083, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4090
2022-05-07 21:34:27 - progress_bar.py[line:272] - INFO: epoch 001:   2304 / 17711 loss=4.502, loss_v1=0, loss_v2=0, nll_loss=2.384, ntokens=381.4, nsentences=32, sample_size=381.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.502, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=37.229, expert1_balance_bottom=15.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.22, wps=216.5, ups=0.57, wpb=381.4, bsz=32, num_updates=2300, lr=9.94744e-06, gnorm=4.324, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4108
2022-05-07 21:34:44 - progress_bar.py[line:272] - INFO: epoch 001:   2314 / 17711 loss=4.492, loss_v1=0, loss_v2=0, nll_loss=2.355, ntokens=392.3, nsentences=32, sample_size=392.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886761, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.492, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.886, expert1_balance_bottom=15.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.12, wps=226.3, ups=0.58, wpb=392.3, bsz=32, num_updates=2310, lr=9.94444e-06, gnorm=3.882, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4125
2022-05-07 21:35:02 - progress_bar.py[line:272] - INFO: epoch 001:   2324 / 17711 loss=4.55, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=387.2, nsentences=32, sample_size=387.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.55, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.631, expert1_balance_bottom=15.88, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.49, wps=221.7, ups=0.57, wpb=387.2, bsz=32, num_updates=2320, lr=9.94144e-06, gnorm=3.693, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=4142
2022-05-07 21:35:19 - progress_bar.py[line:272] - INFO: epoch 001:   2334 / 17711 loss=4.613, loss_v1=0, loss_v2=0, nll_loss=2.493, ntokens=383.8, nsentences=32, sample_size=383.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.613, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=37.153, expert1_balance_bottom=15.157, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.63, wps=218.6, ups=0.57, wpb=383.8, bsz=32, num_updates=2330, lr=9.93843e-06, gnorm=3.969, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4160
2022-05-07 21:35:37 - progress_bar.py[line:272] - INFO: epoch 001:   2344 / 17711 loss=4.543, loss_v1=0, loss_v2=0, nll_loss=2.427, ntokens=384.3, nsentences=32, sample_size=384.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.543, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.189, expert1_balance_bottom=15.499, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.38, wps=217.5, ups=0.57, wpb=384.3, bsz=32, num_updates=2340, lr=9.93543e-06, gnorm=4.213, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4178
2022-05-07 21:35:54 - progress_bar.py[line:272] - INFO: epoch 001:   2354 / 17711 loss=4.506, loss_v1=0, loss_v2=0, nll_loss=2.404, ntokens=397.6, nsentences=32, sample_size=397.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867443, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.506, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=37.343, expert1_balance_bottom=15.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.29, wps=225.4, ups=0.57, wpb=397.6, bsz=32, num_updates=2350, lr=9.93243e-06, gnorm=3.712, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4195
2022-05-07 21:36:12 - progress_bar.py[line:272] - INFO: epoch 001:   2364 / 17711 loss=4.523, loss_v1=0, loss_v2=0, nll_loss=2.408, ntokens=384.7, nsentences=32, sample_size=384.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895304, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.523, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.02, expert1_balance_bottom=15.778, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.31, wps=217.8, ups=0.57, wpb=384.7, bsz=32, num_updates=2360, lr=9.92942e-06, gnorm=3.652, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4213
2022-05-07 21:36:30 - progress_bar.py[line:272] - INFO: epoch 001:   2374 / 17711 loss=4.498, loss_v1=0, loss_v2=0, nll_loss=2.359, ntokens=373.2, nsentences=32, sample_size=373.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.498, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.176, expert1_balance_bottom=15.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.13, wps=211.5, ups=0.57, wpb=373.2, bsz=32, num_updates=2370, lr=9.92642e-06, gnorm=3.919, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4230
2022-05-07 21:36:47 - progress_bar.py[line:272] - INFO: epoch 001:   2384 / 17711 loss=4.517, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=379.5, nsentences=32, sample_size=379.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.517, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.271, expert1_balance_bottom=15.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.27, wps=215.3, ups=0.57, wpb=379.5, bsz=32, num_updates=2380, lr=9.92342e-06, gnorm=4.311, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4248
2022-05-07 21:37:05 - progress_bar.py[line:272] - INFO: epoch 001:   2394 / 17711 loss=4.537, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=388.9, nsentences=32, sample_size=388.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.537, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=35.95, expert1_balance_bottom=15.664, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.37, wps=218.7, ups=0.56, wpb=388.9, bsz=32, num_updates=2390, lr=9.92041e-06, gnorm=3.503, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4266
2022-05-07 21:37:11 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-07 21:37:25 - progress_bar.py[line:272] - INFO: epoch 001:   2405 / 17711 loss=4.457, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=389.5, nsentences=32, sample_size=389.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888493, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.457, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.017, expert1_balance_bottom=15.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.02, wps=199.1, ups=0.51, wpb=389.5, bsz=32, num_updates=2400, lr=9.91741e-06, gnorm=4.04, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4285
2022-05-07 21:37:43 - progress_bar.py[line:272] - INFO: epoch 001:   2415 / 17711 loss=4.604, loss_v1=0, loss_v2=0, nll_loss=2.493, ntokens=380.2, nsentences=32, sample_size=380.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892528, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.604, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.262, expert1_balance_bottom=15.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.63, wps=211.8, ups=0.56, wpb=380.2, bsz=32, num_updates=2410, lr=9.91441e-06, gnorm=3.852, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4303
2022-05-07 21:38:00 - progress_bar.py[line:272] - INFO: epoch 001:   2425 / 17711 loss=4.573, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=378.7, nsentences=32, sample_size=378.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890665, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.573, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=36.279, expert1_balance_bottom=15.686, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.5, wps=214, ups=0.57, wpb=378.7, bsz=32, num_updates=2420, lr=9.9114e-06, gnorm=4.165, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4321
2022-05-07 21:38:18 - progress_bar.py[line:272] - INFO: epoch 001:   2435 / 17711 loss=4.561, loss_v1=0, loss_v2=0, nll_loss=2.435, ntokens=377.5, nsentences=32, sample_size=377.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.561, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.226, expert1_balance_bottom=15.677, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.41, wps=215.6, ups=0.57, wpb=377.5, bsz=32, num_updates=2430, lr=9.9084e-06, gnorm=4.048, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4339
2022-05-07 21:38:35 - progress_bar.py[line:272] - INFO: epoch 001:   2445 / 17711 loss=4.567, loss_v1=0, loss_v2=0, nll_loss=2.44, ntokens=384.9, nsentences=32, sample_size=384.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893342, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.567, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.645, expert1_balance_bottom=15.675, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.43, wps=219.5, ups=0.57, wpb=384.9, bsz=32, num_updates=2440, lr=9.9054e-06, gnorm=4.063, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4356
2022-05-07 21:38:53 - progress_bar.py[line:272] - INFO: epoch 001:   2455 / 17711 loss=4.497, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=378.8, nsentences=32, sample_size=378.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894931, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.497, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.088, expert1_balance_bottom=15.828, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.19, wps=215.2, ups=0.57, wpb=378.8, bsz=32, num_updates=2450, lr=9.90239e-06, gnorm=4.104, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4374
2022-05-07 21:39:11 - progress_bar.py[line:272] - INFO: epoch 001:   2465 / 17711 loss=4.504, loss_v1=0, loss_v2=0, nll_loss=2.37, ntokens=383.1, nsentences=32, sample_size=383.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.504, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.438, expert1_balance_bottom=15.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.17, wps=214.1, ups=0.56, wpb=383.1, bsz=32, num_updates=2460, lr=9.89939e-06, gnorm=4.572, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=4392
2022-05-07 21:39:29 - progress_bar.py[line:272] - INFO: epoch 001:   2475 / 17711 loss=4.556, loss_v1=0, loss_v2=0, nll_loss=2.439, ntokens=382.2, nsentences=32, sample_size=382.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.556, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.076, expert1_balance_bottom=15.77, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.42, wps=215.2, ups=0.56, wpb=382.2, bsz=32, num_updates=2470, lr=9.89639e-06, gnorm=4.133, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4409
2022-05-07 21:39:46 - progress_bar.py[line:272] - INFO: epoch 001:   2485 / 17711 loss=4.508, loss_v1=0, loss_v2=0, nll_loss=2.381, ntokens=388.2, nsentences=32, sample_size=388.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89654, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.508, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.662, expert1_balance_bottom=15.951, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.21, wps=221.6, ups=0.57, wpb=388.2, bsz=32, num_updates=2480, lr=9.89338e-06, gnorm=3.456, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4427
2022-05-07 21:40:04 - progress_bar.py[line:272] - INFO: epoch 001:   2495 / 17711 loss=4.492, loss_v1=0, loss_v2=0, nll_loss=2.369, ntokens=380.1, nsentences=32, sample_size=380.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.492, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.754, expert1_balance_bottom=16.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.17, wps=215, ups=0.57, wpb=380.1, bsz=32, num_updates=2490, lr=9.89038e-06, gnorm=3.946, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4445
2022-05-07 21:40:22 - progress_bar.py[line:272] - INFO: epoch 001:   2505 / 17711 loss=4.54, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=384.7, nsentences=32, sample_size=384.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.54, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.828, expert1_balance_bottom=15.438, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=5.39, wps=217.8, ups=0.57, wpb=384.7, bsz=32, num_updates=2500, lr=9.88738e-06, gnorm=4.111, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4462
2022-05-07 21:40:39 - progress_bar.py[line:272] - INFO: epoch 001:   2515 / 17711 loss=3.79, loss_v1=0, loss_v2=0, nll_loss=1.551, ntokens=377.7, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885981, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.79, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.669, expert1_balance_bottom=15.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.93, wps=214, ups=0.57, wpb=377.7, bsz=32, num_updates=2510, lr=9.88437e-06, gnorm=4.063, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4480
2022-05-07 21:40:57 - progress_bar.py[line:272] - INFO: epoch 001:   2525 / 17711 loss=3.624, loss_v1=0, loss_v2=0, nll_loss=1.322, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.624, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.667, expert1_balance_bottom=15.486, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.5, wps=217.2, ups=0.57, wpb=383.2, bsz=32, num_updates=2520, lr=9.88137e-06, gnorm=3.857, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4498
2022-05-07 21:41:15 - progress_bar.py[line:272] - INFO: epoch 001:   2535 / 17711 loss=3.703, loss_v1=0, loss_v2=0, nll_loss=1.442, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.703, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.475, expert1_balance_bottom=15.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.72, wps=215.6, ups=0.56, wpb=385.9, bsz=32, num_updates=2530, lr=9.87837e-06, gnorm=4.254, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4515
2022-05-07 21:41:32 - progress_bar.py[line:272] - INFO: epoch 001:   2545 / 17711 loss=3.711, loss_v1=0, loss_v2=0, nll_loss=1.438, ntokens=378.9, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.711, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.473, expert1_balance_bottom=16.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.71, wps=213, ups=0.56, wpb=378.9, bsz=32, num_updates=2540, lr=9.87536e-06, gnorm=3.813, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4533
2022-05-07 21:41:50 - progress_bar.py[line:272] - INFO: epoch 001:   2555 / 17711 loss=3.619, loss_v1=0, loss_v2=0, nll_loss=1.339, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899699, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.619, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.655, expert1_balance_bottom=15.904, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.53, wps=217.1, ups=0.57, wpb=382.4, bsz=32, num_updates=2550, lr=9.87236e-06, gnorm=3.681, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4551
2022-05-07 21:42:08 - progress_bar.py[line:272] - INFO: epoch 001:   2565 / 17711 loss=3.654, loss_v1=0, loss_v2=0, nll_loss=1.385, ntokens=374.4, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.654, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.326, expert1_balance_bottom=15.885, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.61, wps=211.1, ups=0.56, wpb=374.4, bsz=32, num_updates=2560, lr=9.86936e-06, gnorm=3.593, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4569
2022-05-07 21:42:26 - progress_bar.py[line:272] - INFO: epoch 001:   2575 / 17711 loss=3.574, loss_v1=0, loss_v2=0, nll_loss=1.306, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88546, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.574, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.729, expert1_balance_bottom=15.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.47, wps=216.9, ups=0.56, wpb=386.8, bsz=32, num_updates=2570, lr=9.86635e-06, gnorm=3.471, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4586
2022-05-07 21:42:43 - progress_bar.py[line:272] - INFO: epoch 001:   2585 / 17711 loss=3.583, loss_v1=0, loss_v2=0, nll_loss=1.29, ntokens=373.2, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90794, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.583, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.288, expert1_balance_bottom=16.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.44, wps=211.4, ups=0.57, wpb=373.2, bsz=32, num_updates=2580, lr=9.86335e-06, gnorm=3.69, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4604
2022-05-07 21:43:01 - progress_bar.py[line:272] - INFO: epoch 001:   2595 / 17711 loss=3.538, loss_v1=0, loss_v2=0, nll_loss=1.256, ntokens=377.3, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890121, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.538, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.322, expert1_balance_bottom=15.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.39, wps=215.2, ups=0.57, wpb=377.3, bsz=32, num_updates=2590, lr=9.86035e-06, gnorm=3.403, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4622
2022-05-07 21:43:19 - progress_bar.py[line:272] - INFO: epoch 001:   2605 / 17711 loss=3.654, loss_v1=0, loss_v2=0, nll_loss=1.397, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882129, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.654, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.589, expert1_balance_bottom=15.05, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.63, wps=214.3, ups=0.56, wpb=380.1, bsz=32, num_updates=2600, lr=9.85734e-06, gnorm=3.817, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4639
2022-05-07 21:43:36 - progress_bar.py[line:272] - INFO: epoch 001:   2615 / 17711 loss=3.612, loss_v1=0, loss_v2=0, nll_loss=1.352, ntokens=382.2, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889504, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.612, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.965, expert1_balance_bottom=15.671, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.55, wps=216.3, ups=0.57, wpb=382.2, bsz=32, num_updates=2610, lr=9.85434e-06, gnorm=4.293, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=4657
2022-05-07 21:43:54 - progress_bar.py[line:272] - INFO: epoch 001:   2625 / 17711 loss=3.652, loss_v1=0, loss_v2=0, nll_loss=1.385, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902379, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.652, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.437, expert1_balance_bottom=15.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.61, wps=217.4, ups=0.57, wpb=380.6, bsz=32, num_updates=2620, lr=9.85134e-06, gnorm=3.88, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4675
2022-05-07 21:44:11 - progress_bar.py[line:272] - INFO: epoch 001:   2635 / 17711 loss=3.643, loss_v1=0, loss_v2=0, nll_loss=1.36, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.643, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.563, expert1_balance_bottom=15.861, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.57, wps=217, ups=0.57, wpb=380.3, bsz=32, num_updates=2630, lr=9.84833e-06, gnorm=3.804, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4692
2022-05-07 21:44:29 - progress_bar.py[line:272] - INFO: epoch 001:   2645 / 17711 loss=3.553, loss_v1=0, loss_v2=0, nll_loss=1.279, ntokens=378, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897585, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.553, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.062, expert1_balance_bottom=15.779, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.43, wps=215.9, ups=0.57, wpb=378, bsz=32, num_updates=2640, lr=9.84533e-06, gnorm=3.855, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=4710
2022-05-07 21:44:47 - progress_bar.py[line:272] - INFO: epoch 001:   2655 / 17711 loss=3.565, loss_v1=0, loss_v2=0, nll_loss=1.291, ntokens=390.5, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.565, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.953, expert1_balance_bottom=15.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.45, wps=220.7, ups=0.57, wpb=390.5, bsz=32, num_updates=2650, lr=9.84233e-06, gnorm=3.974, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4727
2022-05-07 21:45:04 - progress_bar.py[line:272] - INFO: epoch 001:   2665 / 17711 loss=3.544, loss_v1=0, loss_v2=0, nll_loss=1.275, ntokens=375.3, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.544, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.409, expert1_balance_bottom=15.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.42, wps=211.8, ups=0.56, wpb=375.3, bsz=32, num_updates=2660, lr=9.83932e-06, gnorm=3.988, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4745
2022-05-07 21:45:22 - progress_bar.py[line:272] - INFO: epoch 001:   2675 / 17711 loss=3.63, loss_v1=0, loss_v2=0, nll_loss=1.374, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.63, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.946, expert1_balance_bottom=16.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.59, wps=217, ups=0.56, wpb=387.9, bsz=32, num_updates=2670, lr=9.83632e-06, gnorm=3.581, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4763
2022-05-07 21:45:40 - progress_bar.py[line:272] - INFO: epoch 001:   2685 / 17711 loss=3.545, loss_v1=0, loss_v2=0, nll_loss=1.287, ntokens=387.6, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88038, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.545, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.08, expert1_balance_bottom=15.853, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.44, wps=218.6, ups=0.56, wpb=387.6, bsz=32, num_updates=2680, lr=9.83332e-06, gnorm=3.539, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4781
2022-05-07 21:45:57 - progress_bar.py[line:272] - INFO: epoch 001:   2695 / 17711 loss=3.659, loss_v1=0, loss_v2=0, nll_loss=1.396, ntokens=370.5, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.659, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.842, expert1_balance_bottom=15.82, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.63, wps=209.9, ups=0.57, wpb=370.5, bsz=32, num_updates=2690, lr=9.83032e-06, gnorm=4.288, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4798
2022-05-07 21:46:15 - progress_bar.py[line:272] - INFO: epoch 001:   2705 / 17711 loss=3.581, loss_v1=0, loss_v2=0, nll_loss=1.298, ntokens=377.3, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.909325, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.581, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.14, expert1_balance_bottom=16.175, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.46, wps=212.4, ups=0.56, wpb=377.3, bsz=32, num_updates=2700, lr=9.82731e-06, gnorm=4.088, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4816
2022-05-07 21:46:33 - progress_bar.py[line:272] - INFO: epoch 001:   2715 / 17711 loss=3.607, loss_v1=0, loss_v2=0, nll_loss=1.333, ntokens=375, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893923, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.607, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.722, expert1_balance_bottom=16.059, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.52, wps=210.3, ups=0.56, wpb=375, bsz=32, num_updates=2710, lr=9.82431e-06, gnorm=3.442, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4834
2022-05-07 21:46:51 - progress_bar.py[line:272] - INFO: epoch 001:   2725 / 17711 loss=3.495, loss_v1=0, loss_v2=0, nll_loss=1.22, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887578, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.495, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.347, expert1_balance_bottom=16.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=218.8, ups=0.57, wpb=386, bsz=32, num_updates=2720, lr=9.82131e-06, gnorm=3.709, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4852
2022-05-07 21:47:09 - progress_bar.py[line:272] - INFO: epoch 001:   2735 / 17711 loss=3.596, loss_v1=0, loss_v2=0, nll_loss=1.359, ntokens=384, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.596, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.326, expert1_balance_bottom=15.871, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.57, wps=215.8, ups=0.56, wpb=384, bsz=32, num_updates=2730, lr=9.8183e-06, gnorm=3.875, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4869
2022-05-07 21:47:26 - progress_bar.py[line:272] - INFO: epoch 001:   2745 / 17711 loss=3.591, loss_v1=0, loss_v2=0, nll_loss=1.333, ntokens=386.7, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880299, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.591, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=36.25, expert1_balance_bottom=16.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.52, wps=217.6, ups=0.56, wpb=386.7, bsz=32, num_updates=2740, lr=9.8153e-06, gnorm=3.888, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4887
2022-05-07 21:47:44 - progress_bar.py[line:272] - INFO: epoch 001:   2755 / 17711 loss=3.54, loss_v1=0, loss_v2=0, nll_loss=1.281, ntokens=385.3, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.54, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.678, expert1_balance_bottom=16.093, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.43, wps=219.7, ups=0.57, wpb=385.3, bsz=32, num_updates=2750, lr=9.8123e-06, gnorm=3.68, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4905
2022-05-07 21:48:01 - progress_bar.py[line:272] - INFO: epoch 001:   2765 / 17711 loss=3.594, loss_v1=0, loss_v2=0, nll_loss=1.321, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.594, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.799, expert1_balance_bottom=16.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.5, wps=218.1, ups=0.57, wpb=383.4, bsz=32, num_updates=2760, lr=9.80929e-06, gnorm=3.626, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4922
2022-05-07 21:48:19 - progress_bar.py[line:272] - INFO: epoch 001:   2775 / 17711 loss=3.531, loss_v1=0, loss_v2=0, nll_loss=1.265, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.531, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.353, expert1_balance_bottom=15.88, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.4, wps=216.7, ups=0.57, wpb=380.6, bsz=32, num_updates=2770, lr=9.80629e-06, gnorm=3.529, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4940
2022-05-07 21:48:37 - progress_bar.py[line:272] - INFO: epoch 001:   2785 / 17711 loss=3.627, loss_v1=0, loss_v2=0, nll_loss=1.363, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.627, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.187, expert1_balance_bottom=15.907, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.57, wps=216.3, ups=0.57, wpb=381.8, bsz=32, num_updates=2780, lr=9.80329e-06, gnorm=4.25, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4957
2022-05-07 21:48:54 - progress_bar.py[line:272] - INFO: epoch 001:   2795 / 17711 loss=3.624, loss_v1=0, loss_v2=0, nll_loss=1.372, ntokens=379.2, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893688, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.624, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.928, expert1_balance_bottom=15.944, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.59, wps=218.4, ups=0.58, wpb=379.2, bsz=32, num_updates=2790, lr=9.80028e-06, gnorm=4.871, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=4975
2022-05-07 21:49:11 - progress_bar.py[line:272] - INFO: epoch 001:   2805 / 17711 loss=3.611, loss_v1=0, loss_v2=0, nll_loss=1.34, ntokens=381.4, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.611, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.145, expert1_balance_bottom=16.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.53, wps=218.3, ups=0.57, wpb=381.4, bsz=32, num_updates=2800, lr=9.79728e-06, gnorm=4.445, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=4992
2022-05-07 21:49:29 - progress_bar.py[line:272] - INFO: epoch 001:   2815 / 17711 loss=3.639, loss_v1=0, loss_v2=0, nll_loss=1.393, ntokens=383.2, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.639, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.072, expert1_balance_bottom=16.083, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.63, wps=219.1, ups=0.57, wpb=383.2, bsz=32, num_updates=2810, lr=9.79428e-06, gnorm=4.572, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5010
2022-05-07 21:49:46 - progress_bar.py[line:272] - INFO: epoch 001:   2825 / 17711 loss=3.559, loss_v1=0, loss_v2=0, nll_loss=1.294, ntokens=384.2, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.559, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.818, expert1_balance_bottom=16.009, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.45, wps=220.3, ups=0.57, wpb=384.2, bsz=32, num_updates=2820, lr=9.79127e-06, gnorm=4.05, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5027
2022-05-07 21:50:04 - progress_bar.py[line:272] - INFO: epoch 001:   2835 / 17711 loss=3.575, loss_v1=0, loss_v2=0, nll_loss=1.314, ntokens=374.7, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.575, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=35.76, expert1_balance_bottom=16.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.49, wps=213.2, ups=0.57, wpb=374.7, bsz=32, num_updates=2830, lr=9.78827e-06, gnorm=3.777, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5045
2022-05-07 21:50:21 - progress_bar.py[line:272] - INFO: epoch 001:   2845 / 17711 loss=3.586, loss_v1=0, loss_v2=0, nll_loss=1.319, ntokens=378.7, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897872, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.586, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.453, expert1_balance_bottom=16.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.49, wps=218.7, ups=0.58, wpb=378.7, bsz=32, num_updates=2840, lr=9.78527e-06, gnorm=3.982, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5062
2022-05-07 21:50:39 - progress_bar.py[line:272] - INFO: epoch 001:   2855 / 17711 loss=3.615, loss_v1=0, loss_v2=0, nll_loss=1.363, ntokens=385.2, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.615, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.479, expert1_balance_bottom=16.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.57, wps=220, ups=0.57, wpb=385.2, bsz=32, num_updates=2850, lr=9.78226e-06, gnorm=3.461, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5080
2022-05-07 21:50:57 - progress_bar.py[line:272] - INFO: epoch 001:   2865 / 17711 loss=3.516, loss_v1=0, loss_v2=0, nll_loss=1.251, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883264, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.516, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.962, expert1_balance_bottom=15.784, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.38, wps=209.4, ups=0.55, wpb=382.9, bsz=32, num_updates=2860, lr=9.77926e-06, gnorm=3.845, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5098
2022-05-07 21:51:15 - progress_bar.py[line:272] - INFO: epoch 001:   2875 / 17711 loss=3.598, loss_v1=0, loss_v2=0, nll_loss=1.365, ntokens=392.3, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.598, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.074, expert1_balance_bottom=15.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.58, wps=225.1, ups=0.57, wpb=392.3, bsz=32, num_updates=2870, lr=9.77626e-06, gnorm=3.885, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5115
2022-05-07 21:51:32 - progress_bar.py[line:272] - INFO: epoch 001:   2885 / 17711 loss=3.531, loss_v1=0, loss_v2=0, nll_loss=1.269, ntokens=376.7, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891135, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.531, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.47, expert1_balance_bottom=15.944, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.41, wps=213.7, ups=0.57, wpb=376.7, bsz=32, num_updates=2880, lr=9.77325e-06, gnorm=3.472, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=5133
2022-05-07 21:51:50 - progress_bar.py[line:272] - INFO: epoch 001:   2895 / 17711 loss=3.565, loss_v1=0, loss_v2=0, nll_loss=1.3, ntokens=373.2, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.565, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=34.424, expert1_balance_bottom=16.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.46, wps=209.9, ups=0.56, wpb=373.2, bsz=32, num_updates=2890, lr=9.77025e-06, gnorm=3.943, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5151
2022-05-07 21:52:08 - progress_bar.py[line:272] - INFO: epoch 001:   2905 / 17711 loss=3.546, loss_v1=0, loss_v2=0, nll_loss=1.294, ntokens=378.9, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.546, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.275, expert1_balance_bottom=16.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.45, wps=215, ups=0.57, wpb=378.9, bsz=32, num_updates=2900, lr=9.76725e-06, gnorm=4.304, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5168
2022-05-07 21:52:25 - progress_bar.py[line:272] - INFO: epoch 001:   2915 / 17711 loss=3.482, loss_v1=0, loss_v2=0, nll_loss=1.223, ntokens=373.2, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884049, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.482, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.826, expert1_balance_bottom=16.095, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=211.9, ups=0.57, wpb=373.2, bsz=32, num_updates=2910, lr=9.76424e-06, gnorm=4.002, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5186
2022-05-07 21:52:43 - progress_bar.py[line:272] - INFO: epoch 001:   2925 / 17711 loss=3.584, loss_v1=0, loss_v2=0, nll_loss=1.335, ntokens=393.3, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877155, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.584, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.01, expert1_balance_bottom=16.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.52, wps=221.1, ups=0.56, wpb=393.3, bsz=32, num_updates=2920, lr=9.76124e-06, gnorm=4.026, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5204
2022-05-07 21:53:01 - progress_bar.py[line:272] - INFO: epoch 001:   2935 / 17711 loss=3.532, loss_v1=0, loss_v2=0, nll_loss=1.256, ntokens=391.7, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.532, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.76, expert1_balance_bottom=16.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.39, wps=221.6, ups=0.57, wpb=391.7, bsz=32, num_updates=2930, lr=9.75824e-06, gnorm=4.042, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5221
2022-05-07 21:53:18 - progress_bar.py[line:272] - INFO: epoch 001:   2945 / 17711 loss=3.634, loss_v1=0, loss_v2=0, nll_loss=1.39, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.634, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.788, expert1_balance_bottom=16.12, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.62, wps=215.7, ups=0.56, wpb=382.1, bsz=32, num_updates=2940, lr=9.75523e-06, gnorm=4.205, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5239
2022-05-07 21:53:36 - progress_bar.py[line:272] - INFO: epoch 001:   2955 / 17711 loss=3.553, loss_v1=0, loss_v2=0, nll_loss=1.296, ntokens=370.3, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.553, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.064, expert1_balance_bottom=16.939, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.45, wps=210.1, ups=0.57, wpb=370.3, bsz=32, num_updates=2950, lr=9.75223e-06, gnorm=3.975, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5257
2022-05-07 21:53:54 - progress_bar.py[line:272] - INFO: epoch 001:   2965 / 17711 loss=3.473, loss_v1=0, loss_v2=0, nll_loss=1.202, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.473, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.442, expert1_balance_bottom=16.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.3, wps=212.7, ups=0.56, wpb=376.7, bsz=32, num_updates=2960, lr=9.74923e-06, gnorm=3.646, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5274
2022-05-07 21:54:11 - progress_bar.py[line:272] - INFO: epoch 001:   2975 / 17711 loss=3.567, loss_v1=0, loss_v2=0, nll_loss=1.316, ntokens=388.2, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.567, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.292, expert1_balance_bottom=16.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.49, wps=220.2, ups=0.57, wpb=388.2, bsz=32, num_updates=2970, lr=9.74622e-06, gnorm=3.922, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5292
2022-05-07 21:54:29 - progress_bar.py[line:272] - INFO: epoch 001:   2985 / 17711 loss=3.387, loss_v1=0, loss_v2=0, nll_loss=1.104, ntokens=380.7, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.387, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.376, expert1_balance_bottom=16.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=216.4, ups=0.57, wpb=380.7, bsz=32, num_updates=2980, lr=9.74322e-06, gnorm=4.25, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5310
2022-05-07 21:54:47 - progress_bar.py[line:272] - INFO: epoch 001:   2995 / 17711 loss=3.516, loss_v1=0, loss_v2=0, nll_loss=1.254, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.516, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.133, expert1_balance_bottom=16.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.38, wps=217.5, ups=0.56, wpb=386.8, bsz=32, num_updates=2990, lr=9.74022e-06, gnorm=4.761, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5327
2022-05-07 21:55:05 - progress_bar.py[line:272] - INFO: epoch 001:   3005 / 17711 loss=3.515, loss_v1=0, loss_v2=0, nll_loss=1.229, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.908135, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.515, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.116, expert1_balance_bottom=16.404, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.34, wps=212.3, ups=0.56, wpb=380.7, bsz=32, num_updates=3000, lr=9.73721e-06, gnorm=3.81, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5345
2022-05-07 21:55:08 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-07 21:55:24 - progress_bar.py[line:272] - INFO: epoch 001:   3016 / 17711 loss=3.427, loss_v1=0, loss_v2=0, nll_loss=1.16, ntokens=387.6, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.427, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.053, expert1_balance_bottom=15.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=194.9, ups=0.5, wpb=387.6, bsz=32, num_updates=3010, lr=9.73421e-06, gnorm=3.667, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5365
2022-05-07 21:55:42 - progress_bar.py[line:272] - INFO: epoch 001:   3026 / 17711 loss=3.502, loss_v1=0, loss_v2=0, nll_loss=1.244, ntokens=388.8, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.502, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.66, expert1_balance_bottom=16.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=217.4, ups=0.56, wpb=388.8, bsz=32, num_updates=3020, lr=9.73121e-06, gnorm=4.067, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5383
2022-05-07 21:56:00 - progress_bar.py[line:272] - INFO: epoch 001:   3036 / 17711 loss=3.493, loss_v1=0, loss_v2=0, nll_loss=1.246, ntokens=390.2, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87022, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.493, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.205, expert1_balance_bottom=16.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=221, ups=0.57, wpb=390.2, bsz=32, num_updates=3030, lr=9.7282e-06, gnorm=3.742, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5401
2022-05-07 21:56:18 - progress_bar.py[line:272] - INFO: epoch 001:   3046 / 17711 loss=3.525, loss_v1=0, loss_v2=0, nll_loss=1.268, ntokens=376.8, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.525, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.009, expert1_balance_bottom=16.392, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.41, wps=210.1, ups=0.56, wpb=376.8, bsz=32, num_updates=3040, lr=9.7252e-06, gnorm=4.3, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5419
2022-05-07 21:56:36 - progress_bar.py[line:272] - INFO: epoch 001:   3056 / 17711 loss=3.499, loss_v1=0, loss_v2=0, nll_loss=1.245, ntokens=390.8, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.499, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.811, expert1_balance_bottom=16.497, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=221.7, ups=0.57, wpb=390.8, bsz=32, num_updates=3050, lr=9.7222e-06, gnorm=3.395, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5436
2022-05-07 21:56:53 - progress_bar.py[line:272] - INFO: epoch 001:   3066 / 17711 loss=3.594, loss_v1=0, loss_v2=0, nll_loss=1.351, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887766, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.594, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.657, expert1_balance_bottom=16.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.55, wps=219.8, ups=0.57, wpb=383.4, bsz=32, num_updates=3060, lr=9.71919e-06, gnorm=3.871, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=5454
2022-05-07 21:57:11 - progress_bar.py[line:272] - INFO: epoch 001:   3076 / 17711 loss=3.563, loss_v1=0, loss_v2=0, nll_loss=1.315, ntokens=378.1, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880328, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.563, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.418, expert1_balance_bottom=16.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.49, wps=215.4, ups=0.57, wpb=378.1, bsz=32, num_updates=3070, lr=9.71619e-06, gnorm=3.881, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5471
2022-05-07 21:57:28 - progress_bar.py[line:272] - INFO: epoch 001:   3086 / 17711 loss=3.5, loss_v1=0, loss_v2=0, nll_loss=1.223, ntokens=377.7, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.907788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.5, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=34.972, expert1_balance_bottom=16.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=214.4, ups=0.57, wpb=377.7, bsz=32, num_updates=3080, lr=9.71319e-06, gnorm=4.574, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5489
2022-05-07 21:57:46 - progress_bar.py[line:272] - INFO: epoch 001:   3096 / 17711 loss=3.508, loss_v1=0, loss_v2=0, nll_loss=1.251, ntokens=375.3, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.508, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.384, expert1_balance_bottom=16.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.38, wps=211.4, ups=0.56, wpb=375.3, bsz=32, num_updates=3090, lr=9.71018e-06, gnorm=3.495, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5507
2022-05-07 21:58:04 - progress_bar.py[line:272] - INFO: epoch 001:   3106 / 17711 loss=3.499, loss_v1=0, loss_v2=0, nll_loss=1.243, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879862, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.499, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.736, expert1_balance_bottom=16.116, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=217.6, ups=0.57, wpb=383.8, bsz=32, num_updates=3100, lr=9.70718e-06, gnorm=3.922, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5524
2022-05-07 21:58:21 - progress_bar.py[line:272] - INFO: epoch 001:   3116 / 17711 loss=3.421, loss_v1=0, loss_v2=0, nll_loss=1.14, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898745, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.421, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.258, expert1_balance_bottom=16.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=217.9, ups=0.57, wpb=383.8, bsz=32, num_updates=3110, lr=9.70418e-06, gnorm=3.792, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5542
2022-05-07 21:58:39 - progress_bar.py[line:272] - INFO: epoch 001:   3126 / 17711 loss=3.504, loss_v1=0, loss_v2=0, nll_loss=1.247, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889677, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.504, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.164, expert1_balance_bottom=16.593, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=216.5, ups=0.57, wpb=382.3, bsz=32, num_updates=3120, lr=9.70117e-06, gnorm=3.809, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5560
2022-05-07 21:58:57 - progress_bar.py[line:272] - INFO: epoch 001:   3136 / 17711 loss=3.558, loss_v1=0, loss_v2=0, nll_loss=1.304, ntokens=376.2, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893892, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.558, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.073, expert1_balance_bottom=16.786, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.47, wps=209.1, ups=0.56, wpb=376.2, bsz=32, num_updates=3130, lr=9.69817e-06, gnorm=5.099, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5578
2022-05-07 21:59:15 - progress_bar.py[line:272] - INFO: epoch 001:   3146 / 17711 loss=3.568, loss_v1=0, loss_v2=0, nll_loss=1.331, ntokens=379, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.568, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.221, expert1_balance_bottom=16.706, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.51, wps=213.2, ups=0.56, wpb=379, bsz=32, num_updates=3140, lr=9.69517e-06, gnorm=3.811, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5595
2022-05-07 21:59:32 - progress_bar.py[line:272] - INFO: epoch 001:   3156 / 17711 loss=3.478, loss_v1=0, loss_v2=0, nll_loss=1.226, ntokens=376.8, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.478, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=35.455, expert1_balance_bottom=16.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.34, wps=213.2, ups=0.57, wpb=376.8, bsz=32, num_updates=3150, lr=9.69216e-06, gnorm=3.688, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5613
2022-05-07 21:59:50 - progress_bar.py[line:272] - INFO: epoch 001:   3166 / 17711 loss=3.5, loss_v1=0, loss_v2=0, nll_loss=1.228, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.5, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.286, expert1_balance_bottom=16.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.34, wps=217, ups=0.57, wpb=381.7, bsz=32, num_updates=3160, lr=9.68916e-06, gnorm=4.839, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5631
2022-05-07 22:00:08 - progress_bar.py[line:272] - INFO: epoch 001:   3176 / 17711 loss=3.417, loss_v1=0, loss_v2=0, nll_loss=1.154, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.417, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.525, expert1_balance_bottom=16.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=213.9, ups=0.57, wpb=377.9, bsz=32, num_updates=3170, lr=9.68616e-06, gnorm=4.134, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5648
2022-05-07 22:00:26 - progress_bar.py[line:272] - INFO: epoch 001:   3186 / 17711 loss=3.509, loss_v1=0, loss_v2=0, nll_loss=1.263, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887852, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.509, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.669, expert1_balance_bottom=16.291, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.4, wps=214.8, ups=0.56, wpb=386.3, bsz=32, num_updates=3180, lr=9.68315e-06, gnorm=3.748, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5666
2022-05-07 22:00:44 - progress_bar.py[line:272] - INFO: epoch 001:   3196 / 17711 loss=3.493, loss_v1=0, loss_v2=0, nll_loss=1.23, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.493, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.403, expert1_balance_bottom=16.522, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.35, wps=211.6, ups=0.55, wpb=385, bsz=32, num_updates=3190, lr=9.68015e-06, gnorm=3.685, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5685
2022-05-07 22:01:02 - progress_bar.py[line:272] - INFO: epoch 001:   3206 / 17711 loss=3.497, loss_v1=0, loss_v2=0, nll_loss=1.246, ntokens=384.7, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.497, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.573, expert1_balance_bottom=16.171, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=210.2, ups=0.55, wpb=384.7, bsz=32, num_updates=3200, lr=9.67715e-06, gnorm=3.709, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5703
2022-05-07 22:01:20 - progress_bar.py[line:272] - INFO: epoch 001:   3216 / 17711 loss=3.484, loss_v1=0, loss_v2=0, nll_loss=1.217, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888973, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.484, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.178, expert1_balance_bottom=16.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=210.3, ups=0.55, wpb=383.7, bsz=32, num_updates=3210, lr=9.67414e-06, gnorm=3.925, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5721
2022-05-07 22:01:38 - progress_bar.py[line:272] - INFO: epoch 001:   3226 / 17711 loss=3.558, loss_v1=0, loss_v2=0, nll_loss=1.336, ntokens=386.8, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871095, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.558, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=36.251, expert1_balance_bottom=16.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.52, wps=216.5, ups=0.56, wpb=386.8, bsz=32, num_updates=3220, lr=9.67114e-06, gnorm=4.431, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5739
2022-05-07 22:01:57 - progress_bar.py[line:272] - INFO: epoch 001:   3236 / 17711 loss=3.534, loss_v1=0, loss_v2=0, nll_loss=1.285, ntokens=385.5, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.534, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.804, expert1_balance_bottom=16.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.44, wps=202.7, ups=0.53, wpb=385.5, bsz=32, num_updates=3230, lr=9.66814e-06, gnorm=4.007, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5758
2022-05-07 22:02:16 - progress_bar.py[line:272] - INFO: epoch 001:   3246 / 17711 loss=3.583, loss_v1=0, loss_v2=0, nll_loss=1.333, ntokens=390.2, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.583, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.491, expert1_balance_bottom=16.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.52, wps=207.7, ups=0.53, wpb=390.2, bsz=32, num_updates=3240, lr=9.66513e-06, gnorm=3.593, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5777
2022-05-07 22:02:35 - progress_bar.py[line:272] - INFO: epoch 001:   3256 / 17711 loss=3.499, loss_v1=0, loss_v2=0, nll_loss=1.246, ntokens=377.5, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.499, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.62, expert1_balance_bottom=16.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=196.1, ups=0.52, wpb=377.5, bsz=32, num_updates=3250, lr=9.66213e-06, gnorm=3.715, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5796
2022-05-07 22:02:54 - progress_bar.py[line:272] - INFO: epoch 001:   3266 / 17711 loss=3.509, loss_v1=0, loss_v2=0, nll_loss=1.242, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.509, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.802, expert1_balance_bottom=15.941, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=202.6, ups=0.53, wpb=384.1, bsz=32, num_updates=3260, lr=9.65913e-06, gnorm=3.532, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5815
2022-05-07 22:03:13 - progress_bar.py[line:272] - INFO: epoch 001:   3276 / 17711 loss=3.472, loss_v1=0, loss_v2=0, nll_loss=1.207, ntokens=394.1, nsentences=32, sample_size=314, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.472, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=34.77, expert1_balance_bottom=16.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=205.5, ups=0.52, wpb=394.1, bsz=32, num_updates=3270, lr=9.65613e-06, gnorm=3.409, loss_scale=64, train_wall=18, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5834
2022-05-07 22:03:31 - progress_bar.py[line:272] - INFO: epoch 001:   3286 / 17711 loss=3.496, loss_v1=0, loss_v2=0, nll_loss=1.238, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893818, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.496, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.102, expert1_balance_bottom=16.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=217.9, ups=0.57, wpb=384.9, bsz=32, num_updates=3280, lr=9.65312e-06, gnorm=3.519, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5852
2022-05-07 22:03:49 - progress_bar.py[line:272] - INFO: epoch 001:   3296 / 17711 loss=3.531, loss_v1=0, loss_v2=0, nll_loss=1.274, ntokens=382, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892746, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.531, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.157, expert1_balance_bottom=16.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.42, wps=214.2, ups=0.56, wpb=382, bsz=32, num_updates=3290, lr=9.65012e-06, gnorm=4.638, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5870
2022-05-07 22:04:06 - progress_bar.py[line:272] - INFO: epoch 001:   3306 / 17711 loss=3.504, loss_v1=0, loss_v2=0, nll_loss=1.253, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.504, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.303, expert1_balance_bottom=16.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.38, wps=218, ups=0.57, wpb=380.8, bsz=32, num_updates=3300, lr=9.64712e-06, gnorm=3.987, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5887
2022-05-07 22:04:24 - progress_bar.py[line:272] - INFO: epoch 001:   3316 / 17711 loss=3.434, loss_v1=0, loss_v2=0, nll_loss=1.155, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.434, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.208, expert1_balance_bottom=16.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=221, ups=0.57, wpb=388.1, bsz=32, num_updates=3310, lr=9.64411e-06, gnorm=4.016, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=5905
2022-05-07 22:04:42 - progress_bar.py[line:272] - INFO: epoch 001:   3326 / 17711 loss=3.512, loss_v1=0, loss_v2=0, nll_loss=1.255, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892687, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.512, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.098, expert1_balance_bottom=16.61, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.39, wps=213.2, ups=0.56, wpb=378.5, bsz=32, num_updates=3320, lr=9.64111e-06, gnorm=3.914, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5922
2022-05-07 22:05:00 - progress_bar.py[line:272] - INFO: epoch 001:   3336 / 17711 loss=3.455, loss_v1=0, loss_v2=0, nll_loss=1.195, ntokens=375.3, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.455, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.027, expert1_balance_bottom=16.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=210.3, ups=0.56, wpb=375.3, bsz=32, num_updates=3330, lr=9.63811e-06, gnorm=4.005, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5940
2022-05-07 22:05:17 - progress_bar.py[line:272] - INFO: epoch 001:   3346 / 17711 loss=3.433, loss_v1=0, loss_v2=0, nll_loss=1.166, ntokens=376, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.433, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.534, expert1_balance_bottom=16.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=210, ups=0.56, wpb=376, bsz=32, num_updates=3340, lr=9.6351e-06, gnorm=3.349, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5958
2022-05-07 22:05:35 - progress_bar.py[line:272] - INFO: epoch 001:   3356 / 17711 loss=3.582, loss_v1=0, loss_v2=0, nll_loss=1.346, ntokens=377.8, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.582, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.198, expert1_balance_bottom=16.578, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.54, wps=213.4, ups=0.56, wpb=377.8, bsz=32, num_updates=3350, lr=9.6321e-06, gnorm=4.373, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5976
2022-05-07 22:05:53 - progress_bar.py[line:272] - INFO: epoch 001:   3366 / 17711 loss=3.53, loss_v1=0, loss_v2=0, nll_loss=1.28, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891148, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.53, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=34.996, expert1_balance_bottom=16.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.43, wps=219.1, ups=0.57, wpb=383, bsz=32, num_updates=3360, lr=9.6291e-06, gnorm=3.932, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=5993
2022-05-07 22:06:10 - progress_bar.py[line:272] - INFO: epoch 001:   3376 / 17711 loss=3.488, loss_v1=0, loss_v2=0, nll_loss=1.236, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.488, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=34.832, expert1_balance_bottom=16.856, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=218.8, ups=0.57, wpb=383.9, bsz=32, num_updates=3370, lr=9.62609e-06, gnorm=3.433, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6011
2022-05-07 22:06:28 - progress_bar.py[line:272] - INFO: epoch 001:   3386 / 17711 loss=3.589, loss_v1=0, loss_v2=0, nll_loss=1.342, ntokens=379.8, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.589, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.552, expert1_balance_bottom=16.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.53, wps=215.5, ups=0.57, wpb=379.8, bsz=32, num_updates=3380, lr=9.62309e-06, gnorm=3.649, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6029
2022-05-07 22:06:45 - progress_bar.py[line:272] - INFO: epoch 001:   3396 / 17711 loss=3.483, loss_v1=0, loss_v2=0, nll_loss=1.237, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885094, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.483, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.572, expert1_balance_bottom=16.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=217.1, ups=0.56, wpb=384.5, bsz=32, num_updates=3390, lr=9.62009e-06, gnorm=3.5, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6046
2022-05-07 22:07:03 - progress_bar.py[line:272] - INFO: epoch 001:   3406 / 17711 loss=3.414, loss_v1=0, loss_v2=0, nll_loss=1.165, ntokens=386.8, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.414, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.538, expert1_balance_bottom=16.647, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=220.6, ups=0.57, wpb=386.8, bsz=32, num_updates=3400, lr=9.61708e-06, gnorm=3.978, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6064
2022-05-07 22:07:21 - progress_bar.py[line:272] - INFO: epoch 001:   3416 / 17711 loss=3.512, loss_v1=0, loss_v2=0, nll_loss=1.266, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.512, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=35.375, expert1_balance_bottom=16.646, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.41, wps=219, ups=0.57, wpb=384.7, bsz=32, num_updates=3410, lr=9.61408e-06, gnorm=3.539, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=6081
2022-05-07 22:07:38 - progress_bar.py[line:272] - INFO: epoch 001:   3426 / 17711 loss=3.585, loss_v1=0, loss_v2=0, nll_loss=1.357, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.585, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=34.898, expert1_balance_bottom=16.797, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.56, wps=218.5, ups=0.58, wpb=379.6, bsz=32, num_updates=3420, lr=9.61108e-06, gnorm=3.693, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6099
2022-05-07 22:07:56 - progress_bar.py[line:272] - INFO: epoch 001:   3436 / 17711 loss=3.51, loss_v1=0, loss_v2=0, nll_loss=1.262, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.51, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=34.83, expert1_balance_bottom=16.783, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.4, wps=217.9, ups=0.57, wpb=383.3, bsz=32, num_updates=3430, lr=9.60807e-06, gnorm=3.48, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6116
2022-05-07 22:08:13 - progress_bar.py[line:272] - INFO: epoch 001:   3446 / 17711 loss=3.461, loss_v1=0, loss_v2=0, nll_loss=1.197, ntokens=378.5, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898135, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.461, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.311, expert1_balance_bottom=17.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=218, ups=0.58, wpb=378.5, bsz=32, num_updates=3440, lr=9.60507e-06, gnorm=3.861, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6134
2022-05-07 22:08:31 - progress_bar.py[line:272] - INFO: epoch 001:   3456 / 17711 loss=3.535, loss_v1=0, loss_v2=0, nll_loss=1.288, ntokens=388.7, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890834, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.535, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.975, expert1_balance_bottom=16.704, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.44, wps=219.9, ups=0.57, wpb=388.7, bsz=32, num_updates=3450, lr=9.60207e-06, gnorm=3.767, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6151
2022-05-07 22:08:48 - progress_bar.py[line:272] - INFO: epoch 001:   3466 / 17711 loss=3.409, loss_v1=0, loss_v2=0, nll_loss=1.152, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.409, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.591, expert1_balance_bottom=16.848, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=217.9, ups=0.57, wpb=379.5, bsz=32, num_updates=3460, lr=9.59906e-06, gnorm=3.324, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6169
2022-05-07 22:09:05 - progress_bar.py[line:272] - INFO: epoch 001:   3476 / 17711 loss=3.439, loss_v1=0, loss_v2=0, nll_loss=1.196, ntokens=385.9, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.439, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.889, expert1_balance_bottom=16.492, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=223.3, ups=0.58, wpb=385.9, bsz=32, num_updates=3470, lr=9.59606e-06, gnorm=3.514, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6186
2022-05-07 22:09:23 - progress_bar.py[line:272] - INFO: epoch 001:   3486 / 17711 loss=3.487, loss_v1=0, loss_v2=0, nll_loss=1.216, ntokens=375.7, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903383, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.487, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.409, expert1_balance_bottom=16.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=212, ups=0.56, wpb=375.7, bsz=32, num_updates=3480, lr=9.59306e-06, gnorm=3.644, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=6204
2022-05-07 22:09:41 - progress_bar.py[line:272] - INFO: epoch 001:   3496 / 17711 loss=3.5, loss_v1=0, loss_v2=0, nll_loss=1.247, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897747, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.5, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.115, expert1_balance_bottom=16.626, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=218.6, ups=0.57, wpb=382.8, bsz=32, num_updates=3490, lr=9.59005e-06, gnorm=3.919, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6221
2022-05-07 22:09:58 - progress_bar.py[line:272] - INFO: epoch 001:   3506 / 17711 loss=3.462, loss_v1=0, loss_v2=0, nll_loss=1.218, ntokens=388.8, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.462, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.413, expert1_balance_bottom=16.605, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=218.9, ups=0.56, wpb=388.8, bsz=32, num_updates=3500, lr=9.58705e-06, gnorm=3.687, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6239
2022-05-07 22:10:16 - progress_bar.py[line:272] - INFO: epoch 001:   3516 / 17711 loss=3.417, loss_v1=0, loss_v2=0, nll_loss=1.151, ntokens=374.3, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.417, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.057, expert1_balance_bottom=16.666, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=214.5, ups=0.57, wpb=374.3, bsz=32, num_updates=3510, lr=9.58405e-06, gnorm=3.994, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6257
2022-05-07 22:10:33 - progress_bar.py[line:272] - INFO: epoch 001:   3526 / 17711 loss=3.523, loss_v1=0, loss_v2=0, nll_loss=1.268, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890116, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.523, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.41, expert1_balance_bottom=16.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.41, wps=215.1, ups=0.57, wpb=377.9, bsz=32, num_updates=3520, lr=9.58104e-06, gnorm=4.058, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6274
2022-05-07 22:10:51 - progress_bar.py[line:272] - INFO: epoch 001:   3536 / 17711 loss=3.445, loss_v1=0, loss_v2=0, nll_loss=1.18, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897563, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.445, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.023, expert1_balance_bottom=16.813, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=221.5, ups=0.58, wpb=383.8, bsz=32, num_updates=3530, lr=9.57804e-06, gnorm=4.284, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6291
2022-05-07 22:11:08 - progress_bar.py[line:272] - INFO: epoch 001:   3546 / 17711 loss=3.511, loss_v1=0, loss_v2=0, nll_loss=1.27, ntokens=384.6, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.511, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.984, expert1_balance_bottom=16.591, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.41, wps=221, ups=0.57, wpb=384.6, bsz=32, num_updates=3540, lr=9.57504e-06, gnorm=4.293, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6309
2022-05-07 22:11:25 - progress_bar.py[line:272] - INFO: epoch 001:   3556 / 17711 loss=3.533, loss_v1=0, loss_v2=0, nll_loss=1.284, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.533, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.09, expert1_balance_bottom=16.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.44, wps=220.5, ups=0.58, wpb=382.8, bsz=32, num_updates=3550, lr=9.57203e-06, gnorm=3.813, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6326
2022-05-07 22:11:43 - progress_bar.py[line:272] - INFO: epoch 001:   3566 / 17711 loss=3.395, loss_v1=0, loss_v2=0, nll_loss=1.154, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881053, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.395, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.27, expert1_balance_bottom=16.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=219.5, ups=0.57, wpb=382.4, bsz=32, num_updates=3560, lr=9.56903e-06, gnorm=3.537, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6344
2022-05-07 22:12:00 - progress_bar.py[line:272] - INFO: epoch 001:   3576 / 17711 loss=3.48, loss_v1=0, loss_v2=0, nll_loss=1.226, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886429, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.48, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.448, expert1_balance_bottom=16.7, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.34, wps=218.5, ups=0.57, wpb=384.8, bsz=32, num_updates=3570, lr=9.56603e-06, gnorm=3.696, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6361
2022-05-07 22:12:18 - progress_bar.py[line:272] - INFO: epoch 001:   3586 / 17711 loss=3.487, loss_v1=0, loss_v2=0, nll_loss=1.238, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891128, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.487, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.652, expert1_balance_bottom=16.551, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=217.7, ups=0.57, wpb=383.9, bsz=32, num_updates=3580, lr=9.56302e-06, gnorm=3.702, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=6379
2022-05-07 22:12:36 - progress_bar.py[line:272] - INFO: epoch 001:   3596 / 17711 loss=3.53, loss_v1=0, loss_v2=0, nll_loss=1.284, ntokens=378.8, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.53, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.701, expert1_balance_bottom=16.886, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.43, wps=212, ups=0.56, wpb=378.8, bsz=32, num_updates=3590, lr=9.56002e-06, gnorm=3.845, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=6397
2022-05-07 22:12:53 - progress_bar.py[line:272] - INFO: epoch 001:   3606 / 17711 loss=3.446, loss_v1=0, loss_v2=0, nll_loss=1.187, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.446, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.224, expert1_balance_bottom=16.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.28, wps=219, ups=0.57, wpb=383.2, bsz=32, num_updates=3600, lr=9.55702e-06, gnorm=3.331, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6414
2022-05-07 22:13:11 - progress_bar.py[line:272] - INFO: epoch 001:   3616 / 17711 loss=3.397, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=380.9, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.397, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.463, expert1_balance_bottom=16.775, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=215.5, ups=0.57, wpb=380.9, bsz=32, num_updates=3610, lr=9.55401e-06, gnorm=3.233, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6432
2022-05-07 22:13:29 - progress_bar.py[line:272] - INFO: epoch 001:   3626 / 17711 loss=3.511, loss_v1=0, loss_v2=0, nll_loss=1.278, ntokens=381.3, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.511, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.336, expert1_balance_bottom=16.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.43, wps=213.3, ups=0.56, wpb=381.3, bsz=32, num_updates=3620, lr=9.55101e-06, gnorm=3.727, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6450
2022-05-07 22:13:47 - progress_bar.py[line:272] - INFO: epoch 001:   3636 / 17711 loss=3.498, loss_v1=0, loss_v2=0, nll_loss=1.253, ntokens=390.4, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.498, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.897, expert1_balance_bottom=16.831, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.38, wps=221.8, ups=0.57, wpb=390.4, bsz=32, num_updates=3630, lr=9.54801e-06, gnorm=3.859, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6467
2022-05-07 22:14:04 - progress_bar.py[line:272] - INFO: epoch 001:   3646 / 17711 loss=3.532, loss_v1=0, loss_v2=0, nll_loss=1.285, ntokens=384.8, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.532, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.022, expert1_balance_bottom=17.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.44, wps=215.9, ups=0.56, wpb=384.8, bsz=32, num_updates=3640, lr=9.545e-06, gnorm=4.014, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=6485
2022-05-07 22:14:22 - progress_bar.py[line:272] - INFO: epoch 001:   3656 / 17711 loss=3.431, loss_v1=0, loss_v2=0, nll_loss=1.183, ntokens=379.3, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889939, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.431, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.316, expert1_balance_bottom=16.724, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=214.7, ups=0.57, wpb=379.3, bsz=32, num_updates=3650, lr=9.542e-06, gnorm=3.925, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6503
2022-05-07 22:14:40 - progress_bar.py[line:272] - INFO: epoch 001:   3666 / 17711 loss=3.435, loss_v1=0, loss_v2=0, nll_loss=1.168, ntokens=392.3, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89012, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.435, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.98, expert1_balance_bottom=16.762, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.25, wps=222.1, ups=0.57, wpb=392.3, bsz=32, num_updates=3660, lr=9.539e-06, gnorm=3.456, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=6521
2022-05-07 22:14:57 - progress_bar.py[line:272] - INFO: epoch 001:   3676 / 17711 loss=3.467, loss_v1=0, loss_v2=0, nll_loss=1.214, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898811, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.467, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=34.582, expert1_balance_bottom=17.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=214.9, ups=0.57, wpb=378.1, bsz=32, num_updates=3670, lr=9.53599e-06, gnorm=3.813, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6538
2022-05-07 22:15:15 - progress_bar.py[line:272] - INFO: epoch 001:   3686 / 17711 loss=3.423, loss_v1=0, loss_v2=0, nll_loss=1.175, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881293, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.423, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=35.135, expert1_balance_bottom=16.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=216.1, ups=0.57, wpb=379, bsz=32, num_updates=3680, lr=9.53299e-06, gnorm=4.078, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=6556
2022-05-07 22:15:33 - progress_bar.py[line:272] - INFO: epoch 001:   3696 / 17711 loss=3.434, loss_v1=0, loss_v2=0, nll_loss=1.176, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.434, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.428, expert1_balance_bottom=16.892, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=215.9, ups=0.57, wpb=381.7, bsz=32, num_updates=3690, lr=9.52999e-06, gnorm=4.126, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6573
2022-05-07 22:15:51 - progress_bar.py[line:272] - INFO: epoch 001:   3706 / 17711 loss=3.429, loss_v1=0, loss_v2=0, nll_loss=1.166, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900604, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.429, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=34.863, expert1_balance_bottom=17.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=211.7, ups=0.56, wpb=380.5, bsz=32, num_updates=3700, lr=9.52698e-06, gnorm=3.634, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6591
2022-05-07 22:16:08 - progress_bar.py[line:272] - INFO: epoch 001:   3716 / 17711 loss=3.476, loss_v1=0, loss_v2=0, nll_loss=1.24, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.476, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.949, expert1_balance_bottom=16.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=219, ups=0.57, wpb=382.3, bsz=32, num_updates=3710, lr=9.52398e-06, gnorm=3.404, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6609
2022-05-07 22:16:26 - progress_bar.py[line:272] - INFO: epoch 001:   3726 / 17711 loss=3.476, loss_v1=0, loss_v2=0, nll_loss=1.234, ntokens=387.4, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.476, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.4, expert1_balance_bottom=16.803, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.35, wps=219.8, ups=0.57, wpb=387.4, bsz=32, num_updates=3720, lr=9.52098e-06, gnorm=3.684, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6626
2022-05-07 22:16:43 - progress_bar.py[line:272] - INFO: epoch 001:   3736 / 17711 loss=3.526, loss_v1=0, loss_v2=0, nll_loss=1.275, ntokens=381.8, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895065, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.526, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.379, expert1_balance_bottom=16.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.42, wps=214.6, ups=0.56, wpb=381.8, bsz=32, num_updates=3730, lr=9.51797e-06, gnorm=3.761, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6644
2022-05-07 22:17:01 - progress_bar.py[line:272] - INFO: epoch 001:   3746 / 17711 loss=3.523, loss_v1=0, loss_v2=0, nll_loss=1.286, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.523, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.161, expert1_balance_bottom=16.548, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.44, wps=217.5, ups=0.57, wpb=381.7, bsz=32, num_updates=3740, lr=9.51497e-06, gnorm=3.355, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6662
2022-05-07 22:17:19 - progress_bar.py[line:272] - INFO: epoch 001:   3756 / 17711 loss=3.451, loss_v1=0, loss_v2=0, nll_loss=1.194, ntokens=389.6, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.451, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=34.877, expert1_balance_bottom=16.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=221.7, ups=0.57, wpb=389.6, bsz=32, num_updates=3750, lr=9.51197e-06, gnorm=3.653, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=6679
2022-05-07 22:17:36 - progress_bar.py[line:272] - INFO: epoch 001:   3766 / 17711 loss=3.462, loss_v1=0, loss_v2=0, nll_loss=1.212, ntokens=391.6, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890973, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.462, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=34.68, expert1_balance_bottom=17.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=222, ups=0.57, wpb=391.6, bsz=32, num_updates=3760, lr=9.50896e-06, gnorm=4.408, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6697
2022-05-07 22:17:54 - progress_bar.py[line:272] - INFO: epoch 001:   3776 / 17711 loss=3.485, loss_v1=0, loss_v2=0, nll_loss=1.241, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.485, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=34.667, expert1_balance_bottom=16.961, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=217.6, ups=0.56, wpb=386.2, bsz=32, num_updates=3770, lr=9.50596e-06, gnorm=3.909, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6715
2022-05-07 22:18:12 - progress_bar.py[line:272] - INFO: epoch 001:   3786 / 17711 loss=3.455, loss_v1=0, loss_v2=0, nll_loss=1.217, ntokens=381.6, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885234, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.455, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.166, expert1_balance_bottom=16.888, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=215.5, ups=0.56, wpb=381.6, bsz=32, num_updates=3780, lr=9.50296e-06, gnorm=3.59, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6732
2022-05-07 22:18:29 - progress_bar.py[line:272] - INFO: epoch 001:   3796 / 17711 loss=3.459, loss_v1=0, loss_v2=0, nll_loss=1.209, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.459, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.167, expert1_balance_bottom=16.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=213.2, ups=0.56, wpb=379.2, bsz=32, num_updates=3790, lr=9.49995e-06, gnorm=3.888, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6750
2022-05-07 22:18:48 - progress_bar.py[line:272] - INFO: epoch 001:   3806 / 17711 loss=3.444, loss_v1=0, loss_v2=0, nll_loss=1.196, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886177, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.444, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.116, expert1_balance_bottom=16.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=207.4, ups=0.55, wpb=377.2, bsz=32, num_updates=3800, lr=9.49695e-06, gnorm=3.736, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6768
2022-05-07 22:19:06 - progress_bar.py[line:272] - INFO: epoch 001:   3816 / 17711 loss=3.403, loss_v1=0, loss_v2=0, nll_loss=1.146, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889192, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.403, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.112, expert1_balance_bottom=16.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=209.3, ups=0.55, wpb=381.8, bsz=32, num_updates=3810, lr=9.49395e-06, gnorm=3.268, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6787
2022-05-07 22:19:24 - progress_bar.py[line:272] - INFO: epoch 001:   3826 / 17711 loss=3.479, loss_v1=0, loss_v2=0, nll_loss=1.245, ntokens=383.8, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87874, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.479, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.386, expert1_balance_bottom=16.834, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=206.3, ups=0.54, wpb=383.8, bsz=32, num_updates=3820, lr=9.49095e-06, gnorm=3.59, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6805
2022-05-07 22:19:43 - progress_bar.py[line:272] - INFO: epoch 001:   3836 / 17711 loss=3.405, loss_v1=0, loss_v2=0, nll_loss=1.166, ntokens=389.7, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882084, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.405, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.08, expert1_balance_bottom=17.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=212.3, ups=0.54, wpb=389.7, bsz=32, num_updates=3830, lr=9.48794e-06, gnorm=3.226, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6824
2022-05-07 22:20:01 - progress_bar.py[line:272] - INFO: epoch 001:   3846 / 17711 loss=3.403, loss_v1=0, loss_v2=0, nll_loss=1.15, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890378, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.403, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.466, expert1_balance_bottom=16.879, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=210.8, ups=0.54, wpb=388.3, bsz=32, num_updates=3840, lr=9.48494e-06, gnorm=3.176, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6842
2022-05-07 22:20:20 - progress_bar.py[line:272] - INFO: epoch 001:   3856 / 17711 loss=3.409, loss_v1=0, loss_v2=0, nll_loss=1.16, ntokens=384.8, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886135, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.409, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.555, expert1_balance_bottom=16.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=209.9, ups=0.55, wpb=384.8, bsz=32, num_updates=3850, lr=9.48194e-06, gnorm=3.854, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6860
2022-05-07 22:20:38 - progress_bar.py[line:272] - INFO: epoch 001:   3866 / 17711 loss=3.462, loss_v1=0, loss_v2=0, nll_loss=1.216, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.462, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.299, expert1_balance_bottom=16.771, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=211.1, ups=0.54, wpb=388.2, bsz=32, num_updates=3860, lr=9.47893e-06, gnorm=3.554, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6879
2022-05-07 22:20:56 - progress_bar.py[line:272] - INFO: epoch 001:   3876 / 17711 loss=3.49, loss_v1=0, loss_v2=0, nll_loss=1.242, ntokens=389.8, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897214, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.49, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=34.943, expert1_balance_bottom=16.831, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=211.3, ups=0.54, wpb=389.8, bsz=32, num_updates=3870, lr=9.47593e-06, gnorm=3.642, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6897
2022-05-07 22:21:15 - progress_bar.py[line:272] - INFO: epoch 001:   3886 / 17711 loss=3.517, loss_v1=0, loss_v2=0, nll_loss=1.287, ntokens=378.6, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88654, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.517, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.461, expert1_balance_bottom=16.74, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.44, wps=207.1, ups=0.55, wpb=378.6, bsz=32, num_updates=3880, lr=9.47293e-06, gnorm=3.722, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6915
2022-05-07 22:21:32 - progress_bar.py[line:272] - INFO: epoch 001:   3896 / 17711 loss=3.493, loss_v1=0, loss_v2=0, nll_loss=1.248, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89275, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.493, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=35.546, expert1_balance_bottom=16.732, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.38, wps=214, ups=0.56, wpb=381.3, bsz=32, num_updates=3890, lr=9.46992e-06, gnorm=3.475, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6933
2022-05-07 22:21:50 - progress_bar.py[line:272] - INFO: epoch 001:   3906 / 17711 loss=3.418, loss_v1=0, loss_v2=0, nll_loss=1.146, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896771, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.418, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=34.897, expert1_balance_bottom=17.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=218.4, ups=0.57, wpb=382.9, bsz=32, num_updates=3900, lr=9.46692e-06, gnorm=3.337, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6951
2022-05-07 22:22:08 - progress_bar.py[line:272] - INFO: epoch 001:   3916 / 17711 loss=3.48, loss_v1=0, loss_v2=0, nll_loss=1.233, ntokens=386.1, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892243, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.48, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.197, expert1_balance_bottom=16.694, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.35, wps=215.4, ups=0.56, wpb=386.1, bsz=32, num_updates=3910, lr=9.46392e-06, gnorm=4.143, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=6969
2022-05-07 22:22:25 - progress_bar.py[line:272] - INFO: epoch 001:   3926 / 17711 loss=3.454, loss_v1=0, loss_v2=0, nll_loss=1.213, ntokens=377.8, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.454, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.484, expert1_balance_bottom=16.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=217.1, ups=0.57, wpb=377.8, bsz=32, num_updates=3920, lr=9.46091e-06, gnorm=3.595, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=6986
2022-05-07 22:22:43 - progress_bar.py[line:272] - INFO: epoch 001:   3936 / 17711 loss=3.431, loss_v1=0, loss_v2=0, nll_loss=1.175, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.431, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.611, expert1_balance_bottom=16.704, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=215.2, ups=0.56, wpb=385.3, bsz=32, num_updates=3930, lr=9.45791e-06, gnorm=3.718, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7004
2022-05-07 22:23:01 - progress_bar.py[line:272] - INFO: epoch 001:   3946 / 17711 loss=3.473, loss_v1=0, loss_v2=0, nll_loss=1.232, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.473, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=34.743, expert1_balance_bottom=17.016, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.35, wps=217.5, ups=0.57, wpb=382.4, bsz=32, num_updates=3940, lr=9.45491e-06, gnorm=3.851, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7022
2022-05-07 22:23:19 - progress_bar.py[line:272] - INFO: epoch 001:   3956 / 17711 loss=3.424, loss_v1=0, loss_v2=0, nll_loss=1.174, ntokens=385.2, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895342, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.424, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.399, expert1_balance_bottom=16.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=217.4, ups=0.56, wpb=385.2, bsz=32, num_updates=3950, lr=9.4519e-06, gnorm=3.652, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7039
2022-05-07 22:23:36 - progress_bar.py[line:272] - INFO: epoch 001:   3966 / 17711 loss=3.438, loss_v1=0, loss_v2=0, nll_loss=1.191, ntokens=382.7, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.438, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.24, expert1_balance_bottom=16.969, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.28, wps=218.9, ups=0.57, wpb=382.7, bsz=32, num_updates=3960, lr=9.4489e-06, gnorm=3.346, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7057
2022-05-07 22:23:54 - progress_bar.py[line:272] - INFO: epoch 001:   3976 / 17711 loss=3.458, loss_v1=0, loss_v2=0, nll_loss=1.207, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89373, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.458, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=34.245, expert1_balance_bottom=17.044, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=217.3, ups=0.57, wpb=382.2, bsz=32, num_updates=3970, lr=9.4459e-06, gnorm=3.513, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7074
2022-05-07 22:24:11 - progress_bar.py[line:272] - INFO: epoch 001:   3986 / 17711 loss=3.502, loss_v1=0, loss_v2=0, nll_loss=1.265, ntokens=389.6, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88733, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.502, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.089, expert1_balance_bottom=16.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.4, wps=225.2, ups=0.58, wpb=389.6, bsz=32, num_updates=3980, lr=9.44289e-06, gnorm=3.283, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7092
2022-05-07 22:24:29 - progress_bar.py[line:272] - INFO: epoch 001:   3996 / 17711 loss=3.378, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.378, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=34.67, expert1_balance_bottom=17.111, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=214.4, ups=0.56, wpb=381.3, bsz=32, num_updates=3990, lr=9.43989e-06, gnorm=3.68, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7109
2022-05-07 22:24:46 - progress_bar.py[line:272] - INFO: epoch 001:   4006 / 17711 loss=3.452, loss_v1=0, loss_v2=0, nll_loss=1.224, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87314, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.452, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.621, expert1_balance_bottom=16.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.34, wps=218.7, ups=0.57, wpb=382.5, bsz=32, num_updates=4000, lr=9.43689e-06, gnorm=3.393, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7127
2022-05-07 22:25:03 - progress_bar.py[line:272] - INFO: epoch 001:   4016 / 17711 loss=3.486, loss_v1=0, loss_v2=0, nll_loss=1.221, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.486, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=34.501, expert1_balance_bottom=17.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=224.5, ups=0.59, wpb=383.3, bsz=32, num_updates=4010, lr=9.43388e-06, gnorm=4.346, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7144
2022-05-07 22:25:21 - progress_bar.py[line:272] - INFO: epoch 001:   4026 / 17711 loss=3.441, loss_v1=0, loss_v2=0, nll_loss=1.21, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881506, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.441, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.313, expert1_balance_bottom=17.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=217.8, ups=0.57, wpb=380, bsz=32, num_updates=4020, lr=9.43088e-06, gnorm=3.524, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7161
2022-05-07 22:25:38 - progress_bar.py[line:272] - INFO: epoch 001:   4036 / 17711 loss=3.539, loss_v1=0, loss_v2=0, nll_loss=1.317, ntokens=384.9, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886828, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.539, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.684, expert1_balance_bottom=16.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.49, wps=220.5, ups=0.57, wpb=384.9, bsz=32, num_updates=4030, lr=9.42788e-06, gnorm=3.644, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7179
2022-05-07 22:25:56 - progress_bar.py[line:272] - INFO: epoch 001:   4046 / 17711 loss=3.423, loss_v1=0, loss_v2=0, nll_loss=1.175, ntokens=386, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.423, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.397, expert1_balance_bottom=16.768, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=221.5, ups=0.57, wpb=386, bsz=32, num_updates=4040, lr=9.42487e-06, gnorm=4.825, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7196
2022-05-07 22:26:13 - progress_bar.py[line:272] - INFO: epoch 001:   4056 / 17711 loss=3.397, loss_v1=0, loss_v2=0, nll_loss=1.152, ntokens=375.2, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.397, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.201, expert1_balance_bottom=16.783, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=215.3, ups=0.57, wpb=375.2, bsz=32, num_updates=4050, lr=9.42187e-06, gnorm=3.283, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7214
2022-05-07 22:26:31 - progress_bar.py[line:272] - INFO: epoch 001:   4066 / 17711 loss=3.483, loss_v1=0, loss_v2=0, nll_loss=1.253, ntokens=398.9, nsentences=32, sample_size=317.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874254, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.483, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=36.14, expert1_balance_bottom=16.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.38, wps=224.8, ups=0.56, wpb=398.9, bsz=32, num_updates=4060, lr=9.41887e-06, gnorm=3.567, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7232
2022-05-07 22:26:48 - progress_bar.py[line:272] - INFO: epoch 001:   4076 / 17711 loss=3.486, loss_v1=0, loss_v2=0, nll_loss=1.25, ntokens=390.8, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88783, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.486, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.378, expert1_balance_bottom=16.986, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.38, wps=222, ups=0.57, wpb=390.8, bsz=32, num_updates=4070, lr=9.41586e-06, gnorm=3.53, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7249
2022-05-07 22:27:06 - progress_bar.py[line:272] - INFO: epoch 001:   4086 / 17711 loss=3.403, loss_v1=0, loss_v2=0, nll_loss=1.155, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.403, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.38, expert1_balance_bottom=16.824, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=216.7, ups=0.56, wpb=384.8, bsz=32, num_updates=4080, lr=9.41286e-06, gnorm=4.06, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7267
2022-05-07 22:27:24 - progress_bar.py[line:272] - INFO: epoch 001:   4096 / 17711 loss=3.445, loss_v1=0, loss_v2=0, nll_loss=1.214, ntokens=380, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.445, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.597, expert1_balance_bottom=16.894, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=212.5, ups=0.56, wpb=380, bsz=32, num_updates=4090, lr=9.40986e-06, gnorm=3.691, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7285
2022-05-07 22:27:42 - progress_bar.py[line:272] - INFO: epoch 001:   4106 / 17711 loss=3.457, loss_v1=0, loss_v2=0, nll_loss=1.213, ntokens=392.2, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.457, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.466, expert1_balance_bottom=16.67, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=222.6, ups=0.57, wpb=392.2, bsz=32, num_updates=4100, lr=9.40685e-06, gnorm=3.382, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7302
2022-05-07 22:27:59 - progress_bar.py[line:272] - INFO: epoch 001:   4116 / 17711 loss=3.492, loss_v1=0, loss_v2=0, nll_loss=1.252, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.492, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.099, expert1_balance_bottom=16.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.38, wps=219.2, ups=0.56, wpb=388.1, bsz=32, num_updates=4110, lr=9.40385e-06, gnorm=4.055, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7320
2022-05-07 22:28:17 - progress_bar.py[line:272] - INFO: epoch 001:   4126 / 17711 loss=3.441, loss_v1=0, loss_v2=0, nll_loss=1.194, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887454, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.441, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=35.462, expert1_balance_bottom=16.835, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=222.1, ups=0.57, wpb=388.3, bsz=32, num_updates=4120, lr=9.40085e-06, gnorm=3.826, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7338
2022-05-07 22:28:34 - progress_bar.py[line:272] - INFO: epoch 001:   4136 / 17711 loss=3.454, loss_v1=0, loss_v2=0, nll_loss=1.192, ntokens=378.8, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.454, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=34.959, expert1_balance_bottom=16.86, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=216.1, ups=0.57, wpb=378.8, bsz=32, num_updates=4130, lr=9.39784e-06, gnorm=3.679, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7355
2022-05-07 22:28:52 - progress_bar.py[line:272] - INFO: epoch 001:   4146 / 17711 loss=3.397, loss_v1=0, loss_v2=0, nll_loss=1.136, ntokens=390.6, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897748, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.397, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=34.907, expert1_balance_bottom=16.834, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=221.7, ups=0.57, wpb=390.6, bsz=32, num_updates=4140, lr=9.39484e-06, gnorm=3.709, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7373
2022-05-07 22:29:10 - progress_bar.py[line:272] - INFO: epoch 001:   4156 / 17711 loss=3.426, loss_v1=0, loss_v2=0, nll_loss=1.188, ntokens=386.6, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883075, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.426, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.492, expert1_balance_bottom=16.968, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.28, wps=213.6, ups=0.55, wpb=386.6, bsz=32, num_updates=4150, lr=9.39184e-06, gnorm=3.498, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7391
2022-05-07 22:29:28 - progress_bar.py[line:272] - INFO: epoch 001:   4166 / 17711 loss=3.478, loss_v1=0, loss_v2=0, nll_loss=1.263, ntokens=378.6, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.478, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=36.243, expert1_balance_bottom=16.617, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.4, wps=212.1, ups=0.56, wpb=378.6, bsz=32, num_updates=4160, lr=9.38883e-06, gnorm=3.898, loss_scale=256, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7409
2022-05-07 22:29:46 - progress_bar.py[line:272] - INFO: epoch 001:   4176 / 17711 loss=3.504, loss_v1=0, loss_v2=0, nll_loss=1.264, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894226, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.504, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=34.811, expert1_balance_bottom=17.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.4, wps=216.9, ups=0.57, wpb=382.4, bsz=32, num_updates=4170, lr=9.38583e-06, gnorm=3.766, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7426
2022-05-07 22:30:04 - progress_bar.py[line:272] - INFO: epoch 001:   4186 / 17711 loss=3.384, loss_v1=0, loss_v2=0, nll_loss=1.144, ntokens=375.9, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.384, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.855, expert1_balance_bottom=16.749, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=209.1, ups=0.56, wpb=375.9, bsz=32, num_updates=4180, lr=9.38283e-06, gnorm=3.485, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7444
2022-05-07 22:30:22 - progress_bar.py[line:272] - INFO: epoch 001:   4196 / 17711 loss=3.43, loss_v1=0, loss_v2=0, nll_loss=1.191, ntokens=391.5, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.43, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.373, expert1_balance_top=36.061, expert1_balance_bottom=16.688, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.28, wps=217.3, ups=0.55, wpb=391.5, bsz=32, num_updates=4190, lr=9.37982e-06, gnorm=3.408, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7462
2022-05-07 22:30:39 - progress_bar.py[line:272] - INFO: epoch 001:   4206 / 17711 loss=3.37, loss_v1=0, loss_v2=0, nll_loss=1.112, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890227, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.37, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.556, expert1_balance_bottom=16.734, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=214.2, ups=0.56, wpb=383, bsz=32, num_updates=4200, lr=9.37682e-06, gnorm=3.356, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7480
2022-05-07 22:30:57 - progress_bar.py[line:272] - INFO: epoch 001:   4216 / 17711 loss=3.461, loss_v1=0, loss_v2=0, nll_loss=1.218, ntokens=384.3, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.461, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.402, expert1_balance_bottom=16.881, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=218.1, ups=0.57, wpb=384.3, bsz=32, num_updates=4210, lr=9.37382e-06, gnorm=3.619, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7498
2022-05-07 22:31:15 - progress_bar.py[line:272] - INFO: epoch 001:   4226 / 17711 loss=3.417, loss_v1=0, loss_v2=0, nll_loss=1.17, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889342, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.417, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.384, expert1_balance_bottom=16.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.25, wps=216.9, ups=0.57, wpb=380.5, bsz=32, num_updates=4220, lr=9.37081e-06, gnorm=3.411, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7515
2022-05-07 22:31:32 - progress_bar.py[line:272] - INFO: epoch 001:   4236 / 17711 loss=3.519, loss_v1=0, loss_v2=0, nll_loss=1.274, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896642, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.519, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.068, expert1_balance_bottom=16.823, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.42, wps=217.8, ups=0.57, wpb=380.1, bsz=32, num_updates=4230, lr=9.36781e-06, gnorm=3.324, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7533
2022-05-07 22:31:50 - progress_bar.py[line:272] - INFO: epoch 001:   4246 / 17711 loss=3.398, loss_v1=0, loss_v2=0, nll_loss=1.153, ntokens=384.1, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891343, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.398, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.017, expert1_balance_bottom=17.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=216, ups=0.56, wpb=384.1, bsz=32, num_updates=4240, lr=9.36481e-06, gnorm=3.291, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7551
2022-05-07 22:32:08 - progress_bar.py[line:272] - INFO: epoch 001:   4256 / 17711 loss=3.398, loss_v1=0, loss_v2=0, nll_loss=1.155, ntokens=380.6, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.398, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.011, expert1_balance_bottom=17.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=214.2, ups=0.56, wpb=380.6, bsz=32, num_updates=4250, lr=9.3618e-06, gnorm=3.699, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7568
2022-05-07 22:32:20 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-07 22:32:27 - progress_bar.py[line:272] - INFO: epoch 001:   4267 / 17711 loss=3.471, loss_v1=0, loss_v2=0, nll_loss=1.245, ntokens=381.5, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884353, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.471, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.483, expert1_balance_bottom=16.775, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=198.4, ups=0.52, wpb=381.5, bsz=32, num_updates=4260, lr=9.3588e-06, gnorm=3.599, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7588
2022-05-07 22:32:45 - progress_bar.py[line:272] - INFO: epoch 001:   4277 / 17711 loss=3.428, loss_v1=0, loss_v2=0, nll_loss=1.176, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892748, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.428, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=34.632, expert1_balance_bottom=17.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=215.4, ups=0.56, wpb=383, bsz=32, num_updates=4270, lr=9.3558e-06, gnorm=3.78, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7605
2022-05-07 22:33:02 - progress_bar.py[line:272] - INFO: epoch 001:   4287 / 17711 loss=3.435, loss_v1=0, loss_v2=0, nll_loss=1.19, ntokens=379.3, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890267, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.435, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.476, expert1_balance_bottom=17.031, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.28, wps=214.7, ups=0.57, wpb=379.3, bsz=32, num_updates=4280, lr=9.35279e-06, gnorm=3.455, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7623
2022-05-07 22:33:20 - progress_bar.py[line:272] - INFO: epoch 001:   4297 / 17711 loss=3.405, loss_v1=0, loss_v2=0, nll_loss=1.159, ntokens=388.8, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.405, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.376, expert1_balance_bottom=17.14, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=217.5, ups=0.56, wpb=388.8, bsz=32, num_updates=4290, lr=9.34979e-06, gnorm=3.817, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7641
2022-05-07 22:33:38 - progress_bar.py[line:272] - INFO: epoch 001:   4307 / 17711 loss=3.42, loss_v1=0, loss_v2=0, nll_loss=1.183, ntokens=390.5, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880743, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.42, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.963, expert1_balance_bottom=16.847, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=220.7, ups=0.57, wpb=390.5, bsz=32, num_updates=4300, lr=9.34679e-06, gnorm=3.6, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7659
2022-05-07 22:33:55 - progress_bar.py[line:272] - INFO: epoch 001:   4317 / 17711 loss=3.445, loss_v1=0, loss_v2=0, nll_loss=1.21, ntokens=391.3, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.445, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=34.861, expert1_balance_bottom=17.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=221.8, ups=0.57, wpb=391.3, bsz=32, num_updates=4310, lr=9.34378e-06, gnorm=4.137, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=7676
2022-05-07 22:34:13 - progress_bar.py[line:272] - INFO: epoch 001:   4327 / 17711 loss=3.472, loss_v1=0, loss_v2=0, nll_loss=1.234, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885134, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.472, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.286, expert1_balance_bottom=16.83, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.35, wps=216.9, ups=0.56, wpb=385.8, bsz=32, num_updates=4320, lr=9.34078e-06, gnorm=3.684, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=7694
2022-05-07 22:34:31 - progress_bar.py[line:272] - INFO: epoch 001:   4337 / 17711 loss=3.346, loss_v1=0, loss_v2=0, nll_loss=1.083, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.346, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=34.954, expert1_balance_bottom=17.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=215, ups=0.56, wpb=381.8, bsz=32, num_updates=4330, lr=9.33778e-06, gnorm=3.675, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7712
2022-05-07 22:34:49 - progress_bar.py[line:272] - INFO: epoch 001:   4347 / 17711 loss=3.433, loss_v1=0, loss_v2=0, nll_loss=1.191, ntokens=378.3, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891759, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.433, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=35.069, expert1_balance_bottom=17.24, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.28, wps=214.8, ups=0.57, wpb=378.3, bsz=32, num_updates=4340, lr=9.33477e-06, gnorm=3.281, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7729
2022-05-07 22:35:06 - progress_bar.py[line:272] - INFO: epoch 001:   4357 / 17711 loss=3.398, loss_v1=0, loss_v2=0, nll_loss=1.159, ntokens=389.7, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882583, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.398, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.572, expert1_balance_bottom=17.014, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=219.2, ups=0.56, wpb=389.7, bsz=32, num_updates=4350, lr=9.33177e-06, gnorm=3.499, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7747
2022-05-07 22:35:24 - progress_bar.py[line:272] - INFO: epoch 001:   4367 / 17711 loss=3.445, loss_v1=0, loss_v2=0, nll_loss=1.193, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.445, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.194, expert1_balance_bottom=17.059, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=216.5, ups=0.57, wpb=379.5, bsz=32, num_updates=4360, lr=9.32877e-06, gnorm=3.347, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7765
2022-05-07 22:35:42 - progress_bar.py[line:272] - INFO: epoch 001:   4377 / 17711 loss=3.419, loss_v1=0, loss_v2=0, nll_loss=1.193, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.419, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.372, expert1_balance_top=36, expert1_balance_bottom=16.67, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=215.9, ups=0.57, wpb=380.7, bsz=32, num_updates=4370, lr=9.32577e-06, gnorm=3.598, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7782
2022-05-07 22:35:59 - progress_bar.py[line:272] - INFO: epoch 001:   4387 / 17711 loss=3.501, loss_v1=0, loss_v2=0, nll_loss=1.277, ntokens=387, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882267, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.501, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.484, expert1_balance_bottom=16.51, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.42, wps=219.7, ups=0.57, wpb=387, bsz=32, num_updates=4380, lr=9.32276e-06, gnorm=3.781, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7800
2022-05-07 22:36:17 - progress_bar.py[line:272] - INFO: epoch 001:   4397 / 17711 loss=3.418, loss_v1=0, loss_v2=0, nll_loss=1.176, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.418, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.3, expert1_balance_bottom=16.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=211.8, ups=0.56, wpb=377.8, bsz=32, num_updates=4390, lr=9.31976e-06, gnorm=3.345, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7818
2022-05-07 22:36:35 - progress_bar.py[line:272] - INFO: epoch 001:   4407 / 17711 loss=3.367, loss_v1=0, loss_v2=0, nll_loss=1.125, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882252, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.367, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.195, expert1_balance_bottom=16.859, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=207.7, ups=0.54, wpb=382.1, bsz=32, num_updates=4400, lr=9.31676e-06, gnorm=3.227, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7836
2022-05-07 22:36:54 - progress_bar.py[line:272] - INFO: epoch 001:   4417 / 17711 loss=3.441, loss_v1=0, loss_v2=0, nll_loss=1.201, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.441, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.695, expert1_balance_bottom=17.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.3, wps=206.6, ups=0.54, wpb=384.9, bsz=32, num_updates=4410, lr=9.31375e-06, gnorm=3.617, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7855
2022-05-07 22:37:13 - progress_bar.py[line:272] - INFO: epoch 001:   4427 / 17711 loss=3.385, loss_v1=0, loss_v2=0, nll_loss=1.149, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.385, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.593, expert1_balance_bottom=16.971, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=205.5, ups=0.53, wpb=384.2, bsz=32, num_updates=4420, lr=9.31075e-06, gnorm=3.454, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7874
2022-05-07 22:37:32 - progress_bar.py[line:272] - INFO: epoch 001:   4437 / 17711 loss=3.491, loss_v1=0, loss_v2=0, nll_loss=1.248, ntokens=375, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893546, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.491, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.189, expert1_balance_bottom=16.967, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=194.3, ups=0.52, wpb=375, bsz=32, num_updates=4430, lr=9.30775e-06, gnorm=3.609, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7893
2022-05-07 22:37:51 - progress_bar.py[line:272] - INFO: epoch 001:   4447 / 17711 loss=3.402, loss_v1=0, loss_v2=0, nll_loss=1.171, ntokens=380, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88535, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.402, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.211, expert1_balance_bottom=17.093, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.25, wps=195.4, ups=0.51, wpb=380, bsz=32, num_updates=4440, lr=9.30474e-06, gnorm=3.598, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7912
2022-05-07 22:38:11 - progress_bar.py[line:272] - INFO: epoch 001:   4457 / 17711 loss=3.386, loss_v1=0, loss_v2=0, nll_loss=1.128, ntokens=382.2, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891379, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.386, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.243, expert1_balance_bottom=17.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=196.8, ups=0.51, wpb=382.2, bsz=32, num_updates=4450, lr=9.30174e-06, gnorm=3.32, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7932
2022-05-07 22:38:30 - progress_bar.py[line:272] - INFO: epoch 001:   4467 / 17711 loss=3.448, loss_v1=0, loss_v2=0, nll_loss=1.201, ntokens=375.8, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.448, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.356, expert1_balance_bottom=17.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.3, wps=197.7, ups=0.53, wpb=375.8, bsz=32, num_updates=4460, lr=9.29874e-06, gnorm=3.61, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7951
2022-05-07 22:38:49 - progress_bar.py[line:272] - INFO: epoch 001:   4477 / 17711 loss=3.444, loss_v1=0, loss_v2=0, nll_loss=1.193, ntokens=370.7, nsentences=32, sample_size=294.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905504, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.444, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=34.3, expert1_balance_bottom=17.459, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=195.2, ups=0.53, wpb=370.7, bsz=32, num_updates=4470, lr=9.29573e-06, gnorm=3.788, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7970
2022-05-07 22:38:53 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-07 22:39:11 - progress_bar.py[line:272] - INFO: epoch 001:   4488 / 17711 loss=3.499, loss_v1=0, loss_v2=0, nll_loss=1.28, ntokens=382.9, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892811, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.499, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.094, expert1_balance_bottom=17.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.43, wps=173, ups=0.45, wpb=382.9, bsz=32, num_updates=4480, lr=9.29273e-06, gnorm=3.772, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=7992
2022-05-07 22:39:29 - progress_bar.py[line:272] - INFO: epoch 001:   4498 / 17711 loss=3.47, loss_v1=0, loss_v2=0, nll_loss=1.238, ntokens=389.2, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.47, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.263, expert1_balance_bottom=16.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=213, ups=0.55, wpb=389.2, bsz=32, num_updates=4490, lr=9.28973e-06, gnorm=3.415, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8010
2022-05-07 22:39:47 - progress_bar.py[line:272] - INFO: epoch 001:   4508 / 17711 loss=3.433, loss_v1=0, loss_v2=0, nll_loss=1.199, ntokens=380.9, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888344, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.433, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.08, expert1_balance_bottom=17.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.3, wps=210.5, ups=0.55, wpb=380.9, bsz=32, num_updates=4500, lr=9.28672e-06, gnorm=3.423, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=8028
2022-05-07 22:40:05 - progress_bar.py[line:272] - INFO: epoch 001:   4518 / 17711 loss=3.455, loss_v1=0, loss_v2=0, nll_loss=1.214, ntokens=379.8, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.455, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.107, expert1_balance_bottom=16.931, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=216.9, ups=0.57, wpb=379.8, bsz=32, num_updates=4510, lr=9.28372e-06, gnorm=3.156, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8046
2022-05-07 22:40:23 - progress_bar.py[line:272] - INFO: epoch 001:   4528 / 17711 loss=3.391, loss_v1=0, loss_v2=0, nll_loss=1.148, ntokens=385.6, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.391, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=34.86, expert1_balance_bottom=17.107, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=218.7, ups=0.57, wpb=385.6, bsz=32, num_updates=4520, lr=9.28072e-06, gnorm=3.661, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8063
2022-05-07 22:40:40 - progress_bar.py[line:272] - INFO: epoch 001:   4538 / 17711 loss=3.417, loss_v1=0, loss_v2=0, nll_loss=1.158, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.417, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=34.889, expert1_balance_bottom=17.24, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=219.8, ups=0.57, wpb=384.7, bsz=32, num_updates=4530, lr=9.27771e-06, gnorm=3.431, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8081
2022-05-07 22:40:58 - progress_bar.py[line:272] - INFO: epoch 001:   4548 / 17711 loss=3.498, loss_v1=0, loss_v2=0, nll_loss=1.258, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.498, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=34.645, expert1_balance_bottom=17.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.39, wps=216.2, ups=0.57, wpb=378.2, bsz=32, num_updates=4540, lr=9.27471e-06, gnorm=3.813, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8098
2022-05-07 22:41:15 - progress_bar.py[line:272] - INFO: epoch 001:   4558 / 17711 loss=3.404, loss_v1=0, loss_v2=0, nll_loss=1.166, ntokens=390.6, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890302, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.404, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.191, expert1_balance_bottom=17.086, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=226.4, ups=0.58, wpb=390.6, bsz=32, num_updates=4550, lr=9.27171e-06, gnorm=3.531, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8116
2022-05-07 22:41:32 - progress_bar.py[line:272] - INFO: epoch 001:   4568 / 17711 loss=3.34, loss_v1=0, loss_v2=0, nll_loss=1.072, ntokens=374.4, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.34, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.125, expert1_balance_bottom=17.116, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=213.9, ups=0.57, wpb=374.4, bsz=32, num_updates=4560, lr=9.2687e-06, gnorm=3.443, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8133
2022-05-07 22:41:50 - progress_bar.py[line:272] - INFO: epoch 001:   4578 / 17711 loss=3.446, loss_v1=0, loss_v2=0, nll_loss=1.19, ntokens=373.7, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.446, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=34.493, expert1_balance_bottom=17.597, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.28, wps=211.7, ups=0.57, wpb=373.7, bsz=32, num_updates=4570, lr=9.2657e-06, gnorm=3.262, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8151
2022-05-07 22:42:08 - progress_bar.py[line:272] - INFO: epoch 001:   4588 / 17711 loss=3.367, loss_v1=0, loss_v2=0, nll_loss=1.108, ntokens=384.2, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89491, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.367, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.123, expert1_balance_bottom=17.102, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=213.5, ups=0.56, wpb=384.2, bsz=32, num_updates=4580, lr=9.2627e-06, gnorm=3.166, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8169
2022-05-07 22:42:26 - progress_bar.py[line:272] - INFO: epoch 001:   4598 / 17711 loss=3.452, loss_v1=0, loss_v2=0, nll_loss=1.207, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895615, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.452, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.222, expert1_balance_bottom=17.077, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=215.2, ups=0.56, wpb=381.1, bsz=32, num_updates=4590, lr=9.25969e-06, gnorm=3.647, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8186
2022-05-07 22:42:43 - progress_bar.py[line:272] - INFO: epoch 001:   4608 / 17711 loss=3.36, loss_v1=0, loss_v2=0, nll_loss=1.113, ntokens=379.4, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.36, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.043, expert1_balance_bottom=17.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=216.9, ups=0.57, wpb=379.4, bsz=32, num_updates=4600, lr=9.25669e-06, gnorm=4.108, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8204
2022-05-07 22:43:01 - progress_bar.py[line:272] - INFO: epoch 001:   4618 / 17711 loss=3.418, loss_v1=0, loss_v2=0, nll_loss=1.187, ntokens=373.9, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.418, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.371, expert1_balance_top=35.413, expert1_balance_bottom=17.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.28, wps=214.7, ups=0.57, wpb=373.9, bsz=32, num_updates=4610, lr=9.25369e-06, gnorm=4.051, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8221
2022-05-07 22:43:18 - progress_bar.py[line:272] - INFO: epoch 001:   4628 / 17711 loss=3.398, loss_v1=0, loss_v2=0, nll_loss=1.154, ntokens=374.3, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.398, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=34.981, expert1_balance_bottom=17.057, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=211, ups=0.56, wpb=374.3, bsz=32, num_updates=4620, lr=9.25068e-06, gnorm=3.888, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=8239
2022-05-07 22:43:36 - progress_bar.py[line:272] - INFO: epoch 001:   4638 / 17711 loss=3.435, loss_v1=0, loss_v2=0, nll_loss=1.2, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.435, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.452, expert1_balance_bottom=17.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.3, wps=220.8, ups=0.57, wpb=385.6, bsz=32, num_updates=4630, lr=9.24768e-06, gnorm=3.932, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8257
2022-05-07 22:43:54 - progress_bar.py[line:272] - INFO: epoch 001:   4648 / 17711 loss=3.463, loss_v1=0, loss_v2=0, nll_loss=1.239, ntokens=385.8, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881853, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.463, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.635, expert1_balance_bottom=16.867, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=212.9, ups=0.55, wpb=385.8, bsz=32, num_updates=4640, lr=9.24468e-06, gnorm=3.782, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8275
2022-05-07 22:44:13 - progress_bar.py[line:272] - INFO: epoch 001:   4658 / 17711 loss=3.426, loss_v1=0, loss_v2=0, nll_loss=1.197, ntokens=386.6, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.426, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.428, expert1_balance_bottom=16.922, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=203.1, ups=0.53, wpb=386.6, bsz=32, num_updates=4650, lr=9.24167e-06, gnorm=3.895, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8294
2022-05-07 22:44:32 - progress_bar.py[line:272] - INFO: epoch 001:   4668 / 17711 loss=3.447, loss_v1=0, loss_v2=0, nll_loss=1.208, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.447, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.295, expert1_balance_bottom=17.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=206.8, ups=0.53, wpb=386.8, bsz=32, num_updates=4660, lr=9.23867e-06, gnorm=3.752, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8312
2022-05-07 22:44:50 - progress_bar.py[line:272] - INFO: epoch 001:   4678 / 17711 loss=3.422, loss_v1=0, loss_v2=0, nll_loss=1.192, ntokens=389, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884919, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.422, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.622, expert1_balance_bottom=17.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=213.2, ups=0.55, wpb=389, bsz=32, num_updates=4670, lr=9.23567e-06, gnorm=3.534, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8331
2022-05-07 22:45:09 - progress_bar.py[line:272] - INFO: epoch 001:   4688 / 17711 loss=3.509, loss_v1=0, loss_v2=0, nll_loss=1.277, ntokens=387.4, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.509, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.635, expert1_balance_bottom=16.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.42, wps=200.4, ups=0.52, wpb=387.4, bsz=32, num_updates=4680, lr=9.23266e-06, gnorm=4.089, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8350
2022-05-07 22:45:28 - progress_bar.py[line:272] - INFO: epoch 001:   4698 / 17711 loss=3.423, loss_v1=0, loss_v2=0, nll_loss=1.178, ntokens=383.2, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.423, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=35.418, expert1_balance_bottom=17.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=201, ups=0.52, wpb=383.2, bsz=32, num_updates=4690, lr=9.22966e-06, gnorm=3.565, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8369
2022-05-07 22:45:47 - progress_bar.py[line:272] - INFO: epoch 001:   4708 / 17711 loss=3.42, loss_v1=0, loss_v2=0, nll_loss=1.169, ntokens=372.3, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903016, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.42, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.37, expert1_balance_top=34.534, expert1_balance_bottom=17.365, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.25, wps=196.6, ups=0.53, wpb=372.3, bsz=32, num_updates=4700, lr=9.22666e-06, gnorm=4.053, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8388
2022-05-07 22:46:06 - progress_bar.py[line:272] - INFO: epoch 001:   4718 / 17711 loss=3.401, loss_v1=0, loss_v2=0, nll_loss=1.16, ntokens=381.3, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886268, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.401, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.012, expert1_balance_bottom=17.383, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=204.2, ups=0.54, wpb=381.3, bsz=32, num_updates=4710, lr=9.22365e-06, gnorm=3.599, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8407
2022-05-07 22:46:24 - progress_bar.py[line:272] - INFO: epoch 001:   4728 / 17711 loss=3.374, loss_v1=0, loss_v2=0, nll_loss=1.126, ntokens=379.3, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892223, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.374, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=34.633, expert1_balance_bottom=17.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=207.7, ups=0.55, wpb=379.3, bsz=32, num_updates=4720, lr=9.22065e-06, gnorm=3.234, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8425
2022-05-07 22:46:42 - progress_bar.py[line:272] - INFO: epoch 001:   4738 / 17711 loss=3.405, loss_v1=0, loss_v2=0, nll_loss=1.159, ntokens=379.7, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.405, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.2, expert1_balance_bottom=17.341, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=214.8, ups=0.57, wpb=379.7, bsz=32, num_updates=4730, lr=9.21765e-06, gnorm=4.33, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8443
2022-05-07 22:47:00 - progress_bar.py[line:272] - INFO: epoch 001:   4748 / 17711 loss=3.329, loss_v1=0, loss_v2=0, nll_loss=1.096, ntokens=384.1, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.329, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.393, expert1_balance_bottom=17.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=215.2, ups=0.56, wpb=384.1, bsz=32, num_updates=4740, lr=9.21464e-06, gnorm=3.166, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8460
2022-05-07 22:47:18 - progress_bar.py[line:272] - INFO: epoch 001:   4758 / 17711 loss=3.395, loss_v1=0, loss_v2=0, nll_loss=1.142, ntokens=383, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897344, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.395, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=34.772, expert1_balance_bottom=17.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=214.4, ups=0.56, wpb=383, bsz=32, num_updates=4750, lr=9.21164e-06, gnorm=3.557, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8478
2022-05-07 22:47:36 - progress_bar.py[line:272] - INFO: epoch 001:   4768 / 17711 loss=3.457, loss_v1=0, loss_v2=0, nll_loss=1.225, ntokens=375.1, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.457, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.319, expert1_balance_bottom=17.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.34, wps=205.1, ups=0.55, wpb=375.1, bsz=32, num_updates=4760, lr=9.20864e-06, gnorm=3.432, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8497
2022-05-07 22:47:54 - progress_bar.py[line:272] - INFO: epoch 001:   4778 / 17711 loss=3.37, loss_v1=0, loss_v2=0, nll_loss=1.121, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89431, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.37, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=34.854, expert1_balance_bottom=17.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=209, ups=0.54, wpb=385.1, bsz=32, num_updates=4770, lr=9.20563e-06, gnorm=3.809, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8515
2022-05-07 22:48:13 - progress_bar.py[line:272] - INFO: epoch 001:   4788 / 17711 loss=3.395, loss_v1=0, loss_v2=0, nll_loss=1.145, ntokens=382.3, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.395, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=34.453, expert1_balance_bottom=17.589, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=201.5, ups=0.53, wpb=382.3, bsz=32, num_updates=4780, lr=9.20263e-06, gnorm=3.734, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8534
2022-05-07 22:48:32 - progress_bar.py[line:272] - INFO: epoch 001:   4798 / 17711 loss=3.377, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.377, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.048, expert1_balance_bottom=17.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=200.3, ups=0.53, wpb=379.5, bsz=32, num_updates=4790, lr=9.19963e-06, gnorm=4.46, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8553
2022-05-07 22:48:51 - progress_bar.py[line:272] - INFO: epoch 001:   4808 / 17711 loss=3.391, loss_v1=0, loss_v2=0, nll_loss=1.136, ntokens=375.9, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.391, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=34.815, expert1_balance_bottom=17.446, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=199.2, ups=0.53, wpb=375.9, bsz=32, num_updates=4800, lr=9.19662e-06, gnorm=3.55, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8572
2022-05-07 22:49:10 - progress_bar.py[line:272] - INFO: epoch 001:   4818 / 17711 loss=3.345, loss_v1=0, loss_v2=0, nll_loss=1.079, ntokens=386.4, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902012, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.345, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=34.39, expert1_balance_bottom=17.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=208.2, ups=0.54, wpb=386.4, bsz=32, num_updates=4810, lr=9.19362e-06, gnorm=3.345, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8590
2022-05-07 22:49:29 - progress_bar.py[line:272] - INFO: epoch 001:   4828 / 17711 loss=3.396, loss_v1=0, loss_v2=0, nll_loss=1.166, ntokens=380.9, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883524, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.396, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.414, expert1_balance_bottom=17.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=199.9, ups=0.52, wpb=380.9, bsz=32, num_updates=4820, lr=9.19062e-06, gnorm=3.76, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8609
2022-05-07 22:49:48 - progress_bar.py[line:272] - INFO: epoch 001:   4838 / 17711 loss=3.436, loss_v1=0, loss_v2=0, nll_loss=1.195, ntokens=390, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.436, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.238, expert1_balance_bottom=17.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=199.5, ups=0.51, wpb=390, bsz=32, num_updates=4830, lr=9.18761e-06, gnorm=3.575, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8629
2022-05-07 22:50:07 - progress_bar.py[line:272] - INFO: epoch 001:   4848 / 17711 loss=3.431, loss_v1=0, loss_v2=0, nll_loss=1.209, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876116, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.431, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.753, expert1_balance_bottom=16.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=207.7, ups=0.55, wpb=380.8, bsz=32, num_updates=4840, lr=9.18461e-06, gnorm=3.974, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8647
2022-05-07 22:50:25 - progress_bar.py[line:272] - INFO: epoch 001:   4858 / 17711 loss=3.361, loss_v1=0, loss_v2=0, nll_loss=1.112, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.361, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.746, expert1_balance_bottom=17.077, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=210.4, ups=0.55, wpb=379.9, bsz=32, num_updates=4850, lr=9.18161e-06, gnorm=3.491, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8665
2022-05-07 22:50:43 - progress_bar.py[line:272] - INFO: epoch 001:   4868 / 17711 loss=3.422, loss_v1=0, loss_v2=0, nll_loss=1.196, ntokens=397.5, nsentences=32, sample_size=316.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880115, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.422, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.031, expert1_balance_bottom=17.068, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=218.7, ups=0.55, wpb=397.5, bsz=32, num_updates=4860, lr=9.1786e-06, gnorm=3.143, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8684
2022-05-07 22:51:01 - progress_bar.py[line:272] - INFO: epoch 001:   4878 / 17711 loss=3.413, loss_v1=0, loss_v2=0, nll_loss=1.153, ntokens=378.8, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898099, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.413, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=34.531, expert1_balance_bottom=17.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=208.2, ups=0.55, wpb=378.8, bsz=32, num_updates=4870, lr=9.1756e-06, gnorm=3.523, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8702
2022-05-07 22:51:20 - progress_bar.py[line:272] - INFO: epoch 001:   4888 / 17711 loss=3.411, loss_v1=0, loss_v2=0, nll_loss=1.186, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.411, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.237, expert1_balance_bottom=17.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=201.3, ups=0.53, wpb=381.2, bsz=32, num_updates=4880, lr=9.1726e-06, gnorm=3.604, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8721
2022-05-07 22:51:38 - progress_bar.py[line:272] - INFO: epoch 001:   4898 / 17711 loss=3.407, loss_v1=0, loss_v2=0, nll_loss=1.171, ntokens=379.9, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.407, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.631, expert1_balance_bottom=17.031, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.25, wps=205.5, ups=0.54, wpb=379.9, bsz=32, num_updates=4890, lr=9.16959e-06, gnorm=3.704, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8739
2022-05-07 22:51:58 - progress_bar.py[line:272] - INFO: epoch 001:   4908 / 17711 loss=3.298, loss_v1=0, loss_v2=0, nll_loss=1.048, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892136, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.298, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.175, expert1_balance_bottom=17.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=200.3, ups=0.52, wpb=382.3, bsz=32, num_updates=4900, lr=9.16659e-06, gnorm=3.035, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8758
2022-05-07 22:52:16 - progress_bar.py[line:272] - INFO: epoch 001:   4918 / 17711 loss=3.409, loss_v1=0, loss_v2=0, nll_loss=1.177, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.409, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.437, expert1_balance_bottom=16.998, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=203.7, ups=0.53, wpb=383.8, bsz=32, num_updates=4910, lr=9.16359e-06, gnorm=3.817, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8777
2022-05-07 22:52:35 - progress_bar.py[line:272] - INFO: epoch 001:   4928 / 17711 loss=3.379, loss_v1=0, loss_v2=0, nll_loss=1.125, ntokens=378.2, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.379, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.077, expert1_balance_bottom=17.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=199.7, ups=0.53, wpb=378.2, bsz=32, num_updates=4920, lr=9.16059e-06, gnorm=4.11, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8796
2022-05-07 22:52:56 - progress_bar.py[line:272] - INFO: epoch 001:   4938 / 17711 loss=3.404, loss_v1=0, loss_v2=0, nll_loss=1.18, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.404, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.566, expert1_balance_bottom=17.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=190.3, ups=0.49, wpb=386, bsz=32, num_updates=4930, lr=9.15758e-06, gnorm=3.69, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8816
2022-05-07 22:53:14 - progress_bar.py[line:272] - INFO: epoch 001:   4948 / 17711 loss=3.409, loss_v1=0, loss_v2=0, nll_loss=1.173, ntokens=386.4, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.409, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=34.851, expert1_balance_bottom=17.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=206.9, ups=0.54, wpb=386.4, bsz=32, num_updates=4940, lr=9.15458e-06, gnorm=4.097, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8835
2022-05-07 22:53:32 - progress_bar.py[line:272] - INFO: epoch 001:   4958 / 17711 loss=3.361, loss_v1=0, loss_v2=0, nll_loss=1.11, ntokens=384.8, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.361, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=34.58, expert1_balance_bottom=17.394, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=214.4, ups=0.56, wpb=384.8, bsz=32, num_updates=4950, lr=9.15158e-06, gnorm=3.751, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8853
2022-05-07 22:53:50 - progress_bar.py[line:272] - INFO: epoch 001:   4968 / 17711 loss=3.34, loss_v1=0, loss_v2=0, nll_loss=1.094, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.34, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.369, expert1_balance_top=35.378, expert1_balance_bottom=17.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=215.7, ups=0.56, wpb=382.1, bsz=32, num_updates=4960, lr=9.14857e-06, gnorm=3.169, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8871
2022-05-07 22:54:08 - progress_bar.py[line:272] - INFO: epoch 001:   4978 / 17711 loss=3.362, loss_v1=0, loss_v2=0, nll_loss=1.123, ntokens=387, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888397, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.362, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.046, expert1_balance_bottom=17.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=218.2, ups=0.56, wpb=387, bsz=32, num_updates=4970, lr=9.14557e-06, gnorm=3.238, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8888
2022-05-07 22:54:25 - progress_bar.py[line:272] - INFO: epoch 001:   4988 / 17711 loss=3.473, loss_v1=0, loss_v2=0, nll_loss=1.23, ntokens=371.6, nsentences=32, sample_size=295.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896326, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.473, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.372, expert1_balance_bottom=17.113, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.35, wps=211.3, ups=0.57, wpb=371.6, bsz=32, num_updates=4980, lr=9.14257e-06, gnorm=3.928, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8906
2022-05-07 22:54:43 - progress_bar.py[line:272] - INFO: epoch 001:   4998 / 17711 loss=3.409, loss_v1=0, loss_v2=0, nll_loss=1.182, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885254, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.409, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.243, expert1_balance_bottom=17.029, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=213.7, ups=0.55, wpb=385.1, bsz=32, num_updates=4990, lr=9.13956e-06, gnorm=3.17, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8924
2022-05-07 22:55:01 - progress_bar.py[line:272] - INFO: epoch 001:   5008 / 17711 loss=3.388, loss_v1=0, loss_v2=0, nll_loss=1.153, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.388, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.33, expert1_balance_bottom=17.091, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=211.3, ups=0.55, wpb=381, bsz=32, num_updates=5000, lr=9.13656e-06, gnorm=3.266, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=8942
2022-05-07 22:55:01 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-07 22:55:01 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-07 22:55:01 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-07 23:03:03 - train.py[line:517] - INFO: valid_step finished
2022-05-07 23:03:03 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 8.52 | loss_v1 0 | loss_v2 0 | nll_loss 6.767 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.956822 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 8.52 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.368 | expert1_balance_top 41.222 | expert1_balance_bottom 14.15 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 108.89 | cider 1.041 | wps 628.2 | wpb 481.7 | bsz 8 | num_updates 5000
2022-05-07 23:03:03 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 1 @ 5000 updates
2022-05-07 23:03:03 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_5000-rank-0.pt
2022-05-07 23:03:03 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_5000-rank-0.pt
2022-05-07 23:03:11 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_5000-rank-0.pt
2022-05-07 23:03:11 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_5000-shared.pt
2022-05-07 23:03:19 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_5000-shared.pt
2022-05-07 23:03:50 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_5000-rank-0.pt (epoch 1 @ 5000 updates, score 1.041) (writing took 47.2711076522246 seconds)
2022-05-07 23:04:08 - progress_bar.py[line:272] - INFO: epoch 001:   5018 / 17711 loss=3.347, loss_v1=0, loss_v2=0, nll_loss=1.102, ntokens=377.2, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.347, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.054, expert1_balance_bottom=17.292, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=6.9, ups=0.02, wpb=377.2, bsz=32, num_updates=5010, lr=9.13356e-06, gnorm=3.425, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9489
2022-05-07 23:04:26 - progress_bar.py[line:272] - INFO: epoch 001:   5028 / 17711 loss=3.407, loss_v1=0, loss_v2=0, nll_loss=1.17, ntokens=383.2, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886764, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.407, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=34.844, expert1_balance_bottom=17.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.25, wps=211.8, ups=0.55, wpb=383.2, bsz=32, num_updates=5020, lr=9.13055e-06, gnorm=3.36, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9507
2022-05-07 23:04:44 - progress_bar.py[line:272] - INFO: epoch 001:   5038 / 17711 loss=3.368, loss_v1=0, loss_v2=0, nll_loss=1.127, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888678, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.368, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.215, expert1_balance_bottom=17.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=206.2, ups=0.54, wpb=382.2, bsz=32, num_updates=5030, lr=9.12755e-06, gnorm=3.934, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9525
2022-05-07 23:05:03 - progress_bar.py[line:272] - INFO: epoch 001:   5048 / 17711 loss=3.351, loss_v1=0, loss_v2=0, nll_loss=1.096, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892415, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.351, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.353, expert1_balance_bottom=17.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=212, ups=0.55, wpb=384.9, bsz=32, num_updates=5040, lr=9.12455e-06, gnorm=3.783, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9543
2022-05-07 23:05:21 - progress_bar.py[line:272] - INFO: epoch 001:   5058 / 17711 loss=3.466, loss_v1=0, loss_v2=0, nll_loss=1.228, ntokens=377.3, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89078, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.466, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.303, expert1_balance_bottom=17.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.34, wps=209.3, ups=0.55, wpb=377.3, bsz=32, num_updates=5050, lr=9.12154e-06, gnorm=3.882, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9561
2022-05-07 23:05:39 - progress_bar.py[line:272] - INFO: epoch 001:   5068 / 17711 loss=3.395, loss_v1=0, loss_v2=0, nll_loss=1.168, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882512, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.395, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=35.597, expert1_balance_bottom=17.063, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.25, wps=208, ups=0.55, wpb=379.2, bsz=32, num_updates=5060, lr=9.11854e-06, gnorm=3.398, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9580
2022-05-07 23:05:57 - progress_bar.py[line:272] - INFO: epoch 001:   5078 / 17711 loss=3.389, loss_v1=0, loss_v2=0, nll_loss=1.15, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.389, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=35.414, expert1_balance_bottom=17.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=206.2, ups=0.54, wpb=380, bsz=32, num_updates=5070, lr=9.11554e-06, gnorm=3.611, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9598
2022-05-07 23:06:16 - progress_bar.py[line:272] - INFO: epoch 001:   5088 / 17711 loss=3.366, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=391.5, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.366, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.368, expert1_balance_top=34.485, expert1_balance_bottom=17.539, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=214.7, ups=0.55, wpb=391.5, bsz=32, num_updates=5080, lr=9.11253e-06, gnorm=3.287, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9616
2022-05-07 23:06:34 - progress_bar.py[line:272] - INFO: epoch 001:   5098 / 17711 loss=3.327, loss_v1=0, loss_v2=0, nll_loss=1.075, ntokens=380.6, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.327, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=34.317, expert1_balance_bottom=17.623, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=209.2, ups=0.55, wpb=380.6, bsz=32, num_updates=5090, lr=9.10953e-06, gnorm=3.247, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9634
2022-05-07 23:06:52 - progress_bar.py[line:272] - INFO: epoch 001:   5108 / 17711 loss=3.335, loss_v1=0, loss_v2=0, nll_loss=1.08, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.335, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=34.66, expert1_balance_bottom=17.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=205.2, ups=0.54, wpb=377.9, bsz=32, num_updates=5100, lr=9.10653e-06, gnorm=3.053, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9653
2022-05-07 23:07:10 - progress_bar.py[line:272] - INFO: epoch 001:   5118 / 17711 loss=3.447, loss_v1=0, loss_v2=0, nll_loss=1.22, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.447, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=35.316, expert1_balance_bottom=17.02, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=210.4, ups=0.55, wpb=384.5, bsz=32, num_updates=5110, lr=9.10352e-06, gnorm=3.387, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9671
2022-05-07 23:07:29 - progress_bar.py[line:272] - INFO: epoch 001:   5128 / 17711 loss=3.33, loss_v1=0, loss_v2=0, nll_loss=1.074, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892895, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.33, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=34.663, expert1_balance_bottom=17.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=210, ups=0.54, wpb=388.1, bsz=32, num_updates=5120, lr=9.10052e-06, gnorm=3.569, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9690
2022-05-07 23:07:47 - progress_bar.py[line:272] - INFO: epoch 001:   5138 / 17711 loss=3.383, loss_v1=0, loss_v2=0, nll_loss=1.15, ntokens=393.1, nsentences=32, sample_size=313.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884709, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.383, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=35.379, expert1_balance_bottom=17.155, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=215.8, ups=0.55, wpb=393.1, bsz=32, num_updates=5130, lr=9.09752e-06, gnorm=3.689, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9708
2022-05-07 23:08:06 - progress_bar.py[line:272] - INFO: epoch 001:   5148 / 17711 loss=3.363, loss_v1=0, loss_v2=0, nll_loss=1.129, ntokens=392.9, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.363, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=35.417, expert1_balance_bottom=17.253, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=208.1, ups=0.53, wpb=392.9, bsz=32, num_updates=5140, lr=9.09451e-06, gnorm=3.272, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9727
2022-05-07 23:08:25 - progress_bar.py[line:272] - INFO: epoch 001:   5158 / 17711 loss=3.268, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.268, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=34.253, expert1_balance_bottom=17.682, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=207.8, ups=0.54, wpb=385.3, bsz=32, num_updates=5150, lr=9.09151e-06, gnorm=3.459, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9745
2022-05-07 23:08:44 - progress_bar.py[line:272] - INFO: epoch 001:   5168 / 17711 loss=3.38, loss_v1=0, loss_v2=0, nll_loss=1.138, ntokens=384.9, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887454, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.38, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=35.524, expert1_balance_bottom=17.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=202, ups=0.52, wpb=384.9, bsz=32, num_updates=5160, lr=9.08851e-06, gnorm=3.094, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9764
2022-05-07 23:09:02 - progress_bar.py[line:272] - INFO: epoch 001:   5178 / 17711 loss=3.325, loss_v1=0, loss_v2=0, nll_loss=1.069, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.325, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=35.041, expert1_balance_bottom=17.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=214.4, ups=0.56, wpb=385.7, bsz=32, num_updates=5170, lr=9.0855e-06, gnorm=3.319, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9782
2022-05-07 23:09:19 - progress_bar.py[line:272] - INFO: epoch 001:   5188 / 17711 loss=3.377, loss_v1=0, loss_v2=0, nll_loss=1.135, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893529, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.377, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=35.003, expert1_balance_bottom=17.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=217.6, ups=0.57, wpb=379.7, bsz=32, num_updates=5180, lr=9.0825e-06, gnorm=3.851, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9800
2022-05-07 23:09:37 - progress_bar.py[line:272] - INFO: epoch 001:   5198 / 17711 loss=3.445, loss_v1=0, loss_v2=0, nll_loss=1.222, ntokens=386.6, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876609, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.445, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=36.136, expert1_balance_bottom=16.826, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=221.4, ups=0.57, wpb=386.6, bsz=32, num_updates=5190, lr=9.0795e-06, gnorm=3.7, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9817
2022-05-07 23:09:54 - progress_bar.py[line:272] - INFO: epoch 001:   5208 / 17711 loss=3.38, loss_v1=0, loss_v2=0, nll_loss=1.138, ntokens=388, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891144, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.38, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=34.738, expert1_balance_bottom=17.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=223.3, ups=0.58, wpb=388, bsz=32, num_updates=5200, lr=9.07649e-06, gnorm=3.452, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9835
2022-05-07 23:10:11 - progress_bar.py[line:272] - INFO: epoch 001:   5218 / 17711 loss=3.411, loss_v1=0, loss_v2=0, nll_loss=1.185, ntokens=388.7, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884293, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.411, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=35.086, expert1_balance_bottom=17.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=221.9, ups=0.57, wpb=388.7, bsz=32, num_updates=5210, lr=9.07349e-06, gnorm=3.666, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9852
2022-05-07 23:10:29 - progress_bar.py[line:272] - INFO: epoch 001:   5228 / 17711 loss=3.339, loss_v1=0, loss_v2=0, nll_loss=1.091, ntokens=379.7, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.339, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=34.729, expert1_balance_bottom=17.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=217.9, ups=0.57, wpb=379.7, bsz=32, num_updates=5220, lr=9.07049e-06, gnorm=3.356, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9870
2022-05-07 23:10:47 - progress_bar.py[line:272] - INFO: epoch 001:   5238 / 17711 loss=3.378, loss_v1=0, loss_v2=0, nll_loss=1.149, ntokens=390.9, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884119, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.378, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=34.973, expert1_balance_bottom=17.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=216, ups=0.55, wpb=390.9, bsz=32, num_updates=5230, lr=9.06748e-06, gnorm=3.546, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=9888
2022-05-07 23:11:05 - progress_bar.py[line:272] - INFO: epoch 001:   5248 / 17711 loss=3.375, loss_v1=0, loss_v2=0, nll_loss=1.136, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885373, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.375, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=34.748, expert1_balance_bottom=17.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=209.6, ups=0.56, wpb=375.5, bsz=32, num_updates=5240, lr=9.06448e-06, gnorm=4.19, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9906
2022-05-07 23:11:23 - progress_bar.py[line:272] - INFO: epoch 001:   5258 / 17711 loss=3.36, loss_v1=0, loss_v2=0, nll_loss=1.116, ntokens=383.9, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.36, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=34.924, expert1_balance_bottom=17.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=211.8, ups=0.55, wpb=383.9, bsz=32, num_updates=5250, lr=9.06148e-06, gnorm=3.112, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9924
2022-05-07 23:11:41 - progress_bar.py[line:272] - INFO: epoch 001:   5268 / 17711 loss=3.398, loss_v1=0, loss_v2=0, nll_loss=1.166, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.398, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=35.171, expert1_balance_bottom=17.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=210.2, ups=0.55, wpb=379.2, bsz=32, num_updates=5260, lr=9.05847e-06, gnorm=3.293, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9942
2022-05-07 23:11:59 - progress_bar.py[line:272] - INFO: epoch 001:   5278 / 17711 loss=3.452, loss_v1=0, loss_v2=0, nll_loss=1.233, ntokens=378.7, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.452, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.367, expert1_balance_top=35.567, expert1_balance_bottom=17.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.35, wps=208, ups=0.55, wpb=378.7, bsz=32, num_updates=5270, lr=9.05547e-06, gnorm=3.479, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9960
2022-05-07 23:12:18 - progress_bar.py[line:272] - INFO: epoch 001:   5288 / 17711 loss=3.432, loss_v1=0, loss_v2=0, nll_loss=1.21, ntokens=389.8, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876132, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.432, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=35.472, expert1_balance_bottom=17.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=210.6, ups=0.54, wpb=389.8, bsz=32, num_updates=5280, lr=9.05247e-06, gnorm=3.974, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9979
2022-05-07 23:12:36 - progress_bar.py[line:272] - INFO: epoch 001:   5298 / 17711 loss=3.353, loss_v1=0, loss_v2=0, nll_loss=1.114, ntokens=387.6, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.353, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=34.801, expert1_balance_bottom=17.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=214.8, ups=0.55, wpb=387.6, bsz=32, num_updates=5290, lr=9.04946e-06, gnorm=3.767, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=9997
2022-05-07 23:12:54 - progress_bar.py[line:272] - INFO: epoch 001:   5308 / 17711 loss=3.426, loss_v1=0, loss_v2=0, nll_loss=1.194, ntokens=386, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890457, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.426, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=35.081, expert1_balance_bottom=17.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=213.8, ups=0.55, wpb=386, bsz=32, num_updates=5300, lr=9.04646e-06, gnorm=3.889, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=10015
2022-05-07 23:13:12 - progress_bar.py[line:272] - INFO: epoch 001:   5318 / 17711 loss=3.393, loss_v1=0, loss_v2=0, nll_loss=1.158, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890205, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.393, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=34.823, expert1_balance_bottom=17.395, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=216.2, ups=0.56, wpb=384.8, bsz=32, num_updates=5310, lr=9.04346e-06, gnorm=3.637, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10032
2022-05-07 23:13:29 - progress_bar.py[line:272] - INFO: epoch 001:   5328 / 17711 loss=3.415, loss_v1=0, loss_v2=0, nll_loss=1.184, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.415, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=35.122, expert1_balance_bottom=17.302, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=220.8, ups=0.57, wpb=385.5, bsz=32, num_updates=5320, lr=9.04045e-06, gnorm=3.552, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10050
2022-05-07 23:13:47 - progress_bar.py[line:272] - INFO: epoch 001:   5338 / 17711 loss=3.394, loss_v1=0, loss_v2=0, nll_loss=1.145, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.394, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=34.493, expert1_balance_bottom=17.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=220.1, ups=0.57, wpb=384.8, bsz=32, num_updates=5330, lr=9.03745e-06, gnorm=3.715, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10067
2022-05-07 23:14:04 - progress_bar.py[line:272] - INFO: epoch 001:   5348 / 17711 loss=3.286, loss_v1=0, loss_v2=0, nll_loss=1.035, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889377, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.286, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=34.697, expert1_balance_bottom=17.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=215.4, ups=0.57, wpb=377.1, bsz=32, num_updates=5340, lr=9.03445e-06, gnorm=3.185, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10085
2022-05-07 23:14:22 - progress_bar.py[line:272] - INFO: epoch 001:   5358 / 17711 loss=3.469, loss_v1=0, loss_v2=0, nll_loss=1.23, ntokens=370.4, nsentences=32, sample_size=294.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89504, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.469, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=34.76, expert1_balance_bottom=17.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.35, wps=212.1, ups=0.57, wpb=370.4, bsz=32, num_updates=5350, lr=9.03144e-06, gnorm=4.042, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10102
2022-05-07 23:14:39 - progress_bar.py[line:272] - INFO: epoch 001:   5368 / 17711 loss=3.313, loss_v1=0, loss_v2=0, nll_loss=1.076, ntokens=389.5, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.313, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=35.367, expert1_balance_bottom=17.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=217.8, ups=0.56, wpb=389.5, bsz=32, num_updates=5360, lr=9.02844e-06, gnorm=3.758, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10120
2022-05-07 23:14:57 - progress_bar.py[line:272] - INFO: epoch 001:   5378 / 17711 loss=3.369, loss_v1=0, loss_v2=0, nll_loss=1.134, ntokens=386.1, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881023, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.369, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=35.537, expert1_balance_bottom=17.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=220, ups=0.57, wpb=386.1, bsz=32, num_updates=5370, lr=9.02544e-06, gnorm=3.988, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10138
2022-05-07 23:15:14 - progress_bar.py[line:272] - INFO: epoch 001:   5388 / 17711 loss=3.349, loss_v1=0, loss_v2=0, nll_loss=1.099, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.349, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=34.758, expert1_balance_bottom=17.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=217.1, ups=0.57, wpb=379.3, bsz=32, num_updates=5380, lr=9.02243e-06, gnorm=3.701, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10155
2022-05-07 23:15:32 - progress_bar.py[line:272] - INFO: epoch 001:   5398 / 17711 loss=3.345, loss_v1=0, loss_v2=0, nll_loss=1.123, ntokens=391, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878072, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.345, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=36.073, expert1_balance_bottom=16.995, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=222.2, ups=0.57, wpb=391, bsz=32, num_updates=5390, lr=9.01943e-06, gnorm=3.596, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=10173
2022-05-07 23:15:50 - progress_bar.py[line:272] - INFO: epoch 001:   5408 / 17711 loss=3.292, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=386.7, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.292, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.147, expert1_balance_bottom=17.493, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=220.3, ups=0.57, wpb=386.7, bsz=32, num_updates=5400, lr=9.01643e-06, gnorm=3.882, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10190
2022-05-07 23:16:07 - progress_bar.py[line:272] - INFO: epoch 001:   5418 / 17711 loss=3.331, loss_v1=0, loss_v2=0, nll_loss=1.076, ntokens=376.9, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.331, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=34.636, expert1_balance_bottom=17.397, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=211.4, ups=0.56, wpb=376.9, bsz=32, num_updates=5410, lr=9.01342e-06, gnorm=3.701, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10208
2022-05-07 23:16:25 - progress_bar.py[line:272] - INFO: epoch 001:   5428 / 17711 loss=3.337, loss_v1=0, loss_v2=0, nll_loss=1.089, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891628, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.337, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=34.482, expert1_balance_bottom=17.549, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=216.7, ups=0.57, wpb=382.6, bsz=32, num_updates=5420, lr=9.01042e-06, gnorm=3.218, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10226
2022-05-07 23:16:43 - progress_bar.py[line:272] - INFO: epoch 001:   5438 / 17711 loss=3.344, loss_v1=0, loss_v2=0, nll_loss=1.103, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.344, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=34.926, expert1_balance_bottom=17.645, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=214.9, ups=0.56, wpb=385.7, bsz=32, num_updates=5430, lr=9.00742e-06, gnorm=3.254, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10244
2022-05-07 23:17:00 - progress_bar.py[line:272] - INFO: epoch 001:   5448 / 17711 loss=3.34, loss_v1=0, loss_v2=0, nll_loss=1.103, ntokens=388, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.34, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.366, expert1_balance_top=34.912, expert1_balance_bottom=17.549, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=222.6, ups=0.57, wpb=388, bsz=32, num_updates=5440, lr=9.00441e-06, gnorm=3.535, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10261
2022-05-07 23:17:18 - progress_bar.py[line:272] - INFO: epoch 001:   5458 / 17711 loss=3.377, loss_v1=0, loss_v2=0, nll_loss=1.126, ntokens=386.5, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892859, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.377, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=34.735, expert1_balance_bottom=17.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=220, ups=0.57, wpb=386.5, bsz=32, num_updates=5450, lr=9.00141e-06, gnorm=3.928, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10279
2022-05-07 23:17:30 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-07 23:17:37 - progress_bar.py[line:272] - INFO: epoch 001:   5469 / 17711 loss=3.365, loss_v1=0, loss_v2=0, nll_loss=1.131, ntokens=387.2, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885619, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.365, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.034, expert1_balance_bottom=17.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=200.5, ups=0.52, wpb=387.2, bsz=32, num_updates=5460, lr=8.99841e-06, gnorm=3.393, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10298
2022-05-07 23:17:55 - progress_bar.py[line:272] - INFO: epoch 001:   5479 / 17711 loss=3.335, loss_v1=0, loss_v2=0, nll_loss=1.094, ntokens=385.1, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.335, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.039, expert1_balance_bottom=17.698, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=217.5, ups=0.56, wpb=385.1, bsz=32, num_updates=5470, lr=8.9954e-06, gnorm=3.44, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10316
2022-05-07 23:18:13 - progress_bar.py[line:272] - INFO: epoch 001:   5489 / 17711 loss=3.381, loss_v1=0, loss_v2=0, nll_loss=1.16, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883193, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.381, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.351, expert1_balance_bottom=17.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=214.4, ups=0.56, wpb=385.9, bsz=32, num_updates=5480, lr=8.9924e-06, gnorm=3.784, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10334
2022-05-07 23:18:31 - progress_bar.py[line:272] - INFO: epoch 001:   5499 / 17711 loss=3.388, loss_v1=0, loss_v2=0, nll_loss=1.155, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.388, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.58, expert1_balance_bottom=17.193, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=215.9, ups=0.57, wpb=380.4, bsz=32, num_updates=5490, lr=8.9894e-06, gnorm=3.087, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10351
2022-05-07 23:18:48 - progress_bar.py[line:272] - INFO: epoch 001:   5509 / 17711 loss=3.355, loss_v1=0, loss_v2=0, nll_loss=1.127, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.355, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.255, expert1_balance_bottom=17.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=218.3, ups=0.57, wpb=383.4, bsz=32, num_updates=5500, lr=8.9864e-06, gnorm=3.447, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10369
2022-05-07 23:19:06 - progress_bar.py[line:272] - INFO: epoch 001:   5519 / 17711 loss=3.385, loss_v1=0, loss_v2=0, nll_loss=1.154, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.385, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.305, expert1_balance_bottom=17.093, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=218.8, ups=0.57, wpb=385.2, bsz=32, num_updates=5510, lr=8.98339e-06, gnorm=3.932, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10387
2022-05-07 23:19:24 - progress_bar.py[line:272] - INFO: epoch 001:   5529 / 17711 loss=3.458, loss_v1=0, loss_v2=0, nll_loss=1.245, ntokens=385.4, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.458, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.689, expert1_balance_bottom=16.941, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.37, wps=217.5, ups=0.56, wpb=385.4, bsz=32, num_updates=5520, lr=8.98039e-06, gnorm=3.468, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10404
2022-05-07 23:19:41 - progress_bar.py[line:272] - INFO: epoch 001:   5539 / 17711 loss=3.298, loss_v1=0, loss_v2=0, nll_loss=1.053, ntokens=390.8, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.298, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.176, expert1_balance_bottom=17.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=219.5, ups=0.56, wpb=390.8, bsz=32, num_updates=5530, lr=8.97739e-06, gnorm=3.769, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10422
2022-05-07 23:19:59 - progress_bar.py[line:272] - INFO: epoch 001:   5549 / 17711 loss=3.353, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=388.9, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.353, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.296, expert1_balance_bottom=17.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=218.1, ups=0.56, wpb=388.9, bsz=32, num_updates=5540, lr=8.97438e-06, gnorm=2.955, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10440
2022-05-07 23:20:17 - progress_bar.py[line:272] - INFO: epoch 001:   5559 / 17711 loss=3.387, loss_v1=0, loss_v2=0, nll_loss=1.154, ntokens=390.9, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890069, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.387, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=34.6, expert1_balance_bottom=17.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=221.3, ups=0.57, wpb=390.9, bsz=32, num_updates=5550, lr=8.97138e-06, gnorm=3.6, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10458
2022-05-07 23:20:35 - progress_bar.py[line:272] - INFO: epoch 001:   5569 / 17711 loss=3.329, loss_v1=0, loss_v2=0, nll_loss=1.078, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89078, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.329, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=34.905, expert1_balance_bottom=17.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=212.1, ups=0.56, wpb=377.8, bsz=32, num_updates=5560, lr=8.96838e-06, gnorm=3.167, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10475
2022-05-07 23:20:53 - progress_bar.py[line:272] - INFO: epoch 001:   5579 / 17711 loss=3.34, loss_v1=0, loss_v2=0, nll_loss=1.107, ntokens=381.4, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.34, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.406, expert1_balance_bottom=17.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=213, ups=0.56, wpb=381.4, bsz=32, num_updates=5570, lr=8.96537e-06, gnorm=3.667, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10493
2022-05-07 23:21:10 - progress_bar.py[line:272] - INFO: epoch 001:   5589 / 17711 loss=3.392, loss_v1=0, loss_v2=0, nll_loss=1.155, ntokens=376.3, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895029, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.392, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=34.81, expert1_balance_bottom=17.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=212.1, ups=0.56, wpb=376.3, bsz=32, num_updates=5580, lr=8.96237e-06, gnorm=3.586, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10511
2022-05-07 23:21:28 - progress_bar.py[line:272] - INFO: epoch 001:   5599 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=0.975, ntokens=382.8, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893369, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=34.452, expert1_balance_bottom=17.742, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=212.8, ups=0.56, wpb=382.8, bsz=32, num_updates=5590, lr=8.95937e-06, gnorm=3.177, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10529
2022-05-07 23:21:46 - progress_bar.py[line:272] - INFO: epoch 001:   5609 / 17711 loss=3.346, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=386.2, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.346, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.365, expert1_balance_top=35.802, expert1_balance_bottom=17.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=217.4, ups=0.56, wpb=386.2, bsz=32, num_updates=5600, lr=8.95636e-06, gnorm=3.573, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10547
2022-05-07 23:22:04 - progress_bar.py[line:272] - INFO: epoch 001:   5619 / 17711 loss=3.397, loss_v1=0, loss_v2=0, nll_loss=1.164, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88656, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.397, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=34.716, expert1_balance_bottom=17.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=219.8, ups=0.57, wpb=385.7, bsz=32, num_updates=5610, lr=8.95336e-06, gnorm=3.28, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10564
2022-05-07 23:22:21 - progress_bar.py[line:272] - INFO: epoch 001:   5629 / 17711 loss=3.354, loss_v1=0, loss_v2=0, nll_loss=1.126, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882677, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.354, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=35.528, expert1_balance_bottom=17.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=214.5, ups=0.56, wpb=382.5, bsz=32, num_updates=5620, lr=8.95036e-06, gnorm=3.116, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10582
2022-05-07 23:22:39 - progress_bar.py[line:272] - INFO: epoch 001:   5639 / 17711 loss=3.384, loss_v1=0, loss_v2=0, nll_loss=1.149, ntokens=390.1, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890328, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.384, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=35.083, expert1_balance_bottom=17.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=222.1, ups=0.57, wpb=390.1, bsz=32, num_updates=5630, lr=8.94735e-06, gnorm=3.423, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10600
2022-05-07 23:22:57 - progress_bar.py[line:272] - INFO: epoch 001:   5649 / 17711 loss=3.453, loss_v1=0, loss_v2=0, nll_loss=1.222, ntokens=378.7, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898042, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.453, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=35.167, expert1_balance_bottom=17.24, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.33, wps=214.7, ups=0.57, wpb=378.7, bsz=32, num_updates=5640, lr=8.94435e-06, gnorm=4.188, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10617
2022-05-07 23:23:14 - progress_bar.py[line:272] - INFO: epoch 001:   5659 / 17711 loss=3.332, loss_v1=0, loss_v2=0, nll_loss=1.093, ntokens=378.9, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884819, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.332, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=35.863, expert1_balance_bottom=17.035, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=214.2, ups=0.57, wpb=378.9, bsz=32, num_updates=5650, lr=8.94135e-06, gnorm=3.544, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10635
2022-05-07 23:23:32 - progress_bar.py[line:272] - INFO: epoch 001:   5669 / 17711 loss=3.341, loss_v1=0, loss_v2=0, nll_loss=1.097, ntokens=376.3, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896341, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.341, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=34.876, expert1_balance_bottom=17.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=215.9, ups=0.57, wpb=376.3, bsz=32, num_updates=5660, lr=8.93834e-06, gnorm=3.284, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10653
2022-05-07 23:23:49 - progress_bar.py[line:272] - INFO: epoch 001:   5679 / 17711 loss=3.344, loss_v1=0, loss_v2=0, nll_loss=1.088, ntokens=391, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898729, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.344, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.932, expert1_balance_bottom=17.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=223.1, ups=0.57, wpb=391, bsz=32, num_updates=5670, lr=8.93534e-06, gnorm=3.611, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=10670
2022-05-07 23:24:07 - progress_bar.py[line:272] - INFO: epoch 001:   5689 / 17711 loss=3.336, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=374.7, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888047, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.336, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=35.15, expert1_balance_bottom=17.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=212, ups=0.57, wpb=374.7, bsz=32, num_updates=5680, lr=8.93234e-06, gnorm=3.808, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10688
2022-05-07 23:24:24 - progress_bar.py[line:272] - INFO: epoch 001:   5699 / 17711 loss=3.331, loss_v1=0, loss_v2=0, nll_loss=1.095, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.331, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.998, expert1_balance_bottom=17.665, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=219, ups=0.57, wpb=383.3, bsz=32, num_updates=5690, lr=8.92933e-06, gnorm=3.37, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=10705
2022-05-07 23:24:42 - progress_bar.py[line:272] - INFO: epoch 001:   5709 / 17711 loss=3.334, loss_v1=0, loss_v2=0, nll_loss=1.088, ntokens=376, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.334, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=35.098, expert1_balance_bottom=17.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=213.8, ups=0.57, wpb=376, bsz=32, num_updates=5700, lr=8.92633e-06, gnorm=3.624, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10723
2022-05-07 23:25:00 - progress_bar.py[line:272] - INFO: epoch 001:   5719 / 17711 loss=3.369, loss_v1=0, loss_v2=0, nll_loss=1.135, ntokens=377.6, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890675, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.369, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=35.218, expert1_balance_bottom=17.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=214.3, ups=0.57, wpb=377.6, bsz=32, num_updates=5710, lr=8.92333e-06, gnorm=3.369, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10740
2022-05-07 23:25:17 - progress_bar.py[line:272] - INFO: epoch 001:   5729 / 17711 loss=3.342, loss_v1=0, loss_v2=0, nll_loss=1.109, ntokens=387.2, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.342, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=35.782, expert1_balance_bottom=17.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=218.7, ups=0.56, wpb=387.2, bsz=32, num_updates=5720, lr=8.92032e-06, gnorm=3.206, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10758
2022-05-07 23:25:35 - progress_bar.py[line:272] - INFO: epoch 001:   5739 / 17711 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=0.997, ntokens=376.2, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891745, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.256, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.507, expert1_balance_bottom=17.733, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=211.4, ups=0.56, wpb=376.2, bsz=32, num_updates=5730, lr=8.91732e-06, gnorm=3.561, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10776
2022-05-07 23:25:53 - progress_bar.py[line:272] - INFO: epoch 001:   5749 / 17711 loss=3.4, loss_v1=0, loss_v2=0, nll_loss=1.156, ntokens=384.6, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.4, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=34.843, expert1_balance_bottom=17.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=217.6, ups=0.57, wpb=384.6, bsz=32, num_updates=5740, lr=8.91432e-06, gnorm=3.267, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10794
2022-05-07 23:26:10 - progress_bar.py[line:272] - INFO: epoch 001:   5759 / 17711 loss=3.344, loss_v1=0, loss_v2=0, nll_loss=1.102, ntokens=380.9, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887433, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.344, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.912, expert1_balance_bottom=17.464, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=215.8, ups=0.57, wpb=380.9, bsz=32, num_updates=5750, lr=8.91131e-06, gnorm=3.434, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10811
2022-05-07 23:26:28 - progress_bar.py[line:272] - INFO: epoch 001:   5769 / 17711 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=0.979, ntokens=379.8, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.373, expert1_balance_bottom=17.617, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=218.6, ups=0.58, wpb=379.8, bsz=32, num_updates=5760, lr=8.90831e-06, gnorm=3.141, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10829
2022-05-07 23:26:45 - progress_bar.py[line:272] - INFO: epoch 001:   5779 / 17711 loss=3.394, loss_v1=0, loss_v2=0, nll_loss=1.162, ntokens=375.1, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.394, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.67, expert1_balance_bottom=17.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=215, ups=0.57, wpb=375.1, bsz=32, num_updates=5770, lr=8.90531e-06, gnorm=3.815, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=10846
2022-05-07 23:27:03 - progress_bar.py[line:272] - INFO: epoch 001:   5789 / 17711 loss=3.438, loss_v1=0, loss_v2=0, nll_loss=1.206, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.438, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.541, expert1_balance_bottom=17.454, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=216.6, ups=0.57, wpb=382.3, bsz=32, num_updates=5780, lr=8.9023e-06, gnorm=2.993, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10864
2022-05-07 23:27:21 - progress_bar.py[line:272] - INFO: epoch 001:   5799 / 17711 loss=3.373, loss_v1=0, loss_v2=0, nll_loss=1.164, ntokens=386.1, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.373, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.364, expert1_balance_top=35.828, expert1_balance_bottom=17.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=217.5, ups=0.56, wpb=386.1, bsz=32, num_updates=5790, lr=8.8993e-06, gnorm=3.555, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10882
2022-05-07 23:27:38 - progress_bar.py[line:272] - INFO: epoch 001:   5809 / 17711 loss=3.343, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=375.4, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.343, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.649, expert1_balance_bottom=17.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=214.3, ups=0.57, wpb=375.4, bsz=32, num_updates=5800, lr=8.8963e-06, gnorm=3.366, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10899
2022-05-07 23:27:56 - progress_bar.py[line:272] - INFO: epoch 001:   5819 / 17711 loss=3.337, loss_v1=0, loss_v2=0, nll_loss=1.088, ntokens=374.6, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900939, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.337, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.281, expert1_balance_bottom=17.665, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=214, ups=0.57, wpb=374.6, bsz=32, num_updates=5810, lr=8.89329e-06, gnorm=3.198, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=10917
2022-05-07 23:28:14 - progress_bar.py[line:272] - INFO: epoch 001:   5829 / 17711 loss=3.328, loss_v1=0, loss_v2=0, nll_loss=1.071, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901119, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.328, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.256, expert1_balance_bottom=17.724, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=214.3, ups=0.56, wpb=381.1, bsz=32, num_updates=5820, lr=8.89029e-06, gnorm=3.315, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10934
2022-05-07 23:28:31 - progress_bar.py[line:272] - INFO: epoch 001:   5839 / 17711 loss=3.453, loss_v1=0, loss_v2=0, nll_loss=1.23, ntokens=380.1, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882962, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.453, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=35.551, expert1_balance_bottom=17.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.35, wps=214.6, ups=0.56, wpb=380.1, bsz=32, num_updates=5830, lr=8.88729e-06, gnorm=4.214, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10952
2022-05-07 23:28:49 - progress_bar.py[line:272] - INFO: epoch 001:   5849 / 17711 loss=3.353, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=394.4, nsentences=32, sample_size=313.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883024, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.353, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=35.146, expert1_balance_bottom=17.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=224.1, ups=0.57, wpb=394.4, bsz=32, num_updates=5840, lr=8.88428e-06, gnorm=3.521, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10970
2022-05-07 23:29:06 - progress_bar.py[line:272] - INFO: epoch 001:   5859 / 17711 loss=3.332, loss_v1=0, loss_v2=0, nll_loss=1.09, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.332, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=34.693, expert1_balance_bottom=17.673, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=215.3, ups=0.57, wpb=378.8, bsz=32, num_updates=5850, lr=8.88128e-06, gnorm=3.342, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=10987
2022-05-07 23:29:24 - progress_bar.py[line:272] - INFO: epoch 001:   5869 / 17711 loss=3.314, loss_v1=0, loss_v2=0, nll_loss=1.071, ntokens=374.4, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887895, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.314, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=35.179, expert1_balance_bottom=17.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=208.9, ups=0.56, wpb=374.4, bsz=32, num_updates=5860, lr=8.87828e-06, gnorm=3.459, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11005
2022-05-07 23:29:42 - progress_bar.py[line:272] - INFO: epoch 001:   5879 / 17711 loss=3.311, loss_v1=0, loss_v2=0, nll_loss=1.08, ntokens=384.3, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879818, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.311, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=35.422, expert1_balance_bottom=17.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=216.6, ups=0.56, wpb=384.3, bsz=32, num_updates=5870, lr=8.87527e-06, gnorm=3.143, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11023
2022-05-07 23:30:00 - progress_bar.py[line:272] - INFO: epoch 001:   5889 / 17711 loss=3.316, loss_v1=0, loss_v2=0, nll_loss=1.067, ntokens=376.7, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.316, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.363, expert1_balance_top=33.944, expert1_balance_bottom=17.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=211.3, ups=0.56, wpb=376.7, bsz=32, num_updates=5880, lr=8.87227e-06, gnorm=2.958, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11041
2022-05-07 23:30:18 - progress_bar.py[line:272] - INFO: epoch 001:   5899 / 17711 loss=3.321, loss_v1=0, loss_v2=0, nll_loss=1.085, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882927, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.321, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=35.113, expert1_balance_bottom=17.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=213.4, ups=0.56, wpb=381.2, bsz=32, num_updates=5890, lr=8.86927e-06, gnorm=3.796, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11059
2022-05-07 23:30:35 - progress_bar.py[line:272] - INFO: epoch 001:   5909 / 17711 loss=3.46, loss_v1=0, loss_v2=0, nll_loss=1.238, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.46, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=34.874, expert1_balance_bottom=17.64, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=214.9, ups=0.57, wpb=377.5, bsz=32, num_updates=5900, lr=8.86626e-06, gnorm=3.725, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11076
2022-05-07 23:30:53 - progress_bar.py[line:272] - INFO: epoch 001:   5919 / 17711 loss=3.37, loss_v1=0, loss_v2=0, nll_loss=1.142, ntokens=387.5, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886721, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.37, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=35.043, expert1_balance_bottom=17.459, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=215.9, ups=0.56, wpb=387.5, bsz=32, num_updates=5910, lr=8.86326e-06, gnorm=3.396, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11094
2022-05-07 23:31:11 - progress_bar.py[line:272] - INFO: epoch 001:   5929 / 17711 loss=3.387, loss_v1=0, loss_v2=0, nll_loss=1.142, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.387, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=34.271, expert1_balance_bottom=17.749, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=216.2, ups=0.56, wpb=383.4, bsz=32, num_updates=5920, lr=8.86026e-06, gnorm=3.973, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11112
2022-05-07 23:31:29 - progress_bar.py[line:272] - INFO: epoch 001:   5939 / 17711 loss=3.339, loss_v1=0, loss_v2=0, nll_loss=1.117, ntokens=376.3, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.339, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=34.669, expert1_balance_bottom=17.592, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=212.1, ups=0.56, wpb=376.3, bsz=32, num_updates=5930, lr=8.85725e-06, gnorm=3.439, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=11130
2022-05-07 23:31:46 - progress_bar.py[line:272] - INFO: epoch 001:   5949 / 17711 loss=3.375, loss_v1=0, loss_v2=0, nll_loss=1.163, ntokens=391.5, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.375, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=35.633, expert1_balance_bottom=17.534, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=225.7, ups=0.58, wpb=391.5, bsz=32, num_updates=5940, lr=8.85425e-06, gnorm=3.787, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11147
2022-05-07 23:32:04 - progress_bar.py[line:272] - INFO: epoch 001:   5959 / 17711 loss=3.327, loss_v1=0, loss_v2=0, nll_loss=1.085, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888213, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.327, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=34.493, expert1_balance_bottom=17.674, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=218.2, ups=0.57, wpb=383.9, bsz=32, num_updates=5950, lr=8.85125e-06, gnorm=3.338, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11164
2022-05-07 23:32:21 - progress_bar.py[line:272] - INFO: epoch 001:   5969 / 17711 loss=3.347, loss_v1=0, loss_v2=0, nll_loss=1.114, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.347, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=35.317, expert1_balance_bottom=17.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=215.3, ups=0.57, wpb=380.1, bsz=32, num_updates=5960, lr=8.84824e-06, gnorm=3.36, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11182
2022-05-07 23:32:39 - progress_bar.py[line:272] - INFO: epoch 001:   5979 / 17711 loss=3.287, loss_v1=0, loss_v2=0, nll_loss=1.045, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891524, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.287, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=34.568, expert1_balance_bottom=17.456, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=215.7, ups=0.57, wpb=380, bsz=32, num_updates=5970, lr=8.84524e-06, gnorm=3.22, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11200
2022-05-07 23:32:56 - progress_bar.py[line:272] - INFO: epoch 001:   5989 / 17711 loss=3.324, loss_v1=0, loss_v2=0, nll_loss=1.087, ntokens=391.1, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.324, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=35.37, expert1_balance_bottom=17.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=225.1, ups=0.58, wpb=391.1, bsz=32, num_updates=5980, lr=8.84224e-06, gnorm=3.232, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11217
2022-05-07 23:33:14 - progress_bar.py[line:272] - INFO: epoch 001:   5999 / 17711 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=1.036, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.274, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=35.083, expert1_balance_bottom=17.573, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=214.4, ups=0.56, wpb=379.6, bsz=32, num_updates=5990, lr=8.83923e-06, gnorm=3.635, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11235
2022-05-07 23:33:32 - progress_bar.py[line:272] - INFO: epoch 001:   6009 / 17711 loss=3.314, loss_v1=0, loss_v2=0, nll_loss=1.069, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.314, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=34.46, expert1_balance_bottom=17.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=219.2, ups=0.57, wpb=382.4, bsz=32, num_updates=6000, lr=8.83623e-06, gnorm=3.577, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11252
2022-05-07 23:33:49 - progress_bar.py[line:272] - INFO: epoch 001:   6019 / 17711 loss=3.296, loss_v1=0, loss_v2=0, nll_loss=1.048, ntokens=388.3, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.296, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.362, expert1_balance_top=34.94, expert1_balance_bottom=17.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=224.6, ups=0.58, wpb=388.3, bsz=32, num_updates=6010, lr=8.83323e-06, gnorm=3.438, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11270
2022-05-07 23:34:07 - progress_bar.py[line:272] - INFO: epoch 001:   6029 / 17711 loss=3.359, loss_v1=0, loss_v2=0, nll_loss=1.137, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883668, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.359, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=35.276, expert1_balance_bottom=17.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=211.8, ups=0.56, wpb=376.7, bsz=32, num_updates=6020, lr=8.83022e-06, gnorm=4.073, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=11287
2022-05-07 23:34:24 - progress_bar.py[line:272] - INFO: epoch 001:   6039 / 17711 loss=3.363, loss_v1=0, loss_v2=0, nll_loss=1.124, ntokens=384.6, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.363, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=35.13, expert1_balance_bottom=17.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=215.9, ups=0.56, wpb=384.6, bsz=32, num_updates=6030, lr=8.82722e-06, gnorm=3.464, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11305
2022-05-07 23:34:42 - progress_bar.py[line:272] - INFO: epoch 001:   6049 / 17711 loss=3.318, loss_v1=0, loss_v2=0, nll_loss=1.09, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883839, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.318, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=35.15, expert1_balance_bottom=17.597, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=220.2, ups=0.57, wpb=385.4, bsz=32, num_updates=6040, lr=8.82422e-06, gnorm=3.284, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11323
2022-05-07 23:35:00 - progress_bar.py[line:272] - INFO: epoch 001:   6059 / 17711 loss=3.381, loss_v1=0, loss_v2=0, nll_loss=1.149, ntokens=387, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883299, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.381, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=35.323, expert1_balance_bottom=17.503, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=220.1, ups=0.57, wpb=387, bsz=32, num_updates=6050, lr=8.82122e-06, gnorm=3.596, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11340
2022-05-07 23:35:17 - progress_bar.py[line:272] - INFO: epoch 001:   6069 / 17711 loss=3.335, loss_v1=0, loss_v2=0, nll_loss=1.117, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.335, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=35.658, expert1_balance_bottom=17.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=215.4, ups=0.56, wpb=382.7, bsz=32, num_updates=6060, lr=8.81821e-06, gnorm=3.452, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11358
2022-05-07 23:35:35 - progress_bar.py[line:272] - INFO: epoch 001:   6079 / 17711 loss=3.373, loss_v1=0, loss_v2=0, nll_loss=1.155, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880944, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.373, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=35.599, expert1_balance_bottom=17.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=217.8, ups=0.56, wpb=388.1, bsz=32, num_updates=6070, lr=8.81521e-06, gnorm=2.865, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=11376
2022-05-07 23:35:53 - progress_bar.py[line:272] - INFO: epoch 001:   6089 / 17711 loss=3.307, loss_v1=0, loss_v2=0, nll_loss=1.079, ntokens=385.2, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.307, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=35.841, expert1_balance_bottom=17.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=218.4, ups=0.57, wpb=385.2, bsz=32, num_updates=6080, lr=8.81221e-06, gnorm=3.071, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11394
2022-05-07 23:36:10 - progress_bar.py[line:272] - INFO: epoch 001:   6099 / 17711 loss=3.387, loss_v1=0, loss_v2=0, nll_loss=1.143, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900986, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.387, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=34.139, expert1_balance_bottom=18.071, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=213.9, ups=0.56, wpb=378.6, bsz=32, num_updates=6090, lr=8.8092e-06, gnorm=3.494, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=11411
2022-05-07 23:36:28 - progress_bar.py[line:272] - INFO: epoch 001:   6109 / 17711 loss=3.362, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=377.4, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896366, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.362, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=34.258, expert1_balance_bottom=17.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=212.8, ups=0.56, wpb=377.4, bsz=32, num_updates=6100, lr=8.8062e-06, gnorm=3.565, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11429
2022-05-07 23:36:46 - progress_bar.py[line:272] - INFO: epoch 001:   6119 / 17711 loss=3.438, loss_v1=0, loss_v2=0, nll_loss=1.214, ntokens=374.4, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890406, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.438, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.361, expert1_balance_top=34.373, expert1_balance_bottom=17.784, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=210.3, ups=0.56, wpb=374.4, bsz=32, num_updates=6110, lr=8.8032e-06, gnorm=3.578, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11447
2022-05-07 23:37:03 - progress_bar.py[line:272] - INFO: epoch 001:   6129 / 17711 loss=3.278, loss_v1=0, loss_v2=0, nll_loss=1.031, ntokens=376.5, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.278, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=34.175, expert1_balance_bottom=17.878, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=215.8, ups=0.57, wpb=376.5, bsz=32, num_updates=6120, lr=8.80019e-06, gnorm=4.249, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11464
2022-05-07 23:37:21 - progress_bar.py[line:272] - INFO: epoch 001:   6139 / 17711 loss=3.336, loss_v1=0, loss_v2=0, nll_loss=1.097, ntokens=379.4, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.336, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=35.058, expert1_balance_bottom=17.856, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=216.3, ups=0.57, wpb=379.4, bsz=32, num_updates=6130, lr=8.79719e-06, gnorm=3.022, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11482
2022-05-07 23:37:39 - progress_bar.py[line:272] - INFO: epoch 001:   6149 / 17711 loss=3.353, loss_v1=0, loss_v2=0, nll_loss=1.117, ntokens=372.7, nsentences=32, sample_size=296.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89144, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.353, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=34.434, expert1_balance_bottom=17.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=211.6, ups=0.57, wpb=372.7, bsz=32, num_updates=6140, lr=8.79419e-06, gnorm=3.434, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11499
2022-05-07 23:37:56 - progress_bar.py[line:272] - INFO: epoch 001:   6159 / 17711 loss=3.275, loss_v1=0, loss_v2=0, nll_loss=1.036, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.275, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=34.399, expert1_balance_bottom=17.783, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=215.2, ups=0.57, wpb=378.5, bsz=32, num_updates=6150, lr=8.79118e-06, gnorm=3.077, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11517
2022-05-07 23:38:14 - progress_bar.py[line:272] - INFO: epoch 001:   6169 / 17711 loss=3.381, loss_v1=0, loss_v2=0, nll_loss=1.134, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.381, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=33.722, expert1_balance_bottom=18.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=211.6, ups=0.56, wpb=377.8, bsz=32, num_updates=6160, lr=8.78818e-06, gnorm=3.714, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11535
2022-05-07 23:38:32 - progress_bar.py[line:272] - INFO: epoch 001:   6179 / 17711 loss=3.349, loss_v1=0, loss_v2=0, nll_loss=1.128, ntokens=388.6, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878145, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.349, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=35.544, expert1_balance_bottom=17.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=219, ups=0.56, wpb=388.6, bsz=32, num_updates=6170, lr=8.78518e-06, gnorm=3.145, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=11553
2022-05-07 23:38:49 - progress_bar.py[line:272] - INFO: epoch 001:   6189 / 17711 loss=3.355, loss_v1=0, loss_v2=0, nll_loss=1.124, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.355, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=34.999, expert1_balance_bottom=17.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=215, ups=0.57, wpb=379.2, bsz=32, num_updates=6180, lr=8.78217e-06, gnorm=3.753, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11570
2022-05-07 23:39:07 - progress_bar.py[line:272] - INFO: epoch 001:   6199 / 17711 loss=3.331, loss_v1=0, loss_v2=0, nll_loss=1.099, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880013, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.331, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=35.263, expert1_balance_bottom=17.87, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=219, ups=0.57, wpb=385.7, bsz=32, num_updates=6190, lr=8.77917e-06, gnorm=3.46, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11588
2022-05-07 23:39:25 - progress_bar.py[line:272] - INFO: epoch 001:   6209 / 17711 loss=3.326, loss_v1=0, loss_v2=0, nll_loss=1.085, ntokens=383.7, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.326, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=34.727, expert1_balance_bottom=17.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=214.5, ups=0.56, wpb=383.7, bsz=32, num_updates=6200, lr=8.77617e-06, gnorm=3.699, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11606
2022-05-07 23:39:43 - progress_bar.py[line:272] - INFO: epoch 001:   6219 / 17711 loss=3.329, loss_v1=0, loss_v2=0, nll_loss=1.094, ntokens=391.1, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.329, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=35.339, expert1_balance_bottom=17.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=217.6, ups=0.56, wpb=391.1, bsz=32, num_updates=6210, lr=8.77316e-06, gnorm=3.48, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11624
2022-05-07 23:40:01 - progress_bar.py[line:272] - INFO: epoch 001:   6229 / 17711 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=383.5, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.23, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=35.112, expert1_balance_bottom=17.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=213.2, ups=0.56, wpb=383.5, bsz=32, num_updates=6220, lr=8.77016e-06, gnorm=3.324, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11642
2022-05-07 23:40:19 - progress_bar.py[line:272] - INFO: epoch 001:   6239 / 17711 loss=3.34, loss_v1=0, loss_v2=0, nll_loss=1.106, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892644, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.34, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=34.555, expert1_balance_bottom=17.823, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=219.5, ups=0.57, wpb=388, bsz=32, num_updates=6230, lr=8.76716e-06, gnorm=3.456, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11659
2022-05-07 23:40:36 - progress_bar.py[line:272] - INFO: epoch 001:   6249 / 17711 loss=3.332, loss_v1=0, loss_v2=0, nll_loss=1.087, ntokens=377, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900233, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.332, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=34.234, expert1_balance_bottom=17.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=212.8, ups=0.56, wpb=377, bsz=32, num_updates=6240, lr=8.76415e-06, gnorm=3.533, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11677
2022-05-07 23:40:54 - progress_bar.py[line:272] - INFO: epoch 001:   6259 / 17711 loss=3.36, loss_v1=0, loss_v2=0, nll_loss=1.119, ntokens=384.8, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.36, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=35.216, expert1_balance_bottom=17.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=216.6, ups=0.56, wpb=384.8, bsz=32, num_updates=6250, lr=8.76115e-06, gnorm=3.943, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11695
2022-05-07 23:41:12 - progress_bar.py[line:272] - INFO: epoch 001:   6269 / 17711 loss=3.279, loss_v1=0, loss_v2=0, nll_loss=1.038, ntokens=385.9, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.279, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=35.122, expert1_balance_bottom=17.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=218, ups=0.56, wpb=385.9, bsz=32, num_updates=6260, lr=8.75815e-06, gnorm=3.34, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11712
2022-05-07 23:41:29 - progress_bar.py[line:272] - INFO: epoch 001:   6279 / 17711 loss=3.456, loss_v1=0, loss_v2=0, nll_loss=1.237, ntokens=388.9, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.456, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=34.978, expert1_balance_bottom=17.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.36, wps=221, ups=0.57, wpb=388.9, bsz=32, num_updates=6270, lr=8.75514e-06, gnorm=3.847, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11730
2022-05-07 23:41:47 - progress_bar.py[line:272] - INFO: epoch 001:   6289 / 17711 loss=3.358, loss_v1=0, loss_v2=0, nll_loss=1.129, ntokens=378.6, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892162, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.358, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.36, expert1_balance_top=34.859, expert1_balance_bottom=18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=211.2, ups=0.56, wpb=378.6, bsz=32, num_updates=6280, lr=8.75214e-06, gnorm=3.478, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11748
2022-05-07 23:42:05 - progress_bar.py[line:272] - INFO: epoch 001:   6299 / 17711 loss=3.419, loss_v1=0, loss_v2=0, nll_loss=1.183, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900148, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.419, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=34.395, expert1_balance_bottom=17.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=214.6, ups=0.56, wpb=380.2, bsz=32, num_updates=6290, lr=8.74914e-06, gnorm=3.944, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11766
2022-05-07 23:42:23 - progress_bar.py[line:272] - INFO: epoch 001:   6309 / 17711 loss=3.401, loss_v1=0, loss_v2=0, nll_loss=1.18, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.401, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=35.478, expert1_balance_bottom=17.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=217, ups=0.56, wpb=384.9, bsz=32, num_updates=6300, lr=8.74613e-06, gnorm=3.687, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11783
2022-05-07 23:42:40 - progress_bar.py[line:272] - INFO: epoch 001:   6319 / 17711 loss=3.372, loss_v1=0, loss_v2=0, nll_loss=1.128, ntokens=386.2, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.372, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=34.72, expert1_balance_bottom=17.771, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=221.5, ups=0.57, wpb=386.2, bsz=32, num_updates=6310, lr=8.74313e-06, gnorm=3.983, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11801
2022-05-07 23:42:58 - progress_bar.py[line:272] - INFO: epoch 001:   6329 / 17711 loss=3.299, loss_v1=0, loss_v2=0, nll_loss=1.052, ntokens=385.5, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892573, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.299, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=35.168, expert1_balance_bottom=17.736, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=214.2, ups=0.56, wpb=385.5, bsz=32, num_updates=6320, lr=8.74013e-06, gnorm=3.208, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11819
2022-05-07 23:43:15 - progress_bar.py[line:272] - INFO: epoch 001:   6339 / 17711 loss=3.354, loss_v1=0, loss_v2=0, nll_loss=1.111, ntokens=373.7, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892423, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.354, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=35.288, expert1_balance_bottom=17.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=215.4, ups=0.58, wpb=373.7, bsz=32, num_updates=6330, lr=8.73712e-06, gnorm=3.535, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11836
2022-05-07 23:43:33 - progress_bar.py[line:272] - INFO: epoch 001:   6349 / 17711 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=391.1, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.256, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=36.094, expert1_balance_bottom=17.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=223, ups=0.57, wpb=391.1, bsz=32, num_updates=6340, lr=8.73412e-06, gnorm=4.667, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11854
2022-05-07 23:43:50 - progress_bar.py[line:272] - INFO: epoch 001:   6359 / 17711 loss=3.279, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=386.9, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900438, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.279, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=34.602, expert1_balance_bottom=17.839, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=221.5, ups=0.57, wpb=386.9, bsz=32, num_updates=6350, lr=8.73112e-06, gnorm=3.814, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11871
2022-05-07 23:44:08 - progress_bar.py[line:272] - INFO: epoch 001:   6369 / 17711 loss=3.286, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.286, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=35.457, expert1_balance_bottom=17.782, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=217, ups=0.57, wpb=380.6, bsz=32, num_updates=6360, lr=8.72811e-06, gnorm=3.639, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11889
2022-05-07 23:44:26 - progress_bar.py[line:272] - INFO: epoch 001:   6379 / 17711 loss=3.439, loss_v1=0, loss_v2=0, nll_loss=1.214, ntokens=383.4, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891089, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.439, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=35.477, expert1_balance_bottom=17.668, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=215.4, ups=0.56, wpb=383.4, bsz=32, num_updates=6370, lr=8.72511e-06, gnorm=3.585, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11907
2022-05-07 23:44:44 - progress_bar.py[line:272] - INFO: epoch 001:   6389 / 17711 loss=3.305, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=374.3, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.305, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=35.349, expert1_balance_bottom=17.791, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=210.4, ups=0.56, wpb=374.3, bsz=32, num_updates=6380, lr=8.72211e-06, gnorm=4.122, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11924
2022-05-07 23:45:01 - progress_bar.py[line:272] - INFO: epoch 001:   6399 / 17711 loss=3.32, loss_v1=0, loss_v2=0, nll_loss=1.097, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.32, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=36.049, expert1_balance_bottom=17.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=215.1, ups=0.56, wpb=383.3, bsz=32, num_updates=6390, lr=8.7191e-06, gnorm=3.413, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=11942
2022-05-07 23:45:19 - progress_bar.py[line:272] - INFO: epoch 001:   6409 / 17711 loss=3.324, loss_v1=0, loss_v2=0, nll_loss=1.082, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889853, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.324, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=35.006, expert1_balance_bottom=17.57, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=214.2, ups=0.56, wpb=383.9, bsz=32, num_updates=6400, lr=8.7161e-06, gnorm=3.692, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11960
2022-05-07 23:45:37 - progress_bar.py[line:272] - INFO: epoch 001:   6419 / 17711 loss=3.352, loss_v1=0, loss_v2=0, nll_loss=1.112, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898191, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.352, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=34.658, expert1_balance_bottom=17.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=214.2, ups=0.57, wpb=377.5, bsz=32, num_updates=6410, lr=8.7131e-06, gnorm=3.314, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11978
2022-05-07 23:45:54 - progress_bar.py[line:272] - INFO: epoch 001:   6429 / 17711 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888262, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.196, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=34.943, expert1_balance_bottom=17.794, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=220.1, ups=0.57, wpb=382.8, bsz=32, num_updates=6420, lr=8.71009e-06, gnorm=3.135, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=11995
2022-05-07 23:46:12 - progress_bar.py[line:272] - INFO: epoch 001:   6439 / 17711 loss=3.33, loss_v1=0, loss_v2=0, nll_loss=1.098, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.33, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.359, expert1_balance_top=35.378, expert1_balance_bottom=17.612, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=217.5, ups=0.57, wpb=380, bsz=32, num_updates=6430, lr=8.70709e-06, gnorm=3.724, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=12013
2022-05-07 23:46:30 - progress_bar.py[line:272] - INFO: epoch 001:   6449 / 17711 loss=3.408, loss_v1=0, loss_v2=0, nll_loss=1.202, ntokens=387.5, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873137, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.408, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=36.074, expert1_balance_bottom=17.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.3, wps=217.4, ups=0.56, wpb=387.5, bsz=32, num_updates=6440, lr=8.70409e-06, gnorm=3.312, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12030
2022-05-07 23:46:47 - progress_bar.py[line:272] - INFO: epoch 001:   6459 / 17711 loss=3.269, loss_v1=0, loss_v2=0, nll_loss=1.04, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.269, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=35.503, expert1_balance_bottom=17.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=218.3, ups=0.56, wpb=386.5, bsz=32, num_updates=6450, lr=8.70108e-06, gnorm=3.16, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12048
2022-05-07 23:47:05 - progress_bar.py[line:272] - INFO: epoch 001:   6469 / 17711 loss=3.405, loss_v1=0, loss_v2=0, nll_loss=1.186, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.405, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=35.373, expert1_balance_bottom=17.619, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.28, wps=218, ups=0.57, wpb=383.2, bsz=32, num_updates=6460, lr=8.69808e-06, gnorm=4.313, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12066
2022-05-07 23:47:22 - progress_bar.py[line:272] - INFO: epoch 001:   6479 / 17711 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=1.024, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.274, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=34.545, expert1_balance_bottom=17.833, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=215, ups=0.57, wpb=377.4, bsz=32, num_updates=6470, lr=8.69508e-06, gnorm=4.182, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12083
2022-05-07 23:47:40 - progress_bar.py[line:272] - INFO: epoch 001:   6489 / 17711 loss=3.361, loss_v1=0, loss_v2=0, nll_loss=1.126, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.361, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=34.893, expert1_balance_bottom=17.698, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=219.7, ups=0.57, wpb=388.2, bsz=32, num_updates=6480, lr=8.69207e-06, gnorm=4.017, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12101
2022-05-07 23:47:58 - progress_bar.py[line:272] - INFO: epoch 001:   6499 / 17711 loss=3.38, loss_v1=0, loss_v2=0, nll_loss=1.153, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.38, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=35.342, expert1_balance_bottom=17.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=217.3, ups=0.56, wpb=385.2, bsz=32, num_updates=6490, lr=8.68907e-06, gnorm=3.538, loss_scale=256, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=12119
2022-05-07 23:48:15 - progress_bar.py[line:272] - INFO: epoch 001:   6509 / 17711 loss=3.375, loss_v1=0, loss_v2=0, nll_loss=1.154, ntokens=378.3, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887509, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.375, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=35.252, expert1_balance_bottom=17.787, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=216.1, ups=0.57, wpb=378.3, bsz=32, num_updates=6500, lr=8.68607e-06, gnorm=3.946, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12136
2022-05-07 23:48:33 - progress_bar.py[line:272] - INFO: epoch 001:   6519 / 17711 loss=3.363, loss_v1=0, loss_v2=0, nll_loss=1.13, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.363, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=34.97, expert1_balance_bottom=17.834, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=215.8, ups=0.56, wpb=384.2, bsz=32, num_updates=6510, lr=8.68306e-06, gnorm=3.602, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12154
2022-05-07 23:48:51 - progress_bar.py[line:272] - INFO: epoch 001:   6529 / 17711 loss=3.308, loss_v1=0, loss_v2=0, nll_loss=1.059, ntokens=379.4, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.308, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=34.96, expert1_balance_bottom=17.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=216.7, ups=0.57, wpb=379.4, bsz=32, num_updates=6520, lr=8.68006e-06, gnorm=3.915, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12171
2022-05-07 23:49:08 - progress_bar.py[line:272] - INFO: epoch 001:   6539 / 17711 loss=3.345, loss_v1=0, loss_v2=0, nll_loss=1.125, ntokens=387.8, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880557, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.345, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.405, expert1_balance_bottom=17.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=220.1, ups=0.57, wpb=387.8, bsz=32, num_updates=6530, lr=8.67706e-06, gnorm=3.747, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12189
2022-05-07 23:49:26 - progress_bar.py[line:272] - INFO: epoch 001:   6549 / 17711 loss=3.304, loss_v1=0, loss_v2=0, nll_loss=1.063, ntokens=384, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892731, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.304, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=34.926, expert1_balance_bottom=17.712, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=219.9, ups=0.57, wpb=384, bsz=32, num_updates=6540, lr=8.67405e-06, gnorm=3.553, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12207
2022-05-07 23:49:44 - progress_bar.py[line:272] - INFO: epoch 001:   6559 / 17711 loss=3.33, loss_v1=0, loss_v2=0, nll_loss=1.088, ntokens=365.7, nsentences=32, sample_size=290.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898232, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.33, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.358, expert1_balance_top=34.613, expert1_balance_bottom=17.713, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=205.3, ups=0.56, wpb=365.7, bsz=32, num_updates=6550, lr=8.67105e-06, gnorm=3.689, loss_scale=256, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=12224
2022-05-07 23:50:01 - progress_bar.py[line:272] - INFO: epoch 001:   6569 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.025, ntokens=388.2, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882488, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.801, expert1_balance_bottom=17.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=222.5, ups=0.57, wpb=388.2, bsz=32, num_updates=6560, lr=8.66805e-06, gnorm=3.026, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12242
2022-05-07 23:50:19 - progress_bar.py[line:272] - INFO: epoch 001:   6579 / 17711 loss=3.368, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=370.7, nsentences=32, sample_size=295, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.368, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=34.772, expert1_balance_bottom=17.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=210.2, ups=0.57, wpb=370.7, bsz=32, num_updates=6570, lr=8.66504e-06, gnorm=4.23, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12259
2022-05-07 23:50:33 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-07 23:50:38 - progress_bar.py[line:272] - INFO: epoch 001:   6590 / 17711 loss=3.407, loss_v1=0, loss_v2=0, nll_loss=1.175, ntokens=379.4, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.407, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=34.72, expert1_balance_bottom=17.801, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=198.1, ups=0.52, wpb=379.4, bsz=32, num_updates=6580, lr=8.66204e-06, gnorm=3.837, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12279
2022-05-07 23:50:55 - progress_bar.py[line:272] - INFO: epoch 001:   6600 / 17711 loss=3.334, loss_v1=0, loss_v2=0, nll_loss=1.099, ntokens=383.7, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.334, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.195, expert1_balance_bottom=17.715, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=221, ups=0.58, wpb=383.7, bsz=32, num_updates=6590, lr=8.65904e-06, gnorm=3.751, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12296
2022-05-07 23:51:13 - progress_bar.py[line:272] - INFO: epoch 001:   6610 / 17711 loss=3.295, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=393.1, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.295, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.431, expert1_balance_bottom=17.657, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=225.3, ups=0.57, wpb=393.1, bsz=32, num_updates=6600, lr=8.65604e-06, gnorm=3.302, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12313
2022-05-07 23:51:30 - progress_bar.py[line:272] - INFO: epoch 001:   6620 / 17711 loss=3.376, loss_v1=0, loss_v2=0, nll_loss=1.139, ntokens=387.9, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.376, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.295, expert1_balance_bottom=17.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=222.4, ups=0.57, wpb=387.9, bsz=32, num_updates=6610, lr=8.65303e-06, gnorm=4.028, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12331
2022-05-07 23:51:48 - progress_bar.py[line:272] - INFO: epoch 001:   6630 / 17711 loss=3.334, loss_v1=0, loss_v2=0, nll_loss=1.106, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.334, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.959, expert1_balance_bottom=17.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=219.1, ups=0.57, wpb=385.7, bsz=32, num_updates=6620, lr=8.65003e-06, gnorm=3.295, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12348
2022-05-07 23:52:05 - progress_bar.py[line:272] - INFO: epoch 001:   6640 / 17711 loss=3.296, loss_v1=0, loss_v2=0, nll_loss=1.076, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885042, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.296, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.154, expert1_balance_bottom=17.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=218.7, ups=0.57, wpb=385, bsz=32, num_updates=6630, lr=8.64703e-06, gnorm=3.603, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=12366
2022-05-07 23:52:23 - progress_bar.py[line:272] - INFO: epoch 001:   6650 / 17711 loss=3.378, loss_v1=0, loss_v2=0, nll_loss=1.152, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885576, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.378, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.632, expert1_balance_bottom=17.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=213, ups=0.56, wpb=378.6, bsz=32, num_updates=6640, lr=8.64402e-06, gnorm=4.075, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12384
2022-05-07 23:52:41 - progress_bar.py[line:272] - INFO: epoch 001:   6660 / 17711 loss=3.369, loss_v1=0, loss_v2=0, nll_loss=1.139, ntokens=378.2, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.369, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.151, expert1_balance_bottom=17.608, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=213.8, ups=0.57, wpb=378.2, bsz=32, num_updates=6650, lr=8.64102e-06, gnorm=3.66, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12402
2022-05-07 23:52:58 - progress_bar.py[line:272] - INFO: epoch 001:   6670 / 17711 loss=3.339, loss_v1=0, loss_v2=0, nll_loss=1.11, ntokens=374.5, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890661, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.339, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=35.564, expert1_balance_bottom=17.718, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=214.4, ups=0.57, wpb=374.5, bsz=32, num_updates=6660, lr=8.63802e-06, gnorm=3.86, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12419
2022-05-07 23:53:16 - progress_bar.py[line:272] - INFO: epoch 001:   6680 / 17711 loss=3.33, loss_v1=0, loss_v2=0, nll_loss=1.093, ntokens=374.8, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.33, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.356, expert1_balance_top=35.084, expert1_balance_bottom=17.722, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=212.6, ups=0.57, wpb=374.8, bsz=32, num_updates=6670, lr=8.63501e-06, gnorm=3.398, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12437
2022-05-07 23:53:33 - progress_bar.py[line:272] - INFO: epoch 001:   6690 / 17711 loss=3.306, loss_v1=0, loss_v2=0, nll_loss=1.075, ntokens=392.7, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882909, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.306, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.356, expert1_balance_top=35.878, expert1_balance_bottom=17.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=223.7, ups=0.57, wpb=392.7, bsz=32, num_updates=6680, lr=8.63201e-06, gnorm=3.833, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12454
2022-05-07 23:53:51 - progress_bar.py[line:272] - INFO: epoch 001:   6700 / 17711 loss=3.327, loss_v1=0, loss_v2=0, nll_loss=1.096, ntokens=382.2, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882529, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.327, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.356, expert1_balance_top=35.659, expert1_balance_bottom=17.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=214.3, ups=0.56, wpb=382.2, bsz=32, num_updates=6690, lr=8.62901e-06, gnorm=3.264, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12472
2022-05-07 23:54:09 - progress_bar.py[line:272] - INFO: epoch 001:   6710 / 17711 loss=3.314, loss_v1=0, loss_v2=0, nll_loss=1.082, ntokens=375.9, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.314, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.356, expert1_balance_top=35.245, expert1_balance_bottom=17.549, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=212.6, ups=0.57, wpb=375.9, bsz=32, num_updates=6700, lr=8.626e-06, gnorm=3.693, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12490
2022-05-07 23:54:27 - progress_bar.py[line:272] - INFO: epoch 001:   6720 / 17711 loss=3.291, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=380.3, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896326, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.291, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.357, expert1_balance_top=34.409, expert1_balance_bottom=18.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=213.7, ups=0.56, wpb=380.3, bsz=32, num_updates=6710, lr=8.623e-06, gnorm=3.577, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12508
2022-05-07 23:54:45 - progress_bar.py[line:272] - INFO: epoch 001:   6730 / 17711 loss=3.329, loss_v1=0, loss_v2=0, nll_loss=1.104, ntokens=392, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.329, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.356, expert1_balance_top=35.357, expert1_balance_bottom=17.987, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=217.6, ups=0.56, wpb=392, bsz=32, num_updates=6720, lr=8.62e-06, gnorm=3.621, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=12526
2022-05-07 23:55:03 - progress_bar.py[line:272] - INFO: epoch 001:   6740 / 17711 loss=3.349, loss_v1=0, loss_v2=0, nll_loss=1.125, ntokens=388.3, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.349, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.356, expert1_balance_top=35.462, expert1_balance_bottom=17.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=212, ups=0.55, wpb=388.3, bsz=32, num_updates=6730, lr=8.61699e-06, gnorm=3.738, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12544
2022-05-07 23:55:21 - progress_bar.py[line:272] - INFO: epoch 001:   6750 / 17711 loss=3.337, loss_v1=0, loss_v2=0, nll_loss=1.096, ntokens=384.5, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.337, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.356, expert1_balance_top=34.964, expert1_balance_bottom=17.804, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=209.9, ups=0.55, wpb=384.5, bsz=32, num_updates=6740, lr=8.61399e-06, gnorm=4.137, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12562
2022-05-07 23:55:40 - progress_bar.py[line:272] - INFO: epoch 001:   6760 / 17711 loss=3.319, loss_v1=0, loss_v2=0, nll_loss=1.081, ntokens=379.9, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.319, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=35.028, expert1_balance_bottom=17.575, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=209.6, ups=0.55, wpb=379.9, bsz=32, num_updates=6750, lr=8.61099e-06, gnorm=3.463, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12580
2022-05-07 23:55:58 - progress_bar.py[line:272] - INFO: epoch 001:   6770 / 17711 loss=3.27, loss_v1=0, loss_v2=0, nll_loss=1.042, ntokens=377.4, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878508, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.27, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=35.996, expert1_balance_bottom=17.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=201.9, ups=0.53, wpb=377.4, bsz=32, num_updates=6760, lr=8.60798e-06, gnorm=3.543, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12599
2022-05-07 23:56:17 - progress_bar.py[line:272] - INFO: epoch 001:   6780 / 17711 loss=3.334, loss_v1=0, loss_v2=0, nll_loss=1.093, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897062, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.334, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.567, expert1_balance_bottom=17.933, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=207.1, ups=0.54, wpb=382.9, bsz=32, num_updates=6770, lr=8.60498e-06, gnorm=3.809, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12617
2022-05-07 23:56:35 - progress_bar.py[line:272] - INFO: epoch 001:   6790 / 17711 loss=3.31, loss_v1=0, loss_v2=0, nll_loss=1.082, ntokens=389.9, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.31, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.356, expert1_balance_top=35.231, expert1_balance_bottom=17.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=217.7, ups=0.56, wpb=389.9, bsz=32, num_updates=6780, lr=8.60198e-06, gnorm=3.236, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12635
2022-05-07 23:56:53 - progress_bar.py[line:272] - INFO: epoch 001:   6800 / 17711 loss=3.283, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=384.4, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892498, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.283, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.356, expert1_balance_top=35.53, expert1_balance_bottom=17.657, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=212.2, ups=0.55, wpb=384.4, bsz=32, num_updates=6790, lr=8.59897e-06, gnorm=3.262, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=12654
2022-05-07 23:57:10 - progress_bar.py[line:272] - INFO: epoch 001:   6810 / 17711 loss=3.396, loss_v1=0, loss_v2=0, nll_loss=1.178, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879004, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.396, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=35.887, expert1_balance_bottom=17.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.26, wps=217, ups=0.56, wpb=385, bsz=32, num_updates=6800, lr=8.59597e-06, gnorm=3.918, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12671
2022-05-07 23:57:28 - progress_bar.py[line:272] - INFO: epoch 001:   6820 / 17711 loss=3.279, loss_v1=0, loss_v2=0, nll_loss=1.044, ntokens=376.1, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891198, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.279, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.885, expert1_balance_bottom=17.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=212.8, ups=0.57, wpb=376.1, bsz=32, num_updates=6810, lr=8.59297e-06, gnorm=3.972, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12689
2022-05-07 23:57:46 - progress_bar.py[line:272] - INFO: epoch 001:   6830 / 17711 loss=3.374, loss_v1=0, loss_v2=0, nll_loss=1.144, ntokens=389.5, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.374, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=35.13, expert1_balance_bottom=17.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=222.2, ups=0.57, wpb=389.5, bsz=32, num_updates=6820, lr=8.58996e-06, gnorm=3.768, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12706
2022-05-07 23:58:04 - progress_bar.py[line:272] - INFO: epoch 001:   6840 / 17711 loss=3.318, loss_v1=0, loss_v2=0, nll_loss=1.103, ntokens=385.4, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.318, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=35.937, expert1_balance_bottom=17.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=215.8, ups=0.56, wpb=385.4, bsz=32, num_updates=6830, lr=8.58696e-06, gnorm=3.58, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12724
2022-05-07 23:58:21 - progress_bar.py[line:272] - INFO: epoch 001:   6850 / 17711 loss=3.348, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=376.7, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.348, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.8, expert1_balance_bottom=17.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=214.4, ups=0.57, wpb=376.7, bsz=32, num_updates=6840, lr=8.58396e-06, gnorm=3.562, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12742
2022-05-07 23:58:39 - progress_bar.py[line:272] - INFO: epoch 001:   6860 / 17711 loss=3.317, loss_v1=0, loss_v2=0, nll_loss=1.079, ntokens=384, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894942, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.317, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.804, expert1_balance_bottom=18.022, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=216, ups=0.56, wpb=384, bsz=32, num_updates=6850, lr=8.58095e-06, gnorm=3.397, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12760
2022-05-07 23:58:57 - progress_bar.py[line:272] - INFO: epoch 001:   6870 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.059, ntokens=382.7, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=35.313, expert1_balance_bottom=17.746, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=215, ups=0.56, wpb=382.7, bsz=32, num_updates=6860, lr=8.57795e-06, gnorm=3.224, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12777
2022-05-07 23:59:14 - progress_bar.py[line:272] - INFO: epoch 001:   6880 / 17711 loss=3.346, loss_v1=0, loss_v2=0, nll_loss=1.107, ntokens=375.1, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892229, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.346, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.85, expert1_balance_bottom=17.882, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=214.7, ups=0.57, wpb=375.1, bsz=32, num_updates=6870, lr=8.57495e-06, gnorm=3.519, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12795
2022-05-07 23:59:32 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-07 23:59:33 - progress_bar.py[line:272] - INFO: epoch 001:   6891 / 17711 loss=3.391, loss_v1=0, loss_v2=0, nll_loss=1.157, ntokens=374.2, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899041, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.391, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.63, expert1_balance_bottom=18.009, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=193.6, ups=0.52, wpb=374.2, bsz=32, num_updates=6880, lr=8.57194e-06, gnorm=3.896, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12814
2022-05-07 23:59:51 - progress_bar.py[line:272] - INFO: epoch 001:   6901 / 17711 loss=3.341, loss_v1=0, loss_v2=0, nll_loss=1.109, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894843, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.341, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.669, expert1_balance_bottom=18.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=216.7, ups=0.57, wpb=380.9, bsz=32, num_updates=6890, lr=8.56894e-06, gnorm=4.014, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12832
2022-05-08 00:00:09 - progress_bar.py[line:272] - INFO: epoch 001:   6911 / 17711 loss=3.325, loss_v1=0, loss_v2=0, nll_loss=1.084, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.325, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.647, expert1_balance_bottom=17.783, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=214.9, ups=0.57, wpb=380.1, bsz=32, num_updates=6900, lr=8.56594e-06, gnorm=3.288, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12850
2022-05-08 00:00:26 - progress_bar.py[line:272] - INFO: epoch 001:   6921 / 17711 loss=3.329, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=378.9, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881724, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.329, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=35.548, expert1_balance_bottom=17.623, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=216.5, ups=0.57, wpb=378.9, bsz=32, num_updates=6910, lr=8.56293e-06, gnorm=3.486, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12867
2022-05-08 00:00:44 - progress_bar.py[line:272] - INFO: epoch 001:   6931 / 17711 loss=3.277, loss_v1=0, loss_v2=0, nll_loss=1.034, ntokens=385.7, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.277, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.816, expert1_balance_bottom=18.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=216.6, ups=0.56, wpb=385.7, bsz=32, num_updates=6920, lr=8.55993e-06, gnorm=3.425, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12885
2022-05-08 00:01:02 - progress_bar.py[line:272] - INFO: epoch 001:   6941 / 17711 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=390.1, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.238, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=35.535, expert1_balance_bottom=17.582, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=221.4, ups=0.57, wpb=390.1, bsz=32, num_updates=6930, lr=8.55693e-06, gnorm=3.305, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12902
2022-05-08 00:01:19 - progress_bar.py[line:272] - INFO: epoch 001:   6951 / 17711 loss=3.304, loss_v1=0, loss_v2=0, nll_loss=1.053, ntokens=381, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.304, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.355, expert1_balance_top=34.386, expert1_balance_bottom=17.945, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=216.9, ups=0.57, wpb=381, bsz=32, num_updates=6940, lr=8.55392e-06, gnorm=3.396, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12920
2022-05-08 00:01:37 - progress_bar.py[line:272] - INFO: epoch 001:   6961 / 17711 loss=3.343, loss_v1=0, loss_v2=0, nll_loss=1.106, ntokens=378.9, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.343, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.354, expert1_balance_top=34.836, expert1_balance_bottom=17.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=212.8, ups=0.56, wpb=378.9, bsz=32, num_updates=6950, lr=8.55092e-06, gnorm=3.53, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12938
2022-05-08 00:01:55 - progress_bar.py[line:272] - INFO: epoch 001:   6971 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894961, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.354, expert1_balance_top=34.848, expert1_balance_bottom=17.959, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=212.7, ups=0.56, wpb=378, bsz=32, num_updates=6960, lr=8.54792e-06, gnorm=3.961, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12956
2022-05-08 00:02:13 - progress_bar.py[line:272] - INFO: epoch 001:   6981 / 17711 loss=3.347, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=388.6, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.347, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.353, expert1_balance_top=36.033, expert1_balance_bottom=17.557, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=219.2, ups=0.56, wpb=388.6, bsz=32, num_updates=6970, lr=8.54491e-06, gnorm=3.509, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=12973
2022-05-08 00:02:30 - progress_bar.py[line:272] - INFO: epoch 001:   6991 / 17711 loss=3.353, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=379.7, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.353, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.354, expert1_balance_top=35.203, expert1_balance_bottom=17.644, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=215, ups=0.57, wpb=379.7, bsz=32, num_updates=6980, lr=8.54191e-06, gnorm=3.67, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=12991
2022-05-08 00:02:48 - progress_bar.py[line:272] - INFO: epoch 001:   7001 / 17711 loss=3.409, loss_v1=0, loss_v2=0, nll_loss=1.198, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.409, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.354, expert1_balance_top=35.923, expert1_balance_bottom=17.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.29, wps=217.7, ups=0.57, wpb=385.3, bsz=32, num_updates=6990, lr=8.53891e-06, gnorm=3.883, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13009
2022-05-08 00:03:05 - progress_bar.py[line:272] - INFO: epoch 001:   7011 / 17711 loss=3.351, loss_v1=0, loss_v2=0, nll_loss=1.128, ntokens=372.9, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.351, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.354, expert1_balance_top=35.312, expert1_balance_bottom=17.852, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=216.2, ups=0.58, wpb=372.9, bsz=32, num_updates=7000, lr=8.5359e-06, gnorm=3.367, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13026
2022-05-08 00:03:23 - progress_bar.py[line:272] - INFO: epoch 001:   7021 / 17711 loss=3.284, loss_v1=0, loss_v2=0, nll_loss=1.061, ntokens=375.4, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.284, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.353, expert1_balance_top=35.529, expert1_balance_bottom=17.392, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=215.2, ups=0.57, wpb=375.4, bsz=32, num_updates=7010, lr=8.5329e-06, gnorm=3.628, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13043
2022-05-08 00:03:40 - progress_bar.py[line:272] - INFO: epoch 001:   7031 / 17711 loss=3.349, loss_v1=0, loss_v2=0, nll_loss=1.11, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895596, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.349, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.353, expert1_balance_top=34.664, expert1_balance_bottom=17.663, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=216.6, ups=0.57, wpb=377.8, bsz=32, num_updates=7020, lr=8.5299e-06, gnorm=3.233, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13061
2022-05-08 00:03:58 - progress_bar.py[line:272] - INFO: epoch 001:   7041 / 17711 loss=3.295, loss_v1=0, loss_v2=0, nll_loss=1.07, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883525, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.295, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.353, expert1_balance_top=35.703, expert1_balance_bottom=17.612, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=216.1, ups=0.57, wpb=378.4, bsz=32, num_updates=7030, lr=8.52689e-06, gnorm=3.504, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13078
2022-05-08 00:04:15 - progress_bar.py[line:272] - INFO: epoch 001:   7051 / 17711 loss=3.35, loss_v1=0, loss_v2=0, nll_loss=1.114, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.35, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.354, expert1_balance_top=35.176, expert1_balance_bottom=17.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=221, ups=0.58, wpb=381.1, bsz=32, num_updates=7040, lr=8.52389e-06, gnorm=3.797, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13096
2022-05-08 00:04:32 - progress_bar.py[line:272] - INFO: epoch 001:   7061 / 17711 loss=3.29, loss_v1=0, loss_v2=0, nll_loss=1.057, ntokens=385.5, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882191, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.29, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.354, expert1_balance_top=35.713, expert1_balance_bottom=17.624, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=224.3, ups=0.58, wpb=385.5, bsz=32, num_updates=7050, lr=8.52089e-06, gnorm=3.506, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13113
2022-05-08 00:04:49 - progress_bar.py[line:272] - INFO: epoch 001:   7071 / 17711 loss=3.341, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.341, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.354, expert1_balance_top=35.765, expert1_balance_bottom=17.673, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=218.2, ups=0.57, wpb=380.6, bsz=32, num_updates=7060, lr=8.51788e-06, gnorm=3.858, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13130
2022-05-08 00:05:07 - progress_bar.py[line:272] - INFO: epoch 001:   7081 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=386.8, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.354, expert1_balance_top=34.98, expert1_balance_bottom=17.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=222.3, ups=0.57, wpb=386.8, bsz=32, num_updates=7070, lr=8.51488e-06, gnorm=3.151, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13148
2022-05-08 00:05:24 - progress_bar.py[line:272] - INFO: epoch 001:   7091 / 17711 loss=3.359, loss_v1=0, loss_v2=0, nll_loss=1.132, ntokens=389.4, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89115, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.359, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.353, expert1_balance_top=34.94, expert1_balance_bottom=17.705, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=222, ups=0.57, wpb=389.4, bsz=32, num_updates=7080, lr=8.51188e-06, gnorm=4.115, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=13165
2022-05-08 00:05:37 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 00:05:44 - progress_bar.py[line:272] - INFO: epoch 001:   7102 / 17711 loss=3.295, loss_v1=0, loss_v2=0, nll_loss=1.053, ntokens=386.6, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.295, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.353, expert1_balance_top=34.586, expert1_balance_bottom=18.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=198.9, ups=0.51, wpb=386.6, bsz=32, num_updates=7090, lr=8.50887e-06, gnorm=3.04, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13185
2022-05-08 00:06:01 - progress_bar.py[line:272] - INFO: epoch 001:   7112 / 17711 loss=3.33, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=392.8, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.33, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.353, expert1_balance_top=36.044, expert1_balance_bottom=17.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=229.9, ups=0.59, wpb=392.8, bsz=32, num_updates=7100, lr=8.50587e-06, gnorm=3.267, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13202
2022-05-08 00:06:18 - progress_bar.py[line:272] - INFO: epoch 001:   7122 / 17711 loss=3.295, loss_v1=0, loss_v2=0, nll_loss=1.055, ntokens=391.2, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.295, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.353, expert1_balance_top=34.5, expert1_balance_bottom=17.948, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=225.9, ups=0.58, wpb=391.2, bsz=32, num_updates=7110, lr=8.50287e-06, gnorm=3.377, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13219
2022-05-08 00:06:35 - progress_bar.py[line:272] - INFO: epoch 001:   7132 / 17711 loss=3.29, loss_v1=0, loss_v2=0, nll_loss=1.061, ntokens=388.9, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885153, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.29, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.353, expert1_balance_top=35.33, expert1_balance_bottom=17.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=225.7, ups=0.58, wpb=388.9, bsz=32, num_updates=7120, lr=8.49986e-06, gnorm=3.141, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13236
2022-05-08 00:06:53 - progress_bar.py[line:272] - INFO: epoch 001:   7142 / 17711 loss=3.319, loss_v1=0, loss_v2=0, nll_loss=1.08, ntokens=382.5, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.319, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.352, expert1_balance_top=35.317, expert1_balance_bottom=17.849, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=222.5, ups=0.58, wpb=382.5, bsz=32, num_updates=7130, lr=8.49686e-06, gnorm=3.171, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=13253
2022-05-08 00:07:10 - progress_bar.py[line:272] - INFO: epoch 001:   7152 / 17711 loss=3.384, loss_v1=0, loss_v2=0, nll_loss=1.158, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.384, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.352, expert1_balance_top=34.775, expert1_balance_bottom=17.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.23, wps=223.1, ups=0.58, wpb=383.3, bsz=32, num_updates=7140, lr=8.49386e-06, gnorm=3.897, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13271
2022-05-08 00:07:27 - progress_bar.py[line:272] - INFO: epoch 001:   7162 / 17711 loss=3.312, loss_v1=0, loss_v2=0, nll_loss=1.087, ntokens=383.8, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886079, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.312, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.352, expert1_balance_top=35.862, expert1_balance_bottom=17.617, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=221, ups=0.58, wpb=383.8, bsz=32, num_updates=7150, lr=8.49086e-06, gnorm=3.968, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13288
2022-05-08 00:07:45 - progress_bar.py[line:272] - INFO: epoch 001:   7172 / 17711 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=1.015, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870742, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.24, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.352, expert1_balance_top=36.175, expert1_balance_bottom=17.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=221.3, ups=0.58, wpb=384.5, bsz=32, num_updates=7160, lr=8.48785e-06, gnorm=3.126, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13305
2022-05-08 00:08:02 - progress_bar.py[line:272] - INFO: epoch 001:   7182 / 17711 loss=3.351, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893125, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.351, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.352, expert1_balance_top=35.264, expert1_balance_bottom=18.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=220.2, ups=0.57, wpb=383.8, bsz=32, num_updates=7170, lr=8.48485e-06, gnorm=3.378, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13323
2022-05-08 00:08:19 - progress_bar.py[line:272] - INFO: epoch 001:   7192 / 17711 loss=3.351, loss_v1=0, loss_v2=0, nll_loss=1.128, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887514, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.351, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.352, expert1_balance_top=35.609, expert1_balance_bottom=17.688, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=218.9, ups=0.58, wpb=379.7, bsz=32, num_updates=7180, lr=8.48185e-06, gnorm=3.765, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13340
2022-05-08 00:08:37 - progress_bar.py[line:272] - INFO: epoch 001:   7202 / 17711 loss=3.417, loss_v1=0, loss_v2=0, nll_loss=1.211, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.417, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=36.618, expert1_balance_bottom=17.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.32, wps=219.1, ups=0.58, wpb=378.7, bsz=32, num_updates=7190, lr=8.47884e-06, gnorm=3.857, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13357
2022-05-08 00:08:54 - progress_bar.py[line:272] - INFO: epoch 001:   7212 / 17711 loss=3.332, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894819, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.332, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.352, expert1_balance_top=35.15, expert1_balance_bottom=17.67, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=220.3, ups=0.58, wpb=381.7, bsz=32, num_updates=7200, lr=8.47584e-06, gnorm=4.012, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13375
2022-05-08 00:09:11 - progress_bar.py[line:272] - INFO: epoch 001:   7222 / 17711 loss=3.252, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=381.5, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.252, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=36.057, expert1_balance_bottom=17.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=218.3, ups=0.57, wpb=381.5, bsz=32, num_updates=7210, lr=8.47284e-06, gnorm=3.266, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13392
2022-05-08 00:09:29 - progress_bar.py[line:272] - INFO: epoch 001:   7232 / 17711 loss=3.332, loss_v1=0, loss_v2=0, nll_loss=1.108, ntokens=380.6, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.332, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.352, expert1_balance_top=35.562, expert1_balance_bottom=17.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=217, ups=0.57, wpb=380.6, bsz=32, num_updates=7220, lr=8.46983e-06, gnorm=3.762, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13410
2022-05-08 00:09:46 - progress_bar.py[line:272] - INFO: epoch 001:   7242 / 17711 loss=3.304, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=387.1, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895731, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.304, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=35.266, expert1_balance_bottom=17.671, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=224.8, ups=0.58, wpb=387.1, bsz=32, num_updates=7230, lr=8.46683e-06, gnorm=3.591, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13427
2022-05-08 00:10:04 - progress_bar.py[line:272] - INFO: epoch 001:   7252 / 17711 loss=3.342, loss_v1=0, loss_v2=0, nll_loss=1.127, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.342, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=36.16, expert1_balance_bottom=17.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=217.1, ups=0.57, wpb=380.7, bsz=32, num_updates=7240, lr=8.46383e-06, gnorm=3.997, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13445
2022-05-08 00:10:21 - progress_bar.py[line:272] - INFO: epoch 001:   7262 / 17711 loss=3.341, loss_v1=0, loss_v2=0, nll_loss=1.111, ntokens=374.3, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.341, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=34.47, expert1_balance_bottom=18.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=214.9, ups=0.57, wpb=374.3, bsz=32, num_updates=7250, lr=8.46082e-06, gnorm=3.61, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13462
2022-05-08 00:10:38 - progress_bar.py[line:272] - INFO: epoch 001:   7272 / 17711 loss=3.283, loss_v1=0, loss_v2=0, nll_loss=1.037, ntokens=375.1, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897422, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.283, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=34.274, expert1_balance_bottom=18.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=219.2, ups=0.58, wpb=375.1, bsz=32, num_updates=7260, lr=8.45782e-06, gnorm=3.792, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13479
2022-05-08 00:10:56 - progress_bar.py[line:272] - INFO: epoch 001:   7282 / 17711 loss=3.311, loss_v1=0, loss_v2=0, nll_loss=1.08, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.311, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=34.913, expert1_balance_bottom=17.76, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=216.7, ups=0.57, wpb=381.5, bsz=32, num_updates=7270, lr=8.45482e-06, gnorm=3.3, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13497
2022-05-08 00:11:13 - progress_bar.py[line:272] - INFO: epoch 001:   7292 / 17711 loss=3.313, loss_v1=0, loss_v2=0, nll_loss=1.086, ntokens=374.2, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.313, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=35.384, expert1_balance_bottom=17.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=214.4, ups=0.57, wpb=374.2, bsz=32, num_updates=7280, lr=8.45181e-06, gnorm=3.5, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=13514
2022-05-08 00:11:31 - progress_bar.py[line:272] - INFO: epoch 001:   7302 / 17711 loss=3.279, loss_v1=0, loss_v2=0, nll_loss=1.039, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886608, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.279, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=35.378, expert1_balance_bottom=17.88, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=223.1, ups=0.58, wpb=386.1, bsz=32, num_updates=7290, lr=8.44881e-06, gnorm=3.279, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13531
2022-05-08 00:11:48 - progress_bar.py[line:272] - INFO: epoch 001:   7312 / 17711 loss=3.271, loss_v1=0, loss_v2=0, nll_loss=1.045, ntokens=376.1, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.271, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=35.437, expert1_balance_bottom=17.892, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=216, ups=0.57, wpb=376.1, bsz=32, num_updates=7300, lr=8.44581e-06, gnorm=3.649, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13549
2022-05-08 00:12:06 - progress_bar.py[line:272] - INFO: epoch 001:   7322 / 17711 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=375.9, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.22, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=35.493, expert1_balance_bottom=17.883, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=214.1, ups=0.57, wpb=375.9, bsz=32, num_updates=7310, lr=8.4428e-06, gnorm=3.598, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=13566
2022-05-08 00:12:23 - progress_bar.py[line:272] - INFO: epoch 001:   7332 / 17711 loss=3.323, loss_v1=0, loss_v2=0, nll_loss=1.089, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892861, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.323, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=34.466, expert1_balance_bottom=18.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=217.1, ups=0.57, wpb=381.7, bsz=32, num_updates=7320, lr=8.4398e-06, gnorm=4.141, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13584
2022-05-08 00:12:41 - progress_bar.py[line:272] - INFO: epoch 001:   7342 / 17711 loss=3.342, loss_v1=0, loss_v2=0, nll_loss=1.121, ntokens=379.6, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877554, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.342, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=35.645, expert1_balance_bottom=17.666, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=217.7, ups=0.57, wpb=379.6, bsz=32, num_updates=7330, lr=8.4368e-06, gnorm=3.342, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13601
2022-05-08 00:12:58 - progress_bar.py[line:272] - INFO: epoch 001:   7352 / 17711 loss=3.242, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=385, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884125, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.242, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=35.457, expert1_balance_bottom=17.675, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=216.4, ups=0.56, wpb=385, bsz=32, num_updates=7340, lr=8.43379e-06, gnorm=3.356, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13619
2022-05-08 00:13:16 - progress_bar.py[line:272] - INFO: epoch 001:   7362 / 17711 loss=3.357, loss_v1=0, loss_v2=0, nll_loss=1.13, ntokens=374.8, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.357, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.351, expert1_balance_top=35.228, expert1_balance_bottom=17.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=211.1, ups=0.56, wpb=374.8, bsz=32, num_updates=7350, lr=8.43079e-06, gnorm=3.311, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13637
2022-05-08 00:13:34 - progress_bar.py[line:272] - INFO: epoch 001:   7372 / 17711 loss=3.331, loss_v1=0, loss_v2=0, nll_loss=1.098, ntokens=383.4, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885099, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.331, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=35.65, expert1_balance_bottom=17.725, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=216.8, ups=0.57, wpb=383.4, bsz=32, num_updates=7360, lr=8.42779e-06, gnorm=3.221, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13655
2022-05-08 00:13:51 - progress_bar.py[line:272] - INFO: epoch 001:   7382 / 17711 loss=3.312, loss_v1=0, loss_v2=0, nll_loss=1.079, ntokens=382.3, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893961, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.312, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=34.801, expert1_balance_bottom=17.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=218.5, ups=0.57, wpb=382.3, bsz=32, num_updates=7370, lr=8.42478e-06, gnorm=3.26, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=13672
2022-05-08 00:14:09 - progress_bar.py[line:272] - INFO: epoch 001:   7392 / 17711 loss=3.26, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=380.1, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.26, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=35.039, expert1_balance_bottom=17.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=215.8, ups=0.57, wpb=380.1, bsz=32, num_updates=7380, lr=8.42178e-06, gnorm=3.325, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13690
2022-05-08 00:14:27 - progress_bar.py[line:272] - INFO: epoch 001:   7402 / 17711 loss=3.303, loss_v1=0, loss_v2=0, nll_loss=1.067, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.303, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=35.134, expert1_balance_bottom=17.738, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=216.4, ups=0.57, wpb=380, bsz=32, num_updates=7390, lr=8.41878e-06, gnorm=4.016, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13707
2022-05-08 00:14:44 - progress_bar.py[line:272] - INFO: epoch 001:   7412 / 17711 loss=3.309, loss_v1=0, loss_v2=0, nll_loss=1.09, ntokens=378.7, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.309, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=35.911, expert1_balance_bottom=17.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=214.4, ups=0.57, wpb=378.7, bsz=32, num_updates=7400, lr=8.41577e-06, gnorm=4.142, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13725
2022-05-08 00:15:02 - progress_bar.py[line:272] - INFO: epoch 001:   7422 / 17711 loss=3.327, loss_v1=0, loss_v2=0, nll_loss=1.112, ntokens=388.1, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876443, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.327, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=35.953, expert1_balance_bottom=17.513, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=218.6, ups=0.56, wpb=388.1, bsz=32, num_updates=7410, lr=8.41277e-06, gnorm=3.686, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13743
2022-05-08 00:15:20 - progress_bar.py[line:272] - INFO: epoch 001:   7432 / 17711 loss=3.321, loss_v1=0, loss_v2=0, nll_loss=1.092, ntokens=383.8, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.321, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=35.102, expert1_balance_bottom=17.699, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=211.9, ups=0.55, wpb=383.8, bsz=32, num_updates=7420, lr=8.40977e-06, gnorm=3.851, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13761
2022-05-08 00:15:38 - progress_bar.py[line:272] - INFO: epoch 001:   7442 / 17711 loss=3.291, loss_v1=0, loss_v2=0, nll_loss=1.051, ntokens=373.8, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.291, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=35.179, expert1_balance_bottom=17.838, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=212.6, ups=0.57, wpb=373.8, bsz=32, num_updates=7430, lr=8.40676e-06, gnorm=3.838, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13778
2022-05-08 00:15:55 - progress_bar.py[line:272] - INFO: epoch 001:   7452 / 17711 loss=3.266, loss_v1=0, loss_v2=0, nll_loss=1.022, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.266, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.077, expert1_balance_bottom=17.841, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=219.8, ups=0.58, wpb=381.2, bsz=32, num_updates=7440, lr=8.40376e-06, gnorm=3.346, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13796
2022-05-08 00:16:13 - progress_bar.py[line:272] - INFO: epoch 001:   7462 / 17711 loss=3.356, loss_v1=0, loss_v2=0, nll_loss=1.14, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.356, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.35, expert1_balance_top=36.172, expert1_balance_bottom=17.563, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=218.9, ups=0.57, wpb=384.5, bsz=32, num_updates=7450, lr=8.40076e-06, gnorm=3.352, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13813
2022-05-08 00:16:30 - progress_bar.py[line:272] - INFO: epoch 001:   7472 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=379.5, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.362, expert1_balance_bottom=18.081, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220.1, ups=0.58, wpb=379.5, bsz=32, num_updates=7460, lr=8.39775e-06, gnorm=3.181, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13831
2022-05-08 00:16:47 - progress_bar.py[line:272] - INFO: epoch 001:   7482 / 17711 loss=3.251, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=385.3, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.251, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.046, expert1_balance_bottom=18.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=220.5, ups=0.57, wpb=385.3, bsz=32, num_updates=7470, lr=8.39475e-06, gnorm=3.546, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13848
2022-05-08 00:17:05 - progress_bar.py[line:272] - INFO: epoch 001:   7492 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=381.4, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87833, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.73, expert1_balance_bottom=17.737, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=219.3, ups=0.58, wpb=381.4, bsz=32, num_updates=7480, lr=8.39175e-06, gnorm=3.28, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13865
2022-05-08 00:17:22 - progress_bar.py[line:272] - INFO: epoch 001:   7502 / 17711 loss=3.327, loss_v1=0, loss_v2=0, nll_loss=1.104, ntokens=383.5, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87956, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.327, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.577, expert1_balance_bottom=17.725, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=221.7, ups=0.58, wpb=383.5, bsz=32, num_updates=7490, lr=8.38874e-06, gnorm=3.293, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13883
2022-05-08 00:17:40 - progress_bar.py[line:272] - INFO: epoch 001:   7512 / 17711 loss=3.285, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=379.1, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.285, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.339, expert1_balance_bottom=17.897, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=213.8, ups=0.56, wpb=379.1, bsz=32, num_updates=7500, lr=8.38574e-06, gnorm=3.176, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13900
2022-05-08 00:17:57 - progress_bar.py[line:272] - INFO: epoch 001:   7522 / 17711 loss=3.285, loss_v1=0, loss_v2=0, nll_loss=1.045, ntokens=375.7, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.285, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.293, expert1_balance_bottom=17.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=213.2, ups=0.57, wpb=375.7, bsz=32, num_updates=7510, lr=8.38274e-06, gnorm=3.795, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=13918
2022-05-08 00:18:15 - progress_bar.py[line:272] - INFO: epoch 001:   7532 / 17711 loss=3.315, loss_v1=0, loss_v2=0, nll_loss=1.074, ntokens=376.4, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.315, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=34.534, expert1_balance_bottom=18.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=210.4, ups=0.56, wpb=376.4, bsz=32, num_updates=7520, lr=8.37973e-06, gnorm=3.832, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=13936
2022-05-08 00:18:33 - progress_bar.py[line:272] - INFO: epoch 001:   7542 / 17711 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.992, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.229, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=35.121, expert1_balance_bottom=17.996, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=219.3, ups=0.57, wpb=384.2, bsz=32, num_updates=7530, lr=8.37673e-06, gnorm=3.301, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.8, cuda_gb_free=9.7, wall=13953
2022-05-08 00:18:50 - progress_bar.py[line:272] - INFO: epoch 001:   7552 / 17711 loss=3.365, loss_v1=0, loss_v2=0, nll_loss=1.135, ntokens=372.9, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.365, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=34.901, expert1_balance_bottom=18.034, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=217.1, ups=0.58, wpb=372.9, bsz=32, num_updates=7540, lr=8.37373e-06, gnorm=3.81, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13971
2022-05-08 00:19:07 - progress_bar.py[line:272] - INFO: epoch 001:   7562 / 17711 loss=3.263, loss_v1=0, loss_v2=0, nll_loss=1.032, ntokens=386.2, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.263, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.164, expert1_balance_bottom=17.833, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=220.9, ups=0.57, wpb=386.2, bsz=32, num_updates=7550, lr=8.37072e-06, gnorm=3.543, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=13988
2022-05-08 00:19:25 - progress_bar.py[line:272] - INFO: epoch 001:   7572 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=383.5, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.786, expert1_balance_bottom=17.759, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=219, ups=0.57, wpb=383.5, bsz=32, num_updates=7560, lr=8.36772e-06, gnorm=3.235, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=14006
2022-05-08 00:19:42 - progress_bar.py[line:272] - INFO: epoch 001:   7582 / 17711 loss=3.286, loss_v1=0, loss_v2=0, nll_loss=1.064, ntokens=374.9, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88029, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.286, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=35.427, expert1_balance_bottom=17.913, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=214.4, ups=0.57, wpb=374.9, bsz=32, num_updates=7570, lr=8.36472e-06, gnorm=3.851, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=14023
2022-05-08 00:20:00 - progress_bar.py[line:272] - INFO: epoch 001:   7592 / 17711 loss=3.285, loss_v1=0, loss_v2=0, nll_loss=1.049, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886024, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.285, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=35.284, expert1_balance_bottom=17.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=219.5, ups=0.58, wpb=381, bsz=32, num_updates=7580, lr=8.36171e-06, gnorm=3.414, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=14040
2022-05-08 00:20:17 - progress_bar.py[line:272] - INFO: epoch 001:   7602 / 17711 loss=3.342, loss_v1=0, loss_v2=0, nll_loss=1.111, ntokens=371.1, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.342, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.349, expert1_balance_top=35.495, expert1_balance_bottom=17.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=219.2, ups=0.59, wpb=371.1, bsz=32, num_updates=7590, lr=8.35871e-06, gnorm=3.805, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=14057
2022-05-08 00:20:34 - progress_bar.py[line:272] - INFO: epoch 001:   7612 / 17711 loss=3.277, loss_v1=0, loss_v2=0, nll_loss=1.052, ntokens=388.5, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.277, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=36.162, expert1_balance_bottom=17.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=228.8, ups=0.59, wpb=388.5, bsz=32, num_updates=7600, lr=8.35571e-06, gnorm=3.678, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=14074
2022-05-08 00:20:51 - progress_bar.py[line:272] - INFO: epoch 001:   7622 / 17711 loss=3.326, loss_v1=0, loss_v2=0, nll_loss=1.106, ntokens=378.6, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.326, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=36.186, expert1_balance_bottom=17.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=215.7, ups=0.57, wpb=378.6, bsz=32, num_updates=7610, lr=8.3527e-06, gnorm=4.135, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=14092
2022-05-08 00:21:09 - progress_bar.py[line:272] - INFO: epoch 001:   7632 / 17711 loss=3.314, loss_v1=0, loss_v2=0, nll_loss=1.085, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.314, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=35.305, expert1_balance_bottom=17.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=222.5, ups=0.58, wpb=385.3, bsz=32, num_updates=7620, lr=8.3497e-06, gnorm=3.75, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=14109
2022-05-08 00:21:26 - progress_bar.py[line:272] - INFO: epoch 001:   7642 / 17711 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=381.5, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.227, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=35.001, expert1_balance_bottom=17.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=218.6, ups=0.57, wpb=381.5, bsz=32, num_updates=7630, lr=8.3467e-06, gnorm=3.803, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.8, cuda_gb_free=9.6, wall=14127
2022-05-08 00:21:44 - progress_bar.py[line:272] - INFO: epoch 001:   7652 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=35.032, expert1_balance_bottom=17.727, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=209.9, ups=0.55, wpb=382.1, bsz=32, num_updates=7640, lr=8.34369e-06, gnorm=2.933, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14145
2022-05-08 00:22:02 - progress_bar.py[line:272] - INFO: epoch 001:   7662 / 17711 loss=3.325, loss_v1=0, loss_v2=0, nll_loss=1.107, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.325, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=35.422, expert1_balance_bottom=17.666, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=219.6, ups=0.57, wpb=383.3, bsz=32, num_updates=7650, lr=8.34069e-06, gnorm=3.654, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14162
2022-05-08 00:22:19 - progress_bar.py[line:272] - INFO: epoch 001:   7672 / 17711 loss=3.34, loss_v1=0, loss_v2=0, nll_loss=1.115, ntokens=382.1, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888733, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.34, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=34.962, expert1_balance_bottom=18.084, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=219.9, ups=0.58, wpb=382.1, bsz=32, num_updates=7660, lr=8.33769e-06, gnorm=3.324, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14180
2022-05-08 00:22:36 - progress_bar.py[line:272] - INFO: epoch 001:   7682 / 17711 loss=3.343, loss_v1=0, loss_v2=0, nll_loss=1.114, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883992, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.343, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=35.661, expert1_balance_bottom=17.692, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=219.1, ups=0.57, wpb=382.2, bsz=32, num_updates=7670, lr=8.33468e-06, gnorm=3.522, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14197
2022-05-08 00:22:54 - progress_bar.py[line:272] - INFO: epoch 001:   7692 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=376.9, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=34.753, expert1_balance_bottom=18.191, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=215.9, ups=0.57, wpb=376.9, bsz=32, num_updates=7680, lr=8.33168e-06, gnorm=3.295, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14215
2022-05-08 00:23:11 - progress_bar.py[line:272] - INFO: epoch 001:   7702 / 17711 loss=3.305, loss_v1=0, loss_v2=0, nll_loss=1.09, ntokens=376.9, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.305, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=36.152, expert1_balance_bottom=17.729, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=215.1, ups=0.57, wpb=376.9, bsz=32, num_updates=7690, lr=8.32868e-06, gnorm=3.598, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14232
2022-05-08 00:23:29 - progress_bar.py[line:272] - INFO: epoch 001:   7712 / 17711 loss=3.321, loss_v1=0, loss_v2=0, nll_loss=1.098, ntokens=379.4, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885328, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.321, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=35.781, expert1_balance_bottom=17.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=217.2, ups=0.57, wpb=379.4, bsz=32, num_updates=7700, lr=8.32567e-06, gnorm=3.373, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14250
2022-05-08 00:23:46 - progress_bar.py[line:272] - INFO: epoch 001:   7722 / 17711 loss=3.338, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.338, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.348, expert1_balance_top=35.95, expert1_balance_bottom=17.602, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=220.1, ups=0.58, wpb=381.9, bsz=32, num_updates=7710, lr=8.32267e-06, gnorm=3.762, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14267
2022-05-08 00:24:04 - progress_bar.py[line:272] - INFO: epoch 001:   7732 / 17711 loss=3.322, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.322, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=35.429, expert1_balance_bottom=17.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=220.7, ups=0.58, wpb=383.2, bsz=32, num_updates=7720, lr=8.31967e-06, gnorm=3.681, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14284
2022-05-08 00:24:21 - progress_bar.py[line:272] - INFO: epoch 001:   7742 / 17711 loss=3.263, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=379.4, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.263, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=35.41, expert1_balance_bottom=17.863, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=220.1, ups=0.58, wpb=379.4, bsz=32, num_updates=7730, lr=8.31667e-06, gnorm=3.202, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14302
2022-05-08 00:24:38 - progress_bar.py[line:272] - INFO: epoch 001:   7752 / 17711 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=1.023, ntokens=392.1, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.239, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=35.482, expert1_balance_bottom=17.837, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=228.9, ups=0.58, wpb=392.1, bsz=32, num_updates=7740, lr=8.31366e-06, gnorm=3.241, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14319
2022-05-08 00:24:55 - progress_bar.py[line:272] - INFO: epoch 001:   7762 / 17711 loss=3.289, loss_v1=0, loss_v2=0, nll_loss=1.069, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879307, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.289, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=35.21, expert1_balance_bottom=17.793, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=217.5, ups=0.58, wpb=377.5, bsz=32, num_updates=7750, lr=8.31066e-06, gnorm=3.543, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14336
2022-05-08 00:25:13 - progress_bar.py[line:272] - INFO: epoch 001:   7772 / 17711 loss=3.336, loss_v1=0, loss_v2=0, nll_loss=1.096, ntokens=381.2, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903552, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.336, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=34.536, expert1_balance_bottom=18.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=215.2, ups=0.56, wpb=381.2, bsz=32, num_updates=7760, lr=8.30766e-06, gnorm=3.469, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14354
2022-05-08 00:25:31 - progress_bar.py[line:272] - INFO: epoch 001:   7782 / 17711 loss=3.327, loss_v1=0, loss_v2=0, nll_loss=1.113, ntokens=384.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876961, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.327, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=35.899, expert1_balance_bottom=17.608, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=220.1, ups=0.57, wpb=384.3, bsz=32, num_updates=7770, lr=8.30465e-06, gnorm=3.431, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14371
2022-05-08 00:25:48 - progress_bar.py[line:272] - INFO: epoch 001:   7792 / 17711 loss=3.28, loss_v1=0, loss_v2=0, nll_loss=1.04, ntokens=379.8, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.28, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.347, expert1_balance_top=34.758, expert1_balance_bottom=17.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=217.3, ups=0.57, wpb=379.8, bsz=32, num_updates=7780, lr=8.30165e-06, gnorm=3.784, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=14389
2022-05-08 00:26:05 - progress_bar.py[line:272] - INFO: epoch 001:   7802 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.024, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893269, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=34.906, expert1_balance_bottom=17.801, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=220.7, ups=0.58, wpb=383.2, bsz=32, num_updates=7790, lr=8.29865e-06, gnorm=3.943, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14406
2022-05-08 00:26:23 - progress_bar.py[line:272] - INFO: epoch 001:   7812 / 17711 loss=3.269, loss_v1=0, loss_v2=0, nll_loss=1.037, ntokens=396.9, nsentences=32, sample_size=316, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.269, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=35.593, expert1_balance_bottom=17.798, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=224.8, ups=0.57, wpb=396.9, bsz=32, num_updates=7800, lr=8.29564e-06, gnorm=3.35, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14424
2022-05-08 00:26:40 - progress_bar.py[line:272] - INFO: epoch 001:   7822 / 17711 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.991, ntokens=392.5, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.22, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=35.785, expert1_balance_bottom=17.811, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=227.8, ups=0.58, wpb=392.5, bsz=32, num_updates=7810, lr=8.29264e-06, gnorm=3.504, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14441
2022-05-08 00:26:57 - progress_bar.py[line:272] - INFO: epoch 001:   7832 / 17711 loss=3.361, loss_v1=0, loss_v2=0, nll_loss=1.135, ntokens=391.4, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.361, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=35.356, expert1_balance_bottom=17.973, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=228.6, ups=0.58, wpb=391.4, bsz=32, num_updates=7820, lr=8.28964e-06, gnorm=3.659, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14458
2022-05-08 00:27:15 - progress_bar.py[line:272] - INFO: epoch 001:   7842 / 17711 loss=3.277, loss_v1=0, loss_v2=0, nll_loss=1.062, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.277, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.857, expert1_balance_bottom=17.77, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=221, ups=0.58, wpb=379.8, bsz=32, num_updates=7830, lr=8.28663e-06, gnorm=3.705, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=14475
2022-05-08 00:27:32 - progress_bar.py[line:272] - INFO: epoch 001:   7852 / 17711 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=1.016, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.243, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.727, expert1_balance_bottom=17.945, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=218, ups=0.57, wpb=385.6, bsz=32, num_updates=7840, lr=8.28363e-06, gnorm=3.356, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14493
2022-05-08 00:27:50 - progress_bar.py[line:272] - INFO: epoch 001:   7862 / 17711 loss=3.346, loss_v1=0, loss_v2=0, nll_loss=1.132, ntokens=392.8, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.346, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=36.041, expert1_balance_bottom=17.649, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=223.3, ups=0.57, wpb=392.8, bsz=32, num_updates=7850, lr=8.28063e-06, gnorm=3.332, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14511
2022-05-08 00:28:07 - progress_bar.py[line:272] - INFO: epoch 001:   7872 / 17711 loss=3.266, loss_v1=0, loss_v2=0, nll_loss=1.048, ntokens=389, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870718, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.266, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=36.394, expert1_balance_bottom=17.503, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=223.6, ups=0.57, wpb=389, bsz=32, num_updates=7860, lr=8.27762e-06, gnorm=3.704, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14528
2022-05-08 00:28:25 - progress_bar.py[line:272] - INFO: epoch 001:   7882 / 17711 loss=3.375, loss_v1=0, loss_v2=0, nll_loss=1.15, ntokens=368.7, nsentences=32, sample_size=293.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.375, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=35.274, expert1_balance_bottom=17.764, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.22, wps=209.6, ups=0.57, wpb=368.7, bsz=32, num_updates=7870, lr=8.27462e-06, gnorm=3.739, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14546
2022-05-08 00:28:42 - progress_bar.py[line:272] - INFO: epoch 001:   7892 / 17711 loss=3.399, loss_v1=0, loss_v2=0, nll_loss=1.18, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888081, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.399, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.552, expert1_balance_bottom=18.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.27, wps=223.8, ups=0.59, wpb=379.2, bsz=32, num_updates=7880, lr=8.27162e-06, gnorm=3.847, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14563
2022-05-08 00:28:59 - progress_bar.py[line:272] - INFO: epoch 001:   7902 / 17711 loss=3.277, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.277, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.039, expert1_balance_bottom=17.918, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=217.3, ups=0.57, wpb=378.7, bsz=32, num_updates=7890, lr=8.26861e-06, gnorm=3.809, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14580
2022-05-08 00:29:17 - progress_bar.py[line:272] - INFO: epoch 001:   7912 / 17711 loss=3.261, loss_v1=0, loss_v2=0, nll_loss=1.025, ntokens=395, nsentences=32, sample_size=314.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892499, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.261, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.032, expert1_balance_bottom=17.811, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=225.9, ups=0.57, wpb=395, bsz=32, num_updates=7900, lr=8.26561e-06, gnorm=3.31, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14597
2022-05-08 00:29:34 - progress_bar.py[line:272] - INFO: epoch 001:   7922 / 17711 loss=3.315, loss_v1=0, loss_v2=0, nll_loss=1.082, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.315, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=34.745, expert1_balance_bottom=18.145, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=225.7, ups=0.59, wpb=384.9, bsz=32, num_updates=7910, lr=8.26261e-06, gnorm=3.6, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14614
2022-05-08 00:29:51 - progress_bar.py[line:272] - INFO: epoch 001:   7932 / 17711 loss=3.356, loss_v1=0, loss_v2=0, nll_loss=1.135, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891134, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.356, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.346, expert1_balance_top=35.03, expert1_balance_bottom=17.97, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=219.8, ups=0.57, wpb=382.6, bsz=32, num_updates=7920, lr=8.2596e-06, gnorm=3.374, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14632
2022-05-08 00:30:08 - progress_bar.py[line:272] - INFO: epoch 001:   7942 / 17711 loss=3.278, loss_v1=0, loss_v2=0, nll_loss=1.046, ntokens=383.6, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.278, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.752, expert1_balance_bottom=17.687, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=221.6, ups=0.58, wpb=383.6, bsz=32, num_updates=7930, lr=8.2566e-06, gnorm=3.943, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14649
2022-05-08 00:30:26 - progress_bar.py[line:272] - INFO: epoch 001:   7952 / 17711 loss=3.242, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.242, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.389, expert1_balance_bottom=17.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=223.3, ups=0.58, wpb=386.3, bsz=32, num_updates=7940, lr=8.2536e-06, gnorm=4.465, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14667
2022-05-08 00:30:43 - progress_bar.py[line:272] - INFO: epoch 001:   7962 / 17711 loss=3.321, loss_v1=0, loss_v2=0, nll_loss=1.094, ntokens=375.4, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.321, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.387, expert1_balance_bottom=17.895, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=213.2, ups=0.57, wpb=375.4, bsz=32, num_updates=7950, lr=8.25059e-06, gnorm=3.264, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=14684
2022-05-08 00:31:01 - progress_bar.py[line:272] - INFO: epoch 001:   7972 / 17711 loss=3.336, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=387, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.336, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.453, expert1_balance_bottom=17.971, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=225.5, ups=0.58, wpb=387, bsz=32, num_updates=7960, lr=8.24759e-06, gnorm=3.71, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14701
2022-05-08 00:31:18 - progress_bar.py[line:272] - INFO: epoch 001:   7982 / 17711 loss=3.279, loss_v1=0, loss_v2=0, nll_loss=1.068, ntokens=390.4, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.279, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=36.37, expert1_balance_bottom=17.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=224.5, ups=0.58, wpb=390.4, bsz=32, num_updates=7970, lr=8.24459e-06, gnorm=3.295, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14719
2022-05-08 00:31:35 - progress_bar.py[line:272] - INFO: epoch 001:   7992 / 17711 loss=3.319, loss_v1=0, loss_v2=0, nll_loss=1.099, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880132, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.319, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.345, expert1_balance_top=35.567, expert1_balance_bottom=17.676, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=220.6, ups=0.58, wpb=382.9, bsz=32, num_updates=7980, lr=8.24158e-06, gnorm=3.379, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=14736
2022-05-08 00:31:53 - progress_bar.py[line:272] - INFO: epoch 001:   8002 / 17711 loss=3.365, loss_v1=0, loss_v2=0, nll_loss=1.145, ntokens=389.9, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882837, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.365, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.344, expert1_balance_top=35.122, expert1_balance_bottom=17.795, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=224.5, ups=0.58, wpb=389.9, bsz=32, num_updates=7990, lr=8.23858e-06, gnorm=3.643, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14753
2022-05-08 00:32:10 - progress_bar.py[line:272] - INFO: epoch 001:   8012 / 17711 loss=3.269, loss_v1=0, loss_v2=0, nll_loss=1.059, ntokens=385.4, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870353, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.269, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.344, expert1_balance_top=36.588, expert1_balance_bottom=17.372, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=219.3, ups=0.57, wpb=385.4, bsz=32, num_updates=8000, lr=8.23558e-06, gnorm=3.555, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14771
2022-05-08 00:32:28 - progress_bar.py[line:272] - INFO: epoch 001:   8022 / 17711 loss=3.316, loss_v1=0, loss_v2=0, nll_loss=1.068, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89609, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.316, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.344, expert1_balance_top=35.182, expert1_balance_bottom=18.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=217.7, ups=0.57, wpb=378.6, bsz=32, num_updates=8010, lr=8.23257e-06, gnorm=3.464, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14788
2022-05-08 00:32:45 - progress_bar.py[line:272] - INFO: epoch 001:   8032 / 17711 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=1.025, ntokens=381.6, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884414, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.247, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.344, expert1_balance_top=35.593, expert1_balance_bottom=17.722, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=218.3, ups=0.57, wpb=381.6, bsz=32, num_updates=8020, lr=8.22957e-06, gnorm=4.441, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14806
2022-05-08 00:33:02 - progress_bar.py[line:272] - INFO: epoch 001:   8042 / 17711 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888488, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.254, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.026, expert1_balance_bottom=17.851, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=223.9, ups=0.58, wpb=387, bsz=32, num_updates=8030, lr=8.22657e-06, gnorm=4.077, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14823
2022-05-08 00:33:20 - progress_bar.py[line:272] - INFO: epoch 001:   8052 / 17711 loss=3.41, loss_v1=0, loss_v2=0, nll_loss=1.21, ntokens=386.5, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.41, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=36.67, expert1_balance_bottom=17.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.31, wps=223, ups=0.58, wpb=386.5, bsz=32, num_updates=8040, lr=8.22356e-06, gnorm=3.359, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14840
2022-05-08 00:33:37 - progress_bar.py[line:272] - INFO: epoch 001:   8062 / 17711 loss=3.391, loss_v1=0, loss_v2=0, nll_loss=1.164, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.391, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.344, expert1_balance_top=34.706, expert1_balance_bottom=18.077, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=221.7, ups=0.57, wpb=385.6, bsz=32, num_updates=8050, lr=8.22056e-06, gnorm=3.742, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14858
2022-05-08 00:33:55 - progress_bar.py[line:272] - INFO: epoch 001:   8072 / 17711 loss=3.257, loss_v1=0, loss_v2=0, nll_loss=1.023, ntokens=391.6, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.257, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.344, expert1_balance_top=35.509, expert1_balance_bottom=17.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=223.7, ups=0.57, wpb=391.6, bsz=32, num_updates=8060, lr=8.21756e-06, gnorm=4.09, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14875
2022-05-08 00:34:12 - progress_bar.py[line:272] - INFO: epoch 001:   8082 / 17711 loss=3.249, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=380.2, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.249, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.083, expert1_balance_bottom=18.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=219.1, ups=0.58, wpb=380.2, bsz=32, num_updates=8070, lr=8.21455e-06, gnorm=3.516, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14893
2022-05-08 00:34:29 - progress_bar.py[line:272] - INFO: epoch 001:   8092 / 17711 loss=3.324, loss_v1=0, loss_v2=0, nll_loss=1.101, ntokens=374.8, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882071, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.324, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.342, expert1_balance_top=35.879, expert1_balance_bottom=17.667, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=214.6, ups=0.57, wpb=374.8, bsz=32, num_updates=8080, lr=8.21155e-06, gnorm=3.638, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14910
2022-05-08 00:34:47 - progress_bar.py[line:272] - INFO: epoch 001:   8102 / 17711 loss=3.353, loss_v1=0, loss_v2=0, nll_loss=1.132, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886909, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.353, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.654, expert1_balance_bottom=17.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=223.2, ups=0.58, wpb=387.9, bsz=32, num_updates=8090, lr=8.20855e-06, gnorm=4.062, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14928
2022-05-08 00:35:04 - progress_bar.py[line:272] - INFO: epoch 001:   8112 / 17711 loss=3.312, loss_v1=0, loss_v2=0, nll_loss=1.076, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895068, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.312, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=34.833, expert1_balance_bottom=18.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=221.4, ups=0.58, wpb=381.9, bsz=32, num_updates=8100, lr=8.20554e-06, gnorm=3.088, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14945
2022-05-08 00:35:21 - progress_bar.py[line:272] - INFO: epoch 001:   8122 / 17711 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=0.998, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.23, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.725, expert1_balance_bottom=17.661, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=219.8, ups=0.58, wpb=380.8, bsz=32, num_updates=8110, lr=8.20254e-06, gnorm=3.457, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14962
2022-05-08 00:35:39 - progress_bar.py[line:272] - INFO: epoch 001:   8132 / 17711 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=1, ntokens=380, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886197, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.237, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.344, expert1_balance_top=35.182, expert1_balance_bottom=17.8, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=219.9, ups=0.58, wpb=380, bsz=32, num_updates=8120, lr=8.19954e-06, gnorm=3.219, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14979
2022-05-08 00:35:56 - progress_bar.py[line:272] - INFO: epoch 001:   8142 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.024, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88656, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.434, expert1_balance_bottom=17.765, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=222.2, ups=0.58, wpb=386.3, bsz=32, num_updates=8130, lr=8.19653e-06, gnorm=3.488, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=14997
2022-05-08 00:36:13 - progress_bar.py[line:272] - INFO: epoch 001:   8152 / 17711 loss=3.245, loss_v1=0, loss_v2=0, nll_loss=1.016, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885716, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.245, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.342, expert1_balance_top=35.069, expert1_balance_bottom=17.84, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=220.6, ups=0.58, wpb=381, bsz=32, num_updates=8140, lr=8.19353e-06, gnorm=3.644, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15014
2022-05-08 00:36:31 - progress_bar.py[line:272] - INFO: epoch 001:   8162 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=376.5, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899715, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=34.206, expert1_balance_bottom=18.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=217.7, ups=0.58, wpb=376.5, bsz=32, num_updates=8150, lr=8.19053e-06, gnorm=3.266, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15031
2022-05-08 00:36:48 - progress_bar.py[line:272] - INFO: epoch 001:   8172 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=383.6, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.342, expert1_balance_top=34.998, expert1_balance_bottom=18.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220, ups=0.57, wpb=383.6, bsz=32, num_updates=8160, lr=8.18752e-06, gnorm=3.973, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15049
2022-05-08 00:37:05 - progress_bar.py[line:272] - INFO: epoch 001:   8182 / 17711 loss=3.34, loss_v1=0, loss_v2=0, nll_loss=1.117, ntokens=380.1, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.34, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.396, expert1_balance_bottom=17.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=218.9, ups=0.58, wpb=380.1, bsz=32, num_updates=8170, lr=8.18452e-06, gnorm=3.568, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15066
2022-05-08 00:37:23 - progress_bar.py[line:272] - INFO: epoch 001:   8192 / 17711 loss=3.315, loss_v1=0, loss_v2=0, nll_loss=1.081, ntokens=375.1, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899571, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.315, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.344, expert1_balance_top=34.442, expert1_balance_bottom=18.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=214.9, ups=0.57, wpb=375.1, bsz=32, num_updates=8180, lr=8.18152e-06, gnorm=3.804, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15084
2022-05-08 00:37:40 - progress_bar.py[line:272] - INFO: epoch 001:   8202 / 17711 loss=3.316, loss_v1=0, loss_v2=0, nll_loss=1.097, ntokens=384.3, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.316, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.342, expert1_balance_top=35.151, expert1_balance_bottom=18.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=220.9, ups=0.57, wpb=384.3, bsz=32, num_updates=8190, lr=8.17851e-06, gnorm=3.644, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15101
2022-05-08 00:37:58 - progress_bar.py[line:272] - INFO: epoch 001:   8212 / 17711 loss=3.288, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=381, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.288, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.342, expert1_balance_top=34.758, expert1_balance_bottom=18.032, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=218, ups=0.57, wpb=381, bsz=32, num_updates=8200, lr=8.17551e-06, gnorm=3.359, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15119
2022-05-08 00:38:15 - progress_bar.py[line:272] - INFO: epoch 001:   8222 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.032, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.383, expert1_balance_bottom=18.07, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=218, ups=0.57, wpb=383.5, bsz=32, num_updates=8210, lr=8.17251e-06, gnorm=3.066, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=15136
2022-05-08 00:38:33 - progress_bar.py[line:272] - INFO: epoch 001:   8232 / 17711 loss=3.283, loss_v1=0, loss_v2=0, nll_loss=1.053, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.283, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.139, expert1_balance_bottom=18.057, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=222, ups=0.58, wpb=383.9, bsz=32, num_updates=8220, lr=8.1695e-06, gnorm=3.891, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15153
2022-05-08 00:38:50 - progress_bar.py[line:272] - INFO: epoch 001:   8242 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.015, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.342, expert1_balance_top=35.566, expert1_balance_bottom=17.758, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=222.4, ups=0.58, wpb=381.7, bsz=32, num_updates=8230, lr=8.1665e-06, gnorm=3.631, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15171
2022-05-08 00:39:07 - progress_bar.py[line:272] - INFO: epoch 001:   8252 / 17711 loss=3.307, loss_v1=0, loss_v2=0, nll_loss=1.079, ntokens=384.5, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.307, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.011, expert1_balance_bottom=17.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=220.6, ups=0.57, wpb=384.5, bsz=32, num_updates=8240, lr=8.1635e-06, gnorm=3.588, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15188
2022-05-08 00:39:24 - progress_bar.py[line:272] - INFO: epoch 001:   8262 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.991, ntokens=389, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888172, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=35.37, expert1_balance_bottom=18.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.2, ups=0.58, wpb=389, bsz=32, num_updates=8250, lr=8.16049e-06, gnorm=3.292, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15205
2022-05-08 00:39:42 - progress_bar.py[line:272] - INFO: epoch 001:   8272 / 17711 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=1.036, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895156, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.272, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.343, expert1_balance_top=34.734, expert1_balance_bottom=18.112, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=217.2, ups=0.57, wpb=382.5, bsz=32, num_updates=8260, lr=8.15749e-06, gnorm=3.392, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15223
2022-05-08 00:40:00 - progress_bar.py[line:272] - INFO: epoch 001:   8282 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=386.4, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875654, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=35.895, expert1_balance_bottom=17.703, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=221.9, ups=0.57, wpb=386.4, bsz=32, num_updates=8270, lr=8.15449e-06, gnorm=4.104, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15240
2022-05-08 00:40:17 - progress_bar.py[line:272] - INFO: epoch 001:   8292 / 17711 loss=3.288, loss_v1=0, loss_v2=0, nll_loss=1.062, ntokens=385.9, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883631, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.288, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=35.811, expert1_balance_bottom=17.663, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=225, ups=0.58, wpb=385.9, bsz=32, num_updates=8280, lr=8.15149e-06, gnorm=3.415, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15257
2022-05-08 00:40:34 - progress_bar.py[line:272] - INFO: epoch 001:   8302 / 17711 loss=3.258, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=381.4, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.258, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=34.88, expert1_balance_bottom=17.948, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=221.6, ups=0.58, wpb=381.4, bsz=32, num_updates=8290, lr=8.14848e-06, gnorm=3.829, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=15275
2022-05-08 00:40:51 - progress_bar.py[line:272] - INFO: epoch 001:   8312 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=35.377, expert1_balance_bottom=17.906, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=221.4, ups=0.58, wpb=382.8, bsz=32, num_updates=8300, lr=8.14548e-06, gnorm=3.729, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15292
2022-05-08 00:41:08 - progress_bar.py[line:272] - INFO: epoch 001:   8322 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.007, ntokens=386.2, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=35.674, expert1_balance_bottom=17.786, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=222.8, ups=0.58, wpb=386.2, bsz=32, num_updates=8310, lr=8.14248e-06, gnorm=3.174, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15309
2022-05-08 00:41:26 - progress_bar.py[line:272] - INFO: epoch 001:   8332 / 17711 loss=3.287, loss_v1=0, loss_v2=0, nll_loss=1.065, ntokens=378.1, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.287, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=35.161, expert1_balance_bottom=18.027, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=217.5, ups=0.58, wpb=378.1, bsz=32, num_updates=8320, lr=8.13947e-06, gnorm=3.981, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15327
2022-05-08 00:41:43 - progress_bar.py[line:272] - INFO: epoch 001:   8342 / 17711 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=386.7, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.234, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=34.999, expert1_balance_bottom=18.092, unused_expert1_count=0.002, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225, ups=0.58, wpb=386.7, bsz=32, num_updates=8330, lr=8.13647e-06, gnorm=3.125, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=15344
2022-05-08 00:42:00 - progress_bar.py[line:272] - INFO: epoch 001:   8352 / 17711 loss=3.323, loss_v1=0, loss_v2=0, nll_loss=1.106, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.323, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=35.332, expert1_balance_bottom=17.779, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=219.9, ups=0.58, wpb=377.4, bsz=32, num_updates=8340, lr=8.13347e-06, gnorm=4.193, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15361
2022-05-08 00:42:17 - progress_bar.py[line:272] - INFO: epoch 001:   8362 / 17711 loss=3.321, loss_v1=0, loss_v2=0, nll_loss=1.095, ntokens=377.7, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.321, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=35.407, expert1_balance_bottom=17.896, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=219.9, ups=0.58, wpb=377.7, bsz=32, num_updates=8350, lr=8.13046e-06, gnorm=3.417, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=15378
2022-05-08 00:42:35 - progress_bar.py[line:272] - INFO: epoch 001:   8372 / 17711 loss=3.259, loss_v1=0, loss_v2=0, nll_loss=1.024, ntokens=380.5, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892856, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.259, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=35.247, expert1_balance_bottom=17.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=221.3, ups=0.58, wpb=380.5, bsz=32, num_updates=8360, lr=8.12746e-06, gnorm=3.257, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15395
2022-05-08 00:42:38 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 00:42:53 - progress_bar.py[line:272] - INFO: epoch 001:   8383 / 17711 loss=3.294, loss_v1=0, loss_v2=0, nll_loss=1.068, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886715, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.294, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=35.367, expert1_balance_bottom=18.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=204.8, ups=0.53, wpb=384.7, bsz=32, num_updates=8370, lr=8.12446e-06, gnorm=3.037, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15414
2022-05-08 00:43:11 - progress_bar.py[line:272] - INFO: epoch 001:   8393 / 17711 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=385.4, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.247, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.34, expert1_balance_top=36.425, expert1_balance_bottom=17.542, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=220.4, ups=0.57, wpb=385.4, bsz=32, num_updates=8380, lr=8.12145e-06, gnorm=3.518, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15432
2022-05-08 00:43:28 - progress_bar.py[line:272] - INFO: epoch 001:   8403 / 17711 loss=3.249, loss_v1=0, loss_v2=0, nll_loss=1.012, ntokens=371.7, nsentences=32, sample_size=295.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893668, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.249, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=34.928, expert1_balance_bottom=17.923, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=213.5, ups=0.57, wpb=371.7, bsz=32, num_updates=8390, lr=8.11845e-06, gnorm=4.142, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15449
2022-05-08 00:43:46 - progress_bar.py[line:272] - INFO: epoch 001:   8413 / 17711 loss=3.283, loss_v1=0, loss_v2=0, nll_loss=1.068, ntokens=393, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873488, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.283, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.34, expert1_balance_top=35.966, expert1_balance_bottom=17.721, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=222.3, ups=0.57, wpb=393, bsz=32, num_updates=8400, lr=8.11545e-06, gnorm=3.555, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15467
2022-05-08 00:44:03 - progress_bar.py[line:272] - INFO: epoch 001:   8423 / 17711 loss=3.283, loss_v1=0, loss_v2=0, nll_loss=1.07, ntokens=378.4, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.283, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.34, expert1_balance_top=35.41, expert1_balance_bottom=17.987, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=218.7, ups=0.58, wpb=378.4, bsz=32, num_updates=8410, lr=8.11244e-06, gnorm=4.21, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15484
2022-05-08 00:44:20 - progress_bar.py[line:272] - INFO: epoch 001:   8433 / 17711 loss=3.308, loss_v1=0, loss_v2=0, nll_loss=1.079, ntokens=379.1, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893887, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.308, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.341, expert1_balance_top=34.786, expert1_balance_bottom=18.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=220.3, ups=0.58, wpb=379.1, bsz=32, num_updates=8420, lr=8.10944e-06, gnorm=3.752, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15501
2022-05-08 00:44:38 - progress_bar.py[line:272] - INFO: epoch 001:   8443 / 17711 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=379.6, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88804, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.179, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.34, expert1_balance_top=35.366, expert1_balance_bottom=18.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=219.1, ups=0.58, wpb=379.6, bsz=32, num_updates=8430, lr=8.10644e-06, gnorm=3.523, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15519
2022-05-08 00:44:55 - progress_bar.py[line:272] - INFO: epoch 001:   8453 / 17711 loss=3.279, loss_v1=0, loss_v2=0, nll_loss=1.046, ntokens=377.9, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.279, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.34, expert1_balance_top=34.754, expert1_balance_bottom=18.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=218.8, ups=0.58, wpb=377.9, bsz=32, num_updates=8440, lr=8.10343e-06, gnorm=2.883, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15536
2022-05-08 00:45:12 - progress_bar.py[line:272] - INFO: epoch 001:   8463 / 17711 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=380.8, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.211, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.339, expert1_balance_top=35.27, expert1_balance_bottom=17.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=218.6, ups=0.57, wpb=380.8, bsz=32, num_updates=8450, lr=8.10043e-06, gnorm=3.612, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15553
2022-05-08 00:45:30 - progress_bar.py[line:272] - INFO: epoch 001:   8473 / 17711 loss=3.334, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=388.8, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876496, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.334, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.34, expert1_balance_top=35.778, expert1_balance_bottom=17.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=224.4, ups=0.58, wpb=388.8, bsz=32, num_updates=8460, lr=8.09743e-06, gnorm=3.878, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15571
2022-05-08 00:45:47 - progress_bar.py[line:272] - INFO: epoch 001:   8483 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.339, expert1_balance_top=34.928, expert1_balance_bottom=18.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=220, ups=0.57, wpb=386, bsz=32, num_updates=8470, lr=8.09442e-06, gnorm=3.547, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15588
2022-05-08 00:46:05 - progress_bar.py[line:272] - INFO: epoch 001:   8493 / 17711 loss=3.286, loss_v1=0, loss_v2=0, nll_loss=1.07, ntokens=393.2, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881649, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.286, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.34, expert1_balance_top=35.48, expert1_balance_bottom=17.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=228.5, ups=0.58, wpb=393.2, bsz=32, num_updates=8480, lr=8.09142e-06, gnorm=3.09, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15605
2022-05-08 00:46:22 - progress_bar.py[line:272] - INFO: epoch 001:   8503 / 17711 loss=3.329, loss_v1=0, loss_v2=0, nll_loss=1.102, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891641, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.329, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.34, expert1_balance_top=35.255, expert1_balance_bottom=18.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=222.9, ups=0.58, wpb=382.7, bsz=32, num_updates=8490, lr=8.08842e-06, gnorm=3.662, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15623
2022-05-08 00:46:39 - progress_bar.py[line:272] - INFO: epoch 001:   8513 / 17711 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=1.031, ntokens=388, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.254, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.339, expert1_balance_top=35.669, expert1_balance_bottom=17.906, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=223.8, ups=0.58, wpb=388, bsz=32, num_updates=8500, lr=8.08541e-06, gnorm=3.696, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15640
2022-05-08 00:46:57 - progress_bar.py[line:272] - INFO: epoch 001:   8523 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=382, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.338, expert1_balance_top=35.306, expert1_balance_bottom=17.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=214.7, ups=0.56, wpb=382, bsz=32, num_updates=8510, lr=8.08241e-06, gnorm=3.877, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=15658
2022-05-08 00:47:14 - progress_bar.py[line:272] - INFO: epoch 001:   8533 / 17711 loss=3.325, loss_v1=0, loss_v2=0, nll_loss=1.11, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882631, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.325, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.338, expert1_balance_top=35.16, expert1_balance_bottom=17.853, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=221.1, ups=0.58, wpb=381.1, bsz=32, num_updates=8520, lr=8.07941e-06, gnorm=3.597, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15675
2022-05-08 00:47:32 - progress_bar.py[line:272] - INFO: epoch 001:   8543 / 17711 loss=3.261, loss_v1=0, loss_v2=0, nll_loss=1.038, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.261, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.338, expert1_balance_top=35.659, expert1_balance_bottom=17.747, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=218, ups=0.57, wpb=380.9, bsz=32, num_updates=8530, lr=8.0764e-06, gnorm=3.668, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15692
2022-05-08 00:47:49 - progress_bar.py[line:272] - INFO: epoch 001:   8553 / 17711 loss=3.278, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=394, nsentences=32, sample_size=313.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.278, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.338, expert1_balance_top=34.689, expert1_balance_bottom=18.038, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=223.6, ups=0.57, wpb=394, bsz=32, num_updates=8540, lr=8.0734e-06, gnorm=3.881, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15710
2022-05-08 00:48:07 - progress_bar.py[line:272] - INFO: epoch 001:   8563 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.051, ntokens=391.7, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.338, expert1_balance_top=36.202, expert1_balance_bottom=17.706, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=223.4, ups=0.57, wpb=391.7, bsz=32, num_updates=8550, lr=8.0704e-06, gnorm=3.119, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15728
2022-05-08 00:48:24 - progress_bar.py[line:272] - INFO: epoch 001:   8573 / 17711 loss=3.326, loss_v1=0, loss_v2=0, nll_loss=1.106, ntokens=389.3, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88124, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.326, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.339, expert1_balance_top=35.839, expert1_balance_bottom=17.847, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=224.2, ups=0.58, wpb=389.3, bsz=32, num_updates=8560, lr=8.06739e-06, gnorm=3.353, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15745
2022-05-08 00:48:41 - progress_bar.py[line:272] - INFO: epoch 001:   8583 / 17711 loss=3.343, loss_v1=0, loss_v2=0, nll_loss=1.144, ntokens=384.1, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.343, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.338, expert1_balance_top=36.468, expert1_balance_bottom=17.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.21, wps=220.7, ups=0.57, wpb=384.1, bsz=32, num_updates=8570, lr=8.06439e-06, gnorm=3.456, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15762
2022-05-08 00:48:59 - progress_bar.py[line:272] - INFO: epoch 001:   8593 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.015, ntokens=384, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888678, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.339, expert1_balance_top=34.806, expert1_balance_bottom=18.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=217.2, ups=0.57, wpb=384, bsz=32, num_updates=8580, lr=8.06139e-06, gnorm=3.433, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15780
2022-05-08 00:49:16 - progress_bar.py[line:272] - INFO: epoch 001:   8603 / 17711 loss=3.299, loss_v1=0, loss_v2=0, nll_loss=1.064, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893673, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.299, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.339, expert1_balance_top=34.34, expert1_balance_bottom=18.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=222.3, ups=0.58, wpb=384.5, bsz=32, num_updates=8590, lr=8.05838e-06, gnorm=3.639, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15797
2022-05-08 00:49:34 - progress_bar.py[line:272] - INFO: epoch 001:   8613 / 17711 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.986, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.229, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.339, expert1_balance_top=34.529, expert1_balance_bottom=18.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=218.7, ups=0.57, wpb=386.3, bsz=32, num_updates=8600, lr=8.05538e-06, gnorm=3.226, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15815
2022-05-08 00:49:52 - progress_bar.py[line:272] - INFO: epoch 001:   8623 / 17711 loss=3.287, loss_v1=0, loss_v2=0, nll_loss=1.066, ntokens=376.8, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.287, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.338, expert1_balance_top=35.406, expert1_balance_bottom=17.981, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=211.7, ups=0.56, wpb=376.8, bsz=32, num_updates=8610, lr=8.05238e-06, gnorm=3.678, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15833
2022-05-08 00:50:10 - progress_bar.py[line:272] - INFO: epoch 001:   8633 / 17711 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=385.3, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891048, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.338, expert1_balance_top=35.271, expert1_balance_bottom=17.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=217.9, ups=0.57, wpb=385.3, bsz=32, num_updates=8620, lr=8.04937e-06, gnorm=3.492, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15850
2022-05-08 00:50:27 - progress_bar.py[line:272] - INFO: epoch 001:   8643 / 17711 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=1.052, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.282, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.338, expert1_balance_top=35.267, expert1_balance_bottom=18.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=217.7, ups=0.57, wpb=381.9, bsz=32, num_updates=8630, lr=8.04637e-06, gnorm=3.837, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15868
2022-05-08 00:50:44 - progress_bar.py[line:272] - INFO: epoch 001:   8653 / 17711 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=1.031, ntokens=389.9, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881344, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.247, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=35.802, expert1_balance_bottom=17.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=224.8, ups=0.58, wpb=389.9, bsz=32, num_updates=8640, lr=8.04337e-06, gnorm=4.007, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=15885
2022-05-08 00:51:02 - progress_bar.py[line:272] - INFO: epoch 001:   8663 / 17711 loss=3.277, loss_v1=0, loss_v2=0, nll_loss=1.047, ntokens=389.7, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.277, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=35.302, expert1_balance_bottom=18.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=224.9, ups=0.58, wpb=389.7, bsz=32, num_updates=8650, lr=8.04036e-06, gnorm=3.551, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15903
2022-05-08 00:51:19 - progress_bar.py[line:272] - INFO: epoch 001:   8673 / 17711 loss=3.323, loss_v1=0, loss_v2=0, nll_loss=1.11, ntokens=384.8, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877935, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.323, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=35.913, expert1_balance_bottom=17.87, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=222.6, ups=0.58, wpb=384.8, bsz=32, num_updates=8660, lr=8.03736e-06, gnorm=4.324, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15920
2022-05-08 00:51:37 - progress_bar.py[line:272] - INFO: epoch 001:   8683 / 17711 loss=3.249, loss_v1=0, loss_v2=0, nll_loss=1.012, ntokens=380.3, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888578, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.249, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=35.575, expert1_balance_bottom=17.845, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=217, ups=0.57, wpb=380.3, bsz=32, num_updates=8670, lr=8.03436e-06, gnorm=3.393, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15937
2022-05-08 00:51:54 - progress_bar.py[line:272] - INFO: epoch 001:   8693 / 17711 loss=3.327, loss_v1=0, loss_v2=0, nll_loss=1.115, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.327, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=35.935, expert1_balance_bottom=17.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=218.4, ups=0.57, wpb=381.8, bsz=32, num_updates=8680, lr=8.03135e-06, gnorm=3.564, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15955
2022-05-08 00:52:11 - progress_bar.py[line:272] - INFO: epoch 001:   8703 / 17711 loss=3.291, loss_v1=0, loss_v2=0, nll_loss=1.067, ntokens=389.8, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.291, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=35.069, expert1_balance_bottom=18.056, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=225.1, ups=0.58, wpb=389.8, bsz=32, num_updates=8690, lr=8.02835e-06, gnorm=3.795, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15972
2022-05-08 00:52:20 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 00:52:31 - progress_bar.py[line:272] - INFO: epoch 001:   8714 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.989, ntokens=371.6, nsentences=32, sample_size=295.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.336, expert1_balance_top=35.859, expert1_balance_bottom=17.671, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=194.1, ups=0.52, wpb=371.6, bsz=32, num_updates=8700, lr=8.02535e-06, gnorm=3.247, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=15991
2022-05-08 00:52:48 - progress_bar.py[line:272] - INFO: epoch 001:   8724 / 17711 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=383.7, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.205, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=34.974, expert1_balance_bottom=18.017, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=220.6, ups=0.57, wpb=383.7, bsz=32, num_updates=8710, lr=8.02234e-06, gnorm=2.808, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16009
2022-05-08 00:53:05 - progress_bar.py[line:272] - INFO: epoch 001:   8734 / 17711 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=1, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.234, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=34.952, expert1_balance_bottom=18.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=216.8, ups=0.57, wpb=378.8, bsz=32, num_updates=8720, lr=8.01934e-06, gnorm=3.37, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16026
2022-05-08 00:53:23 - progress_bar.py[line:272] - INFO: epoch 001:   8744 / 17711 loss=3.269, loss_v1=0, loss_v2=0, nll_loss=1.047, ntokens=389.7, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.269, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=35.459, expert1_balance_bottom=17.973, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=224.5, ups=0.58, wpb=389.7, bsz=32, num_updates=8730, lr=8.01634e-06, gnorm=3.596, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16044
2022-05-08 00:53:40 - progress_bar.py[line:272] - INFO: epoch 001:   8754 / 17711 loss=3.245, loss_v1=0, loss_v2=0, nll_loss=0.997, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.245, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=34.325, expert1_balance_bottom=18.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=216, ups=0.58, wpb=375.5, bsz=32, num_updates=8740, lr=8.01333e-06, gnorm=3.202, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16061
2022-05-08 00:53:58 - progress_bar.py[line:272] - INFO: epoch 001:   8764 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=369.6, nsentences=32, sample_size=294.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=34.249, expert1_balance_bottom=18.385, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.4, ups=0.57, wpb=369.6, bsz=32, num_updates=8750, lr=8.01033e-06, gnorm=3.789, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16078
2022-05-08 00:54:15 - progress_bar.py[line:272] - INFO: epoch 001:   8774 / 17711 loss=3.3, loss_v1=0, loss_v2=0, nll_loss=1.073, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886079, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.336, expert1_balance_top=35.541, expert1_balance_bottom=17.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=220.3, ups=0.57, wpb=383.8, bsz=32, num_updates=8760, lr=8.00733e-06, gnorm=3.815, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16096
2022-05-08 00:54:33 - progress_bar.py[line:272] - INFO: epoch 001:   8784 / 17711 loss=3.29, loss_v1=0, loss_v2=0, nll_loss=1.059, ntokens=386.7, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.29, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=35.44, expert1_balance_bottom=18.137, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=221.3, ups=0.57, wpb=386.7, bsz=32, num_updates=8770, lr=8.00432e-06, gnorm=3.729, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16113
2022-05-08 00:54:50 - progress_bar.py[line:272] - INFO: epoch 001:   8794 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=377.4, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892298, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.336, expert1_balance_top=34.787, expert1_balance_bottom=18.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=217.8, ups=0.58, wpb=377.4, bsz=32, num_updates=8780, lr=8.00132e-06, gnorm=3.654, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16131
2022-05-08 00:55:07 - progress_bar.py[line:272] - INFO: epoch 001:   8804 / 17711 loss=3.32, loss_v1=0, loss_v2=0, nll_loss=1.09, ntokens=382.2, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.32, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.336, expert1_balance_top=34.635, expert1_balance_bottom=18.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=217.8, ups=0.57, wpb=382.2, bsz=32, num_updates=8790, lr=7.99832e-06, gnorm=4.446, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16148
2022-05-08 00:55:25 - progress_bar.py[line:272] - INFO: epoch 001:   8814 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.065, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.336, expert1_balance_top=34.968, expert1_balance_bottom=18.135, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=217.1, ups=0.57, wpb=378, bsz=32, num_updates=8800, lr=7.99531e-06, gnorm=3.629, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16166
2022-05-08 00:55:43 - progress_bar.py[line:272] - INFO: epoch 001:   8824 / 17711 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=382.8, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.239, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=34.789, expert1_balance_bottom=18.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=214.7, ups=0.56, wpb=382.8, bsz=32, num_updates=8810, lr=7.99231e-06, gnorm=3.512, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16183
2022-05-08 00:56:00 - progress_bar.py[line:272] - INFO: epoch 001:   8834 / 17711 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=1.042, ntokens=373.2, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898906, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.282, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.337, expert1_balance_top=35.028, expert1_balance_bottom=17.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=213.6, ups=0.57, wpb=373.2, bsz=32, num_updates=8820, lr=7.98931e-06, gnorm=3.913, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16201
2022-05-08 00:56:18 - progress_bar.py[line:272] - INFO: epoch 001:   8844 / 17711 loss=3.269, loss_v1=0, loss_v2=0, nll_loss=1.061, ntokens=379.5, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876664, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.269, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=35.672, expert1_balance_bottom=17.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=216.7, ups=0.57, wpb=379.5, bsz=32, num_updates=8830, lr=7.98631e-06, gnorm=3.342, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16218
2022-05-08 00:56:35 - progress_bar.py[line:272] - INFO: epoch 001:   8854 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.031, ntokens=375.1, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892012, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.336, expert1_balance_top=35.059, expert1_balance_bottom=18.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=221.3, ups=0.59, wpb=375.1, bsz=32, num_updates=8840, lr=7.9833e-06, gnorm=3.647, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16235
2022-05-08 00:56:52 - progress_bar.py[line:272] - INFO: epoch 001:   8864 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.023, ntokens=386.4, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889345, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=35.142, expert1_balance_bottom=17.957, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=227.5, ups=0.59, wpb=386.4, bsz=32, num_updates=8850, lr=7.9803e-06, gnorm=3.512, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16252
2022-05-08 00:57:09 - progress_bar.py[line:272] - INFO: epoch 001:   8874 / 17711 loss=3.276, loss_v1=0, loss_v2=0, nll_loss=1.053, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878331, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.276, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=36.205, expert1_balance_bottom=17.734, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=216.4, ups=0.57, wpb=380.5, bsz=32, num_updates=8860, lr=7.9773e-06, gnorm=3.79, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16270
2022-05-08 00:57:27 - progress_bar.py[line:272] - INFO: epoch 001:   8884 / 17711 loss=3.28, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.28, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=35.304, expert1_balance_bottom=17.897, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=218.1, ups=0.57, wpb=382.9, bsz=32, num_updates=8870, lr=7.97429e-06, gnorm=3.682, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16288
2022-05-08 00:57:44 - progress_bar.py[line:272] - INFO: epoch 001:   8894 / 17711 loss=3.325, loss_v1=0, loss_v2=0, nll_loss=1.115, ntokens=383.2, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87728, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.325, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=35.563, expert1_balance_bottom=17.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=221.3, ups=0.58, wpb=383.2, bsz=32, num_updates=8880, lr=7.97129e-06, gnorm=3.359, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=16305
2022-05-08 00:58:01 - progress_bar.py[line:272] - INFO: epoch 001:   8904 / 17711 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=371.7, nsentences=32, sample_size=295.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892048, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.239, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=35.344, expert1_balance_bottom=17.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=214.1, ups=0.58, wpb=371.7, bsz=32, num_updates=8890, lr=7.96829e-06, gnorm=3.071, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16322
2022-05-08 00:58:19 - progress_bar.py[line:272] - INFO: epoch 001:   8914 / 17711 loss=3.344, loss_v1=0, loss_v2=0, nll_loss=1.126, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883749, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.344, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=35.45, expert1_balance_bottom=18.087, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=217.9, ups=0.57, wpb=382.8, bsz=32, num_updates=8900, lr=7.96528e-06, gnorm=3.857, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16340
2022-05-08 00:58:36 - progress_bar.py[line:272] - INFO: epoch 001:   8924 / 17711 loss=3.287, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=379.4, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889848, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.287, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=34.798, expert1_balance_bottom=18.057, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=219.3, ups=0.58, wpb=379.4, bsz=32, num_updates=8910, lr=7.96228e-06, gnorm=4.129, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16357
2022-05-08 00:58:54 - progress_bar.py[line:272] - INFO: epoch 001:   8934 / 17711 loss=3.298, loss_v1=0, loss_v2=0, nll_loss=1.064, ntokens=384.4, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894726, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.298, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=34.921, expert1_balance_bottom=18.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=222.9, ups=0.58, wpb=384.4, bsz=32, num_updates=8920, lr=7.95928e-06, gnorm=3.552, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16374
2022-05-08 00:59:11 - progress_bar.py[line:272] - INFO: epoch 001:   8944 / 17711 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=1.073, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86841, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.282, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=36.33, expert1_balance_bottom=17.621, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=220.1, ups=0.57, wpb=384.7, bsz=32, num_updates=8930, lr=7.95627e-06, gnorm=3.098, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16392
2022-05-08 00:59:28 - progress_bar.py[line:272] - INFO: epoch 001:   8954 / 17711 loss=3.262, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=379.7, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.262, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=35.602, expert1_balance_bottom=17.86, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=219.2, ups=0.58, wpb=379.7, bsz=32, num_updates=8940, lr=7.95327e-06, gnorm=3.158, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16409
2022-05-08 00:59:46 - progress_bar.py[line:272] - INFO: epoch 001:   8964 / 17711 loss=3.311, loss_v1=0, loss_v2=0, nll_loss=1.091, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.311, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=34.933, expert1_balance_bottom=18.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=218.7, ups=0.58, wpb=378.7, bsz=32, num_updates=8950, lr=7.95027e-06, gnorm=3.514, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16426
2022-05-08 01:00:03 - progress_bar.py[line:272] - INFO: epoch 001:   8974 / 17711 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=1.022, ntokens=374.4, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883143, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.246, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=35.291, expert1_balance_bottom=18.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=214.9, ups=0.57, wpb=374.4, bsz=32, num_updates=8960, lr=7.94726e-06, gnorm=2.95, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16444
2022-05-08 01:00:20 - progress_bar.py[line:272] - INFO: epoch 001:   8984 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.071, ntokens=371.8, nsentences=32, sample_size=295.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887417, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=35.079, expert1_balance_bottom=18.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=213.8, ups=0.58, wpb=371.8, bsz=32, num_updates=8970, lr=7.94426e-06, gnorm=3.39, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16461
2022-05-08 01:00:37 - progress_bar.py[line:272] - INFO: epoch 001:   8994 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897658, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=34.165, expert1_balance_bottom=18.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=226.8, ups=0.59, wpb=381.5, bsz=32, num_updates=8980, lr=7.94126e-06, gnorm=3.273, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16478
2022-05-08 01:00:54 - progress_bar.py[line:272] - INFO: epoch 001:   9004 / 17711 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=1.031, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896488, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.274, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=34.891, expert1_balance_bottom=17.929, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=222.5, ups=0.59, wpb=379.1, bsz=32, num_updates=8990, lr=7.93825e-06, gnorm=3.548, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16495
2022-05-08 01:01:11 - progress_bar.py[line:272] - INFO: epoch 001:   9014 / 17711 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=1.055, ntokens=387.4, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.274, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=35.498, expert1_balance_bottom=18.025, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=226.5, ups=0.58, wpb=387.4, bsz=32, num_updates=9000, lr=7.93525e-06, gnorm=3.483, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16512
2022-05-08 01:01:29 - progress_bar.py[line:272] - INFO: epoch 001:   9024 / 17711 loss=3.281, loss_v1=0, loss_v2=0, nll_loss=1.047, ntokens=383, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.281, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=34.688, expert1_balance_bottom=18.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=220.3, ups=0.58, wpb=383, bsz=32, num_updates=9010, lr=7.93225e-06, gnorm=3.42, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16530
2022-05-08 01:01:46 - progress_bar.py[line:272] - INFO: epoch 001:   9034 / 17711 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=1.019, ntokens=385.9, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.237, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=35.749, expert1_balance_bottom=17.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=225.3, ups=0.58, wpb=385.9, bsz=32, num_updates=9020, lr=7.92924e-06, gnorm=3.809, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16547
2022-05-08 01:02:03 - progress_bar.py[line:272] - INFO: epoch 001:   9044 / 17711 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=388, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884004, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.24, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=35.073, expert1_balance_bottom=18.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=224.2, ups=0.58, wpb=388, bsz=32, num_updates=9030, lr=7.92624e-06, gnorm=3.256, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16564
2022-05-08 01:02:20 - progress_bar.py[line:272] - INFO: epoch 001:   9054 / 17711 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.207, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=34.742, expert1_balance_bottom=18.057, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=223.2, ups=0.58, wpb=381.9, bsz=32, num_updates=9040, lr=7.92324e-06, gnorm=4.09, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16581
2022-05-08 01:02:38 - progress_bar.py[line:272] - INFO: epoch 001:   9064 / 17711 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=0.993, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.225, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=35.322, expert1_balance_bottom=17.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=219, ups=0.57, wpb=381.3, bsz=32, num_updates=9050, lr=7.92023e-06, gnorm=3.165, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16599
2022-05-08 01:02:55 - progress_bar.py[line:272] - INFO: epoch 001:   9074 / 17711 loss=3.268, loss_v1=0, loss_v2=0, nll_loss=1.033, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896053, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.268, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=34.297, expert1_balance_bottom=18.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=221, ups=0.57, wpb=384.7, bsz=32, num_updates=9060, lr=7.91723e-06, gnorm=3.738, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16616
2022-05-08 01:03:13 - progress_bar.py[line:272] - INFO: epoch 001:   9084 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.081, ntokens=396.3, nsentences=32, sample_size=315.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.334, expert1_balance_top=35.169, expert1_balance_bottom=18.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=229, ups=0.58, wpb=396.3, bsz=32, num_updates=9070, lr=7.91423e-06, gnorm=2.985, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16633
2022-05-08 01:03:30 - progress_bar.py[line:272] - INFO: epoch 001:   9094 / 17711 loss=3.242, loss_v1=0, loss_v2=0, nll_loss=1.005, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898822, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.242, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=34.713, expert1_balance_bottom=18.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=217.9, ups=0.57, wpb=379.8, bsz=32, num_updates=9080, lr=7.91122e-06, gnorm=3.33, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16651
2022-05-08 01:03:47 - progress_bar.py[line:272] - INFO: epoch 001:   9104 / 17711 loss=3.34, loss_v1=0, loss_v2=0, nll_loss=1.113, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895735, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.34, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.335, expert1_balance_top=34.743, expert1_balance_bottom=18.418, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=220, ups=0.57, wpb=383.3, bsz=32, num_updates=9090, lr=7.90822e-06, gnorm=3.639, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16668
2022-05-08 01:04:05 - progress_bar.py[line:272] - INFO: epoch 001:   9114 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=385, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883434, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=35.007, expert1_balance_bottom=18.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=221.3, ups=0.57, wpb=385, bsz=32, num_updates=9100, lr=7.90522e-06, gnorm=3.401, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16686
2022-05-08 01:04:22 - progress_bar.py[line:272] - INFO: epoch 001:   9124 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88576, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=35.362, expert1_balance_bottom=17.967, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221, ups=0.58, wpb=380.6, bsz=32, num_updates=9110, lr=7.90221e-06, gnorm=3.209, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=16703
2022-05-08 01:04:39 - progress_bar.py[line:272] - INFO: epoch 001:   9134 / 17711 loss=3.364, loss_v1=0, loss_v2=0, nll_loss=1.163, ntokens=385.6, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874427, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.364, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=36.483, expert1_balance_bottom=17.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=223.7, ups=0.58, wpb=385.6, bsz=32, num_updates=9120, lr=7.89921e-06, gnorm=3.471, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16720
2022-05-08 01:04:56 - progress_bar.py[line:272] - INFO: epoch 001:   9144 / 17711 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=1.015, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896493, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.246, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=34.636, expert1_balance_bottom=18.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=224.8, ups=0.58, wpb=385.4, bsz=32, num_updates=9130, lr=7.89621e-06, gnorm=3.167, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16737
2022-05-08 01:05:14 - progress_bar.py[line:272] - INFO: epoch 001:   9154 / 17711 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=1.046, ntokens=377, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885044, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.272, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=35.204, expert1_balance_bottom=17.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=211.1, ups=0.56, wpb=377, bsz=32, num_updates=9140, lr=7.8932e-06, gnorm=2.858, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16755
2022-05-08 01:05:32 - progress_bar.py[line:272] - INFO: epoch 001:   9164 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=378.5, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=35.34, expert1_balance_bottom=18.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=217.4, ups=0.57, wpb=378.5, bsz=32, num_updates=9150, lr=7.8902e-06, gnorm=3.257, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=16772
2022-05-08 01:05:49 - progress_bar.py[line:272] - INFO: epoch 001:   9174 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=388.7, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=35.777, expert1_balance_bottom=17.993, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.5, ups=0.56, wpb=388.7, bsz=32, num_updates=9160, lr=7.8872e-06, gnorm=3.205, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16790
2022-05-08 01:06:07 - progress_bar.py[line:272] - INFO: epoch 001:   9184 / 17711 loss=3.278, loss_v1=0, loss_v2=0, nll_loss=1.041, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.278, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=34.703, expert1_balance_bottom=18.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=219.4, ups=0.57, wpb=382, bsz=32, num_updates=9170, lr=7.88419e-06, gnorm=3.688, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16808
2022-05-08 01:06:24 - progress_bar.py[line:272] - INFO: epoch 001:   9194 / 17711 loss=3.303, loss_v1=0, loss_v2=0, nll_loss=1.095, ntokens=388.4, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.303, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=35.711, expert1_balance_bottom=18.05, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=224.1, ups=0.58, wpb=388.4, bsz=32, num_updates=9180, lr=7.88119e-06, gnorm=3.865, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16825
2022-05-08 01:06:42 - progress_bar.py[line:272] - INFO: epoch 001:   9204 / 17711 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=393.7, nsentences=32, sample_size=313.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.227, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=34.919, expert1_balance_bottom=18.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=225.6, ups=0.57, wpb=393.7, bsz=32, num_updates=9190, lr=7.87819e-06, gnorm=3.361, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16842
2022-05-08 01:06:59 - progress_bar.py[line:272] - INFO: epoch 001:   9214 / 17711 loss=3.26, loss_v1=0, loss_v2=0, nll_loss=1.038, ntokens=390.3, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.26, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=35.955, expert1_balance_bottom=17.789, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=223.6, ups=0.57, wpb=390.3, bsz=32, num_updates=9200, lr=7.87518e-06, gnorm=3.539, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16860
2022-05-08 01:07:16 - progress_bar.py[line:272] - INFO: epoch 001:   9224 / 17711 loss=3.306, loss_v1=0, loss_v2=0, nll_loss=1.074, ntokens=373.2, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892251, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.306, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=35.103, expert1_balance_bottom=18.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=215.4, ups=0.58, wpb=373.2, bsz=32, num_updates=9210, lr=7.87218e-06, gnorm=3.755, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16877
2022-05-08 01:07:34 - progress_bar.py[line:272] - INFO: epoch 001:   9234 / 17711 loss=3.29, loss_v1=0, loss_v2=0, nll_loss=1.048, ntokens=373.9, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.906235, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.29, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.333, expert1_balance_top=34.175, expert1_balance_bottom=18.5, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=215.2, ups=0.58, wpb=373.9, bsz=32, num_updates=9220, lr=7.86918e-06, gnorm=3.651, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16894
2022-05-08 01:07:51 - progress_bar.py[line:272] - INFO: epoch 001:   9244 / 17711 loss=3.295, loss_v1=0, loss_v2=0, nll_loss=1.098, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.295, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=36.776, expert1_balance_bottom=17.698, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=221.7, ups=0.57, wpb=387, bsz=32, num_updates=9230, lr=7.86617e-06, gnorm=3.225, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=16912
2022-05-08 01:08:09 - progress_bar.py[line:272] - INFO: epoch 001:   9254 / 17711 loss=3.285, loss_v1=0, loss_v2=0, nll_loss=1.064, ntokens=386.6, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881477, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.285, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=35.931, expert1_balance_bottom=18.078, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=222.8, ups=0.58, wpb=386.6, bsz=32, num_updates=9240, lr=7.86317e-06, gnorm=3.553, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=16929
2022-05-08 01:08:26 - progress_bar.py[line:272] - INFO: epoch 001:   9264 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=389.3, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=35.157, expert1_balance_bottom=18.132, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=223.6, ups=0.57, wpb=389.3, bsz=32, num_updates=9250, lr=7.86017e-06, gnorm=3.736, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16947
2022-05-08 01:08:43 - progress_bar.py[line:272] - INFO: epoch 001:   9274 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=371.9, nsentences=32, sample_size=295.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=35.764, expert1_balance_bottom=18.051, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=216.7, ups=0.58, wpb=371.9, bsz=32, num_updates=9260, lr=7.85716e-06, gnorm=3.106, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16964
2022-05-08 01:09:00 - progress_bar.py[line:272] - INFO: epoch 001:   9284 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=35.004, expert1_balance_bottom=18.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.3, ups=0.58, wpb=380.1, bsz=32, num_updates=9270, lr=7.85416e-06, gnorm=3.37, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16981
2022-05-08 01:09:18 - progress_bar.py[line:272] - INFO: epoch 001:   9294 / 17711 loss=3.295, loss_v1=0, loss_v2=0, nll_loss=1.066, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.295, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=34.759, expert1_balance_bottom=18.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=219.7, ups=0.57, wpb=385.3, bsz=32, num_updates=9280, lr=7.85116e-06, gnorm=3.613, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=16999
2022-05-08 01:09:35 - progress_bar.py[line:272] - INFO: epoch 001:   9304 / 17711 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=1.003, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878988, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.225, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=35.554, expert1_balance_bottom=18.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=220.7, ups=0.57, wpb=385.7, bsz=32, num_updates=9290, lr=7.84815e-06, gnorm=3.214, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17016
2022-05-08 01:09:53 - progress_bar.py[line:272] - INFO: epoch 001:   9314 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=389.9, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878492, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=35.717, expert1_balance_bottom=17.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=223.4, ups=0.57, wpb=389.9, bsz=32, num_updates=9300, lr=7.84515e-06, gnorm=3.71, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17034
2022-05-08 01:10:10 - progress_bar.py[line:272] - INFO: epoch 001:   9324 / 17711 loss=3.262, loss_v1=0, loss_v2=0, nll_loss=1.022, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896448, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.262, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=34.746, expert1_balance_bottom=18.256, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=218.7, ups=0.58, wpb=380.4, bsz=32, num_updates=9310, lr=7.84215e-06, gnorm=3.376, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17051
2022-05-08 01:10:28 - progress_bar.py[line:272] - INFO: epoch 001:   9334 / 17711 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.997, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.229, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=34.632, expert1_balance_bottom=18.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=220.9, ups=0.58, wpb=382.2, bsz=32, num_updates=9320, lr=7.83914e-06, gnorm=3.539, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17068
2022-05-08 01:10:45 - progress_bar.py[line:272] - INFO: epoch 001:   9344 / 17711 loss=3.318, loss_v1=0, loss_v2=0, nll_loss=1.093, ntokens=376.9, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890553, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.318, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=34.873, expert1_balance_bottom=18.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=218.6, ups=0.58, wpb=376.9, bsz=32, num_updates=9330, lr=7.83614e-06, gnorm=3.391, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17086
2022-05-08 01:11:02 - progress_bar.py[line:272] - INFO: epoch 001:   9354 / 17711 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=385.7, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890058, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.211, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=35.068, expert1_balance_bottom=18.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222.5, ups=0.58, wpb=385.7, bsz=32, num_updates=9340, lr=7.83314e-06, gnorm=3.457, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17103
2022-05-08 01:11:19 - progress_bar.py[line:272] - INFO: epoch 001:   9364 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=385.8, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=35.934, expert1_balance_bottom=17.764, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=223.4, ups=0.58, wpb=385.8, bsz=32, num_updates=9350, lr=7.83013e-06, gnorm=3.409, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17120
2022-05-08 01:11:37 - progress_bar.py[line:272] - INFO: epoch 001:   9374 / 17711 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=1.009, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888115, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.232, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=35.418, expert1_balance_bottom=17.956, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=218.7, ups=0.57, wpb=380.4, bsz=32, num_updates=9360, lr=7.82713e-06, gnorm=3.719, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17138
2022-05-08 01:11:54 - progress_bar.py[line:272] - INFO: epoch 001:   9384 / 17711 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=1.002, ntokens=388.5, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.239, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=34.841, expert1_balance_bottom=18.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=223.3, ups=0.57, wpb=388.5, bsz=32, num_updates=9370, lr=7.82413e-06, gnorm=3.433, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17155
2022-05-08 01:12:12 - progress_bar.py[line:272] - INFO: epoch 001:   9394 / 17711 loss=3.251, loss_v1=0, loss_v2=0, nll_loss=1.011, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.251, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=34.612, expert1_balance_bottom=18.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=216.8, ups=0.57, wpb=378.8, bsz=32, num_updates=9380, lr=7.82113e-06, gnorm=3.259, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17172
2022-05-08 01:12:29 - progress_bar.py[line:272] - INFO: epoch 001:   9404 / 17711 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=382.4, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.243, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.332, expert1_balance_top=34.756, expert1_balance_bottom=18.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=220.7, ups=0.58, wpb=382.4, bsz=32, num_updates=9390, lr=7.81812e-06, gnorm=3.466, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17190
2022-05-08 01:12:47 - progress_bar.py[line:272] - INFO: epoch 001:   9414 / 17711 loss=3.252, loss_v1=0, loss_v2=0, nll_loss=1.022, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.252, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=35.339, expert1_balance_bottom=18.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=216.3, ups=0.57, wpb=380.4, bsz=32, num_updates=9400, lr=7.81512e-06, gnorm=3.106, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17207
2022-05-08 01:13:04 - progress_bar.py[line:272] - INFO: epoch 001:   9424 / 17711 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=392.8, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890665, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.238, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=34.496, expert1_balance_bottom=18.213, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=228.5, ups=0.58, wpb=392.8, bsz=32, num_updates=9410, lr=7.81212e-06, gnorm=3.281, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17225
2022-05-08 01:13:21 - progress_bar.py[line:272] - INFO: epoch 001:   9434 / 17711 loss=3.267, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.267, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.33, expert1_balance_top=35.477, expert1_balance_bottom=18.057, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=224.6, ups=0.58, wpb=386, bsz=32, num_updates=9420, lr=7.80911e-06, gnorm=3.353, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17242
2022-05-08 01:13:38 - progress_bar.py[line:272] - INFO: epoch 001:   9444 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=391.5, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=34.851, expert1_balance_bottom=18.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=227.1, ups=0.58, wpb=391.5, bsz=32, num_updates=9430, lr=7.80611e-06, gnorm=3.299, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17259
2022-05-08 01:13:56 - progress_bar.py[line:272] - INFO: epoch 001:   9454 / 17711 loss=3.316, loss_v1=0, loss_v2=0, nll_loss=1.09, ntokens=374.1, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.316, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.33, expert1_balance_top=35.058, expert1_balance_bottom=17.916, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=215.1, ups=0.57, wpb=374.1, bsz=32, num_updates=9440, lr=7.80311e-06, gnorm=3.92, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17276
2022-05-08 01:14:13 - progress_bar.py[line:272] - INFO: epoch 001:   9464 / 17711 loss=3.294, loss_v1=0, loss_v2=0, nll_loss=1.065, ntokens=391.6, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895568, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.294, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.331, expert1_balance_top=34.754, expert1_balance_bottom=18.285, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=229.1, ups=0.59, wpb=391.6, bsz=32, num_updates=9450, lr=7.8001e-06, gnorm=3.25, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17293
2022-05-08 01:14:30 - progress_bar.py[line:272] - INFO: epoch 001:   9474 / 17711 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.219, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.33, expert1_balance_top=34.954, expert1_balance_bottom=18.302, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=219.8, ups=0.58, wpb=380.8, bsz=32, num_updates=9460, lr=7.7971e-06, gnorm=3.028, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17311
2022-05-08 01:14:47 - progress_bar.py[line:272] - INFO: epoch 001:   9484 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.007, ntokens=387.2, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.329, expert1_balance_top=35.356, expert1_balance_bottom=18.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=222.3, ups=0.57, wpb=387.2, bsz=32, num_updates=9470, lr=7.7941e-06, gnorm=4.21, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17328
2022-05-08 01:15:05 - progress_bar.py[line:272] - INFO: epoch 001:   9494 / 17711 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=381.4, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.24, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.33, expert1_balance_top=35.093, expert1_balance_bottom=18.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=219.1, ups=0.57, wpb=381.4, bsz=32, num_updates=9480, lr=7.79109e-06, gnorm=3.283, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17346
2022-05-08 01:15:22 - progress_bar.py[line:272] - INFO: epoch 001:   9504 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.33, expert1_balance_top=34.837, expert1_balance_bottom=18.19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=224.3, ups=0.59, wpb=381.4, bsz=32, num_updates=9490, lr=7.78809e-06, gnorm=3.044, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17363
2022-05-08 01:15:39 - progress_bar.py[line:272] - INFO: epoch 001:   9514 / 17711 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=1.009, ntokens=388.1, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.22, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.329, expert1_balance_top=36.223, expert1_balance_bottom=17.722, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=225, ups=0.58, wpb=388.1, bsz=32, num_updates=9500, lr=7.78509e-06, gnorm=3.547, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17380
2022-05-08 01:15:56 - progress_bar.py[line:272] - INFO: epoch 001:   9524 / 17711 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=378.9, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895262, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.22, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.329, expert1_balance_top=34.724, expert1_balance_bottom=18.162, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.7, ups=0.58, wpb=378.9, bsz=32, num_updates=9510, lr=7.78208e-06, gnorm=3.346, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17397
2022-05-08 01:16:14 - progress_bar.py[line:272] - INFO: epoch 001:   9534 / 17711 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=1.035, ntokens=392.3, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.254, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.329, expert1_balance_top=35.201, expert1_balance_bottom=18.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=226, ups=0.58, wpb=392.3, bsz=32, num_updates=9520, lr=7.77908e-06, gnorm=3.794, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17414
2022-05-08 01:16:31 - progress_bar.py[line:272] - INFO: epoch 001:   9544 / 17711 loss=3.331, loss_v1=0, loss_v2=0, nll_loss=1.117, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882974, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.331, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.329, expert1_balance_top=35.62, expert1_balance_bottom=18.032, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=224.7, ups=0.59, wpb=383.2, bsz=32, num_updates=9530, lr=7.77608e-06, gnorm=3.52, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17432
2022-05-08 01:16:48 - progress_bar.py[line:272] - INFO: epoch 001:   9554 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88909, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.329, expert1_balance_top=34.947, expert1_balance_bottom=18.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=218.5, ups=0.58, wpb=379.6, bsz=32, num_updates=9540, lr=7.77307e-06, gnorm=3.103, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17449
2022-05-08 01:17:06 - progress_bar.py[line:272] - INFO: epoch 001:   9564 / 17711 loss=3.252, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=378.9, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.252, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.33, expert1_balance_top=34.481, expert1_balance_bottom=18.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=217.5, ups=0.57, wpb=378.9, bsz=32, num_updates=9550, lr=7.77007e-06, gnorm=3.546, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17466
2022-05-08 01:17:23 - progress_bar.py[line:272] - INFO: epoch 001:   9574 / 17711 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=1.035, ntokens=388.9, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.256, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.328, expert1_balance_top=34.942, expert1_balance_bottom=18.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=227.1, ups=0.58, wpb=388.9, bsz=32, num_updates=9560, lr=7.76707e-06, gnorm=3.537, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17483
2022-05-08 01:17:40 - progress_bar.py[line:272] - INFO: epoch 001:   9584 / 17711 loss=3.262, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882366, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.262, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.328, expert1_balance_top=35.321, expert1_balance_bottom=18.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=220.8, ups=0.57, wpb=384.9, bsz=32, num_updates=9570, lr=7.76406e-06, gnorm=3.464, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17501
2022-05-08 01:17:57 - progress_bar.py[line:272] - INFO: epoch 001:   9594 / 17711 loss=3.28, loss_v1=0, loss_v2=0, nll_loss=1.059, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883771, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.28, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.328, expert1_balance_top=35.19, expert1_balance_bottom=18.038, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=222.4, ups=0.58, wpb=381.1, bsz=32, num_updates=9580, lr=7.76106e-06, gnorm=3.091, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17518
2022-05-08 01:18:14 - progress_bar.py[line:272] - INFO: epoch 001:   9604 / 17711 loss=3.359, loss_v1=0, loss_v2=0, nll_loss=1.162, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.359, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=36.053, expert1_balance_bottom=17.859, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.24, wps=225.7, ups=0.58, wpb=386.3, bsz=32, num_updates=9590, lr=7.75806e-06, gnorm=3.583, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17535
2022-05-08 01:18:32 - progress_bar.py[line:272] - INFO: epoch 001:   9614 / 17711 loss=3.26, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=374.6, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897921, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.26, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.328, expert1_balance_top=34.308, expert1_balance_bottom=18.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=215, ups=0.57, wpb=374.6, bsz=32, num_updates=9600, lr=7.75505e-06, gnorm=3.439, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17553
2022-05-08 01:18:49 - progress_bar.py[line:272] - INFO: epoch 001:   9624 / 17711 loss=3.262, loss_v1=0, loss_v2=0, nll_loss=1.033, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894566, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.262, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.33, expert1_balance_top=34.822, expert1_balance_bottom=18.123, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=222.8, ups=0.58, wpb=383.8, bsz=32, num_updates=9610, lr=7.75205e-06, gnorm=3.501, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17570
2022-05-08 01:19:06 - progress_bar.py[line:272] - INFO: epoch 001:   9634 / 17711 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=1.052, ntokens=373.2, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887107, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.274, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.328, expert1_balance_top=35.344, expert1_balance_bottom=18.094, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=217.2, ups=0.58, wpb=373.2, bsz=32, num_updates=9620, lr=7.74905e-06, gnorm=3.134, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17587
2022-05-08 01:19:15 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 01:19:25 - progress_bar.py[line:272] - INFO: epoch 001:   9645 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=387.7, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891532, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.328, expert1_balance_top=35.103, expert1_balance_bottom=18.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=202.1, ups=0.52, wpb=387.7, bsz=32, num_updates=9630, lr=7.74604e-06, gnorm=3.215, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17606
2022-05-08 01:19:43 - progress_bar.py[line:272] - INFO: epoch 001:   9655 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.078, ntokens=376.4, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885467, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.328, expert1_balance_top=35.087, expert1_balance_bottom=18.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=218.8, ups=0.58, wpb=376.4, bsz=32, num_updates=9640, lr=7.74304e-06, gnorm=3.259, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17623
2022-05-08 01:20:00 - progress_bar.py[line:272] - INFO: epoch 001:   9665 / 17711 loss=3.306, loss_v1=0, loss_v2=0, nll_loss=1.076, ntokens=381.2, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.306, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.329, expert1_balance_top=34.945, expert1_balance_bottom=18.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=221.1, ups=0.58, wpb=381.2, bsz=32, num_updates=9650, lr=7.74004e-06, gnorm=3.557, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17641
2022-05-08 01:20:17 - progress_bar.py[line:272] - INFO: epoch 001:   9675 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892722, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.328, expert1_balance_top=34.519, expert1_balance_bottom=18.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=224.1, ups=0.58, wpb=385.2, bsz=32, num_updates=9660, lr=7.73703e-06, gnorm=3.559, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17658
2022-05-08 01:20:34 - progress_bar.py[line:272] - INFO: epoch 001:   9685 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.042, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.328, expert1_balance_top=35.674, expert1_balance_bottom=18.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=217.9, ups=0.58, wpb=376.7, bsz=32, num_updates=9670, lr=7.73403e-06, gnorm=3.004, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17675
2022-05-08 01:20:52 - progress_bar.py[line:272] - INFO: epoch 001:   9695 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=34.946, expert1_balance_bottom=18.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222.4, ups=0.58, wpb=385.3, bsz=32, num_updates=9680, lr=7.73103e-06, gnorm=3.081, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17692
2022-05-08 01:21:09 - progress_bar.py[line:272] - INFO: epoch 001:   9705 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=388.5, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=35.444, expert1_balance_bottom=18.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=224.8, ups=0.58, wpb=388.5, bsz=32, num_updates=9690, lr=7.72802e-06, gnorm=3.001, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17710
2022-05-08 01:21:26 - progress_bar.py[line:272] - INFO: epoch 001:   9715 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.012, ntokens=389.1, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=35.377, expert1_balance_bottom=18.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=224.4, ups=0.58, wpb=389.1, bsz=32, num_updates=9700, lr=7.72502e-06, gnorm=3.378, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17727
2022-05-08 01:21:44 - progress_bar.py[line:272] - INFO: epoch 001:   9725 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.027, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=35.235, expert1_balance_bottom=18.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=221.2, ups=0.58, wpb=383.6, bsz=32, num_updates=9710, lr=7.72202e-06, gnorm=3.764, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17744
2022-05-08 01:22:01 - progress_bar.py[line:272] - INFO: epoch 001:   9735 / 17711 loss=3.296, loss_v1=0, loss_v2=0, nll_loss=1.061, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.296, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.329, expert1_balance_top=34.52, expert1_balance_bottom=18.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=217, ups=0.57, wpb=378.5, bsz=32, num_updates=9720, lr=7.71901e-06, gnorm=3.537, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17762
2022-05-08 01:22:19 - progress_bar.py[line:272] - INFO: epoch 001:   9745 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=381.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881597, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=35.364, expert1_balance_bottom=18.107, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=217.8, ups=0.57, wpb=381.8, bsz=32, num_updates=9730, lr=7.71601e-06, gnorm=2.95, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17779
2022-05-08 01:22:36 - progress_bar.py[line:272] - INFO: epoch 001:   9755 / 17711 loss=3.32, loss_v1=0, loss_v2=0, nll_loss=1.107, ntokens=386.7, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882417, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.32, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=35.066, expert1_balance_bottom=18.3, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=223.3, ups=0.58, wpb=386.7, bsz=32, num_updates=9740, lr=7.71301e-06, gnorm=3.858, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17797
2022-05-08 01:22:53 - progress_bar.py[line:272] - INFO: epoch 001:   9765 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=35.1, expert1_balance_bottom=18.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.9, ups=0.57, wpb=386.3, bsz=32, num_updates=9750, lr=7.71e-06, gnorm=3.826, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17814
2022-05-08 01:23:11 - progress_bar.py[line:272] - INFO: epoch 001:   9775 / 17711 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=1.059, ntokens=378.2, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.282, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=34.983, expert1_balance_bottom=18.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=217, ups=0.57, wpb=378.2, bsz=32, num_updates=9760, lr=7.707e-06, gnorm=3.315, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17832
2022-05-08 01:23:28 - progress_bar.py[line:272] - INFO: epoch 001:   9785 / 17711 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.205, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=34.69, expert1_balance_bottom=18.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=222.4, ups=0.58, wpb=386.4, bsz=32, num_updates=9770, lr=7.704e-06, gnorm=4.174, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17849
2022-05-08 01:23:46 - progress_bar.py[line:272] - INFO: epoch 001:   9795 / 17711 loss=3.279, loss_v1=0, loss_v2=0, nll_loss=1.068, ntokens=390.2, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877417, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.279, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=35.647, expert1_balance_bottom=17.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=226.2, ups=0.58, wpb=390.2, bsz=32, num_updates=9780, lr=7.70099e-06, gnorm=3.616, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17866
2022-05-08 01:24:03 - progress_bar.py[line:272] - INFO: epoch 001:   9805 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=373.2, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89383, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=34.417, expert1_balance_bottom=18.312, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=218.4, ups=0.59, wpb=373.2, bsz=32, num_updates=9790, lr=7.69799e-06, gnorm=3.4, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17883
2022-05-08 01:24:20 - progress_bar.py[line:272] - INFO: epoch 001:   9815 / 17711 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=1.047, ntokens=375.3, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891623, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.274, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=34.547, expert1_balance_bottom=18.554, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=216.9, ups=0.58, wpb=375.3, bsz=32, num_updates=9800, lr=7.69499e-06, gnorm=3.466, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17901
2022-05-08 01:24:37 - progress_bar.py[line:272] - INFO: epoch 001:   9825 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=386.5, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887209, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.327, expert1_balance_top=35.067, expert1_balance_bottom=18.191, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222.8, ups=0.58, wpb=386.5, bsz=32, num_updates=9810, lr=7.69198e-06, gnorm=3.667, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17918
2022-05-08 01:24:55 - progress_bar.py[line:272] - INFO: epoch 001:   9835 / 17711 loss=3.275, loss_v1=0, loss_v2=0, nll_loss=1.062, ntokens=379.1, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.275, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=35.401, expert1_balance_bottom=17.873, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=212.8, ups=0.56, wpb=379.1, bsz=32, num_updates=9820, lr=7.68898e-06, gnorm=3.428, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17936
2022-05-08 01:25:13 - progress_bar.py[line:272] - INFO: epoch 001:   9845 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.026, ntokens=374.6, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.326, expert1_balance_top=35.106, expert1_balance_bottom=18.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=213.2, ups=0.57, wpb=374.6, bsz=32, num_updates=9830, lr=7.68598e-06, gnorm=3.299, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17953
2022-05-08 01:25:30 - progress_bar.py[line:272] - INFO: epoch 001:   9855 / 17711 loss=3.313, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889077, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.313, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.326, expert1_balance_top=34.785, expert1_balance_bottom=18.067, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=222.1, ups=0.58, wpb=381, bsz=32, num_updates=9840, lr=7.68297e-06, gnorm=3.872, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=17971
2022-05-08 01:25:47 - progress_bar.py[line:272] - INFO: epoch 001:   9865 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=379.9, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.326, expert1_balance_top=34.358, expert1_balance_bottom=18.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=222, ups=0.58, wpb=379.9, bsz=32, num_updates=9850, lr=7.67997e-06, gnorm=3.275, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=17988
2022-05-08 01:26:04 - progress_bar.py[line:272] - INFO: epoch 001:   9875 / 17711 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.998, ntokens=376.7, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.231, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.326, expert1_balance_top=34.213, expert1_balance_bottom=18.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=217.4, ups=0.58, wpb=376.7, bsz=32, num_updates=9860, lr=7.67697e-06, gnorm=3.505, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=18005
2022-05-08 01:26:22 - progress_bar.py[line:272] - INFO: epoch 001:   9885 / 17711 loss=3.268, loss_v1=0, loss_v2=0, nll_loss=1.036, ntokens=393.7, nsentences=32, sample_size=313.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889268, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.268, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.326, expert1_balance_top=34.871, expert1_balance_bottom=18.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=225, ups=0.57, wpb=393.7, bsz=32, num_updates=9870, lr=7.67396e-06, gnorm=3.733, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18023
2022-05-08 01:26:39 - progress_bar.py[line:272] - INFO: epoch 001:   9895 / 17711 loss=3.263, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=381.4, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.263, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.326, expert1_balance_top=34.331, expert1_balance_bottom=18.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=223.3, ups=0.59, wpb=381.4, bsz=32, num_updates=9880, lr=7.67096e-06, gnorm=3.931, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18040
2022-05-08 01:26:56 - progress_bar.py[line:272] - INFO: epoch 001:   9905 / 17711 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=1.015, ntokens=382, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.243, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=34.937, expert1_balance_bottom=18.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=221.7, ups=0.58, wpb=382, bsz=32, num_updates=9890, lr=7.66796e-06, gnorm=3.503, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18057
2022-05-08 01:27:13 - progress_bar.py[line:272] - INFO: epoch 001:   9915 / 17711 loss=3.224, loss_v1=0, loss_v2=0, nll_loss=1, ntokens=393.6, nsentences=32, sample_size=313.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.224, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=35.494, expert1_balance_bottom=18.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=226.6, ups=0.58, wpb=393.6, bsz=32, num_updates=9900, lr=7.66495e-06, gnorm=3.184, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18074
2022-05-08 01:27:31 - progress_bar.py[line:272] - INFO: epoch 001:   9925 / 17711 loss=3.258, loss_v1=0, loss_v2=0, nll_loss=1.04, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.258, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=35.242, expert1_balance_bottom=18.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=222.1, ups=0.58, wpb=383.6, bsz=32, num_updates=9910, lr=7.66195e-06, gnorm=3.215, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18091
2022-05-08 01:27:48 - progress_bar.py[line:272] - INFO: epoch 001:   9935 / 17711 loss=3.307, loss_v1=0, loss_v2=0, nll_loss=1.098, ntokens=388.1, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883458, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.307, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=35.356, expert1_balance_bottom=18.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=221.4, ups=0.57, wpb=388.1, bsz=32, num_updates=9920, lr=7.65895e-06, gnorm=3.025, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18109
2022-05-08 01:28:05 - progress_bar.py[line:272] - INFO: epoch 001:   9945 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887355, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=35.088, expert1_balance_bottom=18.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.7, ups=0.58, wpb=383.3, bsz=32, num_updates=9930, lr=7.65594e-06, gnorm=2.823, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18126
2022-05-08 01:28:23 - progress_bar.py[line:272] - INFO: epoch 001:   9955 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=369.2, nsentences=32, sample_size=293.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89079, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=34.66, expert1_balance_bottom=18.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=212.6, ups=0.58, wpb=369.2, bsz=32, num_updates=9940, lr=7.65294e-06, gnorm=3.672, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18144
2022-05-08 01:28:40 - progress_bar.py[line:272] - INFO: epoch 001:   9965 / 17711 loss=3.275, loss_v1=0, loss_v2=0, nll_loss=1.038, ntokens=374.8, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895709, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.275, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=34.076, expert1_balance_bottom=18.615, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=219.5, ups=0.59, wpb=374.8, bsz=32, num_updates=9950, lr=7.64994e-06, gnorm=3.618, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=18161
2022-05-08 01:28:57 - progress_bar.py[line:272] - INFO: epoch 001:   9975 / 17711 loss=3.251, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888421, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.251, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.324, expert1_balance_top=35.018, expert1_balance_bottom=18.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=223.3, ups=0.59, wpb=380.5, bsz=32, num_updates=9960, lr=7.64694e-06, gnorm=3.394, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18178
2022-05-08 01:29:14 - progress_bar.py[line:272] - INFO: epoch 001:   9985 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.012, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883484, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.324, expert1_balance_top=35.434, expert1_balance_bottom=18.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=225.7, ups=0.6, wpb=378.2, bsz=32, num_updates=9970, lr=7.64393e-06, gnorm=3.601, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18194
2022-05-08 01:29:31 - progress_bar.py[line:272] - INFO: epoch 001:   9995 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.045, ntokens=380.2, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876129, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=35.714, expert1_balance_bottom=18.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=224.3, ups=0.59, wpb=380.2, bsz=32, num_updates=9980, lr=7.64093e-06, gnorm=3.038, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18211
2022-05-08 01:29:48 - progress_bar.py[line:272] - INFO: epoch 001:  10005 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=34.308, expert1_balance_bottom=18.6, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=221.9, ups=0.58, wpb=380.2, bsz=32, num_updates=9990, lr=7.63793e-06, gnorm=3.246, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=18229
2022-05-08 01:30:05 - progress_bar.py[line:272] - INFO: epoch 001:  10015 / 17711 loss=3.251, loss_v1=0, loss_v2=0, nll_loss=1.031, ntokens=375.8, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.251, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.325, expert1_balance_top=34.838, expert1_balance_bottom=18.541, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=217.8, ups=0.58, wpb=375.8, bsz=32, num_updates=10000, lr=7.63492e-06, gnorm=3.967, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18246
2022-05-08 01:30:05 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 01:30:05 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 01:30:05 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 01:37:19 - train.py[line:517] - INFO: valid_step finished
2022-05-08 01:37:19 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.118 | loss_v1 0 | loss_v2 0 | nll_loss 7.396 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.96884 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.118 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.334 | expert1_balance_top 37.311 | expert1_balance_bottom 14.463 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 168.41 | cider 1.123 | wps 694.6 | wpb 481.7 | bsz 8 | num_updates 10000 | best_cider 1.123
2022-05-08 01:37:19 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 1 @ 10000 updates
2022-05-08 01:37:19 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_10000-rank-0.pt
2022-05-08 01:37:19 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_10000-rank-0.pt
2022-05-08 01:37:28 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_10000-rank-0.pt
2022-05-08 01:37:28 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_10000-shared.pt
2022-05-08 01:37:37 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_10000-shared.pt
2022-05-08 01:38:05 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_10000-rank-0.pt (epoch 1 @ 10000 updates, score 1.123) (writing took 46.13494900520891 seconds)
2022-05-08 01:38:22 - progress_bar.py[line:272] - INFO: epoch 001:  10025 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=388.5, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879301, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=35.526, expert1_balance_bottom=18.02, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=7.8, ups=0.02, wpb=388.5, bsz=32, num_updates=10010, lr=7.63192e-06, gnorm=3.387, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=18743
2022-05-08 01:38:39 - progress_bar.py[line:272] - INFO: epoch 001:  10035 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=384.9, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=35.047, expert1_balance_bottom=18.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222.8, ups=0.58, wpb=384.9, bsz=32, num_updates=10020, lr=7.62892e-06, gnorm=3.06, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18760
2022-05-08 01:38:56 - progress_bar.py[line:272] - INFO: epoch 001:  10045 / 17711 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=1.019, ntokens=383.5, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885127, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=35.114, expert1_balance_bottom=18.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=224.1, ups=0.58, wpb=383.5, bsz=32, num_updates=10030, lr=7.62591e-06, gnorm=3.722, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18777
2022-05-08 01:39:14 - progress_bar.py[line:272] - INFO: epoch 001:  10055 / 17711 loss=3.351, loss_v1=0, loss_v2=0, nll_loss=1.137, ntokens=382.1, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88794, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.351, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.324, expert1_balance_top=35.567, expert1_balance_bottom=18.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.2, wps=220.3, ups=0.58, wpb=382.1, bsz=32, num_updates=10040, lr=7.62291e-06, gnorm=3.386, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18794
2022-05-08 01:39:31 - progress_bar.py[line:272] - INFO: epoch 001:  10065 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.98, ntokens=378.9, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890179, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=35.007, expert1_balance_bottom=18.385, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.7, ups=0.58, wpb=378.9, bsz=32, num_updates=10050, lr=7.61991e-06, gnorm=4.284, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18812
2022-05-08 01:39:48 - progress_bar.py[line:272] - INFO: epoch 001:  10075 / 17711 loss=3.25, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=371.9, nsentences=32, sample_size=295.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.25, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=34.972, expert1_balance_bottom=18.365, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=212.1, ups=0.57, wpb=371.9, bsz=32, num_updates=10060, lr=7.6169e-06, gnorm=3.359, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18829
2022-05-08 01:40:06 - progress_bar.py[line:272] - INFO: epoch 001:  10085 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=383, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877225, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.322, expert1_balance_top=36.132, expert1_balance_bottom=17.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=219.7, ups=0.57, wpb=383, bsz=32, num_updates=10070, lr=7.6139e-06, gnorm=3.066, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18847
2022-05-08 01:40:23 - progress_bar.py[line:272] - INFO: epoch 001:  10095 / 17711 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=377.8, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.234, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=34.288, expert1_balance_bottom=18.561, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=219.3, ups=0.58, wpb=377.8, bsz=32, num_updates=10080, lr=7.6109e-06, gnorm=3.655, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18864
2022-05-08 01:40:40 - progress_bar.py[line:272] - INFO: epoch 001:  10105 / 17711 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=1.023, ntokens=388.9, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.253, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=35.465, expert1_balance_bottom=18.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=225.6, ups=0.58, wpb=388.9, bsz=32, num_updates=10090, lr=7.60789e-06, gnorm=3.327, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18881
2022-05-08 01:40:58 - progress_bar.py[line:272] - INFO: epoch 001:  10115 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=377.9, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=34.921, expert1_balance_bottom=18.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=216.7, ups=0.57, wpb=377.9, bsz=32, num_updates=10100, lr=7.60489e-06, gnorm=3.141, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18899
2022-05-08 01:41:15 - progress_bar.py[line:272] - INFO: epoch 001:  10125 / 17711 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=1.022, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880317, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=35.704, expert1_balance_bottom=18.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=218.1, ups=0.57, wpb=382.8, bsz=32, num_updates=10110, lr=7.60189e-06, gnorm=3.437, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18916
2022-05-08 01:41:33 - progress_bar.py[line:272] - INFO: epoch 001:  10135 / 17711 loss=3.301, loss_v1=0, loss_v2=0, nll_loss=1.072, ntokens=384.9, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.301, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.322, expert1_balance_top=34.721, expert1_balance_bottom=18.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=222.5, ups=0.58, wpb=384.9, bsz=32, num_updates=10120, lr=7.59888e-06, gnorm=4.276, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=18933
2022-05-08 01:41:50 - progress_bar.py[line:272] - INFO: epoch 001:  10145 / 17711 loss=3.25, loss_v1=0, loss_v2=0, nll_loss=1.033, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.25, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=35.468, expert1_balance_bottom=17.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=222.2, ups=0.59, wpb=378.5, bsz=32, num_updates=10130, lr=7.59588e-06, gnorm=3.416, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18950
2022-05-08 01:42:07 - progress_bar.py[line:272] - INFO: epoch 001:  10155 / 17711 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=388.3, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883415, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.238, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.322, expert1_balance_top=35.353, expert1_balance_bottom=18.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=221.5, ups=0.57, wpb=388.3, bsz=32, num_updates=10140, lr=7.59288e-06, gnorm=3.452, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18968
2022-05-08 01:42:25 - progress_bar.py[line:272] - INFO: epoch 001:  10165 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.974, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894585, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.323, expert1_balance_top=34.61, expert1_balance_bottom=18.372, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=219.2, ups=0.58, wpb=381.1, bsz=32, num_updates=10150, lr=7.58987e-06, gnorm=3.397, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=18985
2022-05-08 01:42:42 - progress_bar.py[line:272] - INFO: epoch 001:  10175 / 17711 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=377.6, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886311, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.231, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.321, expert1_balance_top=35.524, expert1_balance_bottom=18.135, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=218.3, ups=0.58, wpb=377.6, bsz=32, num_updates=10160, lr=7.58687e-06, gnorm=3.773, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19003
2022-05-08 01:42:59 - progress_bar.py[line:272] - INFO: epoch 001:  10185 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=383.7, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87353, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.321, expert1_balance_top=36.234, expert1_balance_bottom=17.785, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221, ups=0.58, wpb=383.7, bsz=32, num_updates=10170, lr=7.58387e-06, gnorm=2.793, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19020
2022-05-08 01:43:16 - progress_bar.py[line:272] - INFO: epoch 001:  10195 / 17711 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88053, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.214, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.322, expert1_balance_top=35.294, expert1_balance_bottom=18.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=221, ups=0.58, wpb=382.1, bsz=32, num_updates=10180, lr=7.58086e-06, gnorm=3.662, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19037
2022-05-08 01:43:34 - progress_bar.py[line:272] - INFO: epoch 001:  10205 / 17711 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.225, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.324, expert1_balance_top=33.978, expert1_balance_bottom=18.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=222.9, ups=0.58, wpb=384.1, bsz=32, num_updates=10190, lr=7.57786e-06, gnorm=4.205, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=19055
2022-05-08 01:43:51 - progress_bar.py[line:272] - INFO: epoch 001:  10215 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=379.8, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880834, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.321, expert1_balance_top=35.468, expert1_balance_bottom=17.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=217.8, ups=0.57, wpb=379.8, bsz=32, num_updates=10200, lr=7.57486e-06, gnorm=3.342, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19072
2022-05-08 01:44:09 - progress_bar.py[line:272] - INFO: epoch 001:  10225 / 17711 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=1.04, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880959, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.256, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.32, expert1_balance_top=35.585, expert1_balance_bottom=18.091, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=217.9, ups=0.57, wpb=379.7, bsz=32, num_updates=10210, lr=7.57185e-06, gnorm=3.321, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19089
2022-05-08 01:44:26 - progress_bar.py[line:272] - INFO: epoch 001:  10235 / 17711 loss=3.245, loss_v1=0, loss_v2=0, nll_loss=1.019, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.245, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.321, expert1_balance_top=34.778, expert1_balance_bottom=18.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=218.3, ups=0.58, wpb=377.1, bsz=32, num_updates=10220, lr=7.56885e-06, gnorm=4.17, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19107
2022-05-08 01:44:43 - progress_bar.py[line:272] - INFO: epoch 001:  10245 / 17711 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=1.051, ntokens=379.7, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884762, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.272, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.322, expert1_balance_top=35.135, expert1_balance_bottom=18.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=218, ups=0.57, wpb=379.7, bsz=32, num_updates=10230, lr=7.56585e-06, gnorm=3.186, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19124
2022-05-08 01:45:01 - progress_bar.py[line:272] - INFO: epoch 001:  10255 / 17711 loss=3.271, loss_v1=0, loss_v2=0, nll_loss=1.069, ntokens=390.1, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869899, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.271, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.32, expert1_balance_top=35.889, expert1_balance_bottom=18.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=224.9, ups=0.58, wpb=390.1, bsz=32, num_updates=10240, lr=7.56284e-06, gnorm=3.135, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19141
2022-05-08 01:45:18 - progress_bar.py[line:272] - INFO: epoch 001:  10265 / 17711 loss=3.263, loss_v1=0, loss_v2=0, nll_loss=1.063, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873345, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.263, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.32, expert1_balance_top=36.422, expert1_balance_bottom=17.846, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=219.3, ups=0.58, wpb=376.7, bsz=32, num_updates=10250, lr=7.55984e-06, gnorm=3.503, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19159
2022-05-08 01:45:35 - progress_bar.py[line:272] - INFO: epoch 001:  10275 / 17711 loss=3.259, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=381.3, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.259, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.322, expert1_balance_top=34.126, expert1_balance_bottom=18.603, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=219.4, ups=0.58, wpb=381.3, bsz=32, num_updates=10260, lr=7.55684e-06, gnorm=3.474, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19176
2022-05-08 01:45:52 - progress_bar.py[line:272] - INFO: epoch 001:  10285 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.025, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.321, expert1_balance_top=35.187, expert1_balance_bottom=18.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=222.4, ups=0.58, wpb=382.8, bsz=32, num_updates=10270, lr=7.55383e-06, gnorm=3.126, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=19193
2022-05-08 01:46:10 - progress_bar.py[line:272] - INFO: epoch 001:  10295 / 17711 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=1.056, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.272, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.32, expert1_balance_top=35.443, expert1_balance_bottom=18.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=220.4, ups=0.58, wpb=380.8, bsz=32, num_updates=10280, lr=7.55083e-06, gnorm=3.437, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19210
2022-05-08 01:46:27 - progress_bar.py[line:272] - INFO: epoch 001:  10305 / 17711 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=1.03, ntokens=381.9, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.256, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.321, expert1_balance_top=35.325, expert1_balance_bottom=18.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=222.5, ups=0.58, wpb=381.9, bsz=32, num_updates=10290, lr=7.54783e-06, gnorm=3.42, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19228
2022-05-08 01:46:44 - progress_bar.py[line:272] - INFO: epoch 001:  10315 / 17711 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.189, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.321, expert1_balance_top=34.579, expert1_balance_bottom=18.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221.9, ups=0.58, wpb=379.8, bsz=32, num_updates=10300, lr=7.54482e-06, gnorm=3.289, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19245
2022-05-08 01:47:01 - progress_bar.py[line:272] - INFO: epoch 001:  10325 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=380.3, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.321, expert1_balance_top=35.411, expert1_balance_bottom=18.023, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=220, ups=0.58, wpb=380.3, bsz=32, num_updates=10310, lr=7.54182e-06, gnorm=3.154, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19262
2022-05-08 01:47:18 - progress_bar.py[line:272] - INFO: epoch 001:  10335 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87971, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.319, expert1_balance_top=35.332, expert1_balance_bottom=18.134, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220.1, ups=0.58, wpb=378.8, bsz=32, num_updates=10320, lr=7.53882e-06, gnorm=2.844, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19279
2022-05-08 01:47:36 - progress_bar.py[line:272] - INFO: epoch 001:  10345 / 17711 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=1.011, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88172, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.225, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.32, expert1_balance_top=35.585, expert1_balance_bottom=18.135, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=217.1, ups=0.57, wpb=377.9, bsz=32, num_updates=10330, lr=7.53581e-06, gnorm=3.11, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19297
2022-05-08 01:47:53 - progress_bar.py[line:272] - INFO: epoch 001:  10355 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=375.6, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.321, expert1_balance_top=34.735, expert1_balance_bottom=18.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=216.6, ups=0.58, wpb=375.6, bsz=32, num_updates=10340, lr=7.53281e-06, gnorm=2.994, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19314
2022-05-08 01:48:11 - progress_bar.py[line:272] - INFO: epoch 001:  10365 / 17711 loss=3.302, loss_v1=0, loss_v2=0, nll_loss=1.085, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88686, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.302, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.32, expert1_balance_top=35.522, expert1_balance_bottom=18.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=219.4, ups=0.58, wpb=381.1, bsz=32, num_updates=10350, lr=7.52981e-06, gnorm=3.68, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=19331
2022-05-08 01:48:28 - progress_bar.py[line:272] - INFO: epoch 001:  10375 / 17711 loss=3.277, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=387.8, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878817, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.277, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=35.476, expert1_balance_bottom=18.351, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=224.4, ups=0.58, wpb=387.8, bsz=32, num_updates=10360, lr=7.5268e-06, gnorm=3.867, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=19349
2022-05-08 01:48:45 - progress_bar.py[line:272] - INFO: epoch 001:  10385 / 17711 loss=3.279, loss_v1=0, loss_v2=0, nll_loss=1.054, ntokens=379.4, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888698, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.279, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.319, expert1_balance_top=35.09, expert1_balance_bottom=18.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=217.5, ups=0.57, wpb=379.4, bsz=32, num_updates=10370, lr=7.5238e-06, gnorm=3.942, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19366
2022-05-08 01:49:02 - progress_bar.py[line:272] - INFO: epoch 001:  10395 / 17711 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=378.5, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888417, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.23, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.32, expert1_balance_top=34.707, expert1_balance_bottom=18.48, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=221, ups=0.58, wpb=378.5, bsz=32, num_updates=10380, lr=7.5208e-06, gnorm=3.337, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=19383
2022-05-08 01:49:20 - progress_bar.py[line:272] - INFO: epoch 001:  10405 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.049, ntokens=388.3, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=35.622, expert1_balance_bottom=18.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=225.3, ups=0.58, wpb=388.3, bsz=32, num_updates=10390, lr=7.51779e-06, gnorm=3.565, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19400
2022-05-08 01:49:37 - progress_bar.py[line:272] - INFO: epoch 001:  10415 / 17711 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.237, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.319, expert1_balance_top=35.601, expert1_balance_bottom=18.189, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=221.7, ups=0.57, wpb=388, bsz=32, num_updates=10400, lr=7.51479e-06, gnorm=3.24, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19418
2022-05-08 01:49:55 - progress_bar.py[line:272] - INFO: epoch 001:  10425 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.039, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.32, expert1_balance_top=34.699, expert1_balance_bottom=18.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=214.5, ups=0.56, wpb=380, bsz=32, num_updates=10410, lr=7.51179e-06, gnorm=3.033, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19436
2022-05-08 01:50:12 - progress_bar.py[line:272] - INFO: epoch 001:  10435 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886721, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.319, expert1_balance_top=35.016, expert1_balance_bottom=18.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=219.6, ups=0.58, wpb=378.7, bsz=32, num_updates=10420, lr=7.50878e-06, gnorm=3.542, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19453
2022-05-08 01:50:30 - progress_bar.py[line:272] - INFO: epoch 001:  10445 / 17711 loss=3.303, loss_v1=0, loss_v2=0, nll_loss=1.077, ntokens=381.1, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890947, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.303, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.319, expert1_balance_top=34.89, expert1_balance_bottom=18.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=218.2, ups=0.57, wpb=381.1, bsz=32, num_updates=10430, lr=7.50578e-06, gnorm=3.19, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19470
2022-05-08 01:50:47 - progress_bar.py[line:272] - INFO: epoch 001:  10455 / 17711 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=1.018, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88452, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.239, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.319, expert1_balance_top=35.584, expert1_balance_bottom=17.761, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=222.8, ups=0.58, wpb=381.8, bsz=32, num_updates=10440, lr=7.50278e-06, gnorm=3.241, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19488
2022-05-08 01:51:04 - progress_bar.py[line:272] - INFO: epoch 001:  10465 / 17711 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881942, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.199, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=35.559, expert1_balance_bottom=18.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=221.6, ups=0.58, wpb=380.6, bsz=32, num_updates=10450, lr=7.49977e-06, gnorm=3.214, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19505
2022-05-08 01:51:21 - progress_bar.py[line:272] - INFO: epoch 001:  10475 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.076, ntokens=372, nsentences=32, sample_size=295.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888155, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=34.735, expert1_balance_bottom=18.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=216, ups=0.58, wpb=372, bsz=32, num_updates=10460, lr=7.49677e-06, gnorm=3.739, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=19522
2022-05-08 01:51:38 - progress_bar.py[line:272] - INFO: epoch 001:  10485 / 17711 loss=3.263, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=394.7, nsentences=32, sample_size=313.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879661, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.263, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.317, expert1_balance_top=35.279, expert1_balance_bottom=18.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=228.8, ups=0.58, wpb=394.7, bsz=32, num_updates=10470, lr=7.49377e-06, gnorm=3.638, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19539
2022-05-08 01:51:56 - progress_bar.py[line:272] - INFO: epoch 001:  10495 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=34.648, expert1_balance_bottom=18.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.7, ups=0.58, wpb=383.2, bsz=32, num_updates=10480, lr=7.49076e-06, gnorm=3.226, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19556
2022-05-08 01:52:13 - progress_bar.py[line:272] - INFO: epoch 001:  10505 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=377.5, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8877, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.319, expert1_balance_top=35.094, expert1_balance_bottom=18.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221.2, ups=0.59, wpb=377.5, bsz=32, num_updates=10490, lr=7.48776e-06, gnorm=3.407, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19573
2022-05-08 01:52:30 - progress_bar.py[line:272] - INFO: epoch 001:  10515 / 17711 loss=3.276, loss_v1=0, loss_v2=0, nll_loss=1.054, ntokens=382, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884097, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.276, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.317, expert1_balance_top=34.97, expert1_balance_bottom=18.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=222.6, ups=0.58, wpb=382, bsz=32, num_updates=10500, lr=7.48476e-06, gnorm=3.387, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19591
2022-05-08 01:52:47 - progress_bar.py[line:272] - INFO: epoch 001:  10525 / 17711 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=1.055, ntokens=388.8, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.274, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=34.898, expert1_balance_bottom=18.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=224.1, ups=0.58, wpb=388.8, bsz=32, num_updates=10510, lr=7.48176e-06, gnorm=3.26, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=19608
2022-05-08 01:53:04 - progress_bar.py[line:272] - INFO: epoch 001:  10535 / 17711 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.993, ntokens=373.1, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.219, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.317, expert1_balance_top=35.139, expert1_balance_bottom=18.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=217.8, ups=0.58, wpb=373.1, bsz=32, num_updates=10520, lr=7.47875e-06, gnorm=3.242, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19625
2022-05-08 01:53:21 - progress_bar.py[line:272] - INFO: epoch 001:  10545 / 17711 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=385, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886771, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.167, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=34.94, expert1_balance_bottom=18.418, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=225.6, ups=0.59, wpb=385, bsz=32, num_updates=10530, lr=7.47575e-06, gnorm=3.071, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19642
2022-05-08 01:53:39 - progress_bar.py[line:272] - INFO: epoch 001:  10555 / 17711 loss=3.25, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=376, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884448, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.25, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=35.101, expert1_balance_bottom=18.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=216.3, ups=0.58, wpb=376, bsz=32, num_updates=10540, lr=7.47275e-06, gnorm=3.072, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19660
2022-05-08 01:53:56 - progress_bar.py[line:272] - INFO: epoch 001:  10565 / 17711 loss=3.294, loss_v1=0, loss_v2=0, nll_loss=1.086, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883145, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.294, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=35.042, expert1_balance_bottom=18.219, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=225.3, ups=0.59, wpb=384.3, bsz=32, num_updates=10550, lr=7.46974e-06, gnorm=3.316, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19677
2022-05-08 01:54:13 - progress_bar.py[line:272] - INFO: epoch 001:  10575 / 17711 loss=3.298, loss_v1=0, loss_v2=0, nll_loss=1.082, ntokens=374.4, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896664, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.298, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=34.275, expert1_balance_bottom=18.577, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=215.7, ups=0.58, wpb=374.4, bsz=32, num_updates=10560, lr=7.46674e-06, gnorm=3.614, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19694
2022-05-08 01:54:31 - progress_bar.py[line:272] - INFO: epoch 001:  10585 / 17711 loss=3.283, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=382.8, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.283, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.317, expert1_balance_top=34.952, expert1_balance_bottom=18.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=217.1, ups=0.57, wpb=382.8, bsz=32, num_updates=10570, lr=7.46374e-06, gnorm=3.212, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19712
2022-05-08 01:54:48 - progress_bar.py[line:272] - INFO: epoch 001:  10595 / 17711 loss=3.27, loss_v1=0, loss_v2=0, nll_loss=1.052, ntokens=378.4, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883509, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.27, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=34.966, expert1_balance_bottom=18.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=216.9, ups=0.57, wpb=378.4, bsz=32, num_updates=10580, lr=7.46073e-06, gnorm=3.079, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19729
2022-05-08 01:55:06 - progress_bar.py[line:272] - INFO: epoch 001:  10605 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.974, ntokens=380.3, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=34.628, expert1_balance_bottom=18.546, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=218.1, ups=0.57, wpb=380.3, bsz=32, num_updates=10590, lr=7.45773e-06, gnorm=3.095, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19746
2022-05-08 01:55:23 - progress_bar.py[line:272] - INFO: epoch 001:  10615 / 17711 loss=3.26, loss_v1=0, loss_v2=0, nll_loss=1.053, ntokens=389.3, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8766, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.26, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=35.391, expert1_balance_bottom=18.327, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=221.5, ups=0.57, wpb=389.3, bsz=32, num_updates=10600, lr=7.45473e-06, gnorm=3.301, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=19764
2022-05-08 01:55:41 - progress_bar.py[line:272] - INFO: epoch 001:  10625 / 17711 loss=3.261, loss_v1=0, loss_v2=0, nll_loss=1.042, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.261, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.318, expert1_balance_top=35.318, expert1_balance_bottom=18.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=221.5, ups=0.58, wpb=383.5, bsz=32, num_updates=10610, lr=7.45172e-06, gnorm=3.17, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19781
2022-05-08 01:55:58 - progress_bar.py[line:272] - INFO: epoch 001:  10635 / 17711 loss=3.25, loss_v1=0, loss_v2=0, nll_loss=1.03, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885493, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.25, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=35.066, expert1_balance_bottom=18.142, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=224.4, ups=0.58, wpb=388.2, bsz=32, num_updates=10620, lr=7.44872e-06, gnorm=2.651, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19799
2022-05-08 01:56:15 - progress_bar.py[line:272] - INFO: epoch 001:  10645 / 17711 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=388.7, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.216, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=35.352, expert1_balance_bottom=18.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=226.9, ups=0.58, wpb=388.7, bsz=32, num_updates=10630, lr=7.44572e-06, gnorm=2.928, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19816
2022-05-08 01:56:32 - progress_bar.py[line:272] - INFO: epoch 001:  10655 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.998, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881484, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=35.145, expert1_balance_bottom=18.354, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=224.5, ups=0.58, wpb=386.3, bsz=32, num_updates=10640, lr=7.44271e-06, gnorm=3.176, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19833
2022-05-08 01:56:50 - progress_bar.py[line:272] - INFO: epoch 001:  10665 / 17711 loss=3.329, loss_v1=0, loss_v2=0, nll_loss=1.125, ntokens=383.1, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.329, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=35.651, expert1_balance_bottom=18.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=221.6, ups=0.58, wpb=383.1, bsz=32, num_updates=10650, lr=7.43971e-06, gnorm=3.31, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19850
2022-05-08 01:57:07 - progress_bar.py[line:272] - INFO: epoch 001:  10675 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=1.009, ntokens=380, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=35.329, expert1_balance_bottom=18.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=217.7, ups=0.57, wpb=380, bsz=32, num_updates=10660, lr=7.43671e-06, gnorm=3.473, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19868
2022-05-08 01:57:24 - progress_bar.py[line:272] - INFO: epoch 001:  10685 / 17711 loss=3.339, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=381.9, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.339, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.317, expert1_balance_top=34.996, expert1_balance_bottom=18.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.18, wps=221.5, ups=0.58, wpb=381.9, bsz=32, num_updates=10670, lr=7.4337e-06, gnorm=4.032, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19885
2022-05-08 01:57:42 - progress_bar.py[line:272] - INFO: epoch 001:  10695 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=376.4, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893164, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.317, expert1_balance_top=34.332, expert1_balance_bottom=18.639, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=214.8, ups=0.57, wpb=376.4, bsz=32, num_updates=10680, lr=7.4307e-06, gnorm=3.465, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19903
2022-05-08 01:57:59 - progress_bar.py[line:272] - INFO: epoch 001:  10705 / 17711 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=1.033, ntokens=390.7, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.253, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=35.034, expert1_balance_bottom=18.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=222.8, ups=0.57, wpb=390.7, bsz=32, num_updates=10690, lr=7.4277e-06, gnorm=3.8, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19920
2022-05-08 01:58:17 - progress_bar.py[line:272] - INFO: epoch 001:  10715 / 17711 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887171, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.235, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.315, expert1_balance_top=35.166, expert1_balance_bottom=18.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=216.8, ups=0.57, wpb=381, bsz=32, num_updates=10700, lr=7.42469e-06, gnorm=3.518, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19938
2022-05-08 01:58:27 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 01:58:36 - progress_bar.py[line:272] - INFO: epoch 001:  10726 / 17711 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887269, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.24, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=34.96, expert1_balance_bottom=18.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=199.8, ups=0.53, wpb=378.8, bsz=32, num_updates=10710, lr=7.42169e-06, gnorm=3.405, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19957
2022-05-08 01:58:53 - progress_bar.py[line:272] - INFO: epoch 001:  10736 / 17711 loss=3.283, loss_v1=0, loss_v2=0, nll_loss=1.074, ntokens=383.6, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.283, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=35.79, expert1_balance_bottom=17.939, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=221.4, ups=0.58, wpb=383.6, bsz=32, num_updates=10720, lr=7.41869e-06, gnorm=4.491, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19974
2022-05-08 01:59:10 - progress_bar.py[line:272] - INFO: epoch 001:  10746 / 17711 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895267, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.171, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=34.327, expert1_balance_bottom=18.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=220.7, ups=0.58, wpb=378.4, bsz=32, num_updates=10730, lr=7.41568e-06, gnorm=2.845, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=19991
2022-05-08 01:59:28 - progress_bar.py[line:272] - INFO: epoch 001:  10756 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881407, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.315, expert1_balance_top=35.589, expert1_balance_bottom=18.12, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=217.3, ups=0.57, wpb=380.2, bsz=32, num_updates=10740, lr=7.41268e-06, gnorm=3.573, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20009
2022-05-08 01:59:45 - progress_bar.py[line:272] - INFO: epoch 001:  10766 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895501, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=34.598, expert1_balance_bottom=18.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222.3, ups=0.58, wpb=383.9, bsz=32, num_updates=10750, lr=7.40968e-06, gnorm=3.099, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20026
2022-05-08 02:00:02 - progress_bar.py[line:272] - INFO: epoch 001:  10776 / 17711 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885892, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.191, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.315, expert1_balance_top=35.192, expert1_balance_bottom=18.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=220.3, ups=0.57, wpb=383.4, bsz=32, num_updates=10760, lr=7.40667e-06, gnorm=3.261, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20043
2022-05-08 02:00:20 - progress_bar.py[line:272] - INFO: epoch 001:  10786 / 17711 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=387.6, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.232, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.314, expert1_balance_top=35.787, expert1_balance_bottom=18.143, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=220.7, ups=0.57, wpb=387.6, bsz=32, num_updates=10770, lr=7.40367e-06, gnorm=3.221, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20061
2022-05-08 02:00:38 - progress_bar.py[line:272] - INFO: epoch 001:  10796 / 17711 loss=3.297, loss_v1=0, loss_v2=0, nll_loss=1.079, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886794, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.297, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.314, expert1_balance_top=34.804, expert1_balance_bottom=18.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=219.4, ups=0.57, wpb=383.9, bsz=32, num_updates=10780, lr=7.40067e-06, gnorm=3.332, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20078
2022-05-08 02:00:55 - progress_bar.py[line:272] - INFO: epoch 001:  10806 / 17711 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=1.003, ntokens=377.6, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.235, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.316, expert1_balance_top=34.83, expert1_balance_bottom=18.513, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=214.1, ups=0.57, wpb=377.6, bsz=32, num_updates=10790, lr=7.39766e-06, gnorm=3.133, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20096
2022-05-08 02:01:13 - progress_bar.py[line:272] - INFO: epoch 001:  10816 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.313, expert1_balance_top=35.8, expert1_balance_bottom=17.971, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=217.6, ups=0.57, wpb=380.9, bsz=32, num_updates=10800, lr=7.39466e-06, gnorm=2.946, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20113
2022-05-08 02:01:30 - progress_bar.py[line:272] - INFO: epoch 001:  10826 / 17711 loss=3.249, loss_v1=0, loss_v2=0, nll_loss=1.04, ntokens=395.2, nsentences=32, sample_size=314.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8779, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.249, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.314, expert1_balance_top=35.995, expert1_balance_bottom=17.956, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=225.4, ups=0.57, wpb=395.2, bsz=32, num_updates=10810, lr=7.39166e-06, gnorm=3.67, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20131
2022-05-08 02:01:47 - progress_bar.py[line:272] - INFO: epoch 001:  10836 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.98, ntokens=381.1, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.315, expert1_balance_top=35.02, expert1_balance_bottom=18.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=221.2, ups=0.58, wpb=381.1, bsz=32, num_updates=10820, lr=7.38865e-06, gnorm=3.723, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20148
2022-05-08 02:02:05 - progress_bar.py[line:272] - INFO: epoch 001:  10846 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.314, expert1_balance_top=34.944, expert1_balance_bottom=18.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=216.6, ups=0.57, wpb=377.1, bsz=32, num_updates=10830, lr=7.38565e-06, gnorm=2.922, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20166
2022-05-08 02:02:22 - progress_bar.py[line:272] - INFO: epoch 001:  10856 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=393.4, nsentences=32, sample_size=313.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.313, expert1_balance_top=35.132, expert1_balance_bottom=18.359, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=227.1, ups=0.58, wpb=393.4, bsz=32, num_updates=10840, lr=7.38265e-06, gnorm=2.876, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20183
2022-05-08 02:02:39 - progress_bar.py[line:272] - INFO: epoch 001:  10866 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.314, expert1_balance_top=35.051, expert1_balance_bottom=18.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=224.6, ups=0.59, wpb=382.8, bsz=32, num_updates=10850, lr=7.37964e-06, gnorm=3.165, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20200
2022-05-08 02:02:57 - progress_bar.py[line:272] - INFO: epoch 001:  10876 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883765, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.313, expert1_balance_top=35.231, expert1_balance_bottom=18.259, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=215.1, ups=0.56, wpb=382.2, bsz=32, num_updates=10860, lr=7.37664e-06, gnorm=3.578, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20218
2022-05-08 02:03:15 - progress_bar.py[line:272] - INFO: epoch 001:  10886 / 17711 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=1.027, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.246, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.313, expert1_balance_top=35.334, expert1_balance_bottom=18.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=219.8, ups=0.57, wpb=385.4, bsz=32, num_updates=10870, lr=7.37364e-06, gnorm=3.832, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20235
2022-05-08 02:03:32 - progress_bar.py[line:272] - INFO: epoch 001:  10896 / 17711 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=1.046, ntokens=387.3, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871791, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.247, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=36.003, expert1_balance_bottom=18.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=221.2, ups=0.57, wpb=387.3, bsz=32, num_updates=10880, lr=7.37063e-06, gnorm=3.265, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20253
2022-05-08 02:03:49 - progress_bar.py[line:272] - INFO: epoch 001:  10906 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=389, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=35.682, expert1_balance_bottom=18.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=223.5, ups=0.57, wpb=389, bsz=32, num_updates=10890, lr=7.36763e-06, gnorm=2.957, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20270
2022-05-08 02:04:07 - progress_bar.py[line:272] - INFO: epoch 001:  10916 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.048, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.313, expert1_balance_top=35.81, expert1_balance_bottom=18.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=221, ups=0.57, wpb=385.8, bsz=32, num_updates=10900, lr=7.36463e-06, gnorm=3.395, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20288
2022-05-08 02:04:24 - progress_bar.py[line:272] - INFO: epoch 001:  10926 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.068, ntokens=375.4, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895215, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.315, expert1_balance_top=34.563, expert1_balance_bottom=18.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=214.1, ups=0.57, wpb=375.4, bsz=32, num_updates=10910, lr=7.36162e-06, gnorm=3.402, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20305
2022-05-08 02:04:42 - progress_bar.py[line:272] - INFO: epoch 001:  10936 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898396, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.315, expert1_balance_top=34.336, expert1_balance_bottom=18.647, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=219.9, ups=0.58, wpb=381, bsz=32, num_updates=10920, lr=7.35862e-06, gnorm=3.135, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20323
2022-05-08 02:04:59 - progress_bar.py[line:272] - INFO: epoch 001:  10946 / 17711 loss=3.242, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.242, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.314, expert1_balance_top=35.436, expert1_balance_bottom=18.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=223.8, ups=0.58, wpb=386.6, bsz=32, num_updates=10930, lr=7.35562e-06, gnorm=3.873, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20340
2022-05-08 02:05:16 - progress_bar.py[line:272] - INFO: epoch 001:  10956 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=388.3, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=35.35, expert1_balance_bottom=18.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=227.5, ups=0.59, wpb=388.3, bsz=32, num_updates=10940, lr=7.35261e-06, gnorm=3.362, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20357
2022-05-08 02:05:34 - progress_bar.py[line:272] - INFO: epoch 001:  10966 / 17711 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=376.7, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.189, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.313, expert1_balance_top=35.899, expert1_balance_bottom=18.003, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=213.5, ups=0.57, wpb=376.7, bsz=32, num_updates=10950, lr=7.34961e-06, gnorm=3.637, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20375
2022-05-08 02:05:51 - progress_bar.py[line:272] - INFO: epoch 001:  10976 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89181, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.313, expert1_balance_top=34.724, expert1_balance_bottom=18.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222.5, ups=0.58, wpb=385.5, bsz=32, num_updates=10960, lr=7.34661e-06, gnorm=3.916, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20392
2022-05-08 02:06:08 - progress_bar.py[line:272] - INFO: epoch 001:  10986 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=385.3, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=36.004, expert1_balance_bottom=18.189, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223.5, ups=0.58, wpb=385.3, bsz=32, num_updates=10970, lr=7.3436e-06, gnorm=3.092, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20409
2022-05-08 02:06:26 - progress_bar.py[line:272] - INFO: epoch 001:  10996 / 17711 loss=3.277, loss_v1=0, loss_v2=0, nll_loss=1.057, ntokens=379, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.277, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.313, expert1_balance_top=35.648, expert1_balance_bottom=18.083, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=219.8, ups=0.58, wpb=379, bsz=32, num_updates=10980, lr=7.3406e-06, gnorm=3.517, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20426
2022-05-08 02:06:43 - progress_bar.py[line:272] - INFO: epoch 001:  11006 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=1.005, ntokens=388.2, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=35.61, expert1_balance_bottom=17.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=220.3, ups=0.57, wpb=388.2, bsz=32, num_updates=10990, lr=7.3376e-06, gnorm=4.065, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20444
2022-05-08 02:07:01 - progress_bar.py[line:272] - INFO: epoch 001:  11016 / 17711 loss=3.245, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=377.6, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.245, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=34.499, expert1_balance_bottom=18.486, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=217.2, ups=0.58, wpb=377.6, bsz=32, num_updates=11000, lr=7.33459e-06, gnorm=3.38, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20461
2022-05-08 02:07:18 - progress_bar.py[line:272] - INFO: epoch 001:  11026 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.961, ntokens=373.4, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891224, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=35.029, expert1_balance_bottom=18.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=213.6, ups=0.57, wpb=373.4, bsz=32, num_updates=11010, lr=7.33159e-06, gnorm=3.39, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20479
2022-05-08 02:07:35 - progress_bar.py[line:272] - INFO: epoch 001:  11036 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894072, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=34.637, expert1_balance_bottom=18.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222.9, ups=0.59, wpb=380.3, bsz=32, num_updates=11020, lr=7.32859e-06, gnorm=2.918, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20496
2022-05-08 02:07:52 - progress_bar.py[line:272] - INFO: epoch 001:  11046 / 17711 loss=3.267, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=382.2, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887111, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.267, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=34.993, expert1_balance_bottom=18.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=221.4, ups=0.58, wpb=382.2, bsz=32, num_updates=11030, lr=7.32558e-06, gnorm=3.709, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20513
2022-05-08 02:08:10 - progress_bar.py[line:272] - INFO: epoch 001:  11056 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=380.4, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894215, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.313, expert1_balance_top=34.545, expert1_balance_bottom=18.433, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=221.9, ups=0.58, wpb=380.4, bsz=32, num_updates=11040, lr=7.32258e-06, gnorm=3.272, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20530
2022-05-08 02:08:27 - progress_bar.py[line:272] - INFO: epoch 001:  11066 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=386.5, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878148, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=35.822, expert1_balance_bottom=18.073, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=223.7, ups=0.58, wpb=386.5, bsz=32, num_updates=11050, lr=7.31958e-06, gnorm=3.242, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20548
2022-05-08 02:08:44 - progress_bar.py[line:272] - INFO: epoch 001:  11076 / 17711 loss=3.257, loss_v1=0, loss_v2=0, nll_loss=1.032, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888855, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.257, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=35.207, expert1_balance_bottom=18.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=218.6, ups=0.58, wpb=378.7, bsz=32, num_updates=11060, lr=7.31658e-06, gnorm=3.428, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20565
2022-05-08 02:09:02 - progress_bar.py[line:272] - INFO: epoch 001:  11086 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=35.108, expert1_balance_bottom=18.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.3, ups=0.57, wpb=381.8, bsz=32, num_updates=11070, lr=7.31357e-06, gnorm=3.119, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20582
2022-05-08 02:09:19 - progress_bar.py[line:272] - INFO: epoch 001:  11096 / 17711 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=1.016, ntokens=382.8, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.23, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.31, expert1_balance_top=35.838, expert1_balance_bottom=18.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=224.1, ups=0.59, wpb=382.8, bsz=32, num_updates=11080, lr=7.31057e-06, gnorm=3.164, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=20599
2022-05-08 02:09:36 - progress_bar.py[line:272] - INFO: epoch 001:  11106 / 17711 loss=3.315, loss_v1=0, loss_v2=0, nll_loss=1.117, ntokens=383.3, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87672, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.315, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=35.944, expert1_balance_bottom=18.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.17, wps=223, ups=0.58, wpb=383.3, bsz=32, num_updates=11090, lr=7.30757e-06, gnorm=3.518, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20617
2022-05-08 02:09:53 - progress_bar.py[line:272] - INFO: epoch 001:  11116 / 17711 loss=3.27, loss_v1=0, loss_v2=0, nll_loss=1.049, ntokens=383.1, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.27, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=34.788, expert1_balance_bottom=18.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=223.9, ups=0.58, wpb=383.1, bsz=32, num_updates=11100, lr=7.30456e-06, gnorm=3.314, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=20634
2022-05-08 02:10:10 - progress_bar.py[line:272] - INFO: epoch 001:  11126 / 17711 loss=3.224, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=386.9, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.224, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=35.22, expert1_balance_bottom=18.145, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=226, ups=0.58, wpb=386.9, bsz=32, num_updates=11110, lr=7.30156e-06, gnorm=3.507, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20651
2022-05-08 02:10:27 - progress_bar.py[line:272] - INFO: epoch 001:  11136 / 17711 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=1.034, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.254, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=35.12, expert1_balance_bottom=18.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=221, ups=0.58, wpb=380, bsz=32, num_updates=11120, lr=7.29856e-06, gnorm=3.586, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20668
2022-05-08 02:10:44 - progress_bar.py[line:272] - INFO: epoch 001:  11146 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=380.4, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.314, expert1_balance_top=34.775, expert1_balance_bottom=18.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=222.5, ups=0.59, wpb=380.4, bsz=32, num_updates=11130, lr=7.29555e-06, gnorm=2.662, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20685
2022-05-08 02:11:01 - progress_bar.py[line:272] - INFO: epoch 001:  11156 / 17711 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=1.019, ntokens=383.1, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877063, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.231, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=35.736, expert1_balance_bottom=18.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=223.7, ups=0.58, wpb=383.1, bsz=32, num_updates=11140, lr=7.29255e-06, gnorm=3.418, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20702
2022-05-08 02:11:19 - progress_bar.py[line:272] - INFO: epoch 001:  11166 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=383.9, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895263, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=34.337, expert1_balance_bottom=18.578, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220.1, ups=0.57, wpb=383.9, bsz=32, num_updates=11150, lr=7.28955e-06, gnorm=3.687, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20720
2022-05-08 02:11:36 - progress_bar.py[line:272] - INFO: epoch 001:  11176 / 17711 loss=3.258, loss_v1=0, loss_v2=0, nll_loss=1.038, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886111, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.258, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.312, expert1_balance_top=34.976, expert1_balance_bottom=18.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=221.8, ups=0.58, wpb=381.9, bsz=32, num_updates=11160, lr=7.28654e-06, gnorm=3.534, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20737
2022-05-08 02:11:53 - progress_bar.py[line:272] - INFO: epoch 001:  11186 / 17711 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=380.2, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893214, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.227, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=34.41, expert1_balance_bottom=18.55, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=219.7, ups=0.58, wpb=380.2, bsz=32, num_updates=11170, lr=7.28354e-06, gnorm=2.983, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20754
2022-05-08 02:12:11 - progress_bar.py[line:272] - INFO: epoch 001:  11196 / 17711 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.174, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.31, expert1_balance_top=35.247, expert1_balance_bottom=18.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=214, ups=0.57, wpb=378.1, bsz=32, num_updates=11180, lr=7.28054e-06, gnorm=3.509, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20772
2022-05-08 02:12:28 - progress_bar.py[line:272] - INFO: epoch 001:  11206 / 17711 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=388.2, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867478, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.211, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=36.287, expert1_balance_bottom=17.741, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=224, ups=0.58, wpb=388.2, bsz=32, num_updates=11190, lr=7.27753e-06, gnorm=3.362, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20789
2022-05-08 02:12:46 - progress_bar.py[line:272] - INFO: epoch 001:  11216 / 17711 loss=3.245, loss_v1=0, loss_v2=0, nll_loss=1.025, ntokens=383.4, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.245, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.31, expert1_balance_top=35.023, expert1_balance_bottom=18.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=220.5, ups=0.58, wpb=383.4, bsz=32, num_updates=11200, lr=7.27453e-06, gnorm=3.574, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20807
2022-05-08 02:13:03 - progress_bar.py[line:272] - INFO: epoch 001:  11226 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88229, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=34.975, expert1_balance_bottom=18.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=218.1, ups=0.57, wpb=383.8, bsz=32, num_updates=11210, lr=7.27153e-06, gnorm=3.495, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20824
2022-05-08 02:13:21 - progress_bar.py[line:272] - INFO: epoch 001:  11236 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=376.4, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=35.295, expert1_balance_bottom=18.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=214.8, ups=0.57, wpb=376.4, bsz=32, num_updates=11220, lr=7.26852e-06, gnorm=3.141, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20842
2022-05-08 02:13:38 - progress_bar.py[line:272] - INFO: epoch 001:  11246 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.99, ntokens=379.4, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883298, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.31, expert1_balance_top=35.211, expert1_balance_bottom=18.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=218.7, ups=0.58, wpb=379.4, bsz=32, num_updates=11230, lr=7.26552e-06, gnorm=3.464, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20859
2022-05-08 02:13:55 - progress_bar.py[line:272] - INFO: epoch 001:  11256 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=34.763, expert1_balance_bottom=18.539, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=223, ups=0.59, wpb=379.2, bsz=32, num_updates=11240, lr=7.26252e-06, gnorm=3.538, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20876
2022-05-08 02:14:13 - progress_bar.py[line:272] - INFO: epoch 001:  11266 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876004, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=35.745, expert1_balance_bottom=18.26, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220.5, ups=0.57, wpb=384.9, bsz=32, num_updates=11250, lr=7.25951e-06, gnorm=3.105, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=20894
2022-05-08 02:14:30 - progress_bar.py[line:272] - INFO: epoch 001:  11276 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=387.9, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=35.525, expert1_balance_bottom=18.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=226.6, ups=0.58, wpb=387.9, bsz=32, num_updates=11260, lr=7.25651e-06, gnorm=3.435, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20911
2022-05-08 02:14:47 - progress_bar.py[line:272] - INFO: epoch 001:  11286 / 17711 loss=3.262, loss_v1=0, loss_v2=0, nll_loss=1.056, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881116, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.262, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.31, expert1_balance_top=35.289, expert1_balance_bottom=18.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=222, ups=0.58, wpb=384.7, bsz=32, num_updates=11270, lr=7.25351e-06, gnorm=3.316, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20928
2022-05-08 02:15:04 - progress_bar.py[line:272] - INFO: epoch 001:  11296 / 17711 loss=3.288, loss_v1=0, loss_v2=0, nll_loss=1.068, ntokens=381.1, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884585, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.288, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.31, expert1_balance_top=35.053, expert1_balance_bottom=18.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=222.1, ups=0.58, wpb=381.1, bsz=32, num_updates=11280, lr=7.2505e-06, gnorm=4.094, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20945
2022-05-08 02:15:22 - progress_bar.py[line:272] - INFO: epoch 001:  11306 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=35.134, expert1_balance_bottom=18.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221.4, ups=0.57, wpb=385.4, bsz=32, num_updates=11290, lr=7.2475e-06, gnorm=3.255, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20963
2022-05-08 02:15:40 - progress_bar.py[line:272] - INFO: epoch 001:  11316 / 17711 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=382.1, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.247, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=35.07, expert1_balance_bottom=18.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=214.1, ups=0.56, wpb=382.1, bsz=32, num_updates=11300, lr=7.2445e-06, gnorm=3.458, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20980
2022-05-08 02:15:57 - progress_bar.py[line:272] - INFO: epoch 001:  11326 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=384.1, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.31, expert1_balance_top=34.438, expert1_balance_bottom=18.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220.2, ups=0.57, wpb=384.1, bsz=32, num_updates=11310, lr=7.24149e-06, gnorm=3.153, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=20998
2022-05-08 02:16:14 - progress_bar.py[line:272] - INFO: epoch 001:  11336 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=383.9, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885833, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=35.309, expert1_balance_bottom=18.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=220.2, ups=0.57, wpb=383.9, bsz=32, num_updates=11320, lr=7.23849e-06, gnorm=3.504, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21015
2022-05-08 02:16:32 - progress_bar.py[line:272] - INFO: epoch 001:  11346 / 17711 loss=3.284, loss_v1=0, loss_v2=0, nll_loss=1.07, ntokens=379.6, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88143, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.284, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=35.193, expert1_balance_bottom=18.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=211.6, ups=0.56, wpb=379.6, bsz=32, num_updates=11330, lr=7.23549e-06, gnorm=3.663, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21033
2022-05-08 02:16:50 - progress_bar.py[line:272] - INFO: epoch 001:  11356 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.31, expert1_balance_top=35.263, expert1_balance_bottom=18.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=215.5, ups=0.57, wpb=377.2, bsz=32, num_updates=11340, lr=7.23248e-06, gnorm=3.362, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21051
2022-05-08 02:17:07 - progress_bar.py[line:272] - INFO: epoch 001:  11366 / 17711 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.192, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=34.649, expert1_balance_bottom=18.612, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=218.9, ups=0.58, wpb=380.6, bsz=32, num_updates=11350, lr=7.22948e-06, gnorm=3.218, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21068
2022-05-08 02:17:25 - progress_bar.py[line:272] - INFO: epoch 001:  11376 / 17711 loss=3.288, loss_v1=0, loss_v2=0, nll_loss=1.059, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896745, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.288, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=34.409, expert1_balance_bottom=18.623, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=218.4, ups=0.57, wpb=380, bsz=32, num_updates=11360, lr=7.22648e-06, gnorm=3.771, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=21085
2022-05-08 02:17:42 - progress_bar.py[line:272] - INFO: epoch 001:  11386 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.311, expert1_balance_top=34.363, expert1_balance_bottom=18.637, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=217.4, ups=0.57, wpb=381.7, bsz=32, num_updates=11370, lr=7.22347e-06, gnorm=3.165, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21103
2022-05-08 02:18:00 - progress_bar.py[line:272] - INFO: epoch 001:  11396 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=385.4, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=35.601, expert1_balance_bottom=18.171, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=221.7, ups=0.58, wpb=385.4, bsz=32, num_updates=11380, lr=7.22047e-06, gnorm=3.049, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21120
2022-05-08 02:18:17 - progress_bar.py[line:272] - INFO: epoch 001:  11406 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=35.129, expert1_balance_bottom=18.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.3, ups=0.58, wpb=385, bsz=32, num_updates=11390, lr=7.21747e-06, gnorm=3.463, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21138
2022-05-08 02:18:34 - progress_bar.py[line:272] - INFO: epoch 001:  11416 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=387.8, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.309, expert1_balance_top=34.778, expert1_balance_bottom=18.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=221.5, ups=0.57, wpb=387.8, bsz=32, num_updates=11400, lr=7.21446e-06, gnorm=3.748, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21155
2022-05-08 02:18:52 - progress_bar.py[line:272] - INFO: epoch 001:  11426 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.102, ntokens=376.4, nsentences=31.5, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865822, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=36.846, expert1_balance_bottom=17.806, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=218.6, ups=0.58, wpb=376.4, bsz=31.5, num_updates=11410, lr=7.21146e-06, gnorm=3.41, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21172
2022-05-08 02:19:09 - progress_bar.py[line:272] - INFO: epoch 001:  11436 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=383.1, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=34.923, expert1_balance_bottom=18.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=221, ups=0.58, wpb=383.1, bsz=32, num_updates=11420, lr=7.20846e-06, gnorm=3.18, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21190
2022-05-08 02:19:26 - progress_bar.py[line:272] - INFO: epoch 001:  11446 / 17711 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=1.035, ntokens=387.1, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879944, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.246, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=35.852, expert1_balance_bottom=18.194, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=222, ups=0.57, wpb=387.1, bsz=32, num_updates=11430, lr=7.20545e-06, gnorm=3.111, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=21207
2022-05-08 02:19:44 - progress_bar.py[line:272] - INFO: epoch 001:  11456 / 17711 loss=3.266, loss_v1=0, loss_v2=0, nll_loss=1.053, ntokens=381.4, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885144, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.266, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=35.131, expert1_balance_bottom=18.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=219.6, ups=0.58, wpb=381.4, bsz=32, num_updates=11440, lr=7.20245e-06, gnorm=3.121, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=21225
2022-05-08 02:20:01 - progress_bar.py[line:272] - INFO: epoch 001:  11466 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.307, expert1_balance_top=35.701, expert1_balance_bottom=18.017, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.4, ups=0.58, wpb=385.2, bsz=32, num_updates=11450, lr=7.19945e-06, gnorm=3.184, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21242
2022-05-08 02:20:19 - progress_bar.py[line:272] - INFO: epoch 001:  11476 / 17711 loss=3.242, loss_v1=0, loss_v2=0, nll_loss=1.023, ntokens=390.6, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.242, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=35.132, expert1_balance_bottom=18.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=219.2, ups=0.56, wpb=390.6, bsz=32, num_updates=11460, lr=7.19644e-06, gnorm=3.903, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21260
2022-05-08 02:20:36 - progress_bar.py[line:272] - INFO: epoch 001:  11486 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=391.6, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890797, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=34.995, expert1_balance_bottom=18.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=225.2, ups=0.58, wpb=391.6, bsz=32, num_updates=11470, lr=7.19344e-06, gnorm=3.237, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21277
2022-05-08 02:20:54 - progress_bar.py[line:272] - INFO: epoch 001:  11496 / 17711 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=392.8, nsentences=32, sample_size=312.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885341, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.189, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.307, expert1_balance_top=34.611, expert1_balance_bottom=18.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=227.8, ups=0.58, wpb=392.8, bsz=32, num_updates=11480, lr=7.19044e-06, gnorm=3.109, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21294
2022-05-08 02:21:11 - progress_bar.py[line:272] - INFO: epoch 001:  11506 / 17711 loss=3.277, loss_v1=0, loss_v2=0, nll_loss=1.062, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.277, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=34.843, expert1_balance_bottom=18.338, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=221.9, ups=0.57, wpb=386.5, bsz=32, num_updates=11490, lr=7.18743e-06, gnorm=4.302, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=21312
2022-05-08 02:21:28 - progress_bar.py[line:272] - INFO: epoch 001:  11516 / 17711 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=1.07, ntokens=391.9, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.272, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.305, expert1_balance_top=35.866, expert1_balance_bottom=18.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=228.1, ups=0.58, wpb=391.9, bsz=32, num_updates=11500, lr=7.18443e-06, gnorm=3.598, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=21329
2022-05-08 02:21:46 - progress_bar.py[line:272] - INFO: epoch 001:  11526 / 17711 loss=3.258, loss_v1=0, loss_v2=0, nll_loss=1.033, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891749, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.258, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=34.594, expert1_balance_bottom=18.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=218.9, ups=0.57, wpb=382.5, bsz=32, num_updates=11510, lr=7.18143e-06, gnorm=3.464, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=21346
2022-05-08 02:22:03 - progress_bar.py[line:272] - INFO: epoch 001:  11536 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876071, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.306, expert1_balance_top=36.039, expert1_balance_bottom=18.056, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=217.9, ups=0.57, wpb=383.2, bsz=32, num_updates=11520, lr=7.17842e-06, gnorm=3.519, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21364
2022-05-08 02:22:21 - progress_bar.py[line:272] - INFO: epoch 001:  11546 / 17711 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=1.036, ntokens=382.7, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875943, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.246, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.307, expert1_balance_top=35.957, expert1_balance_bottom=18.147, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=220.3, ups=0.58, wpb=382.7, bsz=32, num_updates=11530, lr=7.17542e-06, gnorm=3, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21381
2022-05-08 02:22:38 - progress_bar.py[line:272] - INFO: epoch 001:  11556 / 17711 loss=3.236, loss_v1=0, loss_v2=0, nll_loss=1.018, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885837, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.236, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=35.134, expert1_balance_bottom=18.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=219, ups=0.58, wpb=378.4, bsz=32, num_updates=11540, lr=7.17242e-06, gnorm=3.616, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21399
2022-05-08 02:22:55 - progress_bar.py[line:272] - INFO: epoch 001:  11566 / 17711 loss=3.217, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=388.1, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881449, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.217, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.307, expert1_balance_top=35.547, expert1_balance_bottom=18.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=226.8, ups=0.58, wpb=388.1, bsz=32, num_updates=11550, lr=7.16941e-06, gnorm=3.55, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21416
2022-05-08 02:23:00 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 02:23:14 - progress_bar.py[line:272] - INFO: epoch 001:  11577 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=378.1, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887115, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.307, expert1_balance_top=34.724, expert1_balance_bottom=18.649, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=197.4, ups=0.52, wpb=378.1, bsz=32, num_updates=11560, lr=7.16641e-06, gnorm=2.987, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21435
2022-05-08 02:23:32 - progress_bar.py[line:272] - INFO: epoch 001:  11587 / 17711 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=1.04, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.254, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.307, expert1_balance_top=35.559, expert1_balance_bottom=18.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=220.9, ups=0.57, wpb=384.3, bsz=32, num_updates=11570, lr=7.16341e-06, gnorm=3.954, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21452
2022-05-08 02:23:49 - progress_bar.py[line:272] - INFO: epoch 001:  11597 / 17711 loss=3.262, loss_v1=0, loss_v2=0, nll_loss=1.04, ntokens=375.9, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.262, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=35.291, expert1_balance_bottom=18.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=217.1, ups=0.58, wpb=375.9, bsz=32, num_updates=11580, lr=7.1604e-06, gnorm=3.761, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21470
2022-05-08 02:24:06 - progress_bar.py[line:272] - INFO: epoch 001:  11607 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=385.4, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.307, expert1_balance_top=35.357, expert1_balance_bottom=18.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.6, ups=0.58, wpb=385.4, bsz=32, num_updates=11590, lr=7.1574e-06, gnorm=3.06, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21487
2022-05-08 02:24:24 - progress_bar.py[line:272] - INFO: epoch 001:  11617 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=376.3, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=34.756, expert1_balance_bottom=18.528, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=215.7, ups=0.57, wpb=376.3, bsz=32, num_updates=11600, lr=7.1544e-06, gnorm=3.318, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21504
2022-05-08 02:24:41 - progress_bar.py[line:272] - INFO: epoch 001:  11627 / 17711 loss=3.332, loss_v1=0, loss_v2=0, nll_loss=1.109, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890234, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.332, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.308, expert1_balance_top=34.732, expert1_balance_bottom=18.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=221.4, ups=0.58, wpb=383.6, bsz=32, num_updates=11610, lr=7.1514e-06, gnorm=4.113, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21522
2022-05-08 02:24:58 - progress_bar.py[line:272] - INFO: epoch 001:  11637 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.306, expert1_balance_top=35.354, expert1_balance_bottom=18.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.6, ups=0.57, wpb=384.1, bsz=32, num_updates=11620, lr=7.14839e-06, gnorm=3.481, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21539
2022-05-08 02:25:16 - progress_bar.py[line:272] - INFO: epoch 001:  11647 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.305, expert1_balance_top=35.212, expert1_balance_bottom=18.213, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=221.2, ups=0.57, wpb=386.3, bsz=32, num_updates=11630, lr=7.14539e-06, gnorm=3.417, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21557
2022-05-08 02:25:33 - progress_bar.py[line:272] - INFO: epoch 001:  11657 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883314, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.306, expert1_balance_top=35.253, expert1_balance_bottom=18.253, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=224, ups=0.59, wpb=380.1, bsz=32, num_updates=11640, lr=7.14239e-06, gnorm=3.361, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21574
2022-05-08 02:25:50 - progress_bar.py[line:272] - INFO: epoch 001:  11667 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887978, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.306, expert1_balance_top=34.888, expert1_balance_bottom=18.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=221, ups=0.58, wpb=378.2, bsz=32, num_updates=11650, lr=7.13938e-06, gnorm=3.511, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21591
2022-05-08 02:26:04 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 02:26:09 - progress_bar.py[line:272] - INFO: epoch 001:  11678 / 17711 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=373.8, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.234, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.306, expert1_balance_top=34.382, expert1_balance_bottom=18.616, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=196.7, ups=0.53, wpb=373.8, bsz=32, num_updates=11660, lr=7.13638e-06, gnorm=3.317, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21610
2022-05-08 02:26:26 - progress_bar.py[line:272] - INFO: epoch 001:  11688 / 17711 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.219, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.307, expert1_balance_top=34.053, expert1_balance_bottom=18.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=219.9, ups=0.58, wpb=381.1, bsz=32, num_updates=11670, lr=7.13338e-06, gnorm=3.601, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21627
2022-05-08 02:26:43 - progress_bar.py[line:272] - INFO: epoch 001:  11698 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=384.8, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891568, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.306, expert1_balance_top=34.471, expert1_balance_bottom=18.717, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=224.9, ups=0.58, wpb=384.8, bsz=32, num_updates=11680, lr=7.13037e-06, gnorm=3.527, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21644
2022-05-08 02:27:01 - progress_bar.py[line:272] - INFO: epoch 001:  11708 / 17711 loss=3.309, loss_v1=0, loss_v2=0, nll_loss=1.091, ntokens=374.5, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893275, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.309, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.306, expert1_balance_top=34.326, expert1_balance_bottom=18.641, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=215.8, ups=0.58, wpb=374.5, bsz=32, num_updates=11690, lr=7.12737e-06, gnorm=3.304, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21661
2022-05-08 02:27:18 - progress_bar.py[line:272] - INFO: epoch 001:  11718 / 17711 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=1.022, ntokens=381.7, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.238, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.305, expert1_balance_top=34.959, expert1_balance_bottom=18.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=221.7, ups=0.58, wpb=381.7, bsz=32, num_updates=11700, lr=7.12437e-06, gnorm=3.338, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21679
2022-05-08 02:27:35 - progress_bar.py[line:272] - INFO: epoch 001:  11728 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=381.1, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.304, expert1_balance_top=35.26, expert1_balance_bottom=18.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=218.8, ups=0.57, wpb=381.1, bsz=32, num_updates=11710, lr=7.12136e-06, gnorm=3.066, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21696
2022-05-08 02:27:53 - progress_bar.py[line:272] - INFO: epoch 001:  11738 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.966, ntokens=387.7, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=34.921, expert1_balance_bottom=18.343, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=225.3, ups=0.58, wpb=387.7, bsz=32, num_updates=11720, lr=7.11836e-06, gnorm=3.356, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21713
2022-05-08 02:28:10 - progress_bar.py[line:272] - INFO: epoch 001:  11748 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=382.9, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876535, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=35.658, expert1_balance_bottom=18.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=221.4, ups=0.58, wpb=382.9, bsz=32, num_updates=11730, lr=7.11536e-06, gnorm=3.4, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=21731
2022-05-08 02:28:27 - progress_bar.py[line:272] - INFO: epoch 001:  11758 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.305, expert1_balance_top=35.067, expert1_balance_bottom=18.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=218.2, ups=0.57, wpb=380, bsz=32, num_updates=11740, lr=7.11235e-06, gnorm=3.443, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21748
2022-05-08 02:28:45 - progress_bar.py[line:272] - INFO: epoch 001:  11768 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=371.9, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.305, expert1_balance_top=34.56, expert1_balance_bottom=18.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=213.8, ups=0.57, wpb=371.9, bsz=32, num_updates=11750, lr=7.10935e-06, gnorm=3.403, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21765
2022-05-08 02:29:02 - progress_bar.py[line:272] - INFO: epoch 001:  11778 / 17711 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.998, ntokens=389.5, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.214, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.304, expert1_balance_top=35.097, expert1_balance_bottom=18.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=225.2, ups=0.58, wpb=389.5, bsz=32, num_updates=11760, lr=7.10635e-06, gnorm=3.477, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21783
2022-05-08 02:29:19 - progress_bar.py[line:272] - INFO: epoch 001:  11788 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=377.2, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891151, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.305, expert1_balance_top=34.644, expert1_balance_bottom=18.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=215.7, ups=0.57, wpb=377.2, bsz=32, num_updates=11770, lr=7.10334e-06, gnorm=3.154, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21800
2022-05-08 02:29:37 - progress_bar.py[line:272] - INFO: epoch 001:  11798 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=380, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.304, expert1_balance_top=35.596, expert1_balance_bottom=18.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=216.2, ups=0.57, wpb=380, bsz=32, num_updates=11780, lr=7.10034e-06, gnorm=3.781, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21818
2022-05-08 02:29:54 - progress_bar.py[line:272] - INFO: epoch 001:  11808 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=35.158, expert1_balance_bottom=18.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=222.8, ups=0.58, wpb=386.3, bsz=32, num_updates=11790, lr=7.09734e-06, gnorm=3.298, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21835
2022-05-08 02:30:12 - progress_bar.py[line:272] - INFO: epoch 001:  11818 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=373.2, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894625, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.305, expert1_balance_top=34.506, expert1_balance_bottom=18.591, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=212.2, ups=0.57, wpb=373.2, bsz=32, num_updates=11800, lr=7.09433e-06, gnorm=3.32, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21853
2022-05-08 02:30:29 - progress_bar.py[line:272] - INFO: epoch 001:  11828 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=1.011, ntokens=392, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.745, expert1_balance_bottom=18.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=225.3, ups=0.57, wpb=392, bsz=32, num_updates=11810, lr=7.09133e-06, gnorm=3.471, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21870
2022-05-08 02:30:47 - progress_bar.py[line:272] - INFO: epoch 001:  11838 / 17711 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885569, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.304, expert1_balance_top=35.015, expert1_balance_bottom=18.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=219.2, ups=0.57, wpb=385.3, bsz=32, num_updates=11820, lr=7.08833e-06, gnorm=3.965, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21888
2022-05-08 02:31:04 - progress_bar.py[line:272] - INFO: epoch 001:  11848 / 17711 loss=3.312, loss_v1=0, loss_v2=0, nll_loss=1.11, ntokens=388, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.312, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.302, expert1_balance_top=35.477, expert1_balance_bottom=18.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.16, wps=221.1, ups=0.57, wpb=388, bsz=32, num_updates=11830, lr=7.08532e-06, gnorm=3.643, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21905
2022-05-08 02:31:22 - progress_bar.py[line:272] - INFO: epoch 001:  11858 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=378.2, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87217, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=36.284, expert1_balance_bottom=18.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=217.4, ups=0.57, wpb=378.2, bsz=32, num_updates=11840, lr=7.08232e-06, gnorm=3.246, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=21923
2022-05-08 02:31:39 - progress_bar.py[line:272] - INFO: epoch 001:  11868 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.074, ntokens=381.5, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886381, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=34.86, expert1_balance_bottom=18.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=221.3, ups=0.58, wpb=381.5, bsz=32, num_updates=11850, lr=7.07932e-06, gnorm=4.082, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21940
2022-05-08 02:31:56 - progress_bar.py[line:272] - INFO: epoch 001:  11878 / 17711 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=383.4, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.163, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.302, expert1_balance_top=34.939, expert1_balance_bottom=18.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=223.7, ups=0.58, wpb=383.4, bsz=32, num_updates=11860, lr=7.07631e-06, gnorm=3.348, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21957
2022-05-08 02:32:14 - progress_bar.py[line:272] - INFO: epoch 001:  11888 / 17711 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=389.6, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892768, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.185, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=34.157, expert1_balance_bottom=18.853, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222.7, ups=0.57, wpb=389.6, bsz=32, num_updates=11870, lr=7.07331e-06, gnorm=3.537, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21974
2022-05-08 02:32:31 - progress_bar.py[line:272] - INFO: epoch 001:  11898 / 17711 loss=3.276, loss_v1=0, loss_v2=0, nll_loss=1.07, ntokens=387.8, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873535, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.276, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.559, expert1_balance_bottom=18.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=218.7, ups=0.56, wpb=387.8, bsz=32, num_updates=11880, lr=7.07031e-06, gnorm=3.638, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=21992
2022-05-08 02:32:49 - progress_bar.py[line:272] - INFO: epoch 001:  11908 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.974, ntokens=379.9, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.433, expert1_balance_bottom=18.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=218.6, ups=0.58, wpb=379.9, bsz=32, num_updates=11890, lr=7.0673e-06, gnorm=3.654, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22010
2022-05-08 02:33:07 - progress_bar.py[line:272] - INFO: epoch 001:  11918 / 17711 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=0.993, ntokens=381.2, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898534, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.23, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=34.068, expert1_balance_bottom=18.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=213.9, ups=0.56, wpb=381.2, bsz=32, num_updates=11900, lr=7.0643e-06, gnorm=3.417, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22027
2022-05-08 02:33:24 - progress_bar.py[line:272] - INFO: epoch 001:  11928 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=378.2, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.448, expert1_balance_bottom=18.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=217.4, ups=0.57, wpb=378.2, bsz=32, num_updates=11910, lr=7.0613e-06, gnorm=3.095, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22045
2022-05-08 02:33:41 - progress_bar.py[line:272] - INFO: epoch 001:  11938 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=1.018, ntokens=384.9, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872724, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.302, expert1_balance_top=36.265, expert1_balance_bottom=18.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=220.8, ups=0.57, wpb=384.9, bsz=32, num_updates=11920, lr=7.05829e-06, gnorm=3.083, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22062
2022-05-08 02:33:59 - progress_bar.py[line:272] - INFO: epoch 001:  11948 / 17711 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=1.019, ntokens=388.5, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879524, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.231, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.302, expert1_balance_top=35.783, expert1_balance_bottom=18.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=224.8, ups=0.58, wpb=388.5, bsz=32, num_updates=11930, lr=7.05529e-06, gnorm=3.264, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22080
2022-05-08 02:34:16 - progress_bar.py[line:272] - INFO: epoch 001:  11958 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=377.6, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883514, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=35.516, expert1_balance_bottom=18.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=221.9, ups=0.59, wpb=377.6, bsz=32, num_updates=11940, lr=7.05229e-06, gnorm=3.358, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22097
2022-05-08 02:34:33 - progress_bar.py[line:272] - INFO: epoch 001:  11968 / 17711 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=1.026, ntokens=380.2, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.239, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.302, expert1_balance_top=35.506, expert1_balance_bottom=18.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=219.9, ups=0.58, wpb=380.2, bsz=32, num_updates=11950, lr=7.04928e-06, gnorm=3.354, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22114
2022-05-08 02:34:51 - progress_bar.py[line:272] - INFO: epoch 001:  11978 / 17711 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.196, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.304, expert1_balance_top=35.112, expert1_balance_bottom=18.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=211.8, ups=0.56, wpb=375.5, bsz=32, num_updates=11960, lr=7.04628e-06, gnorm=3.102, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22132
2022-05-08 02:35:08 - progress_bar.py[line:272] - INFO: epoch 001:  11988 / 17711 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=384.5, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.171, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.304, expert1_balance_top=34.791, expert1_balance_bottom=18.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=221.1, ups=0.58, wpb=384.5, bsz=32, num_updates=11970, lr=7.04328e-06, gnorm=2.686, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22149
2022-05-08 02:35:26 - progress_bar.py[line:272] - INFO: epoch 001:  11998 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893029, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=34.253, expert1_balance_bottom=18.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=219.4, ups=0.58, wpb=380.5, bsz=32, num_updates=11980, lr=7.04027e-06, gnorm=3.257, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22166
2022-05-08 02:35:43 - progress_bar.py[line:272] - INFO: epoch 001:  12008 / 17711 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=1.075, ntokens=387.4, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886115, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.293, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.302, expert1_balance_top=34.668, expert1_balance_bottom=18.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=227.2, ups=0.59, wpb=387.4, bsz=32, num_updates=11990, lr=7.03727e-06, gnorm=4.134, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22183
2022-05-08 02:36:00 - progress_bar.py[line:272] - INFO: epoch 001:  12018 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=34.866, expert1_balance_bottom=18.566, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=225.5, ups=0.58, wpb=385.9, bsz=32, num_updates=12000, lr=7.03427e-06, gnorm=3.464, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22200
2022-05-08 02:36:17 - progress_bar.py[line:272] - INFO: epoch 001:  12028 / 17711 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.167, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.302, expert1_balance_top=34.85, expert1_balance_bottom=18.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=216.5, ups=0.57, wpb=378.8, bsz=32, num_updates=12010, lr=7.03126e-06, gnorm=3.456, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22218
2022-05-08 02:36:34 - progress_bar.py[line:272] - INFO: epoch 001:  12038 / 17711 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=374.8, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.235, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=34.962, expert1_balance_bottom=18.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=216.9, ups=0.58, wpb=374.8, bsz=32, num_updates=12020, lr=7.02826e-06, gnorm=4.344, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22235
2022-05-08 02:36:52 - progress_bar.py[line:272] - INFO: epoch 001:  12048 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=374.9, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.303, expert1_balance_top=34.607, expert1_balance_bottom=18.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=216.9, ups=0.58, wpb=374.9, bsz=32, num_updates=12030, lr=7.02526e-06, gnorm=3.236, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=22253
2022-05-08 02:37:09 - progress_bar.py[line:272] - INFO: epoch 001:  12058 / 17711 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.974, ntokens=379.1, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.206, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.304, expert1_balance_top=34.635, expert1_balance_bottom=18.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=216.5, ups=0.57, wpb=379.1, bsz=32, num_updates=12040, lr=7.02225e-06, gnorm=3.074, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22270
2022-05-08 02:37:27 - progress_bar.py[line:272] - INFO: epoch 001:  12068 / 17711 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=1.042, ntokens=389, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.246, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.871, expert1_balance_bottom=18.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=219.9, ups=0.57, wpb=389, bsz=32, num_updates=12050, lr=7.01925e-06, gnorm=3.272, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22288
2022-05-08 02:37:44 - progress_bar.py[line:272] - INFO: epoch 001:  12078 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883491, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.161, expert1_balance_bottom=18.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=217.6, ups=0.57, wpb=378.6, bsz=32, num_updates=12060, lr=7.01625e-06, gnorm=3.6, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22305
2022-05-08 02:38:02 - progress_bar.py[line:272] - INFO: epoch 001:  12088 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=1.035, ntokens=388.6, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875637, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.3, expert1_balance_top=35.801, expert1_balance_bottom=18.476, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=226.2, ups=0.58, wpb=388.6, bsz=32, num_updates=12070, lr=7.01324e-06, gnorm=3.019, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22322
2022-05-08 02:38:19 - progress_bar.py[line:272] - INFO: epoch 001:  12098 / 17711 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=1.016, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899795, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.243, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.304, expert1_balance_top=34.259, expert1_balance_bottom=18.738, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=215.2, ups=0.57, wpb=378.4, bsz=32, num_updates=12080, lr=7.01024e-06, gnorm=2.994, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22340
2022-05-08 02:38:37 - progress_bar.py[line:272] - INFO: epoch 001:  12108 / 17711 loss=3.261, loss_v1=0, loss_v2=0, nll_loss=1.044, ntokens=387.8, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.261, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.581, expert1_balance_bottom=18.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=222.2, ups=0.57, wpb=387.8, bsz=32, num_updates=12090, lr=7.00724e-06, gnorm=3.214, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22357
2022-05-08 02:38:54 - progress_bar.py[line:272] - INFO: epoch 001:  12118 / 17711 loss=3.34, loss_v1=0, loss_v2=0, nll_loss=1.132, ntokens=381.2, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889588, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.34, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.302, expert1_balance_top=34.853, expert1_balance_bottom=18.548, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=217.2, ups=0.57, wpb=381.2, bsz=32, num_updates=12100, lr=7.00423e-06, gnorm=3.203, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22375
2022-05-08 02:39:12 - progress_bar.py[line:272] - INFO: epoch 001:  12128 / 17711 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=1.017, ntokens=378.5, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883379, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.23, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.4, expert1_balance_bottom=18.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=215.2, ups=0.57, wpb=378.5, bsz=32, num_updates=12110, lr=7.00123e-06, gnorm=3.376, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22392
2022-05-08 02:39:29 - progress_bar.py[line:272] - INFO: epoch 001:  12138 / 17711 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=1.045, ntokens=377.4, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.282, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.302, expert1_balance_top=34.591, expert1_balance_bottom=18.227, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=216.6, ups=0.57, wpb=377.4, bsz=32, num_updates=12120, lr=6.99823e-06, gnorm=3.468, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22410
2022-05-08 02:39:47 - progress_bar.py[line:272] - INFO: epoch 001:  12148 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=390.3, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.3, expert1_balance_top=35.061, expert1_balance_bottom=18.612, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=216.8, ups=0.56, wpb=390.3, bsz=32, num_updates=12130, lr=6.99522e-06, gnorm=2.837, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=22428
2022-05-08 02:40:04 - progress_bar.py[line:272] - INFO: epoch 001:  12158 / 17711 loss=3.299, loss_v1=0, loss_v2=0, nll_loss=1.095, ntokens=392.4, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879629, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.299, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.823, expert1_balance_bottom=18.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=228.3, ups=0.58, wpb=392.4, bsz=32, num_updates=12140, lr=6.99222e-06, gnorm=3.408, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22445
2022-05-08 02:40:21 - progress_bar.py[line:272] - INFO: epoch 001:  12168 / 17711 loss=3.289, loss_v1=0, loss_v2=0, nll_loss=1.081, ntokens=379.7, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.289, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=35.314, expert1_balance_bottom=18.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=221.2, ups=0.58, wpb=379.7, bsz=32, num_updates=12150, lr=6.98922e-06, gnorm=3.537, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=22462
2022-05-08 02:40:39 - progress_bar.py[line:272] - INFO: epoch 001:  12178 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=377.3, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.298, expert1_balance_top=35.218, expert1_balance_bottom=18.472, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=218.1, ups=0.58, wpb=377.3, bsz=32, num_updates=12160, lr=6.98621e-06, gnorm=3.284, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=22480
2022-05-08 02:40:56 - progress_bar.py[line:272] - INFO: epoch 001:  12188 / 17711 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=1.024, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888622, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.247, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.299, expert1_balance_top=34.641, expert1_balance_bottom=18.736, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=227.5, ups=0.59, wpb=383.9, bsz=32, num_updates=12170, lr=6.98321e-06, gnorm=3.523, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22496
2022-05-08 02:41:13 - progress_bar.py[line:272] - INFO: epoch 001:  12198 / 17711 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=377.9, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887311, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.205, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=34.929, expert1_balance_bottom=18.295, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.2, ups=0.58, wpb=377.9, bsz=32, num_updates=12180, lr=6.98021e-06, gnorm=3.691, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22514
2022-05-08 02:41:30 - progress_bar.py[line:272] - INFO: epoch 001:  12208 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=383.1, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.3, expert1_balance_top=34.297, expert1_balance_bottom=18.785, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.7, ups=0.57, wpb=383.1, bsz=32, num_updates=12190, lr=6.97721e-06, gnorm=3.194, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22531
2022-05-08 02:41:48 - progress_bar.py[line:272] - INFO: epoch 001:  12218 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891553, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.301, expert1_balance_top=34.541, expert1_balance_bottom=18.699, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=219.7, ups=0.57, wpb=384.5, bsz=32, num_updates=12200, lr=6.9742e-06, gnorm=3.344, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22549
2022-05-08 02:42:05 - progress_bar.py[line:272] - INFO: epoch 001:  12228 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=377.2, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894566, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.3, expert1_balance_top=34.288, expert1_balance_bottom=18.682, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=214.6, ups=0.57, wpb=377.2, bsz=32, num_updates=12210, lr=6.9712e-06, gnorm=3.231, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22566
2022-05-08 02:42:23 - progress_bar.py[line:272] - INFO: epoch 001:  12238 / 17711 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=388.8, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89013, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.209, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.3, expert1_balance_top=34.551, expert1_balance_bottom=18.461, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=226.3, ups=0.58, wpb=388.8, bsz=32, num_updates=12220, lr=6.9682e-06, gnorm=3.644, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22583
2022-05-08 02:42:40 - progress_bar.py[line:272] - INFO: epoch 001:  12248 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.038, ntokens=388.5, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=35.385, expert1_balance_bottom=18.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=224.2, ups=0.58, wpb=388.5, bsz=32, num_updates=12230, lr=6.96519e-06, gnorm=3.202, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22601
2022-05-08 02:42:58 - progress_bar.py[line:272] - INFO: epoch 001:  12258 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.992, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883174, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.298, expert1_balance_top=35.151, expert1_balance_bottom=18.434, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=214.8, ups=0.56, wpb=382.1, bsz=32, num_updates=12240, lr=6.96219e-06, gnorm=3.133, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22619
2022-05-08 02:43:15 - progress_bar.py[line:272] - INFO: epoch 001:  12268 / 17711 loss=3.26, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.26, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.3, expert1_balance_top=34.392, expert1_balance_bottom=18.748, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=220.6, ups=0.58, wpb=377.4, bsz=32, num_updates=12250, lr=6.95919e-06, gnorm=3.293, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22636
2022-05-08 02:43:32 - progress_bar.py[line:272] - INFO: epoch 001:  12278 / 17711 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.219, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.298, expert1_balance_top=35.258, expert1_balance_bottom=18.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=221.7, ups=0.58, wpb=383.7, bsz=32, num_updates=12260, lr=6.95618e-06, gnorm=3.208, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22653
2022-05-08 02:43:49 - progress_bar.py[line:272] - INFO: epoch 001:  12288 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=380.2, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888785, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.3, expert1_balance_top=34.513, expert1_balance_bottom=18.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221, ups=0.58, wpb=380.2, bsz=32, num_updates=12270, lr=6.95318e-06, gnorm=3.669, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22670
2022-05-08 02:44:06 - progress_bar.py[line:272] - INFO: epoch 001:  12298 / 17711 loss=3.27, loss_v1=0, loss_v2=0, nll_loss=1.065, ntokens=390.9, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87177, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.27, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.296, expert1_balance_top=35.294, expert1_balance_bottom=18.42, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=227.9, ups=0.58, wpb=390.9, bsz=32, num_updates=12280, lr=6.95018e-06, gnorm=3.443, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22687
2022-05-08 02:44:24 - progress_bar.py[line:272] - INFO: epoch 001:  12308 / 17711 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=1.038, ntokens=391.6, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874399, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.238, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=35.511, expert1_balance_bottom=18.197, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=226.4, ups=0.58, wpb=391.6, bsz=32, num_updates=12290, lr=6.94717e-06, gnorm=3.781, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22705
2022-05-08 02:44:41 - progress_bar.py[line:272] - INFO: epoch 001:  12318 / 17711 loss=3.271, loss_v1=0, loss_v2=0, nll_loss=1.059, ntokens=386.6, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880507, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.271, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.296, expert1_balance_top=34.851, expert1_balance_bottom=18.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=221.9, ups=0.57, wpb=386.6, bsz=32, num_updates=12300, lr=6.94417e-06, gnorm=3.124, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22722
2022-05-08 02:44:58 - progress_bar.py[line:272] - INFO: epoch 001:  12328 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=384.2, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=34.938, expert1_balance_bottom=18.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=225.1, ups=0.59, wpb=384.2, bsz=32, num_updates=12310, lr=6.94117e-06, gnorm=3.132, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22739
2022-05-08 02:45:15 - progress_bar.py[line:272] - INFO: epoch 001:  12338 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=375.7, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880182, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=35.502, expert1_balance_bottom=18.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=221.3, ups=0.59, wpb=375.7, bsz=32, num_updates=12320, lr=6.93816e-06, gnorm=3.496, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22756
2022-05-08 02:45:33 - progress_bar.py[line:272] - INFO: epoch 001:  12348 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=378.6, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.299, expert1_balance_top=34.572, expert1_balance_bottom=18.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=216.3, ups=0.57, wpb=378.6, bsz=32, num_updates=12330, lr=6.93516e-06, gnorm=3.45, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22774
2022-05-08 02:45:50 - progress_bar.py[line:272] - INFO: epoch 001:  12358 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=381.9, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887502, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=35.129, expert1_balance_bottom=18.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=218.4, ups=0.57, wpb=381.9, bsz=32, num_updates=12340, lr=6.93216e-06, gnorm=2.872, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22791
2022-05-08 02:46:08 - progress_bar.py[line:272] - INFO: epoch 001:  12368 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.298, expert1_balance_top=35.079, expert1_balance_bottom=18.474, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.2, ups=0.57, wpb=380, bsz=32, num_updates=12350, lr=6.92915e-06, gnorm=3.261, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22809
2022-05-08 02:46:25 - progress_bar.py[line:272] - INFO: epoch 001:  12378 / 17711 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=377.3, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.219, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=35.964, expert1_balance_bottom=18.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=216.5, ups=0.57, wpb=377.3, bsz=32, num_updates=12360, lr=6.92615e-06, gnorm=3.197, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=22826
2022-05-08 02:46:43 - progress_bar.py[line:272] - INFO: epoch 001:  12388 / 17711 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=389.6, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888817, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.18, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.298, expert1_balance_top=35.064, expert1_balance_bottom=18.338, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=226.1, ups=0.58, wpb=389.6, bsz=32, num_updates=12370, lr=6.92315e-06, gnorm=3.192, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22843
2022-05-08 02:47:00 - progress_bar.py[line:272] - INFO: epoch 001:  12398 / 17711 loss=3.251, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891134, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.251, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.298, expert1_balance_top=34.772, expert1_balance_bottom=18.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=219.6, ups=0.57, wpb=386.3, bsz=32, num_updates=12380, lr=6.92014e-06, gnorm=3.023, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22861
2022-05-08 02:47:18 - progress_bar.py[line:272] - INFO: epoch 001:  12408 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=1.027, ntokens=385.1, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868806, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=36.351, expert1_balance_bottom=18.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=220.4, ups=0.57, wpb=385.1, bsz=32, num_updates=12390, lr=6.91714e-06, gnorm=3.184, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22878
2022-05-08 02:47:35 - progress_bar.py[line:272] - INFO: epoch 001:  12418 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=382.8, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888501, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.298, expert1_balance_top=35.225, expert1_balance_bottom=18.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=220.4, ups=0.58, wpb=382.8, bsz=32, num_updates=12400, lr=6.91414e-06, gnorm=3.065, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22896
2022-05-08 02:47:52 - progress_bar.py[line:272] - INFO: epoch 001:  12428 / 17711 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=1.039, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886238, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.253, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.299, expert1_balance_top=34.675, expert1_balance_bottom=18.766, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=218.7, ups=0.58, wpb=377.5, bsz=32, num_updates=12410, lr=6.91113e-06, gnorm=2.967, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22913
2022-05-08 02:48:10 - progress_bar.py[line:272] - INFO: epoch 001:  12438 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.998, ntokens=377.6, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.299, expert1_balance_top=34.187, expert1_balance_bottom=18.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=216.6, ups=0.57, wpb=377.6, bsz=32, num_updates=12420, lr=6.90813e-06, gnorm=3.309, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22930
2022-05-08 02:48:27 - progress_bar.py[line:272] - INFO: epoch 001:  12448 / 17711 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=376.3, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895525, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.179, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.299, expert1_balance_top=33.887, expert1_balance_bottom=18.657, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=217.2, ups=0.58, wpb=376.3, bsz=32, num_updates=12430, lr=6.90513e-06, gnorm=3.034, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22948
2022-05-08 02:48:45 - progress_bar.py[line:272] - INFO: epoch 001:  12458 / 17711 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=389.3, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887828, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.205, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.299, expert1_balance_top=34.777, expert1_balance_bottom=18.57, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=218.6, ups=0.56, wpb=389.3, bsz=32, num_updates=12440, lr=6.90212e-06, gnorm=3.116, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22966
2022-05-08 02:49:02 - progress_bar.py[line:272] - INFO: epoch 001:  12468 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.989, ntokens=385.8, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892114, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.299, expert1_balance_top=34.586, expert1_balance_bottom=18.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=225.2, ups=0.58, wpb=385.8, bsz=32, num_updates=12450, lr=6.89912e-06, gnorm=3.092, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=22983
2022-05-08 02:49:19 - progress_bar.py[line:272] - INFO: epoch 001:  12478 / 17711 loss=3.263, loss_v1=0, loss_v2=0, nll_loss=1.042, ntokens=379.1, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889153, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.263, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=34.739, expert1_balance_bottom=18.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=220, ups=0.58, wpb=379.1, bsz=32, num_updates=12460, lr=6.89612e-06, gnorm=3.672, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23000
2022-05-08 02:49:36 - progress_bar.py[line:272] - INFO: epoch 001:  12488 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888475, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=34.564, expert1_balance_bottom=18.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=225.5, ups=0.58, wpb=386.1, bsz=32, num_updates=12470, lr=6.89311e-06, gnorm=3.273, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23017
2022-05-08 02:49:54 - progress_bar.py[line:272] - INFO: epoch 001:  12498 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=375.9, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=34.465, expert1_balance_bottom=18.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=218.2, ups=0.58, wpb=375.9, bsz=32, num_updates=12480, lr=6.89011e-06, gnorm=3.569, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23034
2022-05-08 02:50:11 - progress_bar.py[line:272] - INFO: epoch 001:  12508 / 17711 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=379.1, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878729, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.256, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.296, expert1_balance_top=35.212, expert1_balance_bottom=18.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=219.2, ups=0.58, wpb=379.1, bsz=32, num_updates=12490, lr=6.88711e-06, gnorm=3.252, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23052
2022-05-08 02:50:28 - progress_bar.py[line:272] - INFO: epoch 001:  12518 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.296, expert1_balance_top=34.568, expert1_balance_bottom=18.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=216.7, ups=0.57, wpb=378.2, bsz=32, num_updates=12500, lr=6.8841e-06, gnorm=3.524, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=23069
2022-05-08 02:50:46 - progress_bar.py[line:272] - INFO: epoch 001:  12528 / 17711 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.231, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=34.313, expert1_balance_bottom=18.598, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=217.3, ups=0.56, wpb=384.7, bsz=32, num_updates=12510, lr=6.8811e-06, gnorm=3.641, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23087
2022-05-08 02:51:03 - progress_bar.py[line:272] - INFO: epoch 001:  12538 / 17711 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.998, ntokens=391.4, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.214, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=34.991, expert1_balance_bottom=18.291, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=224.5, ups=0.57, wpb=391.4, bsz=32, num_updates=12520, lr=6.8781e-06, gnorm=3.626, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23104
2022-05-08 02:51:21 - progress_bar.py[line:272] - INFO: epoch 001:  12548 / 17711 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=389.7, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.209, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=35.107, expert1_balance_bottom=18.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=221, ups=0.57, wpb=389.7, bsz=32, num_updates=12530, lr=6.87509e-06, gnorm=3.493, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23122
2022-05-08 02:51:39 - progress_bar.py[line:272] - INFO: epoch 001:  12558 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=1, ntokens=392.4, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=35.433, expert1_balance_bottom=18.308, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=224.5, ups=0.57, wpb=392.4, bsz=32, num_updates=12540, lr=6.87209e-06, gnorm=3.033, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23139
2022-05-08 02:51:56 - progress_bar.py[line:272] - INFO: epoch 001:  12568 / 17711 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=381.1, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.199, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=34.727, expert1_balance_bottom=18.72, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=218.9, ups=0.57, wpb=381.1, bsz=32, num_updates=12550, lr=6.86909e-06, gnorm=3.438, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23157
2022-05-08 02:52:13 - progress_bar.py[line:272] - INFO: epoch 001:  12578 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=390.5, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.296, expert1_balance_top=35.752, expert1_balance_bottom=18.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=223.1, ups=0.57, wpb=390.5, bsz=32, num_updates=12560, lr=6.86608e-06, gnorm=3.022, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23174
2022-05-08 02:52:31 - progress_bar.py[line:272] - INFO: epoch 001:  12588 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=375.6, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=35.042, expert1_balance_bottom=18.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=216.3, ups=0.58, wpb=375.6, bsz=32, num_updates=12570, lr=6.86308e-06, gnorm=3.572, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23192
2022-05-08 02:52:48 - progress_bar.py[line:272] - INFO: epoch 001:  12598 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.997, ntokens=382.2, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=35.37, expert1_balance_bottom=18.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=219.8, ups=0.58, wpb=382.2, bsz=32, num_updates=12580, lr=6.86008e-06, gnorm=3.705, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23209
2022-05-08 02:53:06 - progress_bar.py[line:272] - INFO: epoch 001:  12608 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=379.9, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891041, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=34.787, expert1_balance_bottom=18.618, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=215.6, ups=0.57, wpb=379.9, bsz=32, num_updates=12590, lr=6.85707e-06, gnorm=3.398, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23227
2022-05-08 02:53:23 - progress_bar.py[line:272] - INFO: epoch 001:  12618 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=35.117, expert1_balance_bottom=18.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=218.9, ups=0.57, wpb=382.4, bsz=32, num_updates=12600, lr=6.85407e-06, gnorm=3.435, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23244
2022-05-08 02:53:41 - progress_bar.py[line:272] - INFO: epoch 001:  12628 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=379.2, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889625, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.296, expert1_balance_top=34.502, expert1_balance_bottom=18.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=216.9, ups=0.57, wpb=379.2, bsz=32, num_updates=12610, lr=6.85107e-06, gnorm=3.304, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23262
2022-05-08 02:53:58 - progress_bar.py[line:272] - INFO: epoch 001:  12638 / 17711 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=1.071, ntokens=387.6, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880613, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.282, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.294, expert1_balance_top=35.395, expert1_balance_bottom=18.503, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=220.7, ups=0.57, wpb=387.6, bsz=32, num_updates=12620, lr=6.84806e-06, gnorm=3.298, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23279
2022-05-08 02:54:16 - progress_bar.py[line:272] - INFO: epoch 001:  12648 / 17711 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=1.019, ntokens=380.8, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.231, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=35.166, expert1_balance_bottom=18.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=215.4, ups=0.57, wpb=380.8, bsz=32, num_updates=12630, lr=6.84506e-06, gnorm=2.949, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23297
2022-05-08 02:54:33 - progress_bar.py[line:272] - INFO: epoch 001:  12658 / 17711 loss=3.257, loss_v1=0, loss_v2=0, nll_loss=1.052, ntokens=374.1, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.257, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=34.757, expert1_balance_bottom=18.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=215.7, ups=0.58, wpb=374.1, bsz=32, num_updates=12640, lr=6.84206e-06, gnorm=3.147, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23314
2022-05-08 02:54:51 - progress_bar.py[line:272] - INFO: epoch 001:  12668 / 17711 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.216, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=35.333, expert1_balance_bottom=18.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=218.9, ups=0.58, wpb=380.5, bsz=32, num_updates=12650, lr=6.83905e-06, gnorm=2.992, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23332
2022-05-08 02:55:08 - progress_bar.py[line:272] - INFO: epoch 001:  12678 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=389.3, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.294, expert1_balance_top=35.614, expert1_balance_bottom=18.175, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.4, ups=0.58, wpb=389.3, bsz=32, num_updates=12660, lr=6.83605e-06, gnorm=2.861, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23349
2022-05-08 02:55:26 - progress_bar.py[line:272] - INFO: epoch 001:  12688 / 17711 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=1.012, ntokens=367.7, nsentences=32, sample_size=292.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903558, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.254, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.297, expert1_balance_top=33.551, expert1_balance_bottom=18.857, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=210.1, ups=0.57, wpb=367.7, bsz=32, num_updates=12670, lr=6.83305e-06, gnorm=3.503, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23366
2022-05-08 02:55:43 - progress_bar.py[line:272] - INFO: epoch 001:  12698 / 17711 loss=3.236, loss_v1=0, loss_v2=0, nll_loss=0.998, ntokens=372.5, nsentences=32, sample_size=296.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895431, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.236, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.296, expert1_balance_top=34.56, expert1_balance_bottom=18.691, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=213.9, ups=0.57, wpb=372.5, bsz=32, num_updates=12680, lr=6.83004e-06, gnorm=3.139, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23384
2022-05-08 02:56:01 - progress_bar.py[line:272] - INFO: epoch 001:  12708 / 17711 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885568, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.189, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.294, expert1_balance_top=35, expert1_balance_bottom=18.549, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=215.3, ups=0.57, wpb=380.1, bsz=32, num_updates=12690, lr=6.82704e-06, gnorm=4.029, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23401
2022-05-08 02:56:18 - progress_bar.py[line:272] - INFO: epoch 001:  12718 / 17711 loss=3.257, loss_v1=0, loss_v2=0, nll_loss=1.042, ntokens=386.2, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887901, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.257, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.295, expert1_balance_top=35.03, expert1_balance_bottom=18.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=221.7, ups=0.57, wpb=386.2, bsz=32, num_updates=12700, lr=6.82404e-06, gnorm=3.444, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23419
2022-05-08 02:56:36 - progress_bar.py[line:272] - INFO: epoch 001:  12728 / 17711 loss=3.268, loss_v1=0, loss_v2=0, nll_loss=1.053, ntokens=384, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883586, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.268, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.301, expert1_balance_bottom=18.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=218.3, ups=0.57, wpb=384, bsz=32, num_updates=12710, lr=6.82103e-06, gnorm=3.752, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23436
2022-05-08 02:56:53 - progress_bar.py[line:272] - INFO: epoch 001:  12738 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=391.5, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881127, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.247, expert1_balance_bottom=18.357, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.4, ups=0.58, wpb=391.5, bsz=32, num_updates=12720, lr=6.81803e-06, gnorm=3.219, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23454
2022-05-08 02:57:10 - progress_bar.py[line:272] - INFO: epoch 001:  12748 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=380.2, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.294, expert1_balance_top=35.199, expert1_balance_bottom=18.357, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223, ups=0.59, wpb=380.2, bsz=32, num_updates=12730, lr=6.81503e-06, gnorm=3.02, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23471
2022-05-08 02:57:27 - progress_bar.py[line:272] - INFO: epoch 001:  12758 / 17711 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=382.2, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.294, expert1_balance_top=35.106, expert1_balance_bottom=18.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=220.7, ups=0.58, wpb=382.2, bsz=32, num_updates=12740, lr=6.81203e-06, gnorm=3.734, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23488
2022-05-08 02:57:45 - progress_bar.py[line:272] - INFO: epoch 001:  12768 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=1.026, ntokens=383.1, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.063, expert1_balance_bottom=18.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=220.3, ups=0.57, wpb=383.1, bsz=32, num_updates=12750, lr=6.80902e-06, gnorm=3.223, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23506
2022-05-08 02:58:02 - progress_bar.py[line:272] - INFO: epoch 001:  12778 / 17711 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=388, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873698, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.253, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=35.562, expert1_balance_bottom=18.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=222.4, ups=0.57, wpb=388, bsz=32, num_updates=12760, lr=6.80602e-06, gnorm=3.306, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23523
2022-05-08 02:58:19 - progress_bar.py[line:272] - INFO: epoch 001:  12788 / 17711 loss=3.315, loss_v1=0, loss_v2=0, nll_loss=1.103, ntokens=381.1, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889017, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.315, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.294, expert1_balance_top=34.776, expert1_balance_bottom=18.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=221.8, ups=0.58, wpb=381.1, bsz=32, num_updates=12770, lr=6.80302e-06, gnorm=3.47, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23540
2022-05-08 02:58:36 - progress_bar.py[line:272] - INFO: epoch 001:  12798 / 17711 loss=3.26, loss_v1=0, loss_v2=0, nll_loss=1.041, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892254, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.26, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.296, expert1_balance_top=34.674, expert1_balance_bottom=18.6, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=222.6, ups=0.58, wpb=380.9, bsz=32, num_updates=12780, lr=6.80001e-06, gnorm=3.285, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23557
2022-05-08 02:58:53 - progress_bar.py[line:272] - INFO: epoch 001:  12808 / 17711 loss=3.164, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=378, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878651, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.164, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.506, expert1_balance_bottom=18.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222.7, ups=0.59, wpb=378, bsz=32, num_updates=12790, lr=6.79701e-06, gnorm=3.362, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=23574
2022-05-08 02:59:11 - progress_bar.py[line:272] - INFO: epoch 001:  12818 / 17711 loss=3.264, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=396.2, nsentences=32, sample_size=315.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.264, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.335, expert1_balance_bottom=18.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=228.4, ups=0.58, wpb=396.2, bsz=32, num_updates=12800, lr=6.79401e-06, gnorm=3.165, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=23592
2022-05-08 02:59:28 - progress_bar.py[line:272] - INFO: epoch 001:  12828 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=35.868, expert1_balance_bottom=18.239, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=218.3, ups=0.57, wpb=383.8, bsz=32, num_updates=12810, lr=6.791e-06, gnorm=2.908, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23609
2022-05-08 02:59:46 - progress_bar.py[line:272] - INFO: epoch 001:  12838 / 17711 loss=3.269, loss_v1=0, loss_v2=0, nll_loss=1.057, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.269, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.43, expert1_balance_bottom=18.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=222.3, ups=0.58, wpb=383.6, bsz=32, num_updates=12820, lr=6.788e-06, gnorm=3.785, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23626
2022-05-08 03:00:03 - progress_bar.py[line:272] - INFO: epoch 001:  12848 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.993, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88707, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=34.662, expert1_balance_bottom=18.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=223.1, ups=0.58, wpb=385.5, bsz=32, num_updates=12830, lr=6.785e-06, gnorm=3.521, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23644
2022-05-08 03:00:20 - progress_bar.py[line:272] - INFO: epoch 001:  12858 / 17711 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=1.036, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889797, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.256, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.294, expert1_balance_top=35.084, expert1_balance_bottom=18.514, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=227, ups=0.59, wpb=381.8, bsz=32, num_updates=12840, lr=6.78199e-06, gnorm=3.337, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23661
2022-05-08 03:00:37 - progress_bar.py[line:272] - INFO: epoch 001:  12868 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=380.2, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.296, expert1_balance_top=34.396, expert1_balance_bottom=18.647, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=215.6, ups=0.57, wpb=380.2, bsz=32, num_updates=12850, lr=6.77899e-06, gnorm=3.081, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23678
2022-05-08 03:00:55 - progress_bar.py[line:272] - INFO: epoch 001:  12878 / 17711 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=1.032, ntokens=391.4, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872084, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.232, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=35.982, expert1_balance_bottom=18.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=226, ups=0.58, wpb=391.4, bsz=32, num_updates=12860, lr=6.77599e-06, gnorm=3.862, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23695
2022-05-08 03:01:12 - progress_bar.py[line:272] - INFO: epoch 001:  12888 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=386.6, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880839, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=35.503, expert1_balance_bottom=18.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=219.8, ups=0.57, wpb=386.6, bsz=32, num_updates=12870, lr=6.77298e-06, gnorm=3.399, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=23713
2022-05-08 03:01:30 - progress_bar.py[line:272] - INFO: epoch 001:  12898 / 17711 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=374.9, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880625, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.243, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=35.972, expert1_balance_bottom=18.24, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=215.1, ups=0.57, wpb=374.9, bsz=32, num_updates=12880, lr=6.76998e-06, gnorm=3.587, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23730
2022-05-08 03:01:47 - progress_bar.py[line:272] - INFO: epoch 001:  12908 / 17711 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=1.011, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.229, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=35.778, expert1_balance_bottom=18.091, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=219.2, ups=0.57, wpb=382.7, bsz=32, num_updates=12890, lr=6.76698e-06, gnorm=3.201, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23748
2022-05-08 03:02:05 - progress_bar.py[line:272] - INFO: epoch 001:  12918 / 17711 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=1.031, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88623, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.246, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.25, expert1_balance_bottom=18.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=219.2, ups=0.58, wpb=380.5, bsz=32, num_updates=12900, lr=6.76397e-06, gnorm=3.498, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23765
2022-05-08 03:02:22 - progress_bar.py[line:272] - INFO: epoch 001:  12928 / 17711 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=383.7, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.22, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=34.184, expert1_balance_bottom=18.699, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=222.3, ups=0.58, wpb=383.7, bsz=32, num_updates=12910, lr=6.76097e-06, gnorm=3.236, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23783
2022-05-08 03:02:39 - progress_bar.py[line:272] - INFO: epoch 001:  12938 / 17711 loss=3.25, loss_v1=0, loss_v2=0, nll_loss=1.024, ntokens=374.2, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.25, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=34.704, expert1_balance_bottom=18.55, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=214.3, ups=0.57, wpb=374.2, bsz=32, num_updates=12920, lr=6.75797e-06, gnorm=3.063, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23800
2022-05-08 03:02:57 - progress_bar.py[line:272] - INFO: epoch 001:  12948 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.957, ntokens=385.5, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=35.029, expert1_balance_bottom=18.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=221, ups=0.57, wpb=385.5, bsz=32, num_updates=12930, lr=6.75496e-06, gnorm=3.184, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23817
2022-05-08 03:03:14 - progress_bar.py[line:272] - INFO: epoch 001:  12958 / 17711 loss=3.312, loss_v1=0, loss_v2=0, nll_loss=1.105, ntokens=375.5, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888263, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.312, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=34.881, expert1_balance_bottom=18.675, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.15, wps=214.8, ups=0.57, wpb=375.5, bsz=32, num_updates=12940, lr=6.75196e-06, gnorm=3.396, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23835
2022-05-08 03:03:31 - progress_bar.py[line:272] - INFO: epoch 001:  12968 / 17711 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=1.047, ntokens=396.5, nsentences=32, sample_size=315.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879141, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.254, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=35.224, expert1_balance_bottom=18.418, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=232, ups=0.59, wpb=396.5, bsz=32, num_updates=12950, lr=6.74896e-06, gnorm=3.514, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23852
2022-05-08 03:03:49 - progress_bar.py[line:272] - INFO: epoch 001:  12978 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=389.9, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.09, expert1_balance_bottom=18.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=223.2, ups=0.57, wpb=389.9, bsz=32, num_updates=12960, lr=6.74595e-06, gnorm=3.312, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23870
2022-05-08 03:04:06 - progress_bar.py[line:272] - INFO: epoch 001:  12988 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=379.1, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=35.41, expert1_balance_bottom=18.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=215.7, ups=0.57, wpb=379.1, bsz=32, num_updates=12970, lr=6.74295e-06, gnorm=3.123, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=23887
2022-05-08 03:04:24 - progress_bar.py[line:272] - INFO: epoch 001:  12998 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=388.3, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88359, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.003, expert1_balance_bottom=18.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=221.1, ups=0.57, wpb=388.3, bsz=32, num_updates=12980, lr=6.73995e-06, gnorm=2.752, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23905
2022-05-08 03:04:41 - progress_bar.py[line:272] - INFO: epoch 001:  13008 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=392.3, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886224, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=34.924, expert1_balance_bottom=18.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=228.4, ups=0.58, wpb=392.3, bsz=32, num_updates=12990, lr=6.73694e-06, gnorm=3.428, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=23922
2022-05-08 03:04:58 - progress_bar.py[line:272] - INFO: epoch 001:  13018 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=384.7, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887841, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=34.92, expert1_balance_bottom=18.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=220.8, ups=0.57, wpb=384.7, bsz=32, num_updates=13000, lr=6.73394e-06, gnorm=3.1, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23939
2022-05-08 03:05:16 - progress_bar.py[line:272] - INFO: epoch 001:  13028 / 17711 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88125, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.227, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=34.946, expert1_balance_bottom=18.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=216.9, ups=0.57, wpb=381.2, bsz=32, num_updates=13010, lr=6.73094e-06, gnorm=3.664, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23957
2022-05-08 03:05:34 - progress_bar.py[line:272] - INFO: epoch 001:  13038 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=373.5, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893589, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=34.301, expert1_balance_bottom=18.644, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=213.1, ups=0.57, wpb=373.5, bsz=32, num_updates=13020, lr=6.72793e-06, gnorm=3.397, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23974
2022-05-08 03:05:51 - progress_bar.py[line:272] - INFO: epoch 001:  13048 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=378.3, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=35.221, expert1_balance_bottom=18.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=218, ups=0.58, wpb=378.3, bsz=32, num_updates=13030, lr=6.72493e-06, gnorm=2.881, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=23992
2022-05-08 03:06:08 - progress_bar.py[line:272] - INFO: epoch 001:  13058 / 17711 loss=3.251, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.251, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.294, expert1_balance_top=34.557, expert1_balance_bottom=18.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=223.7, ups=0.58, wpb=385.3, bsz=32, num_updates=13040, lr=6.72193e-06, gnorm=3.36, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=24009
2022-05-08 03:06:26 - progress_bar.py[line:272] - INFO: epoch 001:  13068 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=35.659, expert1_balance_bottom=18.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.2, ups=0.57, wpb=386.6, bsz=32, num_updates=13050, lr=6.71892e-06, gnorm=3.725, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24026
2022-05-08 03:06:43 - progress_bar.py[line:272] - INFO: epoch 001:  13078 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.038, ntokens=385.2, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882461, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.293, expert1_balance_top=35.116, expert1_balance_bottom=18.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=221.5, ups=0.57, wpb=385.2, bsz=32, num_updates=13060, lr=6.71592e-06, gnorm=3.608, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24044
2022-05-08 03:07:00 - progress_bar.py[line:272] - INFO: epoch 001:  13088 / 17711 loss=3.278, loss_v1=0, loss_v2=0, nll_loss=1.066, ntokens=377.8, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.278, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.294, expert1_balance_top=34.354, expert1_balance_bottom=18.737, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=218, ups=0.58, wpb=377.8, bsz=32, num_updates=13070, lr=6.71292e-06, gnorm=3.447, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24061
2022-05-08 03:07:18 - progress_bar.py[line:272] - INFO: epoch 001:  13098 / 17711 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=1.074, ntokens=384.5, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.282, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.291, expert1_balance_top=35.493, expert1_balance_bottom=18.186, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=222.2, ups=0.58, wpb=384.5, bsz=32, num_updates=13080, lr=6.70991e-06, gnorm=3.347, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=24078
2022-05-08 03:07:35 - progress_bar.py[line:272] - INFO: epoch 001:  13108 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=385.3, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=35.251, expert1_balance_bottom=18.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=220.3, ups=0.57, wpb=385.3, bsz=32, num_updates=13090, lr=6.70691e-06, gnorm=3.784, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24096
2022-05-08 03:07:53 - progress_bar.py[line:272] - INFO: epoch 001:  13118 / 17711 loss=3.266, loss_v1=0, loss_v2=0, nll_loss=1.058, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.266, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=34.87, expert1_balance_bottom=18.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=218.3, ups=0.57, wpb=382.7, bsz=32, num_updates=13100, lr=6.70391e-06, gnorm=3.333, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24113
2022-05-08 03:08:10 - progress_bar.py[line:272] - INFO: epoch 001:  13128 / 17711 loss=3.261, loss_v1=0, loss_v2=0, nll_loss=1.051, ntokens=389.6, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.261, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=35.392, expert1_balance_bottom=18.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=224, ups=0.57, wpb=389.6, bsz=32, num_updates=13110, lr=6.7009e-06, gnorm=3.104, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24131
2022-05-08 03:08:28 - progress_bar.py[line:272] - INFO: epoch 001:  13138 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=385.6, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889366, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=34.757, expert1_balance_bottom=18.561, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=220.4, ups=0.57, wpb=385.6, bsz=32, num_updates=13120, lr=6.6979e-06, gnorm=3.075, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=24148
2022-05-08 03:08:45 - progress_bar.py[line:272] - INFO: epoch 001:  13148 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=378.2, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883099, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=34.866, expert1_balance_bottom=18.673, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=216.8, ups=0.57, wpb=378.2, bsz=32, num_updates=13130, lr=6.6949e-06, gnorm=3.108, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24166
2022-05-08 03:09:02 - progress_bar.py[line:272] - INFO: epoch 001:  13158 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=385.4, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.291, expert1_balance_top=34.78, expert1_balance_bottom=18.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220.1, ups=0.57, wpb=385.4, bsz=32, num_updates=13140, lr=6.69189e-06, gnorm=3.275, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24183
2022-05-08 03:09:20 - progress_bar.py[line:272] - INFO: epoch 001:  13168 / 17711 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=1.016, ntokens=395, nsentences=32, sample_size=314.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884393, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.235, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=34.897, expert1_balance_bottom=18.521, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=227.2, ups=0.58, wpb=395, bsz=32, num_updates=13150, lr=6.68889e-06, gnorm=3.063, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24201
2022-05-08 03:09:37 - progress_bar.py[line:272] - INFO: epoch 001:  13178 / 17711 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.199, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=34.227, expert1_balance_bottom=18.591, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=224.4, ups=0.59, wpb=382.5, bsz=32, num_updates=13160, lr=6.68589e-06, gnorm=3.408, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24218
2022-05-08 03:09:54 - progress_bar.py[line:272] - INFO: epoch 001:  13188 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=381.8, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895321, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.292, expert1_balance_top=34.332, expert1_balance_bottom=18.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=223.1, ups=0.58, wpb=381.8, bsz=32, num_updates=13170, lr=6.68288e-06, gnorm=3.42, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24235
2022-05-08 03:10:12 - progress_bar.py[line:272] - INFO: epoch 001:  13198 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881233, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=35.143, expert1_balance_bottom=18.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=216.6, ups=0.57, wpb=379.2, bsz=32, num_updates=13180, lr=6.67988e-06, gnorm=3.302, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24252
2022-05-08 03:10:29 - progress_bar.py[line:272] - INFO: epoch 001:  13208 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=378.2, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.287, expert1_balance_top=35.464, expert1_balance_bottom=18.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=218.4, ups=0.58, wpb=378.2, bsz=32, num_updates=13190, lr=6.67688e-06, gnorm=3.441, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24270
2022-05-08 03:10:47 - progress_bar.py[line:272] - INFO: epoch 001:  13218 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886616, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=35.168, expert1_balance_bottom=18.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=213.3, ups=0.56, wpb=378.4, bsz=32, num_updates=13200, lr=6.67387e-06, gnorm=3.253, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24287
2022-05-08 03:11:04 - progress_bar.py[line:272] - INFO: epoch 001:  13228 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=379.7, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=35.387, expert1_balance_bottom=18.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=219, ups=0.58, wpb=379.7, bsz=32, num_updates=13210, lr=6.67087e-06, gnorm=3.137, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24305
2022-05-08 03:11:22 - progress_bar.py[line:272] - INFO: epoch 001:  13238 / 17711 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=1.033, ntokens=377.7, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.254, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=34.825, expert1_balance_bottom=18.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=214.8, ups=0.57, wpb=377.7, bsz=32, num_updates=13220, lr=6.66787e-06, gnorm=3.446, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24322
2022-05-08 03:11:39 - progress_bar.py[line:272] - INFO: epoch 001:  13248 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=386.2, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891403, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=34.613, expert1_balance_bottom=18.653, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.1, ups=0.58, wpb=386.2, bsz=32, num_updates=13230, lr=6.66486e-06, gnorm=3.168, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24339
2022-05-08 03:11:56 - progress_bar.py[line:272] - INFO: epoch 001:  13258 / 17711 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=373.6, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.232, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.291, expert1_balance_top=34.403, expert1_balance_bottom=18.691, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=219.8, ups=0.59, wpb=373.6, bsz=32, num_updates=13240, lr=6.66186e-06, gnorm=3.337, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24356
2022-05-08 03:11:57 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 03:12:15 - progress_bar.py[line:272] - INFO: epoch 001:  13269 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=377.6, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89055, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=34.456, expert1_balance_bottom=18.595, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=199.3, ups=0.53, wpb=377.6, bsz=32, num_updates=13250, lr=6.65886e-06, gnorm=3.517, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24375
2022-05-08 03:12:32 - progress_bar.py[line:272] - INFO: epoch 001:  13279 / 17711 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888169, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.229, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=34.796, expert1_balance_bottom=18.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=216.5, ups=0.57, wpb=382.1, bsz=32, num_updates=13260, lr=6.65585e-06, gnorm=3.772, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24393
2022-05-08 03:12:49 - progress_bar.py[line:272] - INFO: epoch 001:  13289 / 17711 loss=3.278, loss_v1=0, loss_v2=0, nll_loss=1.065, ntokens=384.8, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.278, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=34.693, expert1_balance_bottom=18.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=224.5, ups=0.58, wpb=384.8, bsz=32, num_updates=13270, lr=6.65285e-06, gnorm=3.163, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24410
2022-05-08 03:13:06 - progress_bar.py[line:272] - INFO: epoch 001:  13299 / 17711 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879562, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.192, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=35.837, expert1_balance_bottom=18.004, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=224.1, ups=0.59, wpb=382.1, bsz=32, num_updates=13280, lr=6.64985e-06, gnorm=3.074, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24427
2022-05-08 03:13:24 - progress_bar.py[line:272] - INFO: epoch 001:  13309 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=386.4, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883525, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=35, expert1_balance_bottom=18.399, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222, ups=0.57, wpb=386.4, bsz=32, num_updates=13290, lr=6.64685e-06, gnorm=3.694, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24445
2022-05-08 03:13:41 - progress_bar.py[line:272] - INFO: epoch 001:  13319 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=34.665, expert1_balance_bottom=18.646, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=218.4, ups=0.58, wpb=378.4, bsz=32, num_updates=13300, lr=6.64384e-06, gnorm=2.843, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=24462
2022-05-08 03:13:58 - progress_bar.py[line:272] - INFO: epoch 001:  13329 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=375.6, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=34.905, expert1_balance_bottom=18.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=217.5, ups=0.58, wpb=375.6, bsz=32, num_updates=13310, lr=6.64084e-06, gnorm=3.192, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24479
2022-05-08 03:14:16 - progress_bar.py[line:272] - INFO: epoch 001:  13339 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=387.8, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=34.557, expert1_balance_bottom=18.492, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.7, ups=0.57, wpb=387.8, bsz=32, num_updates=13320, lr=6.63784e-06, gnorm=2.917, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24497
2022-05-08 03:14:33 - progress_bar.py[line:272] - INFO: epoch 001:  13349 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=389.9, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=34.5, expert1_balance_bottom=18.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=221.1, ups=0.57, wpb=389.9, bsz=32, num_updates=13330, lr=6.63483e-06, gnorm=3.536, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24514
2022-05-08 03:14:51 - progress_bar.py[line:272] - INFO: epoch 001:  13359 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=34.643, expert1_balance_bottom=18.808, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.7, ups=0.57, wpb=388, bsz=32, num_updates=13340, lr=6.63183e-06, gnorm=3.048, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24532
2022-05-08 03:15:08 - progress_bar.py[line:272] - INFO: epoch 001:  13369 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.287, expert1_balance_top=35.25, expert1_balance_bottom=18.291, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221.9, ups=0.58, wpb=385, bsz=32, num_updates=13350, lr=6.62883e-06, gnorm=3.292, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24549
2022-05-08 03:15:26 - progress_bar.py[line:272] - INFO: epoch 001:  13379 / 17711 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.174, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.286, expert1_balance_top=35.927, expert1_balance_bottom=18.02, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=223.2, ups=0.58, wpb=384, bsz=32, num_updates=13360, lr=6.62582e-06, gnorm=2.944, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24566
2022-05-08 03:15:43 - progress_bar.py[line:272] - INFO: epoch 001:  13389 / 17711 loss=3.258, loss_v1=0, loss_v2=0, nll_loss=1.039, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.258, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=34.791, expert1_balance_bottom=18.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=223.8, ups=0.59, wpb=380.8, bsz=32, num_updates=13370, lr=6.62282e-06, gnorm=3.97, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24583
2022-05-08 03:16:00 - progress_bar.py[line:272] - INFO: epoch 001:  13399 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=381.9, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=34.567, expert1_balance_bottom=18.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=221.9, ups=0.58, wpb=381.9, bsz=32, num_updates=13380, lr=6.61982e-06, gnorm=3.512, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24601
2022-05-08 03:16:17 - progress_bar.py[line:272] - INFO: epoch 001:  13409 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=383, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.287, expert1_balance_top=35.361, expert1_balance_bottom=18.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=220.3, ups=0.58, wpb=383, bsz=32, num_updates=13390, lr=6.61681e-06, gnorm=2.916, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24618
2022-05-08 03:16:35 - progress_bar.py[line:272] - INFO: epoch 001:  13419 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885899, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=34.859, expert1_balance_bottom=18.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=218.6, ups=0.57, wpb=383.9, bsz=32, num_updates=13400, lr=6.61381e-06, gnorm=3.955, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24635
2022-05-08 03:16:52 - progress_bar.py[line:272] - INFO: epoch 001:  13429 / 17711 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.209, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=34.632, expert1_balance_bottom=18.589, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=227, ups=0.59, wpb=386, bsz=32, num_updates=13410, lr=6.61081e-06, gnorm=3.2, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24653
2022-05-08 03:17:09 - progress_bar.py[line:272] - INFO: epoch 001:  13439 / 17711 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=1.03, ntokens=387.3, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870756, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.234, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.284, expert1_balance_top=35.738, expert1_balance_bottom=18.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=223, ups=0.58, wpb=387.3, bsz=32, num_updates=13420, lr=6.6078e-06, gnorm=3.306, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=24670
2022-05-08 03:17:27 - progress_bar.py[line:272] - INFO: epoch 001:  13449 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=374.7, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.289, expert1_balance_top=34.233, expert1_balance_bottom=18.876, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=214.5, ups=0.57, wpb=374.7, bsz=32, num_updates=13430, lr=6.6048e-06, gnorm=3.342, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24687
2022-05-08 03:17:44 - progress_bar.py[line:272] - INFO: epoch 001:  13459 / 17711 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.247, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=34.774, expert1_balance_bottom=18.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=220, ups=0.57, wpb=386.6, bsz=32, num_updates=13440, lr=6.6018e-06, gnorm=3.221, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24705
2022-05-08 03:18:02 - progress_bar.py[line:272] - INFO: epoch 001:  13469 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=381.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=34.571, expert1_balance_bottom=18.662, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=219.2, ups=0.57, wpb=381.8, bsz=32, num_updates=13450, lr=6.59879e-06, gnorm=3.93, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24722
2022-05-08 03:18:19 - progress_bar.py[line:272] - INFO: epoch 001:  13479 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884628, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.287, expert1_balance_top=35.102, expert1_balance_bottom=18.52, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=222.1, ups=0.58, wpb=383.8, bsz=32, num_updates=13460, lr=6.59579e-06, gnorm=3.165, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24740
2022-05-08 03:18:36 - progress_bar.py[line:272] - INFO: epoch 001:  13489 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.024, ntokens=378, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.286, expert1_balance_top=35.543, expert1_balance_bottom=18.404, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=215.6, ups=0.57, wpb=378, bsz=32, num_updates=13470, lr=6.59279e-06, gnorm=4.251, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24757
2022-05-08 03:18:54 - progress_bar.py[line:272] - INFO: epoch 001:  13499 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=388.4, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888929, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=34.717, expert1_balance_bottom=18.549, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=226.6, ups=0.58, wpb=388.4, bsz=32, num_updates=13480, lr=6.58978e-06, gnorm=2.982, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24774
2022-05-08 03:19:11 - progress_bar.py[line:272] - INFO: epoch 001:  13509 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=376.4, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893081, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.287, expert1_balance_top=34.718, expert1_balance_bottom=18.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=215.4, ups=0.57, wpb=376.4, bsz=32, num_updates=13490, lr=6.58678e-06, gnorm=3.009, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24792
2022-05-08 03:19:29 - progress_bar.py[line:272] - INFO: epoch 001:  13519 / 17711 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=376.6, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88731, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.207, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.286, expert1_balance_top=34.614, expert1_balance_bottom=18.526, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=207.5, ups=0.55, wpb=376.6, bsz=32, num_updates=13500, lr=6.58378e-06, gnorm=3.089, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24810
2022-05-08 03:19:46 - progress_bar.py[line:272] - INFO: epoch 001:  13529 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=383.5, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=34.523, expert1_balance_bottom=18.835, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=222.9, ups=0.58, wpb=383.5, bsz=32, num_updates=13510, lr=6.58077e-06, gnorm=2.788, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24827
2022-05-08 03:20:04 - progress_bar.py[line:272] - INFO: epoch 001:  13539 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876049, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.284, expert1_balance_top=35.982, expert1_balance_bottom=18.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220.8, ups=0.57, wpb=384.9, bsz=32, num_updates=13520, lr=6.57777e-06, gnorm=3.07, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=24845
2022-05-08 03:20:21 - progress_bar.py[line:272] - INFO: epoch 001:  13549 / 17711 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=1.002, ntokens=387.7, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.231, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=34.795, expert1_balance_bottom=18.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=223.9, ups=0.58, wpb=387.7, bsz=32, num_updates=13530, lr=6.57477e-06, gnorm=3.499, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24862
2022-05-08 03:20:38 - progress_bar.py[line:272] - INFO: epoch 001:  13559 / 17711 loss=3.164, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884877, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.164, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.286, expert1_balance_top=35.07, expert1_balance_bottom=18.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220.6, ups=0.58, wpb=381.9, bsz=32, num_updates=13540, lr=6.57176e-06, gnorm=2.964, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24879
2022-05-08 03:20:56 - progress_bar.py[line:272] - INFO: epoch 001:  13569 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900121, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.29, expert1_balance_top=34.155, expert1_balance_bottom=18.712, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=219.1, ups=0.57, wpb=383.2, bsz=32, num_updates=13550, lr=6.56876e-06, gnorm=3.253, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24897
2022-05-08 03:21:13 - progress_bar.py[line:272] - INFO: epoch 001:  13579 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=385.6, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=35.535, expert1_balance_bottom=18.34, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=227.4, ups=0.59, wpb=385.6, bsz=32, num_updates=13560, lr=6.56576e-06, gnorm=3.649, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24914
2022-05-08 03:21:30 - progress_bar.py[line:272] - INFO: epoch 001:  13589 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886155, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.286, expert1_balance_top=35.009, expert1_balance_bottom=18.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223, ups=0.58, wpb=383.3, bsz=32, num_updates=13570, lr=6.56275e-06, gnorm=2.825, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24931
2022-05-08 03:21:48 - progress_bar.py[line:272] - INFO: epoch 001:  13599 / 17711 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=385.1, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884652, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.206, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.287, expert1_balance_top=34.897, expert1_balance_bottom=18.493, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=218.9, ups=0.57, wpb=385.1, bsz=32, num_updates=13580, lr=6.55975e-06, gnorm=3.255, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24948
2022-05-08 03:22:05 - progress_bar.py[line:272] - INFO: epoch 001:  13609 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=35.69, expert1_balance_bottom=18.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.5, ups=0.57, wpb=386.3, bsz=32, num_updates=13590, lr=6.55675e-06, gnorm=3.435, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24966
2022-05-08 03:22:23 - progress_bar.py[line:272] - INFO: epoch 001:  13619 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.975, ntokens=380.4, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887519, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.286, expert1_balance_top=34.723, expert1_balance_bottom=18.57, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=217.6, ups=0.57, wpb=380.4, bsz=32, num_updates=13600, lr=6.55374e-06, gnorm=3.292, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=24983
2022-05-08 03:22:40 - progress_bar.py[line:272] - INFO: epoch 001:  13629 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=390.3, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879092, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.285, expert1_balance_top=35.096, expert1_balance_bottom=18.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.5, ups=0.57, wpb=390.3, bsz=32, num_updates=13610, lr=6.55074e-06, gnorm=3.306, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25001
2022-05-08 03:22:57 - progress_bar.py[line:272] - INFO: epoch 001:  13639 / 17711 loss=3.242, loss_v1=0, loss_v2=0, nll_loss=1.035, ntokens=387.4, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880029, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.242, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.284, expert1_balance_top=35.654, expert1_balance_bottom=18.24, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=223.7, ups=0.58, wpb=387.4, bsz=32, num_updates=13620, lr=6.54774e-06, gnorm=3.655, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25018
2022-05-08 03:23:15 - progress_bar.py[line:272] - INFO: epoch 001:  13649 / 17711 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=1.026, ntokens=386, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.238, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.285, expert1_balance_top=35.086, expert1_balance_bottom=18.599, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=222.8, ups=0.58, wpb=386, bsz=32, num_updates=13630, lr=6.54473e-06, gnorm=3.532, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25036
2022-05-08 03:23:32 - progress_bar.py[line:272] - INFO: epoch 001:  13659 / 17711 loss=3.26, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.26, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.284, expert1_balance_top=35.945, expert1_balance_bottom=18.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=221.5, ups=0.57, wpb=385.6, bsz=32, num_updates=13640, lr=6.54173e-06, gnorm=3.449, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25053
2022-05-08 03:23:50 - progress_bar.py[line:272] - INFO: epoch 001:  13669 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893371, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.286, expert1_balance_top=34.419, expert1_balance_bottom=18.653, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221.6, ups=0.57, wpb=385.4, bsz=32, num_updates=13650, lr=6.53873e-06, gnorm=3.151, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25070
2022-05-08 03:24:07 - progress_bar.py[line:272] - INFO: epoch 001:  13679 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=387.6, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=36.148, expert1_balance_bottom=18.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=218.4, ups=0.56, wpb=387.6, bsz=32, num_updates=13660, lr=6.53572e-06, gnorm=2.998, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25088
2022-05-08 03:24:24 - progress_bar.py[line:272] - INFO: epoch 001:  13689 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=385.8, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.282, expert1_balance_top=35.426, expert1_balance_bottom=18.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=227.2, ups=0.59, wpb=385.8, bsz=32, num_updates=13670, lr=6.53272e-06, gnorm=3.566, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25105
2022-05-08 03:24:42 - progress_bar.py[line:272] - INFO: epoch 001:  13699 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=389.6, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876283, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.282, expert1_balance_top=35.377, expert1_balance_bottom=18.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=226.9, ups=0.58, wpb=389.6, bsz=32, num_updates=13680, lr=6.52972e-06, gnorm=2.886, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=25122
2022-05-08 03:24:59 - progress_bar.py[line:272] - INFO: epoch 001:  13709 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=34.859, expert1_balance_bottom=18.697, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=213.7, ups=0.56, wpb=379.3, bsz=32, num_updates=13690, lr=6.52671e-06, gnorm=3.031, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25140
2022-05-08 03:25:17 - progress_bar.py[line:272] - INFO: epoch 001:  13719 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.975, ntokens=384.8, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884064, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=35.323, expert1_balance_bottom=18.454, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=217.1, ups=0.56, wpb=384.8, bsz=32, num_updates=13700, lr=6.52371e-06, gnorm=3.125, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25158
2022-05-08 03:25:34 - progress_bar.py[line:272] - INFO: epoch 001:  13729 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880484, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.284, expert1_balance_top=35.384, expert1_balance_bottom=18.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=222.9, ups=0.59, wpb=379.8, bsz=32, num_updates=13710, lr=6.52071e-06, gnorm=3.403, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25175
2022-05-08 03:25:52 - progress_bar.py[line:272] - INFO: epoch 001:  13739 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=0.99, ntokens=374.9, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.288, expert1_balance_top=33.97, expert1_balance_bottom=18.624, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=212.7, ups=0.57, wpb=374.9, bsz=32, num_updates=13720, lr=6.5177e-06, gnorm=3.971, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=25192
2022-05-08 03:26:09 - progress_bar.py[line:272] - INFO: epoch 001:  13749 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=35.017, expert1_balance_bottom=18.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221.3, ups=0.57, wpb=386, bsz=32, num_updates=13730, lr=6.5147e-06, gnorm=3.097, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25210
2022-05-08 03:26:27 - progress_bar.py[line:272] - INFO: epoch 001:  13759 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.986, ntokens=382, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881724, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=34.861, expert1_balance_bottom=18.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=217.5, ups=0.57, wpb=382, bsz=32, num_updates=13740, lr=6.5117e-06, gnorm=3.491, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25227
2022-05-08 03:26:44 - progress_bar.py[line:272] - INFO: epoch 001:  13769 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=383.9, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.285, expert1_balance_top=34.464, expert1_balance_bottom=18.613, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=219.2, ups=0.57, wpb=383.9, bsz=32, num_updates=13750, lr=6.50869e-06, gnorm=3.526, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25245
2022-05-08 03:27:02 - progress_bar.py[line:272] - INFO: epoch 001:  13779 / 17711 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.998, ntokens=386, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877356, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.209, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=35.758, expert1_balance_bottom=18.217, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=222, ups=0.58, wpb=386, bsz=32, num_updates=13760, lr=6.50569e-06, gnorm=3.401, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25262
2022-05-08 03:27:19 - progress_bar.py[line:272] - INFO: epoch 001:  13789 / 17711 loss=3.245, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=382.8, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.245, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.284, expert1_balance_top=34.788, expert1_balance_bottom=18.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=219.6, ups=0.57, wpb=382.8, bsz=32, num_updates=13770, lr=6.50269e-06, gnorm=3.714, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25280
2022-05-08 03:27:37 - progress_bar.py[line:272] - INFO: epoch 001:  13799 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=389.2, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=35.711, expert1_balance_bottom=17.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=217.2, ups=0.56, wpb=389.2, bsz=32, num_updates=13780, lr=6.49968e-06, gnorm=3.38, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25298
2022-05-08 03:27:55 - progress_bar.py[line:272] - INFO: epoch 001:  13809 / 17711 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=372.7, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.171, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.285, expert1_balance_top=33.859, expert1_balance_bottom=18.831, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=208.9, ups=0.56, wpb=372.7, bsz=32, num_updates=13790, lr=6.49668e-06, gnorm=3.168, loss_scale=256, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25316
2022-05-08 03:28:12 - progress_bar.py[line:272] - INFO: epoch 001:  13819 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.98, ntokens=378.9, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.286, expert1_balance_top=34.227, expert1_balance_bottom=18.626, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=215, ups=0.57, wpb=378.9, bsz=32, num_updates=13800, lr=6.49368e-06, gnorm=3.159, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25333
2022-05-08 03:28:30 - progress_bar.py[line:272] - INFO: epoch 001:  13829 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883022, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=35.018, expert1_balance_bottom=18.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=215.4, ups=0.57, wpb=378.5, bsz=32, num_updates=13810, lr=6.49067e-06, gnorm=3.472, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25351
2022-05-08 03:28:47 - progress_bar.py[line:272] - INFO: epoch 001:  13839 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=387, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883429, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.284, expert1_balance_top=35.023, expert1_balance_bottom=18.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=224.5, ups=0.58, wpb=387, bsz=32, num_updates=13820, lr=6.48767e-06, gnorm=3.072, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=25368
2022-05-08 03:29:05 - progress_bar.py[line:272] - INFO: epoch 001:  13849 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=35.481, expert1_balance_bottom=18.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=219.5, ups=0.57, wpb=382.9, bsz=32, num_updates=13830, lr=6.48467e-06, gnorm=3.453, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25385
2022-05-08 03:29:22 - progress_bar.py[line:272] - INFO: epoch 001:  13859 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=384.2, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=34.718, expert1_balance_bottom=18.582, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.1, ups=0.58, wpb=384.2, bsz=32, num_updates=13840, lr=6.48167e-06, gnorm=3.136, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25403
2022-05-08 03:29:39 - progress_bar.py[line:272] - INFO: epoch 001:  13869 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=34.792, expert1_balance_bottom=18.537, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=217.9, ups=0.57, wpb=380.9, bsz=32, num_updates=13850, lr=6.47866e-06, gnorm=3.324, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25420
2022-05-08 03:29:57 - progress_bar.py[line:272] - INFO: epoch 001:  13879 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=375.8, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887129, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.282, expert1_balance_top=34.988, expert1_balance_bottom=18.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=214.7, ups=0.57, wpb=375.8, bsz=32, num_updates=13860, lr=6.47566e-06, gnorm=3.294, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25438
2022-05-08 03:30:14 - progress_bar.py[line:272] - INFO: epoch 001:  13889 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=390.4, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=35.576, expert1_balance_bottom=18.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.1, ups=0.57, wpb=390.4, bsz=32, num_updates=13870, lr=6.47266e-06, gnorm=3.105, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25455
2022-05-08 03:30:32 - progress_bar.py[line:272] - INFO: epoch 001:  13899 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=385.6, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.285, expert1_balance_top=34.144, expert1_balance_bottom=18.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.1, ups=0.58, wpb=385.6, bsz=32, num_updates=13880, lr=6.46965e-06, gnorm=2.95, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25473
2022-05-08 03:30:49 - progress_bar.py[line:272] - INFO: epoch 001:  13909 / 17711 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=377.4, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897898, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.238, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.285, expert1_balance_top=33.738, expert1_balance_bottom=18.904, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=215.8, ups=0.57, wpb=377.4, bsz=32, num_updates=13890, lr=6.46665e-06, gnorm=3.177, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25490
2022-05-08 03:31:07 - progress_bar.py[line:272] - INFO: epoch 001:  13919 / 17711 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=1.012, ntokens=376.4, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.235, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=34.594, expert1_balance_bottom=18.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=213.7, ups=0.57, wpb=376.4, bsz=32, num_updates=13900, lr=6.46365e-06, gnorm=3.437, loss_scale=256, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=25508
2022-05-08 03:31:24 - progress_bar.py[line:272] - INFO: epoch 001:  13929 / 17711 loss=3.285, loss_v1=0, loss_v2=0, nll_loss=1.073, ntokens=380.1, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.285, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.284, expert1_balance_top=34.251, expert1_balance_bottom=18.71, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.1, wps=217.7, ups=0.57, wpb=380.1, bsz=32, num_updates=13910, lr=6.46064e-06, gnorm=4.171, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25525
2022-05-08 03:31:42 - progress_bar.py[line:272] - INFO: epoch 001:  13939 / 17711 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=1.045, ntokens=375.2, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.255, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.282, expert1_balance_top=34.888, expert1_balance_bottom=18.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=216.9, ups=0.58, wpb=375.2, bsz=32, num_updates=13920, lr=6.45764e-06, gnorm=3.31, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25542
2022-05-08 03:31:59 - progress_bar.py[line:272] - INFO: epoch 001:  13949 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=376.8, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.282, expert1_balance_top=34.462, expert1_balance_bottom=18.608, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=216.6, ups=0.57, wpb=376.8, bsz=32, num_updates=13930, lr=6.45464e-06, gnorm=3.102, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25560
2022-05-08 03:32:16 - progress_bar.py[line:272] - INFO: epoch 001:  13959 / 17711 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=389.1, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893459, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.192, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.284, expert1_balance_top=34.491, expert1_balance_bottom=18.392, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=229.9, ups=0.59, wpb=389.1, bsz=32, num_updates=13940, lr=6.45163e-06, gnorm=3.439, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25577
2022-05-08 03:32:33 - progress_bar.py[line:272] - INFO: epoch 001:  13969 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.042, ntokens=383, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.282, expert1_balance_top=35.305, expert1_balance_bottom=18.253, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=226.4, ups=0.59, wpb=383, bsz=32, num_updates=13950, lr=6.44863e-06, gnorm=4.219, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25594
2022-05-08 03:32:50 - progress_bar.py[line:272] - INFO: epoch 001:  13979 / 17711 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.171, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=34.529, expert1_balance_bottom=18.458, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=220.8, ups=0.58, wpb=381.6, bsz=32, num_updates=13960, lr=6.44563e-06, gnorm=3.3, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25611
2022-05-08 03:33:07 - progress_bar.py[line:272] - INFO: epoch 001:  13989 / 17711 loss=3.251, loss_v1=0, loss_v2=0, nll_loss=1.033, ntokens=391.1, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.251, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=34.975, expert1_balance_bottom=18.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=228.5, ups=0.58, wpb=391.1, bsz=32, num_updates=13970, lr=6.44262e-06, gnorm=4.045, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25628
2022-05-08 03:33:11 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 03:33:26 - progress_bar.py[line:272] - INFO: epoch 001:  14000 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=382.2, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=35.248, expert1_balance_bottom=18.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=201.9, ups=0.53, wpb=382.2, bsz=32, num_updates=13980, lr=6.43962e-06, gnorm=3.086, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25647
2022-05-08 03:33:44 - progress_bar.py[line:272] - INFO: epoch 001:  14010 / 17711 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.975, ntokens=384.8, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.199, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=34.475, expert1_balance_bottom=18.787, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=218, ups=0.57, wpb=384.8, bsz=32, num_updates=13990, lr=6.43662e-06, gnorm=3.515, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=25665
2022-05-08 03:34:02 - progress_bar.py[line:272] - INFO: epoch 001:  14020 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=387.7, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888169, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=34.947, expert1_balance_bottom=18.683, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=218.1, ups=0.56, wpb=387.7, bsz=32, num_updates=14000, lr=6.43361e-06, gnorm=3.544, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25682
2022-05-08 03:34:19 - progress_bar.py[line:272] - INFO: epoch 001:  14030 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=34.983, expert1_balance_bottom=18.559, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=219.8, ups=0.58, wpb=380.2, bsz=32, num_updates=14010, lr=6.43061e-06, gnorm=3.809, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25700
2022-05-08 03:34:36 - progress_bar.py[line:272] - INFO: epoch 001:  14040 / 17711 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=379.1, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888716, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.23, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.282, expert1_balance_top=34.734, expert1_balance_bottom=18.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=218, ups=0.58, wpb=379.1, bsz=32, num_updates=14020, lr=6.42761e-06, gnorm=3.146, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25717
2022-05-08 03:34:54 - progress_bar.py[line:272] - INFO: epoch 001:  14050 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.991, ntokens=387.7, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875903, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=35.417, expert1_balance_bottom=18.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=223.8, ups=0.58, wpb=387.7, bsz=32, num_updates=14030, lr=6.4246e-06, gnorm=3.406, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25734
2022-05-08 03:35:11 - progress_bar.py[line:272] - INFO: epoch 001:  14060 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=385.8, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=35.399, expert1_balance_bottom=18.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=225.6, ups=0.58, wpb=385.8, bsz=32, num_updates=14040, lr=6.4216e-06, gnorm=3.394, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=25752
2022-05-08 03:35:28 - progress_bar.py[line:272] - INFO: epoch 001:  14070 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=388.3, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886581, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.282, expert1_balance_top=34.589, expert1_balance_bottom=18.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=222.5, ups=0.57, wpb=388.3, bsz=32, num_updates=14050, lr=6.4186e-06, gnorm=3.238, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25769
2022-05-08 03:35:46 - progress_bar.py[line:272] - INFO: epoch 001:  14080 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=392.1, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876137, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=35.018, expert1_balance_bottom=18.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=225, ups=0.57, wpb=392.1, bsz=32, num_updates=14060, lr=6.41559e-06, gnorm=2.986, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25786
2022-05-08 03:36:03 - progress_bar.py[line:272] - INFO: epoch 001:  14090 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=387.9, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=34.861, expert1_balance_bottom=18.472, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.6, ups=0.58, wpb=387.9, bsz=32, num_updates=14070, lr=6.41259e-06, gnorm=3.296, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25804
2022-05-08 03:36:20 - progress_bar.py[line:272] - INFO: epoch 001:  14100 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=34.307, expert1_balance_bottom=18.576, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=219.1, ups=0.57, wpb=384.3, bsz=32, num_updates=14080, lr=6.40959e-06, gnorm=3.931, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25821
2022-05-08 03:36:38 - progress_bar.py[line:272] - INFO: epoch 001:  14110 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883429, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.961, expert1_balance_bottom=18.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=215.5, ups=0.57, wpb=378.7, bsz=32, num_updates=14090, lr=6.40658e-06, gnorm=3.764, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25839
2022-05-08 03:36:56 - progress_bar.py[line:272] - INFO: epoch 001:  14120 / 17711 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894831, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.179, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.283, expert1_balance_top=33.908, expert1_balance_bottom=18.934, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=217.2, ups=0.56, wpb=384.5, bsz=32, num_updates=14100, lr=6.40358e-06, gnorm=3.05, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25857
2022-05-08 03:37:13 - progress_bar.py[line:272] - INFO: epoch 001:  14130 / 17711 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892325, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.211, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=34.529, expert1_balance_bottom=18.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=214.9, ups=0.57, wpb=378.8, bsz=32, num_updates=14110, lr=6.40058e-06, gnorm=3.707, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25874
2022-05-08 03:37:31 - progress_bar.py[line:272] - INFO: epoch 001:  14140 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.024, ntokens=380, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=34.846, expert1_balance_bottom=18.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=217.6, ups=0.57, wpb=380, bsz=32, num_updates=14120, lr=6.39757e-06, gnorm=4.037, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25892
2022-05-08 03:37:48 - progress_bar.py[line:272] - INFO: epoch 001:  14150 / 17711 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.961, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884307, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.18, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=34.632, expert1_balance_bottom=18.735, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=216.7, ups=0.57, wpb=379, bsz=32, num_updates=14130, lr=6.39457e-06, gnorm=3.644, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25909
2022-05-08 03:38:06 - progress_bar.py[line:272] - INFO: epoch 001:  14160 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=372, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889066, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.538, expert1_balance_bottom=18.46, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=216.2, ups=0.58, wpb=372, bsz=32, num_updates=14140, lr=6.39157e-06, gnorm=3.677, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25926
reach the end of datafile, start a new reader
2022-05-08 03:38:23 - progress_bar.py[line:272] - INFO: epoch 001:  14170 / 17711 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=374.8, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884301, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.22, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=35.016, expert1_balance_bottom=18.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=214.6, ups=0.57, wpb=374.8, bsz=32, num_updates=14150, lr=6.38856e-06, gnorm=3.716, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25944
2022-05-08 03:38:41 - progress_bar.py[line:272] - INFO: epoch 001:  14180 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=380.2, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=35.24, expert1_balance_bottom=18.557, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=214.7, ups=0.56, wpb=380.2, bsz=32, num_updates=14160, lr=6.38556e-06, gnorm=3.471, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25962
2022-05-08 03:38:58 - progress_bar.py[line:272] - INFO: epoch 001:  14190 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=34.923, expert1_balance_bottom=18.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=218.9, ups=0.57, wpb=380.7, bsz=32, num_updates=14170, lr=6.38256e-06, gnorm=3.316, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=25979
2022-05-08 03:39:16 - progress_bar.py[line:272] - INFO: epoch 001:  14200 / 17711 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=377, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88733, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.216, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=34.638, expert1_balance_bottom=18.757, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=214.4, ups=0.57, wpb=377, bsz=32, num_updates=14180, lr=6.37955e-06, gnorm=3.955, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=25996
2022-05-08 03:39:33 - progress_bar.py[line:272] - INFO: epoch 001:  14210 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=1.011, ntokens=372.2, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.277, expert1_balance_top=35.583, expert1_balance_bottom=18.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=218.8, ups=0.59, wpb=372.2, bsz=32, num_updates=14190, lr=6.37655e-06, gnorm=3.475, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26014
2022-05-08 03:39:50 - progress_bar.py[line:272] - INFO: epoch 001:  14220 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=395.4, nsentences=32, sample_size=314.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886044, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.943, expert1_balance_bottom=18.625, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=232.7, ups=0.59, wpb=395.4, bsz=32, num_updates=14200, lr=6.37355e-06, gnorm=3.26, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26030
2022-05-08 03:40:07 - progress_bar.py[line:272] - INFO: epoch 001:  14230 / 17711 loss=3.28, loss_v1=0, loss_v2=0, nll_loss=1.086, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.28, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=35.599, expert1_balance_bottom=18.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.12, wps=228.4, ups=0.59, wpb=385.6, bsz=32, num_updates=14210, lr=6.37054e-06, gnorm=3.489, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26047
2022-05-08 03:40:24 - progress_bar.py[line:272] - INFO: epoch 001:  14240 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=374.7, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879861, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.277, expert1_balance_top=35.305, expert1_balance_bottom=18.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=217.6, ups=0.58, wpb=374.7, bsz=32, num_updates=14220, lr=6.36754e-06, gnorm=3.233, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26065
2022-05-08 03:40:41 - progress_bar.py[line:272] - INFO: epoch 001:  14250 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888318, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=34.809, expert1_balance_bottom=18.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.7, ups=0.59, wpb=382.9, bsz=32, num_updates=14230, lr=6.36454e-06, gnorm=3.305, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26082
2022-05-08 03:40:58 - progress_bar.py[line:272] - INFO: epoch 001:  14260 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=1, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=34.81, expert1_balance_bottom=18.648, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=219.4, ups=0.58, wpb=381.2, bsz=32, num_updates=14240, lr=6.36153e-06, gnorm=3.249, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26099
2022-05-08 03:41:16 - progress_bar.py[line:272] - INFO: epoch 001:  14270 / 17711 loss=3.297, loss_v1=0, loss_v2=0, nll_loss=1.101, ntokens=395, nsentences=32, sample_size=314.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878031, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.297, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.278, expert1_balance_top=35.234, expert1_balance_bottom=18.418, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=222.3, ups=0.56, wpb=395, bsz=32, num_updates=14250, lr=6.35853e-06, gnorm=3.441, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26117
2022-05-08 03:41:34 - progress_bar.py[line:272] - INFO: epoch 001:  14280 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=390.3, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.754, expert1_balance_bottom=18.593, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=216.8, ups=0.56, wpb=390.3, bsz=32, num_updates=14260, lr=6.35553e-06, gnorm=3.103, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26135
2022-05-08 03:41:51 - progress_bar.py[line:272] - INFO: epoch 001:  14290 / 17711 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=378.7, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881407, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.22, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.277, expert1_balance_top=35.117, expert1_balance_bottom=18.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=217.1, ups=0.57, wpb=378.7, bsz=32, num_updates=14270, lr=6.35252e-06, gnorm=3.994, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26152
2022-05-08 03:42:09 - progress_bar.py[line:272] - INFO: epoch 001:  14300 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=372.3, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.281, expert1_balance_top=34.176, expert1_balance_bottom=18.728, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=213.3, ups=0.57, wpb=372.3, bsz=32, num_updates=14280, lr=6.34952e-06, gnorm=3.224, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26170
2022-05-08 03:42:26 - progress_bar.py[line:272] - INFO: epoch 001:  14310 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.278, expert1_balance_top=34.684, expert1_balance_bottom=18.735, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=217.9, ups=0.58, wpb=378.2, bsz=32, num_updates=14290, lr=6.34652e-06, gnorm=2.99, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26187
2022-05-08 03:42:44 - progress_bar.py[line:272] - INFO: epoch 001:  14320 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=380.2, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883847, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=35.058, expert1_balance_bottom=18.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=213.9, ups=0.56, wpb=380.2, bsz=32, num_updates=14300, lr=6.34351e-06, gnorm=4.14, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26205
2022-05-08 03:43:02 - progress_bar.py[line:272] - INFO: epoch 001:  14330 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=371.2, nsentences=32, sample_size=295.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.282, expert1_balance_top=33.937, expert1_balance_bottom=18.811, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=212.3, ups=0.57, wpb=371.2, bsz=32, num_updates=14310, lr=6.34051e-06, gnorm=3.806, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=26222
2022-05-08 03:43:19 - progress_bar.py[line:272] - INFO: epoch 001:  14340 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889617, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.659, expert1_balance_bottom=18.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217.9, ups=0.57, wpb=383.9, bsz=32, num_updates=14320, lr=6.33751e-06, gnorm=3.305, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26240
2022-05-08 03:43:37 - progress_bar.py[line:272] - INFO: epoch 001:  14350 / 17711 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=374.5, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.209, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.277, expert1_balance_top=35.253, expert1_balance_bottom=18.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=211.2, ups=0.56, wpb=374.5, bsz=32, num_updates=14330, lr=6.3345e-06, gnorm=3.164, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26258
2022-05-08 03:43:54 - progress_bar.py[line:272] - INFO: epoch 001:  14360 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=388.5, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879374, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.277, expert1_balance_top=35.088, expert1_balance_bottom=18.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=225.3, ups=0.58, wpb=388.5, bsz=32, num_updates=14340, lr=6.3315e-06, gnorm=3.311, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26275
2022-05-08 03:44:11 - progress_bar.py[line:272] - INFO: epoch 001:  14370 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.998, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.278, expert1_balance_top=35.356, expert1_balance_bottom=18.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=224, ups=0.58, wpb=383.5, bsz=32, num_updates=14350, lr=6.3285e-06, gnorm=3.33, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26292
2022-05-08 03:44:28 - progress_bar.py[line:272] - INFO: epoch 001:  14380 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.278, expert1_balance_top=34.716, expert1_balance_bottom=18.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=225.4, ups=0.59, wpb=382.1, bsz=32, num_updates=14360, lr=6.32549e-06, gnorm=3.584, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26309
2022-05-08 03:44:46 - progress_bar.py[line:272] - INFO: epoch 001:  14390 / 17711 loss=3.28, loss_v1=0, loss_v2=0, nll_loss=1.063, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889631, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.28, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.446, expert1_balance_bottom=18.784, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=218.1, ups=0.58, wpb=379.2, bsz=32, num_updates=14370, lr=6.32249e-06, gnorm=2.835, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26326
2022-05-08 03:45:03 - progress_bar.py[line:272] - INFO: epoch 001:  14400 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=374.5, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.721, expert1_balance_bottom=18.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=215.6, ups=0.58, wpb=374.5, bsz=32, num_updates=14380, lr=6.31949e-06, gnorm=2.957, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26344
2022-05-08 03:45:20 - progress_bar.py[line:272] - INFO: epoch 001:  14410 / 17711 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=1.047, ntokens=383.1, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.863878, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.237, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=36.11, expert1_balance_bottom=18.22, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=219.3, ups=0.57, wpb=383.1, bsz=32, num_updates=14390, lr=6.31648e-06, gnorm=3.548, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26361
2022-05-08 03:45:38 - progress_bar.py[line:272] - INFO: epoch 001:  14420 / 17711 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886509, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.23, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.964, expert1_balance_bottom=18.46, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=216.4, ups=0.57, wpb=380.7, bsz=32, num_updates=14400, lr=6.31348e-06, gnorm=3.409, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26379
2022-05-08 03:45:55 - progress_bar.py[line:272] - INFO: epoch 001:  14430 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87354, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=35.711, expert1_balance_bottom=18.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=220.7, ups=0.57, wpb=385.5, bsz=32, num_updates=14410, lr=6.31048e-06, gnorm=3.421, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26396
2022-05-08 03:46:13 - progress_bar.py[line:272] - INFO: epoch 001:  14440 / 17711 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=1.051, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878625, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.253, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=35.15, expert1_balance_bottom=18.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=215.5, ups=0.57, wpb=379.9, bsz=32, num_updates=14420, lr=6.30748e-06, gnorm=3.109, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26414
2022-05-08 03:46:31 - progress_bar.py[line:272] - INFO: epoch 001:  14450 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=380, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903235, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.28, expert1_balance_top=34.042, expert1_balance_bottom=18.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=216.1, ups=0.57, wpb=380, bsz=32, num_updates=14430, lr=6.30447e-06, gnorm=3.187, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26431
2022-05-08 03:46:48 - progress_bar.py[line:272] - INFO: epoch 001:  14460 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.278, expert1_balance_top=34.756, expert1_balance_bottom=18.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=218.6, ups=0.57, wpb=381.6, bsz=32, num_updates=14440, lr=6.30147e-06, gnorm=3.161, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26449
2022-05-08 03:47:06 - progress_bar.py[line:272] - INFO: epoch 001:  14470 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.275, expert1_balance_top=35.42, expert1_balance_bottom=18.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=218.6, ups=0.58, wpb=379.3, bsz=32, num_updates=14450, lr=6.29847e-06, gnorm=2.667, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26466
2022-05-08 03:47:23 - progress_bar.py[line:272] - INFO: epoch 001:  14480 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.278, expert1_balance_top=34.356, expert1_balance_bottom=18.77, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=218.6, ups=0.58, wpb=378, bsz=32, num_updates=14460, lr=6.29546e-06, gnorm=2.936, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=26484
2022-05-08 03:47:40 - progress_bar.py[line:272] - INFO: epoch 001:  14490 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.027, ntokens=390.1, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=35.343, expert1_balance_bottom=18.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=225.3, ups=0.58, wpb=390.1, bsz=32, num_updates=14470, lr=6.29246e-06, gnorm=3.448, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26501
2022-05-08 03:47:58 - progress_bar.py[line:272] - INFO: epoch 001:  14500 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=382.9, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.598, expert1_balance_bottom=18.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=219.6, ups=0.57, wpb=382.9, bsz=32, num_updates=14480, lr=6.28946e-06, gnorm=3.724, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26518
2022-05-08 03:48:06 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 03:48:17 - progress_bar.py[line:272] - INFO: epoch 001:  14511 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=379.6, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=34.778, expert1_balance_bottom=18.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=197.1, ups=0.52, wpb=379.6, bsz=32, num_updates=14490, lr=6.28645e-06, gnorm=3.331, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26538
2022-05-08 03:48:35 - progress_bar.py[line:272] - INFO: epoch 001:  14521 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=378.3, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=33.931, expert1_balance_bottom=18.841, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.5, ups=0.56, wpb=378.3, bsz=32, num_updates=14500, lr=6.28345e-06, gnorm=3.174, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26555
2022-05-08 03:48:52 - progress_bar.py[line:272] - INFO: epoch 001:  14531 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894155, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.278, expert1_balance_top=34.312, expert1_balance_bottom=18.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=219.3, ups=0.57, wpb=381.9, bsz=32, num_updates=14510, lr=6.28045e-06, gnorm=3.381, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26573
2022-05-08 03:49:09 - progress_bar.py[line:272] - INFO: epoch 001:  14541 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=390.6, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890822, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=34.394, expert1_balance_bottom=18.835, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223, ups=0.57, wpb=390.6, bsz=32, num_updates=14520, lr=6.27744e-06, gnorm=4.164, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26590
2022-05-08 03:49:27 - progress_bar.py[line:272] - INFO: epoch 001:  14551 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=384.6, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.279, expert1_balance_top=34.388, expert1_balance_bottom=18.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=222, ups=0.58, wpb=384.6, bsz=32, num_updates=14530, lr=6.27444e-06, gnorm=3.746, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26608
2022-05-08 03:49:44 - progress_bar.py[line:272] - INFO: epoch 001:  14561 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=391.6, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.275, expert1_balance_top=34.424, expert1_balance_bottom=18.789, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=227.8, ups=0.58, wpb=391.6, bsz=32, num_updates=14540, lr=6.27144e-06, gnorm=3.618, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=26625
2022-05-08 03:50:01 - progress_bar.py[line:272] - INFO: epoch 001:  14571 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.275, expert1_balance_top=36.044, expert1_balance_bottom=18.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=224.2, ups=0.58, wpb=384.7, bsz=32, num_updates=14550, lr=6.26843e-06, gnorm=3.857, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26642
2022-05-08 03:50:18 - progress_bar.py[line:272] - INFO: epoch 001:  14581 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=379, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884475, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=34.62, expert1_balance_bottom=18.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=223.3, ups=0.59, wpb=379, bsz=32, num_updates=14560, lr=6.26543e-06, gnorm=2.852, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=26659
2022-05-08 03:50:35 - progress_bar.py[line:272] - INFO: epoch 001:  14591 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.991, ntokens=376.9, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.277, expert1_balance_top=34.398, expert1_balance_bottom=18.79, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=221.2, ups=0.59, wpb=376.9, bsz=32, num_updates=14570, lr=6.26243e-06, gnorm=3.111, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26676
2022-05-08 03:50:52 - progress_bar.py[line:272] - INFO: epoch 001:  14601 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=34.373, expert1_balance_bottom=18.767, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=222.9, ups=0.58, wpb=383.9, bsz=32, num_updates=14580, lr=6.25942e-06, gnorm=3.117, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26693
2022-05-08 03:51:09 - progress_bar.py[line:272] - INFO: epoch 001:  14611 / 17711 loss=3.217, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=380.3, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.217, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=34.613, expert1_balance_bottom=18.609, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=222.6, ups=0.59, wpb=380.3, bsz=32, num_updates=14590, lr=6.25642e-06, gnorm=3.147, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26710
2022-05-08 03:51:27 - progress_bar.py[line:272] - INFO: epoch 001:  14621 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=380.1, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885459, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=34.834, expert1_balance_bottom=18.595, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=222.5, ups=0.59, wpb=380.1, bsz=32, num_updates=14600, lr=6.25342e-06, gnorm=3.529, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26727
2022-05-08 03:51:44 - progress_bar.py[line:272] - INFO: epoch 001:  14631 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.992, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=34.732, expert1_balance_bottom=18.603, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=222.5, ups=0.58, wpb=380.4, bsz=32, num_updates=14610, lr=6.25041e-06, gnorm=3.515, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26744
2022-05-08 03:52:01 - progress_bar.py[line:272] - INFO: epoch 001:  14641 / 17711 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=1.015, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.229, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=34.378, expert1_balance_bottom=18.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=223.6, ups=0.58, wpb=383.2, bsz=32, num_updates=14620, lr=6.24741e-06, gnorm=2.825, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26762
2022-05-08 03:52:18 - progress_bar.py[line:272] - INFO: epoch 001:  14651 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899646, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.278, expert1_balance_top=34.112, expert1_balance_bottom=18.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220, ups=0.58, wpb=378.6, bsz=32, num_updates=14630, lr=6.24441e-06, gnorm=3.391, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26779
2022-05-08 03:52:35 - progress_bar.py[line:272] - INFO: epoch 001:  14661 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=1.018, ntokens=392.7, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=35.536, expert1_balance_bottom=18.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=227.2, ups=0.58, wpb=392.7, bsz=32, num_updates=14640, lr=6.2414e-06, gnorm=3.46, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26796
2022-05-08 03:52:53 - progress_bar.py[line:272] - INFO: epoch 001:  14671 / 17711 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=382.8, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897943, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.171, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.277, expert1_balance_top=34.126, expert1_balance_bottom=18.889, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220.4, ups=0.58, wpb=382.8, bsz=32, num_updates=14650, lr=6.2384e-06, gnorm=3.33, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26813
2022-05-08 03:53:10 - progress_bar.py[line:272] - INFO: epoch 001:  14681 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=386.9, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=35.012, expert1_balance_bottom=18.608, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=228.1, ups=0.59, wpb=386.9, bsz=32, num_updates=14660, lr=6.2354e-06, gnorm=3.491, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26830
2022-05-08 03:53:27 - progress_bar.py[line:272] - INFO: epoch 001:  14691 / 17711 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=1.037, ntokens=385.5, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.247, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.275, expert1_balance_top=34.582, expert1_balance_bottom=18.864, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=223.6, ups=0.58, wpb=385.5, bsz=32, num_updates=14670, lr=6.23239e-06, gnorm=3.247, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26848
2022-05-08 03:53:44 - progress_bar.py[line:272] - INFO: epoch 001:  14701 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.277, expert1_balance_top=34.408, expert1_balance_bottom=18.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=222, ups=0.58, wpb=383.4, bsz=32, num_updates=14680, lr=6.22939e-06, gnorm=3.353, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26865
2022-05-08 03:54:02 - progress_bar.py[line:272] - INFO: epoch 001:  14711 / 17711 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.959, ntokens=379.1, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875991, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.171, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=35.466, expert1_balance_bottom=18.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=215, ups=0.57, wpb=379.1, bsz=32, num_updates=14690, lr=6.22639e-06, gnorm=3.326, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26883
2022-05-08 03:54:19 - progress_bar.py[line:272] - INFO: epoch 001:  14721 / 17711 loss=3.217, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=388.3, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891263, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.217, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.277, expert1_balance_top=34.246, expert1_balance_bottom=18.729, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=220.5, ups=0.57, wpb=388.3, bsz=32, num_updates=14700, lr=6.22338e-06, gnorm=3.717, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26900
2022-05-08 03:54:37 - progress_bar.py[line:272] - INFO: epoch 001:  14731 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.997, ntokens=388.7, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885702, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=35.283, expert1_balance_bottom=18.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=223.9, ups=0.58, wpb=388.7, bsz=32, num_updates=14710, lr=6.22038e-06, gnorm=3.132, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26917
2022-05-08 03:54:54 - progress_bar.py[line:272] - INFO: epoch 001:  14741 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881231, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=35.477, expert1_balance_bottom=18.42, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221.8, ups=0.58, wpb=385.3, bsz=32, num_updates=14720, lr=6.21738e-06, gnorm=3.744, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26935
2022-05-08 03:55:12 - progress_bar.py[line:272] - INFO: epoch 001:  14751 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.959, ntokens=391.5, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884961, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=35.046, expert1_balance_bottom=18.542, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=223.6, ups=0.57, wpb=391.5, bsz=32, num_updates=14730, lr=6.21437e-06, gnorm=3.54, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26952
2022-05-08 03:55:29 - progress_bar.py[line:272] - INFO: epoch 001:  14761 / 17711 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=1.037, ntokens=382.9, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874181, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.243, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=35.547, expert1_balance_bottom=18.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=217.7, ups=0.57, wpb=382.9, bsz=32, num_updates=14740, lr=6.21137e-06, gnorm=3.802, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26970
2022-05-08 03:55:46 - progress_bar.py[line:272] - INFO: epoch 001:  14771 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=390.2, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=35.47, expert1_balance_bottom=18.593, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=228.4, ups=0.59, wpb=390.2, bsz=32, num_updates=14750, lr=6.20837e-06, gnorm=3.775, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=26987
2022-05-08 03:56:03 - progress_bar.py[line:272] - INFO: epoch 001:  14781 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.993, ntokens=381.3, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883283, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=34.719, expert1_balance_bottom=18.616, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.9, ups=0.59, wpb=381.3, bsz=32, num_updates=14760, lr=6.20536e-06, gnorm=3.947, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=27004
2022-05-08 03:56:20 - progress_bar.py[line:272] - INFO: epoch 001:  14791 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=375.6, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=34.557, expert1_balance_bottom=18.719, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=217.8, ups=0.58, wpb=375.6, bsz=32, num_updates=14770, lr=6.20236e-06, gnorm=3.9, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27021
2022-05-08 03:56:38 - progress_bar.py[line:272] - INFO: epoch 001:  14801 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=383.3, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881611, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=34.945, expert1_balance_bottom=18.651, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=219.2, ups=0.57, wpb=383.3, bsz=32, num_updates=14780, lr=6.19936e-06, gnorm=3.32, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27039
2022-05-08 03:56:55 - progress_bar.py[line:272] - INFO: epoch 001:  14811 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=378.5, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877496, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=35.554, expert1_balance_bottom=18.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220.1, ups=0.58, wpb=378.5, bsz=32, num_updates=14790, lr=6.19635e-06, gnorm=4.081, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27056
2022-05-08 03:57:13 - progress_bar.py[line:272] - INFO: epoch 001:  14821 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=389.3, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885633, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=35.054, expert1_balance_bottom=18.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=222.4, ups=0.57, wpb=389.3, bsz=32, num_updates=14800, lr=6.19335e-06, gnorm=2.952, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27073
2022-05-08 03:57:30 - progress_bar.py[line:272] - INFO: epoch 001:  14831 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888169, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=34.528, expert1_balance_bottom=18.881, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221.8, ups=0.58, wpb=384.7, bsz=32, num_updates=14810, lr=6.19035e-06, gnorm=3.644, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=27091
2022-05-08 03:57:47 - progress_bar.py[line:272] - INFO: epoch 001:  14841 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=389.2, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.275, expert1_balance_top=35.062, expert1_balance_bottom=18.61, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.8, ups=0.57, wpb=389.2, bsz=32, num_updates=14820, lr=6.18734e-06, gnorm=2.734, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27108
2022-05-08 03:58:05 - progress_bar.py[line:272] - INFO: epoch 001:  14851 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=1.035, ntokens=390.6, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=36.214, expert1_balance_bottom=18.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=221.2, ups=0.57, wpb=390.6, bsz=32, num_updates=14830, lr=6.18434e-06, gnorm=3.104, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27126
2022-05-08 03:58:23 - progress_bar.py[line:272] - INFO: epoch 001:  14861 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=382.1, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=34.317, expert1_balance_bottom=18.856, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=218.7, ups=0.57, wpb=382.1, bsz=32, num_updates=14840, lr=6.18134e-06, gnorm=3.052, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27143
2022-05-08 03:58:40 - progress_bar.py[line:272] - INFO: epoch 001:  14871 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=1.019, ntokens=379.6, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=35.439, expert1_balance_bottom=18.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=216.7, ups=0.57, wpb=379.6, bsz=32, num_updates=14850, lr=6.17833e-06, gnorm=3.728, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27161
2022-05-08 03:58:57 - progress_bar.py[line:272] - INFO: epoch 001:  14881 / 17711 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886224, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.199, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=34.77, expert1_balance_bottom=18.624, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=223.3, ups=0.58, wpb=383.1, bsz=32, num_updates=14860, lr=6.17533e-06, gnorm=3.631, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27178
2022-05-08 03:59:15 - progress_bar.py[line:272] - INFO: epoch 001:  14891 / 17711 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885249, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.185, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=35.178, expert1_balance_bottom=18.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=222.1, ups=0.58, wpb=385.9, bsz=32, num_updates=14870, lr=6.17233e-06, gnorm=4.08, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27195
2022-05-08 03:59:32 - progress_bar.py[line:272] - INFO: epoch 001:  14901 / 17711 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=1.075, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882331, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.282, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=34.744, expert1_balance_bottom=18.799, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.11, wps=220.1, ups=0.57, wpb=386.8, bsz=32, num_updates=14880, lr=6.16932e-06, gnorm=3.402, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27213
2022-05-08 03:59:50 - progress_bar.py[line:272] - INFO: epoch 001:  14911 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=368.7, nsentences=32, sample_size=293.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897125, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=34.526, expert1_balance_bottom=18.641, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=211, ups=0.57, wpb=368.7, bsz=32, num_updates=14890, lr=6.16632e-06, gnorm=3.334, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27230
2022-05-08 04:00:07 - progress_bar.py[line:272] - INFO: epoch 001:  14921 / 17711 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877211, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.214, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=35.39, expert1_balance_bottom=18.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=219.4, ups=0.58, wpb=379.9, bsz=32, num_updates=14900, lr=6.16332e-06, gnorm=3.534, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27248
2022-05-08 04:00:24 - progress_bar.py[line:272] - INFO: epoch 001:  14931 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=379.8, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88944, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=34.799, expert1_balance_bottom=18.584, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=218.1, ups=0.57, wpb=379.8, bsz=32, num_updates=14910, lr=6.16031e-06, gnorm=3.399, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27265
2022-05-08 04:00:42 - progress_bar.py[line:272] - INFO: epoch 001:  14941 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882614, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=34.922, expert1_balance_bottom=18.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=221.3, ups=0.57, wpb=386.3, bsz=32, num_updates=14920, lr=6.15731e-06, gnorm=3.183, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27283
2022-05-08 04:01:00 - progress_bar.py[line:272] - INFO: epoch 001:  14951 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=391.5, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=34.888, expert1_balance_bottom=18.613, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=219.6, ups=0.56, wpb=391.5, bsz=32, num_updates=14930, lr=6.15431e-06, gnorm=2.627, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27301
2022-05-08 04:01:18 - progress_bar.py[line:272] - INFO: epoch 001:  14961 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=386.4, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886905, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=34.833, expert1_balance_bottom=18.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=217.3, ups=0.56, wpb=386.4, bsz=32, num_updates=14940, lr=6.1513e-06, gnorm=3.44, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27318
2022-05-08 04:01:35 - progress_bar.py[line:272] - INFO: epoch 001:  14971 / 17711 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=1.011, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.225, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=35.43, expert1_balance_bottom=18.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=216.4, ups=0.57, wpb=381.6, bsz=32, num_updates=14950, lr=6.1483e-06, gnorm=3.597, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27336
2022-05-08 04:01:52 - progress_bar.py[line:272] - INFO: epoch 001:  14981 / 17711 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=1.024, ntokens=378.1, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.247, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=34.36, expert1_balance_bottom=18.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=218.7, ups=0.58, wpb=378.1, bsz=32, num_updates=14960, lr=6.1453e-06, gnorm=3.51, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27353
2022-05-08 04:02:10 - progress_bar.py[line:272] - INFO: epoch 001:  14991 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=375.4, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.276, expert1_balance_top=33.795, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=215.7, ups=0.57, wpb=375.4, bsz=32, num_updates=14970, lr=6.1423e-06, gnorm=2.79, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27371
2022-05-08 04:02:27 - progress_bar.py[line:272] - INFO: epoch 001:  15001 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.961, ntokens=378.9, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886804, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=34.761, expert1_balance_bottom=18.712, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=218.4, ups=0.58, wpb=378.9, bsz=32, num_updates=14980, lr=6.13929e-06, gnorm=3.215, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27388
2022-05-08 04:02:45 - progress_bar.py[line:272] - INFO: epoch 001:  15011 / 17711 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.989, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.209, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=34.945, expert1_balance_bottom=18.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=219.9, ups=0.57, wpb=383.8, bsz=32, num_updates=14990, lr=6.13629e-06, gnorm=3.022, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27405
2022-05-08 04:03:02 - progress_bar.py[line:272] - INFO: epoch 001:  15021 / 17711 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=1.002, ntokens=388.3, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.209, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=35.432, expert1_balance_bottom=18.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=222.4, ups=0.57, wpb=388.3, bsz=32, num_updates=15000, lr=6.13329e-06, gnorm=3.103, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27423
2022-05-08 04:03:02 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 04:03:02 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 04:03:02 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 04:10:19 - train.py[line:517] - INFO: valid_step finished
2022-05-08 04:10:19 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.036 | loss_v1 0 | loss_v2 0 | nll_loss 7.318 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.965689 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.036 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.3 | expert1_balance_top 36.26 | expert1_balance_bottom 14.7 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 159.57 | cider 1.164 | wps 689.5 | wpb 481.7 | bsz 8 | num_updates 15000 | best_cider 1.164
2022-05-08 04:10:19 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 1 @ 15000 updates
2022-05-08 04:10:19 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_15000-rank-0.pt
2022-05-08 04:10:19 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_15000-rank-0.pt
2022-05-08 04:10:27 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_15000-rank-0.pt
2022-05-08 04:10:27 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_15000-shared.pt
2022-05-08 04:10:35 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_15000-shared.pt
2022-05-08 04:11:07 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_1_15000-rank-0.pt (epoch 1 @ 15000 updates, score 1.164) (writing took 47.41483986657113 seconds)
2022-05-08 04:11:24 - progress_bar.py[line:272] - INFO: epoch 001:  15031 / 17711 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=375.3, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.209, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=35.311, expert1_balance_bottom=18.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=7.5, ups=0.02, wpb=375.3, bsz=32, num_updates=15010, lr=6.13028e-06, gnorm=3.284, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27925
2022-05-08 04:11:41 - progress_bar.py[line:272] - INFO: epoch 001:  15041 / 17711 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891855, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.189, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.275, expert1_balance_top=34.679, expert1_balance_bottom=18.731, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=221.8, ups=0.58, wpb=382.2, bsz=32, num_updates=15020, lr=6.12728e-06, gnorm=3.628, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27942
2022-05-08 04:11:59 - progress_bar.py[line:272] - INFO: epoch 001:  15051 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=386, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=34.983, expert1_balance_bottom=18.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=220.9, ups=0.57, wpb=386, bsz=32, num_updates=15030, lr=6.12428e-06, gnorm=3.155, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27960
2022-05-08 04:12:16 - progress_bar.py[line:272] - INFO: epoch 001:  15061 / 17711 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.199, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=35.289, expert1_balance_bottom=18.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=221.2, ups=0.58, wpb=381.7, bsz=32, num_updates=15040, lr=6.12127e-06, gnorm=2.973, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27977
2022-05-08 04:12:25 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 04:12:35 - progress_bar.py[line:272] - INFO: epoch 001:  15072 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=383.4, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=34.66, expert1_balance_bottom=18.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=201.3, ups=0.53, wpb=383.4, bsz=32, num_updates=15050, lr=6.11827e-06, gnorm=3.553, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=27996
2022-05-08 04:12:53 - progress_bar.py[line:272] - INFO: epoch 001:  15082 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=392.3, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=34.737, expert1_balance_bottom=18.734, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=226.5, ups=0.58, wpb=392.3, bsz=32, num_updates=15060, lr=6.11527e-06, gnorm=3.344, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28013
2022-05-08 04:13:10 - progress_bar.py[line:272] - INFO: epoch 001:  15092 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=391.3, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876064, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=35.363, expert1_balance_bottom=18.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=225.8, ups=0.58, wpb=391.3, bsz=32, num_updates=15070, lr=6.11226e-06, gnorm=3.466, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28031
2022-05-08 04:13:27 - progress_bar.py[line:272] - INFO: epoch 001:  15102 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.975, ntokens=388.4, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=34.959, expert1_balance_bottom=18.454, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=225.6, ups=0.58, wpb=388.4, bsz=32, num_updates=15080, lr=6.10926e-06, gnorm=3.301, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28048
2022-05-08 04:13:44 - progress_bar.py[line:272] - INFO: epoch 001:  15112 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=34.341, expert1_balance_bottom=18.852, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.2, ups=0.58, wpb=383, bsz=32, num_updates=15090, lr=6.10626e-06, gnorm=3.122, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28065
2022-05-08 04:14:02 - progress_bar.py[line:272] - INFO: epoch 001:  15122 / 17711 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=1.007, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.225, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=34.556, expert1_balance_bottom=18.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=219.5, ups=0.57, wpb=382.4, bsz=32, num_updates=15100, lr=6.10325e-06, gnorm=3.919, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28083
2022-05-08 04:14:19 - progress_bar.py[line:272] - INFO: epoch 001:  15132 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885841, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=35.054, expert1_balance_bottom=18.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=216.7, ups=0.57, wpb=381.3, bsz=32, num_updates=15110, lr=6.10025e-06, gnorm=3.208, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28100
2022-05-08 04:14:37 - progress_bar.py[line:272] - INFO: epoch 001:  15142 / 17711 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=374.7, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891338, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.216, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=34.21, expert1_balance_bottom=18.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=214, ups=0.57, wpb=374.7, bsz=32, num_updates=15120, lr=6.09725e-06, gnorm=3.191, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28118
2022-05-08 04:14:54 - progress_bar.py[line:272] - INFO: epoch 001:  15152 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=390.3, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883286, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=34.759, expert1_balance_bottom=18.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=224.1, ups=0.57, wpb=390.3, bsz=32, num_updates=15130, lr=6.09424e-06, gnorm=3.108, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28135
2022-05-08 04:15:12 - progress_bar.py[line:272] - INFO: epoch 001:  15162 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=1.009, ntokens=391.4, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.274, expert1_balance_top=34.528, expert1_balance_bottom=18.763, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=221.5, ups=0.57, wpb=391.4, bsz=32, num_updates=15140, lr=6.09124e-06, gnorm=3.912, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28153
2022-05-08 04:15:29 - progress_bar.py[line:272] - INFO: epoch 001:  15172 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=386.9, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.379, expert1_balance_bottom=18.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220.9, ups=0.57, wpb=386.9, bsz=32, num_updates=15150, lr=6.08824e-06, gnorm=3.439, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28170
2022-05-08 04:15:47 - progress_bar.py[line:272] - INFO: epoch 001:  15182 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=382.1, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879392, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=35.125, expert1_balance_bottom=18.674, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=215.7, ups=0.56, wpb=382.1, bsz=32, num_updates=15160, lr=6.08523e-06, gnorm=3.029, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28188
2022-05-08 04:16:05 - progress_bar.py[line:272] - INFO: epoch 001:  15192 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889318, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=34.159, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=221.3, ups=0.58, wpb=384.9, bsz=32, num_updates=15170, lr=6.08223e-06, gnorm=2.803, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28205
2022-05-08 04:16:22 - progress_bar.py[line:272] - INFO: epoch 001:  15202 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=390, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886622, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=34.353, expert1_balance_bottom=18.73, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223.3, ups=0.57, wpb=390, bsz=32, num_updates=15180, lr=6.07923e-06, gnorm=3.404, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28223
2022-05-08 04:16:40 - progress_bar.py[line:272] - INFO: epoch 001:  15212 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.979, ntokens=374.3, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888078, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=34.785, expert1_balance_bottom=18.605, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=214.4, ups=0.57, wpb=374.3, bsz=32, num_updates=15190, lr=6.07622e-06, gnorm=3.456, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28240
2022-05-08 04:16:57 - progress_bar.py[line:272] - INFO: epoch 001:  15222 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=375.4, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=35.366, expert1_balance_bottom=18.583, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=217.7, ups=0.58, wpb=375.4, bsz=32, num_updates=15200, lr=6.07322e-06, gnorm=3.23, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28258
2022-05-08 04:17:14 - progress_bar.py[line:272] - INFO: epoch 001:  15232 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=374.9, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=34.567, expert1_balance_bottom=18.855, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=214.5, ups=0.57, wpb=374.9, bsz=32, num_updates=15210, lr=6.07022e-06, gnorm=3.438, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28275
2022-05-08 04:17:32 - progress_bar.py[line:272] - INFO: epoch 001:  15242 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=381.4, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.275, expert1_balance_top=34.387, expert1_balance_bottom=18.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=216.5, ups=0.57, wpb=381.4, bsz=32, num_updates=15220, lr=6.06721e-06, gnorm=3.486, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28293
2022-05-08 04:17:49 - progress_bar.py[line:272] - INFO: epoch 001:  15252 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.275, expert1_balance_top=33.629, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=217.3, ups=0.57, wpb=377.9, bsz=32, num_updates=15230, lr=6.06421e-06, gnorm=3.495, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28310
2022-05-08 04:18:06 - progress_bar.py[line:272] - INFO: epoch 001:  15262 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=389, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882532, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=35.016, expert1_balance_bottom=18.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=228.4, ups=0.59, wpb=389, bsz=32, num_updates=15240, lr=6.06121e-06, gnorm=4.289, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28327
2022-05-08 04:18:23 - progress_bar.py[line:272] - INFO: epoch 001:  15272 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=1, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=36.135, expert1_balance_bottom=18.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=229, ups=0.6, wpb=383.8, bsz=32, num_updates=15250, lr=6.0582e-06, gnorm=3.04, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28344
2022-05-08 04:18:40 - progress_bar.py[line:272] - INFO: epoch 001:  15282 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=386.3, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.103, expert1_balance_bottom=18.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.5, ups=0.58, wpb=386.3, bsz=32, num_updates=15260, lr=6.0552e-06, gnorm=2.876, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28361
2022-05-08 04:18:58 - progress_bar.py[line:272] - INFO: epoch 001:  15292 / 17711 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.206, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=35.092, expert1_balance_bottom=18.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=219.5, ups=0.57, wpb=383.9, bsz=32, num_updates=15270, lr=6.0522e-06, gnorm=3.375, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28379
2022-05-08 04:19:15 - progress_bar.py[line:272] - INFO: epoch 001:  15302 / 17711 loss=3.26, loss_v1=0, loss_v2=0, nll_loss=1.038, ntokens=379.4, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.26, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=34.415, expert1_balance_bottom=18.685, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=220.8, ups=0.58, wpb=379.4, bsz=32, num_updates=15280, lr=6.04919e-06, gnorm=3.528, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28396
2022-05-08 04:19:32 - progress_bar.py[line:272] - INFO: epoch 001:  15312 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886578, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=34.67, expert1_balance_bottom=18.609, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221.9, ups=0.58, wpb=385.3, bsz=32, num_updates=15290, lr=6.04619e-06, gnorm=2.995, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28413
2022-05-08 04:19:49 - progress_bar.py[line:272] - INFO: epoch 001:  15322 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=386.7, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.129, expert1_balance_bottom=18.452, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=225.9, ups=0.58, wpb=386.7, bsz=32, num_updates=15300, lr=6.04319e-06, gnorm=3.445, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28430
2022-05-08 04:20:07 - progress_bar.py[line:272] - INFO: epoch 001:  15332 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=399.8, nsentences=32, sample_size=318.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.861607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=36.543, expert1_balance_bottom=17.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=231.2, ups=0.58, wpb=399.8, bsz=32, num_updates=15310, lr=6.04018e-06, gnorm=3.276, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28447
2022-05-08 04:20:24 - progress_bar.py[line:272] - INFO: epoch 001:  15342 / 17711 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=1.011, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883839, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.22, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.324, expert1_balance_bottom=18.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=218.7, ups=0.58, wpb=380, bsz=32, num_updates=15320, lr=6.03718e-06, gnorm=3.358, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28465
2022-05-08 04:20:42 - progress_bar.py[line:272] - INFO: epoch 001:  15352 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=386.6, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884974, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.005, expert1_balance_bottom=18.751, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=220, ups=0.57, wpb=386.6, bsz=32, num_updates=15330, lr=6.03418e-06, gnorm=3.134, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28482
2022-05-08 04:20:59 - progress_bar.py[line:272] - INFO: epoch 001:  15362 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=35.218, expert1_balance_bottom=18.64, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.7, ups=0.57, wpb=381.7, bsz=32, num_updates=15340, lr=6.03117e-06, gnorm=3.275, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28500
2022-05-08 04:21:16 - progress_bar.py[line:272] - INFO: epoch 001:  15372 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=385, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882524, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.349, expert1_balance_bottom=18.604, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=222.3, ups=0.58, wpb=385, bsz=32, num_updates=15350, lr=6.02817e-06, gnorm=3.192, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28517
2022-05-08 04:21:34 - progress_bar.py[line:272] - INFO: epoch 001:  15382 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877624, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.409, expert1_balance_bottom=18.586, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=219.9, ups=0.58, wpb=380.9, bsz=32, num_updates=15360, lr=6.02517e-06, gnorm=2.94, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28535
2022-05-08 04:21:51 - progress_bar.py[line:272] - INFO: epoch 001:  15392 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=383.5, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=34.712, expert1_balance_bottom=18.88, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.4, ups=0.58, wpb=383.5, bsz=32, num_updates=15370, lr=6.02216e-06, gnorm=3.103, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28552
2022-05-08 04:22:08 - progress_bar.py[line:272] - INFO: epoch 001:  15402 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=370.7, nsentences=32, sample_size=294.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.272, expert1_balance_top=33.817, expert1_balance_bottom=18.99, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=219.1, ups=0.59, wpb=370.7, bsz=32, num_updates=15380, lr=6.01916e-06, gnorm=3.236, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=28569
2022-05-08 04:22:25 - progress_bar.py[line:272] - INFO: epoch 001:  15412 / 17711 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=388.9, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883255, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.211, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=35.063, expert1_balance_bottom=18.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=228.7, ups=0.59, wpb=388.9, bsz=32, num_updates=15390, lr=6.01616e-06, gnorm=3.595, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28586
2022-05-08 04:22:42 - progress_bar.py[line:272] - INFO: epoch 001:  15422 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=383.8, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886807, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=35.235, expert1_balance_bottom=18.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=220.2, ups=0.57, wpb=383.8, bsz=32, num_updates=15400, lr=6.01315e-06, gnorm=3.802, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28603
2022-05-08 04:23:00 - progress_bar.py[line:272] - INFO: epoch 001:  15432 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=1.018, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.182, expert1_balance_bottom=18.609, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=222, ups=0.58, wpb=383.1, bsz=32, num_updates=15410, lr=6.01015e-06, gnorm=3.414, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=28620
2022-05-08 04:23:17 - progress_bar.py[line:272] - INFO: epoch 001:  15442 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=396.5, nsentences=32, sample_size=315.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.081, expert1_balance_bottom=18.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=230.7, ups=0.58, wpb=396.5, bsz=32, num_updates=15420, lr=6.00715e-06, gnorm=3.33, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28638
2022-05-08 04:23:34 - progress_bar.py[line:272] - INFO: epoch 001:  15452 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885765, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=35.18, expert1_balance_bottom=18.446, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222.3, ups=0.58, wpb=380.6, bsz=32, num_updates=15430, lr=6.00414e-06, gnorm=3.14, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28655
2022-05-08 04:23:51 - progress_bar.py[line:272] - INFO: epoch 001:  15462 / 17711 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=376.3, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.241, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=34.673, expert1_balance_bottom=18.722, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=220, ups=0.58, wpb=376.3, bsz=32, num_updates=15440, lr=6.00114e-06, gnorm=3.356, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28672
2022-05-08 04:24:08 - progress_bar.py[line:272] - INFO: epoch 001:  15472 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=382.2, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=35.354, expert1_balance_bottom=18.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.6, ups=0.59, wpb=382.2, bsz=32, num_updates=15450, lr=5.99814e-06, gnorm=3.048, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=28689
2022-05-08 04:24:25 - progress_bar.py[line:272] - INFO: epoch 001:  15482 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=34.216, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.3, ups=0.59, wpb=376.7, bsz=32, num_updates=15460, lr=5.99513e-06, gnorm=3.168, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28706
2022-05-08 04:24:42 - progress_bar.py[line:272] - INFO: epoch 001:  15492 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.966, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=35.036, expert1_balance_bottom=18.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=222.4, ups=0.58, wpb=385.3, bsz=32, num_updates=15470, lr=5.99213e-06, gnorm=3.644, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=28723
2022-05-08 04:25:00 - progress_bar.py[line:272] - INFO: epoch 001:  15502 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=34.053, expert1_balance_bottom=18.848, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=222.8, ups=0.58, wpb=385.2, bsz=32, num_updates=15480, lr=5.98913e-06, gnorm=3.693, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28740
2022-05-08 04:25:17 - progress_bar.py[line:272] - INFO: epoch 001:  15512 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=384.6, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=36.005, expert1_balance_bottom=18.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=217.7, ups=0.57, wpb=384.6, bsz=32, num_updates=15490, lr=5.98612e-06, gnorm=3.489, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28758
2022-05-08 04:25:35 - progress_bar.py[line:272] - INFO: epoch 001:  15522 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.045, ntokens=385.1, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879706, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=35.215, expert1_balance_bottom=18.558, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=221.6, ups=0.58, wpb=385.1, bsz=32, num_updates=15500, lr=5.98312e-06, gnorm=3.879, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28775
2022-05-08 04:25:52 - progress_bar.py[line:272] - INFO: epoch 001:  15532 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892929, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=34.781, expert1_balance_bottom=18.547, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=224.7, ups=0.58, wpb=386.3, bsz=32, num_updates=15510, lr=5.98012e-06, gnorm=3.738, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28793
2022-05-08 04:26:09 - progress_bar.py[line:272] - INFO: epoch 001:  15542 / 17711 loss=3.285, loss_v1=0, loss_v2=0, nll_loss=1.091, ntokens=384.6, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873299, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.285, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=35.844, expert1_balance_bottom=18.137, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.13, wps=225, ups=0.59, wpb=384.6, bsz=32, num_updates=15520, lr=5.97712e-06, gnorm=3.242, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=28810
2022-05-08 04:26:26 - progress_bar.py[line:272] - INFO: epoch 001:  15552 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=385.9, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=35.439, expert1_balance_bottom=18.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=223.4, ups=0.58, wpb=385.9, bsz=32, num_updates=15530, lr=5.97411e-06, gnorm=3.494, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28827
2022-05-08 04:26:44 - progress_bar.py[line:272] - INFO: epoch 001:  15562 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=385.2, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879634, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=35.214, expert1_balance_bottom=18.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222.2, ups=0.58, wpb=385.2, bsz=32, num_updates=15540, lr=5.97111e-06, gnorm=2.982, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28844
2022-05-08 04:27:01 - progress_bar.py[line:272] - INFO: epoch 001:  15572 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88929, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=34.668, expert1_balance_bottom=18.623, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=217.5, ups=0.57, wpb=379.9, bsz=32, num_updates=15550, lr=5.96811e-06, gnorm=3.278, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28862
2022-05-08 04:27:18 - progress_bar.py[line:272] - INFO: epoch 001:  15582 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=34.526, expert1_balance_bottom=18.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=221.9, ups=0.58, wpb=384.7, bsz=32, num_updates=15560, lr=5.9651e-06, gnorm=2.861, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=28879
2022-05-08 04:27:36 - progress_bar.py[line:272] - INFO: epoch 001:  15592 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=388.3, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=35.062, expert1_balance_bottom=18.561, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.6, ups=0.58, wpb=388.3, bsz=32, num_updates=15570, lr=5.9621e-06, gnorm=3.071, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28897
2022-05-08 04:27:53 - progress_bar.py[line:272] - INFO: epoch 001:  15602 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902781, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.273, expert1_balance_top=33.723, expert1_balance_bottom=18.858, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=217.5, ups=0.57, wpb=380.7, bsz=32, num_updates=15580, lr=5.9591e-06, gnorm=3.479, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28914
2022-05-08 04:28:11 - progress_bar.py[line:272] - INFO: epoch 001:  15612 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=34.492, expert1_balance_bottom=18.748, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=221, ups=0.57, wpb=384.9, bsz=32, num_updates=15590, lr=5.95609e-06, gnorm=3.442, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28931
2022-05-08 04:28:28 - progress_bar.py[line:272] - INFO: epoch 001:  15622 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883338, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=34.889, expert1_balance_bottom=18.62, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=217.9, ups=0.57, wpb=380.7, bsz=32, num_updates=15600, lr=5.95309e-06, gnorm=3.534, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28949
2022-05-08 04:28:46 - progress_bar.py[line:272] - INFO: epoch 001:  15632 / 17711 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=1.039, ntokens=392.9, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.237, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=35.499, expert1_balance_bottom=18.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=225.4, ups=0.57, wpb=392.9, bsz=32, num_updates=15610, lr=5.95009e-06, gnorm=3.575, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=28966
2022-05-08 04:29:03 - progress_bar.py[line:272] - INFO: epoch 001:  15642 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=1.005, ntokens=379.3, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888777, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=34.462, expert1_balance_bottom=18.758, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=216.3, ups=0.57, wpb=379.3, bsz=32, num_updates=15620, lr=5.94708e-06, gnorm=3.591, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=28984
2022-05-08 04:29:20 - progress_bar.py[line:272] - INFO: epoch 001:  15652 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=384, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=34.005, expert1_balance_bottom=18.853, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.6, ups=0.58, wpb=384, bsz=32, num_updates=15630, lr=5.94408e-06, gnorm=2.713, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29001
2022-05-08 04:29:38 - progress_bar.py[line:272] - INFO: epoch 001:  15662 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=373.6, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.271, expert1_balance_top=34.528, expert1_balance_bottom=18.456, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=218.3, ups=0.58, wpb=373.6, bsz=32, num_updates=15640, lr=5.94108e-06, gnorm=2.804, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=29018
2022-05-08 04:29:55 - progress_bar.py[line:272] - INFO: epoch 001:  15672 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894558, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=34.484, expert1_balance_bottom=18.667, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=218.9, ups=0.57, wpb=383.1, bsz=32, num_updates=15650, lr=5.93807e-06, gnorm=3.126, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29036
2022-05-08 04:30:12 - progress_bar.py[line:272] - INFO: epoch 001:  15682 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=35.179, expert1_balance_bottom=18.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=223, ups=0.58, wpb=386.3, bsz=32, num_updates=15660, lr=5.93507e-06, gnorm=3.209, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29053
2022-05-08 04:30:30 - progress_bar.py[line:272] - INFO: epoch 001:  15692 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886562, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.899, expert1_balance_bottom=18.69, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=219.3, ups=0.57, wpb=385.5, bsz=32, num_updates=15670, lr=5.93207e-06, gnorm=3.286, loss_scale=256, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=29071
2022-05-08 04:30:47 - progress_bar.py[line:272] - INFO: epoch 001:  15702 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880977, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=35.096, expert1_balance_bottom=18.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=223, ups=0.58, wpb=385.7, bsz=32, num_updates=15680, lr=5.92906e-06, gnorm=3.067, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29088
2022-05-08 04:31:04 - progress_bar.py[line:272] - INFO: epoch 001:  15712 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881089, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.773, expert1_balance_bottom=18.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=220.9, ups=0.58, wpb=379.2, bsz=32, num_updates=15690, lr=5.92606e-06, gnorm=3.215, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29105
2022-05-08 04:31:22 - progress_bar.py[line:272] - INFO: epoch 001:  15722 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=34.047, expert1_balance_bottom=18.913, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.5, ups=0.58, wpb=378.2, bsz=32, num_updates=15700, lr=5.92306e-06, gnorm=2.809, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29122
2022-05-08 04:31:39 - progress_bar.py[line:272] - INFO: epoch 001:  15732 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.786, expert1_balance_bottom=18.624, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=221.4, ups=0.58, wpb=384.9, bsz=32, num_updates=15710, lr=5.92005e-06, gnorm=3.063, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29140
2022-05-08 04:31:56 - progress_bar.py[line:272] - INFO: epoch 001:  15742 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=35.593, expert1_balance_bottom=18.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219.7, ups=0.58, wpb=380.5, bsz=32, num_updates=15720, lr=5.91705e-06, gnorm=3.015, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29157
2022-05-08 04:32:14 - progress_bar.py[line:272] - INFO: epoch 001:  15752 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=385, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=35.34, expert1_balance_bottom=18.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=218.9, ups=0.57, wpb=385, bsz=32, num_updates=15730, lr=5.91405e-06, gnorm=3.265, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29175
2022-05-08 04:32:31 - progress_bar.py[line:272] - INFO: epoch 001:  15762 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=382, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880874, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=34.96, expert1_balance_bottom=18.772, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=217.7, ups=0.57, wpb=382, bsz=32, num_updates=15740, lr=5.91104e-06, gnorm=3.403, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29192
2022-05-08 04:32:49 - progress_bar.py[line:272] - INFO: epoch 001:  15772 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=387, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885299, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.76, expert1_balance_bottom=18.84, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224, ups=0.58, wpb=387, bsz=32, num_updates=15750, lr=5.90804e-06, gnorm=3.447, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29210
2022-05-08 04:33:06 - progress_bar.py[line:272] - INFO: epoch 001:  15782 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=383.4, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888317, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.736, expert1_balance_bottom=18.647, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221.1, ups=0.58, wpb=383.4, bsz=32, num_updates=15760, lr=5.90504e-06, gnorm=2.928, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29227
2022-05-08 04:33:23 - progress_bar.py[line:272] - INFO: epoch 001:  15792 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885762, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.98, expert1_balance_bottom=18.645, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=221.1, ups=0.58, wpb=383.8, bsz=32, num_updates=15770, lr=5.90203e-06, gnorm=3.169, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29244
2022-05-08 04:33:41 - progress_bar.py[line:272] - INFO: epoch 001:  15802 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=382, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881415, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=35.298, expert1_balance_bottom=18.623, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=216.3, ups=0.57, wpb=382, bsz=32, num_updates=15780, lr=5.89903e-06, gnorm=3.024, loss_scale=256, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=29262
2022-05-08 04:33:59 - progress_bar.py[line:272] - INFO: epoch 001:  15812 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=377.5, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=35.735, expert1_balance_bottom=18.302, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=216.1, ups=0.57, wpb=377.5, bsz=32, num_updates=15790, lr=5.89603e-06, gnorm=3.19, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29279
2022-05-08 04:34:16 - progress_bar.py[line:272] - INFO: epoch 001:  15822 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876187, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=35.685, expert1_balance_bottom=18.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=218.7, ups=0.57, wpb=384, bsz=32, num_updates=15800, lr=5.89302e-06, gnorm=3.244, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29297
2022-05-08 04:34:34 - progress_bar.py[line:272] - INFO: epoch 001:  15832 / 17711 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=1.031, ntokens=381.7, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=35.189, expert1_balance_bottom=18.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=217.4, ups=0.57, wpb=381.7, bsz=32, num_updates=15810, lr=5.89002e-06, gnorm=3.448, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29314
2022-05-08 04:34:51 - progress_bar.py[line:272] - INFO: epoch 001:  15842 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=1.007, ntokens=384.2, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.726, expert1_balance_bottom=18.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=221.8, ups=0.58, wpb=384.2, bsz=32, num_updates=15820, lr=5.88702e-06, gnorm=3.536, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29332
2022-05-08 04:34:53 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 04:35:10 - progress_bar.py[line:272] - INFO: epoch 001:  15853 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=384.4, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883399, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.678, expert1_balance_bottom=18.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=203.2, ups=0.53, wpb=384.4, bsz=32, num_updates=15830, lr=5.88401e-06, gnorm=3.779, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29351
2022-05-08 04:35:27 - progress_bar.py[line:272] - INFO: epoch 001:  15863 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=35.482, expert1_balance_bottom=18.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=224.1, ups=0.58, wpb=386.4, bsz=32, num_updates=15840, lr=5.88101e-06, gnorm=3.28, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29368
2022-05-08 04:35:45 - progress_bar.py[line:272] - INFO: epoch 001:  15873 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.959, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890945, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.404, expert1_balance_bottom=18.57, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=219.9, ups=0.58, wpb=381.2, bsz=32, num_updates=15850, lr=5.87801e-06, gnorm=3.338, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29385
2022-05-08 04:36:02 - progress_bar.py[line:272] - INFO: epoch 001:  15883 / 17711 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=1.054, ntokens=384.5, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.272, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=34.278, expert1_balance_bottom=18.923, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=220.8, ups=0.57, wpb=384.5, bsz=32, num_updates=15860, lr=5.875e-06, gnorm=3.352, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29403
2022-05-08 04:36:19 - progress_bar.py[line:272] - INFO: epoch 001:  15893 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=387.5, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886067, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.683, expert1_balance_bottom=18.823, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.3, ups=0.57, wpb=387.5, bsz=32, num_updates=15870, lr=5.872e-06, gnorm=3.332, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29420
2022-05-08 04:36:37 - progress_bar.py[line:272] - INFO: epoch 001:  15903 / 17711 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.961, ntokens=386.9, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.189, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.042, expert1_balance_bottom=18.78, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.9, ups=0.58, wpb=386.9, bsz=32, num_updates=15880, lr=5.869e-06, gnorm=3.518, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29437
2022-05-08 04:36:54 - progress_bar.py[line:272] - INFO: epoch 001:  15913 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.726, expert1_balance_bottom=18.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=214.9, ups=0.57, wpb=378.4, bsz=32, num_updates=15890, lr=5.86599e-06, gnorm=3.37, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29455
2022-05-08 04:37:12 - progress_bar.py[line:272] - INFO: epoch 001:  15923 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=384.2, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881619, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=35.142, expert1_balance_bottom=18.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=218, ups=0.57, wpb=384.2, bsz=32, num_updates=15900, lr=5.86299e-06, gnorm=3.502, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29473
2022-05-08 04:37:30 - progress_bar.py[line:272] - INFO: epoch 001:  15933 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.974, expert1_balance_bottom=18.557, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=218.5, ups=0.57, wpb=383.4, bsz=32, num_updates=15910, lr=5.85999e-06, gnorm=3.169, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29490
2022-05-08 04:37:47 - progress_bar.py[line:272] - INFO: epoch 001:  15943 / 17711 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.992, ntokens=373, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.207, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=35.064, expert1_balance_bottom=18.535, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=211.8, ups=0.57, wpb=373, bsz=32, num_updates=15920, lr=5.85698e-06, gnorm=3.277, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29508
2022-05-08 04:38:04 - progress_bar.py[line:272] - INFO: epoch 001:  15953 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=377.6, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=34.278, expert1_balance_bottom=18.855, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=217.7, ups=0.58, wpb=377.6, bsz=32, num_updates=15930, lr=5.85398e-06, gnorm=3.196, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29525
2022-05-08 04:38:22 - progress_bar.py[line:272] - INFO: epoch 001:  15963 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882345, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=35.072, expert1_balance_bottom=18.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.3, ups=0.57, wpb=382.3, bsz=32, num_updates=15940, lr=5.85098e-06, gnorm=3.059, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29543
2022-05-08 04:38:39 - progress_bar.py[line:272] - INFO: epoch 001:  15973 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=381.8, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894213, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=33.819, expert1_balance_bottom=18.938, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=222.6, ups=0.58, wpb=381.8, bsz=32, num_updates=15950, lr=5.84797e-06, gnorm=2.967, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29560
2022-05-08 04:38:56 - progress_bar.py[line:272] - INFO: epoch 001:  15983 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=382.5, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.61, expert1_balance_bottom=18.826, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=222.7, ups=0.58, wpb=382.5, bsz=32, num_updates=15960, lr=5.84497e-06, gnorm=3.411, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29577
2022-05-08 04:39:13 - progress_bar.py[line:272] - INFO: epoch 001:  15993 / 17711 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=392.2, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.189, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=35.13, expert1_balance_bottom=18.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=231.4, ups=0.59, wpb=392.2, bsz=32, num_updates=15970, lr=5.84197e-06, gnorm=4.294, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29594
2022-05-08 04:39:30 - progress_bar.py[line:272] - INFO: epoch 001:  16003 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=381.5, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881022, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.839, expert1_balance_bottom=18.55, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=223.2, ups=0.58, wpb=381.5, bsz=32, num_updates=15980, lr=5.83896e-06, gnorm=3.379, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29611
2022-05-08 04:39:48 - progress_bar.py[line:272] - INFO: epoch 001:  16013 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=380.4, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=35.283, expert1_balance_bottom=18.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=221.3, ups=0.58, wpb=380.4, bsz=32, num_updates=15990, lr=5.83596e-06, gnorm=3.507, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29628
2022-05-08 04:40:05 - progress_bar.py[line:272] - INFO: epoch 001:  16023 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=382.6, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=34.688, expert1_balance_bottom=18.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.4, ups=0.58, wpb=382.6, bsz=32, num_updates=16000, lr=5.83296e-06, gnorm=3.372, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29646
2022-05-08 04:40:22 - progress_bar.py[line:272] - INFO: epoch 001:  16033 / 17711 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=1.057, ntokens=390, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.272, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.51, expert1_balance_bottom=18.678, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=226.3, ups=0.58, wpb=390, bsz=32, num_updates=16010, lr=5.82995e-06, gnorm=3.247, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29663
2022-05-08 04:40:39 - progress_bar.py[line:272] - INFO: epoch 001:  16043 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=374.4, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=34.474, expert1_balance_bottom=18.859, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=217.2, ups=0.58, wpb=374.4, bsz=32, num_updates=16020, lr=5.82695e-06, gnorm=2.931, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29680
2022-05-08 04:40:57 - progress_bar.py[line:272] - INFO: epoch 001:  16053 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=387.1, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880471, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=35.161, expert1_balance_bottom=18.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221.3, ups=0.57, wpb=387.1, bsz=32, num_updates=16030, lr=5.82395e-06, gnorm=3.984, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29697
2022-05-08 04:41:14 - progress_bar.py[line:272] - INFO: epoch 001:  16063 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=384.8, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896822, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=33.995, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=227.5, ups=0.59, wpb=384.8, bsz=32, num_updates=16040, lr=5.82094e-06, gnorm=3.127, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29714
2022-05-08 04:41:31 - progress_bar.py[line:272] - INFO: epoch 001:  16073 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=394.7, nsentences=32, sample_size=314, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.762, expert1_balance_bottom=18.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=228, ups=0.58, wpb=394.7, bsz=32, num_updates=16050, lr=5.81794e-06, gnorm=3.159, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=29732
2022-05-08 04:41:48 - progress_bar.py[line:272] - INFO: epoch 001:  16083 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=35.157, expert1_balance_bottom=18.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=224.4, ups=0.59, wpb=381.9, bsz=32, num_updates=16060, lr=5.81494e-06, gnorm=3.202, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29749
2022-05-08 04:42:05 - progress_bar.py[line:272] - INFO: epoch 001:  16093 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=376.8, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891686, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.459, expert1_balance_bottom=18.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.9, ups=0.59, wpb=376.8, bsz=32, num_updates=16070, lr=5.81194e-06, gnorm=3.445, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29766
2022-05-08 04:42:22 - progress_bar.py[line:272] - INFO: epoch 001:  16103 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=377, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874702, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=35.572, expert1_balance_bottom=18.66, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=217.9, ups=0.58, wpb=377, bsz=32, num_updates=16080, lr=5.80893e-06, gnorm=3.152, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29783
2022-05-08 04:42:40 - progress_bar.py[line:272] - INFO: epoch 001:  16113 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=376.5, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.268, expert1_balance_top=34, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=213, ups=0.57, wpb=376.5, bsz=32, num_updates=16090, lr=5.80593e-06, gnorm=3.099, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29801
2022-05-08 04:42:57 - progress_bar.py[line:272] - INFO: epoch 001:  16123 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.891, expert1_balance_bottom=18.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=220, ups=0.57, wpb=386.3, bsz=32, num_updates=16100, lr=5.80293e-06, gnorm=3.151, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29818
2022-05-08 04:43:15 - progress_bar.py[line:272] - INFO: epoch 001:  16133 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=374.7, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=33.298, expert1_balance_bottom=18.933, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=214.2, ups=0.57, wpb=374.7, bsz=32, num_updates=16110, lr=5.79992e-06, gnorm=3.506, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29836
2022-05-08 04:43:32 - progress_bar.py[line:272] - INFO: epoch 001:  16143 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886718, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.863, expert1_balance_bottom=18.658, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=216.7, ups=0.57, wpb=380.6, bsz=32, num_updates=16120, lr=5.79692e-06, gnorm=4.009, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29853
2022-05-08 04:43:49 - progress_bar.py[line:272] - INFO: epoch 001:  16153 / 17711 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.986, ntokens=377.7, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.206, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=34.285, expert1_balance_bottom=18.851, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=222.9, ups=0.59, wpb=377.7, bsz=32, num_updates=16130, lr=5.79392e-06, gnorm=3.686, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29870
2022-05-08 04:44:07 - progress_bar.py[line:272] - INFO: epoch 001:  16163 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893237, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.591, expert1_balance_bottom=18.752, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=221.7, ups=0.58, wpb=384, bsz=32, num_updates=16140, lr=5.79091e-06, gnorm=2.951, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29887
2022-05-08 04:44:24 - progress_bar.py[line:272] - INFO: epoch 001:  16173 / 17711 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=1.033, ntokens=391.7, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870909, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.234, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=35.726, expert1_balance_bottom=18.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.05, wps=225.1, ups=0.57, wpb=391.7, bsz=32, num_updates=16150, lr=5.78791e-06, gnorm=4.417, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29905
2022-05-08 04:44:41 - progress_bar.py[line:272] - INFO: epoch 001:  16183 / 17711 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.174, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=35.25, expert1_balance_bottom=18.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=225, ups=0.58, wpb=388, bsz=32, num_updates=16160, lr=5.78491e-06, gnorm=3.44, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29922
2022-05-08 04:44:59 - progress_bar.py[line:272] - INFO: epoch 001:  16193 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=374.7, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=34.568, expert1_balance_bottom=18.503, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=217, ups=0.58, wpb=374.7, bsz=32, num_updates=16170, lr=5.7819e-06, gnorm=3.305, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29939
2022-05-08 04:45:16 - progress_bar.py[line:272] - INFO: epoch 001:  16203 / 17711 loss=3.217, loss_v1=0, loss_v2=0, nll_loss=0.992, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889795, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.217, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=34.547, expert1_balance_bottom=18.694, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=220.5, ups=0.58, wpb=381.1, bsz=32, num_updates=16180, lr=5.7789e-06, gnorm=3.347, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=29957
2022-05-08 04:45:33 - progress_bar.py[line:272] - INFO: epoch 001:  16213 / 17711 loss=3.261, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=379.4, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886015, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.261, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=35.079, expert1_balance_bottom=18.547, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.07, wps=219.8, ups=0.58, wpb=379.4, bsz=32, num_updates=16190, lr=5.7759e-06, gnorm=3.526, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29974
2022-05-08 04:45:50 - progress_bar.py[line:272] - INFO: epoch 001:  16223 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.974, ntokens=377, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.269, expert1_balance_top=33.75, expert1_balance_bottom=18.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=219.1, ups=0.58, wpb=377, bsz=32, num_updates=16200, lr=5.77289e-06, gnorm=3.153, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=29991
2022-05-08 04:46:08 - progress_bar.py[line:272] - INFO: epoch 001:  16233 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=389.4, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=35.1, expert1_balance_bottom=18.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=226.5, ups=0.58, wpb=389.4, bsz=32, num_updates=16210, lr=5.76989e-06, gnorm=2.969, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30008
2022-05-08 04:46:25 - progress_bar.py[line:272] - INFO: epoch 001:  16243 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.966, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.229, expert1_balance_bottom=18.833, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=219.2, ups=0.57, wpb=383, bsz=32, num_updates=16220, lr=5.76689e-06, gnorm=2.76, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=30026
2022-05-08 04:46:42 - progress_bar.py[line:272] - INFO: epoch 001:  16253 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889127, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=34.624, expert1_balance_bottom=18.993, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=221.8, ups=0.57, wpb=386.8, bsz=32, num_updates=16230, lr=5.76388e-06, gnorm=4.33, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30043
2022-05-08 04:47:00 - progress_bar.py[line:272] - INFO: epoch 001:  16263 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.975, ntokens=392.7, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880729, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.886, expert1_balance_bottom=18.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=228.4, ups=0.58, wpb=392.7, bsz=32, num_updates=16240, lr=5.76088e-06, gnorm=3.467, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30060
2022-05-08 04:47:17 - progress_bar.py[line:272] - INFO: epoch 001:  16273 / 17711 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=1.012, ntokens=387.6, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888986, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.233, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=34.622, expert1_balance_bottom=18.592, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=223.1, ups=0.58, wpb=387.6, bsz=32, num_updates=16250, lr=5.75788e-06, gnorm=3.829, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30078
2022-05-08 04:47:34 - progress_bar.py[line:272] - INFO: epoch 001:  16283 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=377.7, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877458, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=35.359, expert1_balance_bottom=18.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.8, ups=0.57, wpb=377.7, bsz=32, num_updates=16260, lr=5.75487e-06, gnorm=3.227, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30095
2022-05-08 04:47:52 - progress_bar.py[line:272] - INFO: epoch 001:  16293 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.979, ntokens=385.5, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=34.319, expert1_balance_bottom=18.861, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=221.5, ups=0.57, wpb=385.5, bsz=32, num_updates=16270, lr=5.75187e-06, gnorm=3.432, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30113
2022-05-08 04:48:09 - progress_bar.py[line:272] - INFO: epoch 001:  16303 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=388.6, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.752, expert1_balance_bottom=18.766, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.3, ups=0.58, wpb=388.6, bsz=32, num_updates=16280, lr=5.74887e-06, gnorm=3.003, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30130
2022-05-08 04:48:26 - progress_bar.py[line:272] - INFO: epoch 001:  16313 / 17711 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=379.4, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.179, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=34.85, expert1_balance_bottom=18.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=222.2, ups=0.59, wpb=379.4, bsz=32, num_updates=16290, lr=5.74586e-06, gnorm=3.236, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30147
2022-05-08 04:48:44 - progress_bar.py[line:272] - INFO: epoch 001:  16323 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=382.4, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886458, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.56, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=218, ups=0.57, wpb=382.4, bsz=32, num_updates=16300, lr=5.74286e-06, gnorm=3.133, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30165
2022-05-08 04:49:01 - progress_bar.py[line:272] - INFO: epoch 001:  16333 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=33.959, expert1_balance_bottom=18.881, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=216.7, ups=0.57, wpb=378.2, bsz=32, num_updates=16310, lr=5.73986e-06, gnorm=3.643, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30182
2022-05-08 04:49:19 - progress_bar.py[line:272] - INFO: epoch 001:  16343 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=375.9, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=34.688, expert1_balance_bottom=18.641, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=212.5, ups=0.57, wpb=375.9, bsz=32, num_updates=16320, lr=5.73685e-06, gnorm=3.008, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30200
2022-05-08 04:49:36 - progress_bar.py[line:272] - INFO: epoch 001:  16353 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=34.529, expert1_balance_bottom=18.721, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=219.5, ups=0.58, wpb=381, bsz=32, num_updates=16330, lr=5.73385e-06, gnorm=2.867, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=30217
2022-05-08 04:49:54 - progress_bar.py[line:272] - INFO: epoch 001:  16363 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=34.317, expert1_balance_bottom=18.993, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=222.8, ups=0.58, wpb=385.3, bsz=32, num_updates=16340, lr=5.73085e-06, gnorm=3.05, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30234
2022-05-08 04:50:11 - progress_bar.py[line:272] - INFO: epoch 001:  16373 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=385.2, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=34.819, expert1_balance_bottom=18.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.1, ups=0.58, wpb=385.2, bsz=32, num_updates=16350, lr=5.72784e-06, gnorm=3.805, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30252
2022-05-08 04:50:28 - progress_bar.py[line:272] - INFO: epoch 001:  16383 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.959, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.907202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.27, expert1_balance_top=33.36, expert1_balance_bottom=19.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=218.8, ups=0.57, wpb=383.4, bsz=32, num_updates=16360, lr=5.72484e-06, gnorm=3.77, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30269
2022-05-08 04:50:45 - progress_bar.py[line:272] - INFO: epoch 001:  16393 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=380.9, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884107, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.635, expert1_balance_bottom=18.667, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221.6, ups=0.58, wpb=380.9, bsz=32, num_updates=16370, lr=5.72184e-06, gnorm=2.941, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30286
2022-05-08 04:51:03 - progress_bar.py[line:272] - INFO: epoch 001:  16403 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=390.4, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.765, expert1_balance_bottom=18.767, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=226.6, ups=0.58, wpb=390.4, bsz=32, num_updates=16380, lr=5.71883e-06, gnorm=3.312, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30304
2022-05-08 04:51:20 - progress_bar.py[line:272] - INFO: epoch 001:  16413 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876818, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.903, expert1_balance_bottom=18.791, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.1, ups=0.58, wpb=381.7, bsz=32, num_updates=16390, lr=5.71583e-06, gnorm=3.143, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30321
2022-05-08 04:51:37 - progress_bar.py[line:272] - INFO: epoch 001:  16423 / 17711 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=384.1, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.234, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=35.155, expert1_balance_bottom=18.728, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=224.6, ups=0.58, wpb=384.1, bsz=32, num_updates=16400, lr=5.71283e-06, gnorm=3.278, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30338
2022-05-08 04:51:54 - progress_bar.py[line:272] - INFO: epoch 001:  16433 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=378, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=34.246, expert1_balance_bottom=18.747, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=223, ups=0.59, wpb=378, bsz=32, num_updates=16410, lr=5.70982e-06, gnorm=2.968, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30355
2022-05-08 04:52:11 - progress_bar.py[line:272] - INFO: epoch 001:  16443 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=381.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=34.792, expert1_balance_bottom=18.687, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=223.1, ups=0.58, wpb=381.8, bsz=32, num_updates=16420, lr=5.70682e-06, gnorm=3.201, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30372
2022-05-08 04:52:28 - progress_bar.py[line:272] - INFO: epoch 001:  16453 / 17711 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.992, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.199, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.981, expert1_balance_bottom=18.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=220.2, ups=0.58, wpb=380.7, bsz=32, num_updates=16430, lr=5.70382e-06, gnorm=3.097, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30389
2022-05-08 04:52:46 - progress_bar.py[line:272] - INFO: epoch 001:  16463 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.559, expert1_balance_bottom=18.83, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=221.1, ups=0.58, wpb=384.2, bsz=32, num_updates=16440, lr=5.70081e-06, gnorm=3.275, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30406
2022-05-08 04:53:03 - progress_bar.py[line:272] - INFO: epoch 001:  16473 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=34.756, expert1_balance_bottom=18.813, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221, ups=0.58, wpb=379.7, bsz=32, num_updates=16450, lr=5.69781e-06, gnorm=3.138, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=30424
2022-05-08 04:53:20 - progress_bar.py[line:272] - INFO: epoch 001:  16483 / 17711 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=392, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88059, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.163, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.761, expert1_balance_bottom=18.707, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=225.1, ups=0.57, wpb=392, bsz=32, num_updates=16460, lr=5.69481e-06, gnorm=3.126, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30441
2022-05-08 04:53:38 - progress_bar.py[line:272] - INFO: epoch 001:  16493 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874462, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.979, expert1_balance_bottom=18.657, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=222.8, ups=0.58, wpb=385.3, bsz=32, num_updates=16470, lr=5.6918e-06, gnorm=3.06, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30458
2022-05-08 04:53:55 - progress_bar.py[line:272] - INFO: epoch 001:  16503 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896097, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=33.898, expert1_balance_bottom=19.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=223.8, ups=0.58, wpb=385.3, bsz=32, num_updates=16480, lr=5.6888e-06, gnorm=3.627, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30476
2022-05-08 04:54:12 - progress_bar.py[line:272] - INFO: epoch 001:  16513 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.223, expert1_balance_bottom=18.854, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223.6, ups=0.59, wpb=382.1, bsz=32, num_updates=16490, lr=5.6858e-06, gnorm=2.977, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30493
2022-05-08 04:54:29 - progress_bar.py[line:272] - INFO: epoch 001:  16523 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.98, ntokens=398.1, nsentences=32, sample_size=317, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.860003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=36.532, expert1_balance_bottom=18.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=229, ups=0.58, wpb=398.1, bsz=32, num_updates=16500, lr=5.68279e-06, gnorm=2.895, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30510
2022-05-08 04:54:47 - progress_bar.py[line:272] - INFO: epoch 001:  16533 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=379.9, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890269, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.386, expert1_balance_bottom=18.865, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=218.1, ups=0.57, wpb=379.9, bsz=32, num_updates=16510, lr=5.67979e-06, gnorm=3.231, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30527
2022-05-08 04:55:04 - progress_bar.py[line:272] - INFO: epoch 001:  16543 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=376.7, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=34.482, expert1_balance_bottom=18.826, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=214.1, ups=0.57, wpb=376.7, bsz=32, num_updates=16520, lr=5.67679e-06, gnorm=3.634, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30545
2022-05-08 04:55:22 - progress_bar.py[line:272] - INFO: epoch 001:  16553 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=388.7, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=35.227, expert1_balance_bottom=18.626, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=223.9, ups=0.58, wpb=388.7, bsz=32, num_updates=16530, lr=5.67378e-06, gnorm=3.657, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30562
2022-05-08 04:55:39 - progress_bar.py[line:272] - INFO: epoch 001:  16563 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=35.195, expert1_balance_bottom=18.612, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.2, ups=0.58, wpb=385.4, bsz=32, num_updates=16540, lr=5.67078e-06, gnorm=3.404, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30580
2022-05-08 04:55:56 - progress_bar.py[line:272] - INFO: epoch 001:  16573 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=389.4, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=35.366, expert1_balance_bottom=18.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=226.2, ups=0.58, wpb=389.4, bsz=32, num_updates=16550, lr=5.66778e-06, gnorm=3.281, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30597
2022-05-08 04:56:13 - progress_bar.py[line:272] - INFO: epoch 001:  16583 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=1.002, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=34.609, expert1_balance_bottom=18.941, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=221.2, ups=0.58, wpb=379.5, bsz=32, num_updates=16560, lr=5.66477e-06, gnorm=3.722, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30614
2022-05-08 04:56:31 - progress_bar.py[line:272] - INFO: epoch 001:  16593 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=378.8, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.152, expert1_balance_bottom=18.99, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=215.7, ups=0.57, wpb=378.8, bsz=32, num_updates=16570, lr=5.66177e-06, gnorm=3.53, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30632
2022-05-08 04:56:48 - progress_bar.py[line:272] - INFO: epoch 001:  16603 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=376.7, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896182, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.224, expert1_balance_bottom=18.904, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=220.8, ups=0.59, wpb=376.7, bsz=32, num_updates=16580, lr=5.65877e-06, gnorm=3.318, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30649
2022-05-08 04:57:05 - progress_bar.py[line:272] - INFO: epoch 001:  16613 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89293, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.265, expert1_balance_top=34.669, expert1_balance_bottom=18.653, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=224.5, ups=0.58, wpb=384.3, bsz=32, num_updates=16590, lr=5.65576e-06, gnorm=3.602, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30666
2022-05-08 04:57:08 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 04:57:24 - progress_bar.py[line:272] - INFO: epoch 001:  16624 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.671, expert1_balance_bottom=18.829, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=199.3, ups=0.52, wpb=385.7, bsz=32, num_updates=16600, lr=5.65276e-06, gnorm=3.187, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30685
2022-05-08 04:57:42 - progress_bar.py[line:272] - INFO: epoch 001:  16634 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=34.176, expert1_balance_bottom=18.996, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222.6, ups=0.58, wpb=384.5, bsz=32, num_updates=16610, lr=5.64976e-06, gnorm=3.741, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30702
2022-05-08 04:57:59 - progress_bar.py[line:272] - INFO: epoch 001:  16644 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886641, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=34.917, expert1_balance_bottom=18.631, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=219.5, ups=0.58, wpb=380.4, bsz=32, num_updates=16620, lr=5.64675e-06, gnorm=3.246, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30720
2022-05-08 04:58:17 - progress_bar.py[line:272] - INFO: epoch 001:  16654 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=386.7, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.806, expert1_balance_bottom=18.745, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.5, ups=0.57, wpb=386.7, bsz=32, num_updates=16630, lr=5.64375e-06, gnorm=3.137, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30737
2022-05-08 04:58:34 - progress_bar.py[line:272] - INFO: epoch 001:  16664 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893067, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=34.473, expert1_balance_bottom=18.716, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=217.1, ups=0.57, wpb=378.6, bsz=32, num_updates=16640, lr=5.64075e-06, gnorm=3.093, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30755
2022-05-08 04:58:51 - progress_bar.py[line:272] - INFO: epoch 001:  16674 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=35.136, expert1_balance_bottom=18.542, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=223.1, ups=0.58, wpb=382.4, bsz=32, num_updates=16650, lr=5.63775e-06, gnorm=4.385, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30772
2022-05-08 04:59:09 - progress_bar.py[line:272] - INFO: epoch 001:  16684 / 17711 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=378.9, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.216, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=35.552, expert1_balance_bottom=18.632, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=217.8, ups=0.57, wpb=378.9, bsz=32, num_updates=16660, lr=5.63474e-06, gnorm=3.982, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30789
2022-05-08 04:59:26 - progress_bar.py[line:272] - INFO: epoch 001:  16694 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.554, expert1_balance_bottom=18.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=218.5, ups=0.57, wpb=382.3, bsz=32, num_updates=16670, lr=5.63174e-06, gnorm=3.3, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30807
2022-05-08 04:59:43 - progress_bar.py[line:272] - INFO: epoch 001:  16704 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=1.012, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883588, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=35.054, expert1_balance_bottom=18.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=221.1, ups=0.58, wpb=379.8, bsz=32, num_updates=16680, lr=5.62874e-06, gnorm=4.102, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30824
2022-05-08 05:00:01 - progress_bar.py[line:272] - INFO: epoch 001:  16714 / 17711 loss=3.263, loss_v1=0, loss_v2=0, nll_loss=1.054, ntokens=386.6, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.263, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.802, expert1_balance_bottom=18.712, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=218.8, ups=0.57, wpb=386.6, bsz=32, num_updates=16690, lr=5.62573e-06, gnorm=3.438, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30842
2022-05-08 05:00:18 - progress_bar.py[line:272] - INFO: epoch 001:  16724 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=34.318, expert1_balance_bottom=18.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=225.1, ups=0.59, wpb=384.7, bsz=32, num_updates=16700, lr=5.62273e-06, gnorm=3.186, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30859
2022-05-08 05:00:36 - progress_bar.py[line:272] - INFO: epoch 001:  16734 / 17711 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=372.4, nsentences=32, sample_size=296.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.226, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.264, expert1_balance_top=35.101, expert1_balance_bottom=18.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=211.6, ups=0.57, wpb=372.4, bsz=32, num_updates=16710, lr=5.61973e-06, gnorm=3.329, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30876
2022-05-08 05:00:53 - progress_bar.py[line:272] - INFO: epoch 001:  16744 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879094, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=35.213, expert1_balance_bottom=18.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=220.1, ups=0.57, wpb=383.3, bsz=32, num_updates=16720, lr=5.61672e-06, gnorm=3.934, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30894
2022-05-08 05:01:10 - progress_bar.py[line:272] - INFO: epoch 001:  16754 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=370.4, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905411, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.266, expert1_balance_top=33.666, expert1_balance_bottom=19.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=214.4, ups=0.58, wpb=370.4, bsz=32, num_updates=16730, lr=5.61372e-06, gnorm=3.28, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30911
2022-05-08 05:01:28 - progress_bar.py[line:272] - INFO: epoch 001:  16764 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=35.548, expert1_balance_bottom=18.575, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220.6, ups=0.58, wpb=381.7, bsz=32, num_updates=16740, lr=5.61072e-06, gnorm=3.017, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30928
2022-05-08 05:01:45 - progress_bar.py[line:272] - INFO: epoch 001:  16774 / 17711 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.18, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.952, expert1_balance_bottom=18.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=222.4, ups=0.58, wpb=380.5, bsz=32, num_updates=16750, lr=5.60771e-06, gnorm=3.262, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30945
2022-05-08 05:02:02 - progress_bar.py[line:272] - INFO: epoch 001:  16784 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874401, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.384, expert1_balance_bottom=18.588, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=217.1, ups=0.57, wpb=383, bsz=32, num_updates=16760, lr=5.60471e-06, gnorm=3.388, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30963
2022-05-08 05:02:20 - progress_bar.py[line:272] - INFO: epoch 001:  16794 / 17711 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=1.019, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.237, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.263, expert1_balance_top=34.499, expert1_balance_bottom=18.833, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=217, ups=0.57, wpb=380.8, bsz=32, num_updates=16770, lr=5.60171e-06, gnorm=3.478, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30981
2022-05-08 05:02:38 - progress_bar.py[line:272] - INFO: epoch 001:  16804 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=379.1, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.205, expert1_balance_bottom=18.847, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=211.3, ups=0.56, wpb=379.1, bsz=32, num_updates=16780, lr=5.5987e-06, gnorm=3.334, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=30999
2022-05-08 05:02:55 - progress_bar.py[line:272] - INFO: epoch 001:  16814 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=377.4, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890608, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=34.265, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.3, ups=0.57, wpb=377.4, bsz=32, num_updates=16790, lr=5.5957e-06, gnorm=3.243, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31016
2022-05-08 05:03:13 - progress_bar.py[line:272] - INFO: epoch 001:  16824 / 17711 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=388.4, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878726, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.163, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=35.028, expert1_balance_bottom=18.674, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221.8, ups=0.57, wpb=388.4, bsz=32, num_updates=16800, lr=5.5927e-06, gnorm=3.421, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31034
2022-05-08 05:03:30 - progress_bar.py[line:272] - INFO: epoch 001:  16834 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=374.6, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.373, expert1_balance_bottom=18.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.6, ups=0.57, wpb=374.6, bsz=32, num_updates=16810, lr=5.58969e-06, gnorm=3.162, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31051
2022-05-08 05:03:48 - progress_bar.py[line:272] - INFO: epoch 001:  16844 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=386.5, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885687, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.743, expert1_balance_bottom=18.75, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=222.5, ups=0.58, wpb=386.5, bsz=32, num_updates=16820, lr=5.58669e-06, gnorm=3.088, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=31069
2022-05-08 05:04:05 - progress_bar.py[line:272] - INFO: epoch 001:  16854 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=392.9, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876611, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.248, expert1_balance_bottom=18.549, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=223.1, ups=0.57, wpb=392.9, bsz=32, num_updates=16830, lr=5.58369e-06, gnorm=3.547, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31086
2022-05-08 05:04:23 - progress_bar.py[line:272] - INFO: epoch 001:  16864 / 17711 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.997, ntokens=372.8, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88107, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.206, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.974, expert1_balance_bottom=18.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=217.4, ups=0.58, wpb=372.8, bsz=32, num_updates=16840, lr=5.58068e-06, gnorm=3.367, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31103
2022-05-08 05:04:40 - progress_bar.py[line:272] - INFO: epoch 001:  16874 / 17711 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=374.6, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.911528, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.205, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.267, expert1_balance_top=33.472, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=218.5, ups=0.58, wpb=374.6, bsz=32, num_updates=16850, lr=5.57768e-06, gnorm=3.661, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=31120
2022-05-08 05:04:57 - progress_bar.py[line:272] - INFO: epoch 001:  16884 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=375, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=34.568, expert1_balance_bottom=18.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=217.5, ups=0.58, wpb=375, bsz=32, num_updates=16860, lr=5.57468e-06, gnorm=3.15, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31138
2022-05-08 05:05:14 - progress_bar.py[line:272] - INFO: epoch 001:  16894 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=389.1, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.467, expert1_balance_bottom=18.604, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.8, ups=0.58, wpb=389.1, bsz=32, num_updates=16870, lr=5.57167e-06, gnorm=3.275, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31155
2022-05-08 05:05:32 - progress_bar.py[line:272] - INFO: epoch 001:  16904 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=1.043, ntokens=386, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.856709, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=36.098, expert1_balance_bottom=18.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=221.6, ups=0.57, wpb=386, bsz=32, num_updates=16880, lr=5.56867e-06, gnorm=3.499, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31172
2022-05-08 05:05:49 - progress_bar.py[line:272] - INFO: epoch 001:  16914 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870237, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=35.751, expert1_balance_bottom=18.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=221.7, ups=0.58, wpb=383.8, bsz=32, num_updates=16890, lr=5.56567e-06, gnorm=3.303, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31190
2022-05-08 05:06:06 - progress_bar.py[line:272] - INFO: epoch 001:  16924 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=377.6, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894429, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=34.058, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=216.9, ups=0.57, wpb=377.6, bsz=32, num_updates=16900, lr=5.56266e-06, gnorm=3.075, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31207
2022-05-08 05:06:24 - progress_bar.py[line:272] - INFO: epoch 001:  16934 / 17711 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.989, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.206, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.555, expert1_balance_bottom=18.815, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=219.1, ups=0.57, wpb=384.5, bsz=32, num_updates=16910, lr=5.55966e-06, gnorm=3.551, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31225
2022-05-08 05:06:41 - progress_bar.py[line:272] - INFO: epoch 001:  16944 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.992, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879785, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.084, expert1_balance_bottom=18.797, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=218, ups=0.57, wpb=381.5, bsz=32, num_updates=16920, lr=5.55666e-06, gnorm=3.797, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31242
2022-05-08 05:06:59 - progress_bar.py[line:272] - INFO: epoch 001:  16954 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.712, expert1_balance_bottom=18.62, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=220.5, ups=0.58, wpb=380.8, bsz=32, num_updates=16930, lr=5.55365e-06, gnorm=3.842, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31259
2022-05-08 05:07:04 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 05:07:18 - progress_bar.py[line:272] - INFO: epoch 001:  16965 / 17711 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=1.04, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=35.101, expert1_balance_bottom=18.567, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=202.4, ups=0.53, wpb=384.3, bsz=32, num_updates=16940, lr=5.55065e-06, gnorm=3.828, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31278
2022-05-08 05:07:35 - progress_bar.py[line:272] - INFO: epoch 001:  16975 / 17711 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=1.022, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892013, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.168, expert1_balance_bottom=18.92, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=220.7, ups=0.58, wpb=382, bsz=32, num_updates=16950, lr=5.54765e-06, gnorm=3.258, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31296
2022-05-08 05:07:52 - progress_bar.py[line:272] - INFO: epoch 001:  16985 / 17711 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=1.041, ntokens=381.2, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.244, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.961, expert1_balance_bottom=18.64, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.06, wps=217, ups=0.57, wpb=381.2, bsz=32, num_updates=16960, lr=5.54464e-06, gnorm=3.622, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31313
2022-05-08 05:08:10 - progress_bar.py[line:272] - INFO: epoch 001:  16995 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=377.5, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891568, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.527, expert1_balance_bottom=18.732, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.8, ups=0.58, wpb=377.5, bsz=32, num_updates=16970, lr=5.54164e-06, gnorm=2.982, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31331
2022-05-08 05:08:27 - progress_bar.py[line:272] - INFO: epoch 001:  17005 / 17711 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=374.5, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884408, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.185, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.8, expert1_balance_bottom=18.713, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=216.2, ups=0.58, wpb=374.5, bsz=32, num_updates=16980, lr=5.53864e-06, gnorm=3.799, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31348
2022-05-08 05:08:45 - progress_bar.py[line:272] - INFO: epoch 001:  17015 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887904, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.36, expert1_balance_bottom=18.678, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=216.3, ups=0.57, wpb=381.2, bsz=32, num_updates=16990, lr=5.53563e-06, gnorm=3.069, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31366
2022-05-08 05:09:02 - progress_bar.py[line:272] - INFO: epoch 001:  17025 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87904, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=35.111, expert1_balance_bottom=18.682, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=221.1, ups=0.57, wpb=385.9, bsz=32, num_updates=17000, lr=5.53263e-06, gnorm=3.093, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31383
2022-05-08 05:09:19 - progress_bar.py[line:272] - INFO: epoch 001:  17035 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=376.2, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878385, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=35.627, expert1_balance_bottom=18.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.1, ups=0.59, wpb=376.2, bsz=32, num_updates=17010, lr=5.52963e-06, gnorm=3.06, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=31400
2022-05-08 05:09:36 - progress_bar.py[line:272] - INFO: epoch 001:  17045 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=1.007, ntokens=387.2, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.054, expert1_balance_bottom=18.678, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=224.5, ups=0.58, wpb=387.2, bsz=32, num_updates=17020, lr=5.52662e-06, gnorm=3.728, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31417
2022-05-08 05:09:54 - progress_bar.py[line:272] - INFO: epoch 001:  17055 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=370.5, nsentences=32, sample_size=295, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.55, expert1_balance_bottom=18.762, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=212.6, ups=0.57, wpb=370.5, bsz=32, num_updates=17030, lr=5.52362e-06, gnorm=2.803, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31435
2022-05-08 05:10:11 - progress_bar.py[line:272] - INFO: epoch 001:  17065 / 17711 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=375.3, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.196, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.492, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=213.2, ups=0.57, wpb=375.3, bsz=32, num_updates=17040, lr=5.52062e-06, gnorm=3.33, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=31452
2022-05-08 05:10:29 - progress_bar.py[line:272] - INFO: epoch 001:  17075 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=378.1, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=35.669, expert1_balance_bottom=18.454, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=219.1, ups=0.58, wpb=378.1, bsz=32, num_updates=17050, lr=5.51761e-06, gnorm=3.274, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31469
2022-05-08 05:10:46 - progress_bar.py[line:272] - INFO: epoch 001:  17085 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=376.2, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877305, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.649, expert1_balance_bottom=18.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=218.1, ups=0.58, wpb=376.2, bsz=32, num_updates=17060, lr=5.51461e-06, gnorm=3.957, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31487
2022-05-08 05:11:03 - progress_bar.py[line:272] - INFO: epoch 001:  17095 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=387.8, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=34.867, expert1_balance_bottom=18.642, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=224.2, ups=0.58, wpb=387.8, bsz=32, num_updates=17070, lr=5.51161e-06, gnorm=3.167, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31504
2022-05-08 05:11:21 - progress_bar.py[line:272] - INFO: epoch 001:  17105 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=393.1, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=33.801, expert1_balance_bottom=19.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=227.4, ups=0.58, wpb=393.1, bsz=32, num_updates=17080, lr=5.5086e-06, gnorm=3.049, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31521
2022-05-08 05:11:37 - progress_bar.py[line:272] - INFO: epoch 001:  17115 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.992, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=34.967, expert1_balance_bottom=18.802, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=236.1, ups=0.61, wpb=388, bsz=32, num_updates=17090, lr=5.5056e-06, gnorm=3.766, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31538
2022-05-08 05:11:54 - progress_bar.py[line:272] - INFO: epoch 001:  17125 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.957, ntokens=377.7, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.642, expert1_balance_bottom=18.753, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=217, ups=0.57, wpb=377.7, bsz=32, num_updates=17100, lr=5.5026e-06, gnorm=3.36, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31555
2022-05-08 05:12:12 - progress_bar.py[line:272] - INFO: epoch 001:  17135 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888289, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.657, expert1_balance_bottom=18.792, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=218.1, ups=0.58, wpb=378.5, bsz=32, num_updates=17110, lr=5.49959e-06, gnorm=3.706, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31572
2022-05-08 05:12:29 - progress_bar.py[line:272] - INFO: epoch 001:  17145 / 17711 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.192, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.239, expert1_balance_bottom=18.688, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=222.5, ups=0.58, wpb=385.5, bsz=32, num_updates=17120, lr=5.49659e-06, gnorm=3.243, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31590
2022-05-08 05:12:46 - progress_bar.py[line:272] - INFO: epoch 001:  17155 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=379.7, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892726, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.535, expert1_balance_bottom=18.85, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220.2, ups=0.58, wpb=379.7, bsz=32, num_updates=17130, lr=5.49359e-06, gnorm=2.956, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=31607
2022-05-08 05:13:04 - progress_bar.py[line:272] - INFO: epoch 001:  17165 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88839, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.734, expert1_balance_bottom=18.709, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.3, ups=0.56, wpb=379.8, bsz=32, num_updates=17140, lr=5.49058e-06, gnorm=3.153, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31625
2022-05-08 05:13:21 - progress_bar.py[line:272] - INFO: epoch 001:  17175 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=33.974, expert1_balance_bottom=18.839, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=225.3, ups=0.59, wpb=382.2, bsz=32, num_updates=17150, lr=5.48758e-06, gnorm=2.989, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31642
2022-05-08 05:13:38 - progress_bar.py[line:272] - INFO: epoch 001:  17185 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=378.8, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891029, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=34.64, expert1_balance_bottom=18.754, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219.5, ups=0.58, wpb=378.8, bsz=32, num_updates=17160, lr=5.48458e-06, gnorm=2.846, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31659
2022-05-08 05:13:55 - progress_bar.py[line:272] - INFO: epoch 001:  17195 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=388.4, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890198, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.338, expert1_balance_bottom=18.845, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=230.6, ups=0.59, wpb=388.4, bsz=32, num_updates=17170, lr=5.48157e-06, gnorm=3.17, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31676
2022-05-08 05:14:12 - progress_bar.py[line:272] - INFO: epoch 001:  17205 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872314, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=35.869, expert1_balance_bottom=18.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=228.4, ups=0.59, wpb=385.7, bsz=32, num_updates=17180, lr=5.47857e-06, gnorm=3.516, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31693
2022-05-08 05:14:29 - progress_bar.py[line:272] - INFO: epoch 001:  17215 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.134, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=222.9, ups=0.59, wpb=380.7, bsz=32, num_updates=17190, lr=5.47557e-06, gnorm=3.179, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=31710
2022-05-08 05:14:46 - progress_bar.py[line:272] - INFO: epoch 001:  17225 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=388, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=34.926, expert1_balance_bottom=18.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.5, ups=0.58, wpb=388, bsz=32, num_updates=17200, lr=5.47257e-06, gnorm=3.817, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31727
2022-05-08 05:15:03 - progress_bar.py[line:272] - INFO: epoch 001:  17235 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.625, expert1_balance_bottom=18.722, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=225.4, ups=0.59, wpb=383.7, bsz=32, num_updates=17210, lr=5.46956e-06, gnorm=3.367, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31744
2022-05-08 05:15:20 - progress_bar.py[line:272] - INFO: epoch 001:  17245 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.986, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=35.147, expert1_balance_bottom=18.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=225.1, ups=0.59, wpb=383.6, bsz=32, num_updates=17220, lr=5.46656e-06, gnorm=3.751, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31761
2022-05-08 05:15:37 - progress_bar.py[line:272] - INFO: epoch 001:  17255 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=378, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90034, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=33.873, expert1_balance_bottom=18.892, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221.1, ups=0.58, wpb=378, bsz=32, num_updates=17230, lr=5.46356e-06, gnorm=3.122, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31778
2022-05-08 05:15:55 - progress_bar.py[line:272] - INFO: epoch 001:  17265 / 17711 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=372.9, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.171, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.262, expert1_balance_top=34.567, expert1_balance_bottom=18.528, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=217.1, ups=0.58, wpb=372.9, bsz=32, num_updates=17240, lr=5.46055e-06, gnorm=3.309, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31795
2022-05-08 05:16:12 - progress_bar.py[line:272] - INFO: epoch 001:  17275 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880648, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=35.345, expert1_balance_bottom=18.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=218.7, ups=0.57, wpb=384.2, bsz=32, num_updates=17250, lr=5.45755e-06, gnorm=3.305, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31813
2022-05-08 05:16:30 - progress_bar.py[line:272] - INFO: epoch 001:  17285 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.279, expert1_balance_bottom=18.584, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=217.3, ups=0.57, wpb=380.1, bsz=32, num_updates=17260, lr=5.45455e-06, gnorm=3.066, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=31830
2022-05-08 05:16:47 - progress_bar.py[line:272] - INFO: epoch 001:  17295 / 17711 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=384, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885021, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.167, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.72, expert1_balance_bottom=18.904, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=220.1, ups=0.57, wpb=384, bsz=32, num_updates=17270, lr=5.45154e-06, gnorm=3.362, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31848
2022-05-08 05:17:04 - progress_bar.py[line:272] - INFO: epoch 001:  17305 / 17711 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886385, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.219, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.499, expert1_balance_bottom=18.683, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=221, ups=0.58, wpb=382.4, bsz=32, num_updates=17280, lr=5.44854e-06, gnorm=3.524, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31865
2022-05-08 05:17:22 - progress_bar.py[line:272] - INFO: epoch 001:  17315 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=378.6, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887818, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.587, expert1_balance_bottom=18.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=219.7, ups=0.58, wpb=378.6, bsz=32, num_updates=17290, lr=5.44554e-06, gnorm=3.519, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31882
2022-05-08 05:17:39 - progress_bar.py[line:272] - INFO: epoch 001:  17325 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=380.3, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879519, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=34.778, expert1_balance_bottom=18.621, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=220.3, ups=0.58, wpb=380.3, bsz=32, num_updates=17300, lr=5.44253e-06, gnorm=3.326, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31900
2022-05-08 05:17:56 - progress_bar.py[line:272] - INFO: epoch 001:  17335 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=384.1, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=34.481, expert1_balance_bottom=18.904, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=224.9, ups=0.59, wpb=384.1, bsz=32, num_updates=17310, lr=5.43953e-06, gnorm=3.293, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31917
2022-05-08 05:18:13 - progress_bar.py[line:272] - INFO: epoch 001:  17345 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=34.724, expert1_balance_bottom=18.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.1, ups=0.58, wpb=381.6, bsz=32, num_updates=17320, lr=5.43653e-06, gnorm=2.997, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31934
2022-05-08 05:18:31 - progress_bar.py[line:272] - INFO: epoch 001:  17355 / 17711 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.192, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.168, expert1_balance_bottom=18.589, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=222.8, ups=0.58, wpb=384.3, bsz=32, num_updates=17330, lr=5.43352e-06, gnorm=3.571, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31951
2022-05-08 05:18:48 - progress_bar.py[line:272] - INFO: epoch 001:  17365 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=35.569, expert1_balance_bottom=18.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.3, ups=0.58, wpb=383.5, bsz=32, num_updates=17340, lr=5.43052e-06, gnorm=3.71, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31969
2022-05-08 05:19:05 - progress_bar.py[line:272] - INFO: epoch 001:  17375 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=379.7, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894331, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.26, expert1_balance_top=34.008, expert1_balance_bottom=18.853, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=218.4, ups=0.58, wpb=379.7, bsz=32, num_updates=17350, lr=5.42752e-06, gnorm=3.383, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=31986
2022-05-08 05:19:23 - progress_bar.py[line:272] - INFO: epoch 001:  17385 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=384.6, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879252, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=34.855, expert1_balance_bottom=18.751, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.3, ups=0.57, wpb=384.6, bsz=32, num_updates=17360, lr=5.42451e-06, gnorm=3.238, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32003
2022-05-08 05:19:40 - progress_bar.py[line:272] - INFO: epoch 001:  17395 / 17711 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.207, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=35.193, expert1_balance_bottom=18.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=221.5, ups=0.58, wpb=382.9, bsz=32, num_updates=17370, lr=5.42151e-06, gnorm=3.614, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=32021
2022-05-08 05:19:57 - progress_bar.py[line:272] - INFO: epoch 001:  17405 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.99, ntokens=385.4, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=35.571, expert1_balance_bottom=18.452, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=220.2, ups=0.57, wpb=385.4, bsz=32, num_updates=17380, lr=5.41851e-06, gnorm=3.58, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32038
2022-05-08 05:20:15 - progress_bar.py[line:272] - INFO: epoch 001:  17415 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.979, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=34.274, expert1_balance_bottom=18.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=221, ups=0.58, wpb=383.2, bsz=32, num_updates=17390, lr=5.4155e-06, gnorm=2.997, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32056
2022-05-08 05:20:32 - progress_bar.py[line:272] - INFO: epoch 001:  17425 / 17711 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=378.6, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.174, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=35.122, expert1_balance_bottom=18.723, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=220.4, ups=0.58, wpb=378.6, bsz=32, num_updates=17400, lr=5.4125e-06, gnorm=3.586, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32073
2022-05-08 05:20:49 - progress_bar.py[line:272] - INFO: epoch 001:  17435 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=393.9, nsentences=32, sample_size=313.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883734, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.122, expert1_balance_bottom=18.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=229.5, ups=0.58, wpb=393.9, bsz=32, num_updates=17410, lr=5.4095e-06, gnorm=3.218, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32090
2022-05-08 05:21:06 - progress_bar.py[line:272] - INFO: epoch 001:  17445 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=388.3, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=34.278, expert1_balance_bottom=18.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=227.2, ups=0.59, wpb=388.3, bsz=32, num_updates=17420, lr=5.40649e-06, gnorm=3.388, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32107
2022-05-08 05:21:23 - progress_bar.py[line:272] - INFO: epoch 001:  17455 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=385.8, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=34.812, expert1_balance_bottom=18.711, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=223.3, ups=0.58, wpb=385.8, bsz=32, num_updates=17430, lr=5.40349e-06, gnorm=3.293, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32124
2022-05-08 05:21:41 - progress_bar.py[line:272] - INFO: epoch 001:  17465 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890793, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.48, expert1_balance_bottom=18.917, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220, ups=0.58, wpb=380.9, bsz=32, num_updates=17440, lr=5.40049e-06, gnorm=3.631, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32142
2022-05-08 05:21:58 - progress_bar.py[line:272] - INFO: epoch 001:  17475 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=377.9, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891342, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=34.706, expert1_balance_bottom=18.71, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=223.5, ups=0.59, wpb=377.9, bsz=32, num_updates=17450, lr=5.39748e-06, gnorm=3.135, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32158
2022-05-08 05:22:15 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 05:22:17 - progress_bar.py[line:272] - INFO: epoch 001:  17486 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=384.2, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.257, expert1_balance_bottom=18.949, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=201.6, ups=0.52, wpb=384.2, bsz=32, num_updates=17460, lr=5.39448e-06, gnorm=3.51, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32178
2022-05-08 05:22:34 - progress_bar.py[line:272] - INFO: epoch 001:  17496 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=35.227, expert1_balance_bottom=18.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=218, ups=0.58, wpb=378.5, bsz=32, num_updates=17470, lr=5.39148e-06, gnorm=2.871, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32195
2022-05-08 05:22:51 - progress_bar.py[line:272] - INFO: epoch 001:  17506 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=376.1, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894978, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.483, expert1_balance_bottom=18.824, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.1, ups=0.58, wpb=376.1, bsz=32, num_updates=17480, lr=5.38847e-06, gnorm=3.28, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32212
2022-05-08 05:23:09 - progress_bar.py[line:272] - INFO: epoch 001:  17516 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=35.823, expert1_balance_bottom=18.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=220.3, ups=0.57, wpb=383.3, bsz=32, num_updates=17490, lr=5.38547e-06, gnorm=2.977, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32230
2022-05-08 05:23:26 - progress_bar.py[line:272] - INFO: epoch 001:  17526 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=381.4, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880678, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=35.405, expert1_balance_bottom=18.575, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=218.3, ups=0.57, wpb=381.4, bsz=32, num_updates=17500, lr=5.38247e-06, gnorm=3.335, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32247
2022-05-08 05:23:44 - progress_bar.py[line:272] - INFO: epoch 001:  17536 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=377.7, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=34.276, expert1_balance_bottom=18.845, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=217.8, ups=0.58, wpb=377.7, bsz=32, num_updates=17510, lr=5.37946e-06, gnorm=2.883, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32264
2022-05-08 05:24:01 - progress_bar.py[line:272] - INFO: epoch 001:  17546 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884686, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=34.865, expert1_balance_bottom=18.685, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=217.1, ups=0.57, wpb=380.5, bsz=32, num_updates=17520, lr=5.37646e-06, gnorm=3.191, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32282
2022-05-08 05:24:19 - progress_bar.py[line:272] - INFO: epoch 001:  17556 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=35.429, expert1_balance_bottom=18.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=217, ups=0.57, wpb=379.2, bsz=32, num_updates=17530, lr=5.37346e-06, gnorm=2.953, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32299
2022-05-08 05:24:36 - progress_bar.py[line:272] - INFO: epoch 001:  17566 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.9, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=220.6, ups=0.57, wpb=386.4, bsz=32, num_updates=17540, lr=5.37045e-06, gnorm=3.553, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=32317
2022-05-08 05:24:53 - progress_bar.py[line:272] - INFO: epoch 001:  17576 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=382.3, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=35.822, expert1_balance_bottom=18.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.3, ups=0.58, wpb=382.3, bsz=32, num_updates=17550, lr=5.36745e-06, gnorm=3.178, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32334
2022-05-08 05:25:11 - progress_bar.py[line:272] - INFO: epoch 001:  17586 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=387.8, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=35.356, expert1_balance_bottom=18.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219.8, ups=0.57, wpb=387.8, bsz=32, num_updates=17560, lr=5.36445e-06, gnorm=2.982, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32352
2022-05-08 05:25:28 - progress_bar.py[line:272] - INFO: epoch 001:  17596 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887299, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=35.025, expert1_balance_bottom=18.716, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=220.7, ups=0.58, wpb=381.3, bsz=32, num_updates=17570, lr=5.36144e-06, gnorm=3.214, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32369
2022-05-08 05:25:46 - progress_bar.py[line:272] - INFO: epoch 001:  17606 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=391, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=35.493, expert1_balance_bottom=18.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222, ups=0.57, wpb=391, bsz=32, num_updates=17580, lr=5.35844e-06, gnorm=3.789, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32387
2022-05-08 05:26:04 - progress_bar.py[line:272] - INFO: epoch 001:  17616 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=391.1, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=34.551, expert1_balance_bottom=18.856, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222.9, ups=0.57, wpb=391.1, bsz=32, num_updates=17590, lr=5.35544e-06, gnorm=3.452, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32404
2022-05-08 05:26:21 - progress_bar.py[line:272] - INFO: epoch 001:  17626 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=386.5, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=34.751, expert1_balance_bottom=18.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221.1, ups=0.57, wpb=386.5, bsz=32, num_updates=17600, lr=5.35243e-06, gnorm=3.238, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32422
2022-05-08 05:26:38 - progress_bar.py[line:272] - INFO: epoch 001:  17636 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=383.7, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878927, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=35.2, expert1_balance_bottom=18.737, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.8, ups=0.58, wpb=383.7, bsz=32, num_updates=17610, lr=5.34943e-06, gnorm=3.21, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32439
2022-05-08 05:26:56 - progress_bar.py[line:272] - INFO: epoch 001:  17646 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878905, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=35.707, expert1_balance_bottom=18.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.6, ups=0.58, wpb=379, bsz=32, num_updates=17620, lr=5.34643e-06, gnorm=3.278, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32456
2022-05-08 05:27:13 - progress_bar.py[line:272] - INFO: epoch 001:  17656 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=373.5, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.261, expert1_balance_top=33.597, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.9, ups=0.58, wpb=373.5, bsz=32, num_updates=17630, lr=5.34342e-06, gnorm=3.114, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32474
2022-05-08 05:27:30 - progress_bar.py[line:272] - INFO: epoch 001:  17666 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.98, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.259, expert1_balance_top=34.248, expert1_balance_bottom=18.928, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=223.1, ups=0.58, wpb=385.1, bsz=32, num_updates=17640, lr=5.34042e-06, gnorm=3.201, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32491
2022-05-08 05:27:48 - progress_bar.py[line:272] - INFO: epoch 001:  17676 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.406, expert1_balance_bottom=18.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220.3, ups=0.57, wpb=383.3, bsz=32, num_updates=17650, lr=5.33742e-06, gnorm=3.335, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32508
2022-05-08 05:28:05 - progress_bar.py[line:272] - INFO: epoch 001:  17686 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=375.8, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895046, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.258, expert1_balance_top=34.717, expert1_balance_bottom=18.768, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.3, ups=0.58, wpb=375.8, bsz=32, num_updates=17660, lr=5.33441e-06, gnorm=3.169, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32526
2022-05-08 05:28:22 - progress_bar.py[line:272] - INFO: epoch 001:  17696 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=376.6, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882828, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=34.858, expert1_balance_bottom=18.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=221.4, ups=0.59, wpb=376.6, bsz=32, num_updates=17670, lr=5.33141e-06, gnorm=3.222, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32543
2022-05-08 05:28:39 - progress_bar.py[line:272] - INFO: epoch 001:  17706 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89673, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=34.054, expert1_balance_bottom=18.967, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.9, ups=0.57, wpb=381.5, bsz=32, num_updates=17680, lr=5.32841e-06, gnorm=2.942, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=32560
2022-05-08 05:28:48 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 05:28:48 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 05:28:48 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 05:35:57 - train.py[line:517] - INFO: valid_step finished
2022-05-08 05:35:57 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.154 | loss_v1 0 | loss_v2 0 | nll_loss 7.434 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.970813 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.154 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.289 | expert1_balance_top 36.252 | expert1_balance_bottom 14.781 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 172.98 | cider 1.171 | wps 701.8 | wpb 481.7 | bsz 8 | num_updates 17685 | best_cider 1.171
2022-05-08 05:35:57 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 1 @ 17685 updates
2022-05-08 05:35:57 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_best-rank-0.pt
2022-05-08 05:35:57 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_best-rank-0.pt
2022-05-08 05:36:08 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_best-rank-0.pt
2022-05-08 05:36:08 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_best-shared.pt
2022-05-08 05:36:20 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_best-shared.pt
2022-05-08 05:36:36 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_best-rank-0.pt (epoch 1 @ 17685 updates, score 1.171) (writing took 38.459299069829285 seconds)
2022-05-08 05:36:36 - train.py[line:342] - INFO: end of epoch 1 (average epoch stats below)
2022-05-08 05:36:36 - progress_bar.py[line:282] - INFO: epoch 001 | loss 3.721 | loss_v1 0 | loss_v2 0 | nll_loss 1.442 | ntokens 382.703 | nsentences 32 | sample_size 315.628 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.891068 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 3.721 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.329 | expert1_balance_top 36.341 | expert1_balance_bottom 17.057 | unused_expert1_count 0.006 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 2.72 | wps 205.2 | ups 0.54 | wpb 382.7 | bsz 32 | num_updates 17685 | lr 5.32691e-06 | gnorm 3.908 | loss_scale 64 | train_wall 29179 | cuda_gb_allocated 14.1 | cuda_gb_reserved 14.9 | cuda_gb_free 9.6 | wall 33037
2022-05-08 05:36:36 - trainer.py[line:743] - INFO: loading train data for epoch 2
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 row count 566747 total row count 566747
slice_id 0 seek offset 0
2022-05-08 05:37:06 - trainer.py[line:807] - INFO: begin training epoch 2
2022-05-08 05:37:06 - train.py[line:315] - INFO: Start iterating over samples
2022-05-08 05:37:15 - progress_bar.py[line:272] - INFO: epoch 002:      5 / 17711 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878971, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.192, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.674, expert1_balance_bottom=18.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=7.4, ups=0.02, wpb=381.7, bsz=32, num_updates=17690, lr=5.3254e-06, gnorm=3.332, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33076
2022-05-08 05:37:32 - progress_bar.py[line:272] - INFO: epoch 002:     15 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=387.4, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=35.65, expert1_balance_bottom=18.474, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.5, ups=0.58, wpb=387.4, bsz=32, num_updates=17700, lr=5.3224e-06, gnorm=3.316, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33093
2022-05-08 05:37:50 - progress_bar.py[line:272] - INFO: epoch 002:     25 / 17711 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=34.227, expert1_balance_bottom=18.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=216.5, ups=0.57, wpb=379.5, bsz=32, num_updates=17710, lr=5.3194e-06, gnorm=3.25, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33111
2022-05-08 05:38:07 - progress_bar.py[line:272] - INFO: epoch 002:     35 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=374.7, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=35.113, expert1_balance_bottom=18.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=215, ups=0.57, wpb=374.7, bsz=32, num_updates=17720, lr=5.31639e-06, gnorm=3.139, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33128
2022-05-08 05:38:24 - progress_bar.py[line:272] - INFO: epoch 002:     45 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=35.146, expert1_balance_bottom=18.602, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223.7, ups=0.58, wpb=384.5, bsz=32, num_updates=17730, lr=5.31339e-06, gnorm=3.228, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=33145
2022-05-08 05:38:42 - progress_bar.py[line:272] - INFO: epoch 002:     55 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=34.65, expert1_balance_bottom=18.833, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224.7, ups=0.58, wpb=386.1, bsz=32, num_updates=17740, lr=5.31039e-06, gnorm=3.382, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33162
2022-05-08 05:38:59 - progress_bar.py[line:272] - INFO: epoch 002:     65 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=381.9, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884678, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.846, expert1_balance_bottom=18.788, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.8, ups=0.59, wpb=381.9, bsz=32, num_updates=17750, lr=5.30739e-06, gnorm=3.309, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33180
2022-05-08 05:39:16 - progress_bar.py[line:272] - INFO: epoch 002:     75 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=373, nsentences=32, sample_size=296.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876957, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=35.447, expert1_balance_bottom=18.613, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216, ups=0.58, wpb=373, bsz=32, num_updates=17760, lr=5.30438e-06, gnorm=3.369, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=33197
2022-05-08 05:39:33 - progress_bar.py[line:272] - INFO: epoch 002:     85 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885689, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.769, expert1_balance_bottom=18.642, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.2, ups=0.58, wpb=384.9, bsz=32, num_updates=17770, lr=5.30138e-06, gnorm=3.749, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33214
2022-05-08 05:39:51 - progress_bar.py[line:272] - INFO: epoch 002:     95 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=388.6, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=33.86, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=225.4, ups=0.58, wpb=388.6, bsz=32, num_updates=17780, lr=5.29838e-06, gnorm=3.002, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33231
2022-05-08 05:40:08 - progress_bar.py[line:272] - INFO: epoch 002:    105 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=397.9, nsentences=32, sample_size=316.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865662, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=35.601, expert1_balance_bottom=18.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=229.6, ups=0.58, wpb=397.9, bsz=32, num_updates=17790, lr=5.29537e-06, gnorm=3.258, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33249
2022-05-08 05:40:25 - progress_bar.py[line:272] - INFO: epoch 002:    115 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=379.1, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887193, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=34.415, expert1_balance_bottom=18.923, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219.5, ups=0.58, wpb=379.1, bsz=32, num_updates=17800, lr=5.29237e-06, gnorm=3.315, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33266
2022-05-08 05:40:42 - progress_bar.py[line:272] - INFO: epoch 002:    125 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=379.6, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892328, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.314, expert1_balance_bottom=18.642, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220, ups=0.58, wpb=379.6, bsz=32, num_updates=17810, lr=5.28937e-06, gnorm=3.463, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33283
2022-05-08 05:41:00 - progress_bar.py[line:272] - INFO: epoch 002:    135 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=382.2, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=34.841, expert1_balance_bottom=18.589, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=220.8, ups=0.58, wpb=382.2, bsz=32, num_updates=17820, lr=5.28636e-06, gnorm=3.482, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33301
2022-05-08 05:41:17 - progress_bar.py[line:272] - INFO: epoch 002:    145 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.388, expert1_balance_bottom=18.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.5, ups=0.58, wpb=380.1, bsz=32, num_updates=17830, lr=5.28336e-06, gnorm=3.343, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33318
2022-05-08 05:41:34 - progress_bar.py[line:272] - INFO: epoch 002:    155 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=379.7, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891234, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.829, expert1_balance_bottom=18.754, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=221.9, ups=0.58, wpb=379.7, bsz=32, num_updates=17840, lr=5.28036e-06, gnorm=3.479, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33335
2022-05-08 05:41:51 - progress_bar.py[line:272] - INFO: epoch 002:    165 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885408, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=34.687, expert1_balance_bottom=18.641, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.7, ups=0.58, wpb=382.6, bsz=32, num_updates=17850, lr=5.27735e-06, gnorm=3.5, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=33352
2022-05-08 05:42:08 - progress_bar.py[line:272] - INFO: epoch 002:    175 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=377.7, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=34.031, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=220.7, ups=0.58, wpb=377.7, bsz=32, num_updates=17860, lr=5.27435e-06, gnorm=3.703, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33369
2022-05-08 05:42:26 - progress_bar.py[line:272] - INFO: epoch 002:    185 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=384.4, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=34.707, expert1_balance_bottom=18.831, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.9, ups=0.58, wpb=384.4, bsz=32, num_updates=17870, lr=5.27135e-06, gnorm=3.425, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=33386
2022-05-08 05:42:43 - progress_bar.py[line:272] - INFO: epoch 002:    195 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877324, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=35.215, expert1_balance_bottom=18.548, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.7, ups=0.58, wpb=385.8, bsz=32, num_updates=17880, lr=5.26834e-06, gnorm=2.774, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33404
2022-05-08 05:43:00 - progress_bar.py[line:272] - INFO: epoch 002:    205 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=384.4, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884563, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.628, expert1_balance_bottom=18.651, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=220.9, ups=0.57, wpb=384.4, bsz=32, num_updates=17890, lr=5.26534e-06, gnorm=3.147, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33421
2022-05-08 05:43:18 - progress_bar.py[line:272] - INFO: epoch 002:    215 / 17711 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=377.3, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.235, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=35.057, expert1_balance_bottom=18.644, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=216.7, ups=0.57, wpb=377.3, bsz=32, num_updates=17900, lr=5.26234e-06, gnorm=3.597, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33438
2022-05-08 05:43:35 - progress_bar.py[line:272] - INFO: epoch 002:    225 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.557, expert1_balance_bottom=18.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=220.1, ups=0.58, wpb=379, bsz=32, num_updates=17910, lr=5.25933e-06, gnorm=2.747, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33456
2022-05-08 05:43:52 - progress_bar.py[line:272] - INFO: epoch 002:    235 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=372.6, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.736, expert1_balance_bottom=18.74, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=216.7, ups=0.58, wpb=372.6, bsz=32, num_updates=17920, lr=5.25633e-06, gnorm=3.172, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33473
2022-05-08 05:44:09 - progress_bar.py[line:272] - INFO: epoch 002:    245 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866658, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=36.066, expert1_balance_bottom=18.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.5, ups=0.58, wpb=385.6, bsz=32, num_updates=17930, lr=5.25333e-06, gnorm=3.513, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33490
2022-05-08 05:44:27 - progress_bar.py[line:272] - INFO: epoch 002:    255 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=385.3, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88393, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=35.062, expert1_balance_bottom=18.564, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=221.6, ups=0.58, wpb=385.3, bsz=32, num_updates=17940, lr=5.25032e-06, gnorm=3.363, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33507
2022-05-08 05:44:44 - progress_bar.py[line:272] - INFO: epoch 002:    265 / 17711 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=1.007, ntokens=386, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865144, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=35.958, expert1_balance_bottom=18.572, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=222.8, ups=0.58, wpb=386, bsz=32, num_updates=17950, lr=5.24732e-06, gnorm=3.676, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33525
2022-05-08 05:45:01 - progress_bar.py[line:272] - INFO: epoch 002:    275 / 17711 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.196, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=34.164, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=220.4, ups=0.58, wpb=381.8, bsz=32, num_updates=17960, lr=5.24432e-06, gnorm=3.157, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33542
2022-05-08 05:45:18 - progress_bar.py[line:272] - INFO: epoch 002:    285 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886475, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=35.052, expert1_balance_bottom=18.682, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=225.4, ups=0.59, wpb=384.8, bsz=32, num_updates=17970, lr=5.24131e-06, gnorm=2.974, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=33559
2022-05-08 05:45:36 - progress_bar.py[line:272] - INFO: epoch 002:    295 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=375.9, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=34.157, expert1_balance_bottom=18.964, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=218.4, ups=0.58, wpb=375.9, bsz=32, num_updates=17980, lr=5.23831e-06, gnorm=2.783, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33576
2022-05-08 05:45:52 - progress_bar.py[line:272] - INFO: epoch 002:    305 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884611, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=34.822, expert1_balance_bottom=18.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223.4, ups=0.59, wpb=378.8, bsz=32, num_updates=17990, lr=5.23531e-06, gnorm=2.88, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33593
2022-05-08 05:46:10 - progress_bar.py[line:272] - INFO: epoch 002:    315 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88154, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=34.747, expert1_balance_bottom=18.789, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.2, ups=0.58, wpb=384.2, bsz=32, num_updates=18000, lr=5.2323e-06, gnorm=2.792, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33610
2022-05-08 05:46:27 - progress_bar.py[line:272] - INFO: epoch 002:    325 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=1.001, ntokens=381.5, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884042, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=34.827, expert1_balance_bottom=18.762, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=222.2, ups=0.58, wpb=381.5, bsz=32, num_updates=18010, lr=5.2293e-06, gnorm=3.459, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33628
2022-05-08 05:46:44 - progress_bar.py[line:272] - INFO: epoch 002:    335 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=390.1, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888452, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=34.47, expert1_balance_bottom=18.812, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=229.4, ups=0.59, wpb=390.1, bsz=32, num_updates=18020, lr=5.2263e-06, gnorm=3.531, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33645
2022-05-08 05:47:01 - progress_bar.py[line:272] - INFO: epoch 002:    345 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=375.8, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=34.372, expert1_balance_bottom=19.014, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.4, ups=0.58, wpb=375.8, bsz=32, num_updates=18030, lr=5.22329e-06, gnorm=2.993, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=33662
2022-05-08 05:47:18 - progress_bar.py[line:272] - INFO: epoch 002:    355 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=384.6, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900497, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.257, expert1_balance_top=33.922, expert1_balance_bottom=19.037, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.8, ups=0.59, wpb=384.6, bsz=32, num_updates=18040, lr=5.22029e-06, gnorm=3.244, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33679
2022-05-08 05:47:35 - progress_bar.py[line:272] - INFO: epoch 002:    365 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=34.51, expert1_balance_bottom=18.868, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=221.9, ups=0.58, wpb=383.3, bsz=32, num_updates=18050, lr=5.21729e-06, gnorm=4.114, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33696
2022-05-08 05:47:52 - progress_bar.py[line:272] - INFO: epoch 002:    375 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=389.6, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=33.819, expert1_balance_bottom=19.171, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=226.5, ups=0.58, wpb=389.6, bsz=32, num_updates=18060, lr=5.21428e-06, gnorm=2.915, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=33713
2022-05-08 05:48:09 - progress_bar.py[line:272] - INFO: epoch 002:    385 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890861, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=34.452, expert1_balance_bottom=18.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=226.6, ups=0.59, wpb=385.7, bsz=32, num_updates=18070, lr=5.21128e-06, gnorm=3.185, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33730
2022-05-08 05:48:27 - progress_bar.py[line:272] - INFO: epoch 002:    395 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=395.3, nsentences=32, sample_size=314.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=36.027, expert1_balance_bottom=18.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=228.7, ups=0.58, wpb=395.3, bsz=32, num_updates=18080, lr=5.20828e-06, gnorm=3.447, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33748
2022-05-08 05:48:44 - progress_bar.py[line:272] - INFO: epoch 002:    405 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=35.096, expert1_balance_bottom=18.69, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=223.6, ups=0.58, wpb=382.4, bsz=32, num_updates=18090, lr=5.20527e-06, gnorm=3.296, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33765
2022-05-08 05:49:01 - progress_bar.py[line:272] - INFO: epoch 002:    415 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883828, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=34.49, expert1_balance_bottom=18.939, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=220.5, ups=0.58, wpb=379.2, bsz=32, num_updates=18100, lr=5.20227e-06, gnorm=2.893, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33782
2022-05-08 05:49:19 - progress_bar.py[line:272] - INFO: epoch 002:    425 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=34.989, expert1_balance_bottom=18.654, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=218.1, ups=0.57, wpb=381.9, bsz=32, num_updates=18110, lr=5.19927e-06, gnorm=3.109, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33799
2022-05-08 05:49:36 - progress_bar.py[line:272] - INFO: epoch 002:    435 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=385.3, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875525, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=35.145, expert1_balance_bottom=18.775, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=224.9, ups=0.58, wpb=385.3, bsz=32, num_updates=18120, lr=5.19626e-06, gnorm=3.17, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33816
2022-05-08 05:49:53 - progress_bar.py[line:272] - INFO: epoch 002:    445 / 17711 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=372.9, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890331, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.179, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.254, expert1_balance_top=34.257, expert1_balance_bottom=19.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=217, ups=0.58, wpb=372.9, bsz=32, num_updates=18130, lr=5.19326e-06, gnorm=3.228, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33834
2022-05-08 05:50:10 - progress_bar.py[line:272] - INFO: epoch 002:    455 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=377.8, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=34.886, expert1_balance_bottom=18.686, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=220.7, ups=0.58, wpb=377.8, bsz=32, num_updates=18140, lr=5.19026e-06, gnorm=3.658, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33851
2022-05-08 05:50:27 - progress_bar.py[line:272] - INFO: epoch 002:    465 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.98, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=34.68, expert1_balance_bottom=18.745, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=218.7, ups=0.57, wpb=380.5, bsz=32, num_updates=18150, lr=5.18725e-06, gnorm=3.287, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33868
2022-05-08 05:50:45 - progress_bar.py[line:272] - INFO: epoch 002:    475 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=379.1, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=34.289, expert1_balance_bottom=18.826, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.6, ups=0.58, wpb=379.1, bsz=32, num_updates=18160, lr=5.18425e-06, gnorm=3.604, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33885
2022-05-08 05:51:02 - progress_bar.py[line:272] - INFO: epoch 002:    485 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89696, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.256, expert1_balance_top=33.961, expert1_balance_bottom=18.64, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219.2, ups=0.58, wpb=379.5, bsz=32, num_updates=18170, lr=5.18125e-06, gnorm=3.061, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33903
2022-05-08 05:51:19 - progress_bar.py[line:272] - INFO: epoch 002:    495 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=389.4, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=34.655, expert1_balance_bottom=18.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=224.3, ups=0.58, wpb=389.4, bsz=32, num_updates=18180, lr=5.17824e-06, gnorm=3.402, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33920
2022-05-08 05:51:37 - progress_bar.py[line:272] - INFO: epoch 002:    505 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=34.323, expert1_balance_bottom=18.95, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=217.9, ups=0.57, wpb=380, bsz=32, num_updates=18190, lr=5.17524e-06, gnorm=2.978, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33938
2022-05-08 05:51:54 - progress_bar.py[line:272] - INFO: epoch 002:    515 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=34.36, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=221.6, ups=0.58, wpb=382.8, bsz=32, num_updates=18200, lr=5.17224e-06, gnorm=3.619, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33955
2022-05-08 05:52:11 - progress_bar.py[line:272] - INFO: epoch 002:    525 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=388.3, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.921, expert1_balance_bottom=18.856, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=225.4, ups=0.58, wpb=388.3, bsz=32, num_updates=18210, lr=5.16923e-06, gnorm=3.264, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33972
2022-05-08 05:52:29 - progress_bar.py[line:272] - INFO: epoch 002:    535 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=376.8, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=35.183, expert1_balance_bottom=18.731, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=218.5, ups=0.58, wpb=376.8, bsz=32, num_updates=18220, lr=5.16623e-06, gnorm=3.199, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=33989
2022-05-08 05:52:46 - progress_bar.py[line:272] - INFO: epoch 002:    545 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883853, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=34.713, expert1_balance_bottom=18.749, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.3, ups=0.58, wpb=382.9, bsz=32, num_updates=18230, lr=5.16323e-06, gnorm=3.227, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34006
2022-05-08 05:53:03 - progress_bar.py[line:272] - INFO: epoch 002:    555 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=384, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884317, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.767, expert1_balance_bottom=18.635, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=219.8, ups=0.57, wpb=384, bsz=32, num_updates=18240, lr=5.16022e-06, gnorm=3.249, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34024
2022-05-08 05:53:20 - progress_bar.py[line:272] - INFO: epoch 002:    565 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=389.7, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.253, expert1_balance_top=34.378, expert1_balance_bottom=18.821, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=224.8, ups=0.58, wpb=389.7, bsz=32, num_updates=18250, lr=5.15722e-06, gnorm=3.195, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34041
2022-05-08 05:53:38 - progress_bar.py[line:272] - INFO: epoch 002:    575 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=387.1, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879706, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=35.362, expert1_balance_bottom=18.625, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222.5, ups=0.57, wpb=387.1, bsz=32, num_updates=18260, lr=5.15422e-06, gnorm=3.393, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34059
2022-05-08 05:53:55 - progress_bar.py[line:272] - INFO: epoch 002:    585 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=385.1, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=35.215, expert1_balance_bottom=18.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=222.1, ups=0.58, wpb=385.1, bsz=32, num_updates=18270, lr=5.15121e-06, gnorm=3.609, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34076
2022-05-08 05:54:12 - progress_bar.py[line:272] - INFO: epoch 002:    595 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=35.8, expert1_balance_bottom=18.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=222.4, ups=0.58, wpb=384, bsz=32, num_updates=18280, lr=5.14821e-06, gnorm=3.61, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34093
2022-05-08 05:54:30 - progress_bar.py[line:272] - INFO: epoch 002:    605 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=379, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.255, expert1_balance_top=34.029, expert1_balance_bottom=19.023, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217, ups=0.57, wpb=379, bsz=32, num_updates=18290, lr=5.14521e-06, gnorm=3.024, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34111
2022-05-08 05:54:47 - progress_bar.py[line:272] - INFO: epoch 002:    615 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=1.009, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878848, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=35.313, expert1_balance_bottom=18.593, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=222.4, ups=0.58, wpb=385, bsz=32, num_updates=18300, lr=5.14221e-06, gnorm=3.135, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34128
2022-05-08 05:55:04 - progress_bar.py[line:272] - INFO: epoch 002:    625 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=374.7, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891232, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=34.492, expert1_balance_bottom=18.718, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=217.6, ups=0.58, wpb=374.7, bsz=32, num_updates=18310, lr=5.1392e-06, gnorm=3.464, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34145
2022-05-08 05:55:22 - progress_bar.py[line:272] - INFO: epoch 002:    635 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=386.7, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=35.021, expert1_balance_bottom=18.925, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=224, ups=0.58, wpb=386.7, bsz=32, num_updates=18320, lr=5.1362e-06, gnorm=3.758, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34163
2022-05-08 05:55:39 - progress_bar.py[line:272] - INFO: epoch 002:    645 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=35.128, expert1_balance_bottom=18.681, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=217.5, ups=0.57, wpb=380.7, bsz=32, num_updates=18330, lr=5.1332e-06, gnorm=3.078, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34180
2022-05-08 05:55:56 - progress_bar.py[line:272] - INFO: epoch 002:    655 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=386.5, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886779, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=34.554, expert1_balance_bottom=18.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=225.2, ups=0.58, wpb=386.5, bsz=32, num_updates=18340, lr=5.13019e-06, gnorm=3.235, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34197
2022-05-08 05:56:14 - progress_bar.py[line:272] - INFO: epoch 002:    665 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=385.9, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883012, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.975, expert1_balance_bottom=18.786, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=223.1, ups=0.58, wpb=385.9, bsz=32, num_updates=18350, lr=5.12719e-06, gnorm=3.588, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34214
2022-05-08 05:56:31 - progress_bar.py[line:272] - INFO: epoch 002:    675 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=387.8, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885547, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.768, expert1_balance_bottom=18.988, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=227.3, ups=0.59, wpb=387.8, bsz=32, num_updates=18360, lr=5.12419e-06, gnorm=2.675, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34232
2022-05-08 05:56:48 - progress_bar.py[line:272] - INFO: epoch 002:    685 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=389.8, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=36.081, expert1_balance_bottom=18.511, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=222.7, ups=0.57, wpb=389.8, bsz=32, num_updates=18370, lr=5.12118e-06, gnorm=3.166, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34249
2022-05-08 05:57:05 - progress_bar.py[line:272] - INFO: epoch 002:    695 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=376.8, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=34.116, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219, ups=0.58, wpb=376.8, bsz=32, num_updates=18380, lr=5.11818e-06, gnorm=3.019, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34266
2022-05-08 05:57:23 - progress_bar.py[line:272] - INFO: epoch 002:    705 / 17711 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=390.6, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873379, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.211, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=35.542, expert1_balance_bottom=18.702, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=227.2, ups=0.58, wpb=390.6, bsz=32, num_updates=18390, lr=5.11518e-06, gnorm=3.319, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34283
2022-05-08 05:57:40 - progress_bar.py[line:272] - INFO: epoch 002:    715 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=386, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879302, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.816, expert1_balance_bottom=18.72, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.8, ups=0.58, wpb=386, bsz=32, num_updates=18400, lr=5.11217e-06, gnorm=3.89, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34301
2022-05-08 05:57:57 - progress_bar.py[line:272] - INFO: epoch 002:    725 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=385.4, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889169, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=34.246, expert1_balance_bottom=18.92, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.2, ups=0.58, wpb=385.4, bsz=32, num_updates=18410, lr=5.10917e-06, gnorm=3.05, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34318
2022-05-08 05:58:15 - progress_bar.py[line:272] - INFO: epoch 002:    735 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=380.3, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882263, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.328, expert1_balance_bottom=18.853, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=221, ups=0.58, wpb=380.3, bsz=32, num_updates=18420, lr=5.10617e-06, gnorm=3.575, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34335
2022-05-08 05:58:32 - progress_bar.py[line:272] - INFO: epoch 002:    745 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=382.6, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.691, expert1_balance_bottom=18.806, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223.6, ups=0.58, wpb=382.6, bsz=32, num_updates=18430, lr=5.10316e-06, gnorm=2.947, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34352
2022-05-08 05:58:49 - progress_bar.py[line:272] - INFO: epoch 002:    755 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886945, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.386, expert1_balance_bottom=18.783, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.8, ups=0.58, wpb=377.1, bsz=32, num_updates=18440, lr=5.10016e-06, gnorm=3.364, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34370
2022-05-08 05:59:06 - progress_bar.py[line:272] - INFO: epoch 002:    765 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=375.7, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892268, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.512, expert1_balance_bottom=18.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.3, ups=0.58, wpb=375.7, bsz=32, num_updates=18450, lr=5.09716e-06, gnorm=3.333, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34387
2022-05-08 05:59:24 - progress_bar.py[line:272] - INFO: epoch 002:    775 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=389.6, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.81, expert1_balance_bottom=18.844, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.1, ups=0.58, wpb=389.6, bsz=32, num_updates=18460, lr=5.09415e-06, gnorm=3.003, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34404
2022-05-08 05:59:41 - progress_bar.py[line:272] - INFO: epoch 002:    785 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=390.8, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876583, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=35.082, expert1_balance_bottom=18.63, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221.8, ups=0.57, wpb=390.8, bsz=32, num_updates=18470, lr=5.09115e-06, gnorm=2.717, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34422
2022-05-08 05:59:59 - progress_bar.py[line:272] - INFO: epoch 002:    795 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=386, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.914, expert1_balance_bottom=18.732, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221.2, ups=0.57, wpb=386, bsz=32, num_updates=18480, lr=5.08815e-06, gnorm=3.172, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34439
2022-05-08 06:00:16 - progress_bar.py[line:272] - INFO: epoch 002:    805 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883298, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.824, expert1_balance_bottom=18.823, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=219.4, ups=0.57, wpb=383.4, bsz=32, num_updates=18490, lr=5.08514e-06, gnorm=3.233, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=34457
2022-05-08 06:00:33 - progress_bar.py[line:272] - INFO: epoch 002:    815 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=375.8, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900153, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=33.793, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=218.5, ups=0.58, wpb=375.8, bsz=32, num_updates=18500, lr=5.08214e-06, gnorm=3.789, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34474
2022-05-08 06:00:51 - progress_bar.py[line:272] - INFO: epoch 002:    825 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.286, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=217.4, ups=0.57, wpb=384.2, bsz=32, num_updates=18510, lr=5.07914e-06, gnorm=3.429, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34492
2022-05-08 06:01:00 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 06:01:10 - progress_bar.py[line:272] - INFO: epoch 002:    836 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=376.6, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.623, expert1_balance_bottom=18.792, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=198, ups=0.53, wpb=376.6, bsz=32, num_updates=18520, lr=5.07613e-06, gnorm=3.018, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34511
2022-05-08 06:01:27 - progress_bar.py[line:272] - INFO: epoch 002:    846 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885573, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.905, expert1_balance_bottom=18.685, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.4, ups=0.58, wpb=383.2, bsz=32, num_updates=18530, lr=5.07313e-06, gnorm=3.451, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34528
2022-05-08 06:01:45 - progress_bar.py[line:272] - INFO: epoch 002:    856 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=386.2, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=35.531, expert1_balance_bottom=18.692, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=223.6, ups=0.58, wpb=386.2, bsz=32, num_updates=18540, lr=5.07013e-06, gnorm=3.069, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=34545
2022-05-08 06:02:02 - progress_bar.py[line:272] - INFO: epoch 002:    866 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=375.6, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=35.394, expert1_balance_bottom=18.715, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=217.8, ups=0.58, wpb=375.6, bsz=32, num_updates=18550, lr=5.06712e-06, gnorm=3.204, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34563
2022-05-08 06:02:19 - progress_bar.py[line:272] - INFO: epoch 002:    876 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=382.2, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=33.997, expert1_balance_bottom=19.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221, ups=0.58, wpb=382.2, bsz=32, num_updates=18560, lr=5.06412e-06, gnorm=3.213, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34580
2022-05-08 06:02:36 - progress_bar.py[line:272] - INFO: epoch 002:    886 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=385.9, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886401, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.77, expert1_balance_bottom=18.815, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=223.6, ups=0.58, wpb=385.9, bsz=32, num_updates=18570, lr=5.06112e-06, gnorm=3.238, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34597
2022-05-08 06:02:54 - progress_bar.py[line:272] - INFO: epoch 002:    896 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=373.8, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88977, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.659, expert1_balance_bottom=18.668, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217.5, ups=0.58, wpb=373.8, bsz=32, num_updates=18580, lr=5.05811e-06, gnorm=3.386, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34614
2022-05-08 06:02:57 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 06:03:13 - progress_bar.py[line:272] - INFO: epoch 002:    907 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=381.6, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.874, expert1_balance_bottom=18.735, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=202.4, ups=0.53, wpb=381.6, bsz=32, num_updates=18590, lr=5.05511e-06, gnorm=2.949, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34633
2022-05-08 06:03:30 - progress_bar.py[line:272] - INFO: epoch 002:    917 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=388.8, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=35.101, expert1_balance_bottom=18.806, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=226, ups=0.58, wpb=388.8, bsz=32, num_updates=18600, lr=5.05211e-06, gnorm=3.021, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34651
2022-05-08 06:03:47 - progress_bar.py[line:272] - INFO: epoch 002:    927 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=386.9, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.756, expert1_balance_bottom=18.666, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.2, ups=0.57, wpb=386.9, bsz=32, num_updates=18610, lr=5.0491e-06, gnorm=3.284, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34668
2022-05-08 06:04:04 - progress_bar.py[line:272] - INFO: epoch 002:    937 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=386.7, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876852, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=35.51, expert1_balance_bottom=18.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.9, ups=0.58, wpb=386.7, bsz=32, num_updates=18620, lr=5.0461e-06, gnorm=3.479, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34685
2022-05-08 06:04:22 - progress_bar.py[line:272] - INFO: epoch 002:    947 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=384.5, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895583, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=34.299, expert1_balance_bottom=18.78, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=222.4, ups=0.58, wpb=384.5, bsz=32, num_updates=18630, lr=5.0431e-06, gnorm=3.13, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34703
2022-05-08 06:04:39 - progress_bar.py[line:272] - INFO: epoch 002:    957 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=374, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88701, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.782, expert1_balance_bottom=18.62, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.4, ups=0.58, wpb=374, bsz=32, num_updates=18640, lr=5.04009e-06, gnorm=3.129, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34720
2022-05-08 06:04:56 - progress_bar.py[line:272] - INFO: epoch 002:    967 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=385.3, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.59, expert1_balance_bottom=18.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.2, ups=0.58, wpb=385.3, bsz=32, num_updates=18650, lr=5.03709e-06, gnorm=3.363, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34737
2022-05-08 06:05:13 - progress_bar.py[line:272] - INFO: epoch 002:    977 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=380.1, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878349, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.933, expert1_balance_bottom=18.576, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=221.6, ups=0.58, wpb=380.1, bsz=32, num_updates=18660, lr=5.03409e-06, gnorm=3.295, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34754
2022-05-08 06:05:30 - progress_bar.py[line:272] - INFO: epoch 002:    987 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=394.6, nsentences=32, sample_size=314, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882862, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.381, expert1_balance_bottom=18.835, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=231.2, ups=0.59, wpb=394.6, bsz=32, num_updates=18670, lr=5.03108e-06, gnorm=3.036, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34771
2022-05-08 06:05:48 - progress_bar.py[line:272] - INFO: epoch 002:    997 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=387.7, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885356, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.544, expert1_balance_bottom=18.886, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.6, ups=0.57, wpb=387.7, bsz=32, num_updates=18680, lr=5.02808e-06, gnorm=2.859, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34789
2022-05-08 06:06:05 - progress_bar.py[line:272] - INFO: epoch 002:   1007 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=385.6, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=35.12, expert1_balance_bottom=18.663, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.2, ups=0.58, wpb=385.6, bsz=32, num_updates=18690, lr=5.02508e-06, gnorm=3.201, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34806
2022-05-08 06:06:23 - progress_bar.py[line:272] - INFO: epoch 002:   1017 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=387.1, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883405, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.68, expert1_balance_bottom=18.972, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.7, ups=0.57, wpb=387.1, bsz=32, num_updates=18700, lr=5.02207e-06, gnorm=3.008, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34823
2022-05-08 06:06:40 - progress_bar.py[line:272] - INFO: epoch 002:   1027 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=386.4, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885498, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.585, expert1_balance_bottom=18.839, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223, ups=0.58, wpb=386.4, bsz=32, num_updates=18710, lr=5.01907e-06, gnorm=2.975, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34841
2022-05-08 06:06:57 - progress_bar.py[line:272] - INFO: epoch 002:   1037 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891454, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.25, expert1_balance_bottom=18.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219.9, ups=0.58, wpb=381.6, bsz=32, num_updates=18720, lr=5.01607e-06, gnorm=3.574, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=34858
2022-05-08 06:07:15 - progress_bar.py[line:272] - INFO: epoch 002:   1047 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=371.1, nsentences=32, sample_size=295.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=34.572, expert1_balance_bottom=18.866, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=214.8, ups=0.58, wpb=371.1, bsz=32, num_updates=18730, lr=5.01306e-06, gnorm=3.503, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34875
2022-05-08 06:07:32 - progress_bar.py[line:272] - INFO: epoch 002:   1057 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=375.2, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=35.169, expert1_balance_bottom=18.81, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.2, ups=0.58, wpb=375.2, bsz=32, num_updates=18740, lr=5.01006e-06, gnorm=3.322, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34892
2022-05-08 06:07:49 - progress_bar.py[line:272] - INFO: epoch 002:   1067 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=375, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=34.224, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=217, ups=0.58, wpb=375, bsz=32, num_updates=18750, lr=5.00706e-06, gnorm=3.524, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34910
2022-05-08 06:08:06 - progress_bar.py[line:272] - INFO: epoch 002:   1077 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.297, expert1_balance_bottom=18.836, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.1, ups=0.58, wpb=382.8, bsz=32, num_updates=18760, lr=5.00405e-06, gnorm=3.919, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34927
2022-05-08 06:08:24 - progress_bar.py[line:272] - INFO: epoch 002:   1087 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=384, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898321, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.251, expert1_balance_top=33.921, expert1_balance_bottom=19.132, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.6, ups=0.58, wpb=384, bsz=32, num_updates=18770, lr=5.00105e-06, gnorm=3.283, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34944
2022-05-08 06:08:41 - progress_bar.py[line:272] - INFO: epoch 002:   1097 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878776, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.871, expert1_balance_bottom=18.854, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=222, ups=0.58, wpb=380.8, bsz=32, num_updates=18780, lr=4.99805e-06, gnorm=3.543, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34961
2022-05-08 06:08:58 - progress_bar.py[line:272] - INFO: epoch 002:   1107 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874448, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=35.476, expert1_balance_bottom=18.665, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.7, ups=0.58, wpb=383.3, bsz=32, num_updates=18790, lr=4.99504e-06, gnorm=3.266, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34979
2022-05-08 06:09:16 - progress_bar.py[line:272] - INFO: epoch 002:   1117 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=378.3, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.313, expert1_balance_bottom=18.973, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.7, ups=0.57, wpb=378.3, bsz=32, num_updates=18800, lr=4.99204e-06, gnorm=2.964, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=34996
2022-05-08 06:09:33 - progress_bar.py[line:272] - INFO: epoch 002:   1127 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=381.9, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=34.92, expert1_balance_bottom=18.84, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.1, ups=0.58, wpb=381.9, bsz=32, num_updates=18810, lr=4.98904e-06, gnorm=3.33, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35013
2022-05-08 06:09:50 - progress_bar.py[line:272] - INFO: epoch 002:   1137 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=384.5, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.252, expert1_balance_top=33.588, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=225.3, ups=0.59, wpb=384.5, bsz=32, num_updates=18820, lr=4.98603e-06, gnorm=3.21, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=35030
2022-05-08 06:10:07 - progress_bar.py[line:272] - INFO: epoch 002:   1147 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=387.5, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8808, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=35.167, expert1_balance_bottom=18.711, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=220.9, ups=0.57, wpb=387.5, bsz=32, num_updates=18830, lr=4.98303e-06, gnorm=3.483, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=35048
2022-05-08 06:10:25 - progress_bar.py[line:272] - INFO: epoch 002:   1157 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=388.2, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=35.134, expert1_balance_bottom=18.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.3, ups=0.58, wpb=388.2, bsz=32, num_updates=18840, lr=4.98003e-06, gnorm=2.944, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35065
2022-05-08 06:10:42 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 06:10:43 - progress_bar.py[line:272] - INFO: epoch 002:   1168 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=393.5, nsentences=32, sample_size=313.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=35.704, expert1_balance_bottom=18.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.8, ups=0.53, wpb=393.5, bsz=32, num_updates=18850, lr=4.97702e-06, gnorm=3.245, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35084
2022-05-08 06:11:01 - progress_bar.py[line:272] - INFO: epoch 002:   1178 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88873, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.43, expert1_balance_bottom=18.973, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221.2, ups=0.58, wpb=383.9, bsz=32, num_updates=18860, lr=4.97402e-06, gnorm=3.278, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35101
2022-05-08 06:11:18 - progress_bar.py[line:272] - INFO: epoch 002:   1188 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=382.1, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88571, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.747, expert1_balance_bottom=18.862, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.9, ups=0.58, wpb=382.1, bsz=32, num_updates=18870, lr=4.97102e-06, gnorm=2.835, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35119
2022-05-08 06:11:35 - progress_bar.py[line:272] - INFO: epoch 002:   1198 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=395.6, nsentences=32, sample_size=314.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87942, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=35.175, expert1_balance_bottom=18.815, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=227.3, ups=0.57, wpb=395.6, bsz=32, num_updates=18880, lr=4.96802e-06, gnorm=3.404, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=35136
2022-05-08 06:11:53 - progress_bar.py[line:272] - INFO: epoch 002:   1208 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884114, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.782, expert1_balance_bottom=18.85, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220.2, ups=0.57, wpb=385.3, bsz=32, num_updates=18890, lr=4.96501e-06, gnorm=3.209, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35154
2022-05-08 06:12:10 - progress_bar.py[line:272] - INFO: epoch 002:   1218 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=376.6, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877449, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=35.172, expert1_balance_bottom=18.757, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.1, ups=0.58, wpb=376.6, bsz=32, num_updates=18900, lr=4.96201e-06, gnorm=2.735, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=35171
2022-05-08 06:12:28 - progress_bar.py[line:272] - INFO: epoch 002:   1228 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.25, expert1_balance_top=33.827, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220, ups=0.58, wpb=380.7, bsz=32, num_updates=18910, lr=4.95901e-06, gnorm=3.829, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=35188
2022-05-08 06:12:45 - progress_bar.py[line:272] - INFO: epoch 002:   1238 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889305, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.336, expert1_balance_bottom=18.851, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=219.3, ups=0.58, wpb=379.5, bsz=32, num_updates=18920, lr=4.956e-06, gnorm=3.055, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35206
2022-05-08 06:13:02 - progress_bar.py[line:272] - INFO: epoch 002:   1248 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883706, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=35.144, expert1_balance_bottom=18.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221, ups=0.58, wpb=383.1, bsz=32, num_updates=18930, lr=4.953e-06, gnorm=3.152, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35223
2022-05-08 06:13:20 - progress_bar.py[line:272] - INFO: epoch 002:   1258 / 17711 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.228, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.613, expert1_balance_bottom=18.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=220.9, ups=0.58, wpb=382.4, bsz=32, num_updates=18940, lr=4.95e-06, gnorm=3.265, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35240
2022-05-08 06:13:37 - progress_bar.py[line:272] - INFO: epoch 002:   1268 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=389.1, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.513, expert1_balance_bottom=18.865, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221.6, ups=0.57, wpb=389.1, bsz=32, num_updates=18950, lr=4.94699e-06, gnorm=2.962, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35258
2022-05-08 06:13:55 - progress_bar.py[line:272] - INFO: epoch 002:   1278 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=387.5, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882598, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.952, expert1_balance_bottom=18.785, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.4, ups=0.57, wpb=387.5, bsz=32, num_updates=18960, lr=4.94399e-06, gnorm=2.992, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35276
2022-05-08 06:14:12 - progress_bar.py[line:272] - INFO: epoch 002:   1288 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=384.6, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887733, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=35.082, expert1_balance_bottom=18.704, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.7, ups=0.58, wpb=384.6, bsz=32, num_updates=18970, lr=4.94099e-06, gnorm=3.127, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35293
2022-05-08 06:14:29 - progress_bar.py[line:272] - INFO: epoch 002:   1298 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.484, expert1_balance_bottom=18.874, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221.8, ups=0.58, wpb=385.2, bsz=32, num_updates=18980, lr=4.93798e-06, gnorm=3.006, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35310
2022-05-08 06:14:47 - progress_bar.py[line:272] - INFO: epoch 002:   1308 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=372.6, nsentences=32, sample_size=296.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894322, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.701, expert1_balance_bottom=18.787, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.8, ups=0.57, wpb=372.6, bsz=32, num_updates=18990, lr=4.93498e-06, gnorm=2.958, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35328
2022-05-08 06:15:04 - progress_bar.py[line:272] - INFO: epoch 002:   1318 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=381.8, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878746, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.945, expert1_balance_bottom=18.72, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.2, ups=0.57, wpb=381.8, bsz=32, num_updates=19000, lr=4.93198e-06, gnorm=3.197, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35345
2022-05-08 06:15:22 - progress_bar.py[line:272] - INFO: epoch 002:   1328 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.116, expert1_balance_bottom=18.974, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.2, ups=0.58, wpb=385.7, bsz=32, num_updates=19010, lr=4.92897e-06, gnorm=3.142, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35362
2022-05-08 06:15:39 - progress_bar.py[line:272] - INFO: epoch 002:   1338 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882047, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.565, expert1_balance_bottom=18.842, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=220.4, ups=0.58, wpb=382.1, bsz=32, num_updates=19020, lr=4.92597e-06, gnorm=3.314, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35380
2022-05-08 06:15:56 - progress_bar.py[line:272] - INFO: epoch 002:   1348 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.966, ntokens=388.7, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=35.487, expert1_balance_bottom=18.648, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.5, ups=0.58, wpb=388.7, bsz=32, num_updates=19030, lr=4.92297e-06, gnorm=3.239, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35397
2022-05-08 06:16:14 - progress_bar.py[line:272] - INFO: epoch 002:   1358 / 17711 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.211, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.135, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=219.1, ups=0.57, wpb=383.2, bsz=32, num_updates=19040, lr=4.91996e-06, gnorm=3.384, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35415
2022-05-08 06:16:31 - progress_bar.py[line:272] - INFO: epoch 002:   1368 / 17711 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879771, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.163, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=35.124, expert1_balance_bottom=18.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=221.8, ups=0.58, wpb=384.3, bsz=32, num_updates=19050, lr=4.91696e-06, gnorm=3.549, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35432
2022-05-08 06:16:48 - progress_bar.py[line:272] - INFO: epoch 002:   1378 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=383.5, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884849, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.533, expert1_balance_bottom=18.872, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224, ups=0.58, wpb=383.5, bsz=32, num_updates=19060, lr=4.91396e-06, gnorm=3.003, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35449
2022-05-08 06:17:06 - progress_bar.py[line:272] - INFO: epoch 002:   1388 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=387.5, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=35.015, expert1_balance_bottom=18.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=221, ups=0.57, wpb=387.5, bsz=32, num_updates=19070, lr=4.91095e-06, gnorm=3.223, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=35467
2022-05-08 06:17:24 - progress_bar.py[line:272] - INFO: epoch 002:   1398 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=383.4, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890103, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.278, expert1_balance_bottom=18.961, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=216.1, ups=0.56, wpb=383.4, bsz=32, num_updates=19080, lr=4.90795e-06, gnorm=2.83, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35484
2022-05-08 06:17:41 - progress_bar.py[line:272] - INFO: epoch 002:   1408 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.416, expert1_balance_bottom=18.88, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=215.8, ups=0.57, wpb=378.6, bsz=32, num_updates=19090, lr=4.90495e-06, gnorm=3.369, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35502
2022-05-08 06:17:58 - progress_bar.py[line:272] - INFO: epoch 002:   1418 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885961, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.474, expert1_balance_bottom=18.88, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222, ups=0.58, wpb=383.6, bsz=32, num_updates=19100, lr=4.90194e-06, gnorm=3.656, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35519
2022-05-08 06:18:16 - progress_bar.py[line:272] - INFO: epoch 002:   1428 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.694, expert1_balance_bottom=18.768, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.8, ups=0.58, wpb=386.3, bsz=32, num_updates=19110, lr=4.89894e-06, gnorm=2.965, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35537
2022-05-08 06:18:33 - progress_bar.py[line:272] - INFO: epoch 002:   1438 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=387.4, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=33.383, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221.8, ups=0.57, wpb=387.4, bsz=32, num_updates=19120, lr=4.89594e-06, gnorm=3.083, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35554
2022-05-08 06:18:51 - progress_bar.py[line:272] - INFO: epoch 002:   1448 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=376.2, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894963, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.184, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216.6, ups=0.58, wpb=376.2, bsz=32, num_updates=19130, lr=4.89293e-06, gnorm=2.857, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35571
2022-05-08 06:19:08 - progress_bar.py[line:272] - INFO: epoch 002:   1458 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=394.4, nsentences=32, sample_size=314.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=35.44, expert1_balance_bottom=18.6, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=229.4, ups=0.58, wpb=394.4, bsz=32, num_updates=19140, lr=4.88993e-06, gnorm=3.106, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35589
2022-05-08 06:19:25 - progress_bar.py[line:272] - INFO: epoch 002:   1468 / 17711 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=1.015, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885237, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.227, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.334, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=220.1, ups=0.58, wpb=378.4, bsz=32, num_updates=19150, lr=4.88693e-06, gnorm=3.752, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35606
2022-05-08 06:19:42 - progress_bar.py[line:272] - INFO: epoch 002:   1478 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881107, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.753, expert1_balance_bottom=18.753, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.5, ups=0.58, wpb=383.1, bsz=32, num_updates=19160, lr=4.88392e-06, gnorm=3.1, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35623
2022-05-08 06:19:59 - progress_bar.py[line:272] - INFO: epoch 002:   1488 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=378.1, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=34.179, expert1_balance_bottom=18.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221, ups=0.58, wpb=378.1, bsz=32, num_updates=19170, lr=4.88092e-06, gnorm=2.629, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35640
2022-05-08 06:20:16 - progress_bar.py[line:272] - INFO: epoch 002:   1498 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=380.4, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890356, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=34.207, expert1_balance_bottom=18.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220.5, ups=0.58, wpb=380.4, bsz=32, num_updates=19180, lr=4.87792e-06, gnorm=3.134, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35657
2022-05-08 06:20:34 - progress_bar.py[line:272] - INFO: epoch 002:   1508 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.891, expert1_balance_bottom=18.823, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221.5, ups=0.58, wpb=381.2, bsz=32, num_updates=19190, lr=4.87491e-06, gnorm=3.469, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35674
2022-05-08 06:20:51 - progress_bar.py[line:272] - INFO: epoch 002:   1518 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=35.292, expert1_balance_bottom=18.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.9, ups=0.58, wpb=384.7, bsz=32, num_updates=19200, lr=4.87191e-06, gnorm=3.645, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35692
2022-05-08 06:21:08 - progress_bar.py[line:272] - INFO: epoch 002:   1528 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=390.9, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.544, expert1_balance_bottom=18.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=226.6, ups=0.58, wpb=390.9, bsz=32, num_updates=19210, lr=4.86891e-06, gnorm=3.097, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35709
2022-05-08 06:21:25 - progress_bar.py[line:272] - INFO: epoch 002:   1538 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891155, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=33.986, expert1_balance_bottom=18.971, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.2, ups=0.58, wpb=382.1, bsz=32, num_updates=19220, lr=4.8659e-06, gnorm=3.019, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=35726
2022-05-08 06:21:43 - progress_bar.py[line:272] - INFO: epoch 002:   1548 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=35.287, expert1_balance_bottom=18.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=219.9, ups=0.58, wpb=378.4, bsz=32, num_updates=19230, lr=4.8629e-06, gnorm=3.213, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35743
2022-05-08 06:22:00 - progress_bar.py[line:272] - INFO: epoch 002:   1558 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879921, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.705, expert1_balance_bottom=18.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=221.6, ups=0.58, wpb=380.1, bsz=32, num_updates=19240, lr=4.8599e-06, gnorm=3.195, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35760
2022-05-08 06:22:17 - progress_bar.py[line:272] - INFO: epoch 002:   1568 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875562, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=35.462, expert1_balance_bottom=18.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.5, ups=0.58, wpb=384.7, bsz=32, num_updates=19250, lr=4.85689e-06, gnorm=2.823, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35778
2022-05-08 06:22:34 - progress_bar.py[line:272] - INFO: epoch 002:   1578 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=387.3, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=35.398, expert1_balance_bottom=18.598, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=227.2, ups=0.59, wpb=387.3, bsz=32, num_updates=19260, lr=4.85389e-06, gnorm=3.49, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35795
2022-05-08 06:22:51 - progress_bar.py[line:272] - INFO: epoch 002:   1588 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.383, expert1_balance_bottom=18.828, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=221.4, ups=0.58, wpb=382.4, bsz=32, num_updates=19270, lr=4.85089e-06, gnorm=3.499, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35812
2022-05-08 06:23:09 - progress_bar.py[line:272] - INFO: epoch 002:   1598 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=377.8, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882777, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.877, expert1_balance_bottom=18.794, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=216.6, ups=0.57, wpb=377.8, bsz=32, num_updates=19280, lr=4.84788e-06, gnorm=3.289, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35830
2022-05-08 06:23:26 - progress_bar.py[line:272] - INFO: epoch 002:   1608 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88867, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=33.852, expert1_balance_bottom=18.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221.3, ups=0.58, wpb=383.7, bsz=32, num_updates=19290, lr=4.84488e-06, gnorm=2.87, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35847
2022-05-08 06:23:43 - progress_bar.py[line:272] - INFO: epoch 002:   1618 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.662, expert1_balance_bottom=18.735, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.7, ups=0.58, wpb=383.8, bsz=32, num_updates=19300, lr=4.84188e-06, gnorm=3.286, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35864
2022-05-08 06:24:01 - progress_bar.py[line:272] - INFO: epoch 002:   1628 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=35.433, expert1_balance_bottom=18.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.3, ups=0.57, wpb=381.6, bsz=32, num_updates=19310, lr=4.83887e-06, gnorm=3.119, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35881
2022-05-08 06:24:18 - progress_bar.py[line:272] - INFO: epoch 002:   1638 / 17711 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884608, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.174, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=35.085, expert1_balance_bottom=18.558, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=221.7, ups=0.58, wpb=384.7, bsz=32, num_updates=19320, lr=4.83587e-06, gnorm=2.891, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35899
2022-05-08 06:24:35 - progress_bar.py[line:272] - INFO: epoch 002:   1648 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=373.8, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=35.051, expert1_balance_bottom=18.629, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=217.8, ups=0.58, wpb=373.8, bsz=32, num_updates=19330, lr=4.83287e-06, gnorm=3.103, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35916
2022-05-08 06:24:53 - progress_bar.py[line:272] - INFO: epoch 002:   1658 / 17711 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872817, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.167, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=35.31, expert1_balance_bottom=18.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=222.1, ups=0.58, wpb=385.7, bsz=32, num_updates=19340, lr=4.82986e-06, gnorm=3.327, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35933
2022-05-08 06:25:10 - progress_bar.py[line:272] - INFO: epoch 002:   1668 / 17711 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=384.8, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873793, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.163, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=35.742, expert1_balance_bottom=18.464, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=223.5, ups=0.58, wpb=384.8, bsz=32, num_updates=19350, lr=4.82686e-06, gnorm=3.501, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=35951
2022-05-08 06:25:27 - progress_bar.py[line:272] - INFO: epoch 002:   1678 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=382.8, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890489, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.151, expert1_balance_bottom=18.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219, ups=0.57, wpb=382.8, bsz=32, num_updates=19360, lr=4.82386e-06, gnorm=3.416, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35968
2022-05-08 06:25:45 - progress_bar.py[line:272] - INFO: epoch 002:   1688 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=392.6, nsentences=32, sample_size=312.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.916, expert1_balance_bottom=18.7, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=226.5, ups=0.58, wpb=392.6, bsz=32, num_updates=19370, lr=4.82085e-06, gnorm=3.463, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=35985
2022-05-08 06:26:02 - progress_bar.py[line:272] - INFO: epoch 002:   1698 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=383.1, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889724, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.289, expert1_balance_bottom=18.698, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221, ups=0.58, wpb=383.1, bsz=32, num_updates=19380, lr=4.81785e-06, gnorm=3.413, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36003
2022-05-08 06:26:19 - progress_bar.py[line:272] - INFO: epoch 002:   1708 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.587, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220.8, ups=0.58, wpb=381.5, bsz=32, num_updates=19390, lr=4.81485e-06, gnorm=3.15, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36020
2022-05-08 06:26:37 - progress_bar.py[line:272] - INFO: epoch 002:   1718 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=384.8, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.636, expert1_balance_bottom=18.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222.7, ups=0.58, wpb=384.8, bsz=32, num_updates=19400, lr=4.81184e-06, gnorm=3.6, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36037
2022-05-08 06:26:54 - progress_bar.py[line:272] - INFO: epoch 002:   1728 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.141, expert1_balance_bottom=18.872, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=219.6, ups=0.57, wpb=383.9, bsz=32, num_updates=19410, lr=4.80884e-06, gnorm=3.322, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36055
2022-05-08 06:27:11 - progress_bar.py[line:272] - INFO: epoch 002:   1738 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.097, expert1_balance_bottom=18.706, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.1, ups=0.57, wpb=387.2, bsz=32, num_updates=19420, lr=4.80584e-06, gnorm=3.47, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36072
2022-05-08 06:27:29 - progress_bar.py[line:272] - INFO: epoch 002:   1748 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880489, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=35.134, expert1_balance_bottom=18.798, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.2, ups=0.58, wpb=381.7, bsz=32, num_updates=19430, lr=4.80284e-06, gnorm=3.264, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36089
2022-05-08 06:27:46 - progress_bar.py[line:272] - INFO: epoch 002:   1758 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.959, ntokens=388.8, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=35.583, expert1_balance_bottom=18.563, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=225.3, ups=0.58, wpb=388.8, bsz=32, num_updates=19440, lr=4.79983e-06, gnorm=3.736, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36107
2022-05-08 06:28:03 - progress_bar.py[line:272] - INFO: epoch 002:   1768 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=376.6, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896882, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.25, expert1_balance_bottom=18.839, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221.9, ups=0.59, wpb=376.6, bsz=32, num_updates=19450, lr=4.79683e-06, gnorm=3.497, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36124
2022-05-08 06:28:20 - progress_bar.py[line:272] - INFO: epoch 002:   1778 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894263, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=34.388, expert1_balance_bottom=18.818, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=216.8, ups=0.57, wpb=377.9, bsz=32, num_updates=19460, lr=4.79383e-06, gnorm=3.13, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36141
2022-05-08 06:28:37 - progress_bar.py[line:272] - INFO: epoch 002:   1788 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895944, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.249, expert1_balance_top=33.968, expert1_balance_bottom=19.073, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.6, ups=0.58, wpb=380.8, bsz=32, num_updates=19470, lr=4.79082e-06, gnorm=2.989, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36158
2022-05-08 06:28:55 - progress_bar.py[line:272] - INFO: epoch 002:   1798 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=384.5, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.491, expert1_balance_bottom=18.842, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.7, ups=0.58, wpb=384.5, bsz=32, num_updates=19480, lr=4.78782e-06, gnorm=3.088, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36175
2022-05-08 06:29:12 - progress_bar.py[line:272] - INFO: epoch 002:   1808 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=388.3, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.843, expert1_balance_bottom=18.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226.2, ups=0.58, wpb=388.3, bsz=32, num_updates=19490, lr=4.78482e-06, gnorm=3.223, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36192
2022-05-08 06:29:29 - progress_bar.py[line:272] - INFO: epoch 002:   1818 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=386.1, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884128, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.595, expert1_balance_bottom=18.885, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223.4, ups=0.58, wpb=386.1, bsz=32, num_updates=19500, lr=4.78181e-06, gnorm=2.989, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36210
2022-05-08 06:29:46 - progress_bar.py[line:272] - INFO: epoch 002:   1828 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.717, expert1_balance_bottom=18.862, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=224.1, ups=0.58, wpb=384.5, bsz=32, num_updates=19510, lr=4.77881e-06, gnorm=3.194, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36227
2022-05-08 06:30:03 - progress_bar.py[line:272] - INFO: epoch 002:   1838 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=379.9, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883817, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.651, expert1_balance_bottom=18.674, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.5, ups=0.59, wpb=379.9, bsz=32, num_updates=19520, lr=4.77581e-06, gnorm=3.609, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36244
2022-05-08 06:30:21 - progress_bar.py[line:272] - INFO: epoch 002:   1848 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880663, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=35.292, expert1_balance_bottom=18.613, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=218.1, ups=0.57, wpb=382.1, bsz=32, num_updates=19530, lr=4.7728e-06, gnorm=2.97, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=36261
2022-05-08 06:30:38 - progress_bar.py[line:272] - INFO: epoch 002:   1858 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=386.1, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.352, expert1_balance_bottom=18.852, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.6, ups=0.58, wpb=386.1, bsz=32, num_updates=19540, lr=4.7698e-06, gnorm=2.927, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=36279
2022-05-08 06:30:55 - progress_bar.py[line:272] - INFO: epoch 002:   1868 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=388.4, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89044, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.356, expert1_balance_bottom=18.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.4, ups=0.58, wpb=388.4, bsz=32, num_updates=19550, lr=4.7668e-06, gnorm=3.335, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36296
2022-05-08 06:31:12 - progress_bar.py[line:272] - INFO: epoch 002:   1878 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=377.7, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=35.174, expert1_balance_bottom=18.67, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220, ups=0.58, wpb=377.7, bsz=32, num_updates=19560, lr=4.76379e-06, gnorm=3.546, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36313
2022-05-08 06:31:30 - progress_bar.py[line:272] - INFO: epoch 002:   1888 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.66, expert1_balance_bottom=18.811, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=219.7, ups=0.58, wpb=381.4, bsz=32, num_updates=19570, lr=4.76079e-06, gnorm=3.329, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36330
2022-05-08 06:31:46 - progress_bar.py[line:272] - INFO: epoch 002:   1898 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=384.6, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885283, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.464, expert1_balance_bottom=18.95, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=228.5, ups=0.59, wpb=384.6, bsz=32, num_updates=19580, lr=4.75779e-06, gnorm=2.935, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36347
2022-05-08 06:32:03 - progress_bar.py[line:272] - INFO: epoch 002:   1908 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=397.3, nsentences=32, sample_size=316.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870822, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=35.989, expert1_balance_bottom=18.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=236.6, ups=0.6, wpb=397.3, bsz=32, num_updates=19590, lr=4.75478e-06, gnorm=3.273, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36364
2022-05-08 06:32:20 - progress_bar.py[line:272] - INFO: epoch 002:   1918 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=35.789, expert1_balance_bottom=18.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.8, ups=0.6, wpb=378.1, bsz=32, num_updates=19600, lr=4.75178e-06, gnorm=3.279, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36381
2022-05-08 06:32:37 - progress_bar.py[line:272] - INFO: epoch 002:   1928 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=390.6, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.783, expert1_balance_bottom=18.934, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=231.4, ups=0.59, wpb=390.6, bsz=32, num_updates=19610, lr=4.74878e-06, gnorm=3.611, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36398
2022-05-08 06:32:54 - progress_bar.py[line:272] - INFO: epoch 002:   1938 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=372.1, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883981, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.9, expert1_balance_bottom=18.682, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=221.2, ups=0.59, wpb=372.1, bsz=32, num_updates=19620, lr=4.74577e-06, gnorm=2.959, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=36414
2022-05-08 06:33:10 - progress_bar.py[line:272] - INFO: epoch 002:   1948 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.4, expert1_balance_bottom=18.918, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=225.3, ups=0.6, wpb=377.9, bsz=32, num_updates=19630, lr=4.74277e-06, gnorm=3.087, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36431
2022-05-08 06:33:27 - progress_bar.py[line:272] - INFO: epoch 002:   1958 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884782, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.812, expert1_balance_bottom=18.79, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=225.2, ups=0.59, wpb=381.2, bsz=32, num_updates=19640, lr=4.73977e-06, gnorm=3.16, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36448
2022-05-08 06:33:44 - progress_bar.py[line:272] - INFO: epoch 002:   1968 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895401, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=33.61, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=225.3, ups=0.6, wpb=377.2, bsz=32, num_updates=19650, lr=4.73676e-06, gnorm=3.167, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36465
2022-05-08 06:34:01 - progress_bar.py[line:272] - INFO: epoch 002:   1978 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=377.3, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881299, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.797, expert1_balance_bottom=18.898, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.6, ups=0.59, wpb=377.3, bsz=32, num_updates=19660, lr=4.73376e-06, gnorm=3.185, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36482
2022-05-08 06:34:18 - progress_bar.py[line:272] - INFO: epoch 002:   1988 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=387, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89165, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.137, expert1_balance_bottom=18.885, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=230.7, ups=0.6, wpb=387, bsz=32, num_updates=19670, lr=4.73076e-06, gnorm=3.442, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36499
2022-05-08 06:34:35 - progress_bar.py[line:272] - INFO: epoch 002:   1998 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.05, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=229, ups=0.6, wpb=383.1, bsz=32, num_updates=19680, lr=4.72775e-06, gnorm=2.941, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=36515
2022-05-08 06:34:52 - progress_bar.py[line:272] - INFO: epoch 002:   2008 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=392.5, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876127, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=35.302, expert1_balance_bottom=18.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=232.6, ups=0.59, wpb=392.5, bsz=32, num_updates=19690, lr=4.72475e-06, gnorm=3.523, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36532
2022-05-08 06:35:08 - progress_bar.py[line:272] - INFO: epoch 002:   2018 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=389.1, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=35.232, expert1_balance_bottom=18.675, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=232.5, ups=0.6, wpb=389.1, bsz=32, num_updates=19700, lr=4.72175e-06, gnorm=3.082, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36549
2022-05-08 06:35:25 - progress_bar.py[line:272] - INFO: epoch 002:   2028 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=376.6, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.323, expert1_balance_bottom=18.789, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220.8, ups=0.59, wpb=376.6, bsz=32, num_updates=19710, lr=4.71874e-06, gnorm=3.513, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36566
2022-05-08 06:35:42 - progress_bar.py[line:272] - INFO: epoch 002:   2038 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=382.6, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.599, expert1_balance_bottom=18.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=226.3, ups=0.59, wpb=382.6, bsz=32, num_updates=19720, lr=4.71574e-06, gnorm=3.54, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36583
2022-05-08 06:35:59 - progress_bar.py[line:272] - INFO: epoch 002:   2048 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.966, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882716, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.948, expert1_balance_bottom=18.725, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=229.2, ups=0.6, wpb=381.6, bsz=32, num_updates=19730, lr=4.71274e-06, gnorm=3.2, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36600
2022-05-08 06:36:15 - progress_bar.py[line:272] - INFO: epoch 002:   2058 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.529, expert1_balance_bottom=18.882, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=231.4, ups=0.6, wpb=384.7, bsz=32, num_updates=19740, lr=4.70973e-06, gnorm=3.028, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36616
2022-05-08 06:36:32 - progress_bar.py[line:272] - INFO: epoch 002:   2068 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=388.5, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.711, expert1_balance_bottom=18.701, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=231.6, ups=0.6, wpb=388.5, bsz=32, num_updates=19750, lr=4.70673e-06, gnorm=3.079, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36633
2022-05-08 06:36:49 - progress_bar.py[line:272] - INFO: epoch 002:   2078 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.189, expert1_balance_bottom=19.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=226.8, ups=0.59, wpb=381.7, bsz=32, num_updates=19760, lr=4.70373e-06, gnorm=3.105, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36650
2022-05-08 06:37:06 - progress_bar.py[line:272] - INFO: epoch 002:   2088 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.247, expert1_balance_top=33.989, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.9, ups=0.58, wpb=381.5, bsz=32, num_updates=19770, lr=4.70072e-06, gnorm=2.986, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36667
2022-05-08 06:37:23 - progress_bar.py[line:272] - INFO: epoch 002:   2098 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=401.1, nsentences=32, sample_size=319.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870828, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=35.134, expert1_balance_bottom=18.754, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=239.4, ups=0.6, wpb=401.1, bsz=32, num_updates=19780, lr=4.69772e-06, gnorm=3.572, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36684
2022-05-08 06:37:40 - progress_bar.py[line:272] - INFO: epoch 002:   2108 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.83, expert1_balance_bottom=18.705, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=226.6, ups=0.59, wpb=383.4, bsz=32, num_updates=19790, lr=4.69472e-06, gnorm=3.563, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36701
2022-05-08 06:37:57 - progress_bar.py[line:272] - INFO: epoch 002:   2118 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=375.8, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888145, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.353, expert1_balance_bottom=18.899, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.3, ups=0.6, wpb=375.8, bsz=32, num_updates=19800, lr=4.69171e-06, gnorm=3.231, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36717
2022-05-08 06:38:13 - progress_bar.py[line:272] - INFO: epoch 002:   2128 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895675, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=34.062, expert1_balance_bottom=18.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.1, ups=0.6, wpb=380.3, bsz=32, num_updates=19810, lr=4.68871e-06, gnorm=3.294, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36734
2022-05-08 06:38:30 - progress_bar.py[line:272] - INFO: epoch 002:   2138 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=392.1, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.575, expert1_balance_bottom=19.013, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=235.3, ups=0.6, wpb=392.1, bsz=32, num_updates=19820, lr=4.68571e-06, gnorm=3.191, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36751
2022-05-08 06:38:47 - progress_bar.py[line:272] - INFO: epoch 002:   2148 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883847, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.876, expert1_balance_bottom=18.881, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=228.1, ups=0.6, wpb=383.3, bsz=32, num_updates=19830, lr=4.6827e-06, gnorm=3.47, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36768
2022-05-08 06:39:04 - progress_bar.py[line:272] - INFO: epoch 002:   2158 / 17711 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.989, ntokens=377.4, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.205, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=34.013, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220.2, ups=0.58, wpb=377.4, bsz=32, num_updates=19840, lr=4.6797e-06, gnorm=3.817, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36785
2022-05-08 06:39:21 - progress_bar.py[line:272] - INFO: epoch 002:   2168 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898026, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=33.833, expert1_balance_bottom=19.081, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=226.4, ups=0.6, wpb=378.8, bsz=32, num_updates=19850, lr=4.6767e-06, gnorm=3.224, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36801
2022-05-08 06:39:37 - progress_bar.py[line:272] - INFO: epoch 002:   2178 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=374.9, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=35.041, expert1_balance_bottom=18.699, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224.9, ups=0.6, wpb=374.9, bsz=32, num_updates=19860, lr=4.67369e-06, gnorm=3.123, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36818
2022-05-08 06:39:54 - progress_bar.py[line:272] - INFO: epoch 002:   2188 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=381.4, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.854, expert1_balance_bottom=18.749, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=225, ups=0.59, wpb=381.4, bsz=32, num_updates=19870, lr=4.67069e-06, gnorm=3.04, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36835
2022-05-08 06:40:11 - progress_bar.py[line:272] - INFO: epoch 002:   2198 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=384.4, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.19, expert1_balance_bottom=19.213, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=228.4, ups=0.59, wpb=384.4, bsz=32, num_updates=19880, lr=4.66769e-06, gnorm=2.97, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36852
2022-05-08 06:40:28 - progress_bar.py[line:272] - INFO: epoch 002:   2208 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904772, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.248, expert1_balance_top=33.442, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=224.3, ups=0.59, wpb=379.3, bsz=32, num_updates=19890, lr=4.66468e-06, gnorm=3.445, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36869
2022-05-08 06:40:45 - progress_bar.py[line:272] - INFO: epoch 002:   2218 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889192, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.281, expert1_balance_bottom=19.022, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.7, ups=0.59, wpb=384.1, bsz=32, num_updates=19900, lr=4.66168e-06, gnorm=3.473, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36886
2022-05-08 06:41:02 - progress_bar.py[line:272] - INFO: epoch 002:   2228 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=385.6, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885153, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.604, expert1_balance_bottom=18.74, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=229.8, ups=0.6, wpb=385.6, bsz=32, num_updates=19910, lr=4.65868e-06, gnorm=3.308, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36902
2022-05-08 06:41:19 - progress_bar.py[line:272] - INFO: epoch 002:   2238 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.541, expert1_balance_bottom=18.96, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=226.5, ups=0.59, wpb=381.5, bsz=32, num_updates=19920, lr=4.65567e-06, gnorm=3.631, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36919
2022-05-08 06:41:35 - progress_bar.py[line:272] - INFO: epoch 002:   2248 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=35.26, expert1_balance_bottom=18.779, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.8, ups=0.59, wpb=377.4, bsz=32, num_updates=19930, lr=4.65267e-06, gnorm=3.194, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36936
2022-05-08 06:41:52 - progress_bar.py[line:272] - INFO: epoch 002:   2258 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=389.8, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=33.938, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=233.2, ups=0.6, wpb=389.8, bsz=32, num_updates=19940, lr=4.64967e-06, gnorm=3.461, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36953
2022-05-08 06:42:09 - progress_bar.py[line:272] - INFO: epoch 002:   2268 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=374.6, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883041, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=35.026, expert1_balance_bottom=18.556, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=220.3, ups=0.59, wpb=374.6, bsz=32, num_updates=19950, lr=4.64666e-06, gnorm=3.319, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36970
2022-05-08 06:42:26 - progress_bar.py[line:272] - INFO: epoch 002:   2278 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=378.5, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890684, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.171, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.5, ups=0.6, wpb=378.5, bsz=32, num_updates=19960, lr=4.64366e-06, gnorm=3.121, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=36987
2022-05-08 06:42:43 - progress_bar.py[line:272] - INFO: epoch 002:   2288 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882761, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.595, expert1_balance_bottom=18.931, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.2, ups=0.58, wpb=385.6, bsz=32, num_updates=19970, lr=4.64066e-06, gnorm=3.571, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=37004
2022-05-08 06:43:00 - progress_bar.py[line:272] - INFO: epoch 002:   2298 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=386.9, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878097, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.963, expert1_balance_bottom=18.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=229.8, ups=0.59, wpb=386.9, bsz=32, num_updates=19980, lr=4.63766e-06, gnorm=3.253, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37021
2022-05-08 06:43:02 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 06:43:18 - progress_bar.py[line:272] - INFO: epoch 002:   2309 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882781, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.633, expert1_balance_bottom=18.901, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=208.8, ups=0.55, wpb=382.1, bsz=32, num_updates=19990, lr=4.63465e-06, gnorm=2.973, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37039
2022-05-08 06:43:35 - progress_bar.py[line:272] - INFO: epoch 002:   2319 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=392.2, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87571, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=35.246, expert1_balance_bottom=18.679, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=233.8, ups=0.6, wpb=392.2, bsz=32, num_updates=20000, lr=4.63165e-06, gnorm=3.114, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37056
2022-05-08 06:43:35 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 06:43:35 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 06:43:35 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 06:50:34 - train.py[line:517] - INFO: valid_step finished
2022-05-08 06:50:34 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 9.305 | loss_v1 0 | loss_v2 0 | nll_loss 7.6 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.970817 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.305 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.279 | expert1_balance_top 36.43 | expert1_balance_bottom 14.509 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 193.97 | cider 1.184 | wps 718.9 | wpb 481.7 | bsz 8 | num_updates 20000 | best_cider 1.184
2022-05-08 06:50:34 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 20000 updates
2022-05-08 06:50:34 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_20000-rank-0.pt
2022-05-08 06:50:34 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_20000-rank-0.pt
2022-05-08 06:50:41 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_20000-rank-0.pt
2022-05-08 06:50:41 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_20000-shared.pt
2022-05-08 06:50:48 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_20000-shared.pt
2022-05-08 06:51:21 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_20000-rank-0.pt (epoch 2 @ 20000 updates, score 1.184) (writing took 46.985692949034274 seconds)
2022-05-08 06:51:39 - progress_bar.py[line:272] - INFO: epoch 002:   2329 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=386.8, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869977, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=35.129, expert1_balance_bottom=18.719, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=8, ups=0.02, wpb=386.8, bsz=32, num_updates=20010, lr=4.62865e-06, gnorm=3.718, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37539
2022-05-08 06:51:56 - progress_bar.py[line:272] - INFO: epoch 002:   2339 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=381.1, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889483, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.649, expert1_balance_bottom=18.803, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.2, ups=0.58, wpb=381.1, bsz=32, num_updates=20020, lr=4.62564e-06, gnorm=3.319, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37557
2022-05-08 06:52:13 - progress_bar.py[line:272] - INFO: epoch 002:   2349 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=392.4, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.663, expert1_balance_bottom=18.74, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=229.2, ups=0.58, wpb=392.4, bsz=32, num_updates=20030, lr=4.62264e-06, gnorm=3.056, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37574
2022-05-08 06:52:30 - progress_bar.py[line:272] - INFO: epoch 002:   2359 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=392.6, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=35.949, expert1_balance_bottom=18.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=232.4, ups=0.59, wpb=392.6, bsz=32, num_updates=20040, lr=4.61964e-06, gnorm=3.037, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37591
2022-05-08 06:52:46 - progress_bar.py[line:272] - INFO: epoch 002:   2369 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=377.8, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=33.856, expert1_balance_bottom=19.037, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=229.9, ups=0.61, wpb=377.8, bsz=32, num_updates=20050, lr=4.61663e-06, gnorm=3.04, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=37607
2022-05-08 06:53:03 - progress_bar.py[line:272] - INFO: epoch 002:   2379 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=377.6, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.404, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.6, ups=0.59, wpb=377.6, bsz=32, num_updates=20060, lr=4.61363e-06, gnorm=3.035, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37624
2022-05-08 06:53:20 - progress_bar.py[line:272] - INFO: epoch 002:   2389 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.746, expert1_balance_bottom=18.828, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=225.7, ups=0.59, wpb=383.7, bsz=32, num_updates=20070, lr=4.61063e-06, gnorm=2.892, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37641
2022-05-08 06:53:37 - progress_bar.py[line:272] - INFO: epoch 002:   2399 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881437, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.75, expert1_balance_bottom=18.838, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=230.7, ups=0.6, wpb=384.2, bsz=32, num_updates=20080, lr=4.60762e-06, gnorm=3.097, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37658
2022-05-08 06:53:54 - progress_bar.py[line:272] - INFO: epoch 002:   2409 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=35.143, expert1_balance_bottom=18.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=229.9, ups=0.6, wpb=386.3, bsz=32, num_updates=20090, lr=4.60462e-06, gnorm=3.324, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=37674
2022-05-08 06:54:11 - progress_bar.py[line:272] - INFO: epoch 002:   2419 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=386.7, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881469, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.669, expert1_balance_bottom=18.852, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=228.9, ups=0.59, wpb=386.7, bsz=32, num_updates=20100, lr=4.60162e-06, gnorm=3.172, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37691
2022-05-08 06:54:27 - progress_bar.py[line:272] - INFO: epoch 002:   2429 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=374.1, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895088, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.092, expert1_balance_bottom=19.05, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=224.6, ups=0.6, wpb=374.1, bsz=32, num_updates=20110, lr=4.59861e-06, gnorm=3.276, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37708
2022-05-08 06:54:44 - progress_bar.py[line:272] - INFO: epoch 002:   2439 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.156, expert1_balance_bottom=18.878, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=224.1, ups=0.59, wpb=379.1, bsz=32, num_updates=20120, lr=4.59561e-06, gnorm=3.428, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37725
2022-05-08 06:55:01 - progress_bar.py[line:272] - INFO: epoch 002:   2449 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884862, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.73, expert1_balance_bottom=18.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.1, ups=0.59, wpb=383.9, bsz=32, num_updates=20130, lr=4.59261e-06, gnorm=3.67, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37742
2022-05-08 06:55:18 - progress_bar.py[line:272] - INFO: epoch 002:   2459 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=380.4, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.654, expert1_balance_bottom=18.849, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.4, ups=0.6, wpb=380.4, bsz=32, num_updates=20140, lr=4.5896e-06, gnorm=3.152, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37758
2022-05-08 06:55:35 - progress_bar.py[line:272] - INFO: epoch 002:   2469 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902203, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.246, expert1_balance_top=33.719, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=224.6, ups=0.59, wpb=379.6, bsz=32, num_updates=20150, lr=4.5866e-06, gnorm=3.051, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37775
2022-05-08 06:55:51 - progress_bar.py[line:272] - INFO: epoch 002:   2479 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=390.8, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883048, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.992, expert1_balance_bottom=18.493, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=232.5, ups=0.59, wpb=390.8, bsz=32, num_updates=20160, lr=4.5836e-06, gnorm=2.912, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37792
2022-05-08 06:56:08 - progress_bar.py[line:272] - INFO: epoch 002:   2489 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=382.9, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.281, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.6, ups=0.6, wpb=382.9, bsz=32, num_updates=20170, lr=4.58059e-06, gnorm=3.369, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37809
2022-05-08 06:56:25 - progress_bar.py[line:272] - INFO: epoch 002:   2499 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=379.8, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879968, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.909, expert1_balance_bottom=18.76, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222.9, ups=0.59, wpb=379.8, bsz=32, num_updates=20180, lr=4.57759e-06, gnorm=3.054, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37826
2022-05-08 06:56:42 - progress_bar.py[line:272] - INFO: epoch 002:   2509 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=35.233, expert1_balance_bottom=18.604, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=227.7, ups=0.59, wpb=383.6, bsz=32, num_updates=20190, lr=4.57459e-06, gnorm=3.546, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37843
2022-05-08 06:56:59 - progress_bar.py[line:272] - INFO: epoch 002:   2519 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880776, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.992, expert1_balance_bottom=18.916, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=224.2, ups=0.59, wpb=378.2, bsz=32, num_updates=20200, lr=4.57158e-06, gnorm=3.474, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37860
2022-05-08 06:57:16 - progress_bar.py[line:272] - INFO: epoch 002:   2529 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=387.8, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878911, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.636, expert1_balance_bottom=18.736, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=232.6, ups=0.6, wpb=387.8, bsz=32, num_updates=20210, lr=4.56858e-06, gnorm=3.034, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37876
2022-05-08 06:57:33 - progress_bar.py[line:272] - INFO: epoch 002:   2539 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=380.1, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885899, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.569, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=224.5, ups=0.59, wpb=380.1, bsz=32, num_updates=20220, lr=4.56558e-06, gnorm=4.052, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37893
2022-05-08 06:57:49 - progress_bar.py[line:272] - INFO: epoch 002:   2549 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891124, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.013, expert1_balance_bottom=18.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=228.1, ups=0.59, wpb=386.3, bsz=32, num_updates=20230, lr=4.56257e-06, gnorm=3.42, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37910
2022-05-08 06:58:07 - progress_bar.py[line:272] - INFO: epoch 002:   2559 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=376.4, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.415, expert1_balance_bottom=18.924, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=218.5, ups=0.58, wpb=376.4, bsz=32, num_updates=20240, lr=4.55957e-06, gnorm=3.016, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=37927
2022-05-08 06:58:24 - progress_bar.py[line:272] - INFO: epoch 002:   2569 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=378.5, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882514, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=35.37, expert1_balance_bottom=18.712, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.6, ups=0.59, wpb=378.5, bsz=32, num_updates=20250, lr=4.55657e-06, gnorm=2.84, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37944
2022-05-08 06:58:40 - progress_bar.py[line:272] - INFO: epoch 002:   2579 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=376.7, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.448, expert1_balance_bottom=19.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.7, ups=0.59, wpb=376.7, bsz=32, num_updates=20260, lr=4.55356e-06, gnorm=3.051, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37961
2022-05-08 06:58:57 - progress_bar.py[line:272] - INFO: epoch 002:   2589 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=377.1, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=33.65, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.6, ups=0.59, wpb=377.1, bsz=32, num_updates=20270, lr=4.55056e-06, gnorm=2.735, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37978
2022-05-08 06:59:14 - progress_bar.py[line:272] - INFO: epoch 002:   2599 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871808, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=35.889, expert1_balance_bottom=18.521, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.7, ups=0.59, wpb=379.7, bsz=32, num_updates=20280, lr=4.54756e-06, gnorm=2.98, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=37995
2022-05-08 06:59:31 - progress_bar.py[line:272] - INFO: epoch 002:   2609 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884546, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.847, expert1_balance_bottom=18.794, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=227.9, ups=0.59, wpb=383.9, bsz=32, num_updates=20290, lr=4.54455e-06, gnorm=3.114, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38012
2022-05-08 06:59:48 - progress_bar.py[line:272] - INFO: epoch 002:   2619 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=379.5, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.76, expert1_balance_bottom=18.678, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.9, ups=0.59, wpb=379.5, bsz=32, num_updates=20300, lr=4.54155e-06, gnorm=3.159, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38029
2022-05-08 07:00:05 - progress_bar.py[line:272] - INFO: epoch 002:   2629 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=379.8, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896764, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.244, expert1_balance_top=34.063, expert1_balance_bottom=18.883, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=224.8, ups=0.59, wpb=379.8, bsz=32, num_updates=20310, lr=4.53855e-06, gnorm=3.093, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=38046
2022-05-08 07:00:22 - progress_bar.py[line:272] - INFO: epoch 002:   2639 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.102, expert1_balance_bottom=18.956, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=224.2, ups=0.59, wpb=378.6, bsz=32, num_updates=20320, lr=4.53554e-06, gnorm=2.943, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38063
2022-05-08 07:00:39 - progress_bar.py[line:272] - INFO: epoch 002:   2649 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=386.5, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891046, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.069, expert1_balance_bottom=18.97, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=230.2, ups=0.6, wpb=386.5, bsz=32, num_updates=20330, lr=4.53254e-06, gnorm=3.456, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38079
2022-05-08 07:00:56 - progress_bar.py[line:272] - INFO: epoch 002:   2659 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887777, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.531, expert1_balance_bottom=18.898, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=227, ups=0.59, wpb=382.5, bsz=32, num_updates=20340, lr=4.52954e-06, gnorm=3.185, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38096
2022-05-08 07:01:12 - progress_bar.py[line:272] - INFO: epoch 002:   2669 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=377.3, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87304, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=35.866, expert1_balance_bottom=18.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225, ups=0.6, wpb=377.3, bsz=32, num_updates=20350, lr=4.52653e-06, gnorm=3.068, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38113
2022-05-08 07:01:29 - progress_bar.py[line:272] - INFO: epoch 002:   2679 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=391.4, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878745, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=35.012, expert1_balance_bottom=18.835, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=235.1, ups=0.6, wpb=391.4, bsz=32, num_updates=20360, lr=4.52353e-06, gnorm=3.09, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38130
2022-05-08 07:01:46 - progress_bar.py[line:272] - INFO: epoch 002:   2689 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=376.3, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879482, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.845, expert1_balance_bottom=18.772, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.5, ups=0.59, wpb=376.3, bsz=32, num_updates=20370, lr=4.52053e-06, gnorm=3.82, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38147
2022-05-08 07:02:02 - progress_bar.py[line:272] - INFO: epoch 002:   2699 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=377.4, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.406, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=227.4, ups=0.6, wpb=377.4, bsz=32, num_updates=20380, lr=4.51752e-06, gnorm=3.955, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38163
2022-05-08 07:02:19 - progress_bar.py[line:272] - INFO: epoch 002:   2709 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=375.6, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=33.837, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.3, ups=0.6, wpb=375.6, bsz=32, num_updates=20390, lr=4.51452e-06, gnorm=3.26, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38180
2022-05-08 07:02:36 - progress_bar.py[line:272] - INFO: epoch 002:   2719 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.721, expert1_balance_bottom=18.798, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=231.4, ups=0.6, wpb=382.5, bsz=32, num_updates=20400, lr=4.51152e-06, gnorm=3.194, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38197
2022-05-08 07:02:53 - progress_bar.py[line:272] - INFO: epoch 002:   2729 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881374, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.699, expert1_balance_bottom=18.861, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=226.1, ups=0.6, wpb=379.7, bsz=32, num_updates=20410, lr=4.50851e-06, gnorm=2.853, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38213
2022-05-08 07:03:09 - progress_bar.py[line:272] - INFO: epoch 002:   2739 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=35.842, expert1_balance_bottom=18.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=231.7, ups=0.6, wpb=387.2, bsz=32, num_updates=20420, lr=4.50551e-06, gnorm=3.297, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38230
2022-05-08 07:03:26 - progress_bar.py[line:272] - INFO: epoch 002:   2749 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873326, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=35.602, expert1_balance_bottom=18.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=227.1, ups=0.59, wpb=386.4, bsz=32, num_updates=20430, lr=4.50251e-06, gnorm=3.922, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38247
2022-05-08 07:03:43 - progress_bar.py[line:272] - INFO: epoch 002:   2759 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=383.4, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.243, expert1_balance_top=34.063, expert1_balance_bottom=18.968, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226, ups=0.59, wpb=383.4, bsz=32, num_updates=20440, lr=4.4995e-06, gnorm=3.449, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=38264
2022-05-08 07:04:00 - progress_bar.py[line:272] - INFO: epoch 002:   2769 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88709, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.655, expert1_balance_bottom=18.909, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=225.4, ups=0.59, wpb=382.1, bsz=32, num_updates=20450, lr=4.4965e-06, gnorm=2.935, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38281
2022-05-08 07:04:17 - progress_bar.py[line:272] - INFO: epoch 002:   2779 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.946, expert1_balance_bottom=18.815, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226.5, ups=0.59, wpb=383.8, bsz=32, num_updates=20460, lr=4.4935e-06, gnorm=3.423, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38298
2022-05-08 07:04:34 - progress_bar.py[line:272] - INFO: epoch 002:   2789 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=375.9, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.714, expert1_balance_bottom=18.832, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220.7, ups=0.59, wpb=375.9, bsz=32, num_updates=20470, lr=4.49049e-06, gnorm=3.715, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38315
2022-05-08 07:04:51 - progress_bar.py[line:272] - INFO: epoch 002:   2799 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88905, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.67, expert1_balance_bottom=18.684, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=224.7, ups=0.58, wpb=384.3, bsz=32, num_updates=20480, lr=4.48749e-06, gnorm=3.51, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38332
2022-05-08 07:05:09 - progress_bar.py[line:272] - INFO: epoch 002:   2809 / 17711 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.18, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.198, expert1_balance_bottom=19.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=222.2, ups=0.58, wpb=384, bsz=32, num_updates=20490, lr=4.48449e-06, gnorm=3.665, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38349
2022-05-08 07:05:26 - progress_bar.py[line:272] - INFO: epoch 002:   2819 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=380.9, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883718, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.905, expert1_balance_bottom=18.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.8, ups=0.59, wpb=380.9, bsz=32, num_updates=20500, lr=4.48148e-06, gnorm=3.814, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38366
2022-05-08 07:05:43 - progress_bar.py[line:272] - INFO: epoch 002:   2829 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=378.1, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881942, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.695, expert1_balance_bottom=18.804, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=222.5, ups=0.59, wpb=378.1, bsz=32, num_updates=20510, lr=4.47848e-06, gnorm=3.038, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38383
2022-05-08 07:05:59 - progress_bar.py[line:272] - INFO: epoch 002:   2839 / 17711 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.993, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.21, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.466, expert1_balance_bottom=18.834, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=227.5, ups=0.6, wpb=378.4, bsz=32, num_updates=20520, lr=4.47548e-06, gnorm=3.715, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38400
2022-05-08 07:06:16 - progress_bar.py[line:272] - INFO: epoch 002:   2849 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891058, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.137, expert1_balance_bottom=18.897, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=231, ups=0.61, wpb=380.5, bsz=32, num_updates=20530, lr=4.47247e-06, gnorm=3.246, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=38416
2022-05-08 07:06:33 - progress_bar.py[line:272] - INFO: epoch 002:   2859 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=388.6, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.613, expert1_balance_bottom=19.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=225, ups=0.58, wpb=388.6, bsz=32, num_updates=20540, lr=4.46947e-06, gnorm=3.101, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38434
2022-05-08 07:06:50 - progress_bar.py[line:272] - INFO: epoch 002:   2869 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=378.8, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=35.486, expert1_balance_bottom=18.608, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.9, ups=0.58, wpb=378.8, bsz=32, num_updates=20550, lr=4.46647e-06, gnorm=3.56, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38451
2022-05-08 07:07:07 - progress_bar.py[line:272] - INFO: epoch 002:   2879 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879017, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.838, expert1_balance_bottom=18.79, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=233.9, ups=0.6, wpb=388.3, bsz=32, num_updates=20560, lr=4.46347e-06, gnorm=3.139, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=38467
2022-05-08 07:07:24 - progress_bar.py[line:272] - INFO: epoch 002:   2889 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=379.1, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88848, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.402, expert1_balance_bottom=18.926, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=220.3, ups=0.58, wpb=379.1, bsz=32, num_updates=20570, lr=4.46046e-06, gnorm=3.233, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38485
2022-05-08 07:07:41 - progress_bar.py[line:272] - INFO: epoch 002:   2899 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=368.2, nsentences=32, sample_size=293.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893807, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=33.905, expert1_balance_bottom=19.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.5, ups=0.59, wpb=368.2, bsz=32, num_updates=20580, lr=4.45746e-06, gnorm=3.513, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38502
2022-05-08 07:07:58 - progress_bar.py[line:272] - INFO: epoch 002:   2909 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=35.759, expert1_balance_bottom=18.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=228.6, ups=0.6, wpb=383.6, bsz=32, num_updates=20590, lr=4.45446e-06, gnorm=3.32, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38518
2022-05-08 07:08:15 - progress_bar.py[line:272] - INFO: epoch 002:   2919 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=378.3, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880314, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=35.002, expert1_balance_bottom=18.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.3, ups=0.59, wpb=378.3, bsz=32, num_updates=20600, lr=4.45145e-06, gnorm=3.038, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38535
2022-05-08 07:08:31 - progress_bar.py[line:272] - INFO: epoch 002:   2929 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=390.8, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.491, expert1_balance_bottom=18.767, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=234.4, ups=0.6, wpb=390.8, bsz=32, num_updates=20610, lr=4.44845e-06, gnorm=4.018, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38552
2022-05-08 07:08:48 - progress_bar.py[line:272] - INFO: epoch 002:   2939 / 17711 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=391, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879293, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.163, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.679, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=233.6, ups=0.6, wpb=391, bsz=32, num_updates=20620, lr=4.44545e-06, gnorm=3.661, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38569
2022-05-08 07:09:05 - progress_bar.py[line:272] - INFO: epoch 002:   2949 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882996, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.873, expert1_balance_bottom=18.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.2, ups=0.6, wpb=379.7, bsz=32, num_updates=20630, lr=4.44244e-06, gnorm=3.029, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38586
2022-05-08 07:09:22 - progress_bar.py[line:272] - INFO: epoch 002:   2959 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=371.1, nsentences=32, sample_size=295.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899427, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=34.039, expert1_balance_bottom=18.963, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=217.2, ups=0.59, wpb=371.1, bsz=32, num_updates=20640, lr=4.43944e-06, gnorm=4.003, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38603
2022-05-08 07:09:38 - progress_bar.py[line:272] - INFO: epoch 002:   2969 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=380.6, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.734, expert1_balance_bottom=18.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=231.2, ups=0.61, wpb=380.6, bsz=32, num_updates=20650, lr=4.43644e-06, gnorm=3.295, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38619
2022-05-08 07:09:55 - progress_bar.py[line:272] - INFO: epoch 002:   2979 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=388.1, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877745, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=35.076, expert1_balance_bottom=18.681, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.4, ups=0.58, wpb=388.1, bsz=32, num_updates=20660, lr=4.43343e-06, gnorm=3.394, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38636
2022-05-08 07:10:12 - progress_bar.py[line:272] - INFO: epoch 002:   2989 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.628, expert1_balance_bottom=18.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=230, ups=0.6, wpb=383.9, bsz=32, num_updates=20670, lr=4.43043e-06, gnorm=3.617, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38653
2022-05-08 07:10:29 - progress_bar.py[line:272] - INFO: epoch 002:   2999 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=379.8, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.251, expert1_balance_bottom=18.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.6, ups=0.59, wpb=379.8, bsz=32, num_updates=20680, lr=4.42743e-06, gnorm=3.241, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38670
2022-05-08 07:10:43 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 07:10:48 - progress_bar.py[line:272] - INFO: epoch 002:   3010 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=383.7, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.527, expert1_balance_bottom=18.927, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=204, ups=0.53, wpb=383.7, bsz=32, num_updates=20690, lr=4.42442e-06, gnorm=3.357, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38689
2022-05-08 07:11:05 - progress_bar.py[line:272] - INFO: epoch 002:   3020 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=393.5, nsentences=32, sample_size=313.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.576, expert1_balance_bottom=18.926, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=233.5, ups=0.59, wpb=393.5, bsz=32, num_updates=20700, lr=4.42142e-06, gnorm=3.201, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38705
2022-05-08 07:11:21 - progress_bar.py[line:272] - INFO: epoch 002:   3030 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=385.2, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=35.157, expert1_balance_bottom=18.694, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=231.4, ups=0.6, wpb=385.2, bsz=32, num_updates=20710, lr=4.41842e-06, gnorm=3.561, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38722
2022-05-08 07:11:38 - progress_bar.py[line:272] - INFO: epoch 002:   3040 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877677, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=35.238, expert1_balance_bottom=18.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.7, ups=0.59, wpb=382.1, bsz=32, num_updates=20720, lr=4.41541e-06, gnorm=3.324, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38739
2022-05-08 07:11:55 - progress_bar.py[line:272] - INFO: epoch 002:   3050 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.925, expert1_balance_bottom=18.87, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=231.8, ups=0.6, wpb=386.2, bsz=32, num_updates=20730, lr=4.41241e-06, gnorm=3.22, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38756
2022-05-08 07:12:12 - progress_bar.py[line:272] - INFO: epoch 002:   3060 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=385.9, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877748, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=35.224, expert1_balance_bottom=18.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=228.8, ups=0.59, wpb=385.9, bsz=32, num_updates=20740, lr=4.40941e-06, gnorm=3.32, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38772
2022-05-08 07:12:28 - progress_bar.py[line:272] - INFO: epoch 002:   3070 / 17711 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.191, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.937, expert1_balance_bottom=18.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=229.1, ups=0.6, wpb=382.1, bsz=32, num_updates=20750, lr=4.4064e-06, gnorm=3.502, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38789
2022-05-08 07:12:45 - progress_bar.py[line:272] - INFO: epoch 002:   3080 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=378.7, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881191, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.785, expert1_balance_bottom=18.763, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=225.8, ups=0.6, wpb=378.7, bsz=32, num_updates=20760, lr=4.4034e-06, gnorm=3.007, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=38806
2022-05-08 07:13:02 - progress_bar.py[line:272] - INFO: epoch 002:   3090 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=376.3, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.245, expert1_balance_top=33.756, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.3, ups=0.6, wpb=376.3, bsz=32, num_updates=20770, lr=4.4004e-06, gnorm=3.43, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38823
2022-05-08 07:13:19 - progress_bar.py[line:272] - INFO: epoch 002:   3100 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.978, expert1_balance_bottom=18.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=226.3, ups=0.6, wpb=380.3, bsz=32, num_updates=20780, lr=4.39739e-06, gnorm=3.009, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38840
2022-05-08 07:13:35 - progress_bar.py[line:272] - INFO: epoch 002:   3110 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.905, expert1_balance_bottom=18.691, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=227.2, ups=0.6, wpb=378.8, bsz=32, num_updates=20790, lr=4.39439e-06, gnorm=2.863, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=38856
2022-05-08 07:13:52 - progress_bar.py[line:272] - INFO: epoch 002:   3120 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=384.8, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888012, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.816, expert1_balance_bottom=18.774, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=227.7, ups=0.59, wpb=384.8, bsz=32, num_updates=20800, lr=4.39139e-06, gnorm=3.164, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38873
2022-05-08 07:14:09 - progress_bar.py[line:272] - INFO: epoch 002:   3130 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.373, expert1_balance_bottom=18.986, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=223.8, ups=0.59, wpb=381.5, bsz=32, num_updates=20810, lr=4.38838e-06, gnorm=3.884, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38890
2022-05-08 07:14:26 - progress_bar.py[line:272] - INFO: epoch 002:   3140 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=376.4, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.818, expert1_balance_bottom=18.832, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=221.8, ups=0.59, wpb=376.4, bsz=32, num_updates=20820, lr=4.38538e-06, gnorm=3.395, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38907
2022-05-08 07:14:43 - progress_bar.py[line:272] - INFO: epoch 002:   3150 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874981, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=35.119, expert1_balance_bottom=18.736, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226.2, ups=0.59, wpb=382.7, bsz=32, num_updates=20830, lr=4.38238e-06, gnorm=3.431, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38924
2022-05-08 07:15:00 - progress_bar.py[line:272] - INFO: epoch 002:   3160 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=371.1, nsentences=32, sample_size=295.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=33.889, expert1_balance_bottom=19.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.6, ups=0.6, wpb=371.1, bsz=32, num_updates=20840, lr=4.37937e-06, gnorm=3.804, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38941
2022-05-08 07:15:17 - progress_bar.py[line:272] - INFO: epoch 002:   3170 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.865, expert1_balance_bottom=18.954, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=229.3, ups=0.6, wpb=384.3, bsz=32, num_updates=20850, lr=4.37637e-06, gnorm=3.088, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38957
2022-05-08 07:15:34 - progress_bar.py[line:272] - INFO: epoch 002:   3180 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880724, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.888, expert1_balance_bottom=18.972, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=227.2, ups=0.59, wpb=384.3, bsz=32, num_updates=20860, lr=4.37337e-06, gnorm=2.922, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=38974
2022-05-08 07:15:50 - progress_bar.py[line:272] - INFO: epoch 002:   3190 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899273, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.242, expert1_balance_top=33.95, expert1_balance_bottom=19.116, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.3, ups=0.59, wpb=378.5, bsz=32, num_updates=20870, lr=4.37036e-06, gnorm=3.297, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=38991
2022-05-08 07:16:07 - progress_bar.py[line:272] - INFO: epoch 002:   3200 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=389.6, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=35.008, expert1_balance_bottom=18.809, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=235, ups=0.6, wpb=389.6, bsz=32, num_updates=20880, lr=4.36736e-06, gnorm=2.934, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39008
2022-05-08 07:16:24 - progress_bar.py[line:272] - INFO: epoch 002:   3210 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=380.7, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.057, expert1_balance_bottom=19.186, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.6, ups=0.59, wpb=380.7, bsz=32, num_updates=20890, lr=4.36436e-06, gnorm=3.582, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=39025
2022-05-08 07:16:41 - progress_bar.py[line:272] - INFO: epoch 002:   3220 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=386.7, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874457, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=35.203, expert1_balance_bottom=18.658, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=225.3, ups=0.58, wpb=386.7, bsz=32, num_updates=20900, lr=4.36135e-06, gnorm=3.416, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=39042
2022-05-08 07:16:58 - progress_bar.py[line:272] - INFO: epoch 002:   3230 / 17711 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=1.022, ntokens=387.1, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=35.422, expert1_balance_bottom=18.701, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=226.8, ups=0.59, wpb=387.1, bsz=32, num_updates=20910, lr=4.35835e-06, gnorm=4.027, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39059
2022-05-08 07:17:15 - progress_bar.py[line:272] - INFO: epoch 002:   3240 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=387.7, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877366, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=35.007, expert1_balance_bottom=18.626, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=224.3, ups=0.58, wpb=387.7, bsz=32, num_updates=20920, lr=4.35535e-06, gnorm=3.303, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39076
2022-05-08 07:17:32 - progress_bar.py[line:272] - INFO: epoch 002:   3250 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=384, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888154, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.64, expert1_balance_bottom=18.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=225.5, ups=0.59, wpb=384, bsz=32, num_updates=20930, lr=4.35234e-06, gnorm=3.358, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39093
2022-05-08 07:17:49 - progress_bar.py[line:272] - INFO: epoch 002:   3260 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=381.4, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=33.897, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.7, ups=0.59, wpb=381.4, bsz=32, num_updates=20940, lr=4.34934e-06, gnorm=3.189, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=39110
2022-05-08 07:18:06 - progress_bar.py[line:272] - INFO: epoch 002:   3270 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=387.4, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890269, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.292, expert1_balance_bottom=18.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226.4, ups=0.58, wpb=387.4, bsz=32, num_updates=20950, lr=4.34634e-06, gnorm=3.042, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39127
2022-05-08 07:18:24 - progress_bar.py[line:272] - INFO: epoch 002:   3280 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=387.7, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880499, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.822, expert1_balance_bottom=18.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.5, ups=0.58, wpb=387.7, bsz=32, num_updates=20960, lr=4.34333e-06, gnorm=3.136, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39144
2022-05-08 07:18:40 - progress_bar.py[line:272] - INFO: epoch 002:   3290 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.602, expert1_balance_bottom=18.87, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=229.8, ups=0.6, wpb=384.7, bsz=32, num_updates=20970, lr=4.34033e-06, gnorm=2.951, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39161
2022-05-08 07:18:57 - progress_bar.py[line:272] - INFO: epoch 002:   3300 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.375, expert1_balance_bottom=18.933, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=227.4, ups=0.59, wpb=384.2, bsz=32, num_updates=20980, lr=4.33733e-06, gnorm=3.548, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39178
2022-05-08 07:19:14 - progress_bar.py[line:272] - INFO: epoch 002:   3310 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=380.8, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=33.828, expert1_balance_bottom=19.077, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.6, ups=0.59, wpb=380.8, bsz=32, num_updates=20990, lr=4.33432e-06, gnorm=3.262, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39195
2022-05-08 07:19:31 - progress_bar.py[line:272] - INFO: epoch 002:   3320 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=388.7, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.665, expert1_balance_bottom=18.778, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=237.2, ups=0.61, wpb=388.7, bsz=32, num_updates=21000, lr=4.33132e-06, gnorm=3.438, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39211
2022-05-08 07:19:48 - progress_bar.py[line:272] - INFO: epoch 002:   3330 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=373.1, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.585, expert1_balance_bottom=18.851, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.1, ups=0.58, wpb=373.1, bsz=32, num_updates=21010, lr=4.32832e-06, gnorm=3.162, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=39229
2022-05-08 07:20:05 - progress_bar.py[line:272] - INFO: epoch 002:   3340 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=376, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.464, expert1_balance_bottom=19.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.2, ups=0.59, wpb=376, bsz=32, num_updates=21020, lr=4.32531e-06, gnorm=3.199, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=39246
2022-05-08 07:20:21 - progress_bar.py[line:272] - INFO: epoch 002:   3350 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=376.5, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.725, expert1_balance_bottom=18.861, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=227.3, ups=0.6, wpb=376.5, bsz=32, num_updates=21030, lr=4.32231e-06, gnorm=2.988, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=39262
2022-05-08 07:20:38 - progress_bar.py[line:272] - INFO: epoch 002:   3360 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88255, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.819, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=227.8, ups=0.59, wpb=383, bsz=32, num_updates=21040, lr=4.31931e-06, gnorm=3.629, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39279
2022-05-08 07:20:55 - progress_bar.py[line:272] - INFO: epoch 002:   3370 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.043, expert1_balance_bottom=19.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=229.2, ups=0.6, wpb=384.5, bsz=32, num_updates=21050, lr=4.3163e-06, gnorm=3.108, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39296
2022-05-08 07:21:12 - progress_bar.py[line:272] - INFO: epoch 002:   3380 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=379.4, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=34.105, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=224.3, ups=0.59, wpb=379.4, bsz=32, num_updates=21060, lr=4.3133e-06, gnorm=3.495, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39313
2022-05-08 07:21:29 - progress_bar.py[line:272] - INFO: epoch 002:   3390 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=382.6, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=35.061, expert1_balance_bottom=18.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=226.1, ups=0.59, wpb=382.6, bsz=32, num_updates=21070, lr=4.3103e-06, gnorm=3.307, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39330
2022-05-08 07:21:46 - progress_bar.py[line:272] - INFO: epoch 002:   3400 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=384.7, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872236, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=35.416, expert1_balance_bottom=18.935, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.1, ups=0.58, wpb=384.7, bsz=32, num_updates=21080, lr=4.30729e-06, gnorm=3.354, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39347
2022-05-08 07:22:03 - progress_bar.py[line:272] - INFO: epoch 002:   3410 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.924, expert1_balance_bottom=18.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=231.4, ups=0.6, wpb=383, bsz=32, num_updates=21090, lr=4.30429e-06, gnorm=3.017, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39363
2022-05-08 07:22:19 - progress_bar.py[line:272] - INFO: epoch 002:   3420 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=35.183, expert1_balance_bottom=18.615, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=232.6, ups=0.6, wpb=386.8, bsz=32, num_updates=21100, lr=4.30129e-06, gnorm=3.174, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39380
2022-05-08 07:22:36 - progress_bar.py[line:272] - INFO: epoch 002:   3430 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.964, expert1_balance_bottom=18.881, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226.8, ups=0.6, wpb=380.1, bsz=32, num_updates=21110, lr=4.29829e-06, gnorm=2.927, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39397
2022-05-08 07:22:53 - progress_bar.py[line:272] - INFO: epoch 002:   3440 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879371, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.943, expert1_balance_bottom=18.881, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=226.9, ups=0.6, wpb=381, bsz=32, num_updates=21120, lr=4.29528e-06, gnorm=3.546, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39414
2022-05-08 07:23:10 - progress_bar.py[line:272] - INFO: epoch 002:   3450 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=380.8, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898738, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=33.792, expert1_balance_bottom=19.213, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.9, ups=0.6, wpb=380.8, bsz=32, num_updates=21130, lr=4.29228e-06, gnorm=3.455, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39430
2022-05-08 07:23:27 - progress_bar.py[line:272] - INFO: epoch 002:   3460 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=390, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888534, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.651, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=228.6, ups=0.59, wpb=390, bsz=32, num_updates=21140, lr=4.28928e-06, gnorm=3.26, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39447
2022-05-08 07:23:44 - progress_bar.py[line:272] - INFO: epoch 002:   3470 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=379.6, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8834, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.538, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.5, ups=0.59, wpb=379.6, bsz=32, num_updates=21150, lr=4.28627e-06, gnorm=2.754, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39464
2022-05-08 07:24:01 - progress_bar.py[line:272] - INFO: epoch 002:   3480 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=35.142, expert1_balance_bottom=18.83, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.8, ups=0.59, wpb=383.4, bsz=32, num_updates=21160, lr=4.28327e-06, gnorm=3.383, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39481
2022-05-08 07:24:17 - progress_bar.py[line:272] - INFO: epoch 002:   3490 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=374.9, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=33.642, expert1_balance_bottom=19.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.4, ups=0.6, wpb=374.9, bsz=32, num_updates=21170, lr=4.28027e-06, gnorm=2.93, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39498
2022-05-08 07:24:35 - progress_bar.py[line:272] - INFO: epoch 002:   3500 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=388.3, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.653, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.9, ups=0.58, wpb=388.3, bsz=32, num_updates=21180, lr=4.27726e-06, gnorm=3.117, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39515
2022-05-08 07:24:52 - progress_bar.py[line:272] - INFO: epoch 002:   3510 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888232, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.332, expert1_balance_bottom=18.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.7, ups=0.59, wpb=383.2, bsz=32, num_updates=21190, lr=4.27426e-06, gnorm=3.478, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=39532
2022-05-08 07:25:08 - progress_bar.py[line:272] - INFO: epoch 002:   3520 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=374.6, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883049, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=35.166, expert1_balance_bottom=18.671, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.5, ups=0.59, wpb=374.6, bsz=32, num_updates=21200, lr=4.27126e-06, gnorm=3.078, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39549
2022-05-08 07:25:25 - progress_bar.py[line:272] - INFO: epoch 002:   3530 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887867, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.581, expert1_balance_bottom=18.84, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=230.2, ups=0.6, wpb=382.9, bsz=32, num_updates=21210, lr=4.26825e-06, gnorm=3.21, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39566
2022-05-08 07:25:42 - progress_bar.py[line:272] - INFO: epoch 002:   3540 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=377.3, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894583, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=33.99, expert1_balance_bottom=19.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=222.9, ups=0.59, wpb=377.3, bsz=32, num_updates=21220, lr=4.26525e-06, gnorm=3.776, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39583
2022-05-08 07:25:59 - progress_bar.py[line:272] - INFO: epoch 002:   3550 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=385, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.731, expert1_balance_bottom=18.861, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=230.5, ups=0.6, wpb=385, bsz=32, num_updates=21230, lr=4.26225e-06, gnorm=4.232, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=39599
2022-05-08 07:26:16 - progress_bar.py[line:272] - INFO: epoch 002:   3560 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.957, ntokens=386.7, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.611, expert1_balance_bottom=18.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=228.1, ups=0.59, wpb=386.7, bsz=32, num_updates=21240, lr=4.25924e-06, gnorm=3.635, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39616
2022-05-08 07:26:33 - progress_bar.py[line:272] - INFO: epoch 002:   3570 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=382.4, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875168, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=35.341, expert1_balance_bottom=18.857, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.1, ups=0.59, wpb=382.4, bsz=32, num_updates=21250, lr=4.25624e-06, gnorm=3.711, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39633
2022-05-08 07:26:49 - progress_bar.py[line:272] - INFO: epoch 002:   3580 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.689, expert1_balance_bottom=18.854, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=229.6, ups=0.6, wpb=385.5, bsz=32, num_updates=21260, lr=4.25324e-06, gnorm=2.998, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39650
2022-05-08 07:27:06 - progress_bar.py[line:272] - INFO: epoch 002:   3590 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.309, expert1_balance_bottom=19.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=227.4, ups=0.6, wpb=380.1, bsz=32, num_updates=21270, lr=4.25023e-06, gnorm=3.505, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39667
2022-05-08 07:27:23 - progress_bar.py[line:272] - INFO: epoch 002:   3600 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.457, expert1_balance_bottom=18.877, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=226.7, ups=0.59, wpb=382.1, bsz=32, num_updates=21280, lr=4.24723e-06, gnorm=3.355, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39684
2022-05-08 07:27:40 - progress_bar.py[line:272] - INFO: epoch 002:   3610 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891044, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.589, expert1_balance_bottom=18.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226.1, ups=0.6, wpb=378.6, bsz=32, num_updates=21290, lr=4.24423e-06, gnorm=3.403, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39700
2022-05-08 07:27:56 - progress_bar.py[line:272] - INFO: epoch 002:   3620 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=381.4, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890457, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.318, expert1_balance_bottom=18.876, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=232, ups=0.61, wpb=381.4, bsz=32, num_updates=21300, lr=4.24122e-06, gnorm=3.284, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39717
2022-05-08 07:28:13 - progress_bar.py[line:272] - INFO: epoch 002:   3630 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.778, expert1_balance_bottom=18.872, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=226, ups=0.6, wpb=378.4, bsz=32, num_updates=21310, lr=4.23822e-06, gnorm=3.734, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39734
2022-05-08 07:28:30 - progress_bar.py[line:272] - INFO: epoch 002:   3640 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=393.2, nsentences=32, sample_size=312.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88209, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.995, expert1_balance_bottom=18.528, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=233, ups=0.59, wpb=393.2, bsz=32, num_updates=21320, lr=4.23522e-06, gnorm=3.812, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39750
2022-05-08 07:28:47 - progress_bar.py[line:272] - INFO: epoch 002:   3650 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=387.3, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88906, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.776, expert1_balance_bottom=19.037, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=229.2, ups=0.59, wpb=387.3, bsz=32, num_updates=21330, lr=4.23221e-06, gnorm=3.212, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39767
2022-05-08 07:29:03 - progress_bar.py[line:272] - INFO: epoch 002:   3660 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=381.5, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.845, expert1_balance_bottom=18.813, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=228.5, ups=0.6, wpb=381.5, bsz=32, num_updates=21340, lr=4.22921e-06, gnorm=4.072, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39784
2022-05-08 07:29:20 - progress_bar.py[line:272] - INFO: epoch 002:   3670 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=387.7, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89582, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=34.017, expert1_balance_bottom=19.014, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=234.2, ups=0.6, wpb=387.7, bsz=32, num_updates=21350, lr=4.22621e-06, gnorm=3.215, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39801
2022-05-08 07:29:37 - progress_bar.py[line:272] - INFO: epoch 002:   3680 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=376.8, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888923, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.498, expert1_balance_bottom=18.828, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.1, ups=0.59, wpb=376.8, bsz=32, num_updates=21360, lr=4.2232e-06, gnorm=3.586, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39817
2022-05-08 07:29:53 - progress_bar.py[line:272] - INFO: epoch 002:   3690 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883734, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.615, expert1_balance_bottom=18.842, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=230.1, ups=0.6, wpb=381.9, bsz=32, num_updates=21370, lr=4.2202e-06, gnorm=3.811, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39834
2022-05-08 07:30:10 - progress_bar.py[line:272] - INFO: epoch 002:   3700 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883264, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.689, expert1_balance_bottom=18.906, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=229.6, ups=0.6, wpb=381.7, bsz=32, num_updates=21380, lr=4.2172e-06, gnorm=3.433, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39851
2022-05-08 07:30:27 - progress_bar.py[line:272] - INFO: epoch 002:   3710 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=379.9, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894186, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=34.139, expert1_balance_bottom=18.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=225.6, ups=0.59, wpb=379.9, bsz=32, num_updates=21390, lr=4.21419e-06, gnorm=3.709, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39867
2022-05-08 07:30:44 - progress_bar.py[line:272] - INFO: epoch 002:   3720 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.99, ntokens=385.7, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879578, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.754, expert1_balance_bottom=18.765, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=229.7, ups=0.6, wpb=385.7, bsz=32, num_updates=21400, lr=4.21119e-06, gnorm=3.503, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39884
2022-05-08 07:31:00 - progress_bar.py[line:272] - INFO: epoch 002:   3730 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.961, ntokens=382, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885143, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.596, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=231.1, ups=0.61, wpb=382, bsz=32, num_updates=21410, lr=4.20819e-06, gnorm=3.733, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=39901
2022-05-08 07:31:17 - progress_bar.py[line:272] - INFO: epoch 002:   3740 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885484, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.413, expert1_balance_bottom=19.084, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=230, ups=0.6, wpb=386.3, bsz=32, num_updates=21420, lr=4.20518e-06, gnorm=3.612, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39918
2022-05-08 07:31:34 - progress_bar.py[line:272] - INFO: epoch 002:   3750 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=386.3, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895021, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.241, expert1_balance_top=33.657, expert1_balance_bottom=19.083, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=227.8, ups=0.59, wpb=386.3, bsz=32, num_updates=21430, lr=4.20218e-06, gnorm=3.511, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39935
2022-05-08 07:31:50 - progress_bar.py[line:272] - INFO: epoch 002:   3760 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=384.8, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891023, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.285, expert1_balance_bottom=18.948, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=230.5, ups=0.6, wpb=384.8, bsz=32, num_updates=21440, lr=4.19918e-06, gnorm=3.513, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39951
2022-05-08 07:32:07 - progress_bar.py[line:272] - INFO: epoch 002:   3770 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=389.7, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883318, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.524, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=231.9, ups=0.6, wpb=389.7, bsz=32, num_updates=21450, lr=4.19617e-06, gnorm=3.663, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39968
2022-05-08 07:32:24 - progress_bar.py[line:272] - INFO: epoch 002:   3780 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.985, expert1_balance_bottom=18.756, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=231.8, ups=0.6, wpb=386.8, bsz=32, num_updates=21460, lr=4.19317e-06, gnorm=3.363, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=39985
2022-05-08 07:32:41 - progress_bar.py[line:272] - INFO: epoch 002:   3790 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=375.9, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889944, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.154, expert1_balance_bottom=19.047, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=227.1, ups=0.6, wpb=375.9, bsz=32, num_updates=21470, lr=4.19017e-06, gnorm=3.752, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40001
2022-05-08 07:32:58 - progress_bar.py[line:272] - INFO: epoch 002:   3800 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880776, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.811, expert1_balance_bottom=18.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=224.3, ups=0.59, wpb=381.3, bsz=32, num_updates=21480, lr=4.18716e-06, gnorm=3.347, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40018
2022-05-08 07:33:14 - progress_bar.py[line:272] - INFO: epoch 002:   3810 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=379.8, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.538, expert1_balance_bottom=19.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=226, ups=0.59, wpb=379.8, bsz=32, num_updates=21490, lr=4.18416e-06, gnorm=3.416, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40035
2022-05-08 07:33:31 - progress_bar.py[line:272] - INFO: epoch 002:   3820 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=382.7, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881514, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.737, expert1_balance_bottom=18.963, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=226.2, ups=0.59, wpb=382.7, bsz=32, num_updates=21500, lr=4.18116e-06, gnorm=3.299, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40052
2022-05-08 07:33:48 - progress_bar.py[line:272] - INFO: epoch 002:   3830 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871785, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.827, expert1_balance_bottom=18.804, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=231.2, ups=0.6, wpb=388.1, bsz=32, num_updates=21510, lr=4.17815e-06, gnorm=3.252, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40069
2022-05-08 07:34:05 - progress_bar.py[line:272] - INFO: epoch 002:   3840 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=388.8, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880735, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.604, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=234.3, ups=0.6, wpb=388.8, bsz=32, num_updates=21520, lr=4.17515e-06, gnorm=3.01, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40085
2022-05-08 07:34:21 - progress_bar.py[line:272] - INFO: epoch 002:   3850 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=389.9, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.488, expert1_balance_bottom=18.964, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=235.7, ups=0.6, wpb=389.9, bsz=32, num_updates=21530, lr=4.17215e-06, gnorm=3.449, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40102
2022-05-08 07:34:38 - progress_bar.py[line:272] - INFO: epoch 002:   3860 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=386.8, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.762, expert1_balance_bottom=18.74, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=230.9, ups=0.6, wpb=386.8, bsz=32, num_updates=21540, lr=4.16914e-06, gnorm=4.021, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40119
2022-05-08 07:34:55 - progress_bar.py[line:272] - INFO: epoch 002:   3870 / 17711 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=386.9, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.196, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.485, expert1_balance_bottom=18.812, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=230.8, ups=0.6, wpb=386.9, bsz=32, num_updates=21550, lr=4.16614e-06, gnorm=3.545, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40135
2022-05-08 07:35:11 - progress_bar.py[line:272] - INFO: epoch 002:   3880 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.245, expert1_balance_bottom=19.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=229.5, ups=0.6, wpb=384.2, bsz=32, num_updates=21560, lr=4.16314e-06, gnorm=3.435, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40152
2022-05-08 07:35:28 - progress_bar.py[line:272] - INFO: epoch 002:   3890 / 17711 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=1, ntokens=380.2, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.212, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.284, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=228.3, ups=0.6, wpb=380.2, bsz=32, num_updates=21570, lr=4.16013e-06, gnorm=3.747, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40169
2022-05-08 07:35:45 - progress_bar.py[line:272] - INFO: epoch 002:   3900 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887743, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.313, expert1_balance_bottom=18.753, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=228.5, ups=0.6, wpb=380.8, bsz=32, num_updates=21580, lr=4.15713e-06, gnorm=3.238, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=40186
2022-05-08 07:36:01 - progress_bar.py[line:272] - INFO: epoch 002:   3910 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=384.8, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=33.681, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=233.3, ups=0.61, wpb=384.8, bsz=32, num_updates=21590, lr=4.15413e-06, gnorm=3.85, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40202
2022-05-08 07:36:11 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 07:36:20 - progress_bar.py[line:272] - INFO: epoch 002:   3921 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.171, expert1_balance_bottom=19.078, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=205.9, ups=0.54, wpb=378.6, bsz=32, num_updates=21600, lr=4.15112e-06, gnorm=3.544, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40220
2022-05-08 07:36:36 - progress_bar.py[line:272] - INFO: epoch 002:   3931 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=377.6, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.703, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.4, ups=0.6, wpb=377.6, bsz=32, num_updates=21610, lr=4.14812e-06, gnorm=3.344, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=40237
2022-05-08 07:36:53 - progress_bar.py[line:272] - INFO: epoch 002:   3941 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=392.2, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.053, expert1_balance_bottom=19.017, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=234.1, ups=0.6, wpb=392.2, bsz=32, num_updates=21620, lr=4.14512e-06, gnorm=3.387, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40254
2022-05-08 07:37:10 - progress_bar.py[line:272] - INFO: epoch 002:   3951 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=381.2, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889028, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.594, expert1_balance_bottom=18.843, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=227.8, ups=0.6, wpb=381.2, bsz=32, num_updates=21630, lr=4.14211e-06, gnorm=3.588, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40270
2022-05-08 07:37:26 - progress_bar.py[line:272] - INFO: epoch 002:   3961 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884341, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.57, expert1_balance_bottom=19.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=230.9, ups=0.6, wpb=384.7, bsz=32, num_updates=21640, lr=4.13911e-06, gnorm=3.277, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40287
2022-05-08 07:37:43 - progress_bar.py[line:272] - INFO: epoch 002:   3971 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887251, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.323, expert1_balance_bottom=19.056, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=226.4, ups=0.59, wpb=381.6, bsz=32, num_updates=21650, lr=4.13611e-06, gnorm=3.45, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40304
2022-05-08 07:38:00 - progress_bar.py[line:272] - INFO: epoch 002:   3981 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.232, expert1_balance_bottom=18.997, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=226.4, ups=0.59, wpb=383.7, bsz=32, num_updates=21660, lr=4.13311e-06, gnorm=3.269, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40321
2022-05-08 07:38:17 - progress_bar.py[line:272] - INFO: epoch 002:   3991 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885856, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=35.104, expert1_balance_bottom=18.569, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=225.9, ups=0.59, wpb=384.5, bsz=32, num_updates=21670, lr=4.1301e-06, gnorm=3.387, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40338
2022-05-08 07:38:34 - progress_bar.py[line:272] - INFO: epoch 002:   4001 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886457, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.412, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.8, ups=0.59, wpb=381.1, bsz=32, num_updates=21680, lr=4.1271e-06, gnorm=3.448, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40355
2022-05-08 07:38:51 - progress_bar.py[line:272] - INFO: epoch 002:   4011 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=388.1, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875895, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.98, expert1_balance_bottom=18.868, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=234.8, ups=0.6, wpb=388.1, bsz=32, num_updates=21690, lr=4.1241e-06, gnorm=3.43, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40371
2022-05-08 07:39:07 - progress_bar.py[line:272] - INFO: epoch 002:   4021 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.022, expert1_balance_bottom=19.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=228.5, ups=0.6, wpb=382.9, bsz=32, num_updates=21700, lr=4.12109e-06, gnorm=4.502, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40388
2022-05-08 07:39:24 - progress_bar.py[line:272] - INFO: epoch 002:   4031 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=378.9, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=35.09, expert1_balance_bottom=18.761, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=228.5, ups=0.6, wpb=378.9, bsz=32, num_updates=21710, lr=4.11809e-06, gnorm=3.681, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40405
2022-05-08 07:39:41 - progress_bar.py[line:272] - INFO: epoch 002:   4041 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.852, expert1_balance_bottom=18.859, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=229.7, ups=0.6, wpb=385.3, bsz=32, num_updates=21720, lr=4.11509e-06, gnorm=3.573, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40422
2022-05-08 07:39:58 - progress_bar.py[line:272] - INFO: epoch 002:   4051 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=381.6, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=35.193, expert1_balance_bottom=18.634, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.7, ups=0.58, wpb=381.6, bsz=32, num_updates=21730, lr=4.11208e-06, gnorm=3.895, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40439
2022-05-08 07:40:15 - progress_bar.py[line:272] - INFO: epoch 002:   4061 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=384.6, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=35.538, expert1_balance_bottom=18.404, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=229.8, ups=0.6, wpb=384.6, bsz=32, num_updates=21740, lr=4.10908e-06, gnorm=3.405, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40455
2022-05-08 07:40:32 - progress_bar.py[line:272] - INFO: epoch 002:   4071 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=400.9, nsentences=32, sample_size=318.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871512, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=35.749, expert1_balance_bottom=18.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=238.5, ups=0.59, wpb=400.9, bsz=32, num_updates=21750, lr=4.10608e-06, gnorm=3.323, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40472
2022-05-08 07:40:48 - progress_bar.py[line:272] - INFO: epoch 002:   4081 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=382.3, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.118, expert1_balance_bottom=19.093, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=229.9, ups=0.6, wpb=382.3, bsz=32, num_updates=21760, lr=4.10307e-06, gnorm=4.087, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40489
2022-05-08 07:41:05 - progress_bar.py[line:272] - INFO: epoch 002:   4091 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887068, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.92, expert1_balance_bottom=18.795, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=230.8, ups=0.6, wpb=383.9, bsz=32, num_updates=21770, lr=4.10007e-06, gnorm=3.755, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40506
2022-05-08 07:41:21 - progress_bar.py[line:272] - INFO: epoch 002:   4101 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.789, expert1_balance_bottom=18.96, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=233.2, ups=0.61, wpb=384.5, bsz=32, num_updates=21780, lr=4.09707e-06, gnorm=3.825, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40522
2022-05-08 07:41:38 - progress_bar.py[line:272] - INFO: epoch 002:   4111 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.979, ntokens=392.9, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.974, expert1_balance_bottom=18.711, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=235.6, ups=0.6, wpb=392.9, bsz=32, num_updates=21790, lr=4.09406e-06, gnorm=3.663, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40539
2022-05-08 07:41:55 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 07:41:56 - progress_bar.py[line:272] - INFO: epoch 002:   4122 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.361, expert1_balance_bottom=18.899, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=208.1, ups=0.54, wpb=383.9, bsz=32, num_updates=21800, lr=4.09106e-06, gnorm=3.777, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40557
2022-05-08 07:42:13 - progress_bar.py[line:272] - INFO: epoch 002:   4132 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887848, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.087, expert1_balance_bottom=19.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=231.9, ups=0.6, wpb=383.8, bsz=32, num_updates=21810, lr=4.08806e-06, gnorm=4.156, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40574
2022-05-08 07:42:30 - progress_bar.py[line:272] - INFO: epoch 002:   4142 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=386.9, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.257, expert1_balance_bottom=18.968, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=230.7, ups=0.6, wpb=386.9, bsz=32, num_updates=21820, lr=4.08505e-06, gnorm=3.182, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40590
2022-05-08 07:42:46 - progress_bar.py[line:272] - INFO: epoch 002:   4152 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.865, expert1_balance_bottom=18.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=231.8, ups=0.6, wpb=387, bsz=32, num_updates=21830, lr=4.08205e-06, gnorm=3.195, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40607
2022-05-08 07:43:04 - progress_bar.py[line:272] - INFO: epoch 002:   4162 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879065, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=35.084, expert1_balance_bottom=18.729, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=223.7, ups=0.58, wpb=382.5, bsz=32, num_updates=21840, lr=4.07905e-06, gnorm=3.291, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40624
2022-05-08 07:43:20 - progress_bar.py[line:272] - INFO: epoch 002:   4172 / 17711 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=1.03, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=35.206, expert1_balance_bottom=18.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=228.8, ups=0.6, wpb=381.3, bsz=32, num_updates=21850, lr=4.07604e-06, gnorm=4.222, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=40641
2022-05-08 07:43:37 - progress_bar.py[line:272] - INFO: epoch 002:   4182 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882938, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.777, expert1_balance_bottom=18.762, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=228.8, ups=0.6, wpb=380.7, bsz=32, num_updates=21860, lr=4.07304e-06, gnorm=3.902, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40658
2022-05-08 07:43:54 - progress_bar.py[line:272] - INFO: epoch 002:   4192 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885377, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.676, expert1_balance_bottom=18.857, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=226.6, ups=0.59, wpb=381.5, bsz=32, num_updates=21870, lr=4.07004e-06, gnorm=3.407, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40674
2022-05-08 07:44:10 - progress_bar.py[line:272] - INFO: epoch 002:   4202 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=390.6, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.955, expert1_balance_bottom=18.764, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=232.2, ups=0.59, wpb=390.6, bsz=32, num_updates=21880, lr=4.06703e-06, gnorm=3.23, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40691
2022-05-08 07:44:27 - progress_bar.py[line:272] - INFO: epoch 002:   4212 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88608, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.507, expert1_balance_bottom=18.765, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=229.6, ups=0.6, wpb=383.4, bsz=32, num_updates=21890, lr=4.06403e-06, gnorm=3.317, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40708
2022-05-08 07:44:44 - progress_bar.py[line:272] - INFO: epoch 002:   4222 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=379.5, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.307, expert1_balance_bottom=19.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=223.7, ups=0.59, wpb=379.5, bsz=32, num_updates=21900, lr=4.06103e-06, gnorm=3.53, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40725
2022-05-08 07:45:01 - progress_bar.py[line:272] - INFO: epoch 002:   4232 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89165, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.253, expert1_balance_bottom=19.032, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=227.6, ups=0.59, wpb=383.3, bsz=32, num_updates=21910, lr=4.05802e-06, gnorm=3.636, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40742
2022-05-08 07:45:18 - progress_bar.py[line:272] - INFO: epoch 002:   4242 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891888, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.229, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=225.3, ups=0.59, wpb=378.7, bsz=32, num_updates=21920, lr=4.05502e-06, gnorm=3.524, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40759
2022-05-08 07:45:35 - progress_bar.py[line:272] - INFO: epoch 002:   4252 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=387.1, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=35.005, expert1_balance_bottom=18.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=230.6, ups=0.6, wpb=387.1, bsz=32, num_updates=21930, lr=4.05202e-06, gnorm=3.521, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40775
2022-05-08 07:45:51 - progress_bar.py[line:272] - INFO: epoch 002:   4262 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885935, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.396, expert1_balance_bottom=18.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224.9, ups=0.6, wpb=377.1, bsz=32, num_updates=21940, lr=4.04901e-06, gnorm=3.522, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40792
2022-05-08 07:46:08 - progress_bar.py[line:272] - INFO: epoch 002:   4272 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885604, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.374, expert1_balance_bottom=19.108, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=229.9, ups=0.6, wpb=380.4, bsz=32, num_updates=21950, lr=4.04601e-06, gnorm=3.914, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40809
2022-05-08 07:46:25 - progress_bar.py[line:272] - INFO: epoch 002:   4282 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891942, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.329, expert1_balance_bottom=18.95, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=227.9, ups=0.6, wpb=381.7, bsz=32, num_updates=21960, lr=4.04301e-06, gnorm=3.252, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40825
2022-05-08 07:46:41 - progress_bar.py[line:272] - INFO: epoch 002:   4292 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886648, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.642, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=232.2, ups=0.6, wpb=388.1, bsz=32, num_updates=21970, lr=4.04e-06, gnorm=3.168, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40842
2022-05-08 07:46:58 - progress_bar.py[line:272] - INFO: epoch 002:   4302 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=393.2, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=35.632, expert1_balance_bottom=18.61, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=233.5, ups=0.59, wpb=393.2, bsz=32, num_updates=21980, lr=4.037e-06, gnorm=3.222, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40859
2022-05-08 07:47:15 - progress_bar.py[line:272] - INFO: epoch 002:   4312 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=391, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=36.11, expert1_balance_bottom=18.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=232.1, ups=0.59, wpb=391, bsz=32, num_updates=21990, lr=4.034e-06, gnorm=4.017, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=40876
2022-05-08 07:47:32 - progress_bar.py[line:272] - INFO: epoch 002:   4322 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=386.2, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=33.65, expert1_balance_bottom=19.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=227.5, ups=0.59, wpb=386.2, bsz=32, num_updates=22000, lr=4.03099e-06, gnorm=3.271, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40893
2022-05-08 07:47:49 - progress_bar.py[line:272] - INFO: epoch 002:   4332 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884775, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.513, expert1_balance_bottom=18.945, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220.3, ups=0.58, wpb=379.7, bsz=32, num_updates=22010, lr=4.02799e-06, gnorm=3.134, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40910
2022-05-08 07:48:06 - progress_bar.py[line:272] - INFO: epoch 002:   4342 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=375.7, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.6, expert1_balance_bottom=18.99, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.3, ups=0.59, wpb=375.7, bsz=32, num_updates=22020, lr=4.02499e-06, gnorm=2.793, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40927
2022-05-08 07:48:23 - progress_bar.py[line:272] - INFO: epoch 002:   4352 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=35.014, expert1_balance_bottom=18.626, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=230.8, ups=0.6, wpb=386.5, bsz=32, num_updates=22030, lr=4.02198e-06, gnorm=3.556, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40944
2022-05-08 07:48:39 - progress_bar.py[line:272] - INFO: epoch 002:   4362 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=388.7, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=35.14, expert1_balance_bottom=18.627, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=239.1, ups=0.61, wpb=388.7, bsz=32, num_updates=22040, lr=4.01898e-06, gnorm=3.413, loss_scale=32, train_wall=15, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40960
2022-05-08 07:48:56 - progress_bar.py[line:272] - INFO: epoch 002:   4372 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.985, expert1_balance_bottom=18.894, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=226.3, ups=0.6, wpb=376.7, bsz=32, num_updates=22050, lr=4.01598e-06, gnorm=3.458, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40977
2022-05-08 07:49:13 - progress_bar.py[line:272] - INFO: epoch 002:   4382 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=388, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866078, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=36.161, expert1_balance_bottom=18.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=232.3, ups=0.6, wpb=388, bsz=32, num_updates=22060, lr=4.01297e-06, gnorm=3.538, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=40993
2022-05-08 07:49:29 - progress_bar.py[line:272] - INFO: epoch 002:   4392 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=384.1, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890151, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.503, expert1_balance_bottom=18.786, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=228.7, ups=0.6, wpb=384.1, bsz=32, num_updates=22070, lr=4.00997e-06, gnorm=3.503, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41010
2022-05-08 07:49:46 - progress_bar.py[line:272] - INFO: epoch 002:   4402 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=376.4, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890947, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.622, expert1_balance_bottom=18.854, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.3, ups=0.6, wpb=376.4, bsz=32, num_updates=22080, lr=4.00697e-06, gnorm=3.292, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41027
2022-05-08 07:50:03 - progress_bar.py[line:272] - INFO: epoch 002:   4412 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=35.388, expert1_balance_bottom=18.784, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=225, ups=0.59, wpb=380.5, bsz=32, num_updates=22090, lr=4.00396e-06, gnorm=3.394, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41044
2022-05-08 07:50:20 - progress_bar.py[line:272] - INFO: epoch 002:   4422 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884359, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.915, expert1_balance_bottom=18.713, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=232.2, ups=0.6, wpb=385.4, bsz=32, num_updates=22100, lr=4.00096e-06, gnorm=3.316, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41060
2022-05-08 07:50:37 - progress_bar.py[line:272] - INFO: epoch 002:   4432 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=383.7, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877233, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=35.186, expert1_balance_bottom=18.82, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=226.2, ups=0.59, wpb=383.7, bsz=32, num_updates=22110, lr=3.99796e-06, gnorm=3.602, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41077
2022-05-08 07:50:53 - progress_bar.py[line:272] - INFO: epoch 002:   4442 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=372.8, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=33.916, expert1_balance_bottom=18.938, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.3, ups=0.6, wpb=372.8, bsz=32, num_updates=22120, lr=3.99495e-06, gnorm=3.398, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41094
2022-05-08 07:51:10 - progress_bar.py[line:272] - INFO: epoch 002:   4452 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=380.7, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88941, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.499, expert1_balance_bottom=18.919, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.1, ups=0.6, wpb=380.7, bsz=32, num_updates=22130, lr=3.99195e-06, gnorm=3.537, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41111
2022-05-08 07:51:27 - progress_bar.py[line:272] - INFO: epoch 002:   4462 / 17711 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=379.9, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.18, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.95, expert1_balance_bottom=18.724, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=228.3, ups=0.6, wpb=379.9, bsz=32, num_updates=22140, lr=3.98895e-06, gnorm=3.58, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41127
2022-05-08 07:51:44 - progress_bar.py[line:272] - INFO: epoch 002:   4472 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=372.6, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.103, expert1_balance_bottom=19.009, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=219.2, ups=0.59, wpb=372.6, bsz=32, num_updates=22150, lr=3.98594e-06, gnorm=3.548, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=41144
2022-05-08 07:52:00 - progress_bar.py[line:272] - INFO: epoch 002:   4482 / 17711 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895417, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.191, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=34.327, expert1_balance_bottom=18.916, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=227.3, ups=0.6, wpb=377.5, bsz=32, num_updates=22160, lr=3.98294e-06, gnorm=4.05, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41161
2022-05-08 07:52:17 - progress_bar.py[line:272] - INFO: epoch 002:   4492 / 17711 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.979, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887298, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.191, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.509, expert1_balance_bottom=18.997, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=228.3, ups=0.59, wpb=386.3, bsz=32, num_updates=22170, lr=3.97994e-06, gnorm=3.546, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41178
2022-05-08 07:52:34 - progress_bar.py[line:272] - INFO: epoch 002:   4502 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=392, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877318, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.988, expert1_balance_bottom=18.753, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=233.5, ups=0.6, wpb=392, bsz=32, num_updates=22180, lr=3.97693e-06, gnorm=3.268, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41195
2022-05-08 07:52:51 - progress_bar.py[line:272] - INFO: epoch 002:   4512 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=377.9, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88443, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.605, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=226.7, ups=0.6, wpb=377.9, bsz=32, num_updates=22190, lr=3.97393e-06, gnorm=3.397, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41211
2022-05-08 07:53:07 - progress_bar.py[line:272] - INFO: epoch 002:   4522 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881643, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.95, expert1_balance_bottom=18.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=229.3, ups=0.59, wpb=386, bsz=32, num_updates=22200, lr=3.97093e-06, gnorm=2.984, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41228
2022-05-08 07:53:24 - progress_bar.py[line:272] - INFO: epoch 002:   4532 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.966, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895371, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.238, expert1_balance_top=33.964, expert1_balance_bottom=18.976, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=224.5, ups=0.59, wpb=380.5, bsz=32, num_updates=22210, lr=3.96793e-06, gnorm=3.105, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41245
2022-05-08 07:53:41 - progress_bar.py[line:272] - INFO: epoch 002:   4542 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=379.1, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.239, expert1_balance_top=33.905, expert1_balance_bottom=19.041, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=226, ups=0.6, wpb=379.1, bsz=32, num_updates=22220, lr=3.96492e-06, gnorm=3.542, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41262
2022-05-08 07:53:58 - progress_bar.py[line:272] - INFO: epoch 002:   4552 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889059, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.18, expert1_balance_bottom=18.963, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=227.7, ups=0.59, wpb=384.8, bsz=32, num_updates=22230, lr=3.96192e-06, gnorm=3.78, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41279
2022-05-08 07:54:15 - progress_bar.py[line:272] - INFO: epoch 002:   4562 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886298, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.497, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=227.9, ups=0.6, wpb=381.2, bsz=32, num_updates=22240, lr=3.95892e-06, gnorm=3.035, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41296
2022-05-08 07:54:31 - progress_bar.py[line:272] - INFO: epoch 002:   4572 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=380, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891811, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.171, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=229, ups=0.6, wpb=380, bsz=32, num_updates=22250, lr=3.95591e-06, gnorm=3.158, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41312
2022-05-08 07:54:48 - progress_bar.py[line:272] - INFO: epoch 002:   4582 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=373.8, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.24, expert1_balance_top=33.279, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=224.8, ups=0.6, wpb=373.8, bsz=32, num_updates=22260, lr=3.95291e-06, gnorm=3.432, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41329
2022-05-08 07:55:05 - progress_bar.py[line:272] - INFO: epoch 002:   4592 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=384.1, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885459, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.601, expert1_balance_bottom=18.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=230.4, ups=0.6, wpb=384.1, bsz=32, num_updates=22270, lr=3.94991e-06, gnorm=3.158, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41345
2022-05-08 07:55:21 - progress_bar.py[line:272] - INFO: epoch 002:   4602 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892794, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.341, expert1_balance_bottom=19.072, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=228.4, ups=0.6, wpb=382.1, bsz=32, num_updates=22280, lr=3.9469e-06, gnorm=3.145, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41362
2022-05-08 07:55:38 - progress_bar.py[line:272] - INFO: epoch 002:   4612 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=35.247, expert1_balance_bottom=18.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=227.5, ups=0.6, wpb=379.2, bsz=32, num_updates=22290, lr=3.9439e-06, gnorm=3.254, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41379
2022-05-08 07:55:55 - progress_bar.py[line:272] - INFO: epoch 002:   4622 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=366.7, nsentences=32, sample_size=291.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892028, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.429, expert1_balance_bottom=18.815, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=219.1, ups=0.6, wpb=366.7, bsz=32, num_updates=22300, lr=3.9409e-06, gnorm=3.24, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41396
2022-05-08 07:56:12 - progress_bar.py[line:272] - INFO: epoch 002:   4632 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=381.2, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.546, expert1_balance_bottom=18.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=225.8, ups=0.59, wpb=381.2, bsz=32, num_updates=22310, lr=3.93789e-06, gnorm=3.62, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41412
2022-05-08 07:56:28 - progress_bar.py[line:272] - INFO: epoch 002:   4642 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=384.4, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.83, expert1_balance_bottom=18.695, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=230.1, ups=0.6, wpb=384.4, bsz=32, num_updates=22320, lr=3.93489e-06, gnorm=3.907, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41429
2022-05-08 07:56:45 - progress_bar.py[line:272] - INFO: epoch 002:   4652 / 17711 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873383, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.191, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=35.445, expert1_balance_bottom=18.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=230.5, ups=0.6, wpb=386.8, bsz=32, num_updates=22330, lr=3.93189e-06, gnorm=3.472, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41446
2022-05-08 07:57:02 - progress_bar.py[line:272] - INFO: epoch 002:   4662 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=395, nsentences=32, sample_size=314.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876236, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=35.045, expert1_balance_bottom=18.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=232.3, ups=0.59, wpb=395, bsz=32, num_updates=22340, lr=3.92888e-06, gnorm=3.259, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41463
2022-05-08 07:57:19 - progress_bar.py[line:272] - INFO: epoch 002:   4672 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=387.1, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880598, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.753, expert1_balance_bottom=18.918, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=233.3, ups=0.6, wpb=387.1, bsz=32, num_updates=22350, lr=3.92588e-06, gnorm=3.364, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41480
2022-05-08 07:57:35 - progress_bar.py[line:272] - INFO: epoch 002:   4682 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883687, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.727, expert1_balance_bottom=18.572, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=232.1, ups=0.61, wpb=383.4, bsz=32, num_updates=22360, lr=3.92288e-06, gnorm=3.715, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41496
2022-05-08 07:57:52 - progress_bar.py[line:272] - INFO: epoch 002:   4692 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=389, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.634, expert1_balance_bottom=18.708, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=229.9, ups=0.59, wpb=389, bsz=32, num_updates=22370, lr=3.91987e-06, gnorm=3.725, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41513
2022-05-08 07:58:09 - progress_bar.py[line:272] - INFO: epoch 002:   4702 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=373.2, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88565, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.815, expert1_balance_bottom=18.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=228.4, ups=0.61, wpb=373.2, bsz=32, num_updates=22380, lr=3.91687e-06, gnorm=3.567, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41529
2022-05-08 07:58:25 - progress_bar.py[line:272] - INFO: epoch 002:   4712 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=384.3, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.468, expert1_balance_bottom=18.873, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=228.4, ups=0.59, wpb=384.3, bsz=32, num_updates=22390, lr=3.91387e-06, gnorm=3.475, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41546
2022-05-08 07:58:42 - progress_bar.py[line:272] - INFO: epoch 002:   4722 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=373.2, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89668, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=33.923, expert1_balance_bottom=19.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.3, ups=0.59, wpb=373.2, bsz=32, num_updates=22400, lr=3.91086e-06, gnorm=2.947, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41563
2022-05-08 07:58:59 - progress_bar.py[line:272] - INFO: epoch 002:   4732 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=378.6, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887047, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.779, expert1_balance_bottom=18.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=225.8, ups=0.6, wpb=378.6, bsz=32, num_updates=22410, lr=3.90786e-06, gnorm=3.646, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41580
2022-05-08 07:59:15 - progress_bar.py[line:272] - INFO: epoch 002:   4742 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=35.098, expert1_balance_bottom=18.858, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=235.6, ups=0.62, wpb=382.5, bsz=32, num_updates=22420, lr=3.90486e-06, gnorm=3.721, loss_scale=64, train_wall=15, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41596
2022-05-08 07:59:32 - progress_bar.py[line:272] - INFO: epoch 002:   4752 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=383, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.658, expert1_balance_bottom=18.727, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=229, ups=0.6, wpb=383, bsz=32, num_updates=22430, lr=3.90185e-06, gnorm=3.427, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41613
2022-05-08 07:59:49 - progress_bar.py[line:272] - INFO: epoch 002:   4762 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=379, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878072, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=35.178, expert1_balance_bottom=18.812, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=225.9, ups=0.6, wpb=379, bsz=32, num_updates=22440, lr=3.89885e-06, gnorm=3.448, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41630
2022-05-08 08:00:06 - progress_bar.py[line:272] - INFO: epoch 002:   4772 / 17711 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.192, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.26, expert1_balance_bottom=18.886, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=228.5, ups=0.59, wpb=384.5, bsz=32, num_updates=22450, lr=3.89585e-06, gnorm=3.255, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=41646
2022-05-08 08:00:23 - progress_bar.py[line:272] - INFO: epoch 002:   4782 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.007, expert1_balance_bottom=19.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226.6, ups=0.59, wpb=382.1, bsz=32, num_updates=22460, lr=3.89284e-06, gnorm=3.524, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41663
2022-05-08 08:00:39 - progress_bar.py[line:272] - INFO: epoch 002:   4792 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88828, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.559, expert1_balance_bottom=18.894, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=225.3, ups=0.59, wpb=380.8, bsz=32, num_updates=22470, lr=3.88984e-06, gnorm=3.316, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41680
2022-05-08 08:00:56 - progress_bar.py[line:272] - INFO: epoch 002:   4802 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=376, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.237, expert1_balance_top=34.403, expert1_balance_bottom=18.894, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=225, ups=0.6, wpb=376, bsz=32, num_updates=22480, lr=3.88684e-06, gnorm=3.317, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41697
2022-05-08 08:01:13 - progress_bar.py[line:272] - INFO: epoch 002:   4812 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=376.8, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.36, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227.5, ups=0.6, wpb=376.8, bsz=32, num_updates=22490, lr=3.88383e-06, gnorm=3.173, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41714
2022-05-08 08:01:30 - progress_bar.py[line:272] - INFO: epoch 002:   4822 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=389.4, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.962, expert1_balance_bottom=18.855, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=228.3, ups=0.59, wpb=389.4, bsz=32, num_updates=22500, lr=3.88083e-06, gnorm=3.203, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41731
2022-05-08 08:01:47 - progress_bar.py[line:272] - INFO: epoch 002:   4832 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=384.7, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.464, expert1_balance_bottom=18.99, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=230, ups=0.6, wpb=384.7, bsz=32, num_updates=22510, lr=3.87783e-06, gnorm=3.362, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41747
2022-05-08 08:02:03 - progress_bar.py[line:272] - INFO: epoch 002:   4842 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=384.2, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.986, expert1_balance_bottom=18.73, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=232.5, ups=0.61, wpb=384.2, bsz=32, num_updates=22520, lr=3.87482e-06, gnorm=3.469, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41764
2022-05-08 08:02:20 - progress_bar.py[line:272] - INFO: epoch 002:   4852 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=381, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=35.293, expert1_balance_bottom=18.692, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226.6, ups=0.59, wpb=381, bsz=32, num_updates=22530, lr=3.87182e-06, gnorm=3.288, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=41781
2022-05-08 08:02:37 - progress_bar.py[line:272] - INFO: epoch 002:   4862 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=387.5, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=35.491, expert1_balance_bottom=18.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=231.5, ups=0.6, wpb=387.5, bsz=32, num_updates=22540, lr=3.86882e-06, gnorm=3.27, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41797
2022-05-08 08:02:53 - progress_bar.py[line:272] - INFO: epoch 002:   4872 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=387.6, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.473, expert1_balance_bottom=18.978, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=233.6, ups=0.6, wpb=387.6, bsz=32, num_updates=22550, lr=3.86581e-06, gnorm=3.448, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41814
2022-05-08 08:03:10 - progress_bar.py[line:272] - INFO: epoch 002:   4882 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=382.1, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.219, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227.4, ups=0.6, wpb=382.1, bsz=32, num_updates=22560, lr=3.86281e-06, gnorm=2.838, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41831
2022-05-08 08:03:27 - progress_bar.py[line:272] - INFO: epoch 002:   4892 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=380.6, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882437, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.834, expert1_balance_bottom=18.753, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.3, ups=0.58, wpb=380.6, bsz=32, num_updates=22570, lr=3.85981e-06, gnorm=3.701, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=41848
2022-05-08 08:03:44 - progress_bar.py[line:272] - INFO: epoch 002:   4902 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=380.8, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=35.273, expert1_balance_bottom=18.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=224.9, ups=0.59, wpb=380.8, bsz=32, num_updates=22580, lr=3.8568e-06, gnorm=3.327, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41865
2022-05-08 08:04:01 - progress_bar.py[line:272] - INFO: epoch 002:   4912 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=382.8, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.214, expert1_balance_bottom=19.112, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226.3, ups=0.59, wpb=382.8, bsz=32, num_updates=22590, lr=3.8538e-06, gnorm=3.169, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41882
2022-05-08 08:04:18 - progress_bar.py[line:272] - INFO: epoch 002:   4922 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883114, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.664, expert1_balance_bottom=19.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224.2, ups=0.59, wpb=382.3, bsz=32, num_updates=22600, lr=3.8508e-06, gnorm=3.303, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41899
2022-05-08 08:04:35 - progress_bar.py[line:272] - INFO: epoch 002:   4932 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=380.3, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.884, expert1_balance_bottom=18.87, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.7, ups=0.59, wpb=380.3, bsz=32, num_updates=22610, lr=3.84779e-06, gnorm=3.924, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41916
2022-05-08 08:04:52 - progress_bar.py[line:272] - INFO: epoch 002:   4942 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=386.2, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=35.464, expert1_balance_bottom=18.859, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.8, ups=0.59, wpb=386.2, bsz=32, num_updates=22620, lr=3.84479e-06, gnorm=3.32, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41933
2022-05-08 08:05:09 - progress_bar.py[line:272] - INFO: epoch 002:   4952 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=385.7, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=33.915, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=228, ups=0.59, wpb=385.7, bsz=32, num_updates=22630, lr=3.84179e-06, gnorm=3.136, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41950
2022-05-08 08:05:26 - progress_bar.py[line:272] - INFO: epoch 002:   4962 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=384.2, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=35.304, expert1_balance_bottom=18.716, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=229.6, ups=0.6, wpb=384.2, bsz=32, num_updates=22640, lr=3.83878e-06, gnorm=3.133, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=41967
2022-05-08 08:05:43 - progress_bar.py[line:272] - INFO: epoch 002:   4972 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886656, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.714, expert1_balance_bottom=18.964, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=227.6, ups=0.59, wpb=384.1, bsz=32, num_updates=22650, lr=3.83578e-06, gnorm=3.31, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=41983
2022-05-08 08:05:59 - progress_bar.py[line:272] - INFO: epoch 002:   4982 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.991, ntokens=379.6, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.398, expert1_balance_bottom=18.793, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.9, ups=0.59, wpb=379.6, bsz=32, num_updates=22660, lr=3.83278e-06, gnorm=3.171, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42000
2022-05-08 08:06:16 - progress_bar.py[line:272] - INFO: epoch 002:   4992 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=379.4, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886565, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.699, expert1_balance_bottom=18.844, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=231.6, ups=0.61, wpb=379.4, bsz=32, num_updates=22670, lr=3.82977e-06, gnorm=3.705, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42017
2022-05-08 08:06:33 - progress_bar.py[line:272] - INFO: epoch 002:   5002 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.552, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=225.1, ups=0.59, wpb=379.1, bsz=32, num_updates=22680, lr=3.82677e-06, gnorm=3.216, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=42033
2022-05-08 08:06:50 - progress_bar.py[line:272] - INFO: epoch 002:   5012 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=379, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883304, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.478, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=225.3, ups=0.59, wpb=379, bsz=32, num_updates=22690, lr=3.82377e-06, gnorm=3.051, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42050
2022-05-08 08:07:06 - progress_bar.py[line:272] - INFO: epoch 002:   5022 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=383, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880314, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=35.143, expert1_balance_bottom=18.75, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=229, ups=0.6, wpb=383, bsz=32, num_updates=22700, lr=3.82076e-06, gnorm=3.476, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42067
2022-05-08 08:07:23 - progress_bar.py[line:272] - INFO: epoch 002:   5032 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=382, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.888, expert1_balance_bottom=18.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226, ups=0.59, wpb=382, bsz=32, num_updates=22710, lr=3.81776e-06, gnorm=3.343, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42084
2022-05-08 08:07:40 - progress_bar.py[line:272] - INFO: epoch 002:   5042 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=385.9, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.445, expert1_balance_bottom=18.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227.3, ups=0.59, wpb=385.9, bsz=32, num_updates=22720, lr=3.81476e-06, gnorm=3.202, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42101
2022-05-08 08:07:57 - progress_bar.py[line:272] - INFO: epoch 002:   5052 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=381.8, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894016, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=33.949, expert1_balance_bottom=19.188, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=229.7, ups=0.6, wpb=381.8, bsz=32, num_updates=22730, lr=3.81175e-06, gnorm=3.92, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42118
2022-05-08 08:08:14 - progress_bar.py[line:272] - INFO: epoch 002:   5062 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=378, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=35.158, expert1_balance_bottom=18.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=225.2, ups=0.6, wpb=378, bsz=32, num_updates=22740, lr=3.80875e-06, gnorm=3.713, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42134
2022-05-08 08:08:30 - progress_bar.py[line:272] - INFO: epoch 002:   5072 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=376, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.758, expert1_balance_bottom=18.856, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221.9, ups=0.59, wpb=376, bsz=32, num_updates=22750, lr=3.80575e-06, gnorm=3.81, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42151
2022-05-08 08:08:47 - progress_bar.py[line:272] - INFO: epoch 002:   5082 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=389.5, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887689, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.304, expert1_balance_bottom=19.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=230, ups=0.59, wpb=389.5, bsz=32, num_updates=22760, lr=3.80274e-06, gnorm=3.293, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=42168
2022-05-08 08:09:04 - progress_bar.py[line:272] - INFO: epoch 002:   5092 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.09, expert1_balance_bottom=19.087, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=228.2, ups=0.6, wpb=381.7, bsz=32, num_updates=22770, lr=3.79974e-06, gnorm=2.766, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42185
2022-05-08 08:09:21 - progress_bar.py[line:272] - INFO: epoch 002:   5102 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892877, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.276, expert1_balance_bottom=18.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=225.2, ups=0.59, wpb=383, bsz=32, num_updates=22780, lr=3.79674e-06, gnorm=3.256, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42202
2022-05-08 08:09:38 - progress_bar.py[line:272] - INFO: epoch 002:   5112 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=380.1, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.711, expert1_balance_bottom=18.942, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=228, ups=0.6, wpb=380.1, bsz=32, num_updates=22790, lr=3.79374e-06, gnorm=2.976, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42219
2022-05-08 08:09:55 - progress_bar.py[line:272] - INFO: epoch 002:   5122 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=384.5, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=33.979, expert1_balance_bottom=18.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=228.8, ups=0.6, wpb=384.5, bsz=32, num_updates=22800, lr=3.79073e-06, gnorm=3.595, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42235
2022-05-08 08:10:11 - progress_bar.py[line:272] - INFO: epoch 002:   5132 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=391.7, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884629, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.692, expert1_balance_bottom=18.848, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=232.4, ups=0.59, wpb=391.7, bsz=32, num_updates=22810, lr=3.78773e-06, gnorm=2.976, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42252
2022-05-08 08:10:28 - progress_bar.py[line:272] - INFO: epoch 002:   5142 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=393.6, nsentences=32, sample_size=313.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=35.233, expert1_balance_bottom=18.812, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=232.9, ups=0.59, wpb=393.6, bsz=32, num_updates=22820, lr=3.78473e-06, gnorm=3.591, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42269
2022-05-08 08:10:45 - progress_bar.py[line:272] - INFO: epoch 002:   5152 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=386.9, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.316, expert1_balance_bottom=19.056, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=229.2, ups=0.59, wpb=386.9, bsz=32, num_updates=22830, lr=3.78172e-06, gnorm=3.075, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42286
2022-05-08 08:11:02 - progress_bar.py[line:272] - INFO: epoch 002:   5162 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.059, expert1_balance_bottom=19.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=229.6, ups=0.6, wpb=385, bsz=32, num_updates=22840, lr=3.77872e-06, gnorm=2.905, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42303
2022-05-08 08:11:19 - progress_bar.py[line:272] - INFO: epoch 002:   5172 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=388.6, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.868, expert1_balance_bottom=18.762, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=234.8, ups=0.6, wpb=388.6, bsz=32, num_updates=22850, lr=3.77572e-06, gnorm=3.061, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42319
2022-05-08 08:11:35 - progress_bar.py[line:272] - INFO: epoch 002:   5182 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=384.8, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.184, expert1_balance_bottom=18.864, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=229.7, ups=0.6, wpb=384.8, bsz=32, num_updates=22860, lr=3.77271e-06, gnorm=3.637, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=42336
2022-05-08 08:11:52 - progress_bar.py[line:272] - INFO: epoch 002:   5192 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=380.6, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=35.755, expert1_balance_bottom=18.492, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=228.5, ups=0.6, wpb=380.6, bsz=32, num_updates=22870, lr=3.76971e-06, gnorm=2.934, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42353
2022-05-08 08:12:09 - progress_bar.py[line:272] - INFO: epoch 002:   5202 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=35.153, expert1_balance_bottom=18.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=228.5, ups=0.59, wpb=386.8, bsz=32, num_updates=22880, lr=3.76671e-06, gnorm=3.292, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42370
2022-05-08 08:12:26 - progress_bar.py[line:272] - INFO: epoch 002:   5212 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=390.1, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.186, expert1_balance_bottom=19.017, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=232.8, ups=0.6, wpb=390.1, bsz=32, num_updates=22890, lr=3.7637e-06, gnorm=3.53, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42386
2022-05-08 08:12:42 - progress_bar.py[line:272] - INFO: epoch 002:   5222 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=382.3, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884583, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.862, expert1_balance_bottom=18.846, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=229, ups=0.6, wpb=382.3, bsz=32, num_updates=22900, lr=3.7607e-06, gnorm=3.049, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42403
2022-05-08 08:12:59 - progress_bar.py[line:272] - INFO: epoch 002:   5232 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.49, expert1_balance_bottom=18.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=228.9, ups=0.6, wpb=384, bsz=32, num_updates=22910, lr=3.7577e-06, gnorm=3.649, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42420
2022-05-08 08:13:16 - progress_bar.py[line:272] - INFO: epoch 002:   5242 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=35.056, expert1_balance_bottom=18.725, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.4, ups=0.59, wpb=383.6, bsz=32, num_updates=22920, lr=3.75469e-06, gnorm=2.913, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42437
2022-05-08 08:13:33 - progress_bar.py[line:272] - INFO: epoch 002:   5252 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889021, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.502, expert1_balance_bottom=18.996, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.7, ups=0.58, wpb=383.2, bsz=32, num_updates=22930, lr=3.75169e-06, gnorm=3.186, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42454
2022-05-08 08:13:50 - progress_bar.py[line:272] - INFO: epoch 002:   5262 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=375.8, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.719, expert1_balance_bottom=19.034, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223.7, ups=0.6, wpb=375.8, bsz=32, num_updates=22940, lr=3.74869e-06, gnorm=3.351, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42471
2022-05-08 08:14:07 - progress_bar.py[line:272] - INFO: epoch 002:   5272 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.94, expert1_balance_bottom=18.788, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=223.4, ups=0.58, wpb=383, bsz=32, num_updates=22950, lr=3.74568e-06, gnorm=3.616, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42488
2022-05-08 08:14:24 - progress_bar.py[line:272] - INFO: epoch 002:   5282 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=35.348, expert1_balance_bottom=18.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=227.1, ups=0.59, wpb=383.3, bsz=32, num_updates=22960, lr=3.74268e-06, gnorm=3.202, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42505
2022-05-08 08:14:41 - progress_bar.py[line:272] - INFO: epoch 002:   5292 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=388.4, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.973, expert1_balance_bottom=18.701, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=230.7, ups=0.59, wpb=388.4, bsz=32, num_updates=22970, lr=3.73968e-06, gnorm=3.202, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42522
2022-05-08 08:14:58 - progress_bar.py[line:272] - INFO: epoch 002:   5302 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=385.7, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887594, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.579, expert1_balance_bottom=18.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=232.4, ups=0.6, wpb=385.7, bsz=32, num_updates=22980, lr=3.73667e-06, gnorm=3.296, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42538
2022-05-08 08:15:14 - progress_bar.py[line:272] - INFO: epoch 002:   5312 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=382.7, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.014, expert1_balance_bottom=18.929, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=229.8, ups=0.6, wpb=382.7, bsz=32, num_updates=22990, lr=3.73367e-06, gnorm=3.465, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42555
2022-05-08 08:15:30 - progress_bar.py[line:272] - INFO: epoch 002:   5322 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=393.1, nsentences=32, sample_size=313.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.958, expert1_balance_bottom=18.737, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=242, ups=0.62, wpb=393.1, bsz=32, num_updates=23000, lr=3.73067e-06, gnorm=3.415, loss_scale=128, train_wall=15, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42571
2022-05-08 08:15:47 - progress_bar.py[line:272] - INFO: epoch 002:   5332 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=384.8, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.642, expert1_balance_bottom=18.878, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=236.1, ups=0.61, wpb=384.8, bsz=32, num_updates=23010, lr=3.72766e-06, gnorm=3.575, loss_scale=128, train_wall=15, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42588
2022-05-08 08:16:03 - progress_bar.py[line:272] - INFO: epoch 002:   5342 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=34.5, expert1_balance_bottom=19.067, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=229.3, ups=0.6, wpb=382, bsz=32, num_updates=23020, lr=3.72466e-06, gnorm=2.763, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42604
2022-05-08 08:16:20 - progress_bar.py[line:272] - INFO: epoch 002:   5352 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=365.7, nsentences=32, sample_size=290.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896062, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=34.466, expert1_balance_bottom=18.716, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=218.3, ups=0.6, wpb=365.7, bsz=32, num_updates=23030, lr=3.72166e-06, gnorm=3.218, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42621
2022-05-08 08:16:37 - progress_bar.py[line:272] - INFO: epoch 002:   5362 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88507, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.964, expert1_balance_bottom=18.758, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=229, ups=0.6, wpb=383.9, bsz=32, num_updates=23040, lr=3.71865e-06, gnorm=3, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42638
2022-05-08 08:16:49 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 08:16:55 - progress_bar.py[line:272] - INFO: epoch 002:   5373 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=389.7, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879429, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=35.121, expert1_balance_bottom=18.73, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.3, ups=0.54, wpb=389.7, bsz=32, num_updates=23050, lr=3.71565e-06, gnorm=3.329, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42656
2022-05-08 08:17:12 - progress_bar.py[line:272] - INFO: epoch 002:   5383 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883573, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.94, expert1_balance_bottom=18.791, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.9, ups=0.6, wpb=380.9, bsz=32, num_updates=23060, lr=3.71265e-06, gnorm=3.001, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42673
2022-05-08 08:17:29 - progress_bar.py[line:272] - INFO: epoch 002:   5393 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=383.6, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886006, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.642, expert1_balance_bottom=18.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=228.7, ups=0.6, wpb=383.6, bsz=32, num_updates=23070, lr=3.70964e-06, gnorm=3.35, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42690
2022-05-08 08:17:46 - progress_bar.py[line:272] - INFO: epoch 002:   5403 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=394.2, nsentences=32, sample_size=313.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=35.209, expert1_balance_bottom=18.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=229, ups=0.58, wpb=394.2, bsz=32, num_updates=23080, lr=3.70664e-06, gnorm=3.466, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42707
2022-05-08 08:18:03 - progress_bar.py[line:272] - INFO: epoch 002:   5413 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=378.3, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.214, expert1_balance_bottom=19.068, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.9, ups=0.6, wpb=378.3, bsz=32, num_updates=23090, lr=3.70364e-06, gnorm=3.722, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42724
2022-05-08 08:18:20 - progress_bar.py[line:272] - INFO: epoch 002:   5423 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=381.9, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888082, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.538, expert1_balance_bottom=18.85, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227, ups=0.59, wpb=381.9, bsz=32, num_updates=23100, lr=3.70063e-06, gnorm=3.484, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42740
2022-05-08 08:18:36 - progress_bar.py[line:272] - INFO: epoch 002:   5433 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.005, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=230.5, ups=0.6, wpb=385.2, bsz=32, num_updates=23110, lr=3.69763e-06, gnorm=3.516, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42757
2022-05-08 08:18:53 - progress_bar.py[line:272] - INFO: epoch 002:   5443 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884042, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.884, expert1_balance_bottom=18.862, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=227.8, ups=0.59, wpb=384.1, bsz=32, num_updates=23120, lr=3.69463e-06, gnorm=3.178, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42774
2022-05-08 08:19:10 - progress_bar.py[line:272] - INFO: epoch 002:   5453 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=388.5, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.601, expert1_balance_bottom=19.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=231.4, ups=0.6, wpb=388.5, bsz=32, num_updates=23130, lr=3.69162e-06, gnorm=3.426, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42791
2022-05-08 08:19:27 - progress_bar.py[line:272] - INFO: epoch 002:   5463 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=388.4, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885941, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.316, expert1_balance_bottom=19.047, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=230.5, ups=0.59, wpb=388.4, bsz=32, num_updates=23140, lr=3.68862e-06, gnorm=3.223, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42808
2022-05-08 08:19:44 - progress_bar.py[line:272] - INFO: epoch 002:   5473 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=379.3, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888838, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.528, expert1_balance_bottom=19.164, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=225.2, ups=0.59, wpb=379.3, bsz=32, num_updates=23150, lr=3.68562e-06, gnorm=3.251, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42824
2022-05-08 08:20:00 - progress_bar.py[line:272] - INFO: epoch 002:   5483 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=387, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882442, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.928, expert1_balance_bottom=18.844, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=231.8, ups=0.6, wpb=387, bsz=32, num_updates=23160, lr=3.68261e-06, gnorm=3.074, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42841
2022-05-08 08:20:17 - progress_bar.py[line:272] - INFO: epoch 002:   5493 / 17711 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875381, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.179, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=35.321, expert1_balance_bottom=18.757, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=231.8, ups=0.6, wpb=383.6, bsz=32, num_updates=23170, lr=3.67961e-06, gnorm=3.554, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42858
2022-05-08 08:20:34 - progress_bar.py[line:272] - INFO: epoch 002:   5503 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885129, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.716, expert1_balance_bottom=18.798, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=223.6, ups=0.59, wpb=380.2, bsz=32, num_updates=23180, lr=3.67661e-06, gnorm=3.459, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42875
2022-05-08 08:20:50 - progress_bar.py[line:272] - INFO: epoch 002:   5513 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.917, expert1_balance_bottom=18.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=235, ups=0.61, wpb=386.6, bsz=32, num_updates=23190, lr=3.6736e-06, gnorm=3.798, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42891
2022-05-08 08:21:07 - progress_bar.py[line:272] - INFO: epoch 002:   5523 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=1.007, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=35.031, expert1_balance_bottom=18.729, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=231.8, ups=0.6, wpb=383.4, bsz=32, num_updates=23200, lr=3.6706e-06, gnorm=3.948, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42908
2022-05-08 08:21:23 - progress_bar.py[line:272] - INFO: epoch 002:   5533 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=390.4, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869343, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=35.405, expert1_balance_bottom=18.636, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=235.7, ups=0.6, wpb=390.4, bsz=32, num_updates=23210, lr=3.6676e-06, gnorm=3.661, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42924
2022-05-08 08:21:40 - progress_bar.py[line:272] - INFO: epoch 002:   5543 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=389.5, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.545, expert1_balance_bottom=19.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=232.2, ups=0.6, wpb=389.5, bsz=32, num_updates=23220, lr=3.66459e-06, gnorm=3.505, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42941
2022-05-08 08:21:57 - progress_bar.py[line:272] - INFO: epoch 002:   5553 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=387.9, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.706, expert1_balance_bottom=19.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=228.5, ups=0.59, wpb=387.9, bsz=32, num_updates=23230, lr=3.66159e-06, gnorm=3.22, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42958
2022-05-08 08:22:14 - progress_bar.py[line:272] - INFO: epoch 002:   5563 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=384.5, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.028, expert1_balance_bottom=18.997, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=228.2, ups=0.59, wpb=384.5, bsz=32, num_updates=23240, lr=3.65859e-06, gnorm=2.88, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=42975
2022-05-08 08:22:31 - progress_bar.py[line:272] - INFO: epoch 002:   5573 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=380.8, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.728, expert1_balance_bottom=18.845, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=230.6, ups=0.61, wpb=380.8, bsz=32, num_updates=23250, lr=3.65558e-06, gnorm=3.277, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=42991
2022-05-08 08:22:48 - progress_bar.py[line:272] - INFO: epoch 002:   5583 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=377.3, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890392, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.436, expert1_balance_bottom=18.935, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=222.8, ups=0.59, wpb=377.3, bsz=32, num_updates=23260, lr=3.65258e-06, gnorm=3.285, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43008
2022-05-08 08:23:04 - progress_bar.py[line:272] - INFO: epoch 002:   5593 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=382, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888595, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.632, expert1_balance_bottom=18.818, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=227.5, ups=0.6, wpb=382, bsz=32, num_updates=23270, lr=3.64958e-06, gnorm=3.25, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=43025
2022-05-08 08:23:21 - progress_bar.py[line:272] - INFO: epoch 002:   5603 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=35.138, expert1_balance_bottom=18.597, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=226.2, ups=0.59, wpb=383.1, bsz=32, num_updates=23280, lr=3.64657e-06, gnorm=3.132, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=43042
2022-05-08 08:23:39 - progress_bar.py[line:272] - INFO: epoch 002:   5613 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889615, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.357, expert1_balance_bottom=18.906, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.3, ups=0.58, wpb=383.1, bsz=32, num_updates=23290, lr=3.64357e-06, gnorm=3.487, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43059
2022-05-08 08:23:56 - progress_bar.py[line:272] - INFO: epoch 002:   5623 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.658, expert1_balance_bottom=18.954, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=227, ups=0.59, wpb=386.6, bsz=32, num_updates=23300, lr=3.64057e-06, gnorm=2.968, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43076
2022-05-08 08:24:12 - progress_bar.py[line:272] - INFO: epoch 002:   5633 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=389.4, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=35.092, expert1_balance_bottom=18.818, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=233.2, ups=0.6, wpb=389.4, bsz=32, num_updates=23310, lr=3.63756e-06, gnorm=2.848, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43093
2022-05-08 08:24:29 - progress_bar.py[line:272] - INFO: epoch 002:   5643 / 17711 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897225, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=33.667, expert1_balance_bottom=19.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=226.8, ups=0.59, wpb=382.6, bsz=32, num_updates=23320, lr=3.63456e-06, gnorm=3.526, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43110
2022-05-08 08:24:46 - progress_bar.py[line:272] - INFO: epoch 002:   5653 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887275, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.786, expert1_balance_bottom=18.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222.1, ups=0.59, wpb=378.4, bsz=32, num_updates=23330, lr=3.63156e-06, gnorm=3.791, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43127
2022-05-08 08:25:03 - progress_bar.py[line:272] - INFO: epoch 002:   5663 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.291, expert1_balance_bottom=18.813, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=227.4, ups=0.6, wpb=378.4, bsz=32, num_updates=23340, lr=3.62856e-06, gnorm=3.288, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=43144
2022-05-08 08:25:20 - progress_bar.py[line:272] - INFO: epoch 002:   5673 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=380.1, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890599, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.305, expert1_balance_bottom=19.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=227.8, ups=0.6, wpb=380.1, bsz=32, num_updates=23350, lr=3.62555e-06, gnorm=3.52, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43160
2022-05-08 08:25:36 - progress_bar.py[line:272] - INFO: epoch 002:   5683 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=33.915, expert1_balance_bottom=19.124, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.1, ups=0.59, wpb=382.4, bsz=32, num_updates=23360, lr=3.62255e-06, gnorm=3.514, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43177
2022-05-08 08:25:53 - progress_bar.py[line:272] - INFO: epoch 002:   5693 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=379.7, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=35.239, expert1_balance_bottom=18.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.7, ups=0.59, wpb=379.7, bsz=32, num_updates=23370, lr=3.61955e-06, gnorm=3.341, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=43194
2022-05-08 08:26:10 - progress_bar.py[line:272] - INFO: epoch 002:   5703 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887026, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.676, expert1_balance_bottom=19.071, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=225.9, ups=0.59, wpb=382.4, bsz=32, num_updates=23380, lr=3.61654e-06, gnorm=3.221, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43211
2022-05-08 08:26:27 - progress_bar.py[line:272] - INFO: epoch 002:   5713 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=377.7, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=35.438, expert1_balance_bottom=18.686, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=223.7, ups=0.59, wpb=377.7, bsz=32, num_updates=23390, lr=3.61354e-06, gnorm=3.499, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43228
2022-05-08 08:26:44 - progress_bar.py[line:272] - INFO: epoch 002:   5723 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885901, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.98, expert1_balance_bottom=18.627, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=228.3, ups=0.6, wpb=380, bsz=32, num_updates=23400, lr=3.61054e-06, gnorm=2.941, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43245
2022-05-08 08:27:00 - progress_bar.py[line:272] - INFO: epoch 002:   5733 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.708, expert1_balance_bottom=19.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=231.2, ups=0.6, wpb=382.5, bsz=32, num_updates=23410, lr=3.60753e-06, gnorm=3.166, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43261
2022-05-08 08:27:17 - progress_bar.py[line:272] - INFO: epoch 002:   5743 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=378.9, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886545, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.968, expert1_balance_bottom=18.785, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=222, ups=0.59, wpb=378.9, bsz=32, num_updates=23420, lr=3.60453e-06, gnorm=3.513, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43278
2022-05-08 08:27:34 - progress_bar.py[line:272] - INFO: epoch 002:   5753 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=384.5, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=34.124, expert1_balance_bottom=19.095, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=229.8, ups=0.6, wpb=384.5, bsz=32, num_updates=23430, lr=3.60153e-06, gnorm=3.483, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43295
2022-05-08 08:27:50 - progress_bar.py[line:272] - INFO: epoch 002:   5763 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=381.1, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.465, expert1_balance_bottom=18.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=233.7, ups=0.61, wpb=381.1, bsz=32, num_updates=23440, lr=3.59852e-06, gnorm=3.677, loss_scale=64, train_wall=15, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43311
2022-05-08 08:28:07 - progress_bar.py[line:272] - INFO: epoch 002:   5773 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=374.1, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900569, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=33.842, expert1_balance_bottom=18.97, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.4, ups=0.6, wpb=374.1, bsz=32, num_updates=23450, lr=3.59552e-06, gnorm=3.258, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43328
2022-05-08 08:28:24 - progress_bar.py[line:272] - INFO: epoch 002:   5783 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.182, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=227, ups=0.59, wpb=383.9, bsz=32, num_updates=23460, lr=3.59252e-06, gnorm=4.121, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43345
2022-05-08 08:28:41 - progress_bar.py[line:272] - INFO: epoch 002:   5793 / 17711 loss=3.236, loss_v1=0, loss_v2=0, nll_loss=1.02, ntokens=378.5, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.236, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.162, expert1_balance_bottom=18.874, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.03, wps=227.2, ups=0.6, wpb=378.5, bsz=32, num_updates=23470, lr=3.58951e-06, gnorm=3.009, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43362
2022-05-08 08:28:58 - progress_bar.py[line:272] - INFO: epoch 002:   5803 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=384.4, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869619, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=35.498, expert1_balance_bottom=18.763, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=227, ups=0.59, wpb=384.4, bsz=32, num_updates=23480, lr=3.58651e-06, gnorm=3.447, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43378
2022-05-08 08:29:15 - progress_bar.py[line:272] - INFO: epoch 002:   5813 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=375.1, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890261, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.709, expert1_balance_bottom=18.645, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=220.8, ups=0.59, wpb=375.1, bsz=32, num_updates=23490, lr=3.58351e-06, gnorm=3.089, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43395
2022-05-08 08:29:31 - progress_bar.py[line:272] - INFO: epoch 002:   5823 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=374.9, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.236, expert1_balance_top=33.282, expert1_balance_bottom=19.287, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.4, ups=0.6, wpb=374.9, bsz=32, num_updates=23500, lr=3.5805e-06, gnorm=3.237, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43412
2022-05-08 08:29:48 - progress_bar.py[line:272] - INFO: epoch 002:   5833 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892112, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.309, expert1_balance_bottom=18.926, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=230.5, ups=0.6, wpb=381.7, bsz=32, num_updates=23510, lr=3.5775e-06, gnorm=3.142, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43429
2022-05-08 08:30:05 - progress_bar.py[line:272] - INFO: epoch 002:   5843 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.974, ntokens=394.4, nsentences=32, sample_size=314, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=35.44, expert1_balance_bottom=18.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=236.6, ups=0.6, wpb=394.4, bsz=32, num_updates=23520, lr=3.5745e-06, gnorm=3.841, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43445
2022-05-08 08:30:21 - progress_bar.py[line:272] - INFO: epoch 002:   5853 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=375.7, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.189, expert1_balance_bottom=19.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=226.9, ups=0.6, wpb=375.7, bsz=32, num_updates=23530, lr=3.57149e-06, gnorm=3.775, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43462
2022-05-08 08:30:38 - progress_bar.py[line:272] - INFO: epoch 002:   5863 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.818, expert1_balance_bottom=18.812, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=227.5, ups=0.59, wpb=382.5, bsz=32, num_updates=23540, lr=3.56849e-06, gnorm=3.67, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43479
2022-05-08 08:30:55 - progress_bar.py[line:272] - INFO: epoch 002:   5873 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872355, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=35.654, expert1_balance_bottom=18.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=224.2, ups=0.59, wpb=377.4, bsz=32, num_updates=23550, lr=3.56549e-06, gnorm=3.488, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43495
2022-05-08 08:31:12 - progress_bar.py[line:272] - INFO: epoch 002:   5883 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=378.3, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.302, expert1_balance_bottom=19.161, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.3, ups=0.59, wpb=378.3, bsz=32, num_updates=23560, lr=3.56248e-06, gnorm=2.726, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43512
2022-05-08 08:31:25 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 08:31:30 - progress_bar.py[line:272] - INFO: epoch 002:   5894 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882062, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.984, expert1_balance_bottom=18.867, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=210.9, ups=0.55, wpb=384.2, bsz=32, num_updates=23570, lr=3.55948e-06, gnorm=3.359, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43531
2022-05-08 08:31:47 - progress_bar.py[line:272] - INFO: epoch 002:   5904 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881911, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=35.019, expert1_balance_bottom=18.885, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.4, ups=0.59, wpb=380.4, bsz=32, num_updates=23580, lr=3.55648e-06, gnorm=3.847, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=43548
2022-05-08 08:32:04 - progress_bar.py[line:272] - INFO: epoch 002:   5914 / 17711 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.191, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.069, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=225.4, ups=0.59, wpb=381.5, bsz=32, num_updates=23590, lr=3.55347e-06, gnorm=3.641, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43565
2022-05-08 08:32:21 - progress_bar.py[line:272] - INFO: epoch 002:   5924 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=390, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.539, expert1_balance_bottom=19.017, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=228.5, ups=0.59, wpb=390, bsz=32, num_updates=23600, lr=3.55047e-06, gnorm=4.124, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43582
2022-05-08 08:32:38 - progress_bar.py[line:272] - INFO: epoch 002:   5934 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=374.1, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=33.773, expert1_balance_bottom=19.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.3, ups=0.59, wpb=374.1, bsz=32, num_updates=23610, lr=3.54747e-06, gnorm=3.056, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43598
2022-05-08 08:32:55 - progress_bar.py[line:272] - INFO: epoch 002:   5944 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.42, expert1_balance_bottom=18.734, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=222.3, ups=0.59, wpb=378.7, bsz=32, num_updates=23620, lr=3.54446e-06, gnorm=3.612, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43615
2022-05-08 08:33:11 - progress_bar.py[line:272] - INFO: epoch 002:   5954 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=393.5, nsentences=32, sample_size=313.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878631, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.623, expert1_balance_bottom=18.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=236, ups=0.6, wpb=393.5, bsz=32, num_updates=23630, lr=3.54146e-06, gnorm=3.481, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43632
2022-05-08 08:33:28 - progress_bar.py[line:272] - INFO: epoch 002:   5964 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.947, expert1_balance_bottom=18.844, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=226.9, ups=0.59, wpb=382.8, bsz=32, num_updates=23640, lr=3.53846e-06, gnorm=3.467, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43649
2022-05-08 08:33:45 - progress_bar.py[line:272] - INFO: epoch 002:   5974 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896678, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=33.83, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=225.9, ups=0.6, wpb=379.2, bsz=32, num_updates=23650, lr=3.53545e-06, gnorm=3.396, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43666
2022-05-08 08:34:02 - progress_bar.py[line:272] - INFO: epoch 002:   5984 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=387.1, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877411, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=35.036, expert1_balance_bottom=18.687, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=228, ups=0.59, wpb=387.1, bsz=32, num_updates=23660, lr=3.53245e-06, gnorm=2.845, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43683
2022-05-08 08:34:19 - progress_bar.py[line:272] - INFO: epoch 002:   5994 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=35.112, expert1_balance_bottom=18.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=227.8, ups=0.6, wpb=381.1, bsz=32, num_updates=23670, lr=3.52945e-06, gnorm=3.12, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43699
2022-05-08 08:34:35 - progress_bar.py[line:272] - INFO: epoch 002:   6004 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.085, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=228.9, ups=0.61, wpb=378.1, bsz=32, num_updates=23680, lr=3.52644e-06, gnorm=2.683, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43716
2022-05-08 08:34:52 - progress_bar.py[line:272] - INFO: epoch 002:   6014 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=393.4, nsentences=32, sample_size=313.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.434, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=238.5, ups=0.61, wpb=393.4, bsz=32, num_updates=23690, lr=3.52344e-06, gnorm=3.216, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43732
2022-05-08 08:35:08 - progress_bar.py[line:272] - INFO: epoch 002:   6024 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=375.1, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883977, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.712, expert1_balance_bottom=18.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.7, ups=0.6, wpb=375.1, bsz=32, num_updates=23700, lr=3.52044e-06, gnorm=3.288, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43749
2022-05-08 08:35:25 - progress_bar.py[line:272] - INFO: epoch 002:   6034 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=383.4, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.852, expert1_balance_bottom=18.933, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=227.1, ups=0.59, wpb=383.4, bsz=32, num_updates=23710, lr=3.51743e-06, gnorm=4.077, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43766
2022-05-08 08:35:42 - progress_bar.py[line:272] - INFO: epoch 002:   6044 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=386, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88688, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.383, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=232.7, ups=0.6, wpb=386, bsz=32, num_updates=23720, lr=3.51443e-06, gnorm=3.087, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43783
2022-05-08 08:35:59 - progress_bar.py[line:272] - INFO: epoch 002:   6054 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878407, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.49, expert1_balance_bottom=18.942, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=228.7, ups=0.6, wpb=381.9, bsz=32, num_updates=23730, lr=3.51143e-06, gnorm=3.474, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43799
2022-05-08 08:36:16 - progress_bar.py[line:272] - INFO: epoch 002:   6064 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=393.7, nsentences=32, sample_size=313.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=35.108, expert1_balance_bottom=18.69, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=230.7, ups=0.59, wpb=393.7, bsz=32, num_updates=23740, lr=3.50842e-06, gnorm=3.391, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43816
2022-05-08 08:36:32 - progress_bar.py[line:272] - INFO: epoch 002:   6074 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=35.13, expert1_balance_bottom=18.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=229.4, ups=0.6, wpb=382.5, bsz=32, num_updates=23750, lr=3.50542e-06, gnorm=2.776, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43833
2022-05-08 08:36:49 - progress_bar.py[line:272] - INFO: epoch 002:   6084 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875071, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.393, expert1_balance_bottom=18.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=234.1, ups=0.61, wpb=383.9, bsz=32, num_updates=23760, lr=3.50242e-06, gnorm=3.202, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43849
2022-05-08 08:37:06 - progress_bar.py[line:272] - INFO: epoch 002:   6094 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=385.6, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.344, expert1_balance_bottom=19.111, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=228.1, ups=0.59, wpb=385.6, bsz=32, num_updates=23770, lr=3.49941e-06, gnorm=2.988, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43866
2022-05-08 08:37:22 - progress_bar.py[line:272] - INFO: epoch 002:   6104 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=377.5, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.234, expert1_balance_top=33.823, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=225.1, ups=0.6, wpb=377.5, bsz=32, num_updates=23780, lr=3.49641e-06, gnorm=3.61, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43883
2022-05-08 08:37:39 - progress_bar.py[line:272] - INFO: epoch 002:   6114 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=374.3, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.613, expert1_balance_bottom=18.936, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=225.2, ups=0.6, wpb=374.3, bsz=32, num_updates=23790, lr=3.49341e-06, gnorm=3.326, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43900
2022-05-08 08:37:56 - progress_bar.py[line:272] - INFO: epoch 002:   6124 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=374, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=33.898, expert1_balance_bottom=18.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223, ups=0.6, wpb=374, bsz=32, num_updates=23800, lr=3.4904e-06, gnorm=3.133, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43916
2022-05-08 08:38:13 - progress_bar.py[line:272] - INFO: epoch 002:   6134 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=377.6, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.995, expert1_balance_bottom=18.847, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.9, ups=0.59, wpb=377.6, bsz=32, num_updates=23810, lr=3.4874e-06, gnorm=3.278, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43933
2022-05-08 08:38:29 - progress_bar.py[line:272] - INFO: epoch 002:   6144 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=378.9, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.447, expert1_balance_bottom=19.132, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.3, ups=0.59, wpb=378.9, bsz=32, num_updates=23820, lr=3.4844e-06, gnorm=3.303, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43950
2022-05-08 08:38:46 - progress_bar.py[line:272] - INFO: epoch 002:   6154 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=372.2, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=33.484, expert1_balance_bottom=19.218, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221.8, ups=0.6, wpb=372.2, bsz=32, num_updates=23830, lr=3.48139e-06, gnorm=3.492, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43967
2022-05-08 08:39:03 - progress_bar.py[line:272] - INFO: epoch 002:   6164 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891878, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.292, expert1_balance_bottom=19.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=225.5, ups=0.59, wpb=381.2, bsz=32, num_updates=23840, lr=3.47839e-06, gnorm=3.121, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=43984
2022-05-08 08:39:19 - progress_bar.py[line:272] - INFO: epoch 002:   6174 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=35.257, expert1_balance_bottom=18.779, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=235.7, ups=0.61, wpb=384.7, bsz=32, num_updates=23850, lr=3.47539e-06, gnorm=3.403, loss_scale=64, train_wall=15, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44000
2022-05-08 08:39:36 - progress_bar.py[line:272] - INFO: epoch 002:   6184 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88438, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.354, expert1_balance_bottom=18.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=234.7, ups=0.61, wpb=385.3, bsz=32, num_updates=23860, lr=3.47238e-06, gnorm=3.352, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44017
2022-05-08 08:39:53 - progress_bar.py[line:272] - INFO: epoch 002:   6194 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.33, expert1_balance_bottom=19.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.7, ups=0.59, wpb=377.1, bsz=32, num_updates=23870, lr=3.46938e-06, gnorm=3.491, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44034
2022-05-08 08:40:10 - progress_bar.py[line:272] - INFO: epoch 002:   6204 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878462, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.679, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=229.1, ups=0.6, wpb=383.6, bsz=32, num_updates=23880, lr=3.46638e-06, gnorm=3.085, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44050
2022-05-08 08:40:27 - progress_bar.py[line:272] - INFO: epoch 002:   6214 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=390.4, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884448, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.602, expert1_balance_bottom=18.676, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=230.5, ups=0.59, wpb=390.4, bsz=32, num_updates=23890, lr=3.46338e-06, gnorm=3.382, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44067
2022-05-08 08:40:43 - progress_bar.py[line:272] - INFO: epoch 002:   6224 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=383.7, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885499, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.695, expert1_balance_bottom=18.811, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=227.1, ups=0.59, wpb=383.7, bsz=32, num_updates=23900, lr=3.46037e-06, gnorm=3.403, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44084
2022-05-08 08:41:00 - progress_bar.py[line:272] - INFO: epoch 002:   6234 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=385.9, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896144, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.129, expert1_balance_bottom=19.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.1, ups=0.59, wpb=385.9, bsz=32, num_updates=23910, lr=3.45737e-06, gnorm=3.395, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44101
2022-05-08 08:41:17 - progress_bar.py[line:272] - INFO: epoch 002:   6244 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=383.3, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887799, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.658, expert1_balance_bottom=18.95, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.3, ups=0.59, wpb=383.3, bsz=32, num_updates=23920, lr=3.45437e-06, gnorm=3.212, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44118
2022-05-08 08:41:34 - progress_bar.py[line:272] - INFO: epoch 002:   6254 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=388.2, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.299, expert1_balance_bottom=18.858, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=229.3, ups=0.59, wpb=388.2, bsz=32, num_updates=23930, lr=3.45136e-06, gnorm=3.274, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44135
2022-05-08 08:41:51 - progress_bar.py[line:272] - INFO: epoch 002:   6264 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=378.3, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.62, expert1_balance_bottom=18.96, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.9, ups=0.58, wpb=378.3, bsz=32, num_updates=23940, lr=3.44836e-06, gnorm=3.329, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44152
2022-05-08 08:42:08 - progress_bar.py[line:272] - INFO: epoch 002:   6274 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=391.4, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.494, expert1_balance_bottom=18.929, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=230.4, ups=0.59, wpb=391.4, bsz=32, num_updates=23950, lr=3.44536e-06, gnorm=3.805, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44169
2022-05-08 08:42:26 - progress_bar.py[line:272] - INFO: epoch 002:   6284 / 17711 loss=3.217, loss_v1=0, loss_v2=0, nll_loss=1.012, ntokens=379.4, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.217, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.983, expert1_balance_bottom=18.923, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=221.7, ups=0.58, wpb=379.4, bsz=32, num_updates=23960, lr=3.44235e-06, gnorm=3.691, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44186
2022-05-08 08:42:43 - progress_bar.py[line:272] - INFO: epoch 002:   6294 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=33.235, expert1_balance_bottom=19.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.8, ups=0.58, wpb=381.8, bsz=32, num_updates=23970, lr=3.43935e-06, gnorm=3.287, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44203
2022-05-08 08:43:00 - progress_bar.py[line:272] - INFO: epoch 002:   6304 / 17711 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=1.026, ntokens=382.5, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887286, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.234, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=33.968, expert1_balance_bottom=19.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=225.5, ups=0.59, wpb=382.5, bsz=32, num_updates=23980, lr=3.43635e-06, gnorm=3.77, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44220
2022-05-08 08:43:17 - progress_bar.py[line:272] - INFO: epoch 002:   6314 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888641, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.666, expert1_balance_bottom=18.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.5, ups=0.59, wpb=379.2, bsz=32, num_updates=23990, lr=3.43334e-06, gnorm=3.366, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=44237
2022-05-08 08:43:33 - progress_bar.py[line:272] - INFO: epoch 002:   6324 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=387.3, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.243, expert1_balance_bottom=18.98, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=232.3, ups=0.6, wpb=387.3, bsz=32, num_updates=24000, lr=3.43034e-06, gnorm=3.004, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44254
2022-05-08 08:43:50 - progress_bar.py[line:272] - INFO: epoch 002:   6334 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.359, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=230.4, ups=0.6, wpb=384.3, bsz=32, num_updates=24010, lr=3.42734e-06, gnorm=3.343, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44271
2022-05-08 08:44:07 - progress_bar.py[line:272] - INFO: epoch 002:   6344 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=35.244, expert1_balance_bottom=18.767, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=228.9, ups=0.6, wpb=383.6, bsz=32, num_updates=24020, lr=3.42433e-06, gnorm=3.366, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44288
2022-05-08 08:44:24 - progress_bar.py[line:272] - INFO: epoch 002:   6354 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=386.9, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.656, expert1_balance_bottom=18.849, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=228.9, ups=0.59, wpb=386.9, bsz=32, num_updates=24030, lr=3.42133e-06, gnorm=3.704, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44304
2022-05-08 08:44:41 - progress_bar.py[line:272] - INFO: epoch 002:   6364 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=387.3, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881401, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.707, expert1_balance_bottom=18.961, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=229.5, ups=0.59, wpb=387.3, bsz=32, num_updates=24040, lr=3.41833e-06, gnorm=3.222, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44321
2022-05-08 08:44:58 - progress_bar.py[line:272] - INFO: epoch 002:   6374 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=382.1, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.617, expert1_balance_bottom=18.991, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=221.5, ups=0.58, wpb=382.1, bsz=32, num_updates=24050, lr=3.41532e-06, gnorm=3.319, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44339
2022-05-08 08:45:15 - progress_bar.py[line:272] - INFO: epoch 002:   6384 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=375.3, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898172, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=34.035, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=220.5, ups=0.59, wpb=375.3, bsz=32, num_updates=24060, lr=3.41232e-06, gnorm=4.172, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=44356
2022-05-08 08:45:32 - progress_bar.py[line:272] - INFO: epoch 002:   6394 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=376.3, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=35.203, expert1_balance_bottom=18.831, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.2, ups=0.59, wpb=376.3, bsz=32, num_updates=24070, lr=3.40932e-06, gnorm=3.844, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44373
2022-05-08 08:45:48 - progress_bar.py[line:272] - INFO: epoch 002:   6404 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=382.6, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8804, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.868, expert1_balance_bottom=18.763, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=232.6, ups=0.61, wpb=382.6, bsz=32, num_updates=24080, lr=3.40631e-06, gnorm=3.063, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=44389
2022-05-08 08:46:05 - progress_bar.py[line:272] - INFO: epoch 002:   6414 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=387, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889324, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.576, expert1_balance_bottom=19.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=233.2, ups=0.6, wpb=387, bsz=32, num_updates=24090, lr=3.40331e-06, gnorm=3.17, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=44406
2022-05-08 08:46:21 - progress_bar.py[line:272] - INFO: epoch 002:   6424 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=380.6, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.611, expert1_balance_bottom=19.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.6, ups=0.6, wpb=380.6, bsz=32, num_updates=24100, lr=3.40031e-06, gnorm=2.931, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44422
2022-05-08 08:46:39 - progress_bar.py[line:272] - INFO: epoch 002:   6434 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.423, expert1_balance_bottom=18.953, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.2, ups=0.58, wpb=380.1, bsz=32, num_updates=24110, lr=3.3973e-06, gnorm=3.412, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44439
2022-05-08 08:46:55 - progress_bar.py[line:272] - INFO: epoch 002:   6444 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877795, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.947, expert1_balance_bottom=18.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=226.4, ups=0.59, wpb=383.6, bsz=32, num_updates=24120, lr=3.3943e-06, gnorm=3.573, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44456
2022-05-08 08:47:12 - progress_bar.py[line:272] - INFO: epoch 002:   6454 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=387.1, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=35.254, expert1_balance_bottom=18.797, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.5, ups=0.59, wpb=387.1, bsz=32, num_updates=24130, lr=3.3913e-06, gnorm=3.11, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44473
2022-05-08 08:47:29 - progress_bar.py[line:272] - INFO: epoch 002:   6464 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=36.05, expert1_balance_bottom=18.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=228.5, ups=0.6, wpb=382.6, bsz=32, num_updates=24140, lr=3.38829e-06, gnorm=3.359, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44490
2022-05-08 08:47:46 - progress_bar.py[line:272] - INFO: epoch 002:   6474 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88067, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.693, expert1_balance_bottom=19.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=220.5, ups=0.58, wpb=381.2, bsz=32, num_updates=24150, lr=3.38529e-06, gnorm=3.747, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44507
2022-05-08 08:48:04 - progress_bar.py[line:272] - INFO: epoch 002:   6484 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=383.3, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902249, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=33.68, expert1_balance_bottom=19.145, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.8, ups=0.57, wpb=383.3, bsz=32, num_updates=24160, lr=3.38229e-06, gnorm=3.593, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=44525
2022-05-08 08:48:21 - progress_bar.py[line:272] - INFO: epoch 002:   6494 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87838, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.351, expert1_balance_bottom=18.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=227.4, ups=0.59, wpb=384.3, bsz=32, num_updates=24170, lr=3.37928e-06, gnorm=3.872, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44542
2022-05-08 08:48:38 - progress_bar.py[line:272] - INFO: epoch 002:   6504 / 17711 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888464, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.171, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.389, expert1_balance_bottom=19.03, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=225.1, ups=0.59, wpb=383.2, bsz=32, num_updates=24180, lr=3.37628e-06, gnorm=3.633, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44559
2022-05-08 08:48:55 - progress_bar.py[line:272] - INFO: epoch 002:   6514 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.518, expert1_balance_bottom=18.949, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=227.6, ups=0.6, wpb=381.6, bsz=32, num_updates=24190, lr=3.37328e-06, gnorm=3.289, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=44575
2022-05-08 08:49:12 - progress_bar.py[line:272] - INFO: epoch 002:   6524 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.791, expert1_balance_bottom=18.938, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.1, ups=0.58, wpb=382.1, bsz=32, num_updates=24200, lr=3.37027e-06, gnorm=3.13, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44592
2022-05-08 08:49:29 - progress_bar.py[line:272] - INFO: epoch 002:   6534 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=380.4, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.307, expert1_balance_bottom=18.838, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=226, ups=0.59, wpb=380.4, bsz=32, num_updates=24210, lr=3.36727e-06, gnorm=3.123, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44609
2022-05-08 08:49:46 - progress_bar.py[line:272] - INFO: epoch 002:   6544 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=392.2, nsentences=32, sample_size=312.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883977, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.679, expert1_balance_bottom=18.795, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=230.8, ups=0.59, wpb=392.2, bsz=32, num_updates=24220, lr=3.36427e-06, gnorm=3.296, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44626
2022-05-08 08:50:03 - progress_bar.py[line:272] - INFO: epoch 002:   6554 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=374.9, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894411, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=33.688, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=221, ups=0.59, wpb=374.9, bsz=32, num_updates=24230, lr=3.36126e-06, gnorm=3.485, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44643
2022-05-08 08:50:19 - progress_bar.py[line:272] - INFO: epoch 002:   6564 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=378.4, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.421, expert1_balance_bottom=18.885, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=225.2, ups=0.6, wpb=378.4, bsz=32, num_updates=24240, lr=3.35826e-06, gnorm=3.045, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44660
2022-05-08 08:50:36 - progress_bar.py[line:272] - INFO: epoch 002:   6574 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=376.8, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.322, expert1_balance_bottom=18.952, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.4, ups=0.59, wpb=376.8, bsz=32, num_updates=24250, lr=3.35526e-06, gnorm=3.255, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44677
2022-05-08 08:50:53 - progress_bar.py[line:272] - INFO: epoch 002:   6584 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=373.7, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=33.992, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.9, ups=0.6, wpb=373.7, bsz=32, num_updates=24260, lr=3.35225e-06, gnorm=3.255, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44694
2022-05-08 08:51:10 - progress_bar.py[line:272] - INFO: epoch 002:   6594 / 17711 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=374.7, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896588, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.207, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=33.821, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=220.2, ups=0.59, wpb=374.7, bsz=32, num_updates=24270, lr=3.34925e-06, gnorm=4.121, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44711
2022-05-08 08:51:27 - progress_bar.py[line:272] - INFO: epoch 002:   6604 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=393.6, nsentences=32, sample_size=313.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.773, expert1_balance_bottom=18.84, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227, ups=0.58, wpb=393.6, bsz=32, num_updates=24280, lr=3.34625e-06, gnorm=3.453, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44728
2022-05-08 08:51:44 - progress_bar.py[line:272] - INFO: epoch 002:   6614 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=389, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886449, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.284, expert1_balance_bottom=18.969, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=229.6, ups=0.59, wpb=389, bsz=32, num_updates=24290, lr=3.34324e-06, gnorm=3.348, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44745
2022-05-08 08:52:01 - progress_bar.py[line:272] - INFO: epoch 002:   6624 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.197, expert1_balance_bottom=18.886, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=226.4, ups=0.59, wpb=383.8, bsz=32, num_updates=24300, lr=3.34024e-06, gnorm=3.82, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44762
2022-05-08 08:52:18 - progress_bar.py[line:272] - INFO: epoch 002:   6634 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=385.1, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=35.153, expert1_balance_bottom=18.773, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=228.4, ups=0.59, wpb=385.1, bsz=32, num_updates=24310, lr=3.33724e-06, gnorm=3.594, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44779
2022-05-08 08:52:35 - progress_bar.py[line:272] - INFO: epoch 002:   6644 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=387.4, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=35.004, expert1_balance_bottom=18.811, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.4, ups=0.58, wpb=387.4, bsz=32, num_updates=24320, lr=3.33423e-06, gnorm=3.441, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44796
2022-05-08 08:52:53 - progress_bar.py[line:272] - INFO: epoch 002:   6654 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=375.5, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.318, expert1_balance_bottom=18.842, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=217.7, ups=0.58, wpb=375.5, bsz=32, num_updates=24330, lr=3.33123e-06, gnorm=3.68, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44813
2022-05-08 08:53:10 - progress_bar.py[line:272] - INFO: epoch 002:   6664 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.971, ntokens=378.2, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.305, expert1_balance_bottom=18.954, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=220.4, ups=0.58, wpb=378.2, bsz=32, num_updates=24340, lr=3.32823e-06, gnorm=3.39, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44831
2022-05-08 08:53:27 - progress_bar.py[line:272] - INFO: epoch 002:   6674 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=374.1, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885613, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.887, expert1_balance_bottom=18.865, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=219.9, ups=0.59, wpb=374.1, bsz=32, num_updates=24350, lr=3.32522e-06, gnorm=3.493, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44848
2022-05-08 08:53:44 - progress_bar.py[line:272] - INFO: epoch 002:   6684 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.422, expert1_balance_bottom=19.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.4, ups=0.59, wpb=380.7, bsz=32, num_updates=24360, lr=3.32222e-06, gnorm=3.23, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44864
2022-05-08 08:54:01 - progress_bar.py[line:272] - INFO: epoch 002:   6694 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=388.7, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874454, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.026, expert1_balance_bottom=18.794, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=228.3, ups=0.59, wpb=388.7, bsz=32, num_updates=24370, lr=3.31922e-06, gnorm=3.914, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44881
2022-05-08 08:54:18 - progress_bar.py[line:272] - INFO: epoch 002:   6704 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888512, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.914, expert1_balance_bottom=18.675, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.9, ups=0.59, wpb=379.2, bsz=32, num_updates=24380, lr=3.31621e-06, gnorm=3.061, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=44899
2022-05-08 08:54:35 - progress_bar.py[line:272] - INFO: epoch 002:   6714 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.667, expert1_balance_bottom=18.828, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=226, ups=0.59, wpb=381.5, bsz=32, num_updates=24390, lr=3.31321e-06, gnorm=3.502, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44915
2022-05-08 08:54:51 - progress_bar.py[line:272] - INFO: epoch 002:   6724 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=381.4, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=33.527, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=226.9, ups=0.59, wpb=381.4, bsz=32, num_updates=24400, lr=3.31021e-06, gnorm=3.145, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44932
2022-05-08 08:55:08 - progress_bar.py[line:272] - INFO: epoch 002:   6734 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=396.6, nsentences=32, sample_size=315.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=35.713, expert1_balance_bottom=18.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=237.9, ups=0.6, wpb=396.6, bsz=32, num_updates=24410, lr=3.3072e-06, gnorm=3.613, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44949
2022-05-08 08:55:25 - progress_bar.py[line:272] - INFO: epoch 002:   6744 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.09, expert1_balance_bottom=19.078, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.1, ups=0.59, wpb=381.5, bsz=32, num_updates=24420, lr=3.3042e-06, gnorm=2.992, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44966
2022-05-08 08:55:42 - progress_bar.py[line:272] - INFO: epoch 002:   6754 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=386, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.634, expert1_balance_bottom=18.986, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=230.4, ups=0.6, wpb=386, bsz=32, num_updates=24430, lr=3.3012e-06, gnorm=3.621, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=44983
2022-05-08 08:55:59 - progress_bar.py[line:272] - INFO: epoch 002:   6764 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=376.8, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.63, expert1_balance_bottom=18.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.5, ups=0.58, wpb=376.8, bsz=32, num_updates=24440, lr=3.2982e-06, gnorm=3.183, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45000
2022-05-08 08:56:16 - progress_bar.py[line:272] - INFO: epoch 002:   6774 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=375.3, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.879, expert1_balance_bottom=18.737, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=221.5, ups=0.59, wpb=375.3, bsz=32, num_updates=24450, lr=3.29519e-06, gnorm=3.32, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45017
2022-05-08 08:56:33 - progress_bar.py[line:272] - INFO: epoch 002:   6784 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=389.9, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883452, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.636, expert1_balance_bottom=18.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=230.2, ups=0.59, wpb=389.9, bsz=32, num_updates=24460, lr=3.29219e-06, gnorm=3.592, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45034
2022-05-08 08:56:50 - progress_bar.py[line:272] - INFO: epoch 002:   6794 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=388.2, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892782, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.231, expert1_balance_top=34.349, expert1_balance_bottom=19.071, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=229, ups=0.59, wpb=388.2, bsz=32, num_updates=24470, lr=3.28919e-06, gnorm=3.502, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45051
2022-05-08 08:57:07 - progress_bar.py[line:272] - INFO: epoch 002:   6804 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.92, expert1_balance_bottom=18.762, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=228.3, ups=0.59, wpb=384.7, bsz=32, num_updates=24480, lr=3.28618e-06, gnorm=3.904, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45068
2022-05-08 08:57:24 - progress_bar.py[line:272] - INFO: epoch 002:   6814 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=378, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.77, expert1_balance_bottom=18.909, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220.9, ups=0.58, wpb=378, bsz=32, num_updates=24490, lr=3.28318e-06, gnorm=3.479, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45085
2022-05-08 08:57:41 - progress_bar.py[line:272] - INFO: epoch 002:   6824 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898701, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=33.41, expert1_balance_bottom=19.218, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=229.1, ups=0.6, wpb=384.3, bsz=32, num_updates=24500, lr=3.28018e-06, gnorm=2.967, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45101
2022-05-08 08:57:58 - progress_bar.py[line:272] - INFO: epoch 002:   6834 / 17711 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=386.9, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.206, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.41, expert1_balance_bottom=18.661, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=222.7, ups=0.58, wpb=386.9, bsz=32, num_updates=24510, lr=3.27717e-06, gnorm=3.713, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45119
2022-05-08 08:58:15 - progress_bar.py[line:272] - INFO: epoch 002:   6844 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=380.7, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884116, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.938, expert1_balance_bottom=18.732, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=221.9, ups=0.58, wpb=380.7, bsz=32, num_updates=24520, lr=3.27417e-06, gnorm=3.336, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45136
2022-05-08 08:58:32 - progress_bar.py[line:272] - INFO: epoch 002:   6854 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=381.2, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.268, expert1_balance_bottom=19.086, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=224.8, ups=0.59, wpb=381.2, bsz=32, num_updates=24530, lr=3.27117e-06, gnorm=3.443, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45153
2022-05-08 08:58:49 - progress_bar.py[line:272] - INFO: epoch 002:   6864 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=385.9, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893193, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=34.105, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=228.2, ups=0.59, wpb=385.9, bsz=32, num_updates=24540, lr=3.26816e-06, gnorm=3.39, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45170
2022-05-08 08:59:06 - progress_bar.py[line:272] - INFO: epoch 002:   6874 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=377.4, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.896, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=220.5, ups=0.58, wpb=377.4, bsz=32, num_updates=24550, lr=3.26516e-06, gnorm=3.586, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=45187
2022-05-08 08:59:23 - progress_bar.py[line:272] - INFO: epoch 002:   6884 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=375.3, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.232, expert1_balance_top=33.769, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=221.4, ups=0.59, wpb=375.3, bsz=32, num_updates=24560, lr=3.26216e-06, gnorm=3.831, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45204
2022-05-08 08:59:33 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 08:59:42 - progress_bar.py[line:272] - INFO: epoch 002:   6895 / 17711 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=1.005, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.215, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.313, expert1_balance_bottom=18.866, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=202.8, ups=0.54, wpb=378.2, bsz=32, num_updates=24570, lr=3.25915e-06, gnorm=3.659, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45223
2022-05-08 08:59:59 - progress_bar.py[line:272] - INFO: epoch 002:   6905 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.233, expert1_balance_top=33.981, expert1_balance_bottom=19.002, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=226, ups=0.6, wpb=379, bsz=32, num_updates=24580, lr=3.25615e-06, gnorm=3.493, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45239
2022-05-08 09:00:15 - progress_bar.py[line:272] - INFO: epoch 002:   6915 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884427, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.419, expert1_balance_bottom=18.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=226.6, ups=0.6, wpb=380.1, bsz=32, num_updates=24590, lr=3.25315e-06, gnorm=3.377, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45256
2022-05-08 09:00:32 - progress_bar.py[line:272] - INFO: epoch 002:   6925 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885205, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.57, expert1_balance_bottom=18.899, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=228.9, ups=0.6, wpb=381.3, bsz=32, num_updates=24600, lr=3.25014e-06, gnorm=3.452, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45273
2022-05-08 09:00:49 - progress_bar.py[line:272] - INFO: epoch 002:   6935 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=390.6, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88033, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.752, expert1_balance_bottom=18.797, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=231.9, ups=0.59, wpb=390.6, bsz=32, num_updates=24610, lr=3.24714e-06, gnorm=3.286, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45290
2022-05-08 09:01:06 - progress_bar.py[line:272] - INFO: epoch 002:   6945 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=384.5, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.528, expert1_balance_bottom=19.096, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=228.3, ups=0.59, wpb=384.5, bsz=32, num_updates=24620, lr=3.24414e-06, gnorm=3.386, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45306
2022-05-08 09:01:22 - progress_bar.py[line:272] - INFO: epoch 002:   6955 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=375.1, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.235, expert1_balance_top=33.43, expert1_balance_bottom=19.111, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224, ups=0.6, wpb=375.1, bsz=32, num_updates=24630, lr=3.24113e-06, gnorm=2.919, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=45323
2022-05-08 09:01:40 - progress_bar.py[line:272] - INFO: epoch 002:   6965 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.638, expert1_balance_bottom=18.829, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=221.2, ups=0.58, wpb=383.4, bsz=32, num_updates=24640, lr=3.23813e-06, gnorm=3.2, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45340
2022-05-08 09:01:57 - progress_bar.py[line:272] - INFO: epoch 002:   6975 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899496, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=33.893, expert1_balance_bottom=19.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=220.6, ups=0.58, wpb=380.1, bsz=32, num_updates=24650, lr=3.23513e-06, gnorm=3.678, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45358
2022-05-08 09:02:14 - progress_bar.py[line:272] - INFO: epoch 002:   6985 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.965, expert1_balance_bottom=18.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.7, ups=0.58, wpb=383.8, bsz=32, num_updates=24660, lr=3.23212e-06, gnorm=3.297, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45375
2022-05-08 09:02:31 - progress_bar.py[line:272] - INFO: epoch 002:   6995 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.99, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881131, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.687, expert1_balance_bottom=19.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=226.7, ups=0.59, wpb=385.2, bsz=32, num_updates=24670, lr=3.22912e-06, gnorm=3.45, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45392
2022-05-08 09:02:48 - progress_bar.py[line:272] - INFO: epoch 002:   7005 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.993, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879301, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=35.36, expert1_balance_bottom=18.633, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.8, ups=0.59, wpb=380.4, bsz=32, num_updates=24680, lr=3.22612e-06, gnorm=3.973, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45409
2022-05-08 09:03:05 - progress_bar.py[line:272] - INFO: epoch 002:   7015 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=371.6, nsentences=32, sample_size=295.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.595, expert1_balance_bottom=18.859, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.5, ups=0.59, wpb=371.6, bsz=32, num_updates=24690, lr=3.22311e-06, gnorm=3.295, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45426
2022-05-08 09:03:22 - progress_bar.py[line:272] - INFO: epoch 002:   7025 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=375.6, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.069, expert1_balance_bottom=18.765, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219.5, ups=0.58, wpb=375.6, bsz=32, num_updates=24700, lr=3.22011e-06, gnorm=3.549, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45443
2022-05-08 09:03:39 - progress_bar.py[line:272] - INFO: epoch 002:   7035 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891927, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=34.54, expert1_balance_bottom=18.921, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=221.7, ups=0.59, wpb=378.5, bsz=32, num_updates=24710, lr=3.21711e-06, gnorm=3.865, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=45460
2022-05-08 09:03:56 - progress_bar.py[line:272] - INFO: epoch 002:   7045 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=381.3, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88941, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.726, expert1_balance_bottom=18.834, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=226.2, ups=0.59, wpb=381.3, bsz=32, num_updates=24720, lr=3.2141e-06, gnorm=3.43, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45477
2022-05-08 09:04:13 - progress_bar.py[line:272] - INFO: epoch 002:   7055 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=378.3, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.662, expert1_balance_bottom=18.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.4, ups=0.59, wpb=378.3, bsz=32, num_updates=24730, lr=3.2111e-06, gnorm=3.8, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45494
2022-05-08 09:04:30 - progress_bar.py[line:272] - INFO: epoch 002:   7065 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=389.8, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872031, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=35.538, expert1_balance_bottom=18.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=229.2, ups=0.59, wpb=389.8, bsz=32, num_updates=24740, lr=3.2081e-06, gnorm=3.731, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45511
2022-05-08 09:04:47 - progress_bar.py[line:272] - INFO: epoch 002:   7075 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.291, expert1_balance_bottom=18.867, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=226, ups=0.59, wpb=383.4, bsz=32, num_updates=24750, lr=3.20509e-06, gnorm=3.136, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45528
2022-05-08 09:05:04 - progress_bar.py[line:272] - INFO: epoch 002:   7085 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=381.2, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.344, expert1_balance_bottom=18.964, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=224.5, ups=0.59, wpb=381.2, bsz=32, num_updates=24760, lr=3.20209e-06, gnorm=3.221, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45545
2022-05-08 09:05:21 - progress_bar.py[line:272] - INFO: epoch 002:   7095 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=391.2, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89484, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=33.811, expert1_balance_bottom=19.155, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=232.4, ups=0.59, wpb=391.2, bsz=32, num_updates=24770, lr=3.19909e-06, gnorm=3.765, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45562
2022-05-08 09:05:26 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 09:05:39 - progress_bar.py[line:272] - INFO: epoch 002:   7106 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=391.4, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875403, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.12, expert1_balance_bottom=18.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.4, ups=0.54, wpb=391.4, bsz=32, num_updates=24780, lr=3.19608e-06, gnorm=3.694, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45580
2022-05-08 09:05:56 - progress_bar.py[line:272] - INFO: epoch 002:   7116 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=392.6, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88324, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.471, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=232.7, ups=0.59, wpb=392.6, bsz=32, num_updates=24790, lr=3.19308e-06, gnorm=2.974, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45597
2022-05-08 09:06:13 - progress_bar.py[line:272] - INFO: epoch 002:   7126 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=393.5, nsentences=32, sample_size=312.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887772, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.005, expert1_balance_bottom=19.102, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=232.1, ups=0.59, wpb=393.5, bsz=32, num_updates=24800, lr=3.19008e-06, gnorm=3.579, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45614
2022-05-08 09:06:30 - progress_bar.py[line:272] - INFO: epoch 002:   7136 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=389.3, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.772, expert1_balance_bottom=18.882, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=229, ups=0.59, wpb=389.3, bsz=32, num_updates=24810, lr=3.18707e-06, gnorm=3.189, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45631
2022-05-08 09:06:47 - progress_bar.py[line:272] - INFO: epoch 002:   7146 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=375.9, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.015, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226, ups=0.6, wpb=375.9, bsz=32, num_updates=24820, lr=3.18407e-06, gnorm=3.279, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45648
2022-05-08 09:07:04 - progress_bar.py[line:272] - INFO: epoch 002:   7156 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.979, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.028, expert1_balance_bottom=18.75, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=229.1, ups=0.6, wpb=382.8, bsz=32, num_updates=24830, lr=3.18107e-06, gnorm=3.644, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45664
2022-05-08 09:07:21 - progress_bar.py[line:272] - INFO: epoch 002:   7166 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=386.6, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.03, expert1_balance_bottom=18.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=225.9, ups=0.58, wpb=386.6, bsz=32, num_updates=24840, lr=3.17806e-06, gnorm=3.83, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45682
2022-05-08 09:07:38 - progress_bar.py[line:272] - INFO: epoch 002:   7176 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885421, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.385, expert1_balance_bottom=19.084, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=225, ups=0.59, wpb=380.7, bsz=32, num_updates=24850, lr=3.17506e-06, gnorm=2.867, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45698
2022-05-08 09:07:54 - progress_bar.py[line:272] - INFO: epoch 002:   7186 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.735, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=226.1, ups=0.59, wpb=380.2, bsz=32, num_updates=24860, lr=3.17206e-06, gnorm=3.945, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45715
2022-05-08 09:08:11 - progress_bar.py[line:272] - INFO: epoch 002:   7196 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877789, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.438, expert1_balance_bottom=18.654, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=225.1, ups=0.59, wpb=381.2, bsz=32, num_updates=24870, lr=3.16905e-06, gnorm=3.664, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45732
2022-05-08 09:08:28 - progress_bar.py[line:272] - INFO: epoch 002:   7206 / 17711 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=378.3, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.191, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.633, expert1_balance_bottom=18.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=222.2, ups=0.59, wpb=378.3, bsz=32, num_updates=24880, lr=3.16605e-06, gnorm=4.08, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45749
2022-05-08 09:08:46 - progress_bar.py[line:272] - INFO: epoch 002:   7216 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=381.6, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88523, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.665, expert1_balance_bottom=18.833, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.4, ups=0.58, wpb=381.6, bsz=32, num_updates=24890, lr=3.16305e-06, gnorm=3.802, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45766
2022-05-08 09:09:03 - progress_bar.py[line:272] - INFO: epoch 002:   7226 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=386.7, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882112, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=35.128, expert1_balance_bottom=18.698, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=223.5, ups=0.58, wpb=386.7, bsz=32, num_updates=24900, lr=3.16004e-06, gnorm=3.109, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45784
2022-05-08 09:09:20 - progress_bar.py[line:272] - INFO: epoch 002:   7236 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=377.2, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.257, expert1_balance_bottom=18.863, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=224.5, ups=0.6, wpb=377.2, bsz=32, num_updates=24910, lr=3.15704e-06, gnorm=3.942, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45801
2022-05-08 09:09:37 - progress_bar.py[line:272] - INFO: epoch 002:   7246 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=384.8, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.933, expert1_balance_bottom=18.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.6, ups=0.59, wpb=384.8, bsz=32, num_updates=24920, lr=3.15404e-06, gnorm=3.737, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45817
2022-05-08 09:09:54 - progress_bar.py[line:272] - INFO: epoch 002:   7256 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=381.4, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880328, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.991, expert1_balance_bottom=18.853, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=225.2, ups=0.59, wpb=381.4, bsz=32, num_updates=24930, lr=3.15103e-06, gnorm=3.759, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45834
2022-05-08 09:10:11 - progress_bar.py[line:272] - INFO: epoch 002:   7266 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=376.8, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=33.614, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=218.5, ups=0.58, wpb=376.8, bsz=32, num_updates=24940, lr=3.14803e-06, gnorm=3.304, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45852
2022-05-08 09:10:28 - progress_bar.py[line:272] - INFO: epoch 002:   7276 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=372, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=33.842, expert1_balance_bottom=19.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=219.5, ups=0.59, wpb=372, bsz=32, num_updates=24950, lr=3.14503e-06, gnorm=3.361, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45869
2022-05-08 09:10:44 - progress_bar.py[line:272] - INFO: epoch 002:   7286 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876492, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=35.046, expert1_balance_bottom=18.756, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=230.6, ups=0.6, wpb=385.5, bsz=32, num_updates=24960, lr=3.14202e-06, gnorm=3.328, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45885
2022-05-08 09:11:01 - progress_bar.py[line:272] - INFO: epoch 002:   7296 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=376.4, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882936, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.811, expert1_balance_bottom=18.709, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=221.6, ups=0.59, wpb=376.4, bsz=32, num_updates=24970, lr=3.13902e-06, gnorm=3.338, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45902
2022-05-08 09:11:18 - progress_bar.py[line:272] - INFO: epoch 002:   7306 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=379, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.507, expert1_balance_bottom=18.894, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.7, ups=0.6, wpb=379, bsz=32, num_updates=24980, lr=3.13602e-06, gnorm=3.308, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45919
2022-05-08 09:11:35 - progress_bar.py[line:272] - INFO: epoch 002:   7316 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=380, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.936, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.7, ups=0.59, wpb=380, bsz=32, num_updates=24990, lr=3.13301e-06, gnorm=3.16, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=45936
2022-05-08 09:11:52 - progress_bar.py[line:272] - INFO: epoch 002:   7326 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=376.2, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888568, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.652, expert1_balance_bottom=18.956, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.8, ups=0.59, wpb=376.2, bsz=32, num_updates=25000, lr=3.13001e-06, gnorm=2.982, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=45953
2022-05-08 09:11:52 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 09:11:52 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 09:11:52 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 09:18:48 - train.py[line:517] - INFO: valid_step finished
2022-05-08 09:18:48 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 9.481 | loss_v1 0 | loss_v2 0 | nll_loss 7.782 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.969904 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.481 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.27 | expert1_balance_top 36.076 | expert1_balance_bottom 14.823 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 220.08 | cider 1.185 | wps 724.5 | wpb 481.7 | bsz 8 | num_updates 25000 | best_cider 1.185
2022-05-08 09:18:48 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 25000 updates
2022-05-08 09:18:48 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_25000-rank-0.pt
2022-05-08 09:18:48 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_25000-rank-0.pt
2022-05-08 09:18:56 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_25000-rank-0.pt
2022-05-08 09:18:56 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_25000-shared.pt
2022-05-08 09:19:04 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_25000-shared.pt
2022-05-08 09:19:36 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_25000-rank-0.pt (epoch 2 @ 25000 updates, score 1.185) (writing took 47.884955004788935 seconds)
2022-05-08 09:19:53 - progress_bar.py[line:272] - INFO: epoch 002:   7336 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878738, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.778, expert1_balance_bottom=19.013, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=7.9, ups=0.02, wpb=382.3, bsz=32, num_updates=25010, lr=3.12701e-06, gnorm=3.463, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=46434
2022-05-08 09:20:10 - progress_bar.py[line:272] - INFO: epoch 002:   7346 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=35.066, expert1_balance_bottom=18.768, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=227.4, ups=0.6, wpb=380.4, bsz=32, num_updates=25020, lr=3.12401e-06, gnorm=3.145, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46451
2022-05-08 09:20:27 - progress_bar.py[line:272] - INFO: epoch 002:   7356 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=379.1, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.426, expert1_balance_bottom=18.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.6, ups=0.59, wpb=379.1, bsz=32, num_updates=25030, lr=3.121e-06, gnorm=3.25, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46468
2022-05-08 09:20:44 - progress_bar.py[line:272] - INFO: epoch 002:   7366 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=378.3, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885325, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.76, expert1_balance_bottom=18.71, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=225.6, ups=0.6, wpb=378.3, bsz=32, num_updates=25040, lr=3.118e-06, gnorm=3.29, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46485
2022-05-08 09:21:01 - progress_bar.py[line:272] - INFO: epoch 002:   7376 / 17711 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.997, ntokens=387.7, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885261, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.393, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=221.7, ups=0.57, wpb=387.7, bsz=32, num_updates=25050, lr=3.115e-06, gnorm=3.315, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46502
2022-05-08 09:21:18 - progress_bar.py[line:272] - INFO: epoch 002:   7386 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=381.9, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893107, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.099, expert1_balance_bottom=19.039, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223.8, ups=0.59, wpb=381.9, bsz=32, num_updates=25060, lr=3.11199e-06, gnorm=2.95, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46519
2022-05-08 09:21:35 - progress_bar.py[line:272] - INFO: epoch 002:   7396 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880118, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.797, expert1_balance_bottom=18.749, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=229.8, ups=0.61, wpb=379.5, bsz=32, num_updates=25070, lr=3.10899e-06, gnorm=3.35, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46536
2022-05-08 09:21:52 - progress_bar.py[line:272] - INFO: epoch 002:   7406 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=375.3, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877179, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.995, expert1_balance_bottom=18.705, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=220.9, ups=0.59, wpb=375.3, bsz=32, num_updates=25080, lr=3.10599e-06, gnorm=3.556, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46553
2022-05-08 09:22:09 - progress_bar.py[line:272] - INFO: epoch 002:   7416 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877871, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.993, expert1_balance_bottom=18.624, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=225, ups=0.59, wpb=381.6, bsz=32, num_updates=25090, lr=3.10298e-06, gnorm=3.952, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46570
2022-05-08 09:22:25 - progress_bar.py[line:272] - INFO: epoch 002:   7426 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=388.2, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.977, expert1_balance_bottom=18.767, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=233.4, ups=0.6, wpb=388.2, bsz=32, num_updates=25100, lr=3.09998e-06, gnorm=3.059, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46586
2022-05-08 09:22:42 - progress_bar.py[line:272] - INFO: epoch 002:   7436 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896013, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.211, expert1_balance_bottom=19.03, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.6, ups=0.59, wpb=377.5, bsz=32, num_updates=25110, lr=3.09698e-06, gnorm=3.641, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46603
2022-05-08 09:22:59 - progress_bar.py[line:272] - INFO: epoch 002:   7446 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=378, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.23, expert1_balance_top=34.093, expert1_balance_bottom=19.068, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.2, ups=0.59, wpb=378, bsz=32, num_updates=25120, lr=3.09397e-06, gnorm=3.433, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46620
2022-05-08 09:23:16 - progress_bar.py[line:272] - INFO: epoch 002:   7456 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=384.5, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=35.046, expert1_balance_bottom=18.781, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=226.2, ups=0.59, wpb=384.5, bsz=32, num_updates=25130, lr=3.09097e-06, gnorm=3.147, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=46637
2022-05-08 09:23:33 - progress_bar.py[line:272] - INFO: epoch 002:   7466 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=390.5, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875856, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=35.3, expert1_balance_bottom=18.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=232.9, ups=0.6, wpb=390.5, bsz=32, num_updates=25140, lr=3.08797e-06, gnorm=2.892, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46654
2022-05-08 09:23:49 - progress_bar.py[line:272] - INFO: epoch 002:   7476 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=374.5, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.677, expert1_balance_bottom=19.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=225.8, ups=0.6, wpb=374.5, bsz=32, num_updates=25150, lr=3.08496e-06, gnorm=2.99, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46670
2022-05-08 09:24:06 - progress_bar.py[line:272] - INFO: epoch 002:   7486 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=385.1, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.785, expert1_balance_bottom=19.056, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=229.6, ups=0.6, wpb=385.1, bsz=32, num_updates=25160, lr=3.08196e-06, gnorm=3.093, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46687
2022-05-08 09:24:23 - progress_bar.py[line:272] - INFO: epoch 002:   7496 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877031, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=35.13, expert1_balance_bottom=18.815, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=226.2, ups=0.6, wpb=379.6, bsz=32, num_updates=25170, lr=3.07896e-06, gnorm=3.428, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46704
2022-05-08 09:24:40 - progress_bar.py[line:272] - INFO: epoch 002:   7506 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879624, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.657, expert1_balance_bottom=18.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=227.4, ups=0.59, wpb=384.2, bsz=32, num_updates=25180, lr=3.07595e-06, gnorm=2.995, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46721
2022-05-08 09:24:57 - progress_bar.py[line:272] - INFO: epoch 002:   7516 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=374.2, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.387, expert1_balance_bottom=18.99, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.4, ups=0.59, wpb=374.2, bsz=32, num_updates=25190, lr=3.07295e-06, gnorm=3.315, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=46738
2022-05-08 09:25:14 - progress_bar.py[line:272] - INFO: epoch 002:   7526 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=375.5, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889408, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.477, expert1_balance_bottom=18.892, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=217.8, ups=0.58, wpb=375.5, bsz=32, num_updates=25200, lr=3.06995e-06, gnorm=3.947, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46755
2022-05-08 09:25:32 - progress_bar.py[line:272] - INFO: epoch 002:   7536 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.118, expert1_balance_bottom=19.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216.5, ups=0.57, wpb=379.3, bsz=32, num_updates=25210, lr=3.06694e-06, gnorm=3.069, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46772
2022-05-08 09:25:49 - progress_bar.py[line:272] - INFO: epoch 002:   7546 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=380, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.742, expert1_balance_bottom=19.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.1, ups=0.58, wpb=380, bsz=32, num_updates=25220, lr=3.06394e-06, gnorm=3.397, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46789
2022-05-08 09:26:06 - progress_bar.py[line:272] - INFO: epoch 002:   7556 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887022, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.624, expert1_balance_bottom=18.888, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=223.5, ups=0.59, wpb=381.7, bsz=32, num_updates=25230, lr=3.06094e-06, gnorm=3.493, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46807
2022-05-08 09:26:23 - progress_bar.py[line:272] - INFO: epoch 002:   7566 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.36, expert1_balance_bottom=18.882, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.3, ups=0.58, wpb=383.8, bsz=32, num_updates=25240, lr=3.05793e-06, gnorm=3.382, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46824
2022-05-08 09:26:40 - progress_bar.py[line:272] - INFO: epoch 002:   7576 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873544, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=35.261, expert1_balance_bottom=18.804, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.5, ups=0.59, wpb=378, bsz=32, num_updates=25250, lr=3.05493e-06, gnorm=3.11, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=46841
2022-05-08 09:26:57 - progress_bar.py[line:272] - INFO: epoch 002:   7586 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=378.9, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.139, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=222.5, ups=0.59, wpb=378.9, bsz=32, num_updates=25260, lr=3.05193e-06, gnorm=3.68, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46858
2022-05-08 09:27:14 - progress_bar.py[line:272] - INFO: epoch 002:   7596 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=377.9, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88378, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.859, expert1_balance_bottom=18.772, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225, ups=0.6, wpb=377.9, bsz=32, num_updates=25270, lr=3.04892e-06, gnorm=3.393, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46875
2022-05-08 09:27:31 - progress_bar.py[line:272] - INFO: epoch 002:   7606 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=375.4, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=35.348, expert1_balance_bottom=18.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=219.8, ups=0.59, wpb=375.4, bsz=32, num_updates=25280, lr=3.04592e-06, gnorm=3.211, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46892
2022-05-08 09:27:48 - progress_bar.py[line:272] - INFO: epoch 002:   7616 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=386, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=35.037, expert1_balance_bottom=18.926, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=227.3, ups=0.59, wpb=386, bsz=32, num_updates=25290, lr=3.04292e-06, gnorm=3.518, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46909
2022-05-08 09:28:05 - progress_bar.py[line:272] - INFO: epoch 002:   7626 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=377.6, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.367, expert1_balance_bottom=18.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.2, ups=0.59, wpb=377.6, bsz=32, num_updates=25300, lr=3.03991e-06, gnorm=3.627, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46926
2022-05-08 09:28:22 - progress_bar.py[line:272] - INFO: epoch 002:   7636 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=386, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.715, expert1_balance_bottom=18.814, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=230.1, ups=0.6, wpb=386, bsz=32, num_updates=25310, lr=3.03691e-06, gnorm=3.984, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46942
2022-05-08 09:28:39 - progress_bar.py[line:272] - INFO: epoch 002:   7646 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=388.4, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.955, expert1_balance_bottom=18.743, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=227.3, ups=0.59, wpb=388.4, bsz=32, num_updates=25320, lr=3.03391e-06, gnorm=3.25, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=46959
2022-05-08 09:28:56 - progress_bar.py[line:272] - INFO: epoch 002:   7656 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894644, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=34.23, expert1_balance_bottom=18.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.5, ups=0.59, wpb=377.9, bsz=32, num_updates=25330, lr=3.0309e-06, gnorm=3.029, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46977
2022-05-08 09:29:13 - progress_bar.py[line:272] - INFO: epoch 002:   7666 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=379.4, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8794, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=35.051, expert1_balance_bottom=18.799, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=218.4, ups=0.58, wpb=379.4, bsz=32, num_updates=25340, lr=3.0279e-06, gnorm=3.196, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=46994
2022-05-08 09:29:30 - progress_bar.py[line:272] - INFO: epoch 002:   7676 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.229, expert1_balance_bottom=19.064, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=225.9, ups=0.59, wpb=384.9, bsz=32, num_updates=25350, lr=3.0249e-06, gnorm=2.963, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47011
2022-05-08 09:29:47 - progress_bar.py[line:272] - INFO: epoch 002:   7686 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88024, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=35.083, expert1_balance_bottom=18.847, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=225.5, ups=0.59, wpb=382.4, bsz=32, num_updates=25360, lr=3.02189e-06, gnorm=3.252, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=47028
2022-05-08 09:30:04 - progress_bar.py[line:272] - INFO: epoch 002:   7696 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=373.7, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883909, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.767, expert1_balance_bottom=18.995, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.3, ups=0.59, wpb=373.7, bsz=32, num_updates=25370, lr=3.01889e-06, gnorm=3.486, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47045
2022-05-08 09:30:21 - progress_bar.py[line:272] - INFO: epoch 002:   7706 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=35.469, expert1_balance_bottom=18.75, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=229.2, ups=0.6, wpb=383.3, bsz=32, num_updates=25380, lr=3.01589e-06, gnorm=3.399, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47062
2022-05-08 09:30:37 - progress_bar.py[line:272] - INFO: epoch 002:   7716 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884196, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.774, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=227.3, ups=0.6, wpb=378.5, bsz=32, num_updates=25390, lr=3.01288e-06, gnorm=3.148, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=47078
2022-05-08 09:30:54 - progress_bar.py[line:272] - INFO: epoch 002:   7726 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=375.8, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.713, expert1_balance_bottom=18.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=223.6, ups=0.59, wpb=375.8, bsz=32, num_updates=25400, lr=3.00988e-06, gnorm=3.755, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47095
2022-05-08 09:31:12 - progress_bar.py[line:272] - INFO: epoch 002:   7736 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=389.4, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883562, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.621, expert1_balance_bottom=19.064, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=225.2, ups=0.58, wpb=389.4, bsz=32, num_updates=25410, lr=3.00688e-06, gnorm=3.377, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=47112
2022-05-08 09:31:28 - progress_bar.py[line:272] - INFO: epoch 002:   7746 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889064, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.712, expert1_balance_bottom=18.841, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=224.9, ups=0.59, wpb=378.7, bsz=32, num_updates=25420, lr=3.00387e-06, gnorm=3.01, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47129
2022-05-08 09:31:45 - progress_bar.py[line:272] - INFO: epoch 002:   7756 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=388.9, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=35.623, expert1_balance_bottom=18.647, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.3, ups=0.59, wpb=388.9, bsz=32, num_updates=25430, lr=3.00087e-06, gnorm=3.133, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47146
2022-05-08 09:32:02 - progress_bar.py[line:272] - INFO: epoch 002:   7766 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=376.9, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887062, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.246, expert1_balance_bottom=19.126, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=224.7, ups=0.6, wpb=376.9, bsz=32, num_updates=25440, lr=2.99787e-06, gnorm=2.937, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47163
2022-05-08 09:32:19 - progress_bar.py[line:272] - INFO: epoch 002:   7776 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=383.8, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.334, expert1_balance_bottom=18.925, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=229.6, ups=0.6, wpb=383.8, bsz=32, num_updates=25450, lr=2.99486e-06, gnorm=3.526, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47180
2022-05-08 09:32:36 - progress_bar.py[line:272] - INFO: epoch 002:   7786 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=383.8, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.964, expert1_balance_bottom=18.922, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=228.7, ups=0.6, wpb=383.8, bsz=32, num_updates=25460, lr=2.99186e-06, gnorm=3.073, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47196
2022-05-08 09:32:52 - progress_bar.py[line:272] - INFO: epoch 002:   7796 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892388, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.19, expert1_balance_bottom=19.073, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=232, ups=0.61, wpb=382.4, bsz=32, num_updates=25470, lr=2.98886e-06, gnorm=3.236, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47213
2022-05-08 09:33:09 - progress_bar.py[line:272] - INFO: epoch 002:   7806 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=382.9, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.347, expert1_balance_bottom=18.918, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=225, ups=0.59, wpb=382.9, bsz=32, num_updates=25480, lr=2.98585e-06, gnorm=3.381, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47230
2022-05-08 09:33:26 - progress_bar.py[line:272] - INFO: epoch 002:   7816 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=400.4, nsentences=32, sample_size=319.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=35.202, expert1_balance_bottom=18.729, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=232.4, ups=0.58, wpb=400.4, bsz=32, num_updates=25490, lr=2.98285e-06, gnorm=3.33, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47247
2022-05-08 09:33:43 - progress_bar.py[line:272] - INFO: epoch 002:   7826 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=391.8, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885268, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.988, expert1_balance_bottom=18.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=230.8, ups=0.59, wpb=391.8, bsz=32, num_updates=25500, lr=2.97985e-06, gnorm=3.585, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47264
2022-05-08 09:34:00 - progress_bar.py[line:272] - INFO: epoch 002:   7836 / 17711 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.204, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=35.353, expert1_balance_bottom=18.677, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=227.8, ups=0.59, wpb=384.3, bsz=32, num_updates=25510, lr=2.97684e-06, gnorm=3.728, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47281
2022-05-08 09:34:17 - progress_bar.py[line:272] - INFO: epoch 002:   7846 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=387.9, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873764, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=35.632, expert1_balance_bottom=18.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=228.9, ups=0.59, wpb=387.9, bsz=32, num_updates=25520, lr=2.97384e-06, gnorm=3.131, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47298
2022-05-08 09:34:34 - progress_bar.py[line:272] - INFO: epoch 002:   7856 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=387.8, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875186, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.973, expert1_balance_bottom=18.963, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=229.8, ups=0.59, wpb=387.8, bsz=32, num_updates=25530, lr=2.97084e-06, gnorm=3.197, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47315
2022-05-08 09:34:51 - progress_bar.py[line:272] - INFO: epoch 002:   7866 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=390.2, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876177, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=35.305, expert1_balance_bottom=18.792, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=230.5, ups=0.59, wpb=390.2, bsz=32, num_updates=25540, lr=2.96783e-06, gnorm=3.715, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47332
2022-05-08 09:35:08 - progress_bar.py[line:272] - INFO: epoch 002:   7876 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=376.3, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.944, expert1_balance_bottom=18.75, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.1, ups=0.58, wpb=376.3, bsz=32, num_updates=25550, lr=2.96483e-06, gnorm=3.244, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47349
2022-05-08 09:35:25 - progress_bar.py[line:272] - INFO: epoch 002:   7886 / 17711 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=376, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.196, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.639, expert1_balance_bottom=18.976, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=220.7, ups=0.59, wpb=376, bsz=32, num_updates=25560, lr=2.96183e-06, gnorm=3.563, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47366
2022-05-08 09:35:42 - progress_bar.py[line:272] - INFO: epoch 002:   7896 / 17711 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=379.6, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.192, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.397, expert1_balance_bottom=18.877, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=224.8, ups=0.59, wpb=379.6, bsz=32, num_updates=25570, lr=2.95883e-06, gnorm=3.888, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47383
2022-05-08 09:35:59 - progress_bar.py[line:272] - INFO: epoch 002:   7906 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888673, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.208, expert1_balance_bottom=19.057, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226.9, ups=0.59, wpb=383.5, bsz=32, num_updates=25580, lr=2.95582e-06, gnorm=3.128, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47400
2022-05-08 09:36:16 - progress_bar.py[line:272] - INFO: epoch 002:   7916 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=387.9, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902359, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=33.187, expert1_balance_bottom=19.162, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=227, ups=0.59, wpb=387.9, bsz=32, num_updates=25590, lr=2.95282e-06, gnorm=3.252, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47417
2022-05-08 09:36:33 - progress_bar.py[line:272] - INFO: epoch 002:   7926 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=393.4, nsentences=32, sample_size=313.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873554, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.96, expert1_balance_bottom=18.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=231.6, ups=0.59, wpb=393.4, bsz=32, num_updates=25600, lr=2.94982e-06, gnorm=3.503, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47434
2022-05-08 09:36:50 - progress_bar.py[line:272] - INFO: epoch 002:   7936 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=375.9, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895422, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=34.033, expert1_balance_bottom=19.122, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.9, ups=0.6, wpb=375.9, bsz=32, num_updates=25610, lr=2.94681e-06, gnorm=3.361, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47451
2022-05-08 09:37:07 - progress_bar.py[line:272] - INFO: epoch 002:   7946 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879136, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.702, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=230.5, ups=0.6, wpb=385.7, bsz=32, num_updates=25620, lr=2.94381e-06, gnorm=3.724, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47468
2022-05-08 09:37:24 - progress_bar.py[line:272] - INFO: epoch 002:   7956 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886682, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.406, expert1_balance_bottom=19.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=225.1, ups=0.59, wpb=382.8, bsz=32, num_updates=25630, lr=2.94081e-06, gnorm=3.403, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=47485
2022-05-08 09:37:40 - progress_bar.py[line:272] - INFO: epoch 002:   7966 / 17711 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=377, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874092, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.163, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=35.296, expert1_balance_bottom=18.839, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=230.2, ups=0.61, wpb=377, bsz=32, num_updates=25640, lr=2.9378e-06, gnorm=3.449, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47501
2022-05-08 09:37:57 - progress_bar.py[line:272] - INFO: epoch 002:   7976 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=388.1, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877991, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=35.085, expert1_balance_bottom=18.825, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=227.8, ups=0.59, wpb=388.1, bsz=32, num_updates=25650, lr=2.9348e-06, gnorm=4.105, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47518
2022-05-08 09:38:14 - progress_bar.py[line:272] - INFO: epoch 002:   7986 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=386.7, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.985, expert1_balance_bottom=18.77, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=230.4, ups=0.6, wpb=386.7, bsz=32, num_updates=25660, lr=2.9318e-06, gnorm=3.29, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47535
2022-05-08 09:38:31 - progress_bar.py[line:272] - INFO: epoch 002:   7996 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=391.8, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.493, expert1_balance_bottom=18.858, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=227.9, ups=0.58, wpb=391.8, bsz=32, num_updates=25670, lr=2.92879e-06, gnorm=3.361, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47552
2022-05-08 09:38:48 - progress_bar.py[line:272] - INFO: epoch 002:   8006 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=35.358, expert1_balance_bottom=18.625, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=227.8, ups=0.59, wpb=383.5, bsz=32, num_updates=25680, lr=2.92579e-06, gnorm=3.699, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47569
2022-05-08 09:39:05 - progress_bar.py[line:272] - INFO: epoch 002:   8016 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=384.8, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.962, expert1_balance_bottom=18.774, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.5, ups=0.57, wpb=384.8, bsz=32, num_updates=25690, lr=2.92279e-06, gnorm=3.152, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47586
2022-05-08 09:39:22 - progress_bar.py[line:272] - INFO: epoch 002:   8026 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.714, expert1_balance_bottom=18.846, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.4, ups=0.59, wpb=379.7, bsz=32, num_updates=25700, lr=2.91978e-06, gnorm=3.548, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47603
2022-05-08 09:39:39 - progress_bar.py[line:272] - INFO: epoch 002:   8036 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=378.7, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.474, expert1_balance_bottom=18.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.2, ups=0.59, wpb=378.7, bsz=32, num_updates=25710, lr=2.91678e-06, gnorm=4.01, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47620
2022-05-08 09:39:56 - progress_bar.py[line:272] - INFO: epoch 002:   8046 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=392.5, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875071, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=35.083, expert1_balance_bottom=18.822, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=231.5, ups=0.59, wpb=392.5, bsz=32, num_updates=25720, lr=2.91378e-06, gnorm=3.438, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47637
2022-05-08 09:40:13 - progress_bar.py[line:272] - INFO: epoch 002:   8056 / 17711 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=1.005, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881528, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.211, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.676, expert1_balance_bottom=18.748, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=224.5, ups=0.59, wpb=380, bsz=32, num_updates=25730, lr=2.91077e-06, gnorm=3.205, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47654
2022-05-08 09:40:30 - progress_bar.py[line:272] - INFO: epoch 002:   8066 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=396.7, nsentences=32, sample_size=315.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.83, expert1_balance_bottom=18.929, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=230.6, ups=0.58, wpb=396.7, bsz=32, num_updates=25740, lr=2.90777e-06, gnorm=3.388, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47671
2022-05-08 09:40:48 - progress_bar.py[line:272] - INFO: epoch 002:   8076 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887526, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.61, expert1_balance_bottom=19.013, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.3, ups=0.59, wpb=381.7, bsz=32, num_updates=25750, lr=2.90477e-06, gnorm=3.12, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47688
2022-05-08 09:41:05 - progress_bar.py[line:272] - INFO: epoch 002:   8086 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=378.9, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=35.075, expert1_balance_bottom=18.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=223, ups=0.59, wpb=378.9, bsz=32, num_updates=25760, lr=2.90176e-06, gnorm=3.477, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47705
2022-05-08 09:41:21 - progress_bar.py[line:272] - INFO: epoch 002:   8096 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=377.9, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.912, expert1_balance_bottom=18.927, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=225.2, ups=0.6, wpb=377.9, bsz=32, num_updates=25770, lr=2.89876e-06, gnorm=3.572, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47722
2022-05-08 09:41:38 - progress_bar.py[line:272] - INFO: epoch 002:   8106 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=388.3, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.235, expert1_balance_bottom=19.078, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=234.6, ups=0.6, wpb=388.3, bsz=32, num_updates=25780, lr=2.89576e-06, gnorm=3.393, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=47739
2022-05-08 09:41:55 - progress_bar.py[line:272] - INFO: epoch 002:   8116 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=34.153, expert1_balance_bottom=18.934, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219.6, ups=0.58, wpb=377.9, bsz=32, num_updates=25790, lr=2.89275e-06, gnorm=3.245, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47756
2022-05-08 09:42:13 - progress_bar.py[line:272] - INFO: epoch 002:   8126 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=381.9, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.793, expert1_balance_bottom=18.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219.2, ups=0.57, wpb=381.9, bsz=32, num_updates=25800, lr=2.88975e-06, gnorm=3.169, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47773
2022-05-08 09:42:30 - progress_bar.py[line:272] - INFO: epoch 002:   8136 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=385, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880077, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.681, expert1_balance_bottom=18.878, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.9, ups=0.58, wpb=385, bsz=32, num_updates=25810, lr=2.88675e-06, gnorm=2.983, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47790
2022-05-08 09:42:47 - progress_bar.py[line:272] - INFO: epoch 002:   8146 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=387.7, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.537, expert1_balance_bottom=18.907, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=229, ups=0.59, wpb=387.7, bsz=32, num_updates=25820, lr=2.88374e-06, gnorm=3.133, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47807
2022-05-08 09:43:04 - progress_bar.py[line:272] - INFO: epoch 002:   8156 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=373.3, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.05, expert1_balance_bottom=19.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.7, ups=0.59, wpb=373.3, bsz=32, num_updates=25830, lr=2.88074e-06, gnorm=3.271, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47824
2022-05-08 09:43:21 - progress_bar.py[line:272] - INFO: epoch 002:   8166 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=382.2, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=33.829, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.7, ups=0.59, wpb=382.2, bsz=32, num_updates=25840, lr=2.87774e-06, gnorm=3.247, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47841
2022-05-08 09:43:38 - progress_bar.py[line:272] - INFO: epoch 002:   8176 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=35.035, expert1_balance_bottom=18.843, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=227, ups=0.59, wpb=383, bsz=32, num_updates=25850, lr=2.87473e-06, gnorm=3.337, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47858
2022-05-08 09:43:54 - progress_bar.py[line:272] - INFO: epoch 002:   8186 / 17711 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.992, ntokens=378.6, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888611, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.206, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.271, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=231.2, ups=0.61, wpb=378.6, bsz=32, num_updates=25860, lr=2.87173e-06, gnorm=3.633, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47875
2022-05-08 09:44:11 - progress_bar.py[line:272] - INFO: epoch 002:   8196 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=374.2, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.229, expert1_balance_top=33.667, expert1_balance_bottom=19.031, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.7, ups=0.59, wpb=374.2, bsz=32, num_updates=25870, lr=2.86873e-06, gnorm=3.244, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=47892
2022-05-08 09:44:28 - progress_bar.py[line:272] - INFO: epoch 002:   8206 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.974, ntokens=383.1, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.259, expert1_balance_bottom=19.02, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=225, ups=0.59, wpb=383.1, bsz=32, num_updates=25880, lr=2.86572e-06, gnorm=3.259, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47909
2022-05-08 09:44:45 - progress_bar.py[line:272] - INFO: epoch 002:   8216 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882992, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.895, expert1_balance_bottom=18.793, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=223, ups=0.58, wpb=384.9, bsz=32, num_updates=25890, lr=2.86272e-06, gnorm=3.317, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47926
2022-05-08 09:45:02 - progress_bar.py[line:272] - INFO: epoch 002:   8226 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890342, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.244, expert1_balance_bottom=19.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=221.9, ups=0.58, wpb=379.6, bsz=32, num_updates=25900, lr=2.85972e-06, gnorm=3.069, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47943
2022-05-08 09:45:19 - progress_bar.py[line:272] - INFO: epoch 002:   8236 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=390.5, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.49, expert1_balance_bottom=19.039, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=227.6, ups=0.58, wpb=390.5, bsz=32, num_updates=25910, lr=2.85671e-06, gnorm=3.633, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47960
2022-05-08 09:45:36 - progress_bar.py[line:272] - INFO: epoch 002:   8246 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=379.5, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884888, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.762, expert1_balance_bottom=18.631, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222, ups=0.58, wpb=379.5, bsz=32, num_updates=25920, lr=2.85371e-06, gnorm=3.464, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47977
2022-05-08 09:45:54 - progress_bar.py[line:272] - INFO: epoch 002:   8256 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.653, expert1_balance_bottom=18.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223.8, ups=0.58, wpb=386.5, bsz=32, num_updates=25930, lr=2.85071e-06, gnorm=3.128, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=47994
2022-05-08 09:46:11 - progress_bar.py[line:272] - INFO: epoch 002:   8266 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=382.4, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894214, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=33.974, expert1_balance_bottom=19.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=224.5, ups=0.59, wpb=382.4, bsz=32, num_updates=25940, lr=2.8477e-06, gnorm=3.22, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48011
2022-05-08 09:46:28 - progress_bar.py[line:272] - INFO: epoch 002:   8276 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=388.5, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.607, expert1_balance_bottom=18.818, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.6, ups=0.59, wpb=388.5, bsz=32, num_updates=25950, lr=2.8447e-06, gnorm=3.636, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48029
2022-05-08 09:46:45 - progress_bar.py[line:272] - INFO: epoch 002:   8286 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=385.8, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=35.196, expert1_balance_bottom=18.829, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=227.8, ups=0.59, wpb=385.8, bsz=32, num_updates=25960, lr=2.8417e-06, gnorm=2.75, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48045
2022-05-08 09:47:02 - progress_bar.py[line:272] - INFO: epoch 002:   8296 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=385.2, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.626, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=228.5, ups=0.59, wpb=385.2, bsz=32, num_updates=25970, lr=2.83869e-06, gnorm=3.962, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48062
2022-05-08 09:47:19 - progress_bar.py[line:272] - INFO: epoch 002:   8306 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=377.7, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.471, expert1_balance_bottom=18.907, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.7, ups=0.58, wpb=377.7, bsz=32, num_updates=25980, lr=2.83569e-06, gnorm=3.493, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48080
2022-05-08 09:47:36 - progress_bar.py[line:272] - INFO: epoch 002:   8316 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884075, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.686, expert1_balance_bottom=18.953, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=220.8, ups=0.57, wpb=385.6, bsz=32, num_updates=25990, lr=2.83269e-06, gnorm=3.207, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48097
2022-05-08 09:47:53 - progress_bar.py[line:272] - INFO: epoch 002:   8326 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=384.4, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.795, expert1_balance_bottom=18.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227.7, ups=0.59, wpb=384.4, bsz=32, num_updates=26000, lr=2.82968e-06, gnorm=3.227, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48114
2022-05-08 09:48:10 - progress_bar.py[line:272] - INFO: epoch 002:   8336 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882923, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.455, expert1_balance_bottom=19.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=223.9, ups=0.59, wpb=380.8, bsz=32, num_updates=26010, lr=2.82668e-06, gnorm=3.213, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48131
2022-05-08 09:48:27 - progress_bar.py[line:272] - INFO: epoch 002:   8346 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=381.2, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.278, expert1_balance_bottom=18.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.3, ups=0.59, wpb=381.2, bsz=32, num_updates=26020, lr=2.82368e-06, gnorm=3.285, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=48148
2022-05-08 09:48:44 - progress_bar.py[line:272] - INFO: epoch 002:   8356 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=377.3, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.82, expert1_balance_bottom=18.794, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=223.1, ups=0.59, wpb=377.3, bsz=32, num_updates=26030, lr=2.82067e-06, gnorm=3.277, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48165
2022-05-08 09:49:01 - progress_bar.py[line:272] - INFO: epoch 002:   8366 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=377.6, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.358, expert1_balance_bottom=18.838, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.6, ups=0.59, wpb=377.6, bsz=32, num_updates=26040, lr=2.81767e-06, gnorm=3.578, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48182
2022-05-08 09:49:18 - progress_bar.py[line:272] - INFO: epoch 002:   8376 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=387.6, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888177, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=34.729, expert1_balance_bottom=18.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.3, ups=0.59, wpb=387.6, bsz=32, num_updates=26050, lr=2.81467e-06, gnorm=3.165, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=48199
2022-05-08 09:49:35 - progress_bar.py[line:272] - INFO: epoch 002:   8386 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.679, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.6, ups=0.58, wpb=382.5, bsz=32, num_updates=26060, lr=2.81166e-06, gnorm=3.399, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48216
2022-05-08 09:49:53 - progress_bar.py[line:272] - INFO: epoch 002:   8396 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=380.2, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879457, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=35.149, expert1_balance_bottom=18.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.7, ups=0.58, wpb=380.2, bsz=32, num_updates=26070, lr=2.80866e-06, gnorm=2.838, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48233
2022-05-08 09:50:10 - progress_bar.py[line:272] - INFO: epoch 002:   8406 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.574, expert1_balance_bottom=18.806, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=220.9, ups=0.58, wpb=379.5, bsz=32, num_updates=26080, lr=2.80566e-06, gnorm=3.636, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48250
2022-05-08 09:50:27 - progress_bar.py[line:272] - INFO: epoch 002:   8416 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=390.8, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=35.053, expert1_balance_bottom=18.66, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=230.2, ups=0.59, wpb=390.8, bsz=32, num_updates=26090, lr=2.80265e-06, gnorm=3.8, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48267
2022-05-08 09:50:44 - progress_bar.py[line:272] - INFO: epoch 002:   8426 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=379.8, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882515, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.763, expert1_balance_bottom=18.892, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.9, ups=0.58, wpb=379.8, bsz=32, num_updates=26100, lr=2.79965e-06, gnorm=3.203, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48285
2022-05-08 09:51:01 - progress_bar.py[line:272] - INFO: epoch 002:   8436 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=374.6, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893995, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=33.747, expert1_balance_bottom=19.14, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220.6, ups=0.59, wpb=374.6, bsz=32, num_updates=26110, lr=2.79665e-06, gnorm=3.364, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48302
2022-05-08 09:51:18 - progress_bar.py[line:272] - INFO: epoch 002:   8446 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=381, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886215, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.648, expert1_balance_bottom=18.934, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=225.1, ups=0.59, wpb=381, bsz=32, num_updates=26120, lr=2.79365e-06, gnorm=2.968, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48319
2022-05-08 09:51:35 - progress_bar.py[line:272] - INFO: epoch 002:   8456 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=379.9, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892687, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.861, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.6, ups=0.59, wpb=379.9, bsz=32, num_updates=26130, lr=2.79064e-06, gnorm=3.134, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48336
2022-05-08 09:51:52 - progress_bar.py[line:272] - INFO: epoch 002:   8466 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=385.8, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=35.085, expert1_balance_bottom=18.737, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=226.7, ups=0.59, wpb=385.8, bsz=32, num_updates=26140, lr=2.78764e-06, gnorm=3.536, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48353
2022-05-08 09:52:09 - progress_bar.py[line:272] - INFO: epoch 002:   8476 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=382, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.517, expert1_balance_bottom=19.095, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=225.8, ups=0.59, wpb=382, bsz=32, num_updates=26150, lr=2.78464e-06, gnorm=3.482, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48370
2022-05-08 09:52:26 - progress_bar.py[line:272] - INFO: epoch 002:   8486 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=392.1, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89635, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=33.957, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=233.4, ups=0.6, wpb=392.1, bsz=32, num_updates=26160, lr=2.78163e-06, gnorm=3.343, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48386
2022-05-08 09:52:43 - progress_bar.py[line:272] - INFO: epoch 002:   8496 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=388.5, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877349, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.926, expert1_balance_bottom=18.959, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=227.1, ups=0.58, wpb=388.5, bsz=32, num_updates=26170, lr=2.77863e-06, gnorm=3.124, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48403
2022-05-08 09:53:00 - progress_bar.py[line:272] - INFO: epoch 002:   8506 / 17711 loss=3.164, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.164, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=34.345, expert1_balance_bottom=19.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=219.4, ups=0.58, wpb=380.4, bsz=32, num_updates=26180, lr=2.77563e-06, gnorm=3.77, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=48421
2022-05-08 09:53:17 - progress_bar.py[line:272] - INFO: epoch 002:   8516 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=387.5, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881299, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.832, expert1_balance_bottom=18.685, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.8, ups=0.59, wpb=387.5, bsz=32, num_updates=26190, lr=2.77262e-06, gnorm=3.245, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48438
2022-05-08 09:53:34 - progress_bar.py[line:272] - INFO: epoch 002:   8526 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884333, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.729, expert1_balance_bottom=18.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=225.4, ups=0.59, wpb=383, bsz=32, num_updates=26200, lr=2.76962e-06, gnorm=4.126, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48455
2022-05-08 09:53:51 - progress_bar.py[line:272] - INFO: epoch 002:   8536 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882573, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.294, expert1_balance_bottom=18.877, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=221.5, ups=0.58, wpb=380.2, bsz=32, num_updates=26210, lr=2.76662e-06, gnorm=3.435, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48472
2022-05-08 09:54:08 - progress_bar.py[line:272] - INFO: epoch 002:   8546 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.944, expert1_balance_bottom=18.818, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.7, ups=0.59, wpb=381.9, bsz=32, num_updates=26220, lr=2.76361e-06, gnorm=3.11, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48489
2022-05-08 09:54:25 - progress_bar.py[line:272] - INFO: epoch 002:   8556 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=398.4, nsentences=32, sample_size=316.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.479, expert1_balance_bottom=18.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=235.8, ups=0.59, wpb=398.4, bsz=32, num_updates=26230, lr=2.76061e-06, gnorm=2.992, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48506
2022-05-08 09:54:42 - progress_bar.py[line:272] - INFO: epoch 002:   8566 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=391.7, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=35.304, expert1_balance_bottom=18.76, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=232, ups=0.59, wpb=391.7, bsz=32, num_updates=26240, lr=2.75761e-06, gnorm=2.802, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48523
2022-05-08 09:54:59 - progress_bar.py[line:272] - INFO: epoch 002:   8576 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=389.5, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=35.006, expert1_balance_bottom=18.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.8, ups=0.58, wpb=389.5, bsz=32, num_updates=26250, lr=2.7546e-06, gnorm=4.286, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48540
2022-05-08 09:55:16 - progress_bar.py[line:272] - INFO: epoch 002:   8586 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=379.6, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875519, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=35.017, expert1_balance_bottom=18.89, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224.7, ups=0.59, wpb=379.6, bsz=32, num_updates=26260, lr=2.7516e-06, gnorm=3.721, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48557
2022-05-08 09:55:33 - progress_bar.py[line:272] - INFO: epoch 002:   8596 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=33.746, expert1_balance_bottom=19.287, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=232.2, ups=0.6, wpb=384.2, bsz=32, num_updates=26270, lr=2.7486e-06, gnorm=3.024, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48574
2022-05-08 09:55:49 - progress_bar.py[line:272] - INFO: epoch 002:   8606 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891963, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.485, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=230.7, ups=0.6, wpb=382.4, bsz=32, num_updates=26280, lr=2.74559e-06, gnorm=3.626, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48590
2022-05-08 09:56:06 - progress_bar.py[line:272] - INFO: epoch 002:   8616 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=384.5, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.13, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=225.2, ups=0.59, wpb=384.5, bsz=32, num_updates=26290, lr=2.74259e-06, gnorm=3.336, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=48607
2022-05-08 09:56:24 - progress_bar.py[line:272] - INFO: epoch 002:   8626 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=378.1, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897576, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.87, expert1_balance_bottom=19.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.2, ups=0.58, wpb=378.1, bsz=32, num_updates=26300, lr=2.73959e-06, gnorm=3.077, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=48624
2022-05-08 09:56:40 - progress_bar.py[line:272] - INFO: epoch 002:   8636 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=387.3, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878464, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=35.105, expert1_balance_bottom=19.027, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=229.6, ups=0.59, wpb=387.3, bsz=32, num_updates=26310, lr=2.73658e-06, gnorm=3.932, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48641
2022-05-08 09:56:56 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 09:56:59 - progress_bar.py[line:272] - INFO: epoch 002:   8647 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=386.1, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883212, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.543, expert1_balance_bottom=19.027, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.3, ups=0.54, wpb=386.1, bsz=32, num_updates=26320, lr=2.73358e-06, gnorm=4.074, loss_scale=128, train_wall=18, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=48660
2022-05-08 09:57:16 - progress_bar.py[line:272] - INFO: epoch 002:   8657 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876861, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=35.052, expert1_balance_bottom=18.809, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=231.6, ups=0.6, wpb=384.7, bsz=32, num_updates=26330, lr=2.73058e-06, gnorm=3.602, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48676
2022-05-08 09:57:32 - progress_bar.py[line:272] - INFO: epoch 002:   8667 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=389.3, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886403, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.17, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=233.3, ups=0.6, wpb=389.3, bsz=32, num_updates=26340, lr=2.72757e-06, gnorm=3.997, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48693
2022-05-08 09:57:49 - progress_bar.py[line:272] - INFO: epoch 002:   8677 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=379.9, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876904, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=35.097, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.7, ups=0.59, wpb=379.9, bsz=32, num_updates=26350, lr=2.72457e-06, gnorm=4.3, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48710
2022-05-08 09:58:06 - progress_bar.py[line:272] - INFO: epoch 002:   8687 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.782, expert1_balance_bottom=18.78, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=227.2, ups=0.59, wpb=384.4, bsz=32, num_updates=26360, lr=2.72157e-06, gnorm=3.489, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48727
2022-05-08 09:58:23 - progress_bar.py[line:272] - INFO: epoch 002:   8697 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888907, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.43, expert1_balance_bottom=19.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.5, ups=0.59, wpb=385.4, bsz=32, num_updates=26370, lr=2.71856e-06, gnorm=3.818, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48744
2022-05-08 09:58:40 - progress_bar.py[line:272] - INFO: epoch 002:   8707 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=388.8, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=35.357, expert1_balance_bottom=18.673, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=231.4, ups=0.6, wpb=388.8, bsz=32, num_updates=26380, lr=2.71556e-06, gnorm=3.714, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48761
2022-05-08 09:58:42 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 09:58:59 - progress_bar.py[line:272] - INFO: epoch 002:   8718 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=370.5, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888838, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.365, expert1_balance_bottom=18.941, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=195.6, ups=0.53, wpb=370.5, bsz=32, num_updates=26390, lr=2.71256e-06, gnorm=3.125, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48780
2022-05-08 09:59:16 - progress_bar.py[line:272] - INFO: epoch 002:   8728 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.365, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.4, ups=0.58, wpb=384.7, bsz=32, num_updates=26400, lr=2.70955e-06, gnorm=3.083, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48797
2022-05-08 09:59:33 - progress_bar.py[line:272] - INFO: epoch 002:   8738 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.763, expert1_balance_bottom=18.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=227.1, ups=0.59, wpb=382.1, bsz=32, num_updates=26410, lr=2.70655e-06, gnorm=3.42, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48814
2022-05-08 09:59:50 - progress_bar.py[line:272] - INFO: epoch 002:   8748 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882581, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.66, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.7, ups=0.59, wpb=379.5, bsz=32, num_updates=26420, lr=2.70355e-06, gnorm=3.392, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48830
2022-05-08 10:00:07 - progress_bar.py[line:272] - INFO: epoch 002:   8758 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=377.4, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=33.079, expert1_balance_bottom=19.597, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.3, ups=0.59, wpb=377.4, bsz=32, num_updates=26430, lr=2.70054e-06, gnorm=3.119, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48847
2022-05-08 10:00:24 - progress_bar.py[line:272] - INFO: epoch 002:   8768 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=373.7, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894017, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.915, expert1_balance_bottom=19.19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219.4, ups=0.59, wpb=373.7, bsz=32, num_updates=26440, lr=2.69754e-06, gnorm=3.523, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48864
2022-05-08 10:00:41 - progress_bar.py[line:272] - INFO: epoch 002:   8778 / 17711 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.171, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=35.039, expert1_balance_bottom=18.788, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=227.3, ups=0.59, wpb=385.6, bsz=32, num_updates=26450, lr=2.69454e-06, gnorm=3.721, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48881
2022-05-08 10:00:58 - progress_bar.py[line:272] - INFO: epoch 002:   8788 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.145, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=224.8, ups=0.58, wpb=385.2, bsz=32, num_updates=26460, lr=2.69153e-06, gnorm=3.111, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48899
2022-05-08 10:01:15 - progress_bar.py[line:272] - INFO: epoch 002:   8798 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=376.1, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.2, expert1_balance_bottom=18.987, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.7, ups=0.58, wpb=376.1, bsz=32, num_updates=26470, lr=2.68853e-06, gnorm=4.112, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48916
2022-05-08 10:01:32 - progress_bar.py[line:272] - INFO: epoch 002:   8808 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=381.1, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.916, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225, ups=0.59, wpb=381.1, bsz=32, num_updates=26480, lr=2.68553e-06, gnorm=3.694, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48933
2022-05-08 10:01:49 - progress_bar.py[line:272] - INFO: epoch 002:   8818 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=384.5, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882181, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.452, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.7, ups=0.58, wpb=384.5, bsz=32, num_updates=26490, lr=2.68252e-06, gnorm=3.723, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48950
2022-05-08 10:02:06 - progress_bar.py[line:272] - INFO: epoch 002:   8828 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=376.5, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=33.258, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.4, ups=0.59, wpb=376.5, bsz=32, num_updates=26500, lr=2.67952e-06, gnorm=3.783, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48967
2022-05-08 10:02:23 - progress_bar.py[line:272] - INFO: epoch 002:   8838 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=375.3, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880874, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.718, expert1_balance_bottom=18.972, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=219.1, ups=0.58, wpb=375.3, bsz=32, num_updates=26510, lr=2.67652e-06, gnorm=3.365, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=48984
2022-05-08 10:02:40 - progress_bar.py[line:272] - INFO: epoch 002:   8848 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=379.1, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.922, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=222.9, ups=0.59, wpb=379.1, bsz=32, num_updates=26520, lr=2.67351e-06, gnorm=4.059, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49001
2022-05-08 10:02:57 - progress_bar.py[line:272] - INFO: epoch 002:   8858 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=33.448, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=221.6, ups=0.58, wpb=380.3, bsz=32, num_updates=26530, lr=2.67051e-06, gnorm=3.472, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49018
2022-05-08 10:03:14 - progress_bar.py[line:272] - INFO: epoch 002:   8868 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=379.4, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.701, expert1_balance_bottom=18.955, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222.9, ups=0.59, wpb=379.4, bsz=32, num_updates=26540, lr=2.66751e-06, gnorm=3.88, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49035
2022-05-08 10:03:32 - progress_bar.py[line:272] - INFO: epoch 002:   8878 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87839, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.917, expert1_balance_bottom=18.665, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.9, ups=0.58, wpb=385.4, bsz=32, num_updates=26550, lr=2.6645e-06, gnorm=3.577, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49052
2022-05-08 10:03:49 - progress_bar.py[line:272] - INFO: epoch 002:   8888 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.826, expert1_balance_bottom=18.956, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=220.2, ups=0.58, wpb=378.8, bsz=32, num_updates=26560, lr=2.6615e-06, gnorm=3.761, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49070
2022-05-08 10:04:06 - progress_bar.py[line:272] - INFO: epoch 002:   8898 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.439, expert1_balance_bottom=19.096, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=224.2, ups=0.59, wpb=381.7, bsz=32, num_updates=26570, lr=2.6585e-06, gnorm=3.468, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49087
2022-05-08 10:04:23 - progress_bar.py[line:272] - INFO: epoch 002:   8908 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=374.9, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888022, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.277, expert1_balance_bottom=18.981, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219, ups=0.58, wpb=374.9, bsz=32, num_updates=26580, lr=2.65549e-06, gnorm=3.297, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49104
2022-05-08 10:04:41 - progress_bar.py[line:272] - INFO: epoch 002:   8918 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=379.6, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.194, expert1_balance_bottom=19.096, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217, ups=0.57, wpb=379.6, bsz=32, num_updates=26590, lr=2.65249e-06, gnorm=3.675, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49121
2022-05-08 10:04:58 - progress_bar.py[line:272] - INFO: epoch 002:   8928 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.566, expert1_balance_bottom=18.851, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.1, ups=0.58, wpb=386.5, bsz=32, num_updates=26600, lr=2.64949e-06, gnorm=3.77, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49139
2022-05-08 10:05:15 - progress_bar.py[line:272] - INFO: epoch 002:   8938 / 17711 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=384.6, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.174, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.585, expert1_balance_bottom=18.883, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=222.1, ups=0.58, wpb=384.6, bsz=32, num_updates=26610, lr=2.64648e-06, gnorm=3.429, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49156
2022-05-08 10:05:32 - progress_bar.py[line:272] - INFO: epoch 002:   8948 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=385.4, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.863499, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=35.506, expert1_balance_bottom=18.614, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226.6, ups=0.59, wpb=385.4, bsz=32, num_updates=26620, lr=2.64348e-06, gnorm=3.278, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49173
2022-05-08 10:05:49 - progress_bar.py[line:272] - INFO: epoch 002:   8958 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=374.6, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.937, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222.5, ups=0.59, wpb=374.6, bsz=32, num_updates=26630, lr=2.64048e-06, gnorm=3.241, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49190
2022-05-08 10:06:06 - progress_bar.py[line:272] - INFO: epoch 002:   8968 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883509, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.563, expert1_balance_bottom=18.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=223.7, ups=0.59, wpb=380, bsz=32, num_updates=26640, lr=2.63747e-06, gnorm=3.857, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49207
2022-05-08 10:06:23 - progress_bar.py[line:272] - INFO: epoch 002:   8978 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=370.8, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.738, expert1_balance_bottom=19.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219.1, ups=0.59, wpb=370.8, bsz=32, num_updates=26650, lr=2.63447e-06, gnorm=3.094, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49224
2022-05-08 10:06:40 - progress_bar.py[line:272] - INFO: epoch 002:   8988 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=375.1, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.459, expert1_balance_bottom=19.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.2, ups=0.59, wpb=375.1, bsz=32, num_updates=26660, lr=2.63147e-06, gnorm=3.482, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49241
2022-05-08 10:06:57 - progress_bar.py[line:272] - INFO: epoch 002:   8998 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=383.4, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.227, expert1_balance_top=33.456, expert1_balance_bottom=19.399, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.3, ups=0.58, wpb=383.4, bsz=32, num_updates=26670, lr=2.62847e-06, gnorm=3.168, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49258
2022-05-08 10:07:14 - progress_bar.py[line:272] - INFO: epoch 002:   9008 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=375.2, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889557, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.241, expert1_balance_bottom=18.929, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=218, ups=0.58, wpb=375.2, bsz=32, num_updates=26680, lr=2.62546e-06, gnorm=3.26, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49275
2022-05-08 10:07:31 - progress_bar.py[line:272] - INFO: epoch 002:   9018 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888073, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.044, expert1_balance_bottom=18.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.8, ups=0.58, wpb=386.8, bsz=32, num_updates=26690, lr=2.62246e-06, gnorm=3.51, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49292
2022-05-08 10:07:49 - progress_bar.py[line:272] - INFO: epoch 002:   9028 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885317, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.367, expert1_balance_bottom=18.896, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=223, ups=0.59, wpb=380.8, bsz=32, num_updates=26700, lr=2.61946e-06, gnorm=3.445, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=49309
2022-05-08 10:08:05 - progress_bar.py[line:272] - INFO: epoch 002:   9038 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=397.3, nsentences=32, sample_size=316.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865219, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=35.82, expert1_balance_bottom=18.651, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=236.1, ups=0.59, wpb=397.3, bsz=32, num_updates=26710, lr=2.61645e-06, gnorm=3.243, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49326
2022-05-08 10:08:23 - progress_bar.py[line:272] - INFO: epoch 002:   9048 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887923, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.232, expert1_balance_bottom=18.855, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.4, ups=0.58, wpb=377.9, bsz=32, num_updates=26720, lr=2.61345e-06, gnorm=3.518, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49343
2022-05-08 10:08:40 - progress_bar.py[line:272] - INFO: epoch 002:   9058 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=385.6, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889181, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.878, expert1_balance_bottom=19.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=224.5, ups=0.58, wpb=385.6, bsz=32, num_updates=26730, lr=2.61045e-06, gnorm=3.254, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49361
2022-05-08 10:08:57 - progress_bar.py[line:272] - INFO: epoch 002:   9068 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=380.6, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887092, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.098, expert1_balance_bottom=19.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.8, ups=0.59, wpb=380.6, bsz=32, num_updates=26740, lr=2.60744e-06, gnorm=3.619, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49378
2022-05-08 10:09:14 - progress_bar.py[line:272] - INFO: epoch 002:   9078 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=383.5, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887644, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.833, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.7, ups=0.58, wpb=383.5, bsz=32, num_updates=26750, lr=2.60444e-06, gnorm=3.227, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49395
2022-05-08 10:09:31 - progress_bar.py[line:272] - INFO: epoch 002:   9088 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=398.5, nsentences=32, sample_size=317.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.578, expert1_balance_bottom=18.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=232, ups=0.58, wpb=398.5, bsz=32, num_updates=26760, lr=2.60144e-06, gnorm=3.475, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49412
2022-05-08 10:09:48 - progress_bar.py[line:272] - INFO: epoch 002:   9098 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.228, expert1_balance_top=33.26, expert1_balance_bottom=19.404, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=223.7, ups=0.59, wpb=379.9, bsz=32, num_updates=26770, lr=2.59843e-06, gnorm=3.278, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49429
2022-05-08 10:10:05 - progress_bar.py[line:272] - INFO: epoch 002:   9108 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=379.5, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.848, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.9, ups=0.59, wpb=379.5, bsz=32, num_updates=26780, lr=2.59543e-06, gnorm=3.561, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49446
2022-05-08 10:10:22 - progress_bar.py[line:272] - INFO: epoch 002:   9118 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88234, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.646, expert1_balance_bottom=19.027, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.8, ups=0.58, wpb=383.1, bsz=32, num_updates=26790, lr=2.59243e-06, gnorm=2.767, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49463
2022-05-08 10:10:39 - progress_bar.py[line:272] - INFO: epoch 002:   9128 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884386, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.708, expert1_balance_bottom=18.858, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=229.7, ups=0.6, wpb=384.2, bsz=32, num_updates=26800, lr=2.58942e-06, gnorm=3.444, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49480
2022-05-08 10:10:56 - progress_bar.py[line:272] - INFO: epoch 002:   9138 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=390.2, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.881, expert1_balance_bottom=18.679, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=228.5, ups=0.59, wpb=390.2, bsz=32, num_updates=26810, lr=2.58642e-06, gnorm=3.797, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49497
2022-05-08 10:11:13 - progress_bar.py[line:272] - INFO: epoch 002:   9148 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=375.7, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.316, expert1_balance_bottom=19.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.5, ups=0.6, wpb=375.7, bsz=32, num_updates=26820, lr=2.58342e-06, gnorm=3.36, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49514
2022-05-08 10:11:30 - progress_bar.py[line:272] - INFO: epoch 002:   9158 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882082, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.456, expert1_balance_bottom=19.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223, ups=0.59, wpb=378, bsz=32, num_updates=26830, lr=2.58041e-06, gnorm=3.023, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49531
2022-05-08 10:11:47 - progress_bar.py[line:272] - INFO: epoch 002:   9168 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.965, expert1_balance_bottom=18.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=225.1, ups=0.59, wpb=380.9, bsz=32, num_updates=26840, lr=2.57741e-06, gnorm=3.263, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49548
2022-05-08 10:12:04 - progress_bar.py[line:272] - INFO: epoch 002:   9178 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=391.8, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.738, expert1_balance_bottom=18.832, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=230.9, ups=0.59, wpb=391.8, bsz=32, num_updates=26850, lr=2.57441e-06, gnorm=3.247, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49565
2022-05-08 10:12:21 - progress_bar.py[line:272] - INFO: epoch 002:   9188 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=384.8, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891089, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.978, expert1_balance_bottom=19.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=226.7, ups=0.59, wpb=384.8, bsz=32, num_updates=26860, lr=2.5714e-06, gnorm=3.688, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49582
2022-05-08 10:12:38 - progress_bar.py[line:272] - INFO: epoch 002:   9198 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=391.2, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879785, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.715, expert1_balance_bottom=18.829, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=227.3, ups=0.58, wpb=391.2, bsz=32, num_updates=26870, lr=2.5684e-06, gnorm=3.076, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49599
2022-05-08 10:12:55 - progress_bar.py[line:272] - INFO: epoch 002:   9208 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=390.5, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883566, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.381, expert1_balance_bottom=19.023, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=229.3, ups=0.59, wpb=390.5, bsz=32, num_updates=26880, lr=2.5654e-06, gnorm=3.139, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49616
2022-05-08 10:13:13 - progress_bar.py[line:272] - INFO: epoch 002:   9218 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875716, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.954, expert1_balance_bottom=18.906, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.2, ups=0.56, wpb=384.9, bsz=32, num_updates=26890, lr=2.56239e-06, gnorm=3.176, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49634
2022-05-08 10:13:32 - progress_bar.py[line:272] - INFO: epoch 002:   9228 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=372.8, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=33.506, expert1_balance_bottom=19.147, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=200.3, ups=0.54, wpb=372.8, bsz=32, num_updates=26900, lr=2.55939e-06, gnorm=3.339, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49652
2022-05-08 10:13:51 - progress_bar.py[line:272] - INFO: epoch 002:   9238 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879941, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.558, expert1_balance_bottom=19.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=194.4, ups=0.51, wpb=379.8, bsz=32, num_updates=26910, lr=2.55639e-06, gnorm=3.449, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49672
2022-05-08 10:14:09 - progress_bar.py[line:272] - INFO: epoch 002:   9248 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=383.6, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87554, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=35.454, expert1_balance_bottom=18.788, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=216.5, ups=0.56, wpb=383.6, bsz=32, num_updates=26920, lr=2.55338e-06, gnorm=3.194, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49690
2022-05-08 10:14:26 - progress_bar.py[line:272] - INFO: epoch 002:   9258 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=391.6, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.752, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.4, ups=0.58, wpb=391.6, bsz=32, num_updates=26930, lr=2.55038e-06, gnorm=3.113, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49707
2022-05-08 10:14:43 - progress_bar.py[line:272] - INFO: epoch 002:   9268 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=376, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.695, expert1_balance_bottom=18.89, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=222.5, ups=0.59, wpb=376, bsz=32, num_updates=26940, lr=2.54738e-06, gnorm=3.229, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49724
2022-05-08 10:15:01 - progress_bar.py[line:272] - INFO: epoch 002:   9278 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881899, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.887, expert1_balance_bottom=18.798, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.2, ups=0.55, wpb=380.1, bsz=32, num_updates=26950, lr=2.54437e-06, gnorm=3.282, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49742
2022-05-08 10:15:21 - progress_bar.py[line:272] - INFO: epoch 002:   9288 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891243, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.191, expert1_balance_bottom=19.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=197.8, ups=0.52, wpb=382.3, bsz=32, num_updates=26960, lr=2.54137e-06, gnorm=3.279, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49761
2022-05-08 10:15:39 - progress_bar.py[line:272] - INFO: epoch 002:   9298 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=386.2, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886651, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.546, expert1_balance_bottom=18.955, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=205.6, ups=0.53, wpb=386.2, bsz=32, num_updates=26970, lr=2.53837e-06, gnorm=3.44, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49780
2022-05-08 10:15:57 - progress_bar.py[line:272] - INFO: epoch 002:   9308 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=384.8, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=35.072, expert1_balance_bottom=18.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.9, ups=0.58, wpb=384.8, bsz=32, num_updates=26980, lr=2.53536e-06, gnorm=3.26, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49797
2022-05-08 10:16:13 - progress_bar.py[line:272] - INFO: epoch 002:   9318 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88701, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.565, expert1_balance_bottom=18.852, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=226.2, ups=0.59, wpb=383, bsz=32, num_updates=26990, lr=2.53236e-06, gnorm=3.478, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49814
2022-05-08 10:16:30 - progress_bar.py[line:272] - INFO: epoch 002:   9328 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886735, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.817, expert1_balance_bottom=18.98, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.1, ups=0.59, wpb=384.2, bsz=32, num_updates=27000, lr=2.52936e-06, gnorm=3.393, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49831
2022-05-08 10:16:48 - progress_bar.py[line:272] - INFO: epoch 002:   9338 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.582, expert1_balance_bottom=19.268, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.2, ups=0.58, wpb=380, bsz=32, num_updates=27010, lr=2.52635e-06, gnorm=3.438, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49848
2022-05-08 10:17:07 - progress_bar.py[line:272] - INFO: epoch 002:   9348 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.222, expert1_balance_bottom=19.016, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=200.5, ups=0.53, wpb=380.7, bsz=32, num_updates=27020, lr=2.52335e-06, gnorm=3.152, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49867
2022-05-08 10:17:26 - progress_bar.py[line:272] - INFO: epoch 002:   9358 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=388.7, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.981, expert1_balance_bottom=18.81, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=197.2, ups=0.51, wpb=388.7, bsz=32, num_updates=27030, lr=2.52035e-06, gnorm=3.365, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49887
2022-05-08 10:17:45 - progress_bar.py[line:272] - INFO: epoch 002:   9368 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.555, expert1_balance_bottom=18.951, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=205.3, ups=0.54, wpb=379.7, bsz=32, num_updates=27040, lr=2.51734e-06, gnorm=3.358, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49906
2022-05-08 10:18:04 - progress_bar.py[line:272] - INFO: epoch 002:   9378 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=386.5, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882571, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.66, expert1_balance_bottom=18.667, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=203.4, ups=0.53, wpb=386.5, bsz=32, num_updates=27050, lr=2.51434e-06, gnorm=3.468, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49925
2022-05-08 10:18:22 - progress_bar.py[line:272] - INFO: epoch 002:   9388 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895826, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.607, expert1_balance_bottom=19.181, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.8, ups=0.55, wpb=381.5, bsz=32, num_updates=27060, lr=2.51134e-06, gnorm=3.485, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49943
2022-05-08 10:18:42 - progress_bar.py[line:272] - INFO: epoch 002:   9398 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=381.1, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89219, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.086, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=192.2, ups=0.5, wpb=381.1, bsz=32, num_updates=27070, lr=2.50833e-06, gnorm=3.37, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49963
2022-05-08 10:19:00 - progress_bar.py[line:272] - INFO: epoch 002:   9408 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886401, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.544, expert1_balance_bottom=18.78, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=208.7, ups=0.55, wpb=382.4, bsz=32, num_updates=27080, lr=2.50533e-06, gnorm=3.128, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49981
2022-05-08 10:19:17 - progress_bar.py[line:272] - INFO: epoch 002:   9418 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=387.3, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=35.143, expert1_balance_bottom=18.702, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=223.8, ups=0.58, wpb=387.3, bsz=32, num_updates=27090, lr=2.50233e-06, gnorm=3.145, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=49998
2022-05-08 10:19:35 - progress_bar.py[line:272] - INFO: epoch 002:   9428 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=390.1, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893269, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.831, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=229.1, ups=0.59, wpb=390.1, bsz=32, num_updates=27100, lr=2.49932e-06, gnorm=3.01, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50015
2022-05-08 10:19:52 - progress_bar.py[line:272] - INFO: epoch 002:   9438 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=387.8, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888722, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.154, expert1_balance_bottom=19.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=225.9, ups=0.58, wpb=387.8, bsz=32, num_updates=27110, lr=2.49632e-06, gnorm=3.244, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=50032
2022-05-08 10:20:09 - progress_bar.py[line:272] - INFO: epoch 002:   9448 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=388.4, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878821, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.923, expert1_balance_bottom=18.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=228.1, ups=0.59, wpb=388.4, bsz=32, num_updates=27120, lr=2.49332e-06, gnorm=3.757, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50049
2022-05-08 10:20:26 - progress_bar.py[line:272] - INFO: epoch 002:   9458 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.812, expert1_balance_bottom=18.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=222.6, ups=0.59, wpb=378.5, bsz=32, num_updates=27130, lr=2.49031e-06, gnorm=3.236, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50066
2022-05-08 10:20:43 - progress_bar.py[line:272] - INFO: epoch 002:   9468 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.101, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.9, ups=0.59, wpb=382.3, bsz=32, num_updates=27140, lr=2.48731e-06, gnorm=3.213, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50083
2022-05-08 10:21:00 - progress_bar.py[line:272] - INFO: epoch 002:   9478 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878357, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.863, expert1_balance_bottom=18.828, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226, ups=0.58, wpb=388.2, bsz=32, num_updates=27150, lr=2.48431e-06, gnorm=3.228, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50101
2022-05-08 10:21:19 - progress_bar.py[line:272] - INFO: epoch 002:   9488 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=379.5, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885557, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.413, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=192.9, ups=0.51, wpb=379.5, bsz=32, num_updates=27160, lr=2.4813e-06, gnorm=3.207, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50120
2022-05-08 10:21:37 - progress_bar.py[line:272] - INFO: epoch 002:   9498 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884611, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.209, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.4, ups=0.56, wpb=385.1, bsz=32, num_updates=27170, lr=2.4783e-06, gnorm=3.215, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50138
2022-05-08 10:21:58 - progress_bar.py[line:272] - INFO: epoch 002:   9508 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871696, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.804, expert1_balance_bottom=18.818, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=190.2, ups=0.49, wpb=386.1, bsz=32, num_updates=27180, lr=2.4753e-06, gnorm=3.105, loss_scale=128, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50158
2022-05-08 10:22:15 - progress_bar.py[line:272] - INFO: epoch 002:   9518 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=382.3, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.516, expert1_balance_bottom=18.976, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.1, ups=0.58, wpb=382.3, bsz=32, num_updates=27190, lr=2.47229e-06, gnorm=3.318, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50175
2022-05-08 10:22:32 - progress_bar.py[line:272] - INFO: epoch 002:   9528 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=384.4, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.813, expert1_balance_bottom=19.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=225.5, ups=0.59, wpb=384.4, bsz=32, num_updates=27200, lr=2.46929e-06, gnorm=2.848, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=50193
2022-05-08 10:22:49 - progress_bar.py[line:272] - INFO: epoch 002:   9538 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=383.8, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.424, expert1_balance_bottom=19.142, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=225.3, ups=0.59, wpb=383.8, bsz=32, num_updates=27210, lr=2.46629e-06, gnorm=3.428, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50210
2022-05-08 10:23:06 - progress_bar.py[line:272] - INFO: epoch 002:   9548 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=388.6, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871779, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=35.319, expert1_balance_bottom=18.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=229.8, ups=0.59, wpb=388.6, bsz=32, num_updates=27220, lr=2.46328e-06, gnorm=3.377, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50226
2022-05-08 10:23:23 - progress_bar.py[line:272] - INFO: epoch 002:   9558 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=374.9, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897693, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=33.953, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.8, ups=0.56, wpb=374.9, bsz=32, num_updates=27230, lr=2.46028e-06, gnorm=3.127, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50244
2022-05-08 10:23:42 - progress_bar.py[line:272] - INFO: epoch 002:   9568 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.074, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=207.9, ups=0.54, wpb=385.9, bsz=32, num_updates=27240, lr=2.45728e-06, gnorm=3.346, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50263
2022-05-08 10:24:01 - progress_bar.py[line:272] - INFO: epoch 002:   9578 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883616, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.266, expert1_balance_bottom=18.968, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=199.1, ups=0.52, wpb=381, bsz=32, num_updates=27250, lr=2.45428e-06, gnorm=3.28, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50282
2022-05-08 10:24:18 - progress_bar.py[line:272] - INFO: epoch 002:   9588 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=382.3, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.06, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.1, ups=0.58, wpb=382.3, bsz=32, num_updates=27260, lr=2.45127e-06, gnorm=3.242, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50299
2022-05-08 10:24:40 - progress_bar.py[line:272] - INFO: epoch 002:   9598 / 17711 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=391.2, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.174, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=35.294, expert1_balance_bottom=18.9, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=183.8, ups=0.47, wpb=391.2, bsz=32, num_updates=27270, lr=2.44827e-06, gnorm=3.197, loss_scale=128, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50320
2022-05-08 10:24:57 - progress_bar.py[line:272] - INFO: epoch 002:   9608 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880237, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.615, expert1_balance_bottom=18.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.9, ups=0.59, wpb=379.5, bsz=32, num_updates=27280, lr=2.44527e-06, gnorm=3.973, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50337
2022-05-08 10:25:14 - progress_bar.py[line:272] - INFO: epoch 002:   9618 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=379, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.868, expert1_balance_bottom=19.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.8, ups=0.59, wpb=379, bsz=32, num_updates=27290, lr=2.44226e-06, gnorm=3.37, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50354
2022-05-08 10:25:31 - progress_bar.py[line:272] - INFO: epoch 002:   9628 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=380.3, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.313, expert1_balance_bottom=19.016, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.3, ups=0.57, wpb=380.3, bsz=32, num_updates=27300, lr=2.43926e-06, gnorm=3.587, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50372
2022-05-08 10:25:49 - progress_bar.py[line:272] - INFO: epoch 002:   9638 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.993, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.2, ups=0.57, wpb=380, bsz=32, num_updates=27310, lr=2.43626e-06, gnorm=3.406, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50389
2022-05-08 10:26:06 - progress_bar.py[line:272] - INFO: epoch 002:   9648 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=383.7, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879905, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.801, expert1_balance_bottom=18.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=216.9, ups=0.57, wpb=383.7, bsz=32, num_updates=27320, lr=2.43325e-06, gnorm=4.148, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=50407
2022-05-08 10:26:24 - progress_bar.py[line:272] - INFO: epoch 002:   9658 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=372.1, nsentences=32, sample_size=296.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89137, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.902, expert1_balance_bottom=19.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.6, ups=0.57, wpb=372.1, bsz=32, num_updates=27330, lr=2.43025e-06, gnorm=3.036, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50425
2022-05-08 10:26:41 - progress_bar.py[line:272] - INFO: epoch 002:   9668 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=382.4, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890109, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.98, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221, ups=0.58, wpb=382.4, bsz=32, num_updates=27340, lr=2.42725e-06, gnorm=3.441, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50442
2022-05-08 10:26:58 - progress_bar.py[line:272] - INFO: epoch 002:   9678 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886016, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.271, expert1_balance_bottom=19.227, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=226.3, ups=0.59, wpb=384.7, bsz=32, num_updates=27350, lr=2.42424e-06, gnorm=3.416, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50459
2022-05-08 10:27:16 - progress_bar.py[line:272] - INFO: epoch 002:   9688 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=377.6, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886224, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.513, expert1_balance_bottom=18.952, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=216.2, ups=0.57, wpb=377.6, bsz=32, num_updates=27360, lr=2.42124e-06, gnorm=3.13, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50476
2022-05-08 10:27:33 - progress_bar.py[line:272] - INFO: epoch 002:   9698 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=387, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881227, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.486, expert1_balance_bottom=19.07, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.7, ups=0.58, wpb=387, bsz=32, num_updates=27370, lr=2.41824e-06, gnorm=3.065, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50494
2022-05-08 10:27:50 - progress_bar.py[line:272] - INFO: epoch 002:   9708 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=388.3, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875544, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=35.24, expert1_balance_bottom=18.713, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220.6, ups=0.57, wpb=388.3, bsz=32, num_updates=27380, lr=2.41523e-06, gnorm=3.269, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50511
2022-05-08 10:28:08 - progress_bar.py[line:272] - INFO: epoch 002:   9718 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=384.6, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.987, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.1, ups=0.58, wpb=384.6, bsz=32, num_updates=27390, lr=2.41223e-06, gnorm=3.114, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50528
2022-05-08 10:28:25 - progress_bar.py[line:272] - INFO: epoch 002:   9728 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=388.9, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875843, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.89, expert1_balance_bottom=18.857, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226.6, ups=0.58, wpb=388.9, bsz=32, num_updates=27400, lr=2.40923e-06, gnorm=3.206, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50546
2022-05-08 10:28:42 - progress_bar.py[line:272] - INFO: epoch 002:   9738 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=376, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.479, expert1_balance_bottom=19.239, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=220.6, ups=0.59, wpb=376, bsz=32, num_updates=27410, lr=2.40622e-06, gnorm=3.615, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50563
2022-05-08 10:29:00 - progress_bar.py[line:272] - INFO: epoch 002:   9748 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=387, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.253, expert1_balance_bottom=19.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=216.7, ups=0.56, wpb=387, bsz=32, num_updates=27420, lr=2.40322e-06, gnorm=3.107, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50580
2022-05-08 10:29:19 - progress_bar.py[line:272] - INFO: epoch 002:   9758 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878139, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.517, expert1_balance_bottom=19.086, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=194.9, ups=0.51, wpb=383.6, bsz=32, num_updates=27430, lr=2.40022e-06, gnorm=3.413, loss_scale=256, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50600
2022-05-08 10:29:37 - progress_bar.py[line:272] - INFO: epoch 002:   9768 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=383.6, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885793, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.426, expert1_balance_bottom=19.003, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.8, ups=0.56, wpb=383.6, bsz=32, num_updates=27440, lr=2.39721e-06, gnorm=3.235, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50618
2022-05-08 10:29:54 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 10:30:00 - progress_bar.py[line:272] - INFO: epoch 002:   9779 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88525, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.262, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=168.3, ups=0.45, wpb=375.5, bsz=32, num_updates=27450, lr=2.39421e-06, gnorm=3.066, loss_scale=128, train_wall=21, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50640
2022-05-08 10:30:20 - progress_bar.py[line:272] - INFO: epoch 002:   9789 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=389.4, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885483, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.347, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=195.6, ups=0.5, wpb=389.4, bsz=32, num_updates=27460, lr=2.39121e-06, gnorm=3.228, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50660
2022-05-08 10:30:37 - progress_bar.py[line:272] - INFO: epoch 002:   9799 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883546, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.178, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=214.8, ups=0.56, wpb=384.2, bsz=32, num_updates=27470, lr=2.3882e-06, gnorm=3.496, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50678
2022-05-08 10:30:55 - progress_bar.py[line:272] - INFO: epoch 002:   9809 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=373.5, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887644, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.231, expert1_balance_bottom=19.285, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213.8, ups=0.57, wpb=373.5, bsz=32, num_updates=27480, lr=2.3852e-06, gnorm=3.148, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50696
2022-05-08 10:31:15 - progress_bar.py[line:272] - INFO: epoch 002:   9819 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=382.1, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.169, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=185.9, ups=0.49, wpb=382.1, bsz=32, num_updates=27490, lr=2.3822e-06, gnorm=3.539, loss_scale=128, train_wall=20, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=50716
2022-05-08 10:31:32 - progress_bar.py[line:272] - INFO: epoch 002:   9829 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=35.108, expert1_balance_bottom=18.626, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227.5, ups=0.59, wpb=384.2, bsz=32, num_updates=27500, lr=2.37919e-06, gnorm=3.08, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50733
2022-05-08 10:31:49 - progress_bar.py[line:272] - INFO: epoch 002:   9839 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=373.1, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89197, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.472, expert1_balance_bottom=18.843, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.6, ups=0.59, wpb=373.1, bsz=32, num_updates=27510, lr=2.37619e-06, gnorm=3.098, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50750
2022-05-08 10:32:07 - progress_bar.py[line:272] - INFO: epoch 002:   9849 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876437, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.782, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.3, ups=0.56, wpb=381.8, bsz=32, num_updates=27520, lr=2.37319e-06, gnorm=3.004, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50768
2022-05-08 10:32:27 - progress_bar.py[line:272] - INFO: epoch 002:   9859 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900325, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.445, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=193.2, ups=0.51, wpb=378.8, bsz=32, num_updates=27530, lr=2.37018e-06, gnorm=3.312, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50788
2022-05-08 10:32:45 - progress_bar.py[line:272] - INFO: epoch 002:   9869 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.963, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.9, ups=0.56, wpb=381, bsz=32, num_updates=27540, lr=2.36718e-06, gnorm=3.054, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50805
2022-05-08 10:33:05 - progress_bar.py[line:272] - INFO: epoch 002:   9879 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=382.9, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887961, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.169, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=189.4, ups=0.49, wpb=382.9, bsz=32, num_updates=27550, lr=2.36418e-06, gnorm=3.949, loss_scale=128, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50826
2022-05-08 10:33:23 - progress_bar.py[line:272] - INFO: epoch 002:   9889 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=386.3, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893022, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.06, expert1_balance_bottom=19.291, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214.7, ups=0.56, wpb=386.3, bsz=32, num_updates=27560, lr=2.36117e-06, gnorm=3.282, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50844
2022-05-08 10:33:40 - progress_bar.py[line:272] - INFO: epoch 002:   9899 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=381.4, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886114, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.532, expert1_balance_bottom=18.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=222.7, ups=0.58, wpb=381.4, bsz=32, num_updates=27570, lr=2.35817e-06, gnorm=3.596, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50861
2022-05-08 10:33:57 - progress_bar.py[line:272] - INFO: epoch 002:   9909 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=387.8, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.72, expert1_balance_bottom=18.963, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=230.2, ups=0.59, wpb=387.8, bsz=32, num_updates=27580, lr=2.35517e-06, gnorm=3.174, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50878
2022-05-08 10:34:14 - progress_bar.py[line:272] - INFO: epoch 002:   9919 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882342, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.744, expert1_balance_bottom=18.952, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225, ups=0.58, wpb=385.7, bsz=32, num_updates=27590, lr=2.35216e-06, gnorm=2.951, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=50895
2022-05-08 10:34:31 - progress_bar.py[line:272] - INFO: epoch 002:   9929 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.99, ntokens=390.6, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884438, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.601, expert1_balance_bottom=19.071, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=229.1, ups=0.59, wpb=390.6, bsz=32, num_updates=27600, lr=2.34916e-06, gnorm=3.127, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50912
2022-05-08 10:34:43 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 10:34:50 - progress_bar.py[line:272] - INFO: epoch 002:   9940 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=387.4, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.556, expert1_balance_bottom=19.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.4, ups=0.54, wpb=387.4, bsz=32, num_updates=27610, lr=2.34616e-06, gnorm=3.093, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50930
2022-05-08 10:35:07 - progress_bar.py[line:272] - INFO: epoch 002:   9950 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=376.6, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.281, expert1_balance_bottom=19.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222.2, ups=0.59, wpb=376.6, bsz=32, num_updates=27620, lr=2.34315e-06, gnorm=3.155, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50947
2022-05-08 10:35:24 - progress_bar.py[line:272] - INFO: epoch 002:   9960 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=372.7, nsentences=32, sample_size=296.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900102, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.225, expert1_balance_top=33.293, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.8, ups=0.58, wpb=372.7, bsz=32, num_updates=27630, lr=2.34015e-06, gnorm=3.783, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50964
2022-05-08 10:35:41 - progress_bar.py[line:272] - INFO: epoch 002:   9970 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.318, expert1_balance_bottom=19.059, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=222.1, ups=0.59, wpb=378.4, bsz=32, num_updates=27640, lr=2.33715e-06, gnorm=3.329, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50982
2022-05-08 10:35:58 - progress_bar.py[line:272] - INFO: epoch 002:   9980 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=374.2, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887004, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.511, expert1_balance_bottom=19.191, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=221.5, ups=0.59, wpb=374.2, bsz=32, num_updates=27650, lr=2.33414e-06, gnorm=3.066, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=50998
2022-05-08 10:36:15 - progress_bar.py[line:272] - INFO: epoch 002:   9990 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.794, expert1_balance_bottom=18.894, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=223.5, ups=0.59, wpb=380.5, bsz=32, num_updates=27660, lr=2.33114e-06, gnorm=3.426, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51015
2022-05-08 10:36:32 - progress_bar.py[line:272] - INFO: epoch 002:  10000 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880072, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.735, expert1_balance_bottom=19.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.9, ups=0.58, wpb=377.9, bsz=32, num_updates=27670, lr=2.32814e-06, gnorm=2.871, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51033
2022-05-08 10:36:49 - progress_bar.py[line:272] - INFO: epoch 002:  10010 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.412, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.4, ups=0.59, wpb=380.1, bsz=32, num_updates=27680, lr=2.32513e-06, gnorm=3.5, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51050
2022-05-08 10:37:06 - progress_bar.py[line:272] - INFO: epoch 002:  10020 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=382.7, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874331, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=35.031, expert1_balance_bottom=18.867, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223.2, ups=0.58, wpb=382.7, bsz=32, num_updates=27690, lr=2.32213e-06, gnorm=3.888, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51067
2022-05-08 10:37:23 - progress_bar.py[line:272] - INFO: epoch 002:  10030 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=391.8, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.167, expert1_balance_bottom=18.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=228.1, ups=0.58, wpb=391.8, bsz=32, num_updates=27700, lr=2.31913e-06, gnorm=2.819, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51084
2022-05-08 10:37:41 - progress_bar.py[line:272] - INFO: epoch 002:  10040 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=376.3, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897898, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=33.175, expert1_balance_bottom=19.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.7, ups=0.57, wpb=376.3, bsz=32, num_updates=27710, lr=2.31612e-06, gnorm=2.948, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51101
2022-05-08 10:37:58 - progress_bar.py[line:272] - INFO: epoch 002:  10050 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=389.4, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878415, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.861, expert1_balance_bottom=18.804, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=225.1, ups=0.58, wpb=389.4, bsz=32, num_updates=27720, lr=2.31312e-06, gnorm=3.604, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51119
2022-05-08 10:38:15 - progress_bar.py[line:272] - INFO: epoch 002:  10060 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=33.822, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=220.4, ups=0.58, wpb=376.7, bsz=32, num_updates=27730, lr=2.31012e-06, gnorm=3.181, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51136
2022-05-08 10:38:32 - progress_bar.py[line:272] - INFO: epoch 002:  10070 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=377, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.785, expert1_balance_bottom=18.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.5, ups=0.59, wpb=377, bsz=32, num_updates=27740, lr=2.30711e-06, gnorm=3.184, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=51153
2022-05-08 10:38:49 - progress_bar.py[line:272] - INFO: epoch 002:  10080 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=373.4, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.781, expert1_balance_bottom=18.745, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=218.1, ups=0.58, wpb=373.4, bsz=32, num_updates=27750, lr=2.30411e-06, gnorm=3.535, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51170
2022-05-08 10:39:06 - progress_bar.py[line:272] - INFO: epoch 002:  10090 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.224, expert1_balance_bottom=19.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=224.3, ups=0.59, wpb=383.2, bsz=32, num_updates=27760, lr=2.30111e-06, gnorm=3.468, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51187
2022-05-08 10:39:25 - progress_bar.py[line:272] - INFO: epoch 002:  10100 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891726, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.963, expert1_balance_bottom=18.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=196.5, ups=0.52, wpb=379, bsz=32, num_updates=27770, lr=2.2981e-06, gnorm=3.236, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51206
2022-05-08 10:39:44 - progress_bar.py[line:272] - INFO: epoch 002:  10110 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884217, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.573, expert1_balance_bottom=18.928, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=207.7, ups=0.54, wpb=387, bsz=32, num_updates=27780, lr=2.2951e-06, gnorm=3.16, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51225
2022-05-08 10:40:02 - progress_bar.py[line:272] - INFO: epoch 002:  10120 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884255, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.812, expert1_balance_bottom=18.847, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216.4, ups=0.57, wpb=382.6, bsz=32, num_updates=27790, lr=2.2921e-06, gnorm=2.911, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51243
2022-05-08 10:40:22 - progress_bar.py[line:272] - INFO: epoch 002:  10130 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.519, expert1_balance_bottom=18.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=187.5, ups=0.49, wpb=384.4, bsz=32, num_updates=27800, lr=2.2891e-06, gnorm=3.322, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51263
2022-05-08 10:40:41 - progress_bar.py[line:272] - INFO: epoch 002:  10140 / 17711 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.186, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.909, expert1_balance_bottom=19.188, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=204, ups=0.54, wpb=380.9, bsz=32, num_updates=27810, lr=2.28609e-06, gnorm=3.61, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51282
2022-05-08 10:41:00 - progress_bar.py[line:272] - INFO: epoch 002:  10150 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875878, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.847, expert1_balance_bottom=18.953, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=199.6, ups=0.53, wpb=378.7, bsz=32, num_updates=27820, lr=2.28309e-06, gnorm=3.327, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51301
2022-05-08 10:41:18 - progress_bar.py[line:272] - INFO: epoch 002:  10160 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894132, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.743, expert1_balance_bottom=19.199, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=219.7, ups=0.57, wpb=388.1, bsz=32, num_updates=27830, lr=2.28009e-06, gnorm=3.392, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51318
2022-05-08 10:41:36 - progress_bar.py[line:272] - INFO: epoch 002:  10170 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.742, expert1_balance_bottom=19.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.6, ups=0.55, wpb=381.7, bsz=32, num_updates=27840, lr=2.27708e-06, gnorm=3.509, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51337
2022-05-08 10:41:55 - progress_bar.py[line:272] - INFO: epoch 002:  10180 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=381.2, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880321, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.641, expert1_balance_bottom=18.847, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=198.3, ups=0.52, wpb=381.2, bsz=32, num_updates=27850, lr=2.27408e-06, gnorm=3.37, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51356
2022-05-08 10:42:12 - progress_bar.py[line:272] - INFO: epoch 002:  10190 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877702, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.877, expert1_balance_bottom=18.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.7, ups=0.58, wpb=381.1, bsz=32, num_updates=27860, lr=2.27108e-06, gnorm=3.284, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51373
2022-05-08 10:42:30 - progress_bar.py[line:272] - INFO: epoch 002:  10200 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.167, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.9, ups=0.57, wpb=382.7, bsz=32, num_updates=27870, lr=2.26807e-06, gnorm=3.292, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51390
2022-05-08 10:42:47 - progress_bar.py[line:272] - INFO: epoch 002:  10210 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=378.8, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886563, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.137, expert1_balance_bottom=19.022, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.5, ups=0.58, wpb=378.8, bsz=32, num_updates=27880, lr=2.26507e-06, gnorm=3.514, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51408
2022-05-08 10:43:06 - progress_bar.py[line:272] - INFO: epoch 002:  10220 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87849, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.659, expert1_balance_bottom=19.016, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=195.4, ups=0.51, wpb=382.6, bsz=32, num_updates=27890, lr=2.26207e-06, gnorm=3.14, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51427
2022-05-08 10:43:25 - progress_bar.py[line:272] - INFO: epoch 002:  10230 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=372.9, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.059, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=203.9, ups=0.55, wpb=372.9, bsz=32, num_updates=27900, lr=2.25906e-06, gnorm=3.226, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51445
2022-05-08 10:43:42 - progress_bar.py[line:272] - INFO: epoch 002:  10240 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=385.1, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.455, expert1_balance_bottom=18.972, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=218.4, ups=0.57, wpb=385.1, bsz=32, num_updates=27910, lr=2.25606e-06, gnorm=3.533, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51463
2022-05-08 10:44:03 - progress_bar.py[line:272] - INFO: epoch 002:  10250 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.778, expert1_balance_bottom=19.077, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=182.4, ups=0.48, wpb=383.2, bsz=32, num_updates=27920, lr=2.25306e-06, gnorm=3.201, loss_scale=64, train_wall=20, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=51484
2022-05-08 10:44:20 - progress_bar.py[line:272] - INFO: epoch 002:  10260 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.957, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.838, expert1_balance_bottom=18.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=224.9, ups=0.59, wpb=384, bsz=32, num_updates=27930, lr=2.25005e-06, gnorm=3.574, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51501
2022-05-08 10:44:37 - progress_bar.py[line:272] - INFO: epoch 002:  10270 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878668, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.812, expert1_balance_bottom=18.879, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.9, ups=0.59, wpb=380.7, bsz=32, num_updates=27940, lr=2.24705e-06, gnorm=3.376, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51518
2022-05-08 10:44:54 - progress_bar.py[line:272] - INFO: epoch 002:  10280 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=380.3, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889457, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.837, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=224.7, ups=0.59, wpb=380.3, bsz=32, num_updates=27950, lr=2.24405e-06, gnorm=3.53, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=51535
2022-05-08 10:45:12 - progress_bar.py[line:272] - INFO: epoch 002:  10290 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.497, expert1_balance_bottom=18.995, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=219.1, ups=0.57, wpb=382.5, bsz=32, num_updates=27960, lr=2.24104e-06, gnorm=3.516, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51552
2022-05-08 10:45:29 - progress_bar.py[line:272] - INFO: epoch 002:  10300 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.738, expert1_balance_bottom=19.268, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223, ups=0.59, wpb=380.8, bsz=32, num_updates=27970, lr=2.23804e-06, gnorm=3.266, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51570
2022-05-08 10:45:46 - progress_bar.py[line:272] - INFO: epoch 002:  10310 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880461, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.685, expert1_balance_bottom=18.942, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218.4, ups=0.57, wpb=381.8, bsz=32, num_updates=27980, lr=2.23504e-06, gnorm=3.249, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51587
2022-05-08 10:46:04 - progress_bar.py[line:272] - INFO: epoch 002:  10320 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=380.3, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.511, expert1_balance_bottom=18.945, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=219.4, ups=0.58, wpb=380.3, bsz=32, num_updates=27990, lr=2.23203e-06, gnorm=3.354, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51604
2022-05-08 10:46:21 - progress_bar.py[line:272] - INFO: epoch 002:  10330 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891961, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.995, expert1_balance_bottom=18.998, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223, ups=0.58, wpb=381.8, bsz=32, num_updates=28000, lr=2.22903e-06, gnorm=3.28, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51622
2022-05-08 10:46:38 - progress_bar.py[line:272] - INFO: epoch 002:  10340 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=375.8, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.842, expert1_balance_bottom=18.998, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=222.9, ups=0.59, wpb=375.8, bsz=32, num_updates=28010, lr=2.22603e-06, gnorm=3.303, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51638
2022-05-08 10:46:55 - progress_bar.py[line:272] - INFO: epoch 002:  10350 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=374, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898354, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.224, expert1_balance_top=33.735, expert1_balance_bottom=19.228, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.6, ups=0.58, wpb=374, bsz=32, num_updates=28020, lr=2.22302e-06, gnorm=3.038, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51655
2022-05-08 10:47:12 - progress_bar.py[line:272] - INFO: epoch 002:  10360 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=376.3, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.655, expert1_balance_bottom=18.873, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.5, ups=0.59, wpb=376.3, bsz=32, num_updates=28030, lr=2.22002e-06, gnorm=3.571, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51672
2022-05-08 10:47:29 - progress_bar.py[line:272] - INFO: epoch 002:  10370 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881051, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.786, expert1_balance_bottom=18.945, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.7, ups=0.59, wpb=385.2, bsz=32, num_updates=28040, lr=2.21702e-06, gnorm=3.203, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=51690
2022-05-08 10:47:46 - progress_bar.py[line:272] - INFO: epoch 002:  10380 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=384.2, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=35.16, expert1_balance_bottom=18.776, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=224, ups=0.58, wpb=384.2, bsz=32, num_updates=28050, lr=2.21401e-06, gnorm=3.517, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=51707
2022-05-08 10:48:03 - progress_bar.py[line:272] - INFO: epoch 002:  10390 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.957, ntokens=379.5, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889129, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.243, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=219.9, ups=0.58, wpb=379.5, bsz=32, num_updates=28060, lr=2.21101e-06, gnorm=3.286, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51724
2022-05-08 10:48:20 - progress_bar.py[line:272] - INFO: epoch 002:  10400 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.323, expert1_balance_bottom=19.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.4, ups=0.58, wpb=385.3, bsz=32, num_updates=28070, lr=2.20801e-06, gnorm=3.284, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51741
2022-05-08 10:48:37 - progress_bar.py[line:272] - INFO: epoch 002:  10410 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=384.4, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877191, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=35.08, expert1_balance_bottom=18.916, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=229.3, ups=0.6, wpb=384.4, bsz=32, num_updates=28080, lr=2.205e-06, gnorm=3.669, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51758
2022-05-08 10:48:54 - progress_bar.py[line:272] - INFO: epoch 002:  10420 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=387.2, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.451, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.5, ups=0.58, wpb=387.2, bsz=32, num_updates=28090, lr=2.202e-06, gnorm=3.457, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51775
2022-05-08 10:49:11 - progress_bar.py[line:272] - INFO: epoch 002:  10430 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=380.2, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89145, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=34.181, expert1_balance_bottom=19.057, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.1, ups=0.58, wpb=380.2, bsz=32, num_updates=28100, lr=2.199e-06, gnorm=3.598, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51792
2022-05-08 10:49:29 - progress_bar.py[line:272] - INFO: epoch 002:  10440 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.54, expert1_balance_bottom=19.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=222.1, ups=0.59, wpb=379.2, bsz=32, num_updates=28110, lr=2.19599e-06, gnorm=2.998, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51809
2022-05-08 10:49:45 - progress_bar.py[line:272] - INFO: epoch 002:  10450 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=383.4, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889648, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.519, expert1_balance_bottom=18.81, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=226.6, ups=0.59, wpb=383.4, bsz=32, num_updates=28120, lr=2.19299e-06, gnorm=3.61, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51826
2022-05-08 10:50:03 - progress_bar.py[line:272] - INFO: epoch 002:  10460 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=35.236, expert1_balance_bottom=18.731, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=222.7, ups=0.58, wpb=383.4, bsz=32, num_updates=28130, lr=2.18999e-06, gnorm=3.341, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51843
2022-05-08 10:50:20 - progress_bar.py[line:272] - INFO: epoch 002:  10470 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=369.9, nsentences=32, sample_size=294.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893432, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.233, expert1_balance_bottom=19.07, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.1, ups=0.58, wpb=369.9, bsz=32, num_updates=28140, lr=2.18698e-06, gnorm=3.218, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51861
2022-05-08 10:50:40 - progress_bar.py[line:272] - INFO: epoch 002:  10480 / 17711 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=388.9, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880652, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.205, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.803, expert1_balance_bottom=19.029, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=197.8, ups=0.51, wpb=388.9, bsz=32, num_updates=28150, lr=2.18398e-06, gnorm=3.694, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51880
2022-05-08 10:50:58 - progress_bar.py[line:272] - INFO: epoch 002:  10490 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=385.5, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8888, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.17, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211, ups=0.55, wpb=385.5, bsz=32, num_updates=28160, lr=2.18098e-06, gnorm=3.237, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51899
2022-05-08 10:51:16 - progress_bar.py[line:272] - INFO: epoch 002:  10500 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=377, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.536, expert1_balance_bottom=18.841, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213, ups=0.57, wpb=377, bsz=32, num_updates=28170, lr=2.17797e-06, gnorm=3.682, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51916
2022-05-08 10:51:36 - progress_bar.py[line:272] - INFO: epoch 002:  10510 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.577, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=191.8, ups=0.5, wpb=382.9, bsz=32, num_updates=28180, lr=2.17497e-06, gnorm=3.277, loss_scale=128, train_wall=19, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=51936
2022-05-08 10:51:53 - progress_bar.py[line:272] - INFO: epoch 002:  10520 / 17711 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.163, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.47, expert1_balance_bottom=19.072, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=222.1, ups=0.58, wpb=385.7, bsz=32, num_updates=28190, lr=2.17197e-06, gnorm=3.71, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51954
2022-05-08 10:52:11 - progress_bar.py[line:272] - INFO: epoch 002:  10530 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=383.1, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880301, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.841, expert1_balance_bottom=19.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.4, ups=0.57, wpb=383.1, bsz=32, num_updates=28200, lr=2.16896e-06, gnorm=3.75, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51971
2022-05-08 10:52:28 - progress_bar.py[line:272] - INFO: epoch 002:  10540 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=377.2, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.401, expert1_balance_bottom=18.912, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.6, ups=0.58, wpb=377.2, bsz=32, num_updates=28210, lr=2.16596e-06, gnorm=3.037, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=51989
2022-05-08 10:52:45 - progress_bar.py[line:272] - INFO: epoch 002:  10550 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=379.7, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891855, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.811, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.8, ups=0.58, wpb=379.7, bsz=32, num_updates=28220, lr=2.16296e-06, gnorm=3.378, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52006
2022-05-08 10:53:05 - progress_bar.py[line:272] - INFO: epoch 002:  10560 / 17711 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=1.014, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878735, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.213, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.782, expert1_balance_bottom=18.706, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.02, wps=193.3, ups=0.5, wpb=383.6, bsz=32, num_updates=28230, lr=2.15995e-06, gnorm=3.369, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52026
2022-05-08 10:53:23 - progress_bar.py[line:272] - INFO: epoch 002:  10570 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=375.7, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.978, expert1_balance_bottom=19.146, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=212.8, ups=0.57, wpb=375.7, bsz=32, num_updates=28240, lr=2.15695e-06, gnorm=3.19, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52044
2022-05-08 10:53:41 - progress_bar.py[line:272] - INFO: epoch 002:  10580 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=378.5, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892307, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.866, expert1_balance_bottom=19.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=208.8, ups=0.55, wpb=378.5, bsz=32, num_updates=28250, lr=2.15395e-06, gnorm=3.64, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52062
2022-05-08 10:54:00 - progress_bar.py[line:272] - INFO: epoch 002:  10590 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=379.6, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=35.399, expert1_balance_bottom=18.626, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=200.8, ups=0.53, wpb=379.6, bsz=32, num_updates=28260, lr=2.15094e-06, gnorm=3.405, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52081
2022-05-08 10:54:21 - progress_bar.py[line:272] - INFO: epoch 002:  10600 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=382.4, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889331, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.825, expert1_balance_bottom=19.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=180, ups=0.47, wpb=382.4, bsz=32, num_updates=28270, lr=2.14794e-06, gnorm=3.124, loss_scale=128, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52102
2022-05-08 10:54:38 - progress_bar.py[line:272] - INFO: epoch 002:  10610 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.269, expert1_balance_bottom=19.051, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.4, ups=0.58, wpb=378.8, bsz=32, num_updates=28280, lr=2.14494e-06, gnorm=3.204, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52119
2022-05-08 10:54:55 - progress_bar.py[line:272] - INFO: epoch 002:  10620 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=390.4, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=35.123, expert1_balance_bottom=19.031, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=228.9, ups=0.59, wpb=390.4, bsz=32, num_updates=28290, lr=2.14193e-06, gnorm=3.45, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52136
2022-05-08 10:55:13 - progress_bar.py[line:272] - INFO: epoch 002:  10630 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=387.2, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878118, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=35.045, expert1_balance_bottom=18.737, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.6, ups=0.58, wpb=387.2, bsz=32, num_updates=28300, lr=2.13893e-06, gnorm=2.962, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52153
2022-05-08 10:55:30 - progress_bar.py[line:272] - INFO: epoch 002:  10640 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=391.8, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889077, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.021, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=229.6, ups=0.59, wpb=391.8, bsz=32, num_updates=28310, lr=2.13593e-06, gnorm=2.945, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52170
2022-05-08 10:55:47 - progress_bar.py[line:272] - INFO: epoch 002:  10650 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=380.7, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.178, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.1, ups=0.58, wpb=380.7, bsz=32, num_updates=28320, lr=2.13292e-06, gnorm=3.215, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52188
2022-05-08 10:56:05 - progress_bar.py[line:272] - INFO: epoch 002:  10660 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=386.1, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=35.482, expert1_balance_bottom=18.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=209.5, ups=0.54, wpb=386.1, bsz=32, num_updates=28330, lr=2.12992e-06, gnorm=3.405, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52206
2022-05-08 10:56:25 - progress_bar.py[line:272] - INFO: epoch 002:  10670 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=380.9, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874062, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.146, expert1_balance_bottom=18.788, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=191.5, ups=0.5, wpb=380.9, bsz=32, num_updates=28340, lr=2.12692e-06, gnorm=3.461, loss_scale=128, train_wall=18, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=52226
2022-05-08 10:56:44 - progress_bar.py[line:272] - INFO: epoch 002:  10680 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=377.1, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.421, expert1_balance_bottom=19.193, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=205.8, ups=0.55, wpb=377.1, bsz=32, num_updates=28350, lr=2.12392e-06, gnorm=3.525, loss_scale=128, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=52244
2022-05-08 10:57:04 - progress_bar.py[line:272] - INFO: epoch 002:  10690 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=385.4, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889352, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.886, expert1_balance_bottom=19.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=186.8, ups=0.48, wpb=385.4, bsz=32, num_updates=28360, lr=2.12091e-06, gnorm=3.534, loss_scale=128, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52265
2022-05-08 10:57:22 - progress_bar.py[line:272] - INFO: epoch 002:  10700 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=386.4, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877386, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.793, expert1_balance_bottom=18.913, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=224, ups=0.58, wpb=386.4, bsz=32, num_updates=28370, lr=2.11791e-06, gnorm=3.312, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=52282
2022-05-08 10:57:40 - progress_bar.py[line:272] - INFO: epoch 002:  10710 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.246, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=205.6, ups=0.54, wpb=381.1, bsz=32, num_updates=28380, lr=2.11491e-06, gnorm=3.321, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52301
2022-05-08 10:57:59 - progress_bar.py[line:272] - INFO: epoch 002:  10720 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=380.3, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887031, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.582, expert1_balance_bottom=19.132, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=200.4, ups=0.53, wpb=380.3, bsz=32, num_updates=28390, lr=2.1119e-06, gnorm=3.144, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52320
2022-05-08 10:58:17 - progress_bar.py[line:272] - INFO: epoch 002:  10730 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=381, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.973, expert1_balance_bottom=18.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=215.9, ups=0.57, wpb=381, bsz=32, num_updates=28400, lr=2.1089e-06, gnorm=3.741, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52337
2022-05-08 10:58:35 - progress_bar.py[line:272] - INFO: epoch 002:  10740 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.505, expert1_balance_bottom=19.041, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=202, ups=0.53, wpb=379.5, bsz=32, num_updates=28410, lr=2.1059e-06, gnorm=3.661, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52356
2022-05-08 10:58:54 - progress_bar.py[line:272] - INFO: epoch 002:  10750 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=377.7, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.533, expert1_balance_bottom=19.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=204.2, ups=0.54, wpb=377.7, bsz=32, num_updates=28420, lr=2.10289e-06, gnorm=2.913, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52375
2022-05-08 10:59:13 - progress_bar.py[line:272] - INFO: epoch 002:  10760 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=386.7, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882419, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.713, expert1_balance_bottom=18.825, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=204.9, ups=0.53, wpb=386.7, bsz=32, num_updates=28430, lr=2.09989e-06, gnorm=3.779, loss_scale=128, train_wall=18, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=52394
2022-05-08 10:59:34 - progress_bar.py[line:272] - INFO: epoch 002:  10770 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.291, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=180.2, ups=0.47, wpb=383.6, bsz=32, num_updates=28440, lr=2.09689e-06, gnorm=3.481, loss_scale=128, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52415
2022-05-08 10:59:51 - progress_bar.py[line:272] - INFO: epoch 002:  10780 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.889, expert1_balance_bottom=18.889, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=225.8, ups=0.59, wpb=383.9, bsz=32, num_updates=28450, lr=2.09388e-06, gnorm=3.471, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=52432
2022-05-08 11:00:08 - progress_bar.py[line:272] - INFO: epoch 002:  10790 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.435, expert1_balance_bottom=19.059, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=223.3, ups=0.59, wpb=381.4, bsz=32, num_updates=28460, lr=2.09088e-06, gnorm=3.641, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52449
2022-05-08 11:00:25 - progress_bar.py[line:272] - INFO: epoch 002:  10800 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.183, expert1_balance_bottom=18.998, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=226.5, ups=0.59, wpb=384.7, bsz=32, num_updates=28470, lr=2.08788e-06, gnorm=3.074, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52466
2022-05-08 11:00:43 - progress_bar.py[line:272] - INFO: epoch 002:  10810 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882901, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.851, expert1_balance_bottom=19.001, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.3, ups=0.56, wpb=382, bsz=32, num_updates=28480, lr=2.08487e-06, gnorm=2.718, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52484
2022-05-08 11:01:03 - progress_bar.py[line:272] - INFO: epoch 002:  10820 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=384, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.943, expert1_balance_bottom=18.835, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=197.1, ups=0.51, wpb=384, bsz=32, num_updates=28490, lr=2.08187e-06, gnorm=3.602, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52503
2022-05-08 11:01:22 - progress_bar.py[line:272] - INFO: epoch 002:  10830 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=387.6, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.922, expert1_balance_bottom=18.697, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=204.4, ups=0.53, wpb=387.6, bsz=32, num_updates=28500, lr=2.07887e-06, gnorm=3.471, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52522
2022-05-08 11:01:41 - progress_bar.py[line:272] - INFO: epoch 002:  10840 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.554, expert1_balance_bottom=19.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=202.4, ups=0.53, wpb=383.9, bsz=32, num_updates=28510, lr=2.07586e-06, gnorm=3.406, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52541
2022-05-08 11:01:58 - progress_bar.py[line:272] - INFO: epoch 002:  10850 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=385.5, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886238, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.639, expert1_balance_bottom=18.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=220.5, ups=0.57, wpb=385.5, bsz=32, num_updates=28520, lr=2.07286e-06, gnorm=2.868, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52559
2022-05-08 11:02:19 - progress_bar.py[line:272] - INFO: epoch 002:  10860 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=387.7, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879731, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.794, expert1_balance_bottom=19.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=188.5, ups=0.49, wpb=387.7, bsz=32, num_updates=28530, lr=2.06986e-06, gnorm=3.101, loss_scale=128, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52579
2022-05-08 11:02:36 - progress_bar.py[line:272] - INFO: epoch 002:  10870 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=375.4, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.49, expert1_balance_bottom=18.888, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.9, ups=0.58, wpb=375.4, bsz=32, num_updates=28540, lr=2.06685e-06, gnorm=3.475, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52596
2022-05-08 11:02:53 - progress_bar.py[line:272] - INFO: epoch 002:  10880 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=388.8, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882154, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.756, expert1_balance_bottom=18.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.8, ups=0.57, wpb=388.8, bsz=32, num_updates=28550, lr=2.06385e-06, gnorm=3.592, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52614
2022-05-08 11:03:10 - progress_bar.py[line:272] - INFO: epoch 002:  10890 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.718, expert1_balance_bottom=19.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=222.2, ups=0.58, wpb=383, bsz=32, num_updates=28560, lr=2.06085e-06, gnorm=3.313, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52631
2022-05-08 11:03:28 - progress_bar.py[line:272] - INFO: epoch 002:  10900 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=386.6, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878182, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=35.012, expert1_balance_bottom=18.917, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220.7, ups=0.57, wpb=386.6, bsz=32, num_updates=28570, lr=2.05784e-06, gnorm=3.25, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52649
2022-05-08 11:03:48 - progress_bar.py[line:272] - INFO: epoch 002:  10910 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=392.4, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87021, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.242, expert1_balance_bottom=18.746, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=199.8, ups=0.51, wpb=392.4, bsz=32, num_updates=28580, lr=2.05484e-06, gnorm=3.19, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52668
2022-05-08 11:04:05 - progress_bar.py[line:272] - INFO: epoch 002:  10920 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.926, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=217.5, ups=0.57, wpb=380.7, bsz=32, num_updates=28590, lr=2.05184e-06, gnorm=3.542, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52686
2022-05-08 11:04:25 - progress_bar.py[line:272] - INFO: epoch 002:  10930 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890223, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.319, expert1_balance_bottom=18.996, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=185.6, ups=0.49, wpb=378.2, bsz=32, num_updates=28600, lr=2.04883e-06, gnorm=3.294, loss_scale=128, train_wall=19, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=52706
2022-05-08 11:04:43 - progress_bar.py[line:272] - INFO: epoch 002:  10940 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=382.7, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893048, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.173, expert1_balance_bottom=19.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=218.9, ups=0.57, wpb=382.7, bsz=32, num_updates=28610, lr=2.04583e-06, gnorm=3.068, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52724
2022-05-08 11:05:00 - progress_bar.py[line:272] - INFO: epoch 002:  10950 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=388.1, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880742, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.307, expert1_balance_bottom=19.23, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=229.3, ups=0.59, wpb=388.1, bsz=32, num_updates=28620, lr=2.04283e-06, gnorm=3.154, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52741
2022-05-08 11:05:17 - progress_bar.py[line:272] - INFO: epoch 002:  10960 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871557, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.471, expert1_balance_bottom=18.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.3, ups=0.59, wpb=382.9, bsz=32, num_updates=28630, lr=2.03982e-06, gnorm=3.524, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52757
2022-05-08 11:05:34 - progress_bar.py[line:272] - INFO: epoch 002:  10970 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=378.6, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891322, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.371, expert1_balance_bottom=19.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.6, ups=0.58, wpb=378.6, bsz=32, num_updates=28640, lr=2.03682e-06, gnorm=3.62, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52775
2022-05-08 11:05:51 - progress_bar.py[line:272] - INFO: epoch 002:  10980 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=390, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879037, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.94, expert1_balance_bottom=18.88, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=231, ups=0.59, wpb=390, bsz=32, num_updates=28650, lr=2.03382e-06, gnorm=3.106, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52792
2022-05-08 11:06:10 - progress_bar.py[line:272] - INFO: epoch 002:  10990 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=383.5, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87882, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=35.188, expert1_balance_bottom=18.798, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=195.3, ups=0.51, wpb=383.5, bsz=32, num_updates=28660, lr=2.03081e-06, gnorm=3.494, loss_scale=256, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52811
2022-05-08 11:06:28 - progress_bar.py[line:272] - INFO: epoch 002:  11000 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883397, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=35.003, expert1_balance_bottom=18.742, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.8, ups=0.55, wpb=379.9, bsz=32, num_updates=28670, lr=2.02781e-06, gnorm=3.904, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52829
2022-05-08 11:06:46 - progress_bar.py[line:272] - INFO: epoch 002:  11010 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=378.1, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882717, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.946, expert1_balance_bottom=18.724, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=216.6, ups=0.57, wpb=378.1, bsz=32, num_updates=28680, lr=2.02481e-06, gnorm=3.489, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52847
2022-05-08 11:07:07 - progress_bar.py[line:272] - INFO: epoch 002:  11020 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88704, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.105, expert1_balance_bottom=19.056, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=180, ups=0.47, wpb=382.1, bsz=32, num_updates=28690, lr=2.0218e-06, gnorm=3.318, loss_scale=256, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52868
2022-05-08 11:07:27 - progress_bar.py[line:272] - INFO: epoch 002:  11030 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=375.6, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894545, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.195, expert1_balance_bottom=19.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=193.1, ups=0.51, wpb=375.6, bsz=32, num_updates=28700, lr=2.0188e-06, gnorm=3.135, loss_scale=256, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52887
2022-05-08 11:07:44 - progress_bar.py[line:272] - INFO: epoch 002:  11040 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=380.2, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.532, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.9, ups=0.56, wpb=380.2, bsz=32, num_updates=28710, lr=2.0158e-06, gnorm=3.423, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52905
2022-05-08 11:08:05 - progress_bar.py[line:272] - INFO: epoch 002:  11050 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.207, expert1_balance_bottom=18.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=186.8, ups=0.49, wpb=381.9, bsz=32, num_updates=28720, lr=2.01279e-06, gnorm=3.154, loss_scale=256, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52926
2022-05-08 11:08:23 - progress_bar.py[line:272] - INFO: epoch 002:  11060 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=378.7, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890153, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.293, expert1_balance_bottom=19.122, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.3, ups=0.57, wpb=378.7, bsz=32, num_updates=28730, lr=2.00979e-06, gnorm=3.453, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52943
2022-05-08 11:08:43 - progress_bar.py[line:272] - INFO: epoch 002:  11070 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=389.7, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=35.32, expert1_balance_bottom=18.758, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=191.8, ups=0.49, wpb=389.7, bsz=32, num_updates=28740, lr=2.00679e-06, gnorm=3.037, loss_scale=256, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52964
2022-05-08 11:09:01 - progress_bar.py[line:272] - INFO: epoch 002:  11080 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88393, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.256, expert1_balance_bottom=19.095, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.3, ups=0.55, wpb=382.8, bsz=32, num_updates=28750, lr=2.00378e-06, gnorm=3.497, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=52982
2022-05-08 11:09:20 - progress_bar.py[line:272] - INFO: epoch 002:  11090 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883328, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.949, expert1_balance_bottom=18.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=205.1, ups=0.54, wpb=380.3, bsz=32, num_updates=28760, lr=2.00078e-06, gnorm=2.978, loss_scale=256, train_wall=18, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=53000
2022-05-08 11:09:39 - progress_bar.py[line:272] - INFO: epoch 002:  11100 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883059, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.795, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=193.6, ups=0.51, wpb=382.2, bsz=32, num_updates=28770, lr=1.99778e-06, gnorm=3.452, loss_scale=256, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53020
2022-05-08 11:09:41 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 11:09:58 - progress_bar.py[line:272] - INFO: epoch 002:  11111 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.951, expert1_balance_bottom=19.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=201.5, ups=0.53, wpb=380.6, bsz=32, num_updates=28780, lr=1.99477e-06, gnorm=3.623, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53039
2022-05-08 11:10:15 - progress_bar.py[line:272] - INFO: epoch 002:  11121 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=384.8, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.794, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.5, ups=0.59, wpb=384.8, bsz=32, num_updates=28790, lr=1.99177e-06, gnorm=3.179, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=53056
2022-05-08 11:10:32 - progress_bar.py[line:272] - INFO: epoch 002:  11131 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=385.8, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895944, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.95, expert1_balance_bottom=19.228, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.9, ups=0.59, wpb=385.8, bsz=32, num_updates=28800, lr=1.98877e-06, gnorm=3.568, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53073
2022-05-08 11:10:49 - progress_bar.py[line:272] - INFO: epoch 002:  11141 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886232, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.545, expert1_balance_bottom=19.038, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226.2, ups=0.59, wpb=380.7, bsz=32, num_updates=28810, lr=1.98576e-06, gnorm=3.279, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53090
2022-05-08 11:11:06 - progress_bar.py[line:272] - INFO: epoch 002:  11151 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=379.5, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.763, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.5, ups=0.59, wpb=379.5, bsz=32, num_updates=28820, lr=1.98276e-06, gnorm=3.104, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=53107
2022-05-08 11:11:23 - progress_bar.py[line:272] - INFO: epoch 002:  11161 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885321, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.487, expert1_balance_bottom=18.968, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222, ups=0.58, wpb=382.4, bsz=32, num_updates=28830, lr=1.97976e-06, gnorm=3.369, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53124
2022-05-08 11:11:40 - progress_bar.py[line:272] - INFO: epoch 002:  11171 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=387.2, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881302, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.316, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.4, ups=0.58, wpb=387.2, bsz=32, num_updates=28840, lr=1.97675e-06, gnorm=3.225, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53141
2022-05-08 11:11:57 - progress_bar.py[line:272] - INFO: epoch 002:  11181 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889867, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.364, expert1_balance_bottom=18.974, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=223.2, ups=0.59, wpb=380, bsz=32, num_updates=28850, lr=1.97375e-06, gnorm=3.258, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53158
2022-05-08 11:12:15 - progress_bar.py[line:272] - INFO: epoch 002:  11191 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=376.9, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.086, expert1_balance_bottom=19.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=219.5, ups=0.58, wpb=376.9, bsz=32, num_updates=28860, lr=1.97075e-06, gnorm=3.212, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53175
2022-05-08 11:12:32 - progress_bar.py[line:272] - INFO: epoch 002:  11201 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=35.119, expert1_balance_bottom=18.741, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.6, ups=0.58, wpb=380, bsz=32, num_updates=28870, lr=1.96774e-06, gnorm=3.466, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53193
2022-05-08 11:12:49 - progress_bar.py[line:272] - INFO: epoch 002:  11211 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=393.9, nsentences=32, sample_size=313.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.735, expert1_balance_bottom=18.554, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=228.7, ups=0.58, wpb=393.9, bsz=32, num_updates=28880, lr=1.96474e-06, gnorm=3.062, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53210
2022-05-08 11:12:53 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 11:13:08 - progress_bar.py[line:272] - INFO: epoch 002:  11222 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=378.3, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889435, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.145, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=198.6, ups=0.52, wpb=378.3, bsz=32, num_updates=28890, lr=1.96174e-06, gnorm=3.441, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53229
2022-05-08 11:13:26 - progress_bar.py[line:272] - INFO: epoch 002:  11232 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879388, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.699, expert1_balance_bottom=18.916, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221.3, ups=0.58, wpb=383.9, bsz=32, num_updates=28900, lr=1.95874e-06, gnorm=2.742, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53246
2022-05-08 11:13:42 - progress_bar.py[line:272] - INFO: epoch 002:  11242 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=378.1, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879826, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=35.047, expert1_balance_bottom=18.76, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.2, ups=0.59, wpb=378.1, bsz=32, num_updates=28910, lr=1.95573e-06, gnorm=3.558, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=53263
2022-05-08 11:13:59 - progress_bar.py[line:272] - INFO: epoch 002:  11252 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=376.5, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894843, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.755, expert1_balance_bottom=19.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.4, ups=0.59, wpb=376.5, bsz=32, num_updates=28920, lr=1.95273e-06, gnorm=2.987, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53280
2022-05-08 11:14:16 - progress_bar.py[line:272] - INFO: epoch 002:  11262 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=386, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872665, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=35.069, expert1_balance_bottom=18.836, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=233.4, ups=0.6, wpb=386, bsz=32, num_updates=28930, lr=1.94973e-06, gnorm=3.303, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53297
2022-05-08 11:14:33 - progress_bar.py[line:272] - INFO: epoch 002:  11272 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.99, expert1_balance_bottom=18.84, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=217.2, ups=0.57, wpb=380.6, bsz=32, num_updates=28940, lr=1.94672e-06, gnorm=3.568, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53314
2022-05-08 11:14:51 - progress_bar.py[line:272] - INFO: epoch 002:  11282 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=391.6, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.66, expert1_balance_bottom=18.873, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=228.2, ups=0.58, wpb=391.6, bsz=32, num_updates=28950, lr=1.94372e-06, gnorm=3.105, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53331
2022-05-08 11:15:08 - progress_bar.py[line:272] - INFO: epoch 002:  11292 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.935, expert1_balance_bottom=18.814, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=223.5, ups=0.58, wpb=382.6, bsz=32, num_updates=28960, lr=1.94072e-06, gnorm=3.074, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53348
2022-05-08 11:15:25 - progress_bar.py[line:272] - INFO: epoch 002:  11302 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=377, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.658, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.4, ups=0.58, wpb=377, bsz=32, num_updates=28970, lr=1.93771e-06, gnorm=3.139, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53366
2022-05-08 11:15:42 - progress_bar.py[line:272] - INFO: epoch 002:  11312 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=385.2, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.948, expert1_balance_bottom=18.934, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=220.3, ups=0.57, wpb=385.2, bsz=32, num_updates=28980, lr=1.93471e-06, gnorm=3.092, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53383
2022-05-08 11:15:59 - progress_bar.py[line:272] - INFO: epoch 002:  11322 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882064, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.5, expert1_balance_bottom=18.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=227.8, ups=0.59, wpb=386.3, bsz=32, num_updates=28990, lr=1.93171e-06, gnorm=3.29, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53400
2022-05-08 11:16:16 - progress_bar.py[line:272] - INFO: epoch 002:  11332 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=387.5, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889478, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.437, expert1_balance_bottom=18.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=228.3, ups=0.59, wpb=387.5, bsz=32, num_updates=29000, lr=1.9287e-06, gnorm=3.293, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53417
2022-05-08 11:16:33 - progress_bar.py[line:272] - INFO: epoch 002:  11342 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=378.2, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876776, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.935, expert1_balance_bottom=18.944, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221.9, ups=0.59, wpb=378.2, bsz=32, num_updates=29010, lr=1.9257e-06, gnorm=3.533, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53434
2022-05-08 11:16:51 - progress_bar.py[line:272] - INFO: epoch 002:  11352 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=375.3, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.843, expert1_balance_bottom=18.809, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=215, ups=0.57, wpb=375.3, bsz=32, num_updates=29020, lr=1.9227e-06, gnorm=2.998, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53452
2022-05-08 11:17:08 - progress_bar.py[line:272] - INFO: epoch 002:  11362 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.973, expert1_balance_bottom=19.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=222.1, ups=0.59, wpb=378.2, bsz=32, num_updates=29030, lr=1.91969e-06, gnorm=2.892, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=53469
2022-05-08 11:17:25 - progress_bar.py[line:272] - INFO: epoch 002:  11372 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.975, ntokens=380.3, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887388, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.264, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=221.1, ups=0.58, wpb=380.3, bsz=32, num_updates=29040, lr=1.91669e-06, gnorm=3.522, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53486
2022-05-08 11:17:42 - progress_bar.py[line:272] - INFO: epoch 002:  11382 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895021, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.782, expert1_balance_bottom=19.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=225, ups=0.58, wpb=386, bsz=32, num_updates=29050, lr=1.91369e-06, gnorm=3.157, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53503
2022-05-08 11:18:00 - progress_bar.py[line:272] - INFO: epoch 002:  11392 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=379.9, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882509, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.601, expert1_balance_bottom=18.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217.6, ups=0.57, wpb=379.9, bsz=32, num_updates=29060, lr=1.91068e-06, gnorm=3.532, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53520
2022-05-08 11:18:17 - progress_bar.py[line:272] - INFO: epoch 002:  11402 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=387.7, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884182, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.377, expert1_balance_bottom=19.265, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.8, ups=0.58, wpb=387.7, bsz=32, num_updates=29070, lr=1.90768e-06, gnorm=3.443, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53537
2022-05-08 11:18:34 - progress_bar.py[line:272] - INFO: epoch 002:  11412 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=387, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878779, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.832, expert1_balance_bottom=18.939, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.7, ups=0.58, wpb=387, bsz=32, num_updates=29080, lr=1.90468e-06, gnorm=3.222, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53555
2022-05-08 11:18:51 - progress_bar.py[line:272] - INFO: epoch 002:  11422 / 17711 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.189, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.883, expert1_balance_bottom=19.164, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=227.6, ups=0.59, wpb=386.3, bsz=32, num_updates=29090, lr=1.90167e-06, gnorm=3.568, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53572
2022-05-08 11:19:08 - progress_bar.py[line:272] - INFO: epoch 002:  11432 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873898, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.888, expert1_balance_bottom=19.004, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224.3, ups=0.59, wpb=382.3, bsz=32, num_updates=29100, lr=1.89867e-06, gnorm=3.338, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53589
2022-05-08 11:19:25 - progress_bar.py[line:272] - INFO: epoch 002:  11442 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=392.9, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.725, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=230.6, ups=0.59, wpb=392.9, bsz=32, num_updates=29110, lr=1.89567e-06, gnorm=3.496, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53606
2022-05-08 11:19:42 - progress_bar.py[line:272] - INFO: epoch 002:  11452 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=383.9, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879684, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.752, expert1_balance_bottom=18.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=225.2, ups=0.59, wpb=383.9, bsz=32, num_updates=29120, lr=1.89266e-06, gnorm=4.464, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53623
2022-05-08 11:19:59 - progress_bar.py[line:272] - INFO: epoch 002:  11462 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883769, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.613, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222, ups=0.58, wpb=383.2, bsz=32, num_updates=29130, lr=1.88966e-06, gnorm=3.611, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53640
2022-05-08 11:20:17 - progress_bar.py[line:272] - INFO: epoch 002:  11472 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=397.9, nsentences=32, sample_size=316.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870978, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.3, expert1_balance_bottom=18.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=232.8, ups=0.59, wpb=397.9, bsz=32, num_updates=29140, lr=1.88666e-06, gnorm=3.395, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53657
2022-05-08 11:20:33 - progress_bar.py[line:272] - INFO: epoch 002:  11482 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=391, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.792, expert1_balance_bottom=18.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=230.6, ups=0.59, wpb=391, bsz=32, num_updates=29150, lr=1.88365e-06, gnorm=3.386, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53674
2022-05-08 11:20:50 - progress_bar.py[line:272] - INFO: epoch 002:  11492 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=391.8, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885066, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.389, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=232.9, ups=0.59, wpb=391.8, bsz=32, num_updates=29160, lr=1.88065e-06, gnorm=3.211, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53691
2022-05-08 11:21:07 - progress_bar.py[line:272] - INFO: epoch 002:  11502 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876721, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.578, expert1_balance_bottom=18.953, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=229, ups=0.59, wpb=388.2, bsz=32, num_updates=29170, lr=1.87765e-06, gnorm=3.497, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53708
2022-05-08 11:21:24 - progress_bar.py[line:272] - INFO: epoch 002:  11512 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.979, ntokens=393.1, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.946, expert1_balance_bottom=18.901, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=238.2, ups=0.61, wpb=393.1, bsz=32, num_updates=29180, lr=1.87464e-06, gnorm=3.491, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53725
2022-05-08 11:21:41 - progress_bar.py[line:272] - INFO: epoch 002:  11522 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.241, expert1_balance_bottom=19.259, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=227.8, ups=0.6, wpb=381.9, bsz=32, num_updates=29190, lr=1.87164e-06, gnorm=3.234, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53741
2022-05-08 11:21:58 - progress_bar.py[line:272] - INFO: epoch 002:  11532 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896547, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.856, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=223.4, ups=0.58, wpb=382.5, bsz=32, num_updates=29200, lr=1.86864e-06, gnorm=4.991, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53758
2022-05-08 11:22:15 - progress_bar.py[line:272] - INFO: epoch 002:  11542 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=380.7, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868562, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.744, expert1_balance_bottom=18.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=221, ups=0.58, wpb=380.7, bsz=32, num_updates=29210, lr=1.86563e-06, gnorm=3.467, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53776
2022-05-08 11:22:32 - progress_bar.py[line:272] - INFO: epoch 002:  11552 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=387.6, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877764, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.799, expert1_balance_bottom=18.821, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.4, ups=0.58, wpb=387.6, bsz=32, num_updates=29220, lr=1.86263e-06, gnorm=3.196, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53793
2022-05-08 11:22:49 - progress_bar.py[line:272] - INFO: epoch 002:  11562 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875172, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=35.344, expert1_balance_bottom=18.637, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=220.8, ups=0.57, wpb=385.6, bsz=32, num_updates=29230, lr=1.85963e-06, gnorm=3.777, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53810
2022-05-08 11:23:06 - progress_bar.py[line:272] - INFO: epoch 002:  11572 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883614, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.448, expert1_balance_bottom=19.037, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.2, ups=0.59, wpb=385.7, bsz=32, num_updates=29240, lr=1.85662e-06, gnorm=3.52, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53827
2022-05-08 11:23:23 - progress_bar.py[line:272] - INFO: epoch 002:  11582 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.657, expert1_balance_bottom=18.959, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=227.3, ups=0.59, wpb=386.5, bsz=32, num_updates=29250, lr=1.85362e-06, gnorm=4.231, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53844
2022-05-08 11:23:40 - progress_bar.py[line:272] - INFO: epoch 002:  11592 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=375.1, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887045, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.721, expert1_balance_bottom=18.819, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=219.2, ups=0.58, wpb=375.1, bsz=32, num_updates=29260, lr=1.85062e-06, gnorm=3.48, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53861
2022-05-08 11:23:57 - progress_bar.py[line:272] - INFO: epoch 002:  11602 / 17711 loss=3.164, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=382.8, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.164, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.458, expert1_balance_bottom=18.927, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=226.8, ups=0.59, wpb=382.8, bsz=32, num_updates=29270, lr=1.84761e-06, gnorm=3.172, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=53878
2022-05-08 11:24:14 - progress_bar.py[line:272] - INFO: epoch 002:  11612 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878919, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.894, expert1_balance_bottom=19.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=228.2, ups=0.6, wpb=381.3, bsz=32, num_updates=29280, lr=1.84461e-06, gnorm=3.401, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53895
2022-05-08 11:24:31 - progress_bar.py[line:272] - INFO: epoch 002:  11622 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.957, ntokens=375.6, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.918, expert1_balance_bottom=19.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=226.2, ups=0.6, wpb=375.6, bsz=32, num_updates=29290, lr=1.84161e-06, gnorm=3.702, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53911
2022-05-08 11:24:48 - progress_bar.py[line:272] - INFO: epoch 002:  11632 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=390.5, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.965, expert1_balance_bottom=19.385, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=230.8, ups=0.59, wpb=390.5, bsz=32, num_updates=29300, lr=1.8386e-06, gnorm=3.762, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53928
2022-05-08 11:25:05 - progress_bar.py[line:272] - INFO: epoch 002:  11642 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=382.1, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881431, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.808, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.6, ups=0.58, wpb=382.1, bsz=32, num_updates=29310, lr=1.8356e-06, gnorm=3.549, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53946
2022-05-08 11:25:22 - progress_bar.py[line:272] - INFO: epoch 002:  11652 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=387.3, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.294, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.4, ups=0.59, wpb=387.3, bsz=32, num_updates=29320, lr=1.8326e-06, gnorm=4.25, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53963
2022-05-08 11:25:39 - progress_bar.py[line:272] - INFO: epoch 002:  11662 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880094, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.996, expert1_balance_bottom=18.677, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226.5, ups=0.59, wpb=382.8, bsz=32, num_updates=29330, lr=1.82959e-06, gnorm=3.43, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53980
2022-05-08 11:25:56 - progress_bar.py[line:272] - INFO: epoch 002:  11672 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=378.6, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894115, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.905, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.7, ups=0.59, wpb=378.6, bsz=32, num_updates=29340, lr=1.82659e-06, gnorm=3.262, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=53997
2022-05-08 11:26:13 - progress_bar.py[line:272] - INFO: epoch 002:  11682 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=374.2, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.634, expert1_balance_bottom=19.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=219.5, ups=0.59, wpb=374.2, bsz=32, num_updates=29350, lr=1.82359e-06, gnorm=3.853, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54014
2022-05-08 11:26:30 - progress_bar.py[line:272] - INFO: epoch 002:  11692 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.951, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=223.9, ups=0.58, wpb=386.3, bsz=32, num_updates=29360, lr=1.82058e-06, gnorm=3.638, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54031
2022-05-08 11:26:47 - progress_bar.py[line:272] - INFO: epoch 002:  11702 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904174, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=33.284, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=226, ups=0.6, wpb=377.2, bsz=32, num_updates=29370, lr=1.81758e-06, gnorm=3.873, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54048
2022-05-08 11:27:04 - progress_bar.py[line:272] - INFO: epoch 002:  11712 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=376.3, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895945, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.486, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=219.5, ups=0.58, wpb=376.3, bsz=32, num_updates=29380, lr=1.81458e-06, gnorm=3.139, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=54065
2022-05-08 11:27:21 - progress_bar.py[line:272] - INFO: epoch 002:  11722 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.464, expert1_balance_bottom=19.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.8, ups=0.58, wpb=378.7, bsz=32, num_updates=29390, lr=1.81157e-06, gnorm=3.402, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54082
2022-05-08 11:27:38 - progress_bar.py[line:272] - INFO: epoch 002:  11732 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.47, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=222.6, ups=0.58, wpb=381.8, bsz=32, num_updates=29400, lr=1.80857e-06, gnorm=3.483, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54099
2022-05-08 11:27:56 - progress_bar.py[line:272] - INFO: epoch 002:  11742 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.126, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222, ups=0.58, wpb=384.1, bsz=32, num_updates=29410, lr=1.80557e-06, gnorm=3.323, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54117
2022-05-08 11:28:13 - progress_bar.py[line:272] - INFO: epoch 002:  11752 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884431, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.584, expert1_balance_bottom=18.959, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=225.6, ups=0.58, wpb=386.1, bsz=32, num_updates=29420, lr=1.80256e-06, gnorm=3.22, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54134
2022-05-08 11:28:30 - progress_bar.py[line:272] - INFO: epoch 002:  11762 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.765, expert1_balance_bottom=19.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=225.1, ups=0.59, wpb=379.6, bsz=32, num_updates=29430, lr=1.79956e-06, gnorm=3.165, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54151
2022-05-08 11:28:46 - progress_bar.py[line:272] - INFO: epoch 002:  11772 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.336, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=229.2, ups=0.6, wpb=379.7, bsz=32, num_updates=29440, lr=1.79656e-06, gnorm=3.193, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54167
2022-05-08 11:29:03 - progress_bar.py[line:272] - INFO: epoch 002:  11782 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.789, expert1_balance_bottom=18.948, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226, ups=0.59, wpb=383, bsz=32, num_updates=29450, lr=1.79355e-06, gnorm=3.794, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54184
2022-05-08 11:29:20 - progress_bar.py[line:272] - INFO: epoch 002:  11792 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=383.8, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889519, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.272, expert1_balance_bottom=18.938, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=225.2, ups=0.59, wpb=383.8, bsz=32, num_updates=29460, lr=1.79055e-06, gnorm=3.208, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54201
2022-05-08 11:29:38 - progress_bar.py[line:272] - INFO: epoch 002:  11802 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=378.3, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882469, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.801, expert1_balance_bottom=18.917, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=218.3, ups=0.58, wpb=378.3, bsz=32, num_updates=29470, lr=1.78755e-06, gnorm=3.324, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54218
2022-05-08 11:29:55 - progress_bar.py[line:272] - INFO: epoch 002:  11812 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894782, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.856, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.8, ups=0.59, wpb=382.4, bsz=32, num_updates=29480, lr=1.78455e-06, gnorm=3.782, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54235
2022-05-08 11:30:12 - progress_bar.py[line:272] - INFO: epoch 002:  11822 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.282, expert1_balance_bottom=19.145, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.4, ups=0.58, wpb=385.5, bsz=32, num_updates=29490, lr=1.78154e-06, gnorm=3.155, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54253
2022-05-08 11:30:29 - progress_bar.py[line:272] - INFO: epoch 002:  11832 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=382, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.16, expert1_balance_bottom=19.067, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=227.4, ups=0.6, wpb=382, bsz=32, num_updates=29500, lr=1.77854e-06, gnorm=4.115, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54269
2022-05-08 11:30:46 - progress_bar.py[line:272] - INFO: epoch 002:  11842 / 17711 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.991, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.201, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.094, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.5, ups=0.59, wpb=380.7, bsz=32, num_updates=29510, lr=1.77554e-06, gnorm=3.485, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54286
2022-05-08 11:31:03 - progress_bar.py[line:272] - INFO: epoch 002:  11852 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.959, ntokens=389.5, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.859683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=36.31, expert1_balance_bottom=18.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=224.1, ups=0.58, wpb=389.5, bsz=32, num_updates=29520, lr=1.77253e-06, gnorm=3.479, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54304
2022-05-08 11:31:20 - progress_bar.py[line:272] - INFO: epoch 002:  11862 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88209, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.773, expert1_balance_bottom=18.829, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.2, ups=0.59, wpb=381.2, bsz=32, num_updates=29530, lr=1.76953e-06, gnorm=3.999, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54321
2022-05-08 11:31:37 - progress_bar.py[line:272] - INFO: epoch 002:  11872 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.321, expert1_balance_bottom=19.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.5, ups=0.58, wpb=384.8, bsz=32, num_updates=29540, lr=1.76653e-06, gnorm=3.008, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54338
2022-05-08 11:31:54 - progress_bar.py[line:272] - INFO: epoch 002:  11882 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883068, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.507, expert1_balance_bottom=19.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.6, ups=0.59, wpb=382.8, bsz=32, num_updates=29550, lr=1.76352e-06, gnorm=3.126, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54355
2022-05-08 11:32:11 - progress_bar.py[line:272] - INFO: epoch 002:  11892 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=392.7, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.577, expert1_balance_bottom=19.035, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=231.1, ups=0.59, wpb=392.7, bsz=32, num_updates=29560, lr=1.76052e-06, gnorm=3.459, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54372
2022-05-08 11:32:28 - progress_bar.py[line:272] - INFO: epoch 002:  11902 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.781, expert1_balance_bottom=18.799, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=225, ups=0.59, wpb=382.2, bsz=32, num_updates=29570, lr=1.75752e-06, gnorm=3.965, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54389
2022-05-08 11:32:45 - progress_bar.py[line:272] - INFO: epoch 002:  11912 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886581, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.635, expert1_balance_bottom=18.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.6, ups=0.58, wpb=381, bsz=32, num_updates=29580, lr=1.75451e-06, gnorm=3.26, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54406
2022-05-08 11:33:02 - progress_bar.py[line:272] - INFO: epoch 002:  11922 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=386.1, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.549, expert1_balance_bottom=18.986, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.2, ups=0.59, wpb=386.1, bsz=32, num_updates=29590, lr=1.75151e-06, gnorm=3.371, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54423
2022-05-08 11:33:19 - progress_bar.py[line:272] - INFO: epoch 002:  11932 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=379.6, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.994, expert1_balance_bottom=18.756, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=224.9, ups=0.59, wpb=379.6, bsz=32, num_updates=29600, lr=1.74851e-06, gnorm=3.055, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54440
2022-05-08 11:33:36 - progress_bar.py[line:272] - INFO: epoch 002:  11942 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.959, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888804, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.368, expert1_balance_bottom=18.998, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=226.2, ups=0.59, wpb=385, bsz=32, num_updates=29610, lr=1.7455e-06, gnorm=3.2, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54457
2022-05-08 11:33:54 - progress_bar.py[line:272] - INFO: epoch 002:  11952 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=383.7, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.725, expert1_balance_bottom=19.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=220, ups=0.57, wpb=383.7, bsz=32, num_updates=29620, lr=1.7425e-06, gnorm=3.846, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54474
2022-05-08 11:34:11 - progress_bar.py[line:272] - INFO: epoch 002:  11962 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875968, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.321, expert1_balance_bottom=18.9, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.1, ups=0.59, wpb=381.9, bsz=32, num_updates=29630, lr=1.7395e-06, gnorm=3.479, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54491
2022-05-08 11:34:28 - progress_bar.py[line:272] - INFO: epoch 002:  11972 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=377.7, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877174, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.875, expert1_balance_bottom=18.987, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.2, ups=0.59, wpb=377.7, bsz=32, num_updates=29640, lr=1.73649e-06, gnorm=3.927, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54508
2022-05-08 11:34:45 - progress_bar.py[line:272] - INFO: epoch 002:  11982 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=378.9, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.867, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.1, ups=0.59, wpb=378.9, bsz=32, num_updates=29650, lr=1.73349e-06, gnorm=2.959, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54525
2022-05-08 11:35:01 - progress_bar.py[line:272] - INFO: epoch 002:  11992 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899383, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.764, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=226.8, ups=0.6, wpb=380.8, bsz=32, num_updates=29660, lr=1.73049e-06, gnorm=3.29, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54542
2022-05-08 11:35:19 - progress_bar.py[line:272] - INFO: epoch 002:  12002 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=382.8, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.314, expert1_balance_bottom=19.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=221.7, ups=0.58, wpb=382.8, bsz=32, num_updates=29670, lr=1.72748e-06, gnorm=3.988, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54559
2022-05-08 11:35:36 - progress_bar.py[line:272] - INFO: epoch 002:  12012 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.812, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=225.2, ups=0.59, wpb=383.5, bsz=32, num_updates=29680, lr=1.72448e-06, gnorm=3.837, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54576
2022-05-08 11:35:53 - progress_bar.py[line:272] - INFO: epoch 002:  12022 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.323, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=222.1, ups=0.59, wpb=378.2, bsz=32, num_updates=29690, lr=1.72148e-06, gnorm=2.853, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54594
2022-05-08 11:36:10 - progress_bar.py[line:272] - INFO: epoch 002:  12032 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=371, nsentences=32, sample_size=295.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883385, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.762, expert1_balance_bottom=19.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.2, ups=0.57, wpb=371, bsz=32, num_updates=29700, lr=1.71847e-06, gnorm=3.795, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54611
2022-05-08 11:36:27 - progress_bar.py[line:272] - INFO: epoch 002:  12042 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=374.6, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=33.362, expert1_balance_bottom=19.343, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=217.9, ups=0.58, wpb=374.6, bsz=32, num_updates=29710, lr=1.71547e-06, gnorm=3.81, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54628
2022-05-08 11:36:44 - progress_bar.py[line:272] - INFO: epoch 002:  12052 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886024, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.339, expert1_balance_bottom=19.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=225.3, ups=0.59, wpb=384.3, bsz=32, num_updates=29720, lr=1.71247e-06, gnorm=3.262, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54645
2022-05-08 11:37:02 - progress_bar.py[line:272] - INFO: epoch 002:  12062 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=379, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893557, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.078, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=218.1, ups=0.58, wpb=379, bsz=32, num_updates=29730, lr=1.70946e-06, gnorm=3.304, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54663
2022-05-08 11:37:19 - progress_bar.py[line:272] - INFO: epoch 002:  12072 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=387.9, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870868, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.176, expert1_balance_bottom=18.955, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=231.5, ups=0.6, wpb=387.9, bsz=32, num_updates=29740, lr=1.70646e-06, gnorm=3.792, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54679
2022-05-08 11:37:36 - progress_bar.py[line:272] - INFO: epoch 002:  12082 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=378.3, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.147, expert1_balance_bottom=18.829, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=217.2, ups=0.57, wpb=378.3, bsz=32, num_updates=29750, lr=1.70346e-06, gnorm=3.262, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54697
2022-05-08 11:37:53 - progress_bar.py[line:272] - INFO: epoch 002:  12092 / 17711 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.991, ntokens=382.9, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.198, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.147, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=225.5, ups=0.59, wpb=382.9, bsz=32, num_updates=29760, lr=1.70045e-06, gnorm=3.659, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54714
2022-05-08 11:38:00 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 11:38:11 - progress_bar.py[line:272] - INFO: epoch 002:  12103 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881254, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.902, expert1_balance_bottom=18.725, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=205.7, ups=0.54, wpb=381.3, bsz=32, num_updates=29770, lr=1.69745e-06, gnorm=3.563, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54732
2022-05-08 11:38:28 - progress_bar.py[line:272] - INFO: epoch 002:  12113 / 17711 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.996, ntokens=387.6, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883037, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.208, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.435, expert1_balance_bottom=19.022, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=227.4, ups=0.59, wpb=387.6, bsz=32, num_updates=29780, lr=1.69445e-06, gnorm=3.843, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54749
2022-05-08 11:38:46 - progress_bar.py[line:272] - INFO: epoch 002:  12123 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.105, expert1_balance_bottom=19.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=225, ups=0.58, wpb=386.6, bsz=32, num_updates=29790, lr=1.69144e-06, gnorm=3.353, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54766
2022-05-08 11:39:03 - progress_bar.py[line:272] - INFO: epoch 002:  12133 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=366.5, nsentences=32, sample_size=291.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.557, expert1_balance_bottom=18.747, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215, ups=0.59, wpb=366.5, bsz=32, num_updates=29800, lr=1.68844e-06, gnorm=3.272, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54784
2022-05-08 11:39:20 - progress_bar.py[line:272] - INFO: epoch 002:  12143 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=387.7, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886668, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.206, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=227.8, ups=0.59, wpb=387.7, bsz=32, num_updates=29810, lr=1.68544e-06, gnorm=3.3, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54801
2022-05-08 11:39:37 - progress_bar.py[line:272] - INFO: epoch 002:  12153 / 17711 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=390.9, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.167, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.292, expert1_balance_bottom=18.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=232.6, ups=0.59, wpb=390.9, bsz=32, num_updates=29820, lr=1.68243e-06, gnorm=3.752, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54817
2022-05-08 11:39:54 - progress_bar.py[line:272] - INFO: epoch 002:  12163 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=381.1, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.733, expert1_balance_bottom=18.873, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=221.2, ups=0.58, wpb=381.1, bsz=32, num_updates=29830, lr=1.67943e-06, gnorm=3.237, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54835
2022-05-08 11:40:11 - progress_bar.py[line:272] - INFO: epoch 002:  12173 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.371, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=227, ups=0.59, wpb=383.1, bsz=32, num_updates=29840, lr=1.67643e-06, gnorm=3.425, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54851
2022-05-08 11:40:28 - progress_bar.py[line:272] - INFO: epoch 002:  12183 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.705, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=225.4, ups=0.59, wpb=382.3, bsz=32, num_updates=29850, lr=1.67342e-06, gnorm=3.649, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54868
2022-05-08 11:40:44 - progress_bar.py[line:272] - INFO: epoch 002:  12193 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=375.1, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892648, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.771, expert1_balance_bottom=19.227, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.9, ups=0.59, wpb=375.1, bsz=32, num_updates=29860, lr=1.67042e-06, gnorm=3.248, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54885
2022-05-08 11:41:01 - progress_bar.py[line:272] - INFO: epoch 002:  12203 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=379.3, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885818, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.539, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=230.9, ups=0.61, wpb=379.3, bsz=32, num_updates=29870, lr=1.66742e-06, gnorm=3.165, loss_scale=64, train_wall=15, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54902
2022-05-08 11:41:17 - progress_bar.py[line:272] - INFO: epoch 002:  12213 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=385.9, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.712, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=232.3, ups=0.6, wpb=385.9, bsz=32, num_updates=29880, lr=1.66441e-06, gnorm=3.675, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54918
2022-05-08 11:41:34 - progress_bar.py[line:272] - INFO: epoch 002:  12223 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=376, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.972, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222.8, ups=0.59, wpb=376, bsz=32, num_updates=29890, lr=1.66141e-06, gnorm=2.99, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=54935
2022-05-08 11:41:51 - progress_bar.py[line:272] - INFO: epoch 002:  12233 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=389.1, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883804, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.372, expert1_balance_bottom=19.135, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.2, ups=0.59, wpb=389.1, bsz=32, num_updates=29900, lr=1.65841e-06, gnorm=3.02, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=54952
2022-05-08 11:42:08 - progress_bar.py[line:272] - INFO: epoch 002:  12243 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=389.4, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.971, expert1_balance_bottom=18.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=231.6, ups=0.59, wpb=389.4, bsz=32, num_updates=29910, lr=1.6554e-06, gnorm=3.199, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54969
2022-05-08 11:42:25 - progress_bar.py[line:272] - INFO: epoch 002:  12253 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=390.3, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870681, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.184, expert1_balance_bottom=18.671, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=230.1, ups=0.59, wpb=390.3, bsz=32, num_updates=29920, lr=1.6524e-06, gnorm=3.255, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=54986
2022-05-08 11:42:42 - progress_bar.py[line:272] - INFO: epoch 002:  12263 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.967, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881919, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.853, expert1_balance_bottom=18.848, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=226.3, ups=0.59, wpb=386.3, bsz=32, num_updates=29930, lr=1.6494e-06, gnorm=3.748, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55003
2022-05-08 11:42:59 - progress_bar.py[line:272] - INFO: epoch 002:  12273 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.57, expert1_balance_bottom=18.957, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=229.3, ups=0.6, wpb=383.3, bsz=32, num_updates=29940, lr=1.64639e-06, gnorm=3.526, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55020
2022-05-08 11:43:16 - progress_bar.py[line:272] - INFO: epoch 002:  12283 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886775, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.635, expert1_balance_bottom=18.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.4, ups=0.58, wpb=385.7, bsz=32, num_updates=29950, lr=1.64339e-06, gnorm=3.721, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55037
2022-05-08 11:43:33 - progress_bar.py[line:272] - INFO: epoch 002:  12293 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=380, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.653, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=224, ups=0.59, wpb=380, bsz=32, num_updates=29960, lr=1.64039e-06, gnorm=4.138, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55054
2022-05-08 11:43:51 - progress_bar.py[line:272] - INFO: epoch 002:  12303 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=391.2, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877551, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.017, expert1_balance_bottom=18.866, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224, ups=0.57, wpb=391.2, bsz=32, num_updates=29970, lr=1.63738e-06, gnorm=4.418, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55072
2022-05-08 11:44:08 - progress_bar.py[line:272] - INFO: epoch 002:  12313 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.189, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=227.5, ups=0.59, wpb=387, bsz=32, num_updates=29980, lr=1.63438e-06, gnorm=3.36, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55089
2022-05-08 11:44:25 - progress_bar.py[line:272] - INFO: epoch 002:  12323 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=387.3, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887833, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.491, expert1_balance_bottom=19.135, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=227.8, ups=0.59, wpb=387.3, bsz=32, num_updates=29990, lr=1.63138e-06, gnorm=3.424, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55106
2022-05-08 11:44:42 - progress_bar.py[line:272] - INFO: epoch 002:  12333 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=376.9, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.619, expert1_balance_bottom=18.881, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218.9, ups=0.58, wpb=376.9, bsz=32, num_updates=30000, lr=1.62837e-06, gnorm=4.192, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55123
2022-05-08 11:44:42 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 11:44:42 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 11:44:42 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 11:51:41 - train.py[line:517] - INFO: valid_step finished
2022-05-08 11:51:41 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 9.459 | loss_v1 0 | loss_v2 0 | nll_loss 7.759 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.970856 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.459 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.264 | expert1_balance_top 35.909 | expert1_balance_bottom 14.969 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 216.67 | cider 1.192 | wps 719 | wpb 481.7 | bsz 8 | num_updates 30000 | best_cider 1.192
2022-05-08 11:51:41 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 30000 updates
2022-05-08 11:51:41 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_30000-rank-0.pt
2022-05-08 11:51:41 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_30000-rank-0.pt
2022-05-08 11:51:48 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_30000-rank-0.pt
2022-05-08 11:51:48 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_30000-shared.pt
2022-05-08 11:51:55 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_30000-shared.pt
2022-05-08 11:52:26 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_30000-rank-0.pt (epoch 2 @ 30000 updates, score 1.192) (writing took 44.63688801880926 seconds)
2022-05-08 11:52:43 - progress_bar.py[line:272] - INFO: epoch 002:  12343 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.781, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=8, ups=0.02, wpb=383.6, bsz=32, num_updates=30010, lr=1.62537e-06, gnorm=3.524, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55604
2022-05-08 11:53:00 - progress_bar.py[line:272] - INFO: epoch 002:  12353 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893374, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.194, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.5, ups=0.59, wpb=379.6, bsz=32, num_updates=30020, lr=1.62237e-06, gnorm=3.198, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55621
2022-05-08 11:53:17 - progress_bar.py[line:272] - INFO: epoch 002:  12363 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89354, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34, expert1_balance_bottom=19.123, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.9, ups=0.59, wpb=379.8, bsz=32, num_updates=30030, lr=1.61937e-06, gnorm=4.124, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55637
2022-05-08 11:53:34 - progress_bar.py[line:272] - INFO: epoch 002:  12373 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890241, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.469, expert1_balance_bottom=19.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221.8, ups=0.59, wpb=378.6, bsz=32, num_updates=30040, lr=1.61636e-06, gnorm=4.022, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55654
2022-05-08 11:53:51 - progress_bar.py[line:272] - INFO: epoch 002:  12383 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=384.8, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881504, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.874, expert1_balance_bottom=19.004, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=222, ups=0.58, wpb=384.8, bsz=32, num_updates=30050, lr=1.61336e-06, gnorm=3.105, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55672
2022-05-08 11:54:08 - progress_bar.py[line:272] - INFO: epoch 002:  12393 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.835, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=228.5, ups=0.59, wpb=388.2, bsz=32, num_updates=30060, lr=1.61036e-06, gnorm=3.772, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55689
2022-05-08 11:54:25 - progress_bar.py[line:272] - INFO: epoch 002:  12403 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=382.5, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.3, expert1_balance_bottom=19.03, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=224.1, ups=0.59, wpb=382.5, bsz=32, num_updates=30070, lr=1.60735e-06, gnorm=3.4, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55706
2022-05-08 11:54:42 - progress_bar.py[line:272] - INFO: epoch 002:  12413 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=387.6, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879733, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.202, expert1_balance_bottom=18.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.6, ups=0.57, wpb=387.6, bsz=32, num_updates=30080, lr=1.60435e-06, gnorm=2.968, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55723
2022-05-08 11:54:59 - progress_bar.py[line:272] - INFO: epoch 002:  12423 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.403, expert1_balance_bottom=19.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=225.9, ups=0.59, wpb=381.1, bsz=32, num_updates=30090, lr=1.60135e-06, gnorm=3.739, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55740
2022-05-08 11:55:16 - progress_bar.py[line:272] - INFO: epoch 002:  12433 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.083, expert1_balance_bottom=19.256, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.4, ups=0.59, wpb=380.7, bsz=32, num_updates=30100, lr=1.59834e-06, gnorm=3.377, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55757
2022-05-08 11:55:34 - progress_bar.py[line:272] - INFO: epoch 002:  12443 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=372.5, nsentences=32, sample_size=296.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.995, expert1_balance_bottom=19.112, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=215.8, ups=0.58, wpb=372.5, bsz=32, num_updates=30110, lr=1.59534e-06, gnorm=3.658, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55774
2022-05-08 11:55:51 - progress_bar.py[line:272] - INFO: epoch 002:  12453 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882866, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.656, expert1_balance_bottom=18.878, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.5, ups=0.59, wpb=384.7, bsz=32, num_updates=30120, lr=1.59234e-06, gnorm=3.032, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55791
2022-05-08 11:56:08 - progress_bar.py[line:272] - INFO: epoch 002:  12463 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.802, expert1_balance_bottom=19.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=225.6, ups=0.59, wpb=385, bsz=32, num_updates=30130, lr=1.58933e-06, gnorm=3.539, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55808
2022-05-08 11:56:25 - progress_bar.py[line:272] - INFO: epoch 002:  12473 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=391, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872662, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.392, expert1_balance_bottom=18.843, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=231.7, ups=0.59, wpb=391, bsz=32, num_updates=30140, lr=1.58633e-06, gnorm=3.605, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55825
2022-05-08 11:56:42 - progress_bar.py[line:272] - INFO: epoch 002:  12483 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=379.4, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.821, expert1_balance_bottom=19.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.3, ups=0.59, wpb=379.4, bsz=32, num_updates=30150, lr=1.58333e-06, gnorm=3.373, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55842
2022-05-08 11:56:59 - progress_bar.py[line:272] - INFO: epoch 002:  12493 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.293, expert1_balance_bottom=18.798, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=226.7, ups=0.59, wpb=384.2, bsz=32, num_updates=30160, lr=1.58032e-06, gnorm=3.63, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55859
2022-05-08 11:57:15 - progress_bar.py[line:272] - INFO: epoch 002:  12503 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.171, expert1_balance_bottom=18.998, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=229.4, ups=0.6, wpb=381.3, bsz=32, num_updates=30170, lr=1.57732e-06, gnorm=3.48, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55876
2022-05-08 11:57:32 - progress_bar.py[line:272] - INFO: epoch 002:  12513 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=370.5, nsentences=32, sample_size=294.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88743, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.65, expert1_balance_bottom=18.917, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=218.7, ups=0.59, wpb=370.5, bsz=32, num_updates=30180, lr=1.57432e-06, gnorm=3.567, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55893
2022-05-08 11:57:49 - progress_bar.py[line:272] - INFO: epoch 002:  12523 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.575, expert1_balance_bottom=18.839, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=226.4, ups=0.59, wpb=384.1, bsz=32, num_updates=30190, lr=1.57131e-06, gnorm=4.193, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55910
2022-05-08 11:58:07 - progress_bar.py[line:272] - INFO: epoch 002:  12533 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=390.8, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879582, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.881, expert1_balance_bottom=18.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221.6, ups=0.57, wpb=390.8, bsz=32, num_updates=30200, lr=1.56831e-06, gnorm=3.336, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55927
2022-05-08 11:58:24 - progress_bar.py[line:272] - INFO: epoch 002:  12543 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.939, expert1_balance_bottom=19.039, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=224.6, ups=0.58, wpb=385, bsz=32, num_updates=30210, lr=1.56531e-06, gnorm=3.603, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55945
2022-05-08 11:58:41 - progress_bar.py[line:272] - INFO: epoch 002:  12553 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=395.6, nsentences=32, sample_size=314.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.343, expert1_balance_bottom=19.038, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=232.6, ups=0.59, wpb=395.6, bsz=32, num_updates=30220, lr=1.5623e-06, gnorm=3.771, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55962
2022-05-08 11:58:58 - progress_bar.py[line:272] - INFO: epoch 002:  12563 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883583, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.55, expert1_balance_bottom=19.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=228.8, ups=0.59, wpb=386.8, bsz=32, num_updates=30230, lr=1.5593e-06, gnorm=3.86, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55979
2022-05-08 11:59:15 - progress_bar.py[line:272] - INFO: epoch 002:  12573 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=390.8, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878808, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.007, expert1_balance_bottom=18.894, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=228.8, ups=0.59, wpb=390.8, bsz=32, num_updates=30240, lr=1.5563e-06, gnorm=3.57, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=55996
2022-05-08 11:59:32 - progress_bar.py[line:272] - INFO: epoch 002:  12583 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=378.1, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.327, expert1_balance_bottom=19.039, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=223, ups=0.59, wpb=378.1, bsz=32, num_updates=30250, lr=1.55329e-06, gnorm=3.965, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56013
2022-05-08 11:59:49 - progress_bar.py[line:272] - INFO: epoch 002:  12593 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.52, expert1_balance_bottom=18.98, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=225.6, ups=0.59, wpb=383, bsz=32, num_updates=30260, lr=1.55029e-06, gnorm=3.825, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56030
2022-05-08 12:00:06 - progress_bar.py[line:272] - INFO: epoch 002:  12603 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889526, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.33, expert1_balance_bottom=19.038, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=220.3, ups=0.57, wpb=383.7, bsz=32, num_updates=30270, lr=1.54729e-06, gnorm=3.482, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56047
2022-05-08 12:00:23 - progress_bar.py[line:272] - INFO: epoch 002:  12613 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.057, expert1_balance_bottom=19.111, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223, ups=0.59, wpb=380.1, bsz=32, num_updates=30280, lr=1.54428e-06, gnorm=3.301, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56064
2022-05-08 12:00:40 - progress_bar.py[line:272] - INFO: epoch 002:  12623 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883302, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.568, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.5, ups=0.59, wpb=382.5, bsz=32, num_updates=30290, lr=1.54128e-06, gnorm=3.316, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56081
2022-05-08 12:00:58 - progress_bar.py[line:272] - INFO: epoch 002:  12633 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.184, expert1_balance_bottom=19.143, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.4, ups=0.58, wpb=377.5, bsz=32, num_updates=30300, lr=1.53828e-06, gnorm=4.198, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=56098
2022-05-08 12:01:14 - progress_bar.py[line:272] - INFO: epoch 002:  12643 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=387.9, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864164, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.713, expert1_balance_bottom=18.621, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=232.9, ups=0.6, wpb=387.9, bsz=32, num_updates=30310, lr=1.53527e-06, gnorm=3.413, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56115
2022-05-08 12:01:31 - progress_bar.py[line:272] - INFO: epoch 002:  12653 / 17711 loss=3.164, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=369.5, nsentences=32, sample_size=294.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887766, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.164, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.073, expert1_balance_bottom=19.217, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=214.8, ups=0.58, wpb=369.5, bsz=32, num_updates=30320, lr=1.53227e-06, gnorm=3.555, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56132
2022-05-08 12:01:49 - progress_bar.py[line:272] - INFO: epoch 002:  12663 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=374.7, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880275, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.564, expert1_balance_bottom=18.913, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219.3, ups=0.59, wpb=374.7, bsz=32, num_updates=30330, lr=1.52927e-06, gnorm=3.186, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=56149
2022-05-08 12:02:06 - progress_bar.py[line:272] - INFO: epoch 002:  12673 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.979, expert1_balance_bottom=18.763, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=226.5, ups=0.59, wpb=386.8, bsz=32, num_updates=30340, lr=1.52626e-06, gnorm=3.136, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56166
2022-05-08 12:02:23 - progress_bar.py[line:272] - INFO: epoch 002:  12683 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=379, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891611, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.825, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.9, ups=0.57, wpb=379, bsz=32, num_updates=30350, lr=1.52326e-06, gnorm=3.376, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56184
2022-05-08 12:02:40 - progress_bar.py[line:272] - INFO: epoch 002:  12693 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=374.5, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891818, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.264, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.7, ups=0.57, wpb=374.5, bsz=32, num_updates=30360, lr=1.52026e-06, gnorm=3.382, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56201
2022-05-08 12:02:57 - progress_bar.py[line:272] - INFO: epoch 002:  12703 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.672, expert1_balance_bottom=19.077, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.8, ups=0.59, wpb=378.1, bsz=32, num_updates=30370, lr=1.51725e-06, gnorm=3.807, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56218
2022-05-08 12:03:14 - progress_bar.py[line:272] - INFO: epoch 002:  12713 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=377.5, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.911, expert1_balance_bottom=19.354, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=221.4, ups=0.59, wpb=377.5, bsz=32, num_updates=30380, lr=1.51425e-06, gnorm=3.381, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56235
2022-05-08 12:03:31 - progress_bar.py[line:272] - INFO: epoch 002:  12723 / 17711 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.993, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899112, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.218, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.561, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=226, ups=0.59, wpb=381.8, bsz=32, num_updates=30390, lr=1.51125e-06, gnorm=3.945, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56252
2022-05-08 12:03:48 - progress_bar.py[line:272] - INFO: epoch 002:  12733 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=391.1, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864579, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.72, expert1_balance_bottom=18.664, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=229.7, ups=0.59, wpb=391.1, bsz=32, num_updates=30400, lr=1.50824e-06, gnorm=3.662, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56269
2022-05-08 12:04:05 - progress_bar.py[line:272] - INFO: epoch 002:  12743 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=387.7, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878366, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.713, expert1_balance_bottom=19.029, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=229.9, ups=0.59, wpb=387.7, bsz=32, num_updates=30410, lr=1.50524e-06, gnorm=3.16, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56286
2022-05-08 12:04:22 - progress_bar.py[line:272] - INFO: epoch 002:  12753 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=376.3, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.295, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220.4, ups=0.59, wpb=376.3, bsz=32, num_updates=30420, lr=1.50224e-06, gnorm=3.273, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56303
2022-05-08 12:04:24 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 12:04:41 - progress_bar.py[line:272] - INFO: epoch 002:  12764 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=386.8, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870356, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=35.454, expert1_balance_bottom=18.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209.3, ups=0.54, wpb=386.8, bsz=32, num_updates=30430, lr=1.49923e-06, gnorm=3.507, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56321
2022-05-08 12:04:58 - progress_bar.py[line:272] - INFO: epoch 002:  12774 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875024, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.673, expert1_balance_bottom=18.892, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=228.2, ups=0.59, wpb=387, bsz=32, num_updates=30440, lr=1.49623e-06, gnorm=3.305, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56338
2022-05-08 12:05:15 - progress_bar.py[line:272] - INFO: epoch 002:  12784 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=392.1, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.853, expert1_balance_bottom=18.803, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=229.5, ups=0.59, wpb=392.1, bsz=32, num_updates=30450, lr=1.49323e-06, gnorm=4.04, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=56356
2022-05-08 12:05:32 - progress_bar.py[line:272] - INFO: epoch 002:  12794 / 17711 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.18, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.333, expert1_balance_bottom=19.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=222.9, ups=0.59, wpb=378.7, bsz=32, num_updates=30460, lr=1.49022e-06, gnorm=3.554, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56373
2022-05-08 12:05:49 - progress_bar.py[line:272] - INFO: epoch 002:  12804 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884578, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.63, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.1, ups=0.59, wpb=378.5, bsz=32, num_updates=30470, lr=1.48722e-06, gnorm=4.045, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56389
2022-05-08 12:06:06 - progress_bar.py[line:272] - INFO: epoch 002:  12814 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=390.9, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878534, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.898, expert1_balance_bottom=18.872, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=228, ups=0.58, wpb=390.9, bsz=32, num_updates=30480, lr=1.48422e-06, gnorm=3.496, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56407
2022-05-08 12:06:23 - progress_bar.py[line:272] - INFO: epoch 002:  12824 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885546, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.473, expert1_balance_bottom=19.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=228.6, ups=0.59, wpb=386.3, bsz=32, num_updates=30490, lr=1.48121e-06, gnorm=3.789, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56423
2022-05-08 12:06:40 - progress_bar.py[line:272] - INFO: epoch 002:  12834 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888371, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.234, expert1_balance_bottom=19.124, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=227.3, ups=0.59, wpb=387, bsz=32, num_updates=30500, lr=1.47821e-06, gnorm=3.378, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56440
2022-05-08 12:06:57 - progress_bar.py[line:272] - INFO: epoch 002:  12844 / 17711 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886909, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.192, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.073, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=228.1, ups=0.59, wpb=385.3, bsz=32, num_updates=30510, lr=1.47521e-06, gnorm=3.809, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56457
2022-05-08 12:07:13 - progress_bar.py[line:272] - INFO: epoch 002:  12854 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.645, expert1_balance_bottom=19.107, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227, ups=0.6, wpb=381.5, bsz=32, num_updates=30520, lr=1.4722e-06, gnorm=3.667, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56474
2022-05-08 12:07:30 - progress_bar.py[line:272] - INFO: epoch 002:  12864 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.373, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.1, ups=0.59, wpb=381.8, bsz=32, num_updates=30530, lr=1.4692e-06, gnorm=3.294, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56491
2022-05-08 12:07:47 - progress_bar.py[line:272] - INFO: epoch 002:  12874 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=389.4, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.746, expert1_balance_bottom=18.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=228.5, ups=0.59, wpb=389.4, bsz=32, num_updates=30540, lr=1.4662e-06, gnorm=3.532, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56508
2022-05-08 12:08:05 - progress_bar.py[line:272] - INFO: epoch 002:  12884 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=388.8, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.65, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=227.4, ups=0.58, wpb=388.8, bsz=32, num_updates=30550, lr=1.46319e-06, gnorm=4.227, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=56525
2022-05-08 12:08:22 - progress_bar.py[line:272] - INFO: epoch 002:  12894 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885191, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.742, expert1_balance_bottom=18.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.7, ups=0.59, wpb=377.5, bsz=32, num_updates=30560, lr=1.46019e-06, gnorm=4.022, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56542
2022-05-08 12:08:38 - progress_bar.py[line:272] - INFO: epoch 002:  12904 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=383.3, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.516, expert1_balance_bottom=19.02, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=226.7, ups=0.59, wpb=383.3, bsz=32, num_updates=30570, lr=1.45719e-06, gnorm=3.349, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56559
2022-05-08 12:08:55 - progress_bar.py[line:272] - INFO: epoch 002:  12914 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=380.6, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884899, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.594, expert1_balance_bottom=18.98, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=224.7, ups=0.59, wpb=380.6, bsz=32, num_updates=30580, lr=1.45419e-06, gnorm=3.967, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56576
2022-05-08 12:09:12 - progress_bar.py[line:272] - INFO: epoch 002:  12924 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=387.2, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878819, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.956, expert1_balance_bottom=18.871, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=229.7, ups=0.59, wpb=387.2, bsz=32, num_updates=30590, lr=1.45118e-06, gnorm=3.856, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=56593
2022-05-08 12:09:29 - progress_bar.py[line:272] - INFO: epoch 002:  12934 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=374.6, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.875, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219.2, ups=0.59, wpb=374.6, bsz=32, num_updates=30600, lr=1.44818e-06, gnorm=3.223, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56610
2022-05-08 12:09:46 - progress_bar.py[line:272] - INFO: epoch 002:  12944 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885589, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.494, expert1_balance_bottom=19.063, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=229.7, ups=0.6, wpb=384.4, bsz=32, num_updates=30610, lr=1.44518e-06, gnorm=3.514, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56627
2022-05-08 12:10:03 - progress_bar.py[line:272] - INFO: epoch 002:  12954 / 17711 loss=3.266, loss_v1=0, loss_v2=0, nll_loss=1.056, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.266, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.981, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.08, wps=231.3, ups=0.61, wpb=380.7, bsz=32, num_updates=30620, lr=1.44217e-06, gnorm=4.333, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56643
2022-05-08 12:10:20 - progress_bar.py[line:272] - INFO: epoch 002:  12964 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.993, ntokens=393.1, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8742, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.288, expert1_balance_bottom=18.733, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.99, wps=229.9, ups=0.58, wpb=393.1, bsz=32, num_updates=30630, lr=1.43917e-06, gnorm=3.517, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56660
2022-05-08 12:10:37 - progress_bar.py[line:272] - INFO: epoch 002:  12974 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=388.7, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873528, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.406, expert1_balance_bottom=18.686, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226.1, ups=0.58, wpb=388.7, bsz=32, num_updates=30640, lr=1.43617e-06, gnorm=4.401, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56678
2022-05-08 12:10:54 - progress_bar.py[line:272] - INFO: epoch 002:  12984 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.918, expert1_balance_bottom=18.794, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=228.6, ups=0.59, wpb=385.3, bsz=32, num_updates=30650, lr=1.43316e-06, gnorm=3.596, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56694
2022-05-08 12:11:11 - progress_bar.py[line:272] - INFO: epoch 002:  12994 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883042, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.776, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=223.1, ups=0.59, wpb=379.7, bsz=32, num_updates=30660, lr=1.43016e-06, gnorm=3.45, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56711
2022-05-08 12:11:28 - progress_bar.py[line:272] - INFO: epoch 002:  13004 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=392.3, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.709, expert1_balance_bottom=19.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=231.1, ups=0.59, wpb=392.3, bsz=32, num_updates=30670, lr=1.42716e-06, gnorm=3.641, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56728
2022-05-08 12:11:45 - progress_bar.py[line:272] - INFO: epoch 002:  13014 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=387.2, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872795, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.423, expert1_balance_bottom=18.763, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226.7, ups=0.59, wpb=387.2, bsz=32, num_updates=30680, lr=1.42415e-06, gnorm=4.22, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56746
2022-05-08 12:12:02 - progress_bar.py[line:272] - INFO: epoch 002:  13024 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=376, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89192, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.135, expert1_balance_bottom=18.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.1, ups=0.59, wpb=376, bsz=32, num_updates=30690, lr=1.42115e-06, gnorm=3.601, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=56762
2022-05-08 12:12:19 - progress_bar.py[line:272] - INFO: epoch 002:  13034 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=383.4, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.126, expert1_balance_bottom=19.172, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226.3, ups=0.59, wpb=383.4, bsz=32, num_updates=30700, lr=1.41815e-06, gnorm=3.577, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56779
2022-05-08 12:12:36 - progress_bar.py[line:272] - INFO: epoch 002:  13044 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=377.6, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878681, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.032, expert1_balance_bottom=18.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.2, ups=0.59, wpb=377.6, bsz=32, num_updates=30710, lr=1.41514e-06, gnorm=3.169, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56796
2022-05-08 12:12:53 - progress_bar.py[line:272] - INFO: epoch 002:  13054 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.822, expert1_balance_bottom=19.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223.9, ups=0.58, wpb=387, bsz=32, num_updates=30720, lr=1.41214e-06, gnorm=3.404, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56814
2022-05-08 12:13:03 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 12:13:12 - progress_bar.py[line:272] - INFO: epoch 002:  13065 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877613, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.118, expert1_balance_bottom=18.82, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=202, ups=0.53, wpb=383.1, bsz=32, num_updates=30730, lr=1.40914e-06, gnorm=3.967, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56833
2022-05-08 12:13:29 - progress_bar.py[line:272] - INFO: epoch 002:  13075 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=382.5, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887322, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.496, expert1_balance_bottom=19.029, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.2, ups=0.59, wpb=382.5, bsz=32, num_updates=30740, lr=1.40613e-06, gnorm=3.858, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56850
2022-05-08 12:13:46 - progress_bar.py[line:272] - INFO: epoch 002:  13085 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=376.5, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.917, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=217, ups=0.58, wpb=376.5, bsz=32, num_updates=30750, lr=1.40313e-06, gnorm=5.002, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56867
2022-05-08 12:14:03 - progress_bar.py[line:272] - INFO: epoch 002:  13095 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=378.9, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=35.01, expert1_balance_bottom=18.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=221.6, ups=0.58, wpb=378.9, bsz=32, num_updates=30760, lr=1.40013e-06, gnorm=3.758, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=56884
2022-05-08 12:14:20 - progress_bar.py[line:272] - INFO: epoch 002:  13105 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883609, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.526, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221.3, ups=0.58, wpb=380.2, bsz=32, num_updates=30770, lr=1.39712e-06, gnorm=4.212, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56901
2022-05-08 12:14:37 - progress_bar.py[line:272] - INFO: epoch 002:  13115 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.831, expert1_balance_bottom=18.761, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=224.2, ups=0.59, wpb=380.6, bsz=32, num_updates=30780, lr=1.39412e-06, gnorm=3.538, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56918
2022-05-08 12:14:54 - progress_bar.py[line:272] - INFO: epoch 002:  13125 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=387.1, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882764, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.667, expert1_balance_bottom=18.991, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=228.3, ups=0.59, wpb=387.1, bsz=32, num_updates=30790, lr=1.39112e-06, gnorm=3.419, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=56935
2022-05-08 12:15:12 - progress_bar.py[line:272] - INFO: epoch 002:  13135 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=386.1, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.339, expert1_balance_bottom=19.112, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=225.8, ups=0.58, wpb=386.1, bsz=32, num_updates=30800, lr=1.38811e-06, gnorm=3.004, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=56952
2022-05-08 12:15:28 - progress_bar.py[line:272] - INFO: epoch 002:  13145 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=385.3, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891861, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.042, expert1_balance_bottom=19.256, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=229.6, ups=0.6, wpb=385.3, bsz=32, num_updates=30810, lr=1.38511e-06, gnorm=3.346, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56969
2022-05-08 12:15:45 - progress_bar.py[line:272] - INFO: epoch 002:  13155 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=381.7, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.41, expert1_balance_bottom=19.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=223.6, ups=0.59, wpb=381.7, bsz=32, num_updates=30820, lr=1.38211e-06, gnorm=3.399, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=56986
2022-05-08 12:16:03 - progress_bar.py[line:272] - INFO: epoch 002:  13165 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=384.9, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.327, expert1_balance_bottom=19.078, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.2, ups=0.58, wpb=384.9, bsz=32, num_updates=30830, lr=1.3791e-06, gnorm=3.776, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57003
2022-05-08 12:16:20 - progress_bar.py[line:272] - INFO: epoch 002:  13175 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=395.9, nsentences=32, sample_size=315, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8963, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.775, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=230.5, ups=0.58, wpb=395.9, bsz=32, num_updates=30840, lr=1.3761e-06, gnorm=3.451, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57021
2022-05-08 12:16:37 - progress_bar.py[line:272] - INFO: epoch 002:  13185 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.319, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.7, ups=0.58, wpb=382.1, bsz=32, num_updates=30850, lr=1.3731e-06, gnorm=3.769, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57038
2022-05-08 12:16:54 - progress_bar.py[line:272] - INFO: epoch 002:  13195 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=381.6, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888599, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.309, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=225.5, ups=0.59, wpb=381.6, bsz=32, num_updates=30860, lr=1.37009e-06, gnorm=3.214, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57055
2022-05-08 12:17:11 - progress_bar.py[line:272] - INFO: epoch 002:  13205 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=380, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886991, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.433, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=222.2, ups=0.58, wpb=380, bsz=32, num_updates=30870, lr=1.36709e-06, gnorm=3.214, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57072
2022-05-08 12:17:28 - progress_bar.py[line:272] - INFO: epoch 002:  13215 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=378, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.166, expert1_balance_bottom=18.754, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=220.9, ups=0.58, wpb=378, bsz=32, num_updates=30880, lr=1.36409e-06, gnorm=3.317, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57089
2022-05-08 12:17:46 - progress_bar.py[line:272] - INFO: epoch 002:  13225 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.798, expert1_balance_bottom=18.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=217.9, ups=0.57, wpb=380.4, bsz=32, num_updates=30890, lr=1.36108e-06, gnorm=3.498, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57106
2022-05-08 12:18:03 - progress_bar.py[line:272] - INFO: epoch 002:  13235 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.716, expert1_balance_bottom=18.888, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=219.9, ups=0.58, wpb=381.4, bsz=32, num_updates=30900, lr=1.35808e-06, gnorm=3.492, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57124
2022-05-08 12:18:20 - progress_bar.py[line:272] - INFO: epoch 002:  13245 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.768, expert1_balance_bottom=18.832, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=227, ups=0.59, wpb=386.1, bsz=32, num_updates=30910, lr=1.35508e-06, gnorm=3.604, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57141
2022-05-08 12:18:37 - progress_bar.py[line:272] - INFO: epoch 002:  13255 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=379.1, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885064, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.478, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.7, ups=0.59, wpb=379.1, bsz=32, num_updates=30920, lr=1.35207e-06, gnorm=3.467, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57158
2022-05-08 12:18:54 - progress_bar.py[line:272] - INFO: epoch 002:  13265 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=375.6, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.35, expert1_balance_bottom=19.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.9, ups=0.6, wpb=375.6, bsz=32, num_updates=30930, lr=1.34907e-06, gnorm=3.531, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57175
2022-05-08 12:19:11 - progress_bar.py[line:272] - INFO: epoch 002:  13275 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=375.1, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.481, expert1_balance_bottom=19.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.1, ups=0.59, wpb=375.1, bsz=32, num_updates=30940, lr=1.34607e-06, gnorm=3.829, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57191
2022-05-08 12:19:28 - progress_bar.py[line:272] - INFO: epoch 002:  13285 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=382.6, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.563, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224.3, ups=0.59, wpb=382.6, bsz=32, num_updates=30950, lr=1.34306e-06, gnorm=3.663, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=57208
2022-05-08 12:19:45 - progress_bar.py[line:272] - INFO: epoch 002:  13295 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.739, expert1_balance_bottom=18.847, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=223, ups=0.58, wpb=381.3, bsz=32, num_updates=30960, lr=1.34006e-06, gnorm=3.669, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57226
2022-05-08 12:20:02 - progress_bar.py[line:272] - INFO: epoch 002:  13305 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=392, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.049, expert1_balance_bottom=18.829, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=230.3, ups=0.59, wpb=392, bsz=32, num_updates=30970, lr=1.33706e-06, gnorm=3.993, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57243
2022-05-08 12:20:19 - progress_bar.py[line:272] - INFO: epoch 002:  13315 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=381.8, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.21, expert1_balance_bottom=18.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=222.4, ups=0.58, wpb=381.8, bsz=32, num_updates=30980, lr=1.33405e-06, gnorm=3.079, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57260
2022-05-08 12:20:36 - progress_bar.py[line:272] - INFO: epoch 002:  13325 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=374.1, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.971, expert1_balance_bottom=19.168, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.1, ups=0.58, wpb=374.1, bsz=32, num_updates=30990, lr=1.33105e-06, gnorm=4.037, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57277
2022-05-08 12:20:53 - progress_bar.py[line:272] - INFO: epoch 002:  13335 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=383.6, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888442, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.884, expert1_balance_bottom=19.157, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=225.1, ups=0.59, wpb=383.6, bsz=32, num_updates=31000, lr=1.32805e-06, gnorm=3.39, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57294
2022-05-08 12:21:10 - progress_bar.py[line:272] - INFO: epoch 002:  13345 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=389.1, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.962, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=230.9, ups=0.59, wpb=389.1, bsz=32, num_updates=31010, lr=1.32504e-06, gnorm=3.401, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57311
2022-05-08 12:21:27 - progress_bar.py[line:272] - INFO: epoch 002:  13355 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=386.4, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885895, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.723, expert1_balance_bottom=19.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=221.5, ups=0.57, wpb=386.4, bsz=32, num_updates=31020, lr=1.32204e-06, gnorm=3.721, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57328
2022-05-08 12:21:44 - progress_bar.py[line:272] - INFO: epoch 002:  13365 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=387.7, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885345, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.336, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=228.3, ups=0.59, wpb=387.7, bsz=32, num_updates=31030, lr=1.31904e-06, gnorm=3.449, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57345
2022-05-08 12:22:02 - progress_bar.py[line:272] - INFO: epoch 002:  13375 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=385.6, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884062, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.539, expert1_balance_bottom=18.945, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.9, ups=0.58, wpb=385.6, bsz=32, num_updates=31040, lr=1.31603e-06, gnorm=3, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57363
2022-05-08 12:22:19 - progress_bar.py[line:272] - INFO: epoch 002:  13385 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881682, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.68, expert1_balance_bottom=18.969, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.9, ups=0.59, wpb=380.5, bsz=32, num_updates=31050, lr=1.31303e-06, gnorm=3.695, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57380
2022-05-08 12:22:36 - progress_bar.py[line:272] - INFO: epoch 002:  13395 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=377.3, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.949, expert1_balance_bottom=19.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=225.6, ups=0.6, wpb=377.3, bsz=32, num_updates=31060, lr=1.31003e-06, gnorm=5.295, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57396
2022-05-08 12:22:53 - progress_bar.py[line:272] - INFO: epoch 002:  13405 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.596, expert1_balance_bottom=19.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.4, ups=0.58, wpb=380.5, bsz=32, num_updates=31070, lr=1.30702e-06, gnorm=4.437, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=57414
2022-05-08 12:23:10 - progress_bar.py[line:272] - INFO: epoch 002:  13415 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=385.9, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890535, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.96, expert1_balance_bottom=19.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=227.3, ups=0.59, wpb=385.9, bsz=32, num_updates=31080, lr=1.30402e-06, gnorm=3.151, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=57431
2022-05-08 12:23:27 - progress_bar.py[line:272] - INFO: epoch 002:  13425 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=383.6, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.751, expert1_balance_bottom=18.795, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.7, ups=0.58, wpb=383.6, bsz=32, num_updates=31090, lr=1.30102e-06, gnorm=7.449, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57448
2022-05-08 12:23:44 - progress_bar.py[line:272] - INFO: epoch 002:  13435 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=390.2, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.134, expert1_balance_bottom=19.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=228.2, ups=0.58, wpb=390.2, bsz=32, num_updates=31100, lr=1.29801e-06, gnorm=3.312, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57465
2022-05-08 12:24:01 - progress_bar.py[line:272] - INFO: epoch 002:  13445 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.5, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.6, ups=0.59, wpb=375.5, bsz=32, num_updates=31110, lr=1.29501e-06, gnorm=3.375, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57482
2022-05-08 12:24:18 - progress_bar.py[line:272] - INFO: epoch 002:  13455 / 17711 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=1.008, ntokens=384.8, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.216, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.91, expert1_balance_bottom=19.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=227.7, ups=0.59, wpb=384.8, bsz=32, num_updates=31120, lr=1.29201e-06, gnorm=3.524, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57499
2022-05-08 12:24:35 - progress_bar.py[line:272] - INFO: epoch 002:  13465 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=379.4, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.651, expert1_balance_bottom=19.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.2, ups=0.59, wpb=379.4, bsz=32, num_updates=31130, lr=1.28901e-06, gnorm=3.417, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57516
2022-05-08 12:24:52 - progress_bar.py[line:272] - INFO: epoch 002:  13475 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=383.5, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889562, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.343, expert1_balance_bottom=19.081, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.3, ups=0.58, wpb=383.5, bsz=32, num_updates=31140, lr=1.286e-06, gnorm=3.444, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57533
2022-05-08 12:25:09 - progress_bar.py[line:272] - INFO: epoch 002:  13485 / 17711 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=387.8, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.172, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.434, expert1_balance_bottom=19.126, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=224.4, ups=0.58, wpb=387.8, bsz=32, num_updates=31150, lr=1.283e-06, gnorm=4.076, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57550
2022-05-08 12:25:27 - progress_bar.py[line:272] - INFO: epoch 002:  13495 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882136, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.663, expert1_balance_bottom=18.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.6, ups=0.57, wpb=384.9, bsz=32, num_updates=31160, lr=1.28e-06, gnorm=3.325, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57567
2022-05-08 12:25:44 - progress_bar.py[line:272] - INFO: epoch 002:  13505 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890121, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.739, expert1_balance_bottom=19.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.5, ups=0.58, wpb=383.1, bsz=32, num_updates=31170, lr=1.27699e-06, gnorm=3.538, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57585
2022-05-08 12:26:01 - progress_bar.py[line:272] - INFO: epoch 002:  13515 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=377.4, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.238, expert1_balance_bottom=19.137, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.6, ups=0.57, wpb=377.4, bsz=32, num_updates=31180, lr=1.27399e-06, gnorm=3.233, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57602
2022-05-08 12:26:18 - progress_bar.py[line:272] - INFO: epoch 002:  13525 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.61, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=225.1, ups=0.59, wpb=382.1, bsz=32, num_updates=31190, lr=1.27099e-06, gnorm=3.264, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57619
2022-05-08 12:26:35 - progress_bar.py[line:272] - INFO: epoch 002:  13535 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.267, expert1_balance_bottom=18.833, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.1, ups=0.59, wpb=385.5, bsz=32, num_updates=31200, lr=1.26798e-06, gnorm=3.314, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57636
2022-05-08 12:26:52 - progress_bar.py[line:272] - INFO: epoch 002:  13545 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=382.8, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.023, expert1_balance_bottom=19.146, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=226.2, ups=0.59, wpb=382.8, bsz=32, num_updates=31210, lr=1.26498e-06, gnorm=3.188, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57653
2022-05-08 12:27:09 - progress_bar.py[line:272] - INFO: epoch 002:  13555 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=389.9, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885105, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.156, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=230, ups=0.59, wpb=389.9, bsz=32, num_updates=31220, lr=1.26198e-06, gnorm=3.43, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=57670
2022-05-08 12:27:26 - progress_bar.py[line:272] - INFO: epoch 002:  13565 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=383.7, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.006, expert1_balance_bottom=18.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=227.7, ups=0.59, wpb=383.7, bsz=32, num_updates=31230, lr=1.25897e-06, gnorm=4.055, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57687
2022-05-08 12:27:43 - progress_bar.py[line:272] - INFO: epoch 002:  13575 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=387.2, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884333, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.353, expert1_balance_bottom=19.095, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=229, ups=0.59, wpb=387.2, bsz=32, num_updates=31240, lr=1.25597e-06, gnorm=3.432, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57704
2022-05-08 12:28:00 - progress_bar.py[line:272] - INFO: epoch 002:  13585 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88111, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.902, expert1_balance_bottom=18.76, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.8, ups=0.59, wpb=382.4, bsz=32, num_updates=31250, lr=1.25297e-06, gnorm=3.073, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57721
2022-05-08 12:28:17 - progress_bar.py[line:272] - INFO: epoch 002:  13595 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=377.6, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887097, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.089, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=218.5, ups=0.58, wpb=377.6, bsz=32, num_updates=31260, lr=1.24996e-06, gnorm=3.256, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57738
2022-05-08 12:28:34 - progress_bar.py[line:272] - INFO: epoch 002:  13605 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.216, expert1_balance_bottom=19.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=225.9, ups=0.59, wpb=385.5, bsz=32, num_updates=31270, lr=1.24696e-06, gnorm=3.34, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57755
2022-05-08 12:28:51 - progress_bar.py[line:272] - INFO: epoch 002:  13615 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.936, expert1_balance_bottom=18.918, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=226.9, ups=0.59, wpb=386.3, bsz=32, num_updates=31280, lr=1.24396e-06, gnorm=3.709, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57772
2022-05-08 12:29:08 - progress_bar.py[line:272] - INFO: epoch 002:  13625 / 17711 loss=3.146, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=393, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881907, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.146, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.235, expert1_balance_bottom=19.047, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=233, ups=0.59, wpb=393, bsz=32, num_updates=31290, lr=1.24095e-06, gnorm=3.721, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57789
2022-05-08 12:29:25 - progress_bar.py[line:272] - INFO: epoch 002:  13635 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=387.8, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875766, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=35.177, expert1_balance_bottom=18.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=227.7, ups=0.59, wpb=387.8, bsz=32, num_updates=31300, lr=1.23795e-06, gnorm=3.329, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57806
2022-05-08 12:29:42 - progress_bar.py[line:272] - INFO: epoch 002:  13645 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.009, expert1_balance_bottom=18.787, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=226.7, ups=0.59, wpb=385.7, bsz=32, num_updates=31310, lr=1.23495e-06, gnorm=4.025, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57823
2022-05-08 12:29:59 - progress_bar.py[line:272] - INFO: epoch 002:  13655 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=386.4, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.28, expert1_balance_bottom=18.821, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=225.2, ups=0.58, wpb=386.4, bsz=32, num_updates=31320, lr=1.23194e-06, gnorm=4.325, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57840
2022-05-08 12:30:16 - progress_bar.py[line:272] - INFO: epoch 002:  13665 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.024, expert1_balance_bottom=19.111, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.9, ups=0.58, wpb=385.3, bsz=32, num_updates=31330, lr=1.22894e-06, gnorm=3.534, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57857
2022-05-08 12:30:34 - progress_bar.py[line:272] - INFO: epoch 002:  13675 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=388.2, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884596, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.401, expert1_balance_bottom=19.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=225, ups=0.58, wpb=388.2, bsz=32, num_updates=31340, lr=1.22594e-06, gnorm=3.348, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57875
2022-05-08 12:30:51 - progress_bar.py[line:272] - INFO: epoch 002:  13685 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.534, expert1_balance_bottom=18.749, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=225.6, ups=0.58, wpb=387.9, bsz=32, num_updates=31350, lr=1.22293e-06, gnorm=3.785, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57892
2022-05-08 12:31:08 - progress_bar.py[line:272] - INFO: epoch 002:  13695 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=383.7, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883181, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.675, expert1_balance_bottom=18.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.2, ups=0.58, wpb=383.7, bsz=32, num_updates=31360, lr=1.21993e-06, gnorm=3.442, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57909
2022-05-08 12:31:25 - progress_bar.py[line:272] - INFO: epoch 002:  13705 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=378.9, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882551, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.541, expert1_balance_bottom=18.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=226.8, ups=0.6, wpb=378.9, bsz=32, num_updates=31370, lr=1.21693e-06, gnorm=3.764, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57926
2022-05-08 12:31:42 - progress_bar.py[line:272] - INFO: epoch 002:  13715 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=384.5, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.295, expert1_balance_bottom=19.094, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227.3, ups=0.59, wpb=384.5, bsz=32, num_updates=31380, lr=1.21392e-06, gnorm=3.072, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57943
2022-05-08 12:31:59 - progress_bar.py[line:272] - INFO: epoch 002:  13725 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.457, expert1_balance_bottom=18.997, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=221.3, ups=0.58, wpb=383.3, bsz=32, num_updates=31390, lr=1.21092e-06, gnorm=3.619, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57960
2022-05-08 12:32:16 - progress_bar.py[line:272] - INFO: epoch 002:  13735 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887623, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.113, expert1_balance_bottom=19.197, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=225.7, ups=0.59, wpb=380.6, bsz=32, num_updates=31400, lr=1.20792e-06, gnorm=3.711, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=57977
2022-05-08 12:32:33 - progress_bar.py[line:272] - INFO: epoch 002:  13745 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=35.422, expert1_balance_bottom=18.686, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=228.9, ups=0.59, wpb=385.9, bsz=32, num_updates=31410, lr=1.20491e-06, gnorm=3.828, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=57994
2022-05-08 12:32:50 - progress_bar.py[line:272] - INFO: epoch 002:  13755 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=377.3, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88071, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.771, expert1_balance_bottom=18.818, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=220.1, ups=0.58, wpb=377.3, bsz=32, num_updates=31420, lr=1.20191e-06, gnorm=3.339, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58011
2022-05-08 12:33:07 - progress_bar.py[line:272] - INFO: epoch 002:  13765 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=388.1, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.748, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222, ups=0.57, wpb=388.1, bsz=32, num_updates=31430, lr=1.19891e-06, gnorm=3.79, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58028
2022-05-08 12:33:25 - progress_bar.py[line:272] - INFO: epoch 002:  13775 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.076, expert1_balance_bottom=18.679, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=222.4, ups=0.58, wpb=381.8, bsz=32, num_updates=31440, lr=1.1959e-06, gnorm=4.207, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58045
2022-05-08 12:33:33 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 12:33:45 - progress_bar.py[line:272] - INFO: epoch 002:  13786 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=384.9, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.075, expert1_balance_bottom=18.811, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=193, ups=0.5, wpb=384.9, bsz=32, num_updates=31450, lr=1.1929e-06, gnorm=3.492, loss_scale=32, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58065
2022-05-08 12:34:04 - progress_bar.py[line:272] - INFO: epoch 002:  13796 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880768, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.914, expert1_balance_bottom=18.774, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=199.2, ups=0.52, wpb=380.7, bsz=32, num_updates=31460, lr=1.1899e-06, gnorm=3.867, loss_scale=32, train_wall=18, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=58084
2022-05-08 12:34:21 - progress_bar.py[line:272] - INFO: epoch 002:  13806 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=371, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.916, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=211.5, ups=0.57, wpb=371, bsz=32, num_updates=31470, lr=1.18689e-06, gnorm=3.9, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58102
2022-05-08 12:34:39 - progress_bar.py[line:272] - INFO: epoch 002:  13816 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=376.6, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.272, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212.8, ups=0.57, wpb=376.6, bsz=32, num_updates=31480, lr=1.18389e-06, gnorm=3.587, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=58120
2022-05-08 12:35:00 - progress_bar.py[line:272] - INFO: epoch 002:  13826 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=378.9, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877483, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.015, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=181.6, ups=0.48, wpb=378.9, bsz=32, num_updates=31490, lr=1.18089e-06, gnorm=3.234, loss_scale=32, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58141
2022-05-08 12:35:18 - progress_bar.py[line:272] - INFO: epoch 002:  13836 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880422, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.748, expert1_balance_bottom=18.951, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.5, ups=0.56, wpb=388.1, bsz=32, num_updates=31500, lr=1.17788e-06, gnorm=5.063, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58159
2022-05-08 12:35:36 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-05-08 12:35:40 - progress_bar.py[line:272] - INFO: epoch 002:  13847 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=385.9, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885494, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.608, expert1_balance_bottom=18.859, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=176.5, ups=0.46, wpb=385.9, bsz=32, num_updates=31510, lr=1.17488e-06, gnorm=3.382, loss_scale=16, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58180
2022-05-08 12:35:58 - progress_bar.py[line:272] - INFO: epoch 002:  13857 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=390.9, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881992, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.75, expert1_balance_bottom=18.843, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=218.2, ups=0.56, wpb=390.9, bsz=32, num_updates=31520, lr=1.17188e-06, gnorm=3.682, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58198
2022-05-08 12:36:15 - progress_bar.py[line:272] - INFO: epoch 002:  13867 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=378.3, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886941, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.453, expert1_balance_bottom=19.283, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.4, ups=0.57, wpb=378.3, bsz=32, num_updates=31530, lr=1.16887e-06, gnorm=3.24, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58216
2022-05-08 12:36:36 - progress_bar.py[line:272] - INFO: epoch 002:  13877 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=376.3, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.112, expert1_balance_bottom=18.781, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=175, ups=0.46, wpb=376.3, bsz=32, num_updates=31540, lr=1.16587e-06, gnorm=3.336, loss_scale=16, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58237
2022-05-08 12:36:54 - progress_bar.py[line:272] - INFO: epoch 002:  13887 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=35.68, expert1_balance_bottom=18.692, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.7, ups=0.58, wpb=386.1, bsz=32, num_updates=31550, lr=1.16287e-06, gnorm=3.295, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58254
2022-05-08 12:37:11 - progress_bar.py[line:272] - INFO: epoch 002:  13897 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=384.5, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.035, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.4, ups=0.56, wpb=384.5, bsz=32, num_updates=31560, lr=1.15986e-06, gnorm=3.351, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58272
2022-05-08 12:37:31 - progress_bar.py[line:272] - INFO: epoch 002:  13907 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=380.6, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888931, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.265, expert1_balance_bottom=19.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=193.8, ups=0.51, wpb=380.6, bsz=32, num_updates=31570, lr=1.15686e-06, gnorm=3.245, loss_scale=16, train_wall=18, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=58292
2022-05-08 12:37:49 - progress_bar.py[line:272] - INFO: epoch 002:  13917 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=374.1, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.28, expert1_balance_bottom=19.164, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=212.4, ups=0.57, wpb=374.1, bsz=32, num_updates=31580, lr=1.15386e-06, gnorm=3.471, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58310
2022-05-08 12:38:06 - progress_bar.py[line:272] - INFO: epoch 002:  13927 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=385, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.023, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219, ups=0.57, wpb=385, bsz=32, num_updates=31590, lr=1.15085e-06, gnorm=3.609, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58327
2022-05-08 12:38:24 - progress_bar.py[line:272] - INFO: epoch 002:  13937 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.747, expert1_balance_bottom=18.895, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=212.3, ups=0.56, wpb=381.2, bsz=32, num_updates=31600, lr=1.14785e-06, gnorm=4.033, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=58345
2022-05-08 12:38:42 - progress_bar.py[line:272] - INFO: epoch 002:  13947 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=377.7, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.516, expert1_balance_bottom=18.923, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.7, ups=0.56, wpb=377.7, bsz=32, num_updates=31610, lr=1.14485e-06, gnorm=3.358, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58363
2022-05-08 12:39:03 - progress_bar.py[line:272] - INFO: epoch 002:  13957 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.792, expert1_balance_bottom=18.981, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=185.6, ups=0.48, wpb=383.7, bsz=32, num_updates=31620, lr=1.14184e-06, gnorm=3.697, loss_scale=16, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58384
2022-05-08 12:39:22 - progress_bar.py[line:272] - INFO: epoch 002:  13967 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.99, expert1_balance_bottom=18.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=202.7, ups=0.53, wpb=384.8, bsz=32, num_updates=31630, lr=1.13884e-06, gnorm=3.483, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58403
2022-05-08 12:39:40 - progress_bar.py[line:272] - INFO: epoch 002:  13977 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=385.4, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.505, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=208.6, ups=0.54, wpb=385.4, bsz=32, num_updates=31640, lr=1.13584e-06, gnorm=3.799, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=58421
2022-05-08 12:39:58 - progress_bar.py[line:272] - INFO: epoch 002:  13987 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=387.7, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.576, expert1_balance_bottom=18.92, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.6, ups=0.56, wpb=387.7, bsz=32, num_updates=31650, lr=1.13283e-06, gnorm=3.328, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58439
2022-05-08 12:40:17 - progress_bar.py[line:272] - INFO: epoch 002:  13997 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=381.9, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882058, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.528, expert1_balance_bottom=18.957, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=207.2, ups=0.54, wpb=381.9, bsz=32, num_updates=31660, lr=1.12983e-06, gnorm=3.489, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58457
2022-05-08 12:40:35 - progress_bar.py[line:272] - INFO: epoch 002:  14007 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.13, expert1_balance_bottom=19.04, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=204.9, ups=0.54, wpb=382.1, bsz=32, num_updates=31670, lr=1.12683e-06, gnorm=3.749, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58476
2022-05-08 12:40:52 - progress_bar.py[line:272] - INFO: epoch 002:  14017 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=387.9, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.455, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226.8, ups=0.58, wpb=387.9, bsz=32, num_updates=31680, lr=1.12382e-06, gnorm=3.183, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58493
2022-05-08 12:41:10 - progress_bar.py[line:272] - INFO: epoch 002:  14027 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882322, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.558, expert1_balance_bottom=18.901, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=223, ups=0.58, wpb=382.8, bsz=32, num_updates=31690, lr=1.12082e-06, gnorm=3.283, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58510
2022-05-08 12:41:27 - progress_bar.py[line:272] - INFO: epoch 002:  14037 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.779, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.6, ups=0.58, wpb=381.3, bsz=32, num_updates=31700, lr=1.11782e-06, gnorm=3.017, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58527
2022-05-08 12:41:44 - progress_bar.py[line:272] - INFO: epoch 002:  14047 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.258, expert1_balance_bottom=19.12, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=226.4, ups=0.59, wpb=386.2, bsz=32, num_updates=31710, lr=1.11482e-06, gnorm=3.471, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58545
2022-05-08 12:42:01 - progress_bar.py[line:272] - INFO: epoch 002:  14057 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=385.9, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882545, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.658, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224, ups=0.58, wpb=385.9, bsz=32, num_updates=31720, lr=1.11181e-06, gnorm=3.76, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58562
2022-05-08 12:42:18 - progress_bar.py[line:272] - INFO: epoch 002:  14067 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=388.9, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.252, expert1_balance_bottom=19.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=227.7, ups=0.59, wpb=388.9, bsz=32, num_updates=31730, lr=1.10881e-06, gnorm=3.116, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58579
2022-05-08 12:42:35 - progress_bar.py[line:272] - INFO: epoch 002:  14077 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=392.4, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879388, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.625, expert1_balance_bottom=18.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=229.9, ups=0.59, wpb=392.4, bsz=32, num_updates=31740, lr=1.10581e-06, gnorm=2.88, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58596
2022-05-08 12:42:52 - progress_bar.py[line:272] - INFO: epoch 002:  14087 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=389.3, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882587, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.801, expert1_balance_bottom=18.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226.2, ups=0.58, wpb=389.3, bsz=32, num_updates=31750, lr=1.1028e-06, gnorm=3.342, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58613
2022-05-08 12:43:09 - progress_bar.py[line:272] - INFO: epoch 002:  14097 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=386.3, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.317, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=227.4, ups=0.59, wpb=386.3, bsz=32, num_updates=31760, lr=1.0998e-06, gnorm=3.748, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58630
2022-05-08 12:43:27 - progress_bar.py[line:272] - INFO: epoch 002:  14107 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=382.6, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.945, expert1_balance_bottom=18.846, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=222.8, ups=0.58, wpb=382.6, bsz=32, num_updates=31770, lr=1.0968e-06, gnorm=3.562, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58647
2022-05-08 12:43:44 - progress_bar.py[line:272] - INFO: epoch 002:  14117 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.848, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226.1, ups=0.59, wpb=384.5, bsz=32, num_updates=31780, lr=1.09379e-06, gnorm=3.606, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58664
2022-05-08 12:44:01 - progress_bar.py[line:272] - INFO: epoch 002:  14127 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.122, expert1_balance_bottom=19.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.1, ups=0.58, wpb=384.9, bsz=32, num_updates=31790, lr=1.09079e-06, gnorm=3.541, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58681
2022-05-08 12:44:17 - progress_bar.py[line:272] - INFO: epoch 002:  14137 / 17711 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=383.7, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.174, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.624, expert1_balance_bottom=18.97, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=229.5, ups=0.6, wpb=383.7, bsz=32, num_updates=31800, lr=1.08779e-06, gnorm=4.391, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58698
2022-05-08 12:44:35 - progress_bar.py[line:272] - INFO: epoch 002:  14147 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=372.7, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.031, expert1_balance_bottom=19.292, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.3, ups=0.58, wpb=372.7, bsz=32, num_updates=31810, lr=1.08478e-06, gnorm=3.109, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58715
2022-05-08 12:44:52 - progress_bar.py[line:272] - INFO: epoch 002:  14157 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=373.3, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897617, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.121, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=220.7, ups=0.59, wpb=373.3, bsz=32, num_updates=31820, lr=1.08178e-06, gnorm=3.998, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58732
reach the end of datafile, start a new reader
2022-05-08 12:45:08 - progress_bar.py[line:272] - INFO: epoch 002:  14167 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=373.3, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890267, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.019, expert1_balance_bottom=19.181, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.1, ups=0.59, wpb=373.3, bsz=32, num_updates=31830, lr=1.07878e-06, gnorm=3.395, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58749
2022-05-08 12:45:25 - progress_bar.py[line:272] - INFO: epoch 002:  14177 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=376.6, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.783, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223.7, ups=0.59, wpb=376.6, bsz=32, num_updates=31840, lr=1.07577e-06, gnorm=3.159, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58766
2022-05-08 12:45:43 - progress_bar.py[line:272] - INFO: epoch 002:  14187 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879438, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.859, expert1_balance_bottom=18.925, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.8, ups=0.55, wpb=381.1, bsz=32, num_updates=31850, lr=1.07277e-06, gnorm=3.482, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58784
2022-05-08 12:46:02 - progress_bar.py[line:272] - INFO: epoch 002:  14197 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.254, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=195.8, ups=0.52, wpb=375.5, bsz=32, num_updates=31860, lr=1.06977e-06, gnorm=3.515, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58803
2022-05-08 12:46:20 - progress_bar.py[line:272] - INFO: epoch 002:  14207 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=372.8, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.389, expert1_balance_bottom=19.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=211.4, ups=0.57, wpb=372.8, bsz=32, num_updates=31870, lr=1.06676e-06, gnorm=3.231, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58821
2022-05-08 12:46:38 - progress_bar.py[line:272] - INFO: epoch 002:  14217 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=390.2, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.023, expert1_balance_bottom=18.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217, ups=0.56, wpb=390.2, bsz=32, num_updates=31880, lr=1.06376e-06, gnorm=2.795, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58839
2022-05-08 12:46:56 - progress_bar.py[line:272] - INFO: epoch 002:  14227 / 17711 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=1.029, ntokens=392.1, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.23, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.738, expert1_balance_bottom=18.783, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.04, wps=218.5, ups=0.56, wpb=392.1, bsz=32, num_updates=31890, lr=1.06076e-06, gnorm=5.697, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58857
2022-05-08 12:47:14 - progress_bar.py[line:272] - INFO: epoch 002:  14237 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=373.8, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.896, expert1_balance_bottom=18.89, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.8, ups=0.57, wpb=373.8, bsz=32, num_updates=31900, lr=1.05775e-06, gnorm=3.169, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58874
2022-05-08 12:47:33 - progress_bar.py[line:272] - INFO: epoch 002:  14247 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884696, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.455, expert1_balance_bottom=19.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=203.6, ups=0.53, wpb=384.3, bsz=32, num_updates=31910, lr=1.05475e-06, gnorm=2.994, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58893
2022-05-08 12:47:50 - progress_bar.py[line:272] - INFO: epoch 002:  14257 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=382.2, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.137, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222.1, ups=0.58, wpb=382.2, bsz=32, num_updates=31920, lr=1.05175e-06, gnorm=4.945, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58911
2022-05-08 12:48:07 - progress_bar.py[line:272] - INFO: epoch 002:  14267 / 17711 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=390.4, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.185, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.476, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=229.4, ups=0.59, wpb=390.4, bsz=32, num_updates=31930, lr=1.04874e-06, gnorm=3.379, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58928
2022-05-08 12:48:26 - progress_bar.py[line:272] - INFO: epoch 002:  14277 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=391.8, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871415, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.338, expert1_balance_bottom=18.843, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=202.3, ups=0.52, wpb=391.8, bsz=32, num_updates=31940, lr=1.04574e-06, gnorm=3.403, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=58947
2022-05-08 12:48:45 - progress_bar.py[line:272] - INFO: epoch 002:  14287 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.098, expert1_balance_bottom=18.945, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=197.4, ups=0.52, wpb=380.2, bsz=32, num_updates=31950, lr=1.04274e-06, gnorm=3.355, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58966
2022-05-08 12:49:03 - progress_bar.py[line:272] - INFO: epoch 002:  14297 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=374.9, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.365, expert1_balance_bottom=19.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=211.6, ups=0.56, wpb=374.9, bsz=32, num_updates=31960, lr=1.03973e-06, gnorm=3.178, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=58984
2022-05-08 12:49:22 - progress_bar.py[line:272] - INFO: epoch 002:  14307 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=378.6, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.346, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=201, ups=0.53, wpb=378.6, bsz=32, num_updates=31970, lr=1.03673e-06, gnorm=3.615, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59003
2022-05-08 12:49:39 - progress_bar.py[line:272] - INFO: epoch 002:  14317 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883964, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.746, expert1_balance_bottom=18.83, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.9, ups=0.59, wpb=380.7, bsz=32, num_updates=31980, lr=1.03373e-06, gnorm=4.665, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=59020
2022-05-08 12:49:56 - progress_bar.py[line:272] - INFO: epoch 002:  14327 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=377.2, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.553, expert1_balance_bottom=19.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223, ups=0.59, wpb=377.2, bsz=32, num_updates=31990, lr=1.03072e-06, gnorm=3.074, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59037
2022-05-08 12:50:13 - progress_bar.py[line:272] - INFO: epoch 002:  14337 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.526, expert1_balance_bottom=18.938, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=225.8, ups=0.59, wpb=381.7, bsz=32, num_updates=32000, lr=1.02772e-06, gnorm=3.982, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59054
2022-05-08 12:50:30 - progress_bar.py[line:272] - INFO: epoch 002:  14347 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=379.7, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882508, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.76, expert1_balance_bottom=19.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.2, ups=0.58, wpb=379.7, bsz=32, num_updates=32010, lr=1.02472e-06, gnorm=3.838, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59071
2022-05-08 12:50:47 - progress_bar.py[line:272] - INFO: epoch 002:  14357 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.162, expert1_balance_bottom=19.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=222.8, ups=0.58, wpb=383.3, bsz=32, num_updates=32020, lr=1.02171e-06, gnorm=3.169, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59088
2022-05-08 12:51:04 - progress_bar.py[line:272] - INFO: epoch 002:  14367 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900033, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.956, expert1_balance_bottom=19.122, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.8, ups=0.59, wpb=381.3, bsz=32, num_updates=32030, lr=1.01871e-06, gnorm=3.385, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59105
2022-05-08 12:51:21 - progress_bar.py[line:272] - INFO: epoch 002:  14377 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=379.8, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889665, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.209, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.2, ups=0.58, wpb=379.8, bsz=32, num_updates=32040, lr=1.01571e-06, gnorm=3.98, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59122
2022-05-08 12:51:38 - progress_bar.py[line:272] - INFO: epoch 002:  14387 / 17711 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.178, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.892, expert1_balance_bottom=18.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=223, ups=0.59, wpb=379.7, bsz=32, num_updates=32050, lr=1.0127e-06, gnorm=3.187, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59139
2022-05-08 12:51:56 - progress_bar.py[line:272] - INFO: epoch 002:  14397 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=380, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889654, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.111, expert1_balance_bottom=19.023, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=217.8, ups=0.57, wpb=380, bsz=32, num_updates=32060, lr=1.0097e-06, gnorm=3.316, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59157
2022-05-08 12:52:16 - progress_bar.py[line:272] - INFO: epoch 002:  14407 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=371.4, nsentences=32, sample_size=295.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884048, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.565, expert1_balance_bottom=19.094, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=188.7, ups=0.51, wpb=371.4, bsz=32, num_updates=32070, lr=1.0067e-06, gnorm=4.167, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59176
2022-05-08 12:52:33 - progress_bar.py[line:272] - INFO: epoch 002:  14417 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.125, expert1_balance_bottom=18.895, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.1, ups=0.56, wpb=382.9, bsz=32, num_updates=32080, lr=1.00369e-06, gnorm=3.634, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=59194
2022-05-08 12:52:52 - progress_bar.py[line:272] - INFO: epoch 002:  14427 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=393.9, nsentences=32, sample_size=313.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.675, expert1_balance_bottom=18.871, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=209.2, ups=0.53, wpb=393.9, bsz=32, num_updates=32090, lr=1.00069e-06, gnorm=3.458, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59213
2022-05-08 12:53:09 - progress_bar.py[line:272] - INFO: epoch 002:  14437 / 17711 loss=3.164, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=381.5, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.164, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.19, expert1_balance_bottom=19.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=224.6, ups=0.59, wpb=381.5, bsz=32, num_updates=32100, lr=9.97687e-07, gnorm=3.529, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59230
2022-05-08 12:53:26 - progress_bar.py[line:272] - INFO: epoch 002:  14447 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=378.9, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890894, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.366, expert1_balance_bottom=18.976, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.5, ups=0.58, wpb=378.9, bsz=32, num_updates=32110, lr=9.94684e-07, gnorm=2.88, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59247
2022-05-08 12:53:44 - progress_bar.py[line:272] - INFO: epoch 002:  14457 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892082, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.187, expert1_balance_bottom=19.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.1, ups=0.58, wpb=385, bsz=32, num_updates=32120, lr=9.91681e-07, gnorm=3.127, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59264
2022-05-08 12:54:01 - progress_bar.py[line:272] - INFO: epoch 002:  14467 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=380.7, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.864, expert1_balance_bottom=18.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.4, ups=0.59, wpb=380.7, bsz=32, num_updates=32130, lr=9.88678e-07, gnorm=3.554, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59282
2022-05-08 12:54:19 - progress_bar.py[line:272] - INFO: epoch 002:  14477 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.646, expert1_balance_bottom=19.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=204.9, ups=0.54, wpb=381, bsz=32, num_updates=32140, lr=9.85674e-07, gnorm=3.428, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59300
2022-05-08 12:54:39 - progress_bar.py[line:272] - INFO: epoch 002:  14487 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875305, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.601, expert1_balance_bottom=19.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=193.2, ups=0.5, wpb=385.3, bsz=32, num_updates=32150, lr=9.82671e-07, gnorm=3.176, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59320
2022-05-08 12:54:57 - progress_bar.py[line:272] - INFO: epoch 002:  14497 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882837, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.632, expert1_balance_bottom=19.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.3, ups=0.57, wpb=378.4, bsz=32, num_updates=32160, lr=9.79668e-07, gnorm=3.757, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59337
2022-05-08 12:55:15 - progress_bar.py[line:272] - INFO: epoch 002:  14507 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.031, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=205.4, ups=0.54, wpb=382.8, bsz=32, num_updates=32170, lr=9.76665e-07, gnorm=3.355, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59356
2022-05-08 12:55:32 - progress_bar.py[line:272] - INFO: epoch 002:  14517 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=33.987, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=225.5, ups=0.59, wpb=384.3, bsz=32, num_updates=32180, lr=9.73661e-07, gnorm=2.827, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59373
2022-05-08 12:55:51 - progress_bar.py[line:272] - INFO: epoch 002:  14527 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.432, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=200, ups=0.53, wpb=380.8, bsz=32, num_updates=32190, lr=9.70658e-07, gnorm=3.829, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59392
2022-05-08 12:56:10 - progress_bar.py[line:272] - INFO: epoch 002:  14537 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=382.3, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.243, expert1_balance_bottom=19.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=203.4, ups=0.53, wpb=382.3, bsz=32, num_updates=32200, lr=9.67655e-07, gnorm=3.451, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59411
2022-05-08 12:56:29 - progress_bar.py[line:272] - INFO: epoch 002:  14547 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900396, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.512, expert1_balance_bottom=19.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=206.9, ups=0.54, wpb=385.4, bsz=32, num_updates=32210, lr=9.64651e-07, gnorm=3.11, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59430
2022-05-08 12:56:46 - progress_bar.py[line:272] - INFO: epoch 002:  14557 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=390.8, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.137, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=228.7, ups=0.59, wpb=390.8, bsz=32, num_updates=32220, lr=9.61648e-07, gnorm=3.31, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59447
2022-05-08 12:57:03 - progress_bar.py[line:272] - INFO: epoch 002:  14567 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=388.6, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872728, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.231, expert1_balance_bottom=18.878, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=225.3, ups=0.58, wpb=388.6, bsz=32, num_updates=32230, lr=9.58645e-07, gnorm=3.391, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59464
2022-05-08 12:57:20 - progress_bar.py[line:272] - INFO: epoch 002:  14577 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880532, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.636, expert1_balance_bottom=19.047, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224.9, ups=0.59, wpb=381, bsz=32, num_updates=32240, lr=9.55642e-07, gnorm=3.428, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59481
2022-05-08 12:57:37 - progress_bar.py[line:272] - INFO: epoch 002:  14587 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883448, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.268, expert1_balance_bottom=19.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=220.9, ups=0.58, wpb=379.6, bsz=32, num_updates=32250, lr=9.52638e-07, gnorm=3.692, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59498
2022-05-08 12:57:54 - progress_bar.py[line:272] - INFO: epoch 002:  14597 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.587, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=226.8, ups=0.6, wpb=380.9, bsz=32, num_updates=32260, lr=9.49635e-07, gnorm=2.815, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59515
2022-05-08 12:58:11 - progress_bar.py[line:272] - INFO: epoch 002:  14607 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=378.3, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894245, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.708, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.8, ups=0.58, wpb=378.3, bsz=32, num_updates=32270, lr=9.46632e-07, gnorm=3.256, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59532
2022-05-08 12:58:28 - progress_bar.py[line:272] - INFO: epoch 002:  14617 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.846, expert1_balance_bottom=18.8, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=222.6, ups=0.59, wpb=378.5, bsz=32, num_updates=32280, lr=9.43629e-07, gnorm=3.59, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59549
2022-05-08 12:58:45 - progress_bar.py[line:272] - INFO: epoch 002:  14627 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.807, expert1_balance_bottom=18.865, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.9, ups=0.59, wpb=380.7, bsz=32, num_updates=32290, lr=9.40625e-07, gnorm=3.311, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59566
2022-05-08 12:59:02 - progress_bar.py[line:272] - INFO: epoch 002:  14637 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885702, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.192, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=227.2, ups=0.6, wpb=380.9, bsz=32, num_updates=32300, lr=9.37622e-07, gnorm=3.628, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59583
2022-05-08 12:59:19 - progress_bar.py[line:272] - INFO: epoch 002:  14647 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=377.3, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89554, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.168, expert1_balance_bottom=18.939, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222, ups=0.59, wpb=377.3, bsz=32, num_updates=32310, lr=9.34619e-07, gnorm=3.75, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59600
2022-05-08 12:59:36 - progress_bar.py[line:272] - INFO: epoch 002:  14657 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=388.6, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.408, expert1_balance_bottom=19.004, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.9, ups=0.57, wpb=388.6, bsz=32, num_updates=32320, lr=9.31615e-07, gnorm=3.808, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59617
2022-05-08 12:59:55 - progress_bar.py[line:272] - INFO: epoch 002:  14667 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.54, expert1_balance_bottom=19.039, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=210.5, ups=0.55, wpb=381.9, bsz=32, num_updates=32330, lr=9.28612e-07, gnorm=3.702, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59635
2022-05-08 13:00:14 - progress_bar.py[line:272] - INFO: epoch 002:  14677 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891929, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.962, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=199.6, ups=0.52, wpb=380.7, bsz=32, num_updates=32340, lr=9.25609e-07, gnorm=3.075, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59654
2022-05-08 13:00:31 - progress_bar.py[line:272] - INFO: epoch 002:  14687 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=389.7, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885145, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.256, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=222.1, ups=0.57, wpb=389.7, bsz=32, num_updates=32350, lr=9.22606e-07, gnorm=3.485, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59672
2022-05-08 13:00:49 - progress_bar.py[line:272] - INFO: epoch 002:  14697 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=387.6, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.787, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=214.5, ups=0.55, wpb=387.6, bsz=32, num_updates=32360, lr=9.19602e-07, gnorm=4.983, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59690
2022-05-08 13:01:06 - progress_bar.py[line:272] - INFO: epoch 002:  14707 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=376.8, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.315, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.8, ups=0.59, wpb=376.8, bsz=32, num_updates=32370, lr=9.16599e-07, gnorm=2.98, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=59707
2022-05-08 13:01:23 - progress_bar.py[line:272] - INFO: epoch 002:  14717 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=385.2, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.188, expert1_balance_bottom=19.059, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=226.4, ups=0.59, wpb=385.2, bsz=32, num_updates=32380, lr=9.13596e-07, gnorm=3.287, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59724
2022-05-08 13:01:40 - progress_bar.py[line:272] - INFO: epoch 002:  14727 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=389.6, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876422, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.991, expert1_balance_bottom=18.898, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=227.1, ups=0.58, wpb=389.6, bsz=32, num_updates=32390, lr=9.10593e-07, gnorm=3.305, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59741
2022-05-08 13:01:57 - progress_bar.py[line:272] - INFO: epoch 002:  14737 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=388.4, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.884, expert1_balance_bottom=19.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=226.8, ups=0.58, wpb=388.4, bsz=32, num_updates=32400, lr=9.07589e-07, gnorm=3.584, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59758
2022-05-08 13:02:15 - progress_bar.py[line:272] - INFO: epoch 002:  14747 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=390.7, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874547, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.356, expert1_balance_bottom=18.823, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=227.2, ups=0.58, wpb=390.7, bsz=32, num_updates=32410, lr=9.04586e-07, gnorm=3.876, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59775
2022-05-08 13:02:32 - progress_bar.py[line:272] - INFO: epoch 002:  14757 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=387, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=35.507, expert1_balance_bottom=18.791, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=227, ups=0.59, wpb=387, bsz=32, num_updates=32420, lr=9.01583e-07, gnorm=3.633, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59792
2022-05-08 13:02:49 - progress_bar.py[line:272] - INFO: epoch 002:  14767 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871758, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.368, expert1_balance_bottom=18.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.3, ups=0.59, wpb=382.9, bsz=32, num_updates=32430, lr=8.98579e-07, gnorm=4.19, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=59809
2022-05-08 13:03:09 - progress_bar.py[line:272] - INFO: epoch 002:  14777 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.996, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=192.2, ups=0.5, wpb=384.2, bsz=32, num_updates=32440, lr=8.95576e-07, gnorm=3.254, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59829
2022-05-08 13:03:26 - progress_bar.py[line:272] - INFO: epoch 002:  14787 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.805, expert1_balance_bottom=19.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.3, ups=0.56, wpb=380.6, bsz=32, num_updates=32450, lr=8.92573e-07, gnorm=3.735, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59847
2022-05-08 13:03:45 - progress_bar.py[line:272] - INFO: epoch 002:  14797 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.398, expert1_balance_bottom=18.704, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=204.5, ups=0.54, wpb=381, bsz=32, num_updates=32460, lr=8.8957e-07, gnorm=3.094, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59866
2022-05-08 13:04:02 - progress_bar.py[line:272] - INFO: epoch 002:  14807 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=387, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.84, expert1_balance_bottom=18.964, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=224.4, ups=0.58, wpb=387, bsz=32, num_updates=32470, lr=8.86566e-07, gnorm=3.441, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=59883
2022-05-08 13:04:20 - progress_bar.py[line:272] - INFO: epoch 002:  14817 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=384, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886121, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.53, expert1_balance_bottom=18.961, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.5, ups=0.57, wpb=384, bsz=32, num_updates=32480, lr=8.83563e-07, gnorm=3.584, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59901
2022-05-08 13:04:39 - progress_bar.py[line:272] - INFO: epoch 002:  14827 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=389.9, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.176, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=202.7, ups=0.52, wpb=389.9, bsz=32, num_updates=32490, lr=8.8056e-07, gnorm=3.089, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59920
2022-05-08 13:04:57 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-05-08 13:04:59 - progress_bar.py[line:272] - INFO: epoch 002:  14838 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=385.9, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.442, expert1_balance_bottom=19.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=193.2, ups=0.5, wpb=385.9, bsz=32, num_updates=32500, lr=8.77557e-07, gnorm=3.421, loss_scale=16, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59940
2022-05-08 13:05:18 - progress_bar.py[line:272] - INFO: epoch 002:  14848 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.55, expert1_balance_bottom=18.953, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=202.8, ups=0.53, wpb=383.2, bsz=32, num_updates=32510, lr=8.74553e-07, gnorm=3.391, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59959
2022-05-08 13:05:35 - progress_bar.py[line:272] - INFO: epoch 002:  14858 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=388.2, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884171, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.452, expert1_balance_bottom=19.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=227.1, ups=0.59, wpb=388.2, bsz=32, num_updates=32520, lr=8.7155e-07, gnorm=2.874, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59976
2022-05-08 13:05:53 - progress_bar.py[line:272] - INFO: epoch 002:  14868 / 17711 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882435, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.16, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.676, expert1_balance_bottom=18.948, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=213.9, ups=0.56, wpb=383.7, bsz=32, num_updates=32530, lr=8.68547e-07, gnorm=3.458, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=59994
2022-05-08 13:06:12 - progress_bar.py[line:272] - INFO: epoch 002:  14878 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=386.3, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.182, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=200.2, ups=0.52, wpb=386.3, bsz=32, num_updates=32540, lr=8.65543e-07, gnorm=3.309, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60013
2022-05-08 13:06:30 - progress_bar.py[line:272] - INFO: epoch 002:  14888 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.302, expert1_balance_bottom=18.682, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.9, ups=0.56, wpb=383.3, bsz=32, num_updates=32550, lr=8.6254e-07, gnorm=3.195, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60031
2022-05-08 13:06:49 - progress_bar.py[line:272] - INFO: epoch 002:  14898 / 17711 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.166, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.171, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=206.9, ups=0.54, wpb=384.7, bsz=32, num_updates=32560, lr=8.59537e-07, gnorm=3.688, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60049
2022-05-08 13:07:06 - progress_bar.py[line:272] - INFO: epoch 002:  14908 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=376, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893696, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.909, expert1_balance_bottom=19.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.3, ups=0.59, wpb=376, bsz=32, num_updates=32570, lr=8.56534e-07, gnorm=3.871, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=60066
2022-05-08 13:07:22 - progress_bar.py[line:272] - INFO: epoch 002:  14918 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=373.8, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892882, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.79, expert1_balance_bottom=19.155, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.3, ups=0.6, wpb=373.8, bsz=32, num_updates=32580, lr=8.5353e-07, gnorm=3.653, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60083
2022-05-08 13:07:39 - progress_bar.py[line:272] - INFO: epoch 002:  14928 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=377.5, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886023, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.532, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=221.5, ups=0.59, wpb=377.5, bsz=32, num_updates=32590, lr=8.50527e-07, gnorm=3.511, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60100
2022-05-08 13:07:57 - progress_bar.py[line:272] - INFO: epoch 002:  14938 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.837, expert1_balance_bottom=18.83, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.5, ups=0.58, wpb=378.8, bsz=32, num_updates=32600, lr=8.47524e-07, gnorm=3.62, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60117
2022-05-08 13:08:14 - progress_bar.py[line:272] - INFO: epoch 002:  14948 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=397.6, nsentences=32, sample_size=316.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879807, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.44, expert1_balance_bottom=19.035, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=232.1, ups=0.58, wpb=397.6, bsz=32, num_updates=32610, lr=8.44521e-07, gnorm=3.363, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60135
2022-05-08 13:08:31 - progress_bar.py[line:272] - INFO: epoch 002:  14958 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.642, expert1_balance_bottom=18.83, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=226.1, ups=0.59, wpb=385.1, bsz=32, num_updates=32620, lr=8.41517e-07, gnorm=3.05, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60152
2022-05-08 13:08:48 - progress_bar.py[line:272] - INFO: epoch 002:  14968 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=382.1, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.102, expert1_balance_bottom=18.84, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=222.4, ups=0.58, wpb=382.1, bsz=32, num_updates=32630, lr=8.38514e-07, gnorm=3.503, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=60169
2022-05-08 13:09:05 - progress_bar.py[line:272] - INFO: epoch 002:  14978 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895055, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.734, expert1_balance_bottom=19.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.2, ups=0.58, wpb=379.1, bsz=32, num_updates=32640, lr=8.35511e-07, gnorm=3.45, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60186
2022-05-08 13:09:22 - progress_bar.py[line:272] - INFO: epoch 002:  14988 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=372.5, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.266, expert1_balance_bottom=19.308, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.2, ups=0.58, wpb=372.5, bsz=32, num_updates=32650, lr=8.32507e-07, gnorm=3.56, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60203
2022-05-08 13:09:40 - progress_bar.py[line:272] - INFO: epoch 002:  14998 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=374.2, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.159, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.3, ups=0.58, wpb=374.2, bsz=32, num_updates=32660, lr=8.29504e-07, gnorm=3.562, loss_scale=16, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=60220
2022-05-08 13:10:00 - progress_bar.py[line:272] - INFO: epoch 002:  15008 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883974, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.7, expert1_balance_bottom=18.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=192.9, ups=0.5, wpb=386, bsz=32, num_updates=32670, lr=8.26501e-07, gnorm=3.511, loss_scale=16, train_wall=19, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=60240
2022-05-08 13:10:17 - progress_bar.py[line:272] - INFO: epoch 002:  15018 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.084, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.4, ups=0.57, wpb=387.9, bsz=32, num_updates=32680, lr=8.23498e-07, gnorm=3.225, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60258
2022-05-08 13:10:35 - progress_bar.py[line:272] - INFO: epoch 002:  15028 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=379.2, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.594, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=211.6, ups=0.56, wpb=379.2, bsz=32, num_updates=32690, lr=8.20494e-07, gnorm=3.052, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60276
2022-05-08 13:10:54 - progress_bar.py[line:272] - INFO: epoch 002:  15038 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=380.9, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882688, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.798, expert1_balance_bottom=18.912, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=200, ups=0.53, wpb=380.9, bsz=32, num_updates=32700, lr=8.17491e-07, gnorm=3.571, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60295
2022-05-08 13:11:12 - progress_bar.py[line:272] - INFO: epoch 002:  15048 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.295, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.6, ups=0.55, wpb=384.9, bsz=32, num_updates=32710, lr=8.14488e-07, gnorm=3.277, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=60313
2022-05-08 13:11:30 - progress_bar.py[line:272] - INFO: epoch 002:  15058 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.782, expert1_balance_bottom=18.842, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=219.1, ups=0.57, wpb=381.3, bsz=32, num_updates=32720, lr=8.11485e-07, gnorm=3.297, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60330
2022-05-08 13:11:47 - progress_bar.py[line:272] - INFO: epoch 002:  15068 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.565, expert1_balance_bottom=18.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.1, ups=0.56, wpb=381.1, bsz=32, num_updates=32730, lr=8.08481e-07, gnorm=3.281, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60348
2022-05-08 13:12:06 - progress_bar.py[line:272] - INFO: epoch 002:  15078 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=385.8, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=35.068, expert1_balance_bottom=18.899, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=212.5, ups=0.55, wpb=385.8, bsz=32, num_updates=32740, lr=8.05478e-07, gnorm=3.915, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=60366
2022-05-08 13:12:27 - progress_bar.py[line:272] - INFO: epoch 002:  15088 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=390.9, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=35.002, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=180.1, ups=0.46, wpb=390.9, bsz=32, num_updates=32750, lr=8.02475e-07, gnorm=3.69, loss_scale=16, train_wall=21, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60388
2022-05-08 13:12:47 - progress_bar.py[line:272] - INFO: epoch 002:  15098 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=389.3, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885026, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.545, expert1_balance_bottom=18.874, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=195.4, ups=0.5, wpb=389.3, bsz=32, num_updates=32760, lr=7.99471e-07, gnorm=3.735, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60408
2022-05-08 13:13:05 - progress_bar.py[line:272] - INFO: epoch 002:  15108 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=384.4, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.657, expert1_balance_bottom=19.113, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.9, ups=0.56, wpb=384.4, bsz=32, num_updates=32770, lr=7.96468e-07, gnorm=3.582, loss_scale=16, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=60426
2022-05-08 13:13:23 - progress_bar.py[line:272] - INFO: epoch 002:  15118 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.166, expert1_balance_bottom=18.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217, ups=0.57, wpb=380.7, bsz=32, num_updates=32780, lr=7.93465e-07, gnorm=3.942, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60443
2022-05-08 13:13:40 - progress_bar.py[line:272] - INFO: epoch 002:  15128 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=377.7, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.841, expert1_balance_bottom=18.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.9, ups=0.56, wpb=377.7, bsz=32, num_updates=32790, lr=7.90462e-07, gnorm=3.354, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60461
2022-05-08 13:13:58 - progress_bar.py[line:272] - INFO: epoch 002:  15138 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=375.1, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894834, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.091, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=208.6, ups=0.56, wpb=375.1, bsz=32, num_updates=32800, lr=7.87458e-07, gnorm=3.063, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60479
2022-05-08 13:14:20 - progress_bar.py[line:272] - INFO: epoch 002:  15148 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893016, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.73, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=178.2, ups=0.47, wpb=380.1, bsz=32, num_updates=32810, lr=7.84455e-07, gnorm=3.221, loss_scale=16, train_wall=20, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60501
2022-05-08 13:14:39 - progress_bar.py[line:272] - INFO: epoch 002:  15158 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=392.9, nsentences=32, sample_size=312.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879044, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.726, expert1_balance_bottom=19.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=202.3, ups=0.51, wpb=392.9, bsz=32, num_updates=32820, lr=7.81452e-07, gnorm=3.73, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60520
2022-05-08 13:14:58 - progress_bar.py[line:272] - INFO: epoch 002:  15168 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=391.3, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.007, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=212.5, ups=0.54, wpb=391.3, bsz=32, num_updates=32830, lr=7.78449e-07, gnorm=3.783, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60538
2022-05-08 13:15:16 - progress_bar.py[line:272] - INFO: epoch 002:  15178 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888686, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.326, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.1, ups=0.56, wpb=381.7, bsz=32, num_updates=32840, lr=7.75445e-07, gnorm=3.36, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60556
2022-05-08 13:15:33 - progress_bar.py[line:272] - INFO: epoch 002:  15188 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=392, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.096, expert1_balance_bottom=19.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=219.3, ups=0.56, wpb=392, bsz=32, num_updates=32850, lr=7.72442e-07, gnorm=2.872, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60574
2022-05-08 13:15:51 - progress_bar.py[line:272] - INFO: epoch 002:  15198 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.904, expert1_balance_bottom=19.374, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=211.2, ups=0.55, wpb=382.5, bsz=32, num_updates=32860, lr=7.69439e-07, gnorm=3.405, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60592
2022-05-08 13:16:10 - progress_bar.py[line:272] - INFO: epoch 002:  15208 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=378.3, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888186, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.246, expert1_balance_bottom=19.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.2, ups=0.55, wpb=378.3, bsz=32, num_updates=32870, lr=7.66435e-07, gnorm=3.394, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60610
2022-05-08 13:16:30 - progress_bar.py[line:272] - INFO: epoch 002:  15218 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=367.4, nsentences=32, sample_size=292.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893345, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.256, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=183.5, ups=0.5, wpb=367.4, bsz=32, num_updates=32880, lr=7.63432e-07, gnorm=3.659, loss_scale=16, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60630
2022-05-08 13:16:46 - progress_bar.py[line:272] - INFO: epoch 002:  15228 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=373.2, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.589, expert1_balance_bottom=19.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221, ups=0.59, wpb=373.2, bsz=32, num_updates=32890, lr=7.60429e-07, gnorm=3.22, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60647
2022-05-08 13:17:04 - progress_bar.py[line:272] - INFO: epoch 002:  15238 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.473, expert1_balance_bottom=19.312, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=222.8, ups=0.59, wpb=380.5, bsz=32, num_updates=32900, lr=7.57426e-07, gnorm=3.367, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60664
2022-05-08 13:17:20 - progress_bar.py[line:272] - INFO: epoch 002:  15248 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890051, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.87, expert1_balance_bottom=19.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=231.5, ups=0.6, wpb=384.7, bsz=32, num_updates=32910, lr=7.54422e-07, gnorm=3.438, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60681
2022-05-08 13:17:37 - progress_bar.py[line:272] - INFO: epoch 002:  15258 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=383, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891097, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.082, expert1_balance_bottom=19.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.3, ups=0.59, wpb=383, bsz=32, num_updates=32920, lr=7.51419e-07, gnorm=3.556, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60698
2022-05-08 13:17:54 - progress_bar.py[line:272] - INFO: epoch 002:  15268 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=388.6, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.121, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=228.8, ups=0.59, wpb=388.6, bsz=32, num_updates=32930, lr=7.48416e-07, gnorm=3.49, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60715
2022-05-08 13:18:11 - progress_bar.py[line:272] - INFO: epoch 002:  15278 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=390.5, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872232, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=35.164, expert1_balance_bottom=18.831, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=228.2, ups=0.58, wpb=390.5, bsz=32, num_updates=32940, lr=7.45412e-07, gnorm=3.795, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60732
2022-05-08 13:18:28 - progress_bar.py[line:272] - INFO: epoch 002:  15288 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=382, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886118, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.27, expert1_balance_bottom=19.171, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=226, ups=0.59, wpb=382, bsz=32, num_updates=32950, lr=7.42409e-07, gnorm=3.493, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60749
2022-05-08 13:18:45 - progress_bar.py[line:272] - INFO: epoch 002:  15298 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=377, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890241, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.404, expert1_balance_bottom=19.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221, ups=0.59, wpb=377, bsz=32, num_updates=32960, lr=7.39406e-07, gnorm=3.609, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60766
2022-05-08 13:19:02 - progress_bar.py[line:272] - INFO: epoch 002:  15308 / 17711 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.957, ntokens=387.9, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.168, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.369, expert1_balance_bottom=18.864, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=227.6, ups=0.59, wpb=387.9, bsz=32, num_updates=32970, lr=7.36403e-07, gnorm=3.732, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60783
2022-05-08 13:19:20 - progress_bar.py[line:272] - INFO: epoch 002:  15318 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=384.5, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886416, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.689, expert1_balance_bottom=18.931, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.2, ups=0.58, wpb=384.5, bsz=32, num_updates=32980, lr=7.33399e-07, gnorm=3.354, loss_scale=16, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60800
2022-05-08 13:19:37 - progress_bar.py[line:272] - INFO: epoch 002:  15328 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=386.4, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867081, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=35.542, expert1_balance_bottom=18.728, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219.7, ups=0.57, wpb=386.4, bsz=32, num_updates=32990, lr=7.30396e-07, gnorm=3.619, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60818
2022-05-08 13:19:56 - progress_bar.py[line:272] - INFO: epoch 002:  15338 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=390.6, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883134, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.77, expert1_balance_bottom=18.812, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.6, ups=0.54, wpb=390.6, bsz=32, num_updates=33000, lr=7.27393e-07, gnorm=3.453, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60836
2022-05-08 13:20:15 - progress_bar.py[line:272] - INFO: epoch 002:  15348 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.864, expert1_balance_bottom=19.218, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=201.5, ups=0.52, wpb=384, bsz=32, num_updates=33010, lr=7.2439e-07, gnorm=3.223, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60855
2022-05-08 13:20:35 - progress_bar.py[line:272] - INFO: epoch 002:  15358 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878734, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.874, expert1_balance_bottom=19.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=191.3, ups=0.5, wpb=383.8, bsz=32, num_updates=33020, lr=7.21386e-07, gnorm=3.564, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60876
2022-05-08 13:20:53 - progress_bar.py[line:272] - INFO: epoch 002:  15368 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=390.1, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877589, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.751, expert1_balance_bottom=18.988, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=218.4, ups=0.56, wpb=390.1, bsz=32, num_updates=33030, lr=7.18383e-07, gnorm=3.609, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60893
2022-05-08 13:21:11 - progress_bar.py[line:272] - INFO: epoch 002:  15378 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=386.2, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.043, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=208, ups=0.54, wpb=386.2, bsz=32, num_updates=33040, lr=7.1538e-07, gnorm=3.66, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60912
2022-05-08 13:21:28 - progress_bar.py[line:272] - INFO: epoch 002:  15388 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=378.6, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878646, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.834, expert1_balance_bottom=19.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=220.6, ups=0.58, wpb=378.6, bsz=32, num_updates=33050, lr=7.12376e-07, gnorm=3.446, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60929
2022-05-08 13:21:46 - progress_bar.py[line:272] - INFO: epoch 002:  15398 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=374.8, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.159, expert1_balance_bottom=19.137, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.9, ups=0.57, wpb=374.8, bsz=32, num_updates=33060, lr=7.09373e-07, gnorm=3.779, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60947
2022-05-08 13:22:03 - progress_bar.py[line:272] - INFO: epoch 002:  15408 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=386.6, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.284, expert1_balance_bottom=18.961, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=221, ups=0.57, wpb=386.6, bsz=32, num_updates=33070, lr=7.0637e-07, gnorm=3.445, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60964
2022-05-08 13:22:20 - progress_bar.py[line:272] - INFO: epoch 002:  15418 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.119, expert1_balance_bottom=18.746, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.7, ups=0.58, wpb=381.3, bsz=32, num_updates=33080, lr=7.03367e-07, gnorm=3.748, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60981
2022-05-08 13:22:38 - progress_bar.py[line:272] - INFO: epoch 002:  15428 / 17711 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.174, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.086, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=216.8, ups=0.57, wpb=380.5, bsz=32, num_updates=33090, lr=7.00363e-07, gnorm=4.136, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=60999
2022-05-08 13:22:55 - progress_bar.py[line:272] - INFO: epoch 002:  15438 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=390.6, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881686, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.834, expert1_balance_bottom=18.852, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=226.8, ups=0.58, wpb=390.6, bsz=32, num_updates=33100, lr=6.9736e-07, gnorm=3.532, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61016
2022-05-08 13:23:12 - progress_bar.py[line:272] - INFO: epoch 002:  15448 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=383.1, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.239, expert1_balance_bottom=19.093, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223, ups=0.58, wpb=383.1, bsz=32, num_updates=33110, lr=6.94357e-07, gnorm=2.94, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61033
2022-05-08 13:23:30 - progress_bar.py[line:272] - INFO: epoch 002:  15458 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886165, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.014, expert1_balance_bottom=18.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.8, ups=0.56, wpb=379.9, bsz=32, num_updates=33120, lr=6.91354e-07, gnorm=3.323, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61051
2022-05-08 13:23:47 - progress_bar.py[line:272] - INFO: epoch 002:  15468 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=388.7, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.902, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=229.7, ups=0.59, wpb=388.7, bsz=32, num_updates=33130, lr=6.8835e-07, gnorm=3.307, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61068
2022-05-08 13:24:04 - progress_bar.py[line:272] - INFO: epoch 002:  15478 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=383.1, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.659, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=224.7, ups=0.59, wpb=383.1, bsz=32, num_updates=33140, lr=6.85347e-07, gnorm=3.115, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61085
2022-05-08 13:24:24 - progress_bar.py[line:272] - INFO: epoch 002:  15488 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=35.029, expert1_balance_bottom=18.968, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=187.7, ups=0.49, wpb=380.4, bsz=32, num_updates=33150, lr=6.82344e-07, gnorm=3.698, loss_scale=32, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61105
2022-05-08 13:24:43 - progress_bar.py[line:272] - INFO: epoch 002:  15498 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.401, expert1_balance_bottom=19.087, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.9, ups=0.55, wpb=384, bsz=32, num_updates=33160, lr=6.7934e-07, gnorm=3.457, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61123
2022-05-08 13:25:00 - progress_bar.py[line:272] - INFO: epoch 002:  15508 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=381.6, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.487, expert1_balance_bottom=19.02, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.3, ups=0.56, wpb=381.6, bsz=32, num_updates=33170, lr=6.76337e-07, gnorm=3.33, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61141
2022-05-08 13:25:18 - progress_bar.py[line:272] - INFO: epoch 002:  15518 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=392.2, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=35.611, expert1_balance_bottom=18.729, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=218.7, ups=0.56, wpb=392.2, bsz=32, num_updates=33180, lr=6.73334e-07, gnorm=3.618, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61159
2022-05-08 13:25:38 - progress_bar.py[line:272] - INFO: epoch 002:  15528 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880196, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.85, expert1_balance_bottom=18.882, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=199.2, ups=0.52, wpb=385.6, bsz=32, num_updates=33190, lr=6.70331e-07, gnorm=3.813, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61179
2022-05-08 13:25:55 - progress_bar.py[line:272] - INFO: epoch 002:  15538 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=384, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.075, expert1_balance_bottom=18.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.9, ups=0.59, wpb=384, bsz=32, num_updates=33200, lr=6.67327e-07, gnorm=3.381, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61196
2022-05-08 13:26:12 - progress_bar.py[line:272] - INFO: epoch 002:  15548 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=389, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87103, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=35.147, expert1_balance_bottom=18.834, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226.6, ups=0.58, wpb=389, bsz=32, num_updates=33210, lr=6.64324e-07, gnorm=3.141, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61213
2022-05-08 13:26:32 - progress_bar.py[line:272] - INFO: epoch 002:  15558 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=384, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877193, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.695, expert1_balance_bottom=18.901, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=191.1, ups=0.5, wpb=384, bsz=32, num_updates=33220, lr=6.61321e-07, gnorm=3.6, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61233
2022-05-08 13:26:50 - progress_bar.py[line:272] - INFO: epoch 002:  15568 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=374.5, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889726, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.368, expert1_balance_bottom=18.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.2, ups=0.56, wpb=374.5, bsz=32, num_updates=33230, lr=6.58318e-07, gnorm=3.351, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61251
2022-05-08 13:27:08 - progress_bar.py[line:272] - INFO: epoch 002:  15578 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.096, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=205.3, ups=0.54, wpb=383.3, bsz=32, num_updates=33240, lr=6.55314e-07, gnorm=3.344, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61269
2022-05-08 13:27:26 - progress_bar.py[line:272] - INFO: epoch 002:  15588 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.749, expert1_balance_bottom=19.037, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.5, ups=0.56, wpb=385.4, bsz=32, num_updates=33250, lr=6.52311e-07, gnorm=3.313, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61287
2022-05-08 13:27:45 - progress_bar.py[line:272] - INFO: epoch 002:  15598 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888075, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.643, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=208.2, ups=0.54, wpb=386.4, bsz=32, num_updates=33260, lr=6.49308e-07, gnorm=3.207, loss_scale=32, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61306
2022-05-08 13:28:04 - progress_bar.py[line:272] - INFO: epoch 002:  15608 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=385.6, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.125, expert1_balance_bottom=19.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=205.4, ups=0.53, wpb=385.6, bsz=32, num_updates=33270, lr=6.46304e-07, gnorm=3.928, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61324
2022-05-08 13:28:21 - progress_bar.py[line:272] - INFO: epoch 002:  15618 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=376.2, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.861, expert1_balance_bottom=19.189, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.9, ups=0.57, wpb=376.2, bsz=32, num_updates=33280, lr=6.43301e-07, gnorm=3.005, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=61342
2022-05-08 13:28:39 - progress_bar.py[line:272] - INFO: epoch 002:  15628 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=389.5, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883689, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.681, expert1_balance_bottom=18.898, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=217.8, ups=0.56, wpb=389.5, bsz=32, num_updates=33290, lr=6.40298e-07, gnorm=3.871, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61360
2022-05-08 13:28:59 - progress_bar.py[line:272] - INFO: epoch 002:  15638 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=377.5, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885435, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.676, expert1_balance_bottom=18.87, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=188.9, ups=0.5, wpb=377.5, bsz=32, num_updates=33300, lr=6.37295e-07, gnorm=4.046, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61380
2022-05-08 13:29:17 - progress_bar.py[line:272] - INFO: epoch 002:  15648 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=379.8, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.904, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216, ups=0.57, wpb=379.8, bsz=32, num_updates=33310, lr=6.34291e-07, gnorm=3.027, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61398
2022-05-08 13:29:35 - progress_bar.py[line:272] - INFO: epoch 002:  15658 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.588, expert1_balance_bottom=18.944, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206.2, ups=0.54, wpb=379.6, bsz=32, num_updates=33320, lr=6.31288e-07, gnorm=3.009, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61416
2022-05-08 13:29:53 - progress_bar.py[line:272] - INFO: epoch 002:  15668 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884901, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.684, expert1_balance_bottom=18.924, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.5, ups=0.55, wpb=384.2, bsz=32, num_updates=33330, lr=6.28285e-07, gnorm=3.123, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61434
2022-05-08 13:30:12 - progress_bar.py[line:272] - INFO: epoch 002:  15678 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=35.899, expert1_balance_bottom=18.48, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=205.3, ups=0.54, wpb=383.2, bsz=32, num_updates=33340, lr=6.25282e-07, gnorm=3.664, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61453
2022-05-08 13:30:29 - progress_bar.py[line:272] - INFO: epoch 002:  15688 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=386.7, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884112, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.499, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.8, ups=0.58, wpb=386.7, bsz=32, num_updates=33350, lr=6.22278e-07, gnorm=3.66, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61470
2022-05-08 13:30:46 - progress_bar.py[line:272] - INFO: epoch 002:  15698 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=389.2, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88357, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.7, expert1_balance_bottom=18.832, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=228.2, ups=0.59, wpb=389.2, bsz=32, num_updates=33360, lr=6.19275e-07, gnorm=3.512, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61487
2022-05-08 13:31:04 - progress_bar.py[line:272] - INFO: epoch 002:  15708 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.853, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=220.2, ups=0.58, wpb=381.6, bsz=32, num_updates=33370, lr=6.16272e-07, gnorm=2.927, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61505
2022-05-08 13:31:21 - progress_bar.py[line:272] - INFO: epoch 002:  15718 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=382.5, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=35.628, expert1_balance_bottom=18.675, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=223.1, ups=0.58, wpb=382.5, bsz=32, num_updates=33380, lr=6.13268e-07, gnorm=3.725, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=61522
2022-05-08 13:31:38 - progress_bar.py[line:272] - INFO: epoch 002:  15728 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.239, expert1_balance_bottom=19.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.4, ups=0.59, wpb=380.9, bsz=32, num_updates=33390, lr=6.10265e-07, gnorm=3.507, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=61539
2022-05-08 13:31:55 - progress_bar.py[line:272] - INFO: epoch 002:  15738 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=380.8, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883822, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.731, expert1_balance_bottom=19.032, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.6, ups=0.59, wpb=380.8, bsz=32, num_updates=33400, lr=6.07262e-07, gnorm=3.353, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61556
2022-05-08 13:32:12 - progress_bar.py[line:272] - INFO: epoch 002:  15748 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=393.4, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.272, expert1_balance_bottom=18.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=235.7, ups=0.6, wpb=393.4, bsz=32, num_updates=33410, lr=6.04259e-07, gnorm=3.577, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61572
2022-05-08 13:32:28 - progress_bar.py[line:272] - INFO: epoch 002:  15758 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=378.7, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888475, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.362, expert1_balance_bottom=19.07, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226.3, ups=0.6, wpb=378.7, bsz=32, num_updates=33420, lr=6.01255e-07, gnorm=3.624, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=61589
2022-05-08 13:32:45 - progress_bar.py[line:272] - INFO: epoch 002:  15768 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.169, expert1_balance_bottom=18.941, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=222.3, ups=0.59, wpb=379.2, bsz=32, num_updates=33430, lr=5.98252e-07, gnorm=3.473, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61606
2022-05-08 13:33:02 - progress_bar.py[line:272] - INFO: epoch 002:  15778 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889759, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=33.876, expert1_balance_bottom=19.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.1, ups=0.58, wpb=379.5, bsz=32, num_updates=33440, lr=5.95249e-07, gnorm=3.046, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61623
2022-05-08 13:33:20 - progress_bar.py[line:272] - INFO: epoch 002:  15788 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=391.7, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885523, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.762, expert1_balance_bottom=18.695, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=226.9, ups=0.58, wpb=391.7, bsz=32, num_updates=33450, lr=5.92246e-07, gnorm=4.413, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61641
2022-05-08 13:33:37 - progress_bar.py[line:272] - INFO: epoch 002:  15798 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=376.1, nsentences=31.5, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87686, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.641, expert1_balance_bottom=18.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.3, ups=0.59, wpb=376.1, bsz=31.5, num_updates=33460, lr=5.89242e-07, gnorm=3.219, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61658
2022-05-08 13:33:54 - progress_bar.py[line:272] - INFO: epoch 002:  15808 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.665, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=227.3, ups=0.59, wpb=385.3, bsz=32, num_updates=33470, lr=5.86239e-07, gnorm=3.642, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=61674
2022-05-08 13:34:11 - progress_bar.py[line:272] - INFO: epoch 002:  15818 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=373.3, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.983, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.6, ups=0.57, wpb=373.3, bsz=32, num_updates=33480, lr=5.83236e-07, gnorm=3.327, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61692
2022-05-08 13:34:28 - progress_bar.py[line:272] - INFO: epoch 002:  15828 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=381, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.182, expert1_balance_bottom=18.754, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.7, ups=0.58, wpb=381, bsz=32, num_updates=33490, lr=5.80232e-07, gnorm=5.414, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61709
2022-05-08 13:34:46 - progress_bar.py[line:272] - INFO: epoch 002:  15838 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=385.5, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.472, expert1_balance_bottom=18.888, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=223.2, ups=0.58, wpb=385.5, bsz=32, num_updates=33500, lr=5.77229e-07, gnorm=3.734, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61726
2022-05-08 13:35:03 - progress_bar.py[line:272] - INFO: epoch 002:  15848 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.772, expert1_balance_bottom=18.779, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.7, ups=0.58, wpb=387, bsz=32, num_updates=33510, lr=5.74226e-07, gnorm=3.675, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61744
2022-05-08 13:35:20 - progress_bar.py[line:272] - INFO: epoch 002:  15858 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884515, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.622, expert1_balance_bottom=18.942, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.6, ups=0.57, wpb=384.3, bsz=32, num_updates=33520, lr=5.71223e-07, gnorm=3.715, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61761
2022-05-08 13:35:36 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 13:35:40 - progress_bar.py[line:272] - INFO: epoch 002:  15869 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=382.6, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89275, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.184, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=196.5, ups=0.51, wpb=382.6, bsz=32, num_updates=33530, lr=5.68219e-07, gnorm=3.152, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61781
2022-05-08 13:35:57 - progress_bar.py[line:272] - INFO: epoch 002:  15879 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=382.6, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.189, expert1_balance_bottom=19.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.1, ups=0.58, wpb=382.6, bsz=32, num_updates=33540, lr=5.65216e-07, gnorm=3.071, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61798
2022-05-08 13:36:14 - progress_bar.py[line:272] - INFO: epoch 002:  15889 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89111, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.002, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223, ups=0.58, wpb=386.3, bsz=32, num_updates=33550, lr=5.62213e-07, gnorm=3.319, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61815
2022-05-08 13:36:32 - progress_bar.py[line:272] - INFO: epoch 002:  15899 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=386.1, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.07, expert1_balance_bottom=18.968, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=225.9, ups=0.59, wpb=386.1, bsz=32, num_updates=33560, lr=5.5921e-07, gnorm=3.361, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61832
2022-05-08 13:36:49 - progress_bar.py[line:272] - INFO: epoch 002:  15909 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=381.1, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.112, expert1_balance_bottom=19.067, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.6, ups=0.58, wpb=381.1, bsz=32, num_updates=33570, lr=5.56206e-07, gnorm=3.143, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61850
2022-05-08 13:37:06 - progress_bar.py[line:272] - INFO: epoch 002:  15919 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=383.8, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877656, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.068, expert1_balance_bottom=18.782, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=219.8, ups=0.57, wpb=383.8, bsz=32, num_updates=33580, lr=5.53203e-07, gnorm=3.361, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61867
2022-05-08 13:37:24 - progress_bar.py[line:272] - INFO: epoch 002:  15929 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=387.3, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879988, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.496, expert1_balance_bottom=18.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.7, ups=0.58, wpb=387.3, bsz=32, num_updates=33590, lr=5.502e-07, gnorm=3.731, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61884
2022-05-08 13:37:40 - progress_bar.py[line:272] - INFO: epoch 002:  15939 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=373.3, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89551, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.299, expert1_balance_bottom=19.016, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.1, ups=0.59, wpb=373.3, bsz=32, num_updates=33600, lr=5.47196e-07, gnorm=3.32, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61901
2022-05-08 13:37:58 - progress_bar.py[line:272] - INFO: epoch 002:  15949 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=373.1, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.8, expert1_balance_bottom=19.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216.8, ups=0.58, wpb=373.1, bsz=32, num_updates=33610, lr=5.44193e-07, gnorm=3.004, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61918
2022-05-08 13:38:15 - progress_bar.py[line:272] - INFO: epoch 002:  15959 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.769, expert1_balance_bottom=18.936, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223, ups=0.59, wpb=380.6, bsz=32, num_updates=33620, lr=5.4119e-07, gnorm=3.143, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61936
2022-05-08 13:38:32 - progress_bar.py[line:272] - INFO: epoch 002:  15969 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=386.4, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.02, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=226.3, ups=0.59, wpb=386.4, bsz=32, num_updates=33630, lr=5.38187e-07, gnorm=2.838, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61953
2022-05-08 13:38:49 - progress_bar.py[line:272] - INFO: epoch 002:  15979 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=379.3, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=33.944, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.9, ups=0.57, wpb=379.3, bsz=32, num_updates=33640, lr=5.35183e-07, gnorm=3.403, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61970
2022-05-08 13:39:07 - progress_bar.py[line:272] - INFO: epoch 002:  15989 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=390.4, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.114, expert1_balance_bottom=18.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223.8, ups=0.57, wpb=390.4, bsz=32, num_updates=33650, lr=5.3218e-07, gnorm=3.19, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=61988
2022-05-08 13:39:25 - progress_bar.py[line:272] - INFO: epoch 002:  15999 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=382, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87942, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.805, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216.4, ups=0.57, wpb=382, bsz=32, num_updates=33660, lr=5.29177e-07, gnorm=3.77, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62005
2022-05-08 13:39:42 - progress_bar.py[line:272] - INFO: epoch 002:  16009 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878943, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.607, expert1_balance_bottom=18.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.6, ups=0.57, wpb=385.7, bsz=32, num_updates=33670, lr=5.26174e-07, gnorm=3.284, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62023
2022-05-08 13:39:59 - progress_bar.py[line:272] - INFO: epoch 002:  16019 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=381, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895386, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.83, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.6, ups=0.58, wpb=381, bsz=32, num_updates=33680, lr=5.2317e-07, gnorm=2.979, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62040
2022-05-08 13:40:16 - progress_bar.py[line:272] - INFO: epoch 002:  16029 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=384, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885464, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.746, expert1_balance_bottom=18.897, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=221.9, ups=0.58, wpb=384, bsz=32, num_updates=33690, lr=5.20167e-07, gnorm=3.011, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62057
2022-05-08 13:40:34 - progress_bar.py[line:272] - INFO: epoch 002:  16039 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891868, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.851, expert1_balance_bottom=19.124, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=219, ups=0.57, wpb=382.4, bsz=32, num_updates=33700, lr=5.17164e-07, gnorm=3.312, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62075
2022-05-08 13:40:51 - progress_bar.py[line:272] - INFO: epoch 002:  16049 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881629, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.735, expert1_balance_bottom=19.016, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.5, ups=0.58, wpb=385.3, bsz=32, num_updates=33710, lr=5.1416e-07, gnorm=3.619, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62092
2022-05-08 13:41:08 - progress_bar.py[line:272] - INFO: epoch 002:  16059 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=384.9, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.953, expert1_balance_bottom=19.338, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=222, ups=0.58, wpb=384.9, bsz=32, num_updates=33720, lr=5.11157e-07, gnorm=3.104, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62109
2022-05-08 13:41:26 - progress_bar.py[line:272] - INFO: epoch 002:  16069 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=391.6, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.494, expert1_balance_bottom=18.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=229.4, ups=0.59, wpb=391.6, bsz=32, num_updates=33730, lr=5.08154e-07, gnorm=3.399, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62126
2022-05-08 13:41:43 - progress_bar.py[line:272] - INFO: epoch 002:  16079 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=388.9, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.407, expert1_balance_bottom=19.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=226.5, ups=0.58, wpb=388.9, bsz=32, num_updates=33740, lr=5.05151e-07, gnorm=2.889, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62143
2022-05-08 13:42:00 - progress_bar.py[line:272] - INFO: epoch 002:  16089 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=368, nsentences=32, sample_size=292.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.357, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.2, ups=0.59, wpb=368, bsz=32, num_updates=33750, lr=5.02147e-07, gnorm=3.221, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62160
2022-05-08 13:42:17 - progress_bar.py[line:272] - INFO: epoch 002:  16099 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882115, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.777, expert1_balance_bottom=18.97, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221.6, ups=0.58, wpb=383.7, bsz=32, num_updates=33760, lr=4.99144e-07, gnorm=3.238, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62178
2022-05-08 13:42:34 - progress_bar.py[line:272] - INFO: epoch 002:  16109 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.491, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220.5, ups=0.58, wpb=378, bsz=32, num_updates=33770, lr=4.96141e-07, gnorm=3.327, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62195
2022-05-08 13:42:52 - progress_bar.py[line:272] - INFO: epoch 002:  16119 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=379.4, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.97, expert1_balance_bottom=19.226, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.5, ups=0.58, wpb=379.4, bsz=32, num_updates=33780, lr=4.93138e-07, gnorm=3.112, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62212
2022-05-08 13:43:09 - progress_bar.py[line:272] - INFO: epoch 002:  16129 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891423, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=33.989, expert1_balance_bottom=18.96, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=224.4, ups=0.59, wpb=382.9, bsz=32, num_updates=33790, lr=4.90134e-07, gnorm=3.581, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62229
2022-05-08 13:43:26 - progress_bar.py[line:272] - INFO: epoch 002:  16139 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=372.9, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894709, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.649, expert1_balance_bottom=19.34, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.5, ups=0.57, wpb=372.9, bsz=32, num_updates=33800, lr=4.87131e-07, gnorm=3.294, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62247
2022-05-08 13:43:44 - progress_bar.py[line:272] - INFO: epoch 002:  16149 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=382.1, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884227, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.517, expert1_balance_bottom=19.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.7, ups=0.57, wpb=382.1, bsz=32, num_updates=33810, lr=4.84128e-07, gnorm=3.285, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62264
2022-05-08 13:44:01 - progress_bar.py[line:272] - INFO: epoch 002:  16159 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892831, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.124, expert1_balance_bottom=19.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=220.6, ups=0.57, wpb=384.3, bsz=32, num_updates=33820, lr=4.81124e-07, gnorm=3.175, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62282
2022-05-08 13:44:18 - progress_bar.py[line:272] - INFO: epoch 002:  16169 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=386.1, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887352, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.355, expert1_balance_bottom=18.934, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223.1, ups=0.58, wpb=386.1, bsz=32, num_updates=33830, lr=4.78121e-07, gnorm=3.455, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62299
2022-05-08 13:44:35 - progress_bar.py[line:272] - INFO: epoch 002:  16179 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=389.5, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=35.05, expert1_balance_bottom=18.794, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=230.2, ups=0.59, wpb=389.5, bsz=32, num_updates=33840, lr=4.75118e-07, gnorm=3.377, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62316
2022-05-08 13:44:53 - progress_bar.py[line:272] - INFO: epoch 002:  16189 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=377, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.543, expert1_balance_bottom=18.906, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219, ups=0.58, wpb=377, bsz=32, num_updates=33850, lr=4.72115e-07, gnorm=3.453, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62333
2022-05-08 13:45:10 - progress_bar.py[line:272] - INFO: epoch 002:  16199 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891632, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.091, expert1_balance_bottom=19.095, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.3, ups=0.58, wpb=379.6, bsz=32, num_updates=33860, lr=4.69111e-07, gnorm=2.92, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62351
2022-05-08 13:45:27 - progress_bar.py[line:272] - INFO: epoch 002:  16209 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.872, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=219.8, ups=0.58, wpb=381.7, bsz=32, num_updates=33870, lr=4.66108e-07, gnorm=3.953, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62368
2022-05-08 13:45:44 - progress_bar.py[line:272] - INFO: epoch 002:  16219 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.406, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220, ups=0.58, wpb=378.4, bsz=32, num_updates=33880, lr=4.63105e-07, gnorm=3.265, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62385
2022-05-08 13:46:01 - progress_bar.py[line:272] - INFO: epoch 002:  16229 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=387.6, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887467, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.471, expert1_balance_bottom=18.879, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=226.9, ups=0.59, wpb=387.6, bsz=32, num_updates=33890, lr=4.60102e-07, gnorm=3.079, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62402
2022-05-08 13:46:19 - progress_bar.py[line:272] - INFO: epoch 002:  16239 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893848, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.017, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219.7, ups=0.57, wpb=383.3, bsz=32, num_updates=33900, lr=4.57098e-07, gnorm=3.084, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62420
2022-05-08 13:46:36 - progress_bar.py[line:272] - INFO: epoch 002:  16249 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892066, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.345, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.4, ups=0.58, wpb=382.8, bsz=32, num_updates=33910, lr=4.54095e-07, gnorm=3.039, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62437
2022-05-08 13:46:54 - progress_bar.py[line:272] - INFO: epoch 002:  16259 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=387.3, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889808, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.042, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.1, ups=0.57, wpb=387.3, bsz=32, num_updates=33920, lr=4.51092e-07, gnorm=3.312, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62454
2022-05-08 13:47:11 - progress_bar.py[line:272] - INFO: epoch 002:  16269 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=389.9, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.097, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.6, ups=0.57, wpb=389.9, bsz=32, num_updates=33930, lr=4.48088e-07, gnorm=3.474, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62472
2022-05-08 13:47:28 - progress_bar.py[line:272] - INFO: epoch 002:  16279 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877828, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.915, expert1_balance_bottom=18.993, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.2, ups=0.58, wpb=384.5, bsz=32, num_updates=33940, lr=4.45085e-07, gnorm=3.314, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62489
2022-05-08 13:47:46 - progress_bar.py[line:272] - INFO: epoch 002:  16289 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.837, expert1_balance_bottom=19.086, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222.6, ups=0.58, wpb=384.1, bsz=32, num_updates=33950, lr=4.42082e-07, gnorm=3.082, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62506
2022-05-08 13:48:02 - progress_bar.py[line:272] - INFO: epoch 002:  16299 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=386.6, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.476, expert1_balance_bottom=19.415, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=228.9, ups=0.59, wpb=386.6, bsz=32, num_updates=33960, lr=4.39079e-07, gnorm=3.169, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62523
2022-05-08 13:48:19 - progress_bar.py[line:272] - INFO: epoch 002:  16309 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.544, expert1_balance_bottom=19.012, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=225.9, ups=0.59, wpb=382.8, bsz=32, num_updates=33970, lr=4.36075e-07, gnorm=3.368, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62540
2022-05-08 13:48:36 - progress_bar.py[line:272] - INFO: epoch 002:  16319 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.994, expert1_balance_bottom=18.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.4, ups=0.59, wpb=380.5, bsz=32, num_updates=33980, lr=4.33072e-07, gnorm=3.552, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62557
2022-05-08 13:48:53 - progress_bar.py[line:272] - INFO: epoch 002:  16329 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.948, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.3, ups=0.59, wpb=380.1, bsz=32, num_updates=33990, lr=4.30069e-07, gnorm=3.499, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62574
2022-05-08 13:49:10 - progress_bar.py[line:272] - INFO: epoch 002:  16339 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895234, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.215, expert1_balance_bottom=18.99, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=223.7, ups=0.59, wpb=377.9, bsz=32, num_updates=34000, lr=4.27066e-07, gnorm=2.871, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62591
2022-05-08 13:49:27 - progress_bar.py[line:272] - INFO: epoch 002:  16349 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=379.8, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888733, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.332, expert1_balance_bottom=19.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=226.8, ups=0.6, wpb=379.8, bsz=32, num_updates=34010, lr=4.24062e-07, gnorm=3.152, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62608
2022-05-08 13:49:44 - progress_bar.py[line:272] - INFO: epoch 002:  16359 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888193, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.038, expert1_balance_bottom=19.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=225.3, ups=0.59, wpb=382.3, bsz=32, num_updates=34020, lr=4.21059e-07, gnorm=3.165, loss_scale=32, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62625
2022-05-08 13:50:01 - progress_bar.py[line:272] - INFO: epoch 002:  16369 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=390.3, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8821, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.642, expert1_balance_bottom=19.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=229.6, ups=0.59, wpb=390.3, bsz=32, num_updates=34030, lr=4.18056e-07, gnorm=3.376, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62642
2022-05-08 13:50:18 - progress_bar.py[line:272] - INFO: epoch 002:  16379 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=376.9, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.356, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.4, ups=0.58, wpb=376.9, bsz=32, num_updates=34040, lr=4.15052e-07, gnorm=3.657, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62659
2022-05-08 13:50:35 - progress_bar.py[line:272] - INFO: epoch 002:  16389 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=33.946, expert1_balance_bottom=19.172, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=227, ups=0.59, wpb=385, bsz=32, num_updates=34050, lr=4.12049e-07, gnorm=2.962, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62676
2022-05-08 13:50:52 - progress_bar.py[line:272] - INFO: epoch 002:  16399 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883396, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.574, expert1_balance_bottom=19.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.7, ups=0.59, wpb=386.4, bsz=32, num_updates=34060, lr=4.09046e-07, gnorm=3.339, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62693
2022-05-08 13:51:09 - progress_bar.py[line:272] - INFO: epoch 002:  16409 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879906, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.819, expert1_balance_bottom=19.07, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=226.5, ups=0.59, wpb=383.9, bsz=32, num_updates=34070, lr=4.06043e-07, gnorm=3.26, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62710
2022-05-08 13:51:26 - progress_bar.py[line:272] - INFO: epoch 002:  16419 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876494, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.808, expert1_balance_bottom=19.044, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223.2, ups=0.59, wpb=379.7, bsz=32, num_updates=34080, lr=4.03039e-07, gnorm=3.295, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62727
2022-05-08 13:51:43 - progress_bar.py[line:272] - INFO: epoch 002:  16429 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.941, expert1_balance_bottom=19.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.4, ups=0.59, wpb=381.4, bsz=32, num_updates=34090, lr=4.00036e-07, gnorm=3.207, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62744
2022-05-08 13:52:00 - progress_bar.py[line:272] - INFO: epoch 002:  16439 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.018, expert1_balance_bottom=18.812, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223.2, ups=0.58, wpb=382.3, bsz=32, num_updates=34100, lr=3.97033e-07, gnorm=3.543, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62761
2022-05-08 13:52:17 - progress_bar.py[line:272] - INFO: epoch 002:  16449 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=383.2, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.96, expert1_balance_bottom=18.749, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=226.6, ups=0.59, wpb=383.2, bsz=32, num_updates=34110, lr=3.94029e-07, gnorm=3.716, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62778
2022-05-08 13:52:34 - progress_bar.py[line:272] - INFO: epoch 002:  16459 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887765, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.2, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=222.1, ups=0.58, wpb=381, bsz=32, num_updates=34120, lr=3.91026e-07, gnorm=3.536, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62795
2022-05-08 13:52:51 - progress_bar.py[line:272] - INFO: epoch 002:  16469 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880668, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.837, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.3, ups=0.6, wpb=383.2, bsz=32, num_updates=34130, lr=3.88023e-07, gnorm=3.219, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62812
2022-05-08 13:53:08 - progress_bar.py[line:272] - INFO: epoch 002:  16479 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885114, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.439, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=227.8, ups=0.59, wpb=385.4, bsz=32, num_updates=34140, lr=3.8502e-07, gnorm=3.277, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62829
2022-05-08 13:53:25 - progress_bar.py[line:272] - INFO: epoch 002:  16489 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=387, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.929, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=229, ups=0.59, wpb=387, bsz=32, num_updates=34150, lr=3.82016e-07, gnorm=3.002, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62846
2022-05-08 13:53:42 - progress_bar.py[line:272] - INFO: epoch 002:  16499 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=389, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883523, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.111, expert1_balance_bottom=19.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=229.1, ups=0.59, wpb=389, bsz=32, num_updates=34160, lr=3.79013e-07, gnorm=3.019, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=62863
2022-05-08 13:53:59 - progress_bar.py[line:272] - INFO: epoch 002:  16509 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898434, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.614, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.9, ups=0.57, wpb=378.5, bsz=32, num_updates=34170, lr=3.7601e-07, gnorm=2.854, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62880
2022-05-08 13:54:17 - progress_bar.py[line:272] - INFO: epoch 002:  16519 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=396.5, nsentences=32, sample_size=315.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.597, expert1_balance_bottom=18.863, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=229.1, ups=0.58, wpb=396.5, bsz=32, num_updates=34180, lr=3.73007e-07, gnorm=3.171, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62897
2022-05-08 13:54:34 - progress_bar.py[line:272] - INFO: epoch 002:  16529 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=35.518, expert1_balance_bottom=18.814, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=224.5, ups=0.58, wpb=388, bsz=32, num_updates=34190, lr=3.70003e-07, gnorm=2.949, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62915
2022-05-08 13:54:51 - progress_bar.py[line:272] - INFO: epoch 002:  16539 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=376.3, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.111, expert1_balance_bottom=19.073, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.2, ups=0.58, wpb=376.3, bsz=32, num_updates=34200, lr=3.67e-07, gnorm=3.452, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62932
2022-05-08 13:55:08 - progress_bar.py[line:272] - INFO: epoch 002:  16549 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882115, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.564, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.7, ups=0.58, wpb=379.2, bsz=32, num_updates=34210, lr=3.63997e-07, gnorm=3.01, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62949
2022-05-08 13:55:26 - progress_bar.py[line:272] - INFO: epoch 002:  16559 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=389.9, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.786, expert1_balance_bottom=18.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.7, ups=0.58, wpb=389.9, bsz=32, num_updates=34220, lr=3.60993e-07, gnorm=2.946, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62966
2022-05-08 13:55:43 - progress_bar.py[line:272] - INFO: epoch 002:  16569 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=388.7, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=35.211, expert1_balance_bottom=18.889, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=228.8, ups=0.59, wpb=388.7, bsz=32, num_updates=34230, lr=3.5799e-07, gnorm=2.936, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=62983
2022-05-08 13:56:00 - progress_bar.py[line:272] - INFO: epoch 002:  16579 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=382, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.228, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.9, ups=0.59, wpb=382, bsz=32, num_updates=34240, lr=3.54987e-07, gnorm=3.751, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63000
2022-05-08 13:56:17 - progress_bar.py[line:272] - INFO: epoch 002:  16589 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894968, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.94, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.6, ups=0.59, wpb=380.2, bsz=32, num_updates=34250, lr=3.51984e-07, gnorm=3.416, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63017
2022-05-08 13:56:34 - progress_bar.py[line:272] - INFO: epoch 002:  16599 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894709, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.031, expert1_balance_bottom=19.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222, ups=0.59, wpb=378.6, bsz=32, num_updates=34260, lr=3.4898e-07, gnorm=3.017, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63034
2022-05-08 13:56:50 - progress_bar.py[line:272] - INFO: epoch 002:  16609 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=374.3, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.906994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.108, expert1_balance_bottom=19.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.3, ups=0.59, wpb=374.3, bsz=32, num_updates=34270, lr=3.45977e-07, gnorm=2.908, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63051
2022-05-08 13:57:08 - progress_bar.py[line:272] - INFO: epoch 002:  16619 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=390.5, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.714, expert1_balance_bottom=19.03, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=227.6, ups=0.58, wpb=390.5, bsz=32, num_updates=34280, lr=3.42974e-07, gnorm=3.51, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63068
2022-05-08 13:57:25 - progress_bar.py[line:272] - INFO: epoch 002:  16629 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889328, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.153, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=221.5, ups=0.57, wpb=385.3, bsz=32, num_updates=34290, lr=3.39971e-07, gnorm=3.246, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=63086
2022-05-08 13:57:42 - progress_bar.py[line:272] - INFO: epoch 002:  16639 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894526, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.995, expert1_balance_bottom=19.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=219.3, ups=0.58, wpb=380.5, bsz=32, num_updates=34300, lr=3.36967e-07, gnorm=2.963, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63103
2022-05-08 13:58:00 - progress_bar.py[line:272] - INFO: epoch 002:  16649 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=387.2, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885531, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.672, expert1_balance_bottom=18.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=222, ups=0.57, wpb=387.2, bsz=32, num_updates=34310, lr=3.33964e-07, gnorm=3.41, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63121
2022-05-08 13:58:17 - progress_bar.py[line:272] - INFO: epoch 002:  16659 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890065, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.256, expert1_balance_bottom=19.19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221.9, ups=0.59, wpb=377.9, bsz=32, num_updates=34320, lr=3.30961e-07, gnorm=3.305, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63138
2022-05-08 13:58:34 - progress_bar.py[line:272] - INFO: epoch 002:  16669 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=379.5, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.21, expert1_balance_bottom=19.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.8, ups=0.59, wpb=379.5, bsz=32, num_updates=34330, lr=3.27957e-07, gnorm=3.215, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63155
2022-05-08 13:58:51 - progress_bar.py[line:272] - INFO: epoch 002:  16679 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=35.74, expert1_balance_bottom=18.676, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.9, ups=0.58, wpb=383.2, bsz=32, num_updates=34340, lr=3.24954e-07, gnorm=3.468, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63172
2022-05-08 13:59:08 - progress_bar.py[line:272] - INFO: epoch 002:  16689 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=377.8, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.121, expert1_balance_bottom=19.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.5, ups=0.59, wpb=377.8, bsz=32, num_updates=34350, lr=3.21951e-07, gnorm=3.398, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63189
2022-05-08 13:59:25 - progress_bar.py[line:272] - INFO: epoch 002:  16699 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=385.6, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878873, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.865, expert1_balance_bottom=18.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.4, ups=0.58, wpb=385.6, bsz=32, num_updates=34360, lr=3.18948e-07, gnorm=3.957, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63206
2022-05-08 13:59:43 - progress_bar.py[line:272] - INFO: epoch 002:  16709 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=381.7, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881492, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.686, expert1_balance_bottom=18.878, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.5, ups=0.58, wpb=381.7, bsz=32, num_updates=34370, lr=3.15944e-07, gnorm=3.6, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63223
2022-05-08 14:00:00 - progress_bar.py[line:272] - INFO: epoch 002:  16719 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=389.1, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.764, expert1_balance_bottom=19.147, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=225.8, ups=0.58, wpb=389.1, bsz=32, num_updates=34380, lr=3.12941e-07, gnorm=3.368, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=63241
2022-05-08 14:00:17 - progress_bar.py[line:272] - INFO: epoch 002:  16729 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=373.3, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893582, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.179, expert1_balance_bottom=19.113, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=217.7, ups=0.58, wpb=373.3, bsz=32, num_updates=34390, lr=3.09938e-07, gnorm=3.04, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63258
2022-05-08 14:00:34 - progress_bar.py[line:272] - INFO: epoch 002:  16739 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=377.5, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876749, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.469, expert1_balance_bottom=18.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=226.5, ups=0.6, wpb=377.5, bsz=32, num_updates=34400, lr=3.06935e-07, gnorm=2.882, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63275
2022-05-08 14:00:51 - progress_bar.py[line:272] - INFO: epoch 002:  16749 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.136, expert1_balance_bottom=19.123, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222.5, ups=0.59, wpb=378.8, bsz=32, num_updates=34410, lr=3.03931e-07, gnorm=3.453, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=63292
2022-05-08 14:01:08 - progress_bar.py[line:272] - INFO: epoch 002:  16759 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=373.8, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.364, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215.8, ups=0.58, wpb=373.8, bsz=32, num_updates=34420, lr=3.00928e-07, gnorm=2.816, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63309
2022-05-08 14:01:25 - progress_bar.py[line:272] - INFO: epoch 002:  16769 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866568, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=35.9, expert1_balance_bottom=18.591, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223.6, ups=0.58, wpb=385.1, bsz=32, num_updates=34430, lr=2.97925e-07, gnorm=3.156, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63326
2022-05-08 14:01:42 - progress_bar.py[line:272] - INFO: epoch 002:  16779 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878665, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.864, expert1_balance_bottom=18.958, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=224.1, ups=0.59, wpb=381.5, bsz=32, num_updates=34440, lr=2.94921e-07, gnorm=3.193, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63343
2022-05-08 14:02:00 - progress_bar.py[line:272] - INFO: epoch 002:  16789 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=379.6, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890841, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.243, expert1_balance_bottom=18.97, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.1, ups=0.58, wpb=379.6, bsz=32, num_updates=34450, lr=2.91918e-07, gnorm=3.362, loss_scale=64, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=63360
2022-05-08 14:02:17 - progress_bar.py[line:272] - INFO: epoch 002:  16799 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=381.1, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883905, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.575, expert1_balance_bottom=18.967, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.9, ups=0.58, wpb=381.1, bsz=32, num_updates=34460, lr=2.88915e-07, gnorm=3.274, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63378
2022-05-08 14:02:34 - progress_bar.py[line:272] - INFO: epoch 002:  16809 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885137, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.012, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224, ups=0.59, wpb=378.7, bsz=32, num_updates=34470, lr=2.85912e-07, gnorm=3.184, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63395
2022-05-08 14:02:51 - progress_bar.py[line:272] - INFO: epoch 002:  16819 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=384.6, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885678, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.369, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=226.6, ups=0.59, wpb=384.6, bsz=32, num_updates=34480, lr=2.82908e-07, gnorm=3.317, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63412
2022-05-08 14:03:08 - progress_bar.py[line:272] - INFO: epoch 002:  16829 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887595, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.448, expert1_balance_bottom=18.991, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.6, ups=0.58, wpb=380.6, bsz=32, num_updates=34490, lr=2.79905e-07, gnorm=3.252, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63429
2022-05-08 14:03:25 - progress_bar.py[line:272] - INFO: epoch 002:  16839 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=375.4, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.151, expert1_balance_bottom=18.711, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=219.9, ups=0.59, wpb=375.4, bsz=32, num_updates=34500, lr=2.76902e-07, gnorm=3.164, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63446
2022-05-08 14:03:42 - progress_bar.py[line:272] - INFO: epoch 002:  16849 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=391.4, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.911, expert1_balance_bottom=18.987, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=229.9, ups=0.59, wpb=391.4, bsz=32, num_updates=34510, lr=2.73899e-07, gnorm=3.133, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63463
2022-05-08 14:04:00 - progress_bar.py[line:272] - INFO: epoch 002:  16859 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=381, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881343, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.738, expert1_balance_bottom=18.857, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219.6, ups=0.58, wpb=381, bsz=32, num_updates=34520, lr=2.70895e-07, gnorm=3.696, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63480
2022-05-08 14:04:17 - progress_bar.py[line:272] - INFO: epoch 002:  16869 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=376.3, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.076, expert1_balance_bottom=19.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.7, ups=0.57, wpb=376.3, bsz=32, num_updates=34530, lr=2.67892e-07, gnorm=3.223, loss_scale=64, train_wall=17, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=63498
2022-05-08 14:04:34 - progress_bar.py[line:272] - INFO: epoch 002:  16879 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=374.1, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.910679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.112, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214.7, ups=0.57, wpb=374.1, bsz=32, num_updates=34540, lr=2.64889e-07, gnorm=3.025, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63515
2022-05-08 14:04:51 - progress_bar.py[line:272] - INFO: epoch 002:  16889 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=384.4, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.439, expert1_balance_bottom=19.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226.1, ups=0.59, wpb=384.4, bsz=32, num_updates=34550, lr=2.61885e-07, gnorm=3.145, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63532
2022-05-08 14:05:09 - progress_bar.py[line:272] - INFO: epoch 002:  16899 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877354, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.798, expert1_balance_bottom=18.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.5, ups=0.58, wpb=384.4, bsz=32, num_updates=34560, lr=2.58882e-07, gnorm=3.195, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=63549
2022-05-08 14:05:26 - progress_bar.py[line:272] - INFO: epoch 002:  16909 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=388.8, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.858403, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=35.966, expert1_balance_bottom=18.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=227.7, ups=0.59, wpb=388.8, bsz=32, num_updates=34570, lr=2.55879e-07, gnorm=3.053, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63567
2022-05-08 14:05:43 - progress_bar.py[line:272] - INFO: epoch 002:  16919 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.236, expert1_balance_bottom=18.76, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221.8, ups=0.58, wpb=380.9, bsz=32, num_updates=34580, lr=2.52876e-07, gnorm=3.436, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63584
2022-05-08 14:06:00 - progress_bar.py[line:272] - INFO: epoch 002:  16929 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=376.9, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.452, expert1_balance_bottom=19.377, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.3, ups=0.58, wpb=376.9, bsz=32, num_updates=34590, lr=2.49872e-07, gnorm=3.295, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63601
2022-05-08 14:06:17 - progress_bar.py[line:272] - INFO: epoch 002:  16939 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88304, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.528, expert1_balance_bottom=19.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223.4, ups=0.58, wpb=382.7, bsz=32, num_updates=34600, lr=2.46869e-07, gnorm=3.3, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63618
2022-05-08 14:06:34 - progress_bar.py[line:272] - INFO: epoch 002:  16949 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.005, expert1_balance_bottom=18.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.6, ups=0.58, wpb=386.1, bsz=32, num_updates=34610, lr=2.43866e-07, gnorm=3.771, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63635
2022-05-08 14:06:51 - progress_bar.py[line:272] - INFO: epoch 002:  16959 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=381.5, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891992, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.341, expert1_balance_bottom=19.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.6, ups=0.59, wpb=381.5, bsz=32, num_updates=34620, lr=2.40863e-07, gnorm=3.782, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63652
2022-05-08 14:07:08 - progress_bar.py[line:272] - INFO: epoch 002:  16969 / 17711 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886821, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.181, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.167, expert1_balance_bottom=19.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=223.2, ups=0.59, wpb=380.7, bsz=32, num_updates=34630, lr=2.37859e-07, gnorm=3.798, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63669
2022-05-08 14:07:26 - progress_bar.py[line:272] - INFO: epoch 002:  16979 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88719, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.146, expert1_balance_bottom=19.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=221.3, ups=0.58, wpb=383.8, bsz=32, num_updates=34640, lr=2.34856e-07, gnorm=3.594, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63686
2022-05-08 14:07:43 - progress_bar.py[line:272] - INFO: epoch 002:  16989 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89084, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.174, expert1_balance_bottom=19.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.2, ups=0.58, wpb=378.4, bsz=32, num_updates=34650, lr=2.31853e-07, gnorm=3.647, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63704
2022-05-08 14:08:00 - progress_bar.py[line:272] - INFO: epoch 002:  16999 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=377.3, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.367, expert1_balance_bottom=19.016, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=224.6, ups=0.6, wpb=377.3, bsz=32, num_updates=34660, lr=2.28849e-07, gnorm=2.795, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63720
2022-05-08 14:08:17 - progress_bar.py[line:272] - INFO: epoch 002:  17009 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=374.3, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=33.857, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217.7, ups=0.58, wpb=374.3, bsz=32, num_updates=34670, lr=2.25846e-07, gnorm=3.268, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63738
2022-05-08 14:08:34 - progress_bar.py[line:272] - INFO: epoch 002:  17019 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885494, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.435, expert1_balance_bottom=18.899, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223.7, ups=0.58, wpb=382.8, bsz=32, num_updates=34680, lr=2.22843e-07, gnorm=3.356, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63755
2022-05-08 14:08:52 - progress_bar.py[line:272] - INFO: epoch 002:  17029 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878134, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.825, expert1_balance_bottom=19.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.6, ups=0.57, wpb=383.6, bsz=32, num_updates=34690, lr=2.1984e-07, gnorm=2.696, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63772
2022-05-08 14:09:09 - progress_bar.py[line:272] - INFO: epoch 002:  17039 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.271, expert1_balance_bottom=18.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223.5, ups=0.58, wpb=383.7, bsz=32, num_updates=34700, lr=2.16836e-07, gnorm=3.609, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63789
2022-05-08 14:09:26 - progress_bar.py[line:272] - INFO: epoch 002:  17049 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88437, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.513, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=224.2, ups=0.59, wpb=380.2, bsz=32, num_updates=34710, lr=2.13833e-07, gnorm=3.059, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63806
2022-05-08 14:09:43 - progress_bar.py[line:272] - INFO: epoch 002:  17059 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=369.5, nsentences=32, sample_size=294, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897646, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.931, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.1, ups=0.59, wpb=369.5, bsz=32, num_updates=34720, lr=2.1083e-07, gnorm=3.007, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63823
2022-05-08 14:10:00 - progress_bar.py[line:272] - INFO: epoch 002:  17069 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=376.4, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.462, expert1_balance_bottom=19.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.6, ups=0.58, wpb=376.4, bsz=32, num_updates=34730, lr=2.07827e-07, gnorm=3.379, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=63841
2022-05-08 14:10:17 - progress_bar.py[line:272] - INFO: epoch 002:  17079 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=379.9, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865856, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=35.644, expert1_balance_bottom=18.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.9, ups=0.59, wpb=379.9, bsz=32, num_updates=34740, lr=2.04823e-07, gnorm=2.988, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63858
2022-05-08 14:10:34 - progress_bar.py[line:272] - INFO: epoch 002:  17089 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.767, expert1_balance_bottom=18.877, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=226.6, ups=0.59, wpb=382.8, bsz=32, num_updates=34750, lr=2.0182e-07, gnorm=3.048, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63874
2022-05-08 14:10:51 - progress_bar.py[line:272] - INFO: epoch 002:  17099 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=388.7, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889325, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.033, expert1_balance_bottom=19.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=225.4, ups=0.58, wpb=388.7, bsz=32, num_updates=34760, lr=1.98817e-07, gnorm=2.981, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63892
2022-05-08 14:11:08 - progress_bar.py[line:272] - INFO: epoch 002:  17109 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=385.1, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=33.788, expert1_balance_bottom=19.268, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=226.1, ups=0.59, wpb=385.1, bsz=32, num_updates=34770, lr=1.95813e-07, gnorm=3.363, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63909
2022-05-08 14:11:25 - progress_bar.py[line:272] - INFO: epoch 002:  17119 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=388.9, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886333, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.623, expert1_balance_bottom=19.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.3, ups=0.58, wpb=388.9, bsz=32, num_updates=34780, lr=1.9281e-07, gnorm=3.272, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=63926
2022-05-08 14:11:42 - progress_bar.py[line:272] - INFO: epoch 002:  17129 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=380.1, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887148, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.196, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219.4, ups=0.58, wpb=380.1, bsz=32, num_updates=34790, lr=1.89807e-07, gnorm=3.234, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63943
2022-05-08 14:11:59 - progress_bar.py[line:272] - INFO: epoch 002:  17139 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887059, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.295, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.2, ups=0.59, wpb=378.7, bsz=32, num_updates=34800, lr=1.86804e-07, gnorm=3.376, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63960
2022-05-08 14:12:17 - progress_bar.py[line:272] - INFO: epoch 002:  17149 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876104, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.019, expert1_balance_bottom=18.791, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.2, ups=0.58, wpb=383.8, bsz=32, num_updates=34810, lr=1.838e-07, gnorm=3.203, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63977
2022-05-08 14:12:33 - progress_bar.py[line:272] - INFO: epoch 002:  17159 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.966, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=228, ups=0.6, wpb=381.7, bsz=32, num_updates=34820, lr=1.80797e-07, gnorm=3.314, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=63994
2022-05-08 14:12:50 - progress_bar.py[line:272] - INFO: epoch 002:  17169 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=375.6, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.953, expert1_balance_bottom=19.07, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.5, ups=0.58, wpb=375.6, bsz=32, num_updates=34830, lr=1.77794e-07, gnorm=3.109, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64011
2022-05-08 14:13:07 - progress_bar.py[line:272] - INFO: epoch 002:  17179 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=380.3, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88871, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.255, expert1_balance_bottom=19.171, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=225.4, ups=0.59, wpb=380.3, bsz=32, num_updates=34840, lr=1.74791e-07, gnorm=3.152, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64028
2022-05-08 14:13:24 - progress_bar.py[line:272] - INFO: epoch 002:  17189 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=391.9, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894042, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=33.854, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=227.6, ups=0.58, wpb=391.9, bsz=32, num_updates=34850, lr=1.71787e-07, gnorm=3.175, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64045
2022-05-08 14:13:42 - progress_bar.py[line:272] - INFO: epoch 002:  17199 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877721, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.042, expert1_balance_bottom=18.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=222.4, ups=0.58, wpb=382.2, bsz=32, num_updates=34860, lr=1.68784e-07, gnorm=3.343, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64062
2022-05-08 14:13:59 - progress_bar.py[line:272] - INFO: epoch 002:  17209 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887141, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.311, expert1_balance_bottom=19.172, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.1, ups=0.59, wpb=381.7, bsz=32, num_updates=34870, lr=1.65781e-07, gnorm=3.423, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64079
2022-05-08 14:14:16 - progress_bar.py[line:272] - INFO: epoch 002:  17219 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.623, expert1_balance_bottom=18.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=224.3, ups=0.59, wpb=381.7, bsz=32, num_updates=34880, lr=1.62777e-07, gnorm=2.904, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64097
2022-05-08 14:14:33 - progress_bar.py[line:272] - INFO: epoch 002:  17229 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=385.5, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.535, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=225.9, ups=0.59, wpb=385.5, bsz=32, num_updates=34890, lr=1.59774e-07, gnorm=3.364, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64114
2022-05-08 14:14:50 - progress_bar.py[line:272] - INFO: epoch 002:  17239 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.915, expert1_balance_bottom=18.804, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=227.2, ups=0.59, wpb=384.7, bsz=32, num_updates=34900, lr=1.56771e-07, gnorm=3.542, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64131
2022-05-08 14:15:07 - progress_bar.py[line:272] - INFO: epoch 002:  17249 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.422, expert1_balance_bottom=19.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=227.8, ups=0.59, wpb=383.4, bsz=32, num_updates=34910, lr=1.53768e-07, gnorm=3.049, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64147
2022-05-08 14:15:24 - progress_bar.py[line:272] - INFO: epoch 002:  17259 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=374.9, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899552, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.824, expert1_balance_bottom=19.041, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.6, ups=0.59, wpb=374.9, bsz=32, num_updates=34920, lr=1.50764e-07, gnorm=2.897, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64164
2022-05-08 14:15:41 - progress_bar.py[line:272] - INFO: epoch 002:  17269 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=382.4, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881232, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.813, expert1_balance_bottom=18.873, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.2, ups=0.59, wpb=382.4, bsz=32, num_updates=34930, lr=1.47761e-07, gnorm=3.7, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64181
2022-05-08 14:15:58 - progress_bar.py[line:272] - INFO: epoch 002:  17279 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=372.8, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.173, expert1_balance_bottom=19.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.1, ups=0.59, wpb=372.8, bsz=32, num_updates=34940, lr=1.44758e-07, gnorm=2.923, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64198
2022-05-08 14:16:15 - progress_bar.py[line:272] - INFO: epoch 002:  17289 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.231, expert1_balance_bottom=19.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=225.3, ups=0.59, wpb=384.1, bsz=32, num_updates=34950, lr=1.41755e-07, gnorm=2.972, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64215
2022-05-08 14:16:32 - progress_bar.py[line:272] - INFO: epoch 002:  17299 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=387.6, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888139, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.265, expert1_balance_bottom=19.053, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=222, ups=0.57, wpb=387.6, bsz=32, num_updates=34960, lr=1.38751e-07, gnorm=3.492, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64233
2022-05-08 14:16:49 - progress_bar.py[line:272] - INFO: epoch 002:  17309 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882104, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.694, expert1_balance_bottom=18.85, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.3, ups=0.58, wpb=378.2, bsz=32, num_updates=34970, lr=1.35748e-07, gnorm=3.353, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64250
2022-05-08 14:17:06 - progress_bar.py[line:272] - INFO: epoch 002:  17319 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.893, expert1_balance_bottom=18.814, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=225.8, ups=0.59, wpb=382.6, bsz=32, num_updates=34980, lr=1.32745e-07, gnorm=3.625, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64267
2022-05-08 14:17:23 - progress_bar.py[line:272] - INFO: epoch 002:  17329 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=378.9, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893929, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.082, expert1_balance_bottom=19.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223.5, ups=0.59, wpb=378.9, bsz=32, num_updates=34990, lr=1.29741e-07, gnorm=2.983, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64284
2022-05-08 14:17:40 - progress_bar.py[line:272] - INFO: epoch 002:  17339 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.009, expert1_balance_bottom=19.001, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=226.1, ups=0.59, wpb=383.9, bsz=32, num_updates=35000, lr=1.26738e-07, gnorm=3.359, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64301
2022-05-08 14:17:40 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 14:17:40 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 14:17:40 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 14:24:44 - train.py[line:517] - INFO: valid_step finished
2022-05-08 14:24:44 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 9.575 | loss_v1 0 | loss_v2 0 | nll_loss 7.887 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.9706 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.575 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.26 | expert1_balance_top 35.786 | expert1_balance_bottom 14.879 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 236.72 | cider 1.203 | wps 711.6 | wpb 481.7 | bsz 8 | num_updates 35000 | best_cider 1.203
2022-05-08 14:24:44 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 35000 updates
2022-05-08 14:24:44 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_35000-rank-0.pt
2022-05-08 14:24:44 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_35000-rank-0.pt
2022-05-08 14:24:51 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_35000-rank-0.pt
2022-05-08 14:24:51 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_35000-shared.pt
2022-05-08 14:24:58 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_35000-shared.pt
2022-05-08 14:25:32 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_2_35000-rank-0.pt (epoch 2 @ 35000 updates, score 1.203) (writing took 48.26427150517702 seconds)
2022-05-08 14:25:49 - progress_bar.py[line:272] - INFO: epoch 002:  17349 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.133, expert1_balance_bottom=19.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=7.8, ups=0.02, wpb=382.7, bsz=32, num_updates=35010, lr=1.23735e-07, gnorm=3.144, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64790
2022-05-08 14:26:07 - progress_bar.py[line:272] - INFO: epoch 002:  17359 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=381.9, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884097, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.869, expert1_balance_bottom=18.922, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.5, ups=0.58, wpb=381.9, bsz=32, num_updates=35020, lr=1.20732e-07, gnorm=3.337, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64807
2022-05-08 14:26:24 - progress_bar.py[line:272] - INFO: epoch 002:  17369 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=387.1, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.022, expert1_balance_bottom=18.906, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=222.3, ups=0.57, wpb=387.1, bsz=32, num_updates=35030, lr=1.17728e-07, gnorm=3.679, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64825
2022-05-08 14:26:41 - progress_bar.py[line:272] - INFO: epoch 002:  17379 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891882, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.098, expert1_balance_bottom=19.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.7, ups=0.59, wpb=376.7, bsz=32, num_updates=35040, lr=1.14725e-07, gnorm=3.109, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64842
2022-05-08 14:26:58 - progress_bar.py[line:272] - INFO: epoch 002:  17389 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872764, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=35.054, expert1_balance_bottom=18.826, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=224.3, ups=0.59, wpb=381.9, bsz=32, num_updates=35050, lr=1.11722e-07, gnorm=3.556, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64859
2022-05-08 14:27:15 - progress_bar.py[line:272] - INFO: epoch 002:  17399 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=387.7, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.013, expert1_balance_bottom=18.963, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=227.9, ups=0.59, wpb=387.7, bsz=32, num_updates=35060, lr=1.08719e-07, gnorm=3.474, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64876
2022-05-08 14:27:32 - progress_bar.py[line:272] - INFO: epoch 002:  17409 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=384.8, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.869, expert1_balance_bottom=18.912, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=224.4, ups=0.58, wpb=384.8, bsz=32, num_updates=35070, lr=1.05715e-07, gnorm=3.131, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=64893
2022-05-08 14:27:50 - progress_bar.py[line:272] - INFO: epoch 002:  17419 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.345, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.9, ups=0.58, wpb=385.7, bsz=32, num_updates=35080, lr=1.02712e-07, gnorm=3.186, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64910
2022-05-08 14:28:07 - progress_bar.py[line:272] - INFO: epoch 002:  17429 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=380.4, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889273, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.054, expert1_balance_bottom=19.3, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=218.3, ups=0.57, wpb=380.4, bsz=32, num_updates=35090, lr=9.97087e-08, gnorm=3.15, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=64928
2022-05-08 14:28:24 - progress_bar.py[line:272] - INFO: epoch 002:  17439 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=392.3, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886573, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.321, expert1_balance_bottom=19.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=227.5, ups=0.58, wpb=392.3, bsz=32, num_updates=35100, lr=9.67054e-08, gnorm=3.2, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64945
2022-05-08 14:28:41 - progress_bar.py[line:272] - INFO: epoch 002:  17449 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88328, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.482, expert1_balance_bottom=19.027, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=225.3, ups=0.59, wpb=384.2, bsz=32, num_updates=35110, lr=9.37021e-08, gnorm=2.836, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64962
2022-05-08 14:28:59 - progress_bar.py[line:272] - INFO: epoch 002:  17459 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.719, expert1_balance_bottom=18.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.7, ups=0.57, wpb=384.2, bsz=32, num_updates=35120, lr=9.06989e-08, gnorm=3.406, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64979
2022-05-08 14:29:16 - progress_bar.py[line:272] - INFO: epoch 002:  17469 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=379.8, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.014, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221.6, ups=0.58, wpb=379.8, bsz=32, num_updates=35130, lr=8.76956e-08, gnorm=3.334, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=64997
2022-05-08 14:29:33 - progress_bar.py[line:272] - INFO: epoch 002:  17479 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=381, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889766, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.474, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.8, ups=0.58, wpb=381, bsz=32, num_updates=35140, lr=8.46923e-08, gnorm=3.187, loss_scale=256, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65014
2022-05-08 14:29:43 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-08 14:29:52 - progress_bar.py[line:272] - INFO: epoch 002:  17490 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=387.7, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894988, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.762, expert1_balance_bottom=19.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=207.6, ups=0.54, wpb=387.7, bsz=32, num_updates=35150, lr=8.1689e-08, gnorm=3.205, loss_scale=128, train_wall=18, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=65032
2022-05-08 14:30:08 - progress_bar.py[line:272] - INFO: epoch 002:  17500 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=373, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89388, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.355, expert1_balance_bottom=18.925, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.8, ups=0.59, wpb=373, bsz=32, num_updates=35160, lr=7.86858e-08, gnorm=3.012, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65049
2022-05-08 14:30:26 - progress_bar.py[line:272] - INFO: epoch 002:  17510 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=378.9, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880488, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.832, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.2, ups=0.58, wpb=378.9, bsz=32, num_updates=35170, lr=7.56825e-08, gnorm=3.042, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65067
2022-05-08 14:30:43 - progress_bar.py[line:272] - INFO: epoch 002:  17520 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877043, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.971, expert1_balance_bottom=18.936, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.6, ups=0.58, wpb=381.3, bsz=32, num_updates=35180, lr=7.26792e-08, gnorm=3.238, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65084
2022-05-08 14:31:00 - progress_bar.py[line:272] - INFO: epoch 002:  17530 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.853, expert1_balance_bottom=18.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=220.5, ups=0.58, wpb=382.3, bsz=32, num_updates=35190, lr=6.96759e-08, gnorm=3.083, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65101
2022-05-08 14:31:18 - progress_bar.py[line:272] - INFO: epoch 002:  17540 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=379.1, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881576, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.241, expert1_balance_bottom=19.071, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221.5, ups=0.58, wpb=379.1, bsz=32, num_updates=35200, lr=6.66727e-08, gnorm=3.048, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65118
2022-05-08 14:31:35 - progress_bar.py[line:272] - INFO: epoch 002:  17550 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=376.9, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.422, expert1_balance_bottom=19.067, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.4, ups=0.59, wpb=376.9, bsz=32, num_updates=35210, lr=6.36694e-08, gnorm=3.259, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65135
2022-05-08 14:31:51 - progress_bar.py[line:272] - INFO: epoch 002:  17560 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883223, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.949, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=228.4, ups=0.6, wpb=383.3, bsz=32, num_updates=35220, lr=6.06661e-08, gnorm=3.415, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65152
2022-05-08 14:32:08 - progress_bar.py[line:272] - INFO: epoch 002:  17570 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=35.378, expert1_balance_bottom=18.941, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=227.1, ups=0.59, wpb=384.8, bsz=32, num_updates=35230, lr=5.76629e-08, gnorm=3.265, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65169
2022-05-08 14:32:26 - progress_bar.py[line:272] - INFO: epoch 002:  17580 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=386, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877888, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.767, expert1_balance_bottom=18.953, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=221.9, ups=0.57, wpb=386, bsz=32, num_updates=35240, lr=5.46596e-08, gnorm=2.898, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65186
2022-05-08 14:32:43 - progress_bar.py[line:272] - INFO: epoch 002:  17590 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=387.2, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881072, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.711, expert1_balance_bottom=18.907, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.1, ups=0.59, wpb=387.2, bsz=32, num_updates=35250, lr=5.16563e-08, gnorm=3.196, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65204
2022-05-08 14:33:00 - progress_bar.py[line:272] - INFO: epoch 002:  17600 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=383.5, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.963, expert1_balance_bottom=19.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224, ups=0.58, wpb=383.5, bsz=32, num_updates=35260, lr=4.8653e-08, gnorm=2.994, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65221
2022-05-08 14:33:17 - progress_bar.py[line:272] - INFO: epoch 002:  17610 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=385.9, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883838, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.316, expert1_balance_bottom=19.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=225.4, ups=0.58, wpb=385.9, bsz=32, num_updates=35270, lr=4.56498e-08, gnorm=3.552, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.7, wall=65238
2022-05-08 14:33:34 - progress_bar.py[line:272] - INFO: epoch 002:  17620 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=394.4, nsentences=32, sample_size=314.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.034, expert1_balance_bottom=19.173, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=232.1, ups=0.59, wpb=394.4, bsz=32, num_updates=35280, lr=4.26465e-08, gnorm=4.107, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65255
2022-05-08 14:33:51 - progress_bar.py[line:272] - INFO: epoch 002:  17630 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.527, expert1_balance_bottom=19.003, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221.3, ups=0.58, wpb=383.2, bsz=32, num_updates=35290, lr=3.96432e-08, gnorm=3.117, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65272
2022-05-08 14:34:09 - progress_bar.py[line:272] - INFO: epoch 002:  17640 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=382.3, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875047, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.056, expert1_balance_bottom=18.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=220.6, ups=0.58, wpb=382.3, bsz=32, num_updates=35300, lr=3.66399e-08, gnorm=3.128, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65289
2022-05-08 14:34:26 - progress_bar.py[line:272] - INFO: epoch 002:  17650 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88459, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.768, expert1_balance_bottom=18.784, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.2, ups=0.59, wpb=381.7, bsz=32, num_updates=35310, lr=3.36367e-08, gnorm=3.02, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65306
2022-05-08 14:34:43 - progress_bar.py[line:272] - INFO: epoch 002:  17660 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=370.4, nsentences=32, sample_size=294.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.588, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214.1, ups=0.58, wpb=370.4, bsz=32, num_updates=35320, lr=3.06334e-08, gnorm=2.976, loss_scale=128, train_wall=16, cuda_gb_allocated=14, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65324
2022-05-08 14:35:00 - progress_bar.py[line:272] - INFO: epoch 002:  17670 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=389, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.804, expert1_balance_bottom=19.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=226.2, ups=0.58, wpb=389, bsz=32, num_updates=35330, lr=2.76301e-08, gnorm=2.874, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65341
2022-05-08 14:35:17 - progress_bar.py[line:272] - INFO: epoch 002:  17680 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.304, expert1_balance_bottom=19.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.6, ups=0.58, wpb=382.1, bsz=32, num_updates=35340, lr=2.46268e-08, gnorm=3.26, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65358
2022-05-08 14:35:34 - progress_bar.py[line:272] - INFO: epoch 002:  17690 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=369.9, nsentences=32, sample_size=294.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.569, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.3, ups=0.58, wpb=369.9, bsz=32, num_updates=35350, lr=2.16236e-08, gnorm=2.962, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65375
2022-05-08 14:35:51 - progress_bar.py[line:272] - INFO: epoch 002:  17700 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.389, expert1_balance_bottom=19.084, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=226.8, ups=0.59, wpb=385.1, bsz=32, num_updates=35360, lr=1.86203e-08, gnorm=3.502, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65392
2022-05-08 14:36:08 - progress_bar.py[line:272] - INFO: epoch 002:  17710 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=33.757, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=228.7, ups=0.6, wpb=381.7, bsz=32, num_updates=35370, lr=1.5617e-08, gnorm=3.345, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.9, cuda_gb_free=9.6, wall=65409
2022-05-08 14:36:10 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 14:36:10 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 14:36:10 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 14:42:55 - train.py[line:517] - INFO: valid_step finished
2022-05-08 14:42:55 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 9.572 | loss_v1 0 | loss_v2 0 | nll_loss 7.883 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.970761 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.572 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.26 | expert1_balance_top 35.896 | expert1_balance_bottom 14.815 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 236.09 | cider 1.193 | wps 743.3 | wpb 481.7 | bsz 8 | num_updates 35371 | best_cider 1.203
2022-05-08 14:42:55 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 35371 updates
2022-05-08 14:42:55 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_last-rank-0.pt
2022-05-08 14:42:55 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_last-rank-0.pt
2022-05-08 14:43:08 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_last-rank-0.pt
2022-05-08 14:43:08 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_last-shared.pt
2022-05-08 14:43:20 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_last-shared.pt
2022-05-08 14:43:20 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint_last-rank-0.pt (epoch 2 @ 35371 updates, score 1.193) (writing took 24.779418729245663 seconds)
2022-05-08 14:43:20 - train.py[line:342] - INFO: end of epoch 2 (average epoch stats below)
2022-05-08 14:43:20 - progress_bar.py[line:282] - INFO: epoch 002 | loss 3.111 | loss_v1 0 | loss_v2 0 | nll_loss 0.892 | ntokens 382.741 | nsentences 32 | sample_size 304.597 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.885023 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 3.111 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.224 | expert1_balance_top 34.565 | expert1_balance_bottom 18.947 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 1.86 | wps 206.4 | ups 0.54 | wpb 382.7 | bsz 32 | num_updates 35371 | lr 1.53167e-08 | gnorm 3.392 | loss_scale 128 | train_wall 28715 | cuda_gb_allocated 14.1 | cuda_gb_reserved 14.9 | cuda_gb_free 9.6 | wall 65841
2022-05-08 14:43:20 - trainer.py[line:743] - INFO: loading train data for epoch 3
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 row count 566747 total row count 566747
slice_id 0 seek offset 0
2022-05-08 14:43:48 - train.py[line:224] - INFO: done training in 65839.9 seconds
