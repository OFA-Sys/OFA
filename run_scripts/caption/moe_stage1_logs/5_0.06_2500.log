2022-05-08 20:48:41 - utils.py[line:263] - INFO: distributed init (rank 0): env://
2022-05-08 20:48:41 - utils.py[line:269] - INFO: Start init
2022-05-08 20:48:41 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2022-05-08 20:48:41 - utils.py[line:279] - INFO: initialized host heming-ng1 as rank 0
single-machine distributed training is initialized.
2022-05-08 20:48:44 - train.py[line:78] - INFO: nvidia-smi stats: {'gpu_0_mem_used_gb': 7.1796875, 'gpu_1_mem_used_gb': 0.001953125, 'gpu_2_mem_used_gb': 0.001953125, 'gpu_3_mem_used_gb': 0.001953125}
2022-05-08 20:48:44 - train.py[line:81] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../ofa_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None, 'is_moe': False}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 8, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 2000, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 8, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 5, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [4], 'lr': [1e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './moe_stage1_checkpoints/5_0.06_2500', 'restore_file': './moe_stage1_checkpoints/2_0.06_2500/checkpoint.best_cider_1.2030.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 5000, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'cider', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '-rank-0', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807, 'stats_path': None, 'max_valid_steps': None}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='ofa_moe_base', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, alternate_ffn_embed_dim=0, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='ofa_moe_base', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=8, batch_size_valid=8, best_checkpoint_metric='cider', bf16=False, block_wise=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=0.0, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_moe_cross_entropy', cross_self_attention=False, curriculum=0, data='../../dataset/caption_data/caption_stage1_train.tsv,../../dataset/caption_data/caption_val.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_moe_freq=1, decoder_normalize_before=True, decoder_output_dim=768, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=1, distributed_port=-1, distributed_rank=0, distributed_world_size=1, drop_worst_after=2500, drop_worst_ratio=0.2, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_moe_freq=1, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_args='{"beam":1,"max_len_b":16,"no_repeat_ngram_size":3}', eval_bleu=False, eval_cider=True, eval_cider_cached_tokens='../../dataset/caption_data/cider_cached_tokens/coco-valid-words.p', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=True, freeze_encoder_embedding=True, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, log_nvidia_smi=False, lr=[1e-05], lr_scheduler='polynomial_decay', max_epoch=5, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=20, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, moe_eval_capacity_token_fraction=0.25, moe_expert_count=4, moe_expert_ffn_dim=0, moe_freq=1, moe_gate_loss_combine_method='average', moe_gate_loss_transform='none', moe_gate_loss_wt=1.0, moe_gating_use_fp32=True, moe_normalize_expert_grad='', moe_normalize_gate_prob_before_dropping=True, moe_second_expert_policy='all', moe_top1_expert=True, no_best_checkpoints=False, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_save_optimizer_state_on_training_finished=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=1, num_bins=1000, num_shards=1, num_workers=0, num_workers_valid=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patch_image_size=480, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, resnet_type='resnet101', restore_file='./moe_stage1_checkpoints/2_0.06_2500/checkpoint.best_cider_1.2030.pt', s3_upload_path=None, sample_patch_num=196, save_dir='./moe_stage1_checkpoints/5_0.06_2500', save_interval=1, save_interval_updates=5000, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,4,2', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, symlink_best_and_last_checkpoints=False, sync_bn=False, task='caption', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[4], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_moe_pad_mask=True, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../ofa_module', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=2000, wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'caption', 'data': '../../dataset/caption_data/caption_stage1_train.tsv,../../dataset/caption_data/caption_val.tsv', 'selected_cols': '0,4,2', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 20, 'code_dict_size': 8192, 'patch_image_size': 480, 'num_bins': 1000, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_bleu': False, 'eval_cider': True, 'eval_args': '{"beam":1,"max_len_b":16,"no_repeat_ngram_size":3}', 'eval_print_samples': False, 'eval_cider_cached_tokens': '../../dataset/caption_data/cider_cached_tokens/coco-valid-words.p', 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_moe_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.2, 'drop_worst_after': 2500, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None, 'moe_gate_loss_wt': 1.0, 'moe_gate_loss_combine_method': 'average', 'moe_gate_loss_transform': 'none'}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [1e-05], 'block_wise': False}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [1e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2022-05-08 20:48:44 - ofa_task.py[line:103] - INFO: source dictionary: 59457 types
2022-05-08 20:48:44 - ofa_task.py[line:104] - INFO: target dictionary: 59457 types
2022-05-08 20:48:45 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2022-05-08 20:48:45 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:3 to store for rank: 0
2022-05-08 20:48:45 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:4 to store for rank: 0
2022-05-08 20:48:51 - train.py[line:119] - INFO: OFAModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(59457, 768, padding_idx=1)
    (layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
      (layer2): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (3): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
      (layer3): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (3): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (4): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (5): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (6): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (7): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (8): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (9): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (10): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (11): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (12): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (13): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (14): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (15): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (16): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (17): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (18): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (19): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (20): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (21): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (22): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(59457, 768, padding_idx=1)
    (layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (output_projection): Linear(in_features=768, out_features=59457, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2022-05-08 20:48:51 - train.py[line:120] - INFO: task: CaptionTask
2022-05-08 20:48:51 - train.py[line:121] - INFO: model: OFAModel
2022-05-08 20:48:51 - train.py[line:122] - INFO: criterion: AdjustLabelSmoothedMOECrossEntropyCriterion
2022-05-08 20:48:51 - train.py[line:123] - INFO: num. shared model params: 125,606,216 (num. trained: 79,943,240)
2022-05-08 20:48:51 - train.py[line:130] - INFO: num. expert model params: 226676736 (num. trained: 226676736)
local datafile ../../dataset/caption_data/caption_val.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_val.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_val.tsv slice_id 0 row count 5000 total row count 5000
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/transforms.py:257: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  warnings.warn(
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.output_projection.weight
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.downsample.0.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.downsample.0.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.downsample.0.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv1.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv2.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv3.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.0.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.1.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.2.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.3.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.4.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.5.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.0.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.1.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.2.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.3.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.4.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.5.moe_layer.gate.wg.bias
2022-05-08 20:48:52 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.output_projection.bias
2022-05-08 20:48:52 - utils.py[line:779] - INFO: ***********************CUDA enviroments for all 1 workers***********************
2022-05-08 20:48:52 - utils.py[line:781] - INFO: rank   0: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2022-05-08 20:48:52 - utils.py[line:787] - INFO: ***********************CUDA enviroments for all 1 workers***********************
2022-05-08 20:48:52 - train.py[line:161] - INFO: training on 1 devices (GPUs/TPUs)
2022-05-08 20:48:52 - train.py[line:166] - INFO: max tokens per device = None and max sentences per device = 8
2022-05-08 20:48:52 - train.py[line:172] - INFO: nvidia-smi stats: {'gpu_0_mem_used_gb': 7.92578125, 'gpu_1_mem_used_gb': 0.001953125, 'gpu_2_mem_used_gb': 0.001953125, 'gpu_3_mem_used_gb': 0.001953125}
2022-05-08 20:48:52 - trainer.py[line:547] - INFO: Preparing to load checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint.best_cider_1.2030-rank-0.pt
2022-05-08 20:48:56 - trainer.py[line:569] - INFO: Loaded state for ./moe_stage1_checkpoints/2_0.06_2500/checkpoint.best_cider_1.2030-rank-0.pt
2022-05-08 20:48:57 - adam.py[line:70] - INFO: using FusedAdam
2022-05-08 20:48:57 - trainer.py[line:721] - INFO: Loaded checkpoint ./moe_stage1_checkpoints/2_0.06_2500/checkpoint.best_cider_1.2030-rank-0.pt (epoch 2 @ 0 updates)
2022-05-08 20:48:57 - trainer.py[line:743] - INFO: loading train data for epoch 1
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 row count 566747 total row count 566747
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/transforms.py:257: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  warnings.warn(
slice_id 0 seek offset 0
Total steps 88555, warmup steps 5313, warmup_factor 0.00018821757952192734
2022-05-08 20:49:22 - trainer.py[line:807] - INFO: begin training epoch 1
2022-05-08 20:49:22 - train.py[line:315] - INFO: Start iterating over samples
2022-05-08 20:49:33 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 20:49:56 - progress_bar.py[line:272] - INFO: epoch 001:     11 / 17711 loss=4.169, loss_v1=0, loss_v2=0, nll_loss=2.07, ntokens=381.4, nsentences=32, sample_size=381.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.543, expert1_balance_bottom=19.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.2, wps=179.8, ups=0.47, wpb=381.4, bsz=32, num_updates=10, lr=1.88218e-08, gnorm=4.668, loss_scale=64, train_wall=33, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=64
2022-05-08 20:50:15 - progress_bar.py[line:272] - INFO: epoch 001:     21 / 17711 loss=4.288, loss_v1=0, loss_v2=0, nll_loss=2.201, ntokens=383.2, nsentences=32, sample_size=383.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.288, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.739, expert1_balance_bottom=18.919, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.6, wps=202, ups=0.53, wpb=383.2, bsz=32, num_updates=20, lr=3.76435e-08, gnorm=4.995, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=83
2022-05-08 20:50:33 - progress_bar.py[line:272] - INFO: epoch 001:     31 / 17711 loss=4.221, loss_v1=0, loss_v2=0, nll_loss=2.129, ntokens=377.9, nsentences=32, sample_size=377.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.472, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.37, wps=210.9, ups=0.56, wpb=377.9, bsz=32, num_updates=30, lr=5.64653e-08, gnorm=5.077, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=101
2022-05-08 20:50:51 - progress_bar.py[line:272] - INFO: epoch 001:     41 / 17711 loss=4.248, loss_v1=0, loss_v2=0, nll_loss=2.164, ntokens=376.5, nsentences=32, sample_size=376.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.248, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.828, expert1_balance_bottom=18.861, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.48, wps=212.9, ups=0.57, wpb=376.5, bsz=32, num_updates=40, lr=7.5287e-08, gnorm=4.889, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=119
2022-05-08 20:51:08 - progress_bar.py[line:272] - INFO: epoch 001:     51 / 17711 loss=4.136, loss_v1=0, loss_v2=0, nll_loss=2.021, ntokens=384.4, nsentences=32, sample_size=384.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.32, expert1_balance_bottom=19.108, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.06, wps=218.4, ups=0.57, wpb=384.4, bsz=32, num_updates=50, lr=9.41088e-08, gnorm=4.924, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=136
2022-05-08 20:51:26 - progress_bar.py[line:272] - INFO: epoch 001:     61 / 17711 loss=4.341, loss_v1=0, loss_v2=0, nll_loss=2.27, ntokens=385, nsentences=32, sample_size=385, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.341, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.003, expert1_balance_bottom=18.867, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.82, wps=217.2, ups=0.56, wpb=385, bsz=32, num_updates=60, lr=1.12931e-07, gnorm=4.781, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=154
2022-05-08 20:51:44 - progress_bar.py[line:272] - INFO: epoch 001:     71 / 17711 loss=4.222, loss_v1=0, loss_v2=0, nll_loss=2.134, ntokens=377.1, nsentences=32, sample_size=377.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877956, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.222, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.17, expert1_balance_bottom=19.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.39, wps=212, ups=0.56, wpb=377.1, bsz=32, num_updates=70, lr=1.31752e-07, gnorm=4.621, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=172
2022-05-08 20:52:03 - progress_bar.py[line:272] - INFO: epoch 001:     81 / 17711 loss=4.207, loss_v1=0, loss_v2=0, nll_loss=2.104, ntokens=378.6, nsentences=32, sample_size=378.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889283, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.207, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.234, expert1_balance_bottom=19.226, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.3, wps=199, ups=0.53, wpb=378.6, bsz=32, num_updates=80, lr=1.50574e-07, gnorm=4.662, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=191
2022-05-08 20:52:20 - progress_bar.py[line:272] - INFO: epoch 001:     91 / 17711 loss=4.179, loss_v1=0, loss_v2=0, nll_loss=2.076, ntokens=387.9, nsentences=32, sample_size=387.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.179, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.38, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.22, wps=223.7, ups=0.58, wpb=387.9, bsz=32, num_updates=90, lr=1.69396e-07, gnorm=4.568, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=208
2022-05-08 20:52:37 - progress_bar.py[line:272] - INFO: epoch 001:    101 / 17711 loss=4.267, loss_v1=0, loss_v2=0, nll_loss=2.189, ntokens=392.9, nsentences=32, sample_size=392.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.267, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.67, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.56, wps=227.5, ups=0.58, wpb=392.9, bsz=32, num_updates=100, lr=1.88218e-07, gnorm=4.533, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=225
2022-05-08 20:52:55 - progress_bar.py[line:272] - INFO: epoch 001:    111 / 17711 loss=4.185, loss_v1=0, loss_v2=0, nll_loss=2.082, ntokens=389.6, nsentences=32, sample_size=389.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.185, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.122, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.24, wps=220.8, ups=0.57, wpb=389.6, bsz=32, num_updates=110, lr=2.07039e-07, gnorm=4.485, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=243
2022-05-08 20:53:13 - progress_bar.py[line:272] - INFO: epoch 001:    121 / 17711 loss=4.151, loss_v1=0, loss_v2=0, nll_loss=2.057, ntokens=377.7, nsentences=32, sample_size=377.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.861, expert1_balance_bottom=18.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.16, wps=214.4, ups=0.57, wpb=377.7, bsz=32, num_updates=120, lr=2.25861e-07, gnorm=4.502, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=261
2022-05-08 20:53:30 - progress_bar.py[line:272] - INFO: epoch 001:    131 / 17711 loss=4.152, loss_v1=0, loss_v2=0, nll_loss=2.049, ntokens=381.1, nsentences=32, sample_size=381.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.108, expert1_balance_bottom=18.984, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.14, wps=219.5, ups=0.58, wpb=381.1, bsz=32, num_updates=130, lr=2.44683e-07, gnorm=5.126, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=278
2022-05-08 20:53:47 - progress_bar.py[line:272] - INFO: epoch 001:    141 / 17711 loss=4.187, loss_v1=0, loss_v2=0, nll_loss=2.093, ntokens=382.4, nsentences=32, sample_size=382.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.413, expert1_balance_bottom=18.849, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.27, wps=218.6, ups=0.57, wpb=382.4, bsz=32, num_updates=140, lr=2.63505e-07, gnorm=4.483, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=295
2022-05-08 20:54:05 - progress_bar.py[line:272] - INFO: epoch 001:    151 / 17711 loss=4.085, loss_v1=0, loss_v2=0, nll_loss=1.98, ntokens=377, nsentences=32, sample_size=377, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890728, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.439, expert1_balance_bottom=19.014, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.95, wps=218.8, ups=0.58, wpb=377, bsz=32, num_updates=150, lr=2.82326e-07, gnorm=4.769, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=313
2022-05-08 20:54:22 - progress_bar.py[line:272] - INFO: epoch 001:    161 / 17711 loss=4.217, loss_v1=0, loss_v2=0, nll_loss=2.129, ntokens=381.7, nsentences=32, sample_size=381.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.217, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.688, expert1_balance_bottom=18.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.38, wps=217.5, ups=0.57, wpb=381.7, bsz=32, num_updates=160, lr=3.01148e-07, gnorm=4.386, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=330
2022-05-08 20:54:40 - progress_bar.py[line:272] - INFO: epoch 001:    171 / 17711 loss=4.184, loss_v1=0, loss_v2=0, nll_loss=2.087, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.933, expert1_balance_bottom=19.128, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.25, wps=217.5, ups=0.57, wpb=382.5, bsz=32, num_updates=170, lr=3.1997e-07, gnorm=4.713, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=348
2022-05-08 20:54:57 - progress_bar.py[line:272] - INFO: epoch 001:    181 / 17711 loss=4.177, loss_v1=0, loss_v2=0, nll_loss=2.099, ntokens=379.1, nsentences=32, sample_size=379.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.67, expert1_balance_bottom=18.92, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.29, wps=217.3, ups=0.57, wpb=379.1, bsz=32, num_updates=180, lr=3.38792e-07, gnorm=4.513, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=365
2022-05-08 20:55:16 - progress_bar.py[line:272] - INFO: epoch 001:    191 / 17711 loss=4.017, loss_v1=0, loss_v2=0, nll_loss=1.924, ntokens=387.1, nsentences=32, sample_size=387.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879476, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.661, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=207.7, ups=0.54, wpb=387.1, bsz=32, num_updates=190, lr=3.57613e-07, gnorm=4.241, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=384
2022-05-08 20:55:34 - progress_bar.py[line:272] - INFO: epoch 001:    201 / 17711 loss=4.142, loss_v1=0, loss_v2=0, nll_loss=2.061, ntokens=383.4, nsentences=32, sample_size=383.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883614, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.954, expert1_balance_bottom=18.85, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.17, wps=212.5, ups=0.55, wpb=383.4, bsz=32, num_updates=200, lr=3.76435e-07, gnorm=3.812, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=402
2022-05-08 20:55:53 - progress_bar.py[line:272] - INFO: epoch 001:    211 / 17711 loss=4.207, loss_v1=0, loss_v2=0, nll_loss=2.137, ntokens=380.6, nsentences=32, sample_size=380.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.207, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.617, expert1_balance_bottom=18.839, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.4, wps=204.9, ups=0.54, wpb=380.6, bsz=32, num_updates=210, lr=3.95257e-07, gnorm=4.239, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=421
2022-05-08 20:56:11 - progress_bar.py[line:272] - INFO: epoch 001:    221 / 17711 loss=4.221, loss_v1=0, loss_v2=0, nll_loss=2.152, ntokens=375.2, nsentences=32, sample_size=375.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.221, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.34, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.44, wps=205.4, ups=0.55, wpb=375.2, bsz=32, num_updates=220, lr=4.14079e-07, gnorm=4.01, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=14.7, cuda_gb_free=9.6, wall=439
2022-05-08 20:56:29 - progress_bar.py[line:272] - INFO: epoch 001:    231 / 17711 loss=4.223, loss_v1=0, loss_v2=0, nll_loss=2.159, ntokens=377.9, nsentences=32, sample_size=377.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885553, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.223, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.624, expert1_balance_bottom=19.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.47, wps=207.9, ups=0.55, wpb=377.9, bsz=32, num_updates=230, lr=4.329e-07, gnorm=4.322, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=457
2022-05-08 20:56:48 - progress_bar.py[line:272] - INFO: epoch 001:    241 / 17711 loss=4.263, loss_v1=0, loss_v2=0, nll_loss=2.228, ntokens=381.9, nsentences=32, sample_size=381.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86682, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.263, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.534, expert1_balance_bottom=18.713, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.68, wps=202.8, ups=0.53, wpb=381.9, bsz=32, num_updates=240, lr=4.51722e-07, gnorm=4.387, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=476
2022-05-08 20:57:06 - progress_bar.py[line:272] - INFO: epoch 001:    251 / 17711 loss=4.2, loss_v1=0, loss_v2=0, nll_loss=2.15, ntokens=386, nsentences=32, sample_size=386, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.2, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.01, expert1_balance_bottom=18.935, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.44, wps=215.7, ups=0.56, wpb=386, bsz=32, num_updates=250, lr=4.70544e-07, gnorm=4.008, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=494
2022-05-08 20:57:24 - progress_bar.py[line:272] - INFO: epoch 001:    261 / 17711 loss=4.147, loss_v1=0, loss_v2=0, nll_loss=2.092, ntokens=385.6, nsentences=32, sample_size=385.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.281, expert1_balance_bottom=18.824, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.26, wps=212.4, ups=0.55, wpb=385.6, bsz=32, num_updates=260, lr=4.89366e-07, gnorm=3.801, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=512
2022-05-08 20:57:42 - progress_bar.py[line:272] - INFO: epoch 001:    271 / 17711 loss=4.274, loss_v1=0, loss_v2=0, nll_loss=2.239, ntokens=384.9, nsentences=32, sample_size=384.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873993, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.274, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.939, expert1_balance_bottom=18.901, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.72, wps=212.7, ups=0.55, wpb=384.9, bsz=32, num_updates=270, lr=5.08187e-07, gnorm=3.874, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=530
2022-05-08 20:58:00 - progress_bar.py[line:272] - INFO: epoch 001:    281 / 17711 loss=4.078, loss_v1=0, loss_v2=0, nll_loss=1.998, ntokens=382.4, nsentences=32, sample_size=382.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898324, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.079, expert1_balance_bottom=19.265, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.99, wps=211.3, ups=0.55, wpb=382.4, bsz=32, num_updates=280, lr=5.27009e-07, gnorm=3.722, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=548
2022-05-08 20:58:18 - progress_bar.py[line:272] - INFO: epoch 001:    291 / 17711 loss=4.103, loss_v1=0, loss_v2=0, nll_loss=2.035, ntokens=378.5, nsentences=32, sample_size=378.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.512, expert1_balance_bottom=19.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.1, wps=210.5, ups=0.56, wpb=378.5, bsz=32, num_updates=290, lr=5.45831e-07, gnorm=3.809, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=566
2022-05-08 20:58:36 - progress_bar.py[line:272] - INFO: epoch 001:    301 / 17711 loss=4.088, loss_v1=0, loss_v2=0, nll_loss=2.021, ntokens=374.5, nsentences=32, sample_size=374.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.589, expert1_balance_bottom=18.981, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.06, wps=207.5, ups=0.55, wpb=374.5, bsz=32, num_updates=300, lr=5.64653e-07, gnorm=3.144, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=584
2022-05-08 20:58:54 - progress_bar.py[line:272] - INFO: epoch 001:    311 / 17711 loss=4.085, loss_v1=0, loss_v2=0, nll_loss=2.016, ntokens=386.4, nsentences=32, sample_size=386.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888566, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.035, expert1_balance_bottom=19.095, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.05, wps=214.4, ups=0.55, wpb=386.4, bsz=32, num_updates=310, lr=5.83474e-07, gnorm=3.592, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=602
2022-05-08 20:59:12 - progress_bar.py[line:272] - INFO: epoch 001:    321 / 17711 loss=4.202, loss_v1=0, loss_v2=0, nll_loss=2.166, ntokens=383.1, nsentences=32, sample_size=383.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.202, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.023, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.49, wps=210.1, ups=0.55, wpb=383.1, bsz=32, num_updates=320, lr=6.02296e-07, gnorm=3.482, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=620
2022-05-08 20:59:30 - progress_bar.py[line:272] - INFO: epoch 001:    331 / 17711 loss=4.063, loss_v1=0, loss_v2=0, nll_loss=1.996, ntokens=388.7, nsentences=32, sample_size=388.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.638, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.99, wps=214.9, ups=0.55, wpb=388.7, bsz=32, num_updates=330, lr=6.21118e-07, gnorm=4.355, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=638
2022-05-08 20:59:48 - progress_bar.py[line:272] - INFO: epoch 001:    341 / 17711 loss=4.031, loss_v1=0, loss_v2=0, nll_loss=1.955, ntokens=378.1, nsentences=32, sample_size=378.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.986, expert1_balance_bottom=19.259, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=209.6, ups=0.55, wpb=378.1, bsz=32, num_updates=340, lr=6.3994e-07, gnorm=4.061, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=656
2022-05-08 21:00:07 - progress_bar.py[line:272] - INFO: epoch 001:    351 / 17711 loss=4.107, loss_v1=0, loss_v2=0, nll_loss=2.032, ntokens=379.2, nsentences=32, sample_size=379.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.743, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.09, wps=210, ups=0.55, wpb=379.2, bsz=32, num_updates=350, lr=6.58762e-07, gnorm=4.104, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=675
2022-05-08 21:00:24 - progress_bar.py[line:272] - INFO: epoch 001:    361 / 17711 loss=4.028, loss_v1=0, loss_v2=0, nll_loss=1.945, ntokens=383.4, nsentences=32, sample_size=383.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899878, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.773, expert1_balance_bottom=19.199, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.85, wps=214.1, ups=0.56, wpb=383.4, bsz=32, num_updates=360, lr=6.77583e-07, gnorm=3.434, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=692
2022-05-08 21:00:42 - progress_bar.py[line:272] - INFO: epoch 001:    371 / 17711 loss=4.083, loss_v1=0, loss_v2=0, nll_loss=2.017, ntokens=388, nsentences=32, sample_size=388, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889209, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.603, expert1_balance_bottom=19.03, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.05, wps=215.5, ups=0.56, wpb=388, bsz=32, num_updates=370, lr=6.96405e-07, gnorm=3.374, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=710
2022-05-08 21:01:01 - progress_bar.py[line:272] - INFO: epoch 001:    381 / 17711 loss=4.112, loss_v1=0, loss_v2=0, nll_loss=2.042, ntokens=388, nsentences=32, sample_size=388, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896427, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.108, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.12, wps=213, ups=0.55, wpb=388, bsz=32, num_updates=380, lr=7.15227e-07, gnorm=4.533, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=729
2022-05-08 21:01:18 - progress_bar.py[line:272] - INFO: epoch 001:    391 / 17711 loss=4.104, loss_v1=0, loss_v2=0, nll_loss=2.055, ntokens=393.1, nsentences=32, sample_size=393.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.047, expert1_balance_bottom=18.859, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.15, wps=222.4, ups=0.57, wpb=393.1, bsz=32, num_updates=390, lr=7.34049e-07, gnorm=3.583, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=746
2022-05-08 21:01:36 - progress_bar.py[line:272] - INFO: epoch 001:    401 / 17711 loss=4.149, loss_v1=0, loss_v2=0, nll_loss=2.101, ntokens=386.4, nsentences=32, sample_size=386.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876081, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.672, expert1_balance_bottom=18.846, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.29, wps=222.2, ups=0.58, wpb=386.4, bsz=32, num_updates=400, lr=7.5287e-07, gnorm=3.389, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=764
2022-05-08 21:01:54 - progress_bar.py[line:272] - INFO: epoch 001:    411 / 17711 loss=4.139, loss_v1=0, loss_v2=0, nll_loss=2.086, ntokens=381.2, nsentences=32, sample_size=381.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884286, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.49, expert1_balance_bottom=19.104, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.25, wps=213.2, ups=0.56, wpb=381.2, bsz=32, num_updates=410, lr=7.71692e-07, gnorm=3.584, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=782
2022-05-08 21:02:12 - progress_bar.py[line:272] - INFO: epoch 001:    421 / 17711 loss=4.073, loss_v1=0, loss_v2=0, nll_loss=2.01, ntokens=379, nsentences=32, sample_size=379, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884635, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.747, expert1_balance_bottom=18.915, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.03, wps=211.4, ups=0.56, wpb=379, bsz=32, num_updates=420, lr=7.90514e-07, gnorm=3.739, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=800
2022-05-08 21:02:30 - progress_bar.py[line:272] - INFO: epoch 001:    431 / 17711 loss=4.116, loss_v1=0, loss_v2=0, nll_loss=2.065, ntokens=387.2, nsentences=32, sample_size=387.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.863, expert1_balance_bottom=18.877, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.18, wps=212.7, ups=0.55, wpb=387.2, bsz=32, num_updates=430, lr=8.09336e-07, gnorm=3.498, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=818
2022-05-08 21:02:48 - progress_bar.py[line:272] - INFO: epoch 001:    441 / 17711 loss=4.157, loss_v1=0, loss_v2=0, nll_loss=2.102, ntokens=375.8, nsentences=32, sample_size=375.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.509, expert1_balance_bottom=19.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.29, wps=207.4, ups=0.55, wpb=375.8, bsz=32, num_updates=440, lr=8.28157e-07, gnorm=3.514, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=836
2022-05-08 21:03:06 - progress_bar.py[line:272] - INFO: epoch 001:    451 / 17711 loss=4.118, loss_v1=0, loss_v2=0, nll_loss=2.061, ntokens=378.5, nsentences=32, sample_size=378.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883432, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.934, expert1_balance_bottom=18.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.17, wps=213.6, ups=0.56, wpb=378.5, bsz=32, num_updates=450, lr=8.46979e-07, gnorm=4.646, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=854
2022-05-08 21:03:23 - progress_bar.py[line:272] - INFO: epoch 001:    461 / 17711 loss=4.106, loss_v1=0, loss_v2=0, nll_loss=2.05, ntokens=378.8, nsentences=32, sample_size=378.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882353, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=35.135, expert1_balance_bottom=18.717, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.14, wps=212.1, ups=0.56, wpb=378.8, bsz=32, num_updates=460, lr=8.65801e-07, gnorm=3.651, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=871
2022-05-08 21:03:41 - progress_bar.py[line:272] - INFO: epoch 001:    471 / 17711 loss=4.094, loss_v1=0, loss_v2=0, nll_loss=2.026, ntokens=380.6, nsentences=32, sample_size=380.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895818, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.755, expert1_balance_bottom=19.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.07, wps=211.4, ups=0.56, wpb=380.6, bsz=32, num_updates=470, lr=8.84623e-07, gnorm=3.361, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=889
2022-05-08 21:04:00 - progress_bar.py[line:272] - INFO: epoch 001:    481 / 17711 loss=4.085, loss_v1=0, loss_v2=0, nll_loss=2.01, ntokens=374, nsentences=32, sample_size=374, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=34.024, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.03, wps=204.8, ups=0.55, wpb=374, bsz=32, num_updates=480, lr=9.03444e-07, gnorm=3.755, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=908
2022-05-08 21:04:18 - progress_bar.py[line:272] - INFO: epoch 001:    491 / 17711 loss=4.12, loss_v1=0, loss_v2=0, nll_loss=2.061, ntokens=384.3, nsentences=32, sample_size=384.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.678, expert1_balance_bottom=18.933, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.17, wps=212.7, ups=0.55, wpb=384.3, bsz=32, num_updates=490, lr=9.22266e-07, gnorm=3.851, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=926
2022-05-08 21:04:36 - progress_bar.py[line:272] - INFO: epoch 001:    501 / 17711 loss=4.029, loss_v1=0, loss_v2=0, nll_loss=1.958, ntokens=386.2, nsentences=32, sample_size=386.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.526, expert1_balance_bottom=19.07, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.89, wps=214.4, ups=0.56, wpb=386.2, bsz=32, num_updates=500, lr=9.41088e-07, gnorm=3.488, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=944
2022-05-08 21:04:54 - progress_bar.py[line:272] - INFO: epoch 001:    511 / 17711 loss=4.04, loss_v1=0, loss_v2=0, nll_loss=1.973, ntokens=381.8, nsentences=32, sample_size=381.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887241, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.428, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.93, wps=211.5, ups=0.55, wpb=381.8, bsz=32, num_updates=510, lr=9.5991e-07, gnorm=3.407, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=962
2022-05-08 21:05:12 - progress_bar.py[line:272] - INFO: epoch 001:    521 / 17711 loss=4.124, loss_v1=0, loss_v2=0, nll_loss=2.065, ntokens=385.6, nsentences=32, sample_size=385.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.617, expert1_balance_bottom=18.967, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.18, wps=215.3, ups=0.56, wpb=385.6, bsz=32, num_updates=520, lr=9.78731e-07, gnorm=3.373, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=980
2022-05-08 21:05:30 - progress_bar.py[line:272] - INFO: epoch 001:    531 / 17711 loss=4.132, loss_v1=0, loss_v2=0, nll_loss=2.074, ntokens=383.9, nsentences=32, sample_size=383.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884421, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=35.048, expert1_balance_bottom=19.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.21, wps=212.3, ups=0.55, wpb=383.9, bsz=32, num_updates=530, lr=9.97553e-07, gnorm=3.886, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=998
2022-05-08 21:05:48 - progress_bar.py[line:272] - INFO: epoch 001:    541 / 17711 loss=4.03, loss_v1=0, loss_v2=0, nll_loss=1.968, ntokens=374.8, nsentences=32, sample_size=374.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.795, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.91, wps=209.1, ups=0.56, wpb=374.8, bsz=32, num_updates=540, lr=1.01637e-06, gnorm=3.358, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1016
2022-05-08 21:06:06 - progress_bar.py[line:272] - INFO: epoch 001:    551 / 17711 loss=4.026, loss_v1=0, loss_v2=0, nll_loss=1.956, ntokens=388.2, nsentences=32, sample_size=388.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.294, expert1_balance_bottom=19.053, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=215.2, ups=0.55, wpb=388.2, bsz=32, num_updates=550, lr=1.0352e-06, gnorm=3.637, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1034
2022-05-08 21:06:24 - progress_bar.py[line:272] - INFO: epoch 001:    561 / 17711 loss=4.121, loss_v1=0, loss_v2=0, nll_loss=2.06, ntokens=390.9, nsentences=32, sample_size=390.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886458, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.394, expert1_balance_bottom=19.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.17, wps=217, ups=0.56, wpb=390.9, bsz=32, num_updates=560, lr=1.05402e-06, gnorm=3.256, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1052
2022-05-08 21:06:27 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 21:06:43 - progress_bar.py[line:272] - INFO: epoch 001:    572 / 17711 loss=4.124, loss_v1=0, loss_v2=0, nll_loss=2.068, ntokens=380.2, nsentences=32, sample_size=380.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88088, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=35.092, expert1_balance_bottom=18.842, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.19, wps=193.2, ups=0.51, wpb=380.2, bsz=32, num_updates=570, lr=1.07284e-06, gnorm=3.404, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1072
2022-05-08 21:07:01 - progress_bar.py[line:272] - INFO: epoch 001:    582 / 17711 loss=4.11, loss_v1=0, loss_v2=0, nll_loss=2.043, ntokens=388.5, nsentences=32, sample_size=388.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.737, expert1_balance_bottom=19.04, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.12, wps=217.4, ups=0.56, wpb=388.5, bsz=32, num_updates=580, lr=1.09166e-06, gnorm=3.706, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1089
2022-05-08 21:07:19 - progress_bar.py[line:272] - INFO: epoch 001:    592 / 17711 loss=4.09, loss_v1=0, loss_v2=0, nll_loss=2.043, ntokens=382.1, nsentences=32, sample_size=382.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.623, expert1_balance_bottom=18.77, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.12, wps=214, ups=0.56, wpb=382.1, bsz=32, num_updates=590, lr=1.11048e-06, gnorm=3.985, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1107
2022-05-08 21:07:37 - progress_bar.py[line:272] - INFO: epoch 001:    602 / 17711 loss=4.095, loss_v1=0, loss_v2=0, nll_loss=2.028, ntokens=386.7, nsentences=32, sample_size=386.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882354, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.832, expert1_balance_bottom=18.955, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.08, wps=215.2, ups=0.56, wpb=386.7, bsz=32, num_updates=600, lr=1.12931e-06, gnorm=3.57, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1125
2022-05-08 21:07:55 - progress_bar.py[line:272] - INFO: epoch 001:    612 / 17711 loss=4.136, loss_v1=0, loss_v2=0, nll_loss=2.073, ntokens=381.1, nsentences=32, sample_size=381.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.509, expert1_balance_bottom=18.884, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.21, wps=212.6, ups=0.56, wpb=381.1, bsz=32, num_updates=610, lr=1.14813e-06, gnorm=3.736, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1143
2022-05-08 21:08:13 - progress_bar.py[line:272] - INFO: epoch 001:    622 / 17711 loss=4.114, loss_v1=0, loss_v2=0, nll_loss=2.041, ntokens=377.1, nsentences=32, sample_size=377.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.421, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.12, wps=212.1, ups=0.56, wpb=377.1, bsz=32, num_updates=620, lr=1.16695e-06, gnorm=3.544, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1161
2022-05-08 21:08:31 - progress_bar.py[line:272] - INFO: epoch 001:    632 / 17711 loss=4.149, loss_v1=0, loss_v2=0, nll_loss=2.093, ntokens=381.4, nsentences=32, sample_size=381.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.491, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.27, wps=214.1, ups=0.56, wpb=381.4, bsz=32, num_updates=630, lr=1.18577e-06, gnorm=3.464, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1179
2022-05-08 21:08:49 - progress_bar.py[line:272] - INFO: epoch 001:    642 / 17711 loss=4.109, loss_v1=0, loss_v2=0, nll_loss=2.057, ntokens=383.7, nsentences=32, sample_size=383.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874192, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=35.404, expert1_balance_bottom=18.788, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.16, wps=213.9, ups=0.56, wpb=383.7, bsz=32, num_updates=640, lr=1.20459e-06, gnorm=3.44, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1197
2022-05-08 21:09:07 - progress_bar.py[line:272] - INFO: epoch 001:    652 / 17711 loss=4.119, loss_v1=0, loss_v2=0, nll_loss=2.06, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.898, expert1_balance_bottom=18.971, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.17, wps=212.8, ups=0.56, wpb=382.5, bsz=32, num_updates=650, lr=1.22341e-06, gnorm=3.188, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1215
2022-05-08 21:09:25 - progress_bar.py[line:272] - INFO: epoch 001:    662 / 17711 loss=4.064, loss_v1=0, loss_v2=0, nll_loss=1.998, ntokens=388.1, nsentences=32, sample_size=388.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884171, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.653, expert1_balance_bottom=19.073, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.99, wps=215.5, ups=0.56, wpb=388.1, bsz=32, num_updates=660, lr=1.24224e-06, gnorm=3.233, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1233
2022-05-08 21:09:42 - progress_bar.py[line:272] - INFO: epoch 001:    672 / 17711 loss=3.963, loss_v1=0, loss_v2=0, nll_loss=1.885, ntokens=387.6, nsentences=32, sample_size=387.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.692, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=216.7, ups=0.56, wpb=387.6, bsz=32, num_updates=670, lr=1.26106e-06, gnorm=2.931, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1251
2022-05-08 21:10:00 - progress_bar.py[line:272] - INFO: epoch 001:    682 / 17711 loss=4.08, loss_v1=0, loss_v2=0, nll_loss=2.029, ntokens=391.1, nsentences=32, sample_size=391.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8704, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.6, expert1_balance_bottom=18.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.08, wps=217.4, ups=0.56, wpb=391.1, bsz=32, num_updates=680, lr=1.27988e-06, gnorm=3.296, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1269
2022-05-08 21:10:18 - progress_bar.py[line:272] - INFO: epoch 001:    692 / 17711 loss=3.98, loss_v1=0, loss_v2=0, nll_loss=1.903, ntokens=379.7, nsentences=32, sample_size=379.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.98, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=213, ups=0.56, wpb=379.7, bsz=32, num_updates=690, lr=1.2987e-06, gnorm=3.501, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1286
2022-05-08 21:10:36 - progress_bar.py[line:272] - INFO: epoch 001:    702 / 17711 loss=4.113, loss_v1=0, loss_v2=0, nll_loss=2.056, ntokens=387.3, nsentences=32, sample_size=387.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=35.366, expert1_balance_bottom=18.981, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.16, wps=214, ups=0.55, wpb=387.3, bsz=32, num_updates=700, lr=1.31752e-06, gnorm=3.43, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1304
2022-05-08 21:10:55 - progress_bar.py[line:272] - INFO: epoch 001:    712 / 17711 loss=4.111, loss_v1=0, loss_v2=0, nll_loss=2.046, ntokens=385.9, nsentences=32, sample_size=385.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.451, expert1_balance_bottom=18.974, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.13, wps=209.6, ups=0.54, wpb=385.9, bsz=32, num_updates=710, lr=1.33634e-06, gnorm=3.843, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1323
2022-05-08 21:11:13 - progress_bar.py[line:272] - INFO: epoch 001:    722 / 17711 loss=4.053, loss_v1=0, loss_v2=0, nll_loss=1.977, ntokens=383, nsentences=32, sample_size=383, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.05, expert1_balance_bottom=19.343, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=213.4, ups=0.56, wpb=383, bsz=32, num_updates=720, lr=1.35517e-06, gnorm=3.31, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1341
2022-05-08 21:11:31 - progress_bar.py[line:272] - INFO: epoch 001:    732 / 17711 loss=4.177, loss_v1=0, loss_v2=0, nll_loss=2.124, ntokens=384, nsentences=32, sample_size=384, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878613, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.409, expert1_balance_bottom=19.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.36, wps=210.1, ups=0.55, wpb=384, bsz=32, num_updates=730, lr=1.37399e-06, gnorm=3.856, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1359
2022-05-08 21:11:49 - progress_bar.py[line:272] - INFO: epoch 001:    742 / 17711 loss=4.032, loss_v1=0, loss_v2=0, nll_loss=1.948, ntokens=377.2, nsentences=32, sample_size=377.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891652, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.342, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.86, wps=208.8, ups=0.55, wpb=377.2, bsz=32, num_updates=740, lr=1.39281e-06, gnorm=3.133, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1377
2022-05-08 21:12:07 - progress_bar.py[line:272] - INFO: epoch 001:    752 / 17711 loss=4.046, loss_v1=0, loss_v2=0, nll_loss=1.989, ntokens=380.9, nsentences=32, sample_size=380.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870743, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=35.148, expert1_balance_bottom=18.814, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.97, wps=212.1, ups=0.56, wpb=380.9, bsz=32, num_updates=750, lr=1.41163e-06, gnorm=3.409, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1395
2022-05-08 21:12:25 - progress_bar.py[line:272] - INFO: epoch 001:    762 / 17711 loss=4.023, loss_v1=0, loss_v2=0, nll_loss=1.934, ntokens=378.7, nsentences=32, sample_size=378.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898191, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.881, expert1_balance_bottom=19.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=209.6, ups=0.55, wpb=378.7, bsz=32, num_updates=760, lr=1.43045e-06, gnorm=3.251, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1413
2022-05-08 21:12:43 - progress_bar.py[line:272] - INFO: epoch 001:    772 / 17711 loss=4.034, loss_v1=0, loss_v2=0, nll_loss=1.966, ntokens=386.5, nsentences=32, sample_size=386.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.761, expert1_balance_bottom=18.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.91, wps=211.6, ups=0.55, wpb=386.5, bsz=32, num_updates=770, lr=1.44928e-06, gnorm=3.371, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1431
2022-05-08 21:13:02 - progress_bar.py[line:272] - INFO: epoch 001:    782 / 17711 loss=3.975, loss_v1=0, loss_v2=0, nll_loss=1.899, ntokens=392.5, nsentences=32, sample_size=392.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87662, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.893, expert1_balance_bottom=18.828, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=215.3, ups=0.55, wpb=392.5, bsz=32, num_updates=780, lr=1.4681e-06, gnorm=3.378, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1450
2022-05-08 21:13:20 - progress_bar.py[line:272] - INFO: epoch 001:    792 / 17711 loss=4.037, loss_v1=0, loss_v2=0, nll_loss=1.964, ntokens=385.9, nsentences=32, sample_size=385.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883554, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.572, expert1_balance_bottom=18.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.9, wps=213.4, ups=0.55, wpb=385.9, bsz=32, num_updates=790, lr=1.48692e-06, gnorm=3.678, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1468
2022-05-08 21:13:38 - progress_bar.py[line:272] - INFO: epoch 001:    802 / 17711 loss=4.092, loss_v1=0, loss_v2=0, nll_loss=2.023, ntokens=382.4, nsentences=32, sample_size=382.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.916, expert1_balance_bottom=18.972, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.06, wps=214.1, ups=0.56, wpb=382.4, bsz=32, num_updates=800, lr=1.50574e-06, gnorm=3.277, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1486
2022-05-08 21:13:56 - progress_bar.py[line:272] - INFO: epoch 001:    812 / 17711 loss=4.056, loss_v1=0, loss_v2=0, nll_loss=1.972, ntokens=377.8, nsentences=32, sample_size=377.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.719, expert1_balance_bottom=19.327, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.92, wps=210.4, ups=0.56, wpb=377.8, bsz=32, num_updates=810, lr=1.52456e-06, gnorm=3.85, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1504
2022-05-08 21:14:14 - progress_bar.py[line:272] - INFO: epoch 001:    822 / 17711 loss=4.086, loss_v1=0, loss_v2=0, nll_loss=2, ntokens=381.5, nsentences=32, sample_size=381.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891438, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.847, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4, wps=211.7, ups=0.55, wpb=381.5, bsz=32, num_updates=820, lr=1.54338e-06, gnorm=3.282, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1522
2022-05-08 21:14:31 - progress_bar.py[line:272] - INFO: epoch 001:    832 / 17711 loss=4.023, loss_v1=0, loss_v2=0, nll_loss=1.951, ntokens=378.4, nsentences=32, sample_size=378.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.683, expert1_balance_bottom=19.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.87, wps=212.7, ups=0.56, wpb=378.4, bsz=32, num_updates=830, lr=1.56221e-06, gnorm=3.196, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1539
2022-05-08 21:14:49 - progress_bar.py[line:272] - INFO: epoch 001:    842 / 17711 loss=4.115, loss_v1=0, loss_v2=0, nll_loss=2.045, ntokens=379.8, nsentences=32, sample_size=379.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885569, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.518, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.13, wps=212.3, ups=0.56, wpb=379.8, bsz=32, num_updates=840, lr=1.58103e-06, gnorm=3.115, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1557
2022-05-08 21:15:07 - progress_bar.py[line:272] - INFO: epoch 001:    852 / 17711 loss=4.12, loss_v1=0, loss_v2=0, nll_loss=2.054, ntokens=389.6, nsentences=32, sample_size=389.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.435, expert1_balance_bottom=18.984, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.15, wps=217.6, ups=0.56, wpb=389.6, bsz=32, num_updates=850, lr=1.59985e-06, gnorm=3.1, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1575
2022-05-08 21:15:25 - progress_bar.py[line:272] - INFO: epoch 001:    862 / 17711 loss=4.14, loss_v1=0, loss_v2=0, nll_loss=2.088, ntokens=375.8, nsentences=32, sample_size=375.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=35.11, expert1_balance_bottom=18.901, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.25, wps=210.8, ups=0.56, wpb=375.8, bsz=32, num_updates=860, lr=1.61867e-06, gnorm=3.356, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1593
2022-05-08 21:15:43 - progress_bar.py[line:272] - INFO: epoch 001:    872 / 17711 loss=4.012, loss_v1=0, loss_v2=0, nll_loss=1.936, ntokens=381.6, nsentences=32, sample_size=381.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.237, expert1_balance_bottom=19.191, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.83, wps=214.1, ups=0.56, wpb=381.6, bsz=32, num_updates=870, lr=1.63749e-06, gnorm=3.144, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1611
2022-05-08 21:16:01 - progress_bar.py[line:272] - INFO: epoch 001:    882 / 17711 loss=4.079, loss_v1=0, loss_v2=0, nll_loss=2.005, ntokens=386.9, nsentences=32, sample_size=386.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889743, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.079, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.01, wps=217.7, ups=0.56, wpb=386.9, bsz=32, num_updates=880, lr=1.65631e-06, gnorm=3.433, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1629
2022-05-08 21:16:19 - progress_bar.py[line:272] - INFO: epoch 001:    892 / 17711 loss=4.057, loss_v1=0, loss_v2=0, nll_loss=1.986, ntokens=374.8, nsentences=32, sample_size=374.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.454, expert1_balance_bottom=19.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.96, wps=208.6, ups=0.56, wpb=374.8, bsz=32, num_updates=890, lr=1.67514e-06, gnorm=3.456, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1647
2022-05-08 21:16:29 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 21:16:38 - progress_bar.py[line:272] - INFO: epoch 001:    903 / 17711 loss=4.058, loss_v1=0, loss_v2=0, nll_loss=1.97, ntokens=377.5, nsentences=32, sample_size=377.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=34.021, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.92, wps=192.5, ups=0.51, wpb=377.5, bsz=32, num_updates=900, lr=1.69396e-06, gnorm=4.375, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1666
2022-05-08 21:16:56 - progress_bar.py[line:272] - INFO: epoch 001:    913 / 17711 loss=4.044, loss_v1=0, loss_v2=0, nll_loss=1.976, ntokens=386.7, nsentences=32, sample_size=386.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880524, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.38, expert1_balance_bottom=19.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.93, wps=218.4, ups=0.56, wpb=386.7, bsz=32, num_updates=910, lr=1.71278e-06, gnorm=3.387, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1684
2022-05-08 21:17:14 - progress_bar.py[line:272] - INFO: epoch 001:    923 / 17711 loss=4.064, loss_v1=0, loss_v2=0, nll_loss=1.994, ntokens=387.3, nsentences=32, sample_size=387.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.641, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.98, wps=215.8, ups=0.56, wpb=387.3, bsz=32, num_updates=920, lr=1.7316e-06, gnorm=3.269, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1702
2022-05-08 21:17:31 - progress_bar.py[line:272] - INFO: epoch 001:    933 / 17711 loss=3.996, loss_v1=0, loss_v2=0, nll_loss=1.924, ntokens=386.9, nsentences=32, sample_size=386.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875024, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.844, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=219.6, ups=0.57, wpb=386.9, bsz=32, num_updates=930, lr=1.75042e-06, gnorm=3.276, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1719
2022-05-08 21:17:50 - progress_bar.py[line:272] - INFO: epoch 001:    943 / 17711 loss=4.077, loss_v1=0, loss_v2=0, nll_loss=1.996, ntokens=384, nsentences=32, sample_size=384, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.943, expert1_balance_bottom=19.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.99, wps=210.1, ups=0.55, wpb=384, bsz=32, num_updates=940, lr=1.76925e-06, gnorm=3.714, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1738
2022-05-08 21:18:08 - progress_bar.py[line:272] - INFO: epoch 001:    953 / 17711 loss=4.027, loss_v1=0, loss_v2=0, nll_loss=1.946, ntokens=381.5, nsentences=32, sample_size=381.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887385, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.016, expert1_balance_bottom=19.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.85, wps=210.1, ups=0.55, wpb=381.5, bsz=32, num_updates=950, lr=1.78807e-06, gnorm=3.408, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1756
2022-05-08 21:18:26 - progress_bar.py[line:272] - INFO: epoch 001:    963 / 17711 loss=4.08, loss_v1=0, loss_v2=0, nll_loss=2.005, ntokens=379.2, nsentences=32, sample_size=379.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887649, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.561, expert1_balance_bottom=19.091, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.01, wps=212, ups=0.56, wpb=379.2, bsz=32, num_updates=960, lr=1.80689e-06, gnorm=3.289, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1774
2022-05-08 21:18:44 - progress_bar.py[line:272] - INFO: epoch 001:    973 / 17711 loss=4.108, loss_v1=0, loss_v2=0, nll_loss=2.031, ntokens=379.4, nsentences=32, sample_size=379.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.989, expert1_balance_bottom=19.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.09, wps=210.2, ups=0.55, wpb=379.4, bsz=32, num_updates=970, lr=1.82571e-06, gnorm=3.207, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1792
2022-05-08 21:19:02 - progress_bar.py[line:272] - INFO: epoch 001:    983 / 17711 loss=4.097, loss_v1=0, loss_v2=0, nll_loss=2.031, ntokens=392.6, nsentences=32, sample_size=392.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877506, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.313, expert1_balance_bottom=19.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.09, wps=219.1, ups=0.56, wpb=392.6, bsz=32, num_updates=980, lr=1.84453e-06, gnorm=3.138, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1810
2022-05-08 21:19:20 - progress_bar.py[line:272] - INFO: epoch 001:    993 / 17711 loss=4.109, loss_v1=0, loss_v2=0, nll_loss=2.048, ntokens=390.6, nsentences=32, sample_size=390.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.626, expert1_balance_bottom=18.991, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.13, wps=217.8, ups=0.56, wpb=390.6, bsz=32, num_updates=990, lr=1.86335e-06, gnorm=3.075, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1828
2022-05-08 21:19:38 - progress_bar.py[line:272] - INFO: epoch 001:   1003 / 17711 loss=4.053, loss_v1=0, loss_v2=0, nll_loss=1.981, ntokens=383.4, nsentences=32, sample_size=383.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884073, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.124, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.95, wps=210.6, ups=0.55, wpb=383.4, bsz=32, num_updates=1000, lr=1.88218e-06, gnorm=3.267, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1846
2022-05-08 21:19:56 - progress_bar.py[line:272] - INFO: epoch 001:   1013 / 17711 loss=3.966, loss_v1=0, loss_v2=0, nll_loss=1.886, ntokens=387.6, nsentences=32, sample_size=387.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.387, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=212.8, ups=0.55, wpb=387.6, bsz=32, num_updates=1010, lr=1.901e-06, gnorm=3.218, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1864
2022-05-08 21:20:14 - progress_bar.py[line:272] - INFO: epoch 001:   1023 / 17711 loss=3.996, loss_v1=0, loss_v2=0, nll_loss=1.916, ntokens=385.7, nsentences=32, sample_size=385.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88349, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.784, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.77, wps=212.2, ups=0.55, wpb=385.7, bsz=32, num_updates=1020, lr=1.91982e-06, gnorm=2.982, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1882
2022-05-08 21:20:32 - progress_bar.py[line:272] - INFO: epoch 001:   1033 / 17711 loss=3.961, loss_v1=0, loss_v2=0, nll_loss=1.872, ntokens=382.6, nsentences=32, sample_size=382.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882497, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.05, expert1_balance_bottom=19.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=212.3, ups=0.55, wpb=382.6, bsz=32, num_updates=1030, lr=1.93864e-06, gnorm=3.364, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1900
2022-05-08 21:20:50 - progress_bar.py[line:272] - INFO: epoch 001:   1043 / 17711 loss=4.076, loss_v1=0, loss_v2=0, nll_loss=1.995, ntokens=377.5, nsentences=32, sample_size=377.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887514, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.137, expert1_balance_bottom=19.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.99, wps=209, ups=0.55, wpb=377.5, bsz=32, num_updates=1040, lr=1.95746e-06, gnorm=3.558, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1918
2022-05-08 21:21:08 - progress_bar.py[line:272] - INFO: epoch 001:   1053 / 17711 loss=3.998, loss_v1=0, loss_v2=0, nll_loss=1.915, ntokens=374.4, nsentences=32, sample_size=374.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.245, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.77, wps=207.3, ups=0.55, wpb=374.4, bsz=32, num_updates=1050, lr=1.97628e-06, gnorm=3.466, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1936
2022-05-08 21:21:26 - progress_bar.py[line:272] - INFO: epoch 001:   1063 / 17711 loss=4.003, loss_v1=0, loss_v2=0, nll_loss=1.923, ntokens=375.6, nsentences=32, sample_size=375.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884631, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.321, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=208.4, ups=0.55, wpb=375.6, bsz=32, num_updates=1060, lr=1.99511e-06, gnorm=3.282, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1954
2022-05-08 21:21:45 - progress_bar.py[line:272] - INFO: epoch 001:   1073 / 17711 loss=4.066, loss_v1=0, loss_v2=0, nll_loss=1.987, ntokens=382.7, nsentences=32, sample_size=382.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.902, expert1_balance_bottom=19.108, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.96, wps=210.9, ups=0.55, wpb=382.7, bsz=32, num_updates=1070, lr=2.01393e-06, gnorm=3.471, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1973
2022-05-08 21:22:03 - progress_bar.py[line:272] - INFO: epoch 001:   1083 / 17711 loss=4.099, loss_v1=0, loss_v2=0, nll_loss=2.009, ntokens=378.9, nsentences=32, sample_size=378.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901349, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.226, expert1_balance_top=33.111, expert1_balance_bottom=19.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.02, wps=208, ups=0.55, wpb=378.9, bsz=32, num_updates=1080, lr=2.03275e-06, gnorm=3.073, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=1991
2022-05-08 21:22:21 - progress_bar.py[line:272] - INFO: epoch 001:   1093 / 17711 loss=4.07, loss_v1=0, loss_v2=0, nll_loss=2, ntokens=383.9, nsentences=32, sample_size=383.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882789, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.063, expert1_balance_bottom=19.199, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4, wps=209, ups=0.54, wpb=383.9, bsz=32, num_updates=1090, lr=2.05157e-06, gnorm=3.709, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2009
2022-05-08 21:22:39 - progress_bar.py[line:272] - INFO: epoch 001:   1103 / 17711 loss=4.053, loss_v1=0, loss_v2=0, nll_loss=1.986, ntokens=380.5, nsentences=32, sample_size=380.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876888, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.576, expert1_balance_bottom=19.023, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.96, wps=212.1, ups=0.56, wpb=380.5, bsz=32, num_updates=1100, lr=2.07039e-06, gnorm=3.337, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2027
2022-05-08 21:22:57 - progress_bar.py[line:272] - INFO: epoch 001:   1113 / 17711 loss=4.04, loss_v1=0, loss_v2=0, nll_loss=1.967, ntokens=381.7, nsentences=32, sample_size=381.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880104, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.442, expert1_balance_bottom=19.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.91, wps=212.8, ups=0.56, wpb=381.7, bsz=32, num_updates=1110, lr=2.08922e-06, gnorm=3.071, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2045
2022-05-08 21:23:15 - progress_bar.py[line:272] - INFO: epoch 001:   1123 / 17711 loss=3.994, loss_v1=0, loss_v2=0, nll_loss=1.915, ntokens=382.4, nsentences=32, sample_size=382.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.573, expert1_balance_bottom=19.07, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.77, wps=215, ups=0.56, wpb=382.4, bsz=32, num_updates=1120, lr=2.10804e-06, gnorm=3.152, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2063
2022-05-08 21:23:33 - progress_bar.py[line:272] - INFO: epoch 001:   1133 / 17711 loss=4.11, loss_v1=0, loss_v2=0, nll_loss=2.022, ntokens=378.6, nsentences=32, sample_size=378.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=33.255, expert1_balance_bottom=19.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.06, wps=209.8, ups=0.55, wpb=378.6, bsz=32, num_updates=1130, lr=2.12686e-06, gnorm=3.367, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2081
2022-05-08 21:23:51 - progress_bar.py[line:272] - INFO: epoch 001:   1143 / 17711 loss=4.055, loss_v1=0, loss_v2=0, nll_loss=1.975, ntokens=392.4, nsentences=32, sample_size=392.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.898, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.93, wps=219.6, ups=0.56, wpb=392.4, bsz=32, num_updates=1140, lr=2.14568e-06, gnorm=3.082, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2099
2022-05-08 21:24:09 - progress_bar.py[line:272] - INFO: epoch 001:   1153 / 17711 loss=4.021, loss_v1=0, loss_v2=0, nll_loss=1.936, ntokens=385, nsentences=32, sample_size=385, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.962, expert1_balance_bottom=19.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.83, wps=210.3, ups=0.55, wpb=385, bsz=32, num_updates=1150, lr=2.1645e-06, gnorm=3.22, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2117
2022-05-08 21:24:27 - progress_bar.py[line:272] - INFO: epoch 001:   1163 / 17711 loss=3.988, loss_v1=0, loss_v2=0, nll_loss=1.928, ntokens=396.4, nsentences=32, sample_size=396.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.861278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=35.568, expert1_balance_bottom=18.619, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=216.8, ups=0.55, wpb=396.4, bsz=32, num_updates=1160, lr=2.18332e-06, gnorm=3.142, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2135
2022-05-08 21:24:45 - progress_bar.py[line:272] - INFO: epoch 001:   1173 / 17711 loss=4.143, loss_v1=0, loss_v2=0, nll_loss=2.074, ntokens=381.1, nsentences=32, sample_size=381.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.157, expert1_balance_bottom=19.123, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.21, wps=212.2, ups=0.56, wpb=381.1, bsz=32, num_updates=1170, lr=2.20215e-06, gnorm=3.183, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2153
2022-05-08 21:25:03 - progress_bar.py[line:272] - INFO: epoch 001:   1183 / 17711 loss=4.026, loss_v1=0, loss_v2=0, nll_loss=1.949, ntokens=388.3, nsentences=32, sample_size=388.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882406, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.582, expert1_balance_bottom=19.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.86, wps=217.4, ups=0.56, wpb=388.3, bsz=32, num_updates=1180, lr=2.22097e-06, gnorm=3.16, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2171
2022-05-08 21:25:21 - progress_bar.py[line:272] - INFO: epoch 001:   1193 / 17711 loss=3.988, loss_v1=0, loss_v2=0, nll_loss=1.905, ntokens=388.7, nsentences=32, sample_size=388.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882872, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.419, expert1_balance_bottom=19.097, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=216.1, ups=0.56, wpb=388.7, bsz=32, num_updates=1190, lr=2.23979e-06, gnorm=3.477, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2189
2022-05-08 21:25:39 - progress_bar.py[line:272] - INFO: epoch 001:   1203 / 17711 loss=4.033, loss_v1=0, loss_v2=0, nll_loss=1.955, ntokens=383.9, nsentences=32, sample_size=383.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.546, expert1_balance_bottom=19.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=213.4, ups=0.56, wpb=383.9, bsz=32, num_updates=1200, lr=2.25861e-06, gnorm=3.156, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2207
2022-05-08 21:25:57 - progress_bar.py[line:272] - INFO: epoch 001:   1213 / 17711 loss=4.075, loss_v1=0, loss_v2=0, nll_loss=2.005, ntokens=378.9, nsentences=32, sample_size=378.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880617, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.469, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.01, wps=210.1, ups=0.55, wpb=378.9, bsz=32, num_updates=1210, lr=2.27743e-06, gnorm=3.238, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2225
2022-05-08 21:26:15 - progress_bar.py[line:272] - INFO: epoch 001:   1223 / 17711 loss=4.024, loss_v1=0, loss_v2=0, nll_loss=1.951, ntokens=386.5, nsentences=32, sample_size=386.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.525, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.87, wps=214.6, ups=0.56, wpb=386.5, bsz=32, num_updates=1220, lr=2.29625e-06, gnorm=3.36, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2243
2022-05-08 21:26:33 - progress_bar.py[line:272] - INFO: epoch 001:   1233 / 17711 loss=4, loss_v1=0, loss_v2=0, nll_loss=1.897, ntokens=371.3, nsentences=32, sample_size=371.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.223, expert1_balance_top=33.223, expert1_balance_bottom=19.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=203.9, ups=0.55, wpb=371.3, bsz=32, num_updates=1230, lr=2.31508e-06, gnorm=3.531, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2261
2022-05-08 21:26:52 - progress_bar.py[line:272] - INFO: epoch 001:   1243 / 17711 loss=4.016, loss_v1=0, loss_v2=0, nll_loss=1.934, ntokens=385.2, nsentences=32, sample_size=385.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.301, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=211.5, ups=0.55, wpb=385.2, bsz=32, num_updates=1240, lr=2.3339e-06, gnorm=3.161, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2280
2022-05-08 21:27:10 - progress_bar.py[line:272] - INFO: epoch 001:   1253 / 17711 loss=4.132, loss_v1=0, loss_v2=0, nll_loss=2.057, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=34.398, expert1_balance_bottom=18.931, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.16, wps=210.4, ups=0.55, wpb=382.5, bsz=32, num_updates=1250, lr=2.35272e-06, gnorm=3.262, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2298
2022-05-08 21:27:28 - progress_bar.py[line:272] - INFO: epoch 001:   1263 / 17711 loss=4.094, loss_v1=0, loss_v2=0, nll_loss=2.024, ntokens=382.7, nsentences=32, sample_size=382.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.368, expert1_balance_bottom=19.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.07, wps=214.5, ups=0.56, wpb=382.7, bsz=32, num_updates=1260, lr=2.37154e-06, gnorm=3.23, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2316
2022-05-08 21:27:46 - progress_bar.py[line:272] - INFO: epoch 001:   1273 / 17711 loss=3.972, loss_v1=0, loss_v2=0, nll_loss=1.888, ntokens=397.9, nsentences=32, sample_size=397.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.189, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=220.6, ups=0.55, wpb=397.9, bsz=32, num_updates=1270, lr=2.39036e-06, gnorm=3.324, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2334
2022-05-08 21:28:04 - progress_bar.py[line:272] - INFO: epoch 001:   1283 / 17711 loss=3.944, loss_v1=0, loss_v2=0, nll_loss=1.853, ntokens=380.3, nsentences=32, sample_size=380.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.502, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.61, wps=208.1, ups=0.55, wpb=380.3, bsz=32, num_updates=1280, lr=2.40919e-06, gnorm=2.93, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2352
2022-05-08 21:28:22 - progress_bar.py[line:272] - INFO: epoch 001:   1293 / 17711 loss=4.057, loss_v1=0, loss_v2=0, nll_loss=1.971, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.126, expert1_balance_bottom=19.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.92, wps=210.3, ups=0.55, wpb=382.5, bsz=32, num_updates=1290, lr=2.42801e-06, gnorm=3.326, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2370
2022-05-08 21:28:41 - progress_bar.py[line:272] - INFO: epoch 001:   1303 / 17711 loss=3.961, loss_v1=0, loss_v2=0, nll_loss=1.869, ntokens=382.6, nsentences=32, sample_size=382.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.027, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.65, wps=206.5, ups=0.54, wpb=382.6, bsz=32, num_updates=1300, lr=2.44683e-06, gnorm=3.474, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2389
2022-05-08 21:28:59 - progress_bar.py[line:272] - INFO: epoch 001:   1313 / 17711 loss=3.985, loss_v1=0, loss_v2=0, nll_loss=1.893, ntokens=379, nsentences=32, sample_size=379, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888517, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.031, expert1_balance_bottom=19.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=205.7, ups=0.54, wpb=379, bsz=32, num_updates=1310, lr=2.46565e-06, gnorm=3.292, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2407
2022-05-08 21:29:17 - progress_bar.py[line:272] - INFO: epoch 001:   1323 / 17711 loss=4.05, loss_v1=0, loss_v2=0, nll_loss=1.975, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.451, expert1_balance_bottom=18.942, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.93, wps=210.5, ups=0.55, wpb=382.5, bsz=32, num_updates=1320, lr=2.48447e-06, gnorm=3.514, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2425
2022-05-08 21:29:36 - progress_bar.py[line:272] - INFO: epoch 001:   1333 / 17711 loss=4.054, loss_v1=0, loss_v2=0, nll_loss=1.962, ntokens=384.6, nsentences=32, sample_size=384.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.324, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.89, wps=209.6, ups=0.54, wpb=384.6, bsz=32, num_updates=1330, lr=2.50329e-06, gnorm=3.199, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2444
2022-05-08 21:29:54 - progress_bar.py[line:272] - INFO: epoch 001:   1343 / 17711 loss=4.013, loss_v1=0, loss_v2=0, nll_loss=1.942, ntokens=382.4, nsentences=32, sample_size=382.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.124, expert1_balance_bottom=18.762, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.84, wps=209.1, ups=0.55, wpb=382.4, bsz=32, num_updates=1340, lr=2.52212e-06, gnorm=3.312, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2462
2022-05-08 21:30:12 - progress_bar.py[line:272] - INFO: epoch 001:   1353 / 17711 loss=4.125, loss_v1=0, loss_v2=0, nll_loss=2.058, ntokens=383.5, nsentences=32, sample_size=383.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881706, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.197, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.17, wps=209.4, ups=0.55, wpb=383.5, bsz=32, num_updates=1350, lr=2.54094e-06, gnorm=3.401, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2480
2022-05-08 21:30:30 - progress_bar.py[line:272] - INFO: epoch 001:   1363 / 17711 loss=4.06, loss_v1=0, loss_v2=0, nll_loss=1.972, ntokens=386.2, nsentences=32, sample_size=386.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890785, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.891, expert1_balance_bottom=19.218, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.92, wps=212.8, ups=0.55, wpb=386.2, bsz=32, num_updates=1360, lr=2.55976e-06, gnorm=3.605, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2498
2022-05-08 21:30:48 - progress_bar.py[line:272] - INFO: epoch 001:   1373 / 17711 loss=4.138, loss_v1=0, loss_v2=0, nll_loss=2.066, ntokens=384.9, nsentences=32, sample_size=384.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882023, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.283, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.19, wps=215.5, ups=0.56, wpb=384.9, bsz=32, num_updates=1370, lr=2.57858e-06, gnorm=3.237, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2516
2022-05-08 21:31:06 - progress_bar.py[line:272] - INFO: epoch 001:   1383 / 17711 loss=4.008, loss_v1=0, loss_v2=0, nll_loss=1.935, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.782, expert1_balance_bottom=18.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=212.4, ups=0.56, wpb=382.5, bsz=32, num_updates=1380, lr=2.5974e-06, gnorm=3.019, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2534
2022-05-08 21:31:24 - progress_bar.py[line:272] - INFO: epoch 001:   1393 / 17711 loss=4.06, loss_v1=0, loss_v2=0, nll_loss=1.984, ntokens=386.1, nsentences=32, sample_size=386.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.27, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.95, wps=215.1, ups=0.56, wpb=386.1, bsz=32, num_updates=1390, lr=2.61622e-06, gnorm=2.864, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2552
2022-05-08 21:31:42 - progress_bar.py[line:272] - INFO: epoch 001:   1403 / 17711 loss=4.107, loss_v1=0, loss_v2=0, nll_loss=2.025, ntokens=380, nsentences=32, sample_size=380, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.911, expert1_balance_bottom=19.226, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.07, wps=208.8, ups=0.55, wpb=380, bsz=32, num_updates=1400, lr=2.63505e-06, gnorm=3.269, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2570
2022-05-08 21:32:01 - progress_bar.py[line:272] - INFO: epoch 001:   1413 / 17711 loss=4.017, loss_v1=0, loss_v2=0, nll_loss=1.93, ntokens=380.7, nsentences=32, sample_size=380.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.958, expert1_balance_bottom=19.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=208.4, ups=0.55, wpb=380.7, bsz=32, num_updates=1410, lr=2.65387e-06, gnorm=3.211, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2589
2022-05-08 21:32:19 - progress_bar.py[line:272] - INFO: epoch 001:   1423 / 17711 loss=4.026, loss_v1=0, loss_v2=0, nll_loss=1.948, ntokens=388.7, nsentences=32, sample_size=388.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.716, expert1_balance_bottom=18.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.86, wps=213.5, ups=0.55, wpb=388.7, bsz=32, num_updates=1420, lr=2.67269e-06, gnorm=2.994, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2607
2022-05-08 21:32:37 - progress_bar.py[line:272] - INFO: epoch 001:   1433 / 17711 loss=4.014, loss_v1=0, loss_v2=0, nll_loss=1.924, ntokens=384.2, nsentences=32, sample_size=384.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.668, expert1_balance_bottom=19.164, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=210.2, ups=0.55, wpb=384.2, bsz=32, num_updates=1430, lr=2.69151e-06, gnorm=3.358, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2625
2022-05-08 21:32:55 - progress_bar.py[line:272] - INFO: epoch 001:   1443 / 17711 loss=3.937, loss_v1=0, loss_v2=0, nll_loss=1.827, ntokens=384.3, nsentences=32, sample_size=384.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898226, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.937, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.221, expert1_balance_top=33.407, expert1_balance_bottom=19.458, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.55, wps=212.2, ups=0.55, wpb=384.3, bsz=32, num_updates=1440, lr=2.71033e-06, gnorm=3.309, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2643
2022-05-08 21:33:14 - progress_bar.py[line:272] - INFO: epoch 001:   1453 / 17711 loss=4.046, loss_v1=0, loss_v2=0, nll_loss=1.97, ntokens=383.8, nsentences=32, sample_size=383.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881038, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.408, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.92, wps=210.3, ups=0.55, wpb=383.8, bsz=32, num_updates=1450, lr=2.72915e-06, gnorm=3.094, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2662
2022-05-08 21:33:32 - progress_bar.py[line:272] - INFO: epoch 001:   1463 / 17711 loss=4.086, loss_v1=0, loss_v2=0, nll_loss=2.023, ntokens=388.9, nsentences=32, sample_size=388.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.855, expert1_balance_bottom=18.773, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.06, wps=211.8, ups=0.54, wpb=388.9, bsz=32, num_updates=1460, lr=2.74798e-06, gnorm=3.387, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2680
2022-05-08 21:33:50 - progress_bar.py[line:272] - INFO: epoch 001:   1473 / 17711 loss=4.058, loss_v1=0, loss_v2=0, nll_loss=1.979, ntokens=378.7, nsentences=32, sample_size=378.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883806, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.118, expert1_balance_bottom=19.173, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=211.2, ups=0.56, wpb=378.7, bsz=32, num_updates=1470, lr=2.7668e-06, gnorm=3.335, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2698
2022-05-08 21:34:08 - progress_bar.py[line:272] - INFO: epoch 001:   1483 / 17711 loss=3.947, loss_v1=0, loss_v2=0, nll_loss=1.852, ntokens=386.6, nsentences=32, sample_size=386.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.984, expert1_balance_bottom=19.056, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.61, wps=213.9, ups=0.55, wpb=386.6, bsz=32, num_updates=1480, lr=2.78562e-06, gnorm=2.871, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2716
2022-05-08 21:34:26 - progress_bar.py[line:272] - INFO: epoch 001:   1493 / 17711 loss=4.032, loss_v1=0, loss_v2=0, nll_loss=1.956, ntokens=374.3, nsentences=32, sample_size=374.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.389, expert1_balance_bottom=18.96, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=206.3, ups=0.55, wpb=374.3, bsz=32, num_updates=1490, lr=2.80444e-06, gnorm=3.228, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2734
2022-05-08 21:34:44 - progress_bar.py[line:272] - INFO: epoch 001:   1503 / 17711 loss=3.998, loss_v1=0, loss_v2=0, nll_loss=1.897, ntokens=381.2, nsentences=32, sample_size=381.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.676, expert1_balance_bottom=19.362, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=207.7, ups=0.54, wpb=381.2, bsz=32, num_updates=1500, lr=2.82326e-06, gnorm=3.278, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2752
2022-05-08 21:35:03 - progress_bar.py[line:272] - INFO: epoch 001:   1513 / 17711 loss=4.007, loss_v1=0, loss_v2=0, nll_loss=1.933, ntokens=383.5, nsentences=32, sample_size=383.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.07, expert1_balance_bottom=18.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=210, ups=0.55, wpb=383.5, bsz=32, num_updates=1510, lr=2.84209e-06, gnorm=3.128, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2771
2022-05-08 21:35:21 - progress_bar.py[line:272] - INFO: epoch 001:   1523 / 17711 loss=4.034, loss_v1=0, loss_v2=0, nll_loss=1.955, ntokens=384.4, nsentences=32, sample_size=384.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.408, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=207.5, ups=0.54, wpb=384.4, bsz=32, num_updates=1520, lr=2.86091e-06, gnorm=3.163, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2789
2022-05-08 21:35:39 - progress_bar.py[line:272] - INFO: epoch 001:   1533 / 17711 loss=4.056, loss_v1=0, loss_v2=0, nll_loss=1.975, ntokens=387.7, nsentences=32, sample_size=387.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.137, expert1_balance_bottom=19.104, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.93, wps=214.2, ups=0.55, wpb=387.7, bsz=32, num_updates=1530, lr=2.87973e-06, gnorm=2.904, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2807
2022-05-08 21:35:57 - progress_bar.py[line:272] - INFO: epoch 001:   1543 / 17711 loss=3.965, loss_v1=0, loss_v2=0, nll_loss=1.879, ntokens=378.4, nsentences=32, sample_size=378.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.765, expert1_balance_bottom=18.84, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=208.1, ups=0.55, wpb=378.4, bsz=32, num_updates=1540, lr=2.89855e-06, gnorm=2.944, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2825
2022-05-08 21:36:16 - progress_bar.py[line:272] - INFO: epoch 001:   1553 / 17711 loss=3.99, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=378.6, nsentences=32, sample_size=378.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.833, expert1_balance_bottom=19.416, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=209.6, ups=0.55, wpb=378.6, bsz=32, num_updates=1550, lr=2.91737e-06, gnorm=2.895, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2844
2022-05-08 21:36:34 - progress_bar.py[line:272] - INFO: epoch 001:   1563 / 17711 loss=4.059, loss_v1=0, loss_v2=0, nll_loss=1.983, ntokens=387.9, nsentences=32, sample_size=387.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.714, expert1_balance_bottom=18.909, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.95, wps=213.6, ups=0.55, wpb=387.9, bsz=32, num_updates=1560, lr=2.93619e-06, gnorm=3.199, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2862
2022-05-08 21:36:52 - progress_bar.py[line:272] - INFO: epoch 001:   1573 / 17711 loss=4.017, loss_v1=0, loss_v2=0, nll_loss=1.941, ntokens=380.3, nsentences=32, sample_size=380.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.006, expert1_balance_bottom=18.863, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.84, wps=212.4, ups=0.56, wpb=380.3, bsz=32, num_updates=1570, lr=2.95502e-06, gnorm=3.134, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2880
2022-05-08 21:37:10 - progress_bar.py[line:272] - INFO: epoch 001:   1583 / 17711 loss=4.055, loss_v1=0, loss_v2=0, nll_loss=1.985, ntokens=387.2, nsentences=32, sample_size=387.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876135, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.835, expert1_balance_bottom=18.821, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.96, wps=214.5, ups=0.55, wpb=387.2, bsz=32, num_updates=1580, lr=2.97384e-06, gnorm=3.312, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2898
2022-05-08 21:37:28 - progress_bar.py[line:272] - INFO: epoch 001:   1593 / 17711 loss=4.011, loss_v1=0, loss_v2=0, nll_loss=1.929, ntokens=379.9, nsentences=32, sample_size=379.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88073, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.556, expert1_balance_bottom=19.067, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=209.7, ups=0.55, wpb=379.9, bsz=32, num_updates=1590, lr=2.99266e-06, gnorm=3.653, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2916
2022-05-08 21:37:46 - progress_bar.py[line:272] - INFO: epoch 001:   1603 / 17711 loss=3.926, loss_v1=0, loss_v2=0, nll_loss=1.829, ntokens=386, nsentences=32, sample_size=386, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884494, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.926, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.177, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.55, wps=212.7, ups=0.55, wpb=386, bsz=32, num_updates=1600, lr=3.01148e-06, gnorm=3.291, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2934
2022-05-08 21:38:04 - progress_bar.py[line:272] - INFO: epoch 001:   1613 / 17711 loss=3.962, loss_v1=0, loss_v2=0, nll_loss=1.854, ntokens=380.7, nsentences=32, sample_size=380.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.458, expert1_balance_bottom=19.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=205.8, ups=0.54, wpb=380.7, bsz=32, num_updates=1610, lr=3.0303e-06, gnorm=3.478, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2952
2022-05-08 21:38:23 - progress_bar.py[line:272] - INFO: epoch 001:   1623 / 17711 loss=4.019, loss_v1=0, loss_v2=0, nll_loss=1.93, ntokens=384.6, nsentences=32, sample_size=384.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883675, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.644, expert1_balance_bottom=19.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=209.8, ups=0.55, wpb=384.6, bsz=32, num_updates=1620, lr=3.04912e-06, gnorm=3.589, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2971
2022-05-08 21:38:41 - progress_bar.py[line:272] - INFO: epoch 001:   1633 / 17711 loss=3.986, loss_v1=0, loss_v2=0, nll_loss=1.898, ntokens=380.5, nsentences=32, sample_size=380.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.835, expert1_balance_bottom=18.822, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=208.9, ups=0.55, wpb=380.5, bsz=32, num_updates=1630, lr=3.06795e-06, gnorm=3.027, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=2989
2022-05-08 21:38:59 - progress_bar.py[line:272] - INFO: epoch 001:   1643 / 17711 loss=4.041, loss_v1=0, loss_v2=0, nll_loss=1.97, ntokens=379, nsentences=32, sample_size=379, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=35.257, expert1_balance_bottom=18.876, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.92, wps=209.7, ups=0.55, wpb=379, bsz=32, num_updates=1640, lr=3.08677e-06, gnorm=3.004, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3007
2022-05-08 21:39:17 - progress_bar.py[line:272] - INFO: epoch 001:   1653 / 17711 loss=4.088, loss_v1=0, loss_v2=0, nll_loss=2.006, ntokens=378.1, nsentences=32, sample_size=378.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884269, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.31, expert1_balance_bottom=19.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.02, wps=208.4, ups=0.55, wpb=378.1, bsz=32, num_updates=1650, lr=3.10559e-06, gnorm=3.299, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3025
2022-05-08 21:39:35 - progress_bar.py[line:272] - INFO: epoch 001:   1663 / 17711 loss=4.083, loss_v1=0, loss_v2=0, nll_loss=2.018, ntokens=386.8, nsentences=32, sample_size=386.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.382, expert1_balance_bottom=18.74, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.05, wps=212.6, ups=0.55, wpb=386.8, bsz=32, num_updates=1660, lr=3.12441e-06, gnorm=3.161, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3043
2022-05-08 21:39:53 - progress_bar.py[line:272] - INFO: epoch 001:   1673 / 17711 loss=4.044, loss_v1=0, loss_v2=0, nll_loss=1.966, ntokens=382.5, nsentences=32, sample_size=382.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.467, expert1_balance_bottom=18.923, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.91, wps=213.3, ups=0.56, wpb=382.5, bsz=32, num_updates=1670, lr=3.14323e-06, gnorm=3.837, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3061
2022-05-08 21:39:57 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-08 21:40:13 - progress_bar.py[line:272] - INFO: epoch 001:   1684 / 17711 loss=3.924, loss_v1=0, loss_v2=0, nll_loss=1.824, ntokens=387.3, nsentences=32, sample_size=387.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886366, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.924, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.087, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.54, wps=192.3, ups=0.5, wpb=387.3, bsz=32, num_updates=1680, lr=3.16206e-06, gnorm=3.343, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3081
2022-05-08 21:40:32 - progress_bar.py[line:272] - INFO: epoch 001:   1694 / 17711 loss=3.985, loss_v1=0, loss_v2=0, nll_loss=1.901, ntokens=387.6, nsentences=32, sample_size=387.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878508, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.697, expert1_balance_bottom=18.928, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=203.8, ups=0.53, wpb=387.6, bsz=32, num_updates=1690, lr=3.18088e-06, gnorm=3.418, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3100
2022-05-08 21:40:50 - progress_bar.py[line:272] - INFO: epoch 001:   1704 / 17711 loss=4.012, loss_v1=0, loss_v2=0, nll_loss=1.923, ntokens=382.3, nsentences=32, sample_size=382.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.905, expert1_balance_bottom=19.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=213.1, ups=0.56, wpb=382.3, bsz=32, num_updates=1700, lr=3.1997e-06, gnorm=3.171, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3118
2022-05-08 21:41:09 - progress_bar.py[line:272] - INFO: epoch 001:   1714 / 17711 loss=4.07, loss_v1=0, loss_v2=0, nll_loss=1.986, ntokens=385.1, nsentences=32, sample_size=385.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883728, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.275, expert1_balance_bottom=19.077, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.96, wps=208.3, ups=0.54, wpb=385.1, bsz=32, num_updates=1710, lr=3.21852e-06, gnorm=3.482, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3137
2022-05-08 21:41:27 - progress_bar.py[line:272] - INFO: epoch 001:   1724 / 17711 loss=3.992, loss_v1=0, loss_v2=0, nll_loss=1.902, ntokens=383.3, nsentences=32, sample_size=383.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883512, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.253, expert1_balance_bottom=19.186, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=211.3, ups=0.55, wpb=383.3, bsz=32, num_updates=1720, lr=3.23734e-06, gnorm=2.984, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3155
2022-05-08 21:41:45 - progress_bar.py[line:272] - INFO: epoch 001:   1734 / 17711 loss=4.085, loss_v1=0, loss_v2=0, nll_loss=2.001, ntokens=388.4, nsentences=32, sample_size=388.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888421, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.836, expert1_balance_bottom=19.144, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4, wps=212.5, ups=0.55, wpb=388.4, bsz=32, num_updates=1730, lr=3.25616e-06, gnorm=3.874, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3173
2022-05-08 21:42:04 - progress_bar.py[line:272] - INFO: epoch 001:   1744 / 17711 loss=4.019, loss_v1=0, loss_v2=0, nll_loss=1.937, ntokens=383.3, nsentences=32, sample_size=383.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.61, expert1_balance_bottom=18.895, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.83, wps=209.8, ups=0.55, wpb=383.3, bsz=32, num_updates=1740, lr=3.27499e-06, gnorm=3.041, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3192
2022-05-08 21:42:22 - progress_bar.py[line:272] - INFO: epoch 001:   1754 / 17711 loss=3.976, loss_v1=0, loss_v2=0, nll_loss=1.882, ntokens=383.6, nsentences=32, sample_size=383.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884641, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.526, expert1_balance_bottom=18.97, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=210.1, ups=0.55, wpb=383.6, bsz=32, num_updates=1750, lr=3.29381e-06, gnorm=3.87, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3210
2022-05-08 21:42:40 - progress_bar.py[line:272] - INFO: epoch 001:   1764 / 17711 loss=4.01, loss_v1=0, loss_v2=0, nll_loss=1.927, ntokens=384.3, nsentences=32, sample_size=384.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882678, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.993, expert1_balance_bottom=18.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=209.8, ups=0.55, wpb=384.3, bsz=32, num_updates=1760, lr=3.31263e-06, gnorm=3.118, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3228
2022-05-08 21:42:58 - progress_bar.py[line:272] - INFO: epoch 001:   1774 / 17711 loss=4.073, loss_v1=0, loss_v2=0, nll_loss=1.991, ntokens=374.8, nsentences=32, sample_size=374.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.533, expert1_balance_bottom=18.986, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.97, wps=206.8, ups=0.55, wpb=374.8, bsz=32, num_updates=1770, lr=3.33145e-06, gnorm=3.335, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3246
2022-05-08 21:43:16 - progress_bar.py[line:272] - INFO: epoch 001:   1784 / 17711 loss=4.058, loss_v1=0, loss_v2=0, nll_loss=1.964, ntokens=380, nsentences=32, sample_size=380, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.222, expert1_balance_top=33.509, expert1_balance_bottom=19.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.9, wps=209.8, ups=0.55, wpb=380, bsz=32, num_updates=1780, lr=3.35027e-06, gnorm=3.329, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3264
2022-05-08 21:43:35 - progress_bar.py[line:272] - INFO: epoch 001:   1794 / 17711 loss=4.003, loss_v1=0, loss_v2=0, nll_loss=1.913, ntokens=382.8, nsentences=32, sample_size=382.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883662, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.378, expert1_balance_bottom=19.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.77, wps=208.1, ups=0.54, wpb=382.8, bsz=32, num_updates=1790, lr=3.36909e-06, gnorm=3.253, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3283
2022-05-08 21:43:53 - progress_bar.py[line:272] - INFO: epoch 001:   1804 / 17711 loss=3.975, loss_v1=0, loss_v2=0, nll_loss=1.884, ntokens=385.9, nsentences=32, sample_size=385.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883196, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.263, expert1_balance_bottom=19.113, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=210.1, ups=0.54, wpb=385.9, bsz=32, num_updates=1800, lr=3.38792e-06, gnorm=3.042, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3301
2022-05-08 21:44:11 - progress_bar.py[line:272] - INFO: epoch 001:   1814 / 17711 loss=4.041, loss_v1=0, loss_v2=0, nll_loss=1.952, ntokens=384.1, nsentences=32, sample_size=384.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.301, expert1_balance_bottom=19.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.87, wps=210.4, ups=0.55, wpb=384.1, bsz=32, num_updates=1810, lr=3.40674e-06, gnorm=3.374, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3319
2022-05-08 21:44:30 - progress_bar.py[line:272] - INFO: epoch 001:   1824 / 17711 loss=3.989, loss_v1=0, loss_v2=0, nll_loss=1.908, ntokens=391.1, nsentences=32, sample_size=391.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.708, expert1_balance_bottom=19.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=213.6, ups=0.55, wpb=391.1, bsz=32, num_updates=1820, lr=3.42556e-06, gnorm=2.977, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3338
2022-05-08 21:44:48 - progress_bar.py[line:272] - INFO: epoch 001:   1834 / 17711 loss=4.004, loss_v1=0, loss_v2=0, nll_loss=1.916, ntokens=381.7, nsentences=32, sample_size=381.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.126, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.77, wps=210, ups=0.55, wpb=381.7, bsz=32, num_updates=1830, lr=3.44438e-06, gnorm=3.52, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3356
2022-05-08 21:45:06 - progress_bar.py[line:272] - INFO: epoch 001:   1844 / 17711 loss=4.04, loss_v1=0, loss_v2=0, nll_loss=1.962, ntokens=377.8, nsentences=32, sample_size=377.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.918, expert1_balance_bottom=18.866, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.9, wps=209.1, ups=0.55, wpb=377.8, bsz=32, num_updates=1840, lr=3.4632e-06, gnorm=3.209, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3374
2022-05-08 21:45:24 - progress_bar.py[line:272] - INFO: epoch 001:   1854 / 17711 loss=3.979, loss_v1=0, loss_v2=0, nll_loss=1.888, ntokens=387.1, nsentences=32, sample_size=387.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.421, expert1_balance_bottom=19.014, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=209.3, ups=0.54, wpb=387.1, bsz=32, num_updates=1850, lr=3.48203e-06, gnorm=3.03, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3392
2022-05-08 21:45:43 - progress_bar.py[line:272] - INFO: epoch 001:   1864 / 17711 loss=4.14, loss_v1=0, loss_v2=0, nll_loss=2.062, ntokens=393.1, nsentences=32, sample_size=393.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885388, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.144, expert1_balance_bottom=19.068, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.17, wps=217.7, ups=0.55, wpb=393.1, bsz=32, num_updates=1860, lr=3.50085e-06, gnorm=3.19, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3411
2022-05-08 21:46:01 - progress_bar.py[line:272] - INFO: epoch 001:   1874 / 17711 loss=3.958, loss_v1=0, loss_v2=0, nll_loss=1.855, ntokens=371.8, nsentences=32, sample_size=371.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=34.233, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=205.2, ups=0.55, wpb=371.8, bsz=32, num_updates=1870, lr=3.51967e-06, gnorm=3.132, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3429
2022-05-08 21:46:19 - progress_bar.py[line:272] - INFO: epoch 001:   1884 / 17711 loss=4.026, loss_v1=0, loss_v2=0, nll_loss=1.944, ntokens=382.8, nsentences=32, sample_size=382.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.763, expert1_balance_bottom=18.938, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.85, wps=212.9, ups=0.56, wpb=382.8, bsz=32, num_updates=1880, lr=3.53849e-06, gnorm=3.393, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3447
2022-05-08 21:46:36 - progress_bar.py[line:272] - INFO: epoch 001:   1894 / 17711 loss=3.975, loss_v1=0, loss_v2=0, nll_loss=1.88, ntokens=384.3, nsentences=32, sample_size=384.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.158, expert1_balance_bottom=19.231, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=215.5, ups=0.56, wpb=384.3, bsz=32, num_updates=1890, lr=3.55731e-06, gnorm=3.35, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3464
2022-05-08 21:46:55 - progress_bar.py[line:272] - INFO: epoch 001:   1904 / 17711 loss=4.031, loss_v1=0, loss_v2=0, nll_loss=1.952, ntokens=396, nsentences=32, sample_size=396, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.966, expert1_balance_bottom=18.829, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.87, wps=216.8, ups=0.55, wpb=396, bsz=32, num_updates=1900, lr=3.57613e-06, gnorm=3.337, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3483
2022-05-08 21:47:13 - progress_bar.py[line:272] - INFO: epoch 001:   1914 / 17711 loss=4.001, loss_v1=0, loss_v2=0, nll_loss=1.925, ntokens=384.5, nsentences=32, sample_size=384.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866622, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=35.609, expert1_balance_bottom=18.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=214.4, ups=0.56, wpb=384.5, bsz=32, num_updates=1910, lr=3.59496e-06, gnorm=3.011, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3501
2022-05-08 21:47:31 - progress_bar.py[line:272] - INFO: epoch 001:   1924 / 17711 loss=3.969, loss_v1=0, loss_v2=0, nll_loss=1.879, ntokens=378.2, nsentences=32, sample_size=378.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.672, expert1_balance_bottom=18.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=205.7, ups=0.54, wpb=378.2, bsz=32, num_updates=1920, lr=3.61378e-06, gnorm=3.564, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3519
2022-05-08 21:47:49 - progress_bar.py[line:272] - INFO: epoch 001:   1934 / 17711 loss=3.947, loss_v1=0, loss_v2=0, nll_loss=1.854, ntokens=382, nsentences=32, sample_size=382, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.556, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.61, wps=208.9, ups=0.55, wpb=382, bsz=32, num_updates=1930, lr=3.6326e-06, gnorm=3.129, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3537
2022-05-08 21:48:07 - progress_bar.py[line:272] - INFO: epoch 001:   1944 / 17711 loss=4.033, loss_v1=0, loss_v2=0, nll_loss=1.934, ntokens=372.6, nsentences=32, sample_size=372.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891898, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.684, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=208.3, ups=0.56, wpb=372.6, bsz=32, num_updates=1940, lr=3.65142e-06, gnorm=3.144, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3555
2022-05-08 21:48:26 - progress_bar.py[line:272] - INFO: epoch 001:   1954 / 17711 loss=4.056, loss_v1=0, loss_v2=0, nll_loss=1.976, ntokens=389.8, nsentences=32, sample_size=389.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878483, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.932, expert1_balance_bottom=18.802, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=211.8, ups=0.54, wpb=389.8, bsz=32, num_updates=1950, lr=3.67024e-06, gnorm=3.084, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3574
2022-05-08 21:48:43 - progress_bar.py[line:272] - INFO: epoch 001:   1964 / 17711 loss=4.009, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=373.4, nsentences=32, sample_size=373.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.4, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=208.9, ups=0.56, wpb=373.4, bsz=32, num_updates=1960, lr=3.68906e-06, gnorm=3.19, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3592
2022-05-08 21:49:01 - progress_bar.py[line:272] - INFO: epoch 001:   1974 / 17711 loss=3.998, loss_v1=0, loss_v2=0, nll_loss=1.904, ntokens=380.4, nsentences=32, sample_size=380.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.08, expert1_balance_bottom=19.162, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=211.3, ups=0.56, wpb=380.4, bsz=32, num_updates=1970, lr=3.70789e-06, gnorm=3.672, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3610
2022-05-08 21:49:20 - progress_bar.py[line:272] - INFO: epoch 001:   1984 / 17711 loss=4.046, loss_v1=0, loss_v2=0, nll_loss=1.96, ntokens=380.3, nsentences=32, sample_size=380.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887856, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.049, expert1_balance_bottom=19.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.89, wps=207.1, ups=0.54, wpb=380.3, bsz=32, num_updates=1980, lr=3.72671e-06, gnorm=3.097, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3628
2022-05-08 21:49:38 - progress_bar.py[line:272] - INFO: epoch 001:   1994 / 17711 loss=3.974, loss_v1=0, loss_v2=0, nll_loss=1.871, ntokens=384.5, nsentences=32, sample_size=384.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893535, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.022, expert1_balance_bottom=19.24, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=209.7, ups=0.55, wpb=384.5, bsz=32, num_updates=1990, lr=3.74553e-06, gnorm=3.199, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3646
2022-05-08 21:49:56 - progress_bar.py[line:272] - INFO: epoch 001:   2004 / 17711 loss=4.017, loss_v1=0, loss_v2=0, nll_loss=1.932, ntokens=389.9, nsentences=32, sample_size=389.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.724, expert1_balance_bottom=18.867, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=215.3, ups=0.55, wpb=389.9, bsz=32, num_updates=2000, lr=3.76435e-06, gnorm=3.54, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=3664
2022-05-08 21:49:56 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 21:49:56 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 21:49:56 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 21:58:03 - train.py[line:517] - INFO: valid_step finished
2022-05-08 21:58:03 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 8.735 | loss_v1 0 | loss_v2 0 | nll_loss 6.993 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.970459 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 8.735 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.26 | expert1_balance_top 35.944 | expert1_balance_bottom 14.963 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 127.37 | cider 1.159 | wps 620.9 | wpb 481.7 | bsz 8 | num_updates 2000
2022-05-08 21:58:21 - progress_bar.py[line:272] - INFO: epoch 001:   2014 / 17711 loss=3.983, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=392.9, nsentences=32, sample_size=392.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876806, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=35.057, expert1_balance_bottom=18.882, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=7.8, ups=0.02, wpb=392.9, bsz=32, num_updates=2010, lr=3.78317e-06, gnorm=3.323, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4169
2022-05-08 21:58:40 - progress_bar.py[line:272] - INFO: epoch 001:   2024 / 17711 loss=3.982, loss_v1=0, loss_v2=0, nll_loss=1.878, ntokens=376.8, nsentences=32, sample_size=376.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892995, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.131, expert1_balance_bottom=18.97, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=206.9, ups=0.55, wpb=376.8, bsz=32, num_updates=2020, lr=3.802e-06, gnorm=3.046, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4188
2022-05-08 21:58:58 - progress_bar.py[line:272] - INFO: epoch 001:   2034 / 17711 loss=4.061, loss_v1=0, loss_v2=0, nll_loss=1.979, ntokens=379.9, nsentences=32, sample_size=379.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879596, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.511, expert1_balance_bottom=19.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=208.7, ups=0.55, wpb=379.9, bsz=32, num_updates=2030, lr=3.82082e-06, gnorm=3.661, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4206
2022-05-08 21:59:16 - progress_bar.py[line:272] - INFO: epoch 001:   2044 / 17711 loss=4.203, loss_v1=0, loss_v2=0, nll_loss=2.138, ntokens=383.8, nsentences=32, sample_size=383.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.203, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.861, expert1_balance_bottom=18.728, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.4, wps=214.5, ups=0.56, wpb=383.8, bsz=32, num_updates=2040, lr=3.83964e-06, gnorm=3.564, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4224
2022-05-08 21:59:34 - progress_bar.py[line:272] - INFO: epoch 001:   2054 / 17711 loss=4.062, loss_v1=0, loss_v2=0, nll_loss=1.973, ntokens=384.5, nsentences=32, sample_size=384.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894268, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.773, expert1_balance_bottom=19.268, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.93, wps=211.2, ups=0.55, wpb=384.5, bsz=32, num_updates=2050, lr=3.85846e-06, gnorm=2.924, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4242
2022-05-08 21:59:52 - progress_bar.py[line:272] - INFO: epoch 001:   2064 / 17711 loss=4.016, loss_v1=0, loss_v2=0, nll_loss=1.932, ntokens=390.2, nsentences=32, sample_size=390.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883797, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.678, expert1_balance_bottom=18.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=213.1, ups=0.55, wpb=390.2, bsz=32, num_updates=2060, lr=3.87728e-06, gnorm=2.896, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4260
2022-05-08 22:00:10 - progress_bar.py[line:272] - INFO: epoch 001:   2074 / 17711 loss=3.995, loss_v1=0, loss_v2=0, nll_loss=1.896, ntokens=379.1, nsentences=32, sample_size=379.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895232, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.492, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=207.8, ups=0.55, wpb=379.1, bsz=32, num_updates=2070, lr=3.8961e-06, gnorm=3.679, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4278
2022-05-08 22:00:28 - progress_bar.py[line:272] - INFO: epoch 001:   2084 / 17711 loss=4.031, loss_v1=0, loss_v2=0, nll_loss=1.937, ntokens=379.3, nsentences=32, sample_size=379.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.868, expert1_balance_bottom=19.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.83, wps=210.2, ups=0.55, wpb=379.3, bsz=32, num_updates=2080, lr=3.91493e-06, gnorm=3.142, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4297
2022-05-08 22:00:48 - progress_bar.py[line:272] - INFO: epoch 001:   2094 / 17711 loss=4.058, loss_v1=0, loss_v2=0, nll_loss=1.984, ntokens=395.3, nsentences=32, sample_size=395.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.615, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.96, wps=207.9, ups=0.53, wpb=395.3, bsz=32, num_updates=2090, lr=3.93375e-06, gnorm=3.57, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4316
2022-05-08 22:01:05 - progress_bar.py[line:272] - INFO: epoch 001:   2104 / 17711 loss=4.134, loss_v1=0, loss_v2=0, nll_loss=2.052, ntokens=393.4, nsentences=32, sample_size=393.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=34.04, expert1_balance_bottom=19.219, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.15, wps=219.7, ups=0.56, wpb=393.4, bsz=32, num_updates=2100, lr=3.95257e-06, gnorm=3.933, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4333
2022-05-08 22:01:23 - progress_bar.py[line:272] - INFO: epoch 001:   2114 / 17711 loss=3.986, loss_v1=0, loss_v2=0, nll_loss=1.895, ntokens=379.6, nsentences=32, sample_size=379.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884402, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.948, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=214.9, ups=0.57, wpb=379.6, bsz=32, num_updates=2110, lr=3.97139e-06, gnorm=3.156, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4351
2022-05-08 22:01:41 - progress_bar.py[line:272] - INFO: epoch 001:   2124 / 17711 loss=4.075, loss_v1=0, loss_v2=0, nll_loss=1.989, ntokens=378.4, nsentences=32, sample_size=378.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888563, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=34.182, expert1_balance_bottom=19.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.97, wps=205.4, ups=0.54, wpb=378.4, bsz=32, num_updates=2120, lr=3.99021e-06, gnorm=3.235, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4370
2022-05-08 22:02:00 - progress_bar.py[line:272] - INFO: epoch 001:   2134 / 17711 loss=3.929, loss_v1=0, loss_v2=0, nll_loss=1.825, ntokens=387.5, nsentences=32, sample_size=387.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.929, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.128, expert1_balance_bottom=19.044, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.54, wps=212.8, ups=0.55, wpb=387.5, bsz=32, num_updates=2130, lr=4.00903e-06, gnorm=3.359, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4388
2022-05-08 22:02:18 - progress_bar.py[line:272] - INFO: epoch 001:   2144 / 17711 loss=3.998, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=382.1, nsentences=32, sample_size=382.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.773, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=209.6, ups=0.55, wpb=382.1, bsz=32, num_updates=2140, lr=4.02786e-06, gnorm=3.209, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4406
2022-05-08 22:02:36 - progress_bar.py[line:272] - INFO: epoch 001:   2154 / 17711 loss=4.087, loss_v1=0, loss_v2=0, nll_loss=2.008, ntokens=381.6, nsentences=32, sample_size=381.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.214, expert1_balance_bottom=19.253, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.02, wps=207.5, ups=0.54, wpb=381.6, bsz=32, num_updates=2150, lr=4.04668e-06, gnorm=3.463, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4424
2022-05-08 22:02:55 - progress_bar.py[line:272] - INFO: epoch 001:   2164 / 17711 loss=3.983, loss_v1=0, loss_v2=0, nll_loss=1.873, ntokens=376.1, nsentences=32, sample_size=376.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.219, expert1_balance_top=33.204, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=204.5, ups=0.54, wpb=376.1, bsz=32, num_updates=2160, lr=4.0655e-06, gnorm=4.153, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4443
2022-05-08 22:03:13 - progress_bar.py[line:272] - INFO: epoch 001:   2174 / 17711 loss=4.003, loss_v1=0, loss_v2=0, nll_loss=1.902, ntokens=374.7, nsentences=32, sample_size=374.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893611, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=34.203, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=203.2, ups=0.54, wpb=374.7, bsz=32, num_updates=2170, lr=4.08432e-06, gnorm=3.139, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4461
2022-05-08 22:03:32 - progress_bar.py[line:272] - INFO: epoch 001:   2184 / 17711 loss=4.025, loss_v1=0, loss_v2=0, nll_loss=1.945, ntokens=378, nsentences=32, sample_size=378, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877079, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.465, expert1_balance_bottom=19.053, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.85, wps=206, ups=0.54, wpb=378, bsz=32, num_updates=2180, lr=4.10314e-06, gnorm=3.175, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4480
2022-05-08 22:03:50 - progress_bar.py[line:272] - INFO: epoch 001:   2194 / 17711 loss=3.989, loss_v1=0, loss_v2=0, nll_loss=1.903, ntokens=388.2, nsentences=32, sample_size=388.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.459, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=210.6, ups=0.54, wpb=388.2, bsz=32, num_updates=2190, lr=4.12196e-06, gnorm=2.842, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4498
2022-05-08 22:04:08 - progress_bar.py[line:272] - INFO: epoch 001:   2204 / 17711 loss=3.988, loss_v1=0, loss_v2=0, nll_loss=1.881, ntokens=383.3, nsentences=32, sample_size=383.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.464, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=210.9, ups=0.55, wpb=383.3, bsz=32, num_updates=2200, lr=4.14079e-06, gnorm=3.285, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4516
2022-05-08 22:04:26 - progress_bar.py[line:272] - INFO: epoch 001:   2214 / 17711 loss=4.055, loss_v1=0, loss_v2=0, nll_loss=1.954, ntokens=383, nsentences=32, sample_size=383, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.22, expert1_balance_top=33.479, expert1_balance_bottom=19.302, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.87, wps=209, ups=0.55, wpb=383, bsz=32, num_updates=2210, lr=4.15961e-06, gnorm=5.345, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4534
2022-05-08 22:04:45 - progress_bar.py[line:272] - INFO: epoch 001:   2224 / 17711 loss=3.967, loss_v1=0, loss_v2=0, nll_loss=1.864, ntokens=379.6, nsentences=32, sample_size=379.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.852, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=208.9, ups=0.55, wpb=379.6, bsz=32, num_updates=2220, lr=4.17843e-06, gnorm=3.03, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4553
2022-05-08 22:05:03 - progress_bar.py[line:272] - INFO: epoch 001:   2234 / 17711 loss=3.944, loss_v1=0, loss_v2=0, nll_loss=1.857, ntokens=389.5, nsentences=32, sample_size=389.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.597, expert1_balance_bottom=18.988, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=208.3, ups=0.53, wpb=389.5, bsz=32, num_updates=2230, lr=4.19725e-06, gnorm=3.209, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4571
2022-05-08 22:05:21 - progress_bar.py[line:272] - INFO: epoch 001:   2244 / 17711 loss=3.96, loss_v1=0, loss_v2=0, nll_loss=1.866, ntokens=380.9, nsentences=32, sample_size=380.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.129, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.65, wps=210.7, ups=0.55, wpb=380.9, bsz=32, num_updates=2240, lr=4.21607e-06, gnorm=3.339, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4589
2022-05-08 22:05:39 - progress_bar.py[line:272] - INFO: epoch 001:   2254 / 17711 loss=4.099, loss_v1=0, loss_v2=0, nll_loss=2.017, ntokens=379.2, nsentences=32, sample_size=379.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.217, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.05, wps=211.1, ups=0.56, wpb=379.2, bsz=32, num_updates=2250, lr=4.2349e-06, gnorm=3.307, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4607
2022-05-08 22:05:57 - progress_bar.py[line:272] - INFO: epoch 001:   2264 / 17711 loss=4.007, loss_v1=0, loss_v2=0, nll_loss=1.907, ntokens=380.9, nsentences=32, sample_size=380.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894581, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=34.071, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=211.9, ups=0.56, wpb=380.9, bsz=32, num_updates=2260, lr=4.25372e-06, gnorm=3.057, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4625
2022-05-08 22:06:15 - progress_bar.py[line:272] - INFO: epoch 001:   2274 / 17711 loss=4.01, loss_v1=0, loss_v2=0, nll_loss=1.926, ntokens=377.9, nsentences=32, sample_size=377.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880067, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.563, expert1_balance_bottom=18.998, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=208.4, ups=0.55, wpb=377.9, bsz=32, num_updates=2270, lr=4.27254e-06, gnorm=3.333, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4644
2022-05-08 22:06:33 - progress_bar.py[line:272] - INFO: epoch 001:   2284 / 17711 loss=4.04, loss_v1=0, loss_v2=0, nll_loss=1.95, ntokens=380, nsentences=32, sample_size=380, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888131, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.223, expert1_balance_bottom=19.001, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.86, wps=210.7, ups=0.55, wpb=380, bsz=32, num_updates=2280, lr=4.29136e-06, gnorm=3.388, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4662
2022-05-08 22:06:52 - progress_bar.py[line:272] - INFO: epoch 001:   2294 / 17711 loss=3.978, loss_v1=0, loss_v2=0, nll_loss=1.88, ntokens=389.8, nsentences=32, sample_size=389.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.13, expert1_balance_bottom=19.071, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=213.2, ups=0.55, wpb=389.8, bsz=32, num_updates=2290, lr=4.31018e-06, gnorm=2.946, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4680
2022-05-08 22:07:10 - progress_bar.py[line:272] - INFO: epoch 001:   2304 / 17711 loss=3.977, loss_v1=0, loss_v2=0, nll_loss=1.892, ntokens=381.4, nsentences=32, sample_size=381.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873873, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.936, expert1_balance_bottom=18.868, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=210.3, ups=0.55, wpb=381.4, bsz=32, num_updates=2300, lr=4.329e-06, gnorm=3.525, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4698
2022-05-08 22:07:28 - progress_bar.py[line:272] - INFO: epoch 001:   2314 / 17711 loss=3.953, loss_v1=0, loss_v2=0, nll_loss=1.859, ntokens=392.3, nsentences=32, sample_size=392.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878771, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.681, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=214.5, ups=0.55, wpb=392.3, bsz=32, num_updates=2310, lr=4.34783e-06, gnorm=3.077, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4716
2022-05-08 22:07:46 - progress_bar.py[line:272] - INFO: epoch 001:   2324 / 17711 loss=4.004, loss_v1=0, loss_v2=0, nll_loss=1.935, ntokens=387.2, nsentences=32, sample_size=387.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866734, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.247, expert1_balance_bottom=18.799, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=213, ups=0.55, wpb=387.2, bsz=32, num_updates=2320, lr=4.36665e-06, gnorm=3.123, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4734
2022-05-08 22:08:05 - progress_bar.py[line:272] - INFO: epoch 001:   2334 / 17711 loss=4.062, loss_v1=0, loss_v2=0, nll_loss=1.971, ntokens=383.8, nsentences=32, sample_size=383.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888102, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.009, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.92, wps=208.9, ups=0.54, wpb=383.8, bsz=32, num_updates=2330, lr=4.38547e-06, gnorm=3.703, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4753
2022-05-08 22:08:23 - progress_bar.py[line:272] - INFO: epoch 001:   2344 / 17711 loss=3.999, loss_v1=0, loss_v2=0, nll_loss=1.908, ntokens=384.3, nsentences=32, sample_size=384.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.304, expert1_balance_bottom=18.976, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=209.4, ups=0.54, wpb=384.3, bsz=32, num_updates=2340, lr=4.40429e-06, gnorm=3.002, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4771
2022-05-08 22:08:41 - progress_bar.py[line:272] - INFO: epoch 001:   2354 / 17711 loss=3.981, loss_v1=0, loss_v2=0, nll_loss=1.915, ntokens=397.6, nsentences=32, sample_size=397.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.85844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=36.16, expert1_balance_bottom=18.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.77, wps=218.9, ups=0.55, wpb=397.6, bsz=32, num_updates=2350, lr=4.42311e-06, gnorm=2.942, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4789
2022-05-08 22:08:59 - progress_bar.py[line:272] - INFO: epoch 001:   2364 / 17711 loss=4.02, loss_v1=0, loss_v2=0, nll_loss=1.928, ntokens=384.7, nsentences=32, sample_size=384.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.977, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=212.4, ups=0.55, wpb=384.7, bsz=32, num_updates=2360, lr=4.44193e-06, gnorm=3.001, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4807
2022-05-08 22:09:17 - progress_bar.py[line:272] - INFO: epoch 001:   2374 / 17711 loss=3.999, loss_v1=0, loss_v2=0, nll_loss=1.898, ntokens=373.2, nsentences=32, sample_size=373.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.218, expert1_balance_top=33.788, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=206.4, ups=0.55, wpb=373.2, bsz=32, num_updates=2370, lr=4.46076e-06, gnorm=3.066, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4826
2022-05-08 22:09:36 - progress_bar.py[line:272] - INFO: epoch 001:   2384 / 17711 loss=3.972, loss_v1=0, loss_v2=0, nll_loss=1.878, ntokens=379.5, nsentences=32, sample_size=379.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=34.409, expert1_balance_bottom=19.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=207.8, ups=0.55, wpb=379.5, bsz=32, num_updates=2380, lr=4.47958e-06, gnorm=3.168, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4844
2022-05-08 22:09:54 - progress_bar.py[line:272] - INFO: epoch 001:   2394 / 17711 loss=3.991, loss_v1=0, loss_v2=0, nll_loss=1.898, ntokens=388.9, nsentences=32, sample_size=388.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.546, expert1_balance_bottom=18.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=213.9, ups=0.55, wpb=388.9, bsz=32, num_updates=2390, lr=4.4984e-06, gnorm=3.027, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4862
2022-05-08 22:10:12 - progress_bar.py[line:272] - INFO: epoch 001:   2404 / 17711 loss=3.935, loss_v1=0, loss_v2=0, nll_loss=1.84, ntokens=387.9, nsentences=32, sample_size=387.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.935, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=35.034, expert1_balance_bottom=18.861, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.58, wps=213.3, ups=0.55, wpb=387.9, bsz=32, num_updates=2400, lr=4.51722e-06, gnorm=3.329, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4880
2022-05-08 22:10:30 - progress_bar.py[line:272] - INFO: epoch 001:   2414 / 17711 loss=4.08, loss_v1=0, loss_v2=0, nll_loss=1.993, ntokens=383, nsentences=32, sample_size=383, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.353, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.98, wps=208.8, ups=0.55, wpb=383, bsz=32, num_updates=2410, lr=4.53604e-06, gnorm=3.29, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4898
2022-05-08 22:10:49 - progress_bar.py[line:272] - INFO: epoch 001:   2424 / 17711 loss=4.019, loss_v1=0, loss_v2=0, nll_loss=1.922, ntokens=377.5, nsentences=32, sample_size=377.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888037, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.268, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=206.3, ups=0.55, wpb=377.5, bsz=32, num_updates=2420, lr=4.55487e-06, gnorm=3.113, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4917
2022-05-08 22:11:07 - progress_bar.py[line:272] - INFO: epoch 001:   2434 / 17711 loss=3.989, loss_v1=0, loss_v2=0, nll_loss=1.89, ntokens=376.7, nsentences=32, sample_size=376.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.988, expert1_balance_bottom=19.228, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=208.4, ups=0.55, wpb=376.7, bsz=32, num_updates=2430, lr=4.57369e-06, gnorm=3.12, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4935
2022-05-08 22:11:25 - progress_bar.py[line:272] - INFO: epoch 001:   2444 / 17711 loss=4.025, loss_v1=0, loss_v2=0, nll_loss=1.925, ntokens=383.6, nsentences=32, sample_size=383.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891174, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.217, expert1_balance_top=33.957, expert1_balance_bottom=19.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=215.2, ups=0.56, wpb=383.6, bsz=32, num_updates=2440, lr=4.59251e-06, gnorm=3.506, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4953
2022-05-08 22:11:43 - progress_bar.py[line:272] - INFO: epoch 001:   2454 / 17711 loss=3.971, loss_v1=0, loss_v2=0, nll_loss=1.876, ntokens=380.8, nsentences=32, sample_size=380.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880419, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.347, expert1_balance_bottom=19.213, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.67, wps=208.7, ups=0.55, wpb=380.8, bsz=32, num_updates=2450, lr=4.61133e-06, gnorm=3.296, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4971
2022-05-08 22:12:01 - progress_bar.py[line:272] - INFO: epoch 001:   2464 / 17711 loss=3.96, loss_v1=0, loss_v2=0, nll_loss=1.852, ntokens=381.9, nsentences=32, sample_size=381.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.946, expert1_balance_bottom=19.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.61, wps=210.9, ups=0.55, wpb=381.9, bsz=32, num_updates=2460, lr=4.63015e-06, gnorm=3.299, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=4989
2022-05-08 22:12:19 - progress_bar.py[line:272] - INFO: epoch 001:   2474 / 17711 loss=4.036, loss_v1=0, loss_v2=0, nll_loss=1.931, ntokens=380.9, nsentences=32, sample_size=380.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.216, expert1_balance_top=33.843, expert1_balance_bottom=19.142, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=211.6, ups=0.56, wpb=380.9, bsz=32, num_updates=2470, lr=4.64897e-06, gnorm=3.168, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5007
2022-05-08 22:12:37 - progress_bar.py[line:272] - INFO: epoch 001:   2484 / 17711 loss=3.954, loss_v1=0, loss_v2=0, nll_loss=1.86, ntokens=388.6, nsentences=32, sample_size=388.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882251, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.328, expert1_balance_bottom=19.081, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=213.7, ups=0.55, wpb=388.6, bsz=32, num_updates=2480, lr=4.6678e-06, gnorm=3.046, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5025
2022-05-08 22:12:55 - progress_bar.py[line:272] - INFO: epoch 001:   2494 / 17711 loss=4.015, loss_v1=0, loss_v2=0, nll_loss=1.93, ntokens=383.8, nsentences=32, sample_size=383.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881305, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.511, expert1_balance_bottom=19.068, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=214, ups=0.56, wpb=383.8, bsz=32, num_updates=2490, lr=4.68662e-06, gnorm=3.255, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5043
2022-05-08 22:13:13 - progress_bar.py[line:272] - INFO: epoch 001:   2504 / 17711 loss=4.023, loss_v1=0, loss_v2=0, nll_loss=1.94, ntokens=382.3, nsentences=32, sample_size=382.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=4.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.721, expert1_balance_bottom=18.888, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.84, wps=212.1, ups=0.55, wpb=382.3, bsz=32, num_updates=2500, lr=4.70544e-06, gnorm=3.222, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5061
2022-05-08 22:13:31 - progress_bar.py[line:272] - INFO: epoch 001:   2514 / 17711 loss=3.32, loss_v1=0, loss_v2=0, nll_loss=1.132, ntokens=378.2, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.32, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.827, expert1_balance_bottom=19.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.19, wps=207.2, ups=0.55, wpb=378.2, bsz=32, num_updates=2510, lr=4.72426e-06, gnorm=3.322, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5079
2022-05-08 22:13:50 - progress_bar.py[line:272] - INFO: epoch 001:   2524 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877196, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.508, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=205.8, ups=0.54, wpb=382.9, bsz=32, num_updates=2520, lr=4.74308e-06, gnorm=2.972, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5098
2022-05-08 22:14:08 - progress_bar.py[line:272] - INFO: epoch 001:   2534 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=386.5, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.311, expert1_balance_bottom=19.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=211.1, ups=0.55, wpb=386.5, bsz=32, num_updates=2530, lr=4.7619e-06, gnorm=3.076, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5116
2022-05-08 22:14:27 - progress_bar.py[line:272] - INFO: epoch 001:   2544 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=377.7, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.017, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=206.5, ups=0.55, wpb=377.7, bsz=32, num_updates=2540, lr=4.78073e-06, gnorm=3.105, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5135
2022-05-08 22:14:45 - progress_bar.py[line:272] - INFO: epoch 001:   2554 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=383.5, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892822, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=33.556, expert1_balance_bottom=19.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210.7, ups=0.55, wpb=383.5, bsz=32, num_updates=2550, lr=4.79955e-06, gnorm=2.764, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5153
2022-05-08 22:15:03 - progress_bar.py[line:272] - INFO: epoch 001:   2564 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=376.6, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882311, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.408, expert1_balance_bottom=19.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=205.5, ups=0.55, wpb=376.6, bsz=32, num_updates=2560, lr=4.81837e-06, gnorm=3.123, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5171
2022-05-08 22:15:22 - progress_bar.py[line:272] - INFO: epoch 001:   2574 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88063, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.594, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=206.6, ups=0.54, wpb=383, bsz=32, num_updates=2570, lr=4.83719e-06, gnorm=2.786, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5190
2022-05-08 22:15:40 - progress_bar.py[line:272] - INFO: epoch 001:   2584 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=375.2, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899719, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=33.352, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=204.1, ups=0.54, wpb=375.2, bsz=32, num_updates=2580, lr=4.85601e-06, gnorm=2.934, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5208
2022-05-08 22:15:58 - progress_bar.py[line:272] - INFO: epoch 001:   2594 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=376.6, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89233, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.003, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=208.6, ups=0.55, wpb=376.6, bsz=32, num_updates=2590, lr=4.87484e-06, gnorm=3.021, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5226
2022-05-08 22:16:17 - progress_bar.py[line:272] - INFO: epoch 001:   2604 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=35.271, expert1_balance_bottom=18.81, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=204.8, ups=0.54, wpb=378.7, bsz=32, num_updates=2600, lr=4.89366e-06, gnorm=3.354, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5245
2022-05-08 22:16:35 - progress_bar.py[line:272] - INFO: epoch 001:   2614 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882641, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.661, expert1_balance_bottom=18.856, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.7, ups=0.55, wpb=384.7, bsz=32, num_updates=2610, lr=4.91248e-06, gnorm=3.117, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5263
2022-05-08 22:16:53 - progress_bar.py[line:272] - INFO: epoch 001:   2624 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=379.9, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.213, expert1_balance_top=34.045, expert1_balance_bottom=19.097, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=206.9, ups=0.54, wpb=379.9, bsz=32, num_updates=2620, lr=4.9313e-06, gnorm=3.299, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5281
2022-05-08 22:17:12 - progress_bar.py[line:272] - INFO: epoch 001:   2634 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=376.8, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=33.748, expert1_balance_bottom=19.068, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=203.9, ups=0.54, wpb=376.8, bsz=32, num_updates=2630, lr=4.95012e-06, gnorm=3.019, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5300
2022-05-08 22:17:30 - progress_bar.py[line:272] - INFO: epoch 001:   2644 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=33.811, expert1_balance_bottom=19.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211, ups=0.55, wpb=381.1, bsz=32, num_updates=2640, lr=4.96894e-06, gnorm=3.532, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5318
2022-05-08 22:17:48 - progress_bar.py[line:272] - INFO: epoch 001:   2654 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=390.8, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.241, expert1_balance_bottom=19.094, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.9, ups=0.54, wpb=390.8, bsz=32, num_updates=2650, lr=4.98777e-06, gnorm=3.364, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5336
2022-05-08 22:18:07 - progress_bar.py[line:272] - INFO: epoch 001:   2664 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=376.5, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=35.059, expert1_balance_bottom=18.788, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=204.6, ups=0.54, wpb=376.5, bsz=32, num_updates=2660, lr=5.00659e-06, gnorm=3, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5355
2022-05-08 22:18:25 - progress_bar.py[line:272] - INFO: epoch 001:   2674 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=386.5, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=35.041, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.6, ups=0.55, wpb=386.5, bsz=32, num_updates=2670, lr=5.02541e-06, gnorm=2.744, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5373
2022-05-08 22:18:43 - progress_bar.py[line:272] - INFO: epoch 001:   2684 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=35.014, expert1_balance_bottom=18.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.6, ups=0.55, wpb=385.2, bsz=32, num_updates=2680, lr=5.04423e-06, gnorm=3.461, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5391
2022-05-08 22:19:01 - progress_bar.py[line:272] - INFO: epoch 001:   2694 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=373.9, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883528, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.619, expert1_balance_bottom=18.939, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=205.8, ups=0.55, wpb=373.9, bsz=32, num_updates=2690, lr=5.06305e-06, gnorm=3.558, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5409
2022-05-08 22:19:20 - progress_bar.py[line:272] - INFO: epoch 001:   2704 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=376.3, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903717, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.215, expert1_balance_top=33.544, expert1_balance_bottom=19.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=204.7, ups=0.54, wpb=376.3, bsz=32, num_updates=2700, lr=5.08187e-06, gnorm=3.688, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5428
2022-05-08 22:19:38 - progress_bar.py[line:272] - INFO: epoch 001:   2714 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=374.7, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.189, expert1_balance_bottom=19.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=202.7, ups=0.54, wpb=374.7, bsz=32, num_updates=2710, lr=5.1007e-06, gnorm=3.454, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5446
2022-05-08 22:19:56 - progress_bar.py[line:272] - INFO: epoch 001:   2724 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=385.4, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.699, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=210.4, ups=0.55, wpb=385.4, bsz=32, num_updates=2720, lr=5.11952e-06, gnorm=3.23, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5464
2022-05-08 22:20:14 - progress_bar.py[line:272] - INFO: epoch 001:   2734 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866055, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=35.521, expert1_balance_bottom=18.811, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=212.1, ups=0.55, wpb=384.1, bsz=32, num_updates=2730, lr=5.13834e-06, gnorm=3.062, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5482
2022-05-08 22:20:33 - progress_bar.py[line:272] - INFO: epoch 001:   2744 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=385.1, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=35.289, expert1_balance_bottom=18.764, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.2, ups=0.55, wpb=385.1, bsz=32, num_updates=2740, lr=5.15716e-06, gnorm=3.197, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5501
2022-05-08 22:20:51 - progress_bar.py[line:272] - INFO: epoch 001:   2754 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=388.4, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87894, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.947, expert1_balance_bottom=18.71, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.6, ups=0.55, wpb=388.4, bsz=32, num_updates=2750, lr=5.17598e-06, gnorm=3.005, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5519
2022-05-08 22:21:09 - progress_bar.py[line:272] - INFO: epoch 001:   2764 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894073, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=33.942, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.7, ups=0.55, wpb=384.4, bsz=32, num_updates=2760, lr=5.19481e-06, gnorm=3.131, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5537
2022-05-08 22:21:27 - progress_bar.py[line:272] - INFO: epoch 001:   2774 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88717, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.655, expert1_balance_bottom=19.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=210.1, ups=0.55, wpb=379, bsz=32, num_updates=2770, lr=5.21363e-06, gnorm=3.143, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5555
2022-05-08 22:21:45 - progress_bar.py[line:272] - INFO: epoch 001:   2784 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.97, expert1_balance_bottom=18.925, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.5, ups=0.56, wpb=379.7, bsz=32, num_updates=2780, lr=5.23245e-06, gnorm=3.682, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5573
2022-05-08 22:21:54 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 22:22:05 - progress_bar.py[line:272] - INFO: epoch 001:   2795 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.211, expert1_balance_top=34.397, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=194.1, ups=0.51, wpb=383.6, bsz=32, num_updates=2790, lr=5.25127e-06, gnorm=4.028, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5593
2022-05-08 22:22:23 - progress_bar.py[line:272] - INFO: epoch 001:   2805 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=381.4, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890411, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=33.968, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=212, ups=0.56, wpb=381.4, bsz=32, num_updates=2800, lr=5.27009e-06, gnorm=3.299, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5611
2022-05-08 22:22:41 - progress_bar.py[line:272] - INFO: epoch 001:   2815 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=383.2, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880594, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=35.049, expert1_balance_bottom=18.961, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=210.2, ups=0.55, wpb=383.2, bsz=32, num_updates=2810, lr=5.28891e-06, gnorm=3.561, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5629
2022-05-08 22:22:59 - progress_bar.py[line:272] - INFO: epoch 001:   2825 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=384.2, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887263, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.299, expert1_balance_bottom=19.107, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.5, ups=0.55, wpb=384.2, bsz=32, num_updates=2820, lr=5.30774e-06, gnorm=3.674, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5647
2022-05-08 22:23:17 - progress_bar.py[line:272] - INFO: epoch 001:   2835 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=374.7, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878501, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.56, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=208.4, ups=0.56, wpb=374.7, bsz=32, num_updates=2830, lr=5.32656e-06, gnorm=3.245, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5665
2022-05-08 22:23:35 - progress_bar.py[line:272] - INFO: epoch 001:   2845 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=378.7, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892547, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=33.889, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=207.2, ups=0.55, wpb=378.7, bsz=32, num_updates=2840, lr=5.34538e-06, gnorm=3.599, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5683
2022-05-08 22:23:53 - progress_bar.py[line:272] - INFO: epoch 001:   2855 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=385.2, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.055, expert1_balance_bottom=19.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=216.2, ups=0.56, wpb=385.2, bsz=32, num_updates=2850, lr=5.3642e-06, gnorm=3.327, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5701
2022-05-08 22:24:12 - progress_bar.py[line:272] - INFO: epoch 001:   2865 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877956, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=35.074, expert1_balance_bottom=19.001, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=206.2, ups=0.54, wpb=382.9, bsz=32, num_updates=2860, lr=5.38302e-06, gnorm=3.037, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5720
2022-05-08 22:24:30 - progress_bar.py[line:272] - INFO: epoch 001:   2875 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=392.3, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=35.114, expert1_balance_bottom=18.793, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.4, ups=0.55, wpb=392.3, bsz=32, num_updates=2870, lr=5.40184e-06, gnorm=3.376, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5738
2022-05-08 22:24:48 - progress_bar.py[line:272] - INFO: epoch 001:   2885 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=376.7, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886089, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.398, expert1_balance_bottom=18.96, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211, ups=0.56, wpb=376.7, bsz=32, num_updates=2880, lr=5.42067e-06, gnorm=3.139, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5756
2022-05-08 22:25:06 - progress_bar.py[line:272] - INFO: epoch 001:   2895 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=373.2, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=33.531, expert1_balance_bottom=19.415, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=206.5, ups=0.55, wpb=373.2, bsz=32, num_updates=2890, lr=5.43949e-06, gnorm=3.336, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5774
2022-05-08 22:25:24 - progress_bar.py[line:272] - INFO: epoch 001:   2905 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=378.9, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875238, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=35.189, expert1_balance_bottom=18.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=206.9, ups=0.55, wpb=378.9, bsz=32, num_updates=2900, lr=5.45831e-06, gnorm=3.716, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5792
2022-05-08 22:25:42 - progress_bar.py[line:272] - INFO: epoch 001:   2915 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=373.2, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879791, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.882, expert1_balance_bottom=18.837, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=205.1, ups=0.55, wpb=373.2, bsz=32, num_updates=2910, lr=5.47713e-06, gnorm=3.229, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5810
2022-05-08 22:26:01 - progress_bar.py[line:272] - INFO: epoch 001:   2925 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=393.3, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870324, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=35.18, expert1_balance_bottom=18.668, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216.7, ups=0.55, wpb=393.3, bsz=32, num_updates=2920, lr=5.49595e-06, gnorm=3.307, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5829
2022-05-08 22:26:19 - progress_bar.py[line:272] - INFO: epoch 001:   2935 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=391.7, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889304, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=33.91, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.2, ups=0.55, wpb=391.7, bsz=32, num_updates=2930, lr=5.51478e-06, gnorm=3.274, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5847
2022-05-08 22:26:37 - progress_bar.py[line:272] - INFO: epoch 001:   2945 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.685, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=212.5, ups=0.56, wpb=382.1, bsz=32, num_updates=2940, lr=5.5336e-06, gnorm=3.891, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5865
2022-05-08 22:26:55 - progress_bar.py[line:272] - INFO: epoch 001:   2955 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=370.3, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894831, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=34.017, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=203.6, ups=0.55, wpb=370.3, bsz=32, num_updates=2950, lr=5.55242e-06, gnorm=3.177, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5883
2022-05-08 22:27:13 - progress_bar.py[line:272] - INFO: epoch 001:   2965 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892148, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.396, expert1_balance_bottom=19.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=206, ups=0.55, wpb=376.7, bsz=32, num_updates=2960, lr=5.57124e-06, gnorm=3.252, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5901
2022-05-08 22:27:31 - progress_bar.py[line:272] - INFO: epoch 001:   2975 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=388.2, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873432, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=35.003, expert1_balance_bottom=18.916, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213.8, ups=0.55, wpb=388.2, bsz=32, num_updates=2970, lr=5.59006e-06, gnorm=3.167, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5919
2022-05-08 22:27:49 - progress_bar.py[line:272] - INFO: epoch 001:   2985 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=380.7, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.518, expert1_balance_bottom=19.017, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=212.6, ups=0.56, wpb=380.7, bsz=32, num_updates=2980, lr=5.60888e-06, gnorm=3.438, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5937
2022-05-08 22:28:07 - progress_bar.py[line:272] - INFO: epoch 001:   2995 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884841, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.955, expert1_balance_bottom=18.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.2, ups=0.55, wpb=386.8, bsz=32, num_updates=2990, lr=5.62771e-06, gnorm=3.572, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5956
2022-05-08 22:28:26 - progress_bar.py[line:272] - INFO: epoch 001:   3005 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902849, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.214, expert1_balance_top=33.181, expert1_balance_bottom=19.392, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210.7, ups=0.55, wpb=380.7, bsz=32, num_updates=3000, lr=5.64653e-06, gnorm=3.023, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5974
2022-05-08 22:28:44 - progress_bar.py[line:272] - INFO: epoch 001:   3015 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=385.6, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.869, expert1_balance_bottom=18.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=213.4, ups=0.55, wpb=385.6, bsz=32, num_updates=3010, lr=5.66535e-06, gnorm=3.41, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=5992
2022-05-08 22:29:02 - progress_bar.py[line:272] - INFO: epoch 001:   3025 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=388.1, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888604, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.422, expert1_balance_bottom=19.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.9, ups=0.55, wpb=388.1, bsz=32, num_updates=3020, lr=5.68417e-06, gnorm=3.167, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6010
2022-05-08 22:29:20 - progress_bar.py[line:272] - INFO: epoch 001:   3035 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=389.4, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.859783, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=36.339, expert1_balance_bottom=18.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=211.8, ups=0.54, wpb=389.4, bsz=32, num_updates=3030, lr=5.70299e-06, gnorm=3.139, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6028
2022-05-08 22:29:38 - progress_bar.py[line:272] - INFO: epoch 001:   3045 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=33.814, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=207.8, ups=0.55, wpb=378.7, bsz=32, num_updates=3040, lr=5.72181e-06, gnorm=3.383, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6046
2022-05-08 22:29:57 - progress_bar.py[line:272] - INFO: epoch 001:   3055 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=389.5, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884145, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.946, expert1_balance_bottom=18.98, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214.2, ups=0.55, wpb=389.5, bsz=32, num_updates=3050, lr=5.74064e-06, gnorm=3.164, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6065
2022-05-08 22:30:15 - progress_bar.py[line:272] - INFO: epoch 001:   3065 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=382.8, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881469, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.85, expert1_balance_bottom=18.863, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.6, ups=0.55, wpb=382.8, bsz=32, num_updates=3060, lr=5.75946e-06, gnorm=3.496, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6083
2022-05-08 22:30:33 - progress_bar.py[line:272] - INFO: epoch 001:   3075 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=376.5, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.477, expert1_balance_bottom=18.953, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=203.6, ups=0.54, wpb=376.5, bsz=32, num_updates=3070, lr=5.77828e-06, gnorm=4.069, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6101
2022-05-08 22:30:51 - progress_bar.py[line:272] - INFO: epoch 001:   3085 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=379.5, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.115, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=207.3, ups=0.55, wpb=379.5, bsz=32, num_updates=3080, lr=5.7971e-06, gnorm=3.145, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6120
2022-05-08 22:31:10 - progress_bar.py[line:272] - INFO: epoch 001:   3095 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=377.3, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894397, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.212, expert1_balance_top=34.278, expert1_balance_bottom=19.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=204.5, ups=0.54, wpb=377.3, bsz=32, num_updates=3090, lr=5.81592e-06, gnorm=3.186, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6138
2022-05-08 22:31:28 - progress_bar.py[line:272] - INFO: epoch 001:   3105 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877818, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=35.304, expert1_balance_bottom=18.642, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209, ups=0.55, wpb=381, bsz=32, num_updates=3100, lr=5.83474e-06, gnorm=3.303, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6156
2022-05-08 22:31:46 - progress_bar.py[line:272] - INFO: epoch 001:   3115 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.359, expert1_balance_bottom=18.991, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=209.8, ups=0.55, wpb=383.3, bsz=32, num_updates=3110, lr=5.85357e-06, gnorm=2.93, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6174
2022-05-08 22:32:05 - progress_bar.py[line:272] - INFO: epoch 001:   3125 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888968, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.246, expert1_balance_bottom=19.094, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=207.1, ups=0.54, wpb=384.7, bsz=32, num_updates=3120, lr=5.87239e-06, gnorm=3.349, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6193
2022-05-08 22:32:23 - progress_bar.py[line:272] - INFO: epoch 001:   3135 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=377.2, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.372, expert1_balance_bottom=19.053, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=203.9, ups=0.54, wpb=377.2, bsz=32, num_updates=3130, lr=5.89121e-06, gnorm=3.63, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6212
2022-05-08 22:32:42 - progress_bar.py[line:272] - INFO: epoch 001:   3145 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=378.9, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.48, expert1_balance_bottom=18.994, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.4, ups=0.55, wpb=378.9, bsz=32, num_updates=3140, lr=5.91003e-06, gnorm=3.234, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6230
2022-05-08 22:33:00 - progress_bar.py[line:272] - INFO: epoch 001:   3155 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=377.2, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.619, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=206, ups=0.55, wpb=377.2, bsz=32, num_updates=3150, lr=5.92885e-06, gnorm=3.728, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6248
2022-05-08 22:33:18 - progress_bar.py[line:272] - INFO: epoch 001:   3165 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=379.1, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.209, expert1_balance_bottom=19.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=206.5, ups=0.54, wpb=379.1, bsz=32, num_updates=3160, lr=5.94768e-06, gnorm=3.491, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6266
2022-05-08 22:33:36 - progress_bar.py[line:272] - INFO: epoch 001:   3175 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.676, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=207.6, ups=0.55, wpb=378.7, bsz=32, num_updates=3170, lr=5.9665e-06, gnorm=3.36, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6285
2022-05-08 22:33:54 - progress_bar.py[line:272] - INFO: epoch 001:   3185 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=384.9, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885144, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.794, expert1_balance_bottom=18.963, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.1, ups=0.56, wpb=384.9, bsz=32, num_updates=3180, lr=5.98532e-06, gnorm=3.539, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6303
2022-05-08 22:34:12 - progress_bar.py[line:272] - INFO: epoch 001:   3195 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=387.5, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886197, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.299, expert1_balance_bottom=19.102, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.9, ups=0.55, wpb=387.5, bsz=32, num_updates=3190, lr=6.00414e-06, gnorm=3.244, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6321
2022-05-08 22:34:30 - progress_bar.py[line:272] - INFO: epoch 001:   3205 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888899, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.074, expert1_balance_bottom=19.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214.9, ups=0.56, wpb=383.3, bsz=32, num_updates=3200, lr=6.02296e-06, gnorm=3.103, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6338
2022-05-08 22:34:48 - progress_bar.py[line:272] - INFO: epoch 001:   3215 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882867, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.494, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=216.9, ups=0.56, wpb=384, bsz=32, num_updates=3210, lr=6.04178e-06, gnorm=3.542, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6356
2022-05-08 22:35:06 - progress_bar.py[line:272] - INFO: epoch 001:   3225 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=389.8, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=35.661, expert1_balance_bottom=18.664, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.4, ups=0.54, wpb=389.8, bsz=32, num_updates=3220, lr=6.06061e-06, gnorm=3.688, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6375
2022-05-08 22:35:24 - progress_bar.py[line:272] - INFO: epoch 001:   3235 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=385.1, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.903, expert1_balance_bottom=18.865, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=215.8, ups=0.56, wpb=385.1, bsz=32, num_updates=3230, lr=6.07943e-06, gnorm=3.325, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6392
2022-05-08 22:35:42 - progress_bar.py[line:272] - INFO: epoch 001:   3245 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=387.1, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.354, expert1_balance_bottom=19.056, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.6, ups=0.55, wpb=387.1, bsz=32, num_updates=3240, lr=6.09825e-06, gnorm=3.364, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6410
2022-05-08 22:36:00 - progress_bar.py[line:272] - INFO: epoch 001:   3255 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891856, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.071, expert1_balance_bottom=19.302, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=208.5, ups=0.55, wpb=377.9, bsz=32, num_updates=3250, lr=6.11707e-06, gnorm=3.099, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6429
2022-05-08 22:36:19 - progress_bar.py[line:272] - INFO: epoch 001:   3265 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88752, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.585, expert1_balance_bottom=18.954, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.7, ups=0.55, wpb=384.7, bsz=32, num_updates=3260, lr=6.13589e-06, gnorm=3, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6447
2022-05-08 22:36:37 - progress_bar.py[line:272] - INFO: epoch 001:   3275 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=395.4, nsentences=32, sample_size=315, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.344, expert1_balance_bottom=19.091, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.3, ups=0.53, wpb=395.4, bsz=32, num_updates=3270, lr=6.15471e-06, gnorm=3.156, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6465
2022-05-08 22:36:55 - progress_bar.py[line:272] - INFO: epoch 001:   3285 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=384.9, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=34.148, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.4, ups=0.56, wpb=384.9, bsz=32, num_updates=3280, lr=6.17354e-06, gnorm=2.865, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6483
2022-05-08 22:37:13 - progress_bar.py[line:272] - INFO: epoch 001:   3295 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.464, expert1_balance_bottom=19.218, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.9, ups=0.56, wpb=380.1, bsz=32, num_updates=3290, lr=6.19236e-06, gnorm=3.265, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6501
2022-05-08 22:37:31 - progress_bar.py[line:272] - INFO: epoch 001:   3305 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=380.8, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.149, expert1_balance_bottom=19.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=209.2, ups=0.55, wpb=380.8, bsz=32, num_updates=3300, lr=6.21118e-06, gnorm=3.397, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6519
2022-05-08 22:37:49 - progress_bar.py[line:272] - INFO: epoch 001:   3315 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893956, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=33.96, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.5, ups=0.55, wpb=386.1, bsz=32, num_updates=3310, lr=6.23e-06, gnorm=3.345, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6537
2022-05-08 22:37:51 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 22:38:10 - progress_bar.py[line:272] - INFO: epoch 001:   3326 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889579, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.388, expert1_balance_bottom=18.964, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=187.4, ups=0.5, wpb=378.5, bsz=32, num_updates=3320, lr=6.24882e-06, gnorm=3.33, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6558
2022-05-08 22:38:28 - progress_bar.py[line:272] - INFO: epoch 001:   3336 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=375.3, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89041, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.372, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=203.5, ups=0.54, wpb=375.3, bsz=32, num_updates=3330, lr=6.26765e-06, gnorm=3.58, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6576
2022-05-08 22:38:47 - progress_bar.py[line:272] - INFO: epoch 001:   3346 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=376, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.733, expert1_balance_bottom=19.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=202.5, ups=0.54, wpb=376, bsz=32, num_updates=3340, lr=6.28647e-06, gnorm=3.249, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6595
2022-05-08 22:39:05 - progress_bar.py[line:272] - INFO: epoch 001:   3356 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=377.8, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.482, expert1_balance_bottom=19.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=206.5, ups=0.55, wpb=377.8, bsz=32, num_updates=3350, lr=6.30529e-06, gnorm=3.897, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6613
2022-05-08 22:39:23 - progress_bar.py[line:272] - INFO: epoch 001:   3366 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886735, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.307, expert1_balance_bottom=19.218, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.1, ups=0.54, wpb=383, bsz=32, num_updates=3360, lr=6.32411e-06, gnorm=3.081, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6631
2022-05-08 22:39:42 - progress_bar.py[line:272] - INFO: epoch 001:   3376 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.408, expert1_balance_bottom=19.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=210.4, ups=0.55, wpb=383.9, bsz=32, num_updates=3370, lr=6.34293e-06, gnorm=2.976, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6650
2022-05-08 22:40:00 - progress_bar.py[line:272] - INFO: epoch 001:   3386 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=379.8, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=34.446, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209.7, ups=0.55, wpb=379.8, bsz=32, num_updates=3380, lr=6.36175e-06, gnorm=3.134, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6668
2022-05-08 22:40:18 - progress_bar.py[line:272] - INFO: epoch 001:   3396 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88139, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.935, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.3, ups=0.55, wpb=384.5, bsz=32, num_updates=3390, lr=6.38058e-06, gnorm=3.644, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6686
2022-05-08 22:40:36 - progress_bar.py[line:272] - INFO: epoch 001:   3406 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=386.8, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872043, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=35.383, expert1_balance_bottom=18.998, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.4, ups=0.55, wpb=386.8, bsz=32, num_updates=3400, lr=6.3994e-06, gnorm=3.245, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6704
2022-05-08 22:40:54 - progress_bar.py[line:272] - INFO: epoch 001:   3416 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882109, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.896, expert1_balance_bottom=18.836, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.9, ups=0.55, wpb=384.7, bsz=32, num_updates=3410, lr=6.41822e-06, gnorm=3.285, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6722
2022-05-08 22:41:12 - progress_bar.py[line:272] - INFO: epoch 001:   3426 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.367, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=206.9, ups=0.55, wpb=379.6, bsz=32, num_updates=3420, lr=6.43704e-06, gnorm=3.655, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6740
2022-05-08 22:41:31 - progress_bar.py[line:272] - INFO: epoch 001:   3436 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875528, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.773, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209, ups=0.55, wpb=383.3, bsz=32, num_updates=3430, lr=6.45586e-06, gnorm=3.093, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6759
2022-05-08 22:41:49 - progress_bar.py[line:272] - INFO: epoch 001:   3446 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=378.5, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896261, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=33.786, expert1_balance_bottom=19.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=206.3, ups=0.55, wpb=378.5, bsz=32, num_updates=3440, lr=6.47468e-06, gnorm=3.596, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6777
2022-05-08 22:42:07 - progress_bar.py[line:272] - INFO: epoch 001:   3456 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=388.7, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.662, expert1_balance_bottom=18.997, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=214.4, ups=0.55, wpb=388.7, bsz=32, num_updates=3450, lr=6.49351e-06, gnorm=3.754, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6795
2022-05-08 22:42:25 - progress_bar.py[line:272] - INFO: epoch 001:   3466 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.245, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=209.7, ups=0.55, wpb=379.5, bsz=32, num_updates=3460, lr=6.51233e-06, gnorm=3.099, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6813
2022-05-08 22:42:43 - progress_bar.py[line:272] - INFO: epoch 001:   3476 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=385.9, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=35.48, expert1_balance_bottom=18.796, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.2, ups=0.56, wpb=385.9, bsz=32, num_updates=3470, lr=6.53115e-06, gnorm=3.076, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6831
2022-05-08 22:43:02 - progress_bar.py[line:272] - INFO: epoch 001:   3486 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=375.7, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898668, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.209, expert1_balance_top=33.44, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=201.7, ups=0.54, wpb=375.7, bsz=32, num_updates=3480, lr=6.54997e-06, gnorm=3.024, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6850
2022-05-08 22:43:20 - progress_bar.py[line:272] - INFO: epoch 001:   3496 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.21, expert1_balance_top=33.942, expert1_balance_bottom=19.172, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.5, ups=0.55, wpb=382.8, bsz=32, num_updates=3490, lr=6.56879e-06, gnorm=3.2, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6868
2022-05-08 22:43:38 - progress_bar.py[line:272] - INFO: epoch 001:   3506 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=388.8, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875766, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.947, expert1_balance_bottom=18.853, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.7, ups=0.55, wpb=388.8, bsz=32, num_updates=3500, lr=6.58762e-06, gnorm=3.338, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6886
2022-05-08 22:43:57 - progress_bar.py[line:272] - INFO: epoch 001:   3516 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=374.3, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893156, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.343, expert1_balance_bottom=19.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=202.1, ups=0.54, wpb=374.3, bsz=32, num_updates=3510, lr=6.60644e-06, gnorm=3.113, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6905
2022-05-08 22:44:15 - progress_bar.py[line:272] - INFO: epoch 001:   3526 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884981, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.647, expert1_balance_bottom=18.832, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=208.5, ups=0.55, wpb=377.9, bsz=32, num_updates=3520, lr=6.62526e-06, gnorm=3.481, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6923
2022-05-08 22:44:33 - progress_bar.py[line:272] - INFO: epoch 001:   3536 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.308, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.3, ups=0.55, wpb=383.8, bsz=32, num_updates=3530, lr=6.64408e-06, gnorm=4.028, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6941
2022-05-08 22:44:51 - progress_bar.py[line:272] - INFO: epoch 001:   3546 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=384.6, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880654, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.488, expert1_balance_bottom=19.107, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=212.2, ups=0.55, wpb=384.6, bsz=32, num_updates=3540, lr=6.6629e-06, gnorm=3.627, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6959
2022-05-08 22:45:09 - progress_bar.py[line:272] - INFO: epoch 001:   3556 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886615, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.088, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.1, ups=0.55, wpb=382.8, bsz=32, num_updates=3550, lr=6.68172e-06, gnorm=3.877, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6977
2022-05-08 22:45:27 - progress_bar.py[line:272] - INFO: epoch 001:   3566 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876919, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=35.02, expert1_balance_bottom=18.931, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210.5, ups=0.55, wpb=382.4, bsz=32, num_updates=3560, lr=6.70055e-06, gnorm=3.326, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=6995
2022-05-08 22:45:45 - progress_bar.py[line:272] - INFO: epoch 001:   3576 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883128, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.564, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.3, ups=0.55, wpb=384.8, bsz=32, num_updates=3570, lr=6.71937e-06, gnorm=3.237, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7013
2022-05-08 22:46:04 - progress_bar.py[line:272] - INFO: epoch 001:   3586 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886765, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.373, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.6, ups=0.55, wpb=383.9, bsz=32, num_updates=3580, lr=6.73819e-06, gnorm=3.181, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7032
2022-05-08 22:46:22 - progress_bar.py[line:272] - INFO: epoch 001:   3596 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=378.8, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891435, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.229, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=208, ups=0.55, wpb=378.8, bsz=32, num_updates=3590, lr=6.75701e-06, gnorm=3.7, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7050
2022-05-08 22:46:40 - progress_bar.py[line:272] - INFO: epoch 001:   3606 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887479, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.813, expert1_balance_bottom=18.705, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.9, ups=0.55, wpb=383.2, bsz=32, num_updates=3600, lr=6.77583e-06, gnorm=3.359, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7068
2022-05-08 22:46:58 - progress_bar.py[line:272] - INFO: epoch 001:   3616 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=380.9, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=33.889, expert1_balance_bottom=19.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213, ups=0.56, wpb=380.9, bsz=32, num_updates=3610, lr=6.79465e-06, gnorm=3.231, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7086
2022-05-08 22:47:16 - progress_bar.py[line:272] - INFO: epoch 001:   3626 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=381.3, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87759, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=35.071, expert1_balance_bottom=18.661, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=207.5, ups=0.54, wpb=381.3, bsz=32, num_updates=3620, lr=6.81348e-06, gnorm=3.469, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7104
2022-05-08 22:47:35 - progress_bar.py[line:272] - INFO: epoch 001:   3636 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=390.4, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884675, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.375, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=212.9, ups=0.55, wpb=390.4, bsz=32, num_updates=3630, lr=6.8323e-06, gnorm=3.262, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7123
2022-05-08 22:47:53 - progress_bar.py[line:272] - INFO: epoch 001:   3646 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=384.8, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=34.162, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=208.1, ups=0.54, wpb=384.8, bsz=32, num_updates=3640, lr=6.85112e-06, gnorm=3.425, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7141
2022-05-08 22:48:12 - progress_bar.py[line:272] - INFO: epoch 001:   3656 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=379.3, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88701, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.653, expert1_balance_bottom=19.134, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=206.2, ups=0.54, wpb=379.3, bsz=32, num_updates=3650, lr=6.86994e-06, gnorm=3.498, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7160
2022-05-08 22:48:30 - progress_bar.py[line:272] - INFO: epoch 001:   3666 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=392.3, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885623, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.311, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218, ups=0.56, wpb=392.3, bsz=32, num_updates=3660, lr=6.88876e-06, gnorm=3.761, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7178
2022-05-08 22:48:48 - progress_bar.py[line:272] - INFO: epoch 001:   3676 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=33.903, expert1_balance_bottom=19.193, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=208.9, ups=0.55, wpb=378.1, bsz=32, num_updates=3670, lr=6.90759e-06, gnorm=3.303, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7196
2022-05-08 22:49:06 - progress_bar.py[line:272] - INFO: epoch 001:   3686 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877186, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.661, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=209.5, ups=0.55, wpb=379, bsz=32, num_updates=3680, lr=6.92641e-06, gnorm=3.285, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7214
2022-05-08 22:49:24 - progress_bar.py[line:272] - INFO: epoch 001:   3696 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888616, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.116, expert1_balance_bottom=19.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=208.4, ups=0.55, wpb=381.7, bsz=32, num_updates=3690, lr=6.94523e-06, gnorm=3.401, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7232
2022-05-08 22:49:42 - progress_bar.py[line:272] - INFO: epoch 001:   3706 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=33.738, expert1_balance_bottom=19.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=208.5, ups=0.55, wpb=380.5, bsz=32, num_updates=3700, lr=6.96405e-06, gnorm=3.402, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7250
2022-05-08 22:50:00 - progress_bar.py[line:272] - INFO: epoch 001:   3716 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873938, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=35.078, expert1_balance_bottom=18.782, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.2, ups=0.56, wpb=382.3, bsz=32, num_updates=3710, lr=6.98287e-06, gnorm=3.976, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7268
2022-05-08 22:50:19 - progress_bar.py[line:272] - INFO: epoch 001:   3726 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=387.4, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.408, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.6, ups=0.55, wpb=387.4, bsz=32, num_updates=3720, lr=7.00169e-06, gnorm=3.717, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7287
2022-05-08 22:50:37 - progress_bar.py[line:272] - INFO: epoch 001:   3736 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=381.8, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=33.918, expert1_balance_bottom=19.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=209.3, ups=0.55, wpb=381.8, bsz=32, num_updates=3730, lr=7.02052e-06, gnorm=3.78, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7305
2022-05-08 22:50:55 - progress_bar.py[line:272] - INFO: epoch 001:   3746 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.307, expert1_balance_bottom=19.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=212.1, ups=0.56, wpb=381.7, bsz=32, num_updates=3740, lr=7.03934e-06, gnorm=3.514, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7323
2022-05-08 22:51:13 - progress_bar.py[line:272] - INFO: epoch 001:   3756 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=389.6, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89097, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=34.1, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.9, ups=0.55, wpb=389.6, bsz=32, num_updates=3750, lr=7.05816e-06, gnorm=3.491, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7341
2022-05-08 22:51:31 - progress_bar.py[line:272] - INFO: epoch 001:   3766 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=391.6, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.401, expert1_balance_bottom=19.013, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.6, ups=0.54, wpb=391.6, bsz=32, num_updates=3760, lr=7.07698e-06, gnorm=3.956, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7360
2022-05-08 22:51:49 - progress_bar.py[line:272] - INFO: epoch 001:   3776 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886464, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.354, expert1_balance_bottom=19.068, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.9, ups=0.56, wpb=386.2, bsz=32, num_updates=3770, lr=7.0958e-06, gnorm=3.845, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7378
2022-05-08 22:52:08 - progress_bar.py[line:272] - INFO: epoch 001:   3786 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=381.6, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.672, expert1_balance_bottom=18.854, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=205.4, ups=0.54, wpb=381.6, bsz=32, num_updates=3780, lr=7.11462e-06, gnorm=3.31, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7396
2022-05-08 22:52:26 - progress_bar.py[line:272] - INFO: epoch 001:   3796 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.028, expert1_balance_bottom=19.173, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209.7, ups=0.55, wpb=379.2, bsz=32, num_updates=3790, lr=7.13345e-06, gnorm=3.247, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7414
2022-05-08 22:52:44 - progress_bar.py[line:272] - INFO: epoch 001:   3806 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882718, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.643, expert1_balance_bottom=19.078, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=206.9, ups=0.55, wpb=377.2, bsz=32, num_updates=3800, lr=7.15227e-06, gnorm=3.388, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7432
2022-05-08 22:53:03 - progress_bar.py[line:272] - INFO: epoch 001:   3816 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886004, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.382, expert1_balance_bottom=19.144, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=206.9, ups=0.54, wpb=381.8, bsz=32, num_updates=3810, lr=7.17109e-06, gnorm=3.804, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7451
2022-05-08 22:53:21 - progress_bar.py[line:272] - INFO: epoch 001:   3826 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=383.8, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.917, expert1_balance_bottom=18.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=209.4, ups=0.55, wpb=383.8, bsz=32, num_updates=3820, lr=7.18991e-06, gnorm=3.464, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7469
2022-05-08 22:53:39 - progress_bar.py[line:272] - INFO: epoch 001:   3836 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=389.7, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.49, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.4, ups=0.55, wpb=389.7, bsz=32, num_updates=3830, lr=7.20873e-06, gnorm=2.953, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7487
2022-05-08 22:53:58 - progress_bar.py[line:272] - INFO: epoch 001:   3846 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.222, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210.6, ups=0.54, wpb=388.3, bsz=32, num_updates=3840, lr=7.22756e-06, gnorm=3.441, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7506
2022-05-08 22:54:16 - progress_bar.py[line:272] - INFO: epoch 001:   3856 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=384.8, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.57, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=211.1, ups=0.55, wpb=384.8, bsz=32, num_updates=3850, lr=7.24638e-06, gnorm=3.603, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7524
2022-05-08 22:54:18 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 22:54:36 - progress_bar.py[line:272] - INFO: epoch 001:   3867 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88373, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.596, expert1_balance_bottom=18.848, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=191.3, ups=0.5, wpb=386, bsz=32, num_updates=3860, lr=7.2652e-06, gnorm=3.465, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7544
2022-05-08 22:54:54 - progress_bar.py[line:272] - INFO: epoch 001:   3877 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=388.9, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891996, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.079, expert1_balance_bottom=19.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.3, ups=0.56, wpb=388.9, bsz=32, num_updates=3870, lr=7.28402e-06, gnorm=3.546, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7562
2022-05-08 22:55:12 - progress_bar.py[line:272] - INFO: epoch 001:   3887 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=381.4, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884064, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.43, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=210, ups=0.55, wpb=381.4, bsz=32, num_updates=3880, lr=7.30284e-06, gnorm=3.865, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7580
2022-05-08 22:55:31 - progress_bar.py[line:272] - INFO: epoch 001:   3897 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=379.1, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887794, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=34.375, expert1_balance_bottom=18.738, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=209.5, ups=0.55, wpb=379.1, bsz=32, num_updates=3890, lr=7.32166e-06, gnorm=2.85, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7599
2022-05-08 22:55:49 - progress_bar.py[line:272] - INFO: epoch 001:   3907 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=385, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89037, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.03, expert1_balance_bottom=19.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.2, ups=0.55, wpb=385, bsz=32, num_updates=3900, lr=7.34049e-06, gnorm=3.491, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7617
2022-05-08 22:56:07 - progress_bar.py[line:272] - INFO: epoch 001:   3917 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890371, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.169, expert1_balance_bottom=19.161, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=207.8, ups=0.54, wpb=382.1, bsz=32, num_updates=3910, lr=7.35931e-06, gnorm=3.918, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7635
2022-05-08 22:56:25 - progress_bar.py[line:272] - INFO: epoch 001:   3927 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885082, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.393, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=207.6, ups=0.55, wpb=380, bsz=32, num_updates=3920, lr=7.37813e-06, gnorm=3.289, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7653
2022-05-08 22:56:44 - progress_bar.py[line:272] - INFO: epoch 001:   3937 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889523, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.547, expert1_balance_bottom=18.994, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.5, ups=0.55, wpb=385.8, bsz=32, num_updates=3930, lr=7.39695e-06, gnorm=3.127, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7672
2022-05-08 22:57:02 - progress_bar.py[line:272] - INFO: epoch 001:   3947 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=382, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89067, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.207, expert1_balance_bottom=19.123, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.4, ups=0.55, wpb=382, bsz=32, num_updates=3940, lr=7.41577e-06, gnorm=3.529, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7690
2022-05-08 22:57:20 - progress_bar.py[line:272] - INFO: epoch 001:   3957 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888986, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.321, expert1_balance_bottom=19.04, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.8, ups=0.55, wpb=383.9, bsz=32, num_updates=3950, lr=7.43459e-06, gnorm=3.706, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7708
2022-05-08 22:57:38 - progress_bar.py[line:272] - INFO: epoch 001:   3967 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=386.4, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.722, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210, ups=0.54, wpb=386.4, bsz=32, num_updates=3960, lr=7.45342e-06, gnorm=3.018, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7726
2022-05-08 22:57:56 - progress_bar.py[line:272] - INFO: epoch 001:   3977 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=380, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893006, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=33.971, expert1_balance_bottom=19.091, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208, ups=0.55, wpb=380, bsz=32, num_updates=3970, lr=7.47224e-06, gnorm=3.349, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7745
2022-05-08 22:58:15 - progress_bar.py[line:272] - INFO: epoch 001:   3987 / 17711 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879598, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.151, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.779, expert1_balance_bottom=18.768, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=213.5, ups=0.55, wpb=387.9, bsz=32, num_updates=3980, lr=7.49106e-06, gnorm=3.406, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7763
2022-05-08 22:58:33 - progress_bar.py[line:272] - INFO: epoch 001:   3997 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891156, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.363, expert1_balance_bottom=19.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.1, ups=0.56, wpb=385.5, bsz=32, num_updates=3990, lr=7.50988e-06, gnorm=3.18, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7781
2022-05-08 22:58:51 - progress_bar.py[line:272] - INFO: epoch 001:   4007 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874314, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=35.184, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=210.7, ups=0.55, wpb=380.6, bsz=32, num_updates=4000, lr=7.5287e-06, gnorm=3.666, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=7799
2022-05-08 22:58:51 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 22:58:51 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 22:58:51 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 23:06:28 - train.py[line:517] - INFO: valid_step finished
2022-05-08 23:06:28 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.36 | loss_v1 0 | loss_v2 0 | nll_loss 7.66 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.970106 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.36 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.251 | expert1_balance_top 35.62 | expert1_balance_bottom 15.02 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 202.3 | cider 1.197 | wps 658.5 | wpb 481.7 | bsz 8 | num_updates 4000
2022-05-08 23:06:47 - progress_bar.py[line:272] - INFO: epoch 001:   4017 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895977, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=33.695, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=8, ups=0.02, wpb=382.4, bsz=32, num_updates=4010, lr=7.54752e-06, gnorm=3.961, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8275
2022-05-08 23:07:05 - progress_bar.py[line:272] - INFO: epoch 001:   4027 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.811, expert1_balance_bottom=19.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.3, ups=0.54, wpb=384.1, bsz=32, num_updates=4020, lr=7.56635e-06, gnorm=3.696, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8293
2022-05-08 23:07:23 - progress_bar.py[line:272] - INFO: epoch 001:   4037 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888717, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.561, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=208.6, ups=0.55, wpb=381.1, bsz=32, num_updates=4030, lr=7.58517e-06, gnorm=3.783, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8311
2022-05-08 23:07:42 - progress_bar.py[line:272] - INFO: epoch 001:   4047 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=387.3, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=35.095, expert1_balance_bottom=18.761, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.3, ups=0.55, wpb=387.3, bsz=32, num_updates=4040, lr=7.60399e-06, gnorm=3.634, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8330
2022-05-08 23:08:00 - progress_bar.py[line:272] - INFO: epoch 001:   4057 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=373.5, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.685, expert1_balance_bottom=18.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206.9, ups=0.55, wpb=373.5, bsz=32, num_updates=4050, lr=7.62281e-06, gnorm=3.211, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8348
2022-05-08 23:08:18 - progress_bar.py[line:272] - INFO: epoch 001:   4067 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=400.6, nsentences=32, sample_size=318.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.863918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=35.916, expert1_balance_bottom=18.5, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=217.2, ups=0.54, wpb=400.6, bsz=32, num_updates=4060, lr=7.64163e-06, gnorm=3.459, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8366
2022-05-08 23:08:36 - progress_bar.py[line:272] - INFO: epoch 001:   4077 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=389.8, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888143, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.535, expert1_balance_bottom=18.956, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214, ups=0.55, wpb=389.8, bsz=32, num_updates=4070, lr=7.66046e-06, gnorm=3.225, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8384
2022-05-08 23:08:54 - progress_bar.py[line:272] - INFO: epoch 001:   4087 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=384, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.496, expert1_balance_bottom=18.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212.1, ups=0.55, wpb=384, bsz=32, num_updates=4080, lr=7.67928e-06, gnorm=3.731, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8402
2022-05-08 23:09:13 - progress_bar.py[line:272] - INFO: epoch 001:   4097 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=386.9, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.787, expert1_balance_bottom=19.032, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=212.6, ups=0.55, wpb=386.9, bsz=32, num_updates=4090, lr=7.6981e-06, gnorm=3.685, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8421
2022-05-08 23:09:31 - progress_bar.py[line:272] - INFO: epoch 001:   4107 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=387.5, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883423, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.484, expert1_balance_bottom=19.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.7, ups=0.55, wpb=387.5, bsz=32, num_updates=4100, lr=7.71692e-06, gnorm=3.719, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8439
2022-05-08 23:09:49 - progress_bar.py[line:272] - INFO: epoch 001:   4117 / 17711 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=386.9, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888333, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.175, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.267, expert1_balance_bottom=19.009, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=212.5, ups=0.55, wpb=386.9, bsz=32, num_updates=4110, lr=7.73574e-06, gnorm=3.591, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8457
2022-05-08 23:10:07 - progress_bar.py[line:272] - INFO: epoch 001:   4127 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.269, expert1_balance_bottom=19.126, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.8, ups=0.55, wpb=388, bsz=32, num_updates=4120, lr=7.75456e-06, gnorm=3.604, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8475
2022-05-08 23:10:25 - progress_bar.py[line:272] - INFO: epoch 001:   4137 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=379.8, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887525, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.435, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=208.1, ups=0.55, wpb=379.8, bsz=32, num_updates=4130, lr=7.77339e-06, gnorm=3.633, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8493
2022-05-08 23:10:44 - progress_bar.py[line:272] - INFO: epoch 001:   4147 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=386.2, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901904, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.207, expert1_balance_top=33.627, expert1_balance_bottom=19.284, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=210.9, ups=0.55, wpb=386.2, bsz=32, num_updates=4140, lr=7.79221e-06, gnorm=3.483, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8512
2022-05-08 23:11:02 - progress_bar.py[line:272] - INFO: epoch 001:   4157 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=388.7, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874881, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.847, expert1_balance_bottom=19.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.4, ups=0.55, wpb=388.7, bsz=32, num_updates=4150, lr=7.81103e-06, gnorm=3.267, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8530
2022-05-08 23:11:20 - progress_bar.py[line:272] - INFO: epoch 001:   4167 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.961, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87063, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=35.681, expert1_balance_bottom=18.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=207.6, ups=0.54, wpb=381.1, bsz=32, num_updates=4160, lr=7.82985e-06, gnorm=3.833, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8548
2022-05-08 23:11:38 - progress_bar.py[line:272] - INFO: epoch 001:   4177 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880427, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.623, expert1_balance_bottom=18.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=211.4, ups=0.55, wpb=383.3, bsz=32, num_updates=4170, lr=7.84867e-06, gnorm=3.787, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8566
2022-05-08 23:11:56 - progress_bar.py[line:272] - INFO: epoch 001:   4187 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=373.7, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.26, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206.1, ups=0.55, wpb=373.7, bsz=32, num_updates=4180, lr=7.86749e-06, gnorm=3.766, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8584
2022-05-08 23:12:14 - progress_bar.py[line:272] - INFO: epoch 001:   4197 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=393.4, nsentences=32, sample_size=313.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.971, expert1_balance_bottom=18.911, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222.7, ups=0.57, wpb=393.4, bsz=32, num_updates=4190, lr=7.88632e-06, gnorm=3.553, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8602
2022-05-08 23:12:32 - progress_bar.py[line:272] - INFO: epoch 001:   4207 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.221, expert1_balance_bottom=18.986, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=207.9, ups=0.55, wpb=380.6, bsz=32, num_updates=4200, lr=7.90514e-06, gnorm=3.154, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8620
2022-05-08 23:12:50 - progress_bar.py[line:272] - INFO: epoch 001:   4217 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=383.6, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=33.924, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.2, ups=0.55, wpb=383.6, bsz=32, num_updates=4210, lr=7.92396e-06, gnorm=3.306, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8639
2022-05-08 23:13:09 - progress_bar.py[line:272] - INFO: epoch 001:   4227 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.359, expert1_balance_bottom=19.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=208.5, ups=0.55, wpb=381.3, bsz=32, num_updates=4220, lr=7.94278e-06, gnorm=3.323, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8657
2022-05-08 23:13:27 - progress_bar.py[line:272] - INFO: epoch 001:   4237 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=380.3, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888887, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.204, expert1_balance_bottom=19.083, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.8, ups=0.56, wpb=380.3, bsz=32, num_updates=4230, lr=7.9616e-06, gnorm=3.699, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8675
2022-05-08 23:13:45 - progress_bar.py[line:272] - INFO: epoch 001:   4247 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889567, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.217, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.1, ups=0.55, wpb=382.3, bsz=32, num_updates=4240, lr=7.98043e-06, gnorm=3.021, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8693
2022-05-08 23:14:03 - progress_bar.py[line:272] - INFO: epoch 001:   4257 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.323, expert1_balance_bottom=19.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.4, ups=0.55, wpb=380.5, bsz=32, num_updates=4250, lr=7.99925e-06, gnorm=3.42, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8711
2022-05-08 23:14:21 - progress_bar.py[line:272] - INFO: epoch 001:   4267 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877205, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.549, expert1_balance_bottom=19.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.3, ups=0.55, wpb=383.3, bsz=32, num_updates=4260, lr=8.01807e-06, gnorm=3.478, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8729
2022-05-08 23:14:39 - progress_bar.py[line:272] - INFO: epoch 001:   4277 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888968, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.011, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.1, ups=0.55, wpb=383, bsz=32, num_updates=4270, lr=8.03689e-06, gnorm=3.743, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8747
2022-05-08 23:14:57 - progress_bar.py[line:272] - INFO: epoch 001:   4287 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=379.3, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.457, expert1_balance_bottom=18.901, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.3, ups=0.55, wpb=379.3, bsz=32, num_updates=4280, lr=8.05571e-06, gnorm=3.3, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8765
2022-05-08 23:15:15 - progress_bar.py[line:272] - INFO: epoch 001:   4297 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=388.8, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.217, expert1_balance_bottom=19.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.2, ups=0.56, wpb=388.8, bsz=32, num_updates=4290, lr=8.07453e-06, gnorm=3.805, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8783
2022-05-08 23:15:33 - progress_bar.py[line:272] - INFO: epoch 001:   4307 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=390.5, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=35.239, expert1_balance_bottom=18.883, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=216.1, ups=0.55, wpb=390.5, bsz=32, num_updates=4300, lr=8.09336e-06, gnorm=4.15, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8801
2022-05-08 23:15:52 - progress_bar.py[line:272] - INFO: epoch 001:   4317 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=391.3, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.768, expert1_balance_bottom=18.921, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213.1, ups=0.54, wpb=391.3, bsz=32, num_updates=4310, lr=8.11218e-06, gnorm=3.173, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8820
2022-05-08 23:16:10 - progress_bar.py[line:272] - INFO: epoch 001:   4327 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87904, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.361, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=209.9, ups=0.54, wpb=385.8, bsz=32, num_updates=4320, lr=8.131e-06, gnorm=3.59, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8838
2022-05-08 23:16:28 - progress_bar.py[line:272] - INFO: epoch 001:   4337 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889139, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.579, expert1_balance_bottom=19.096, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.2, ups=0.56, wpb=381.8, bsz=32, num_updates=4330, lr=8.14982e-06, gnorm=2.995, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8856
2022-05-08 23:16:46 - progress_bar.py[line:272] - INFO: epoch 001:   4347 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=378.3, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.297, expert1_balance_bottom=19.116, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=208, ups=0.55, wpb=378.3, bsz=32, num_updates=4340, lr=8.16864e-06, gnorm=3.43, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8874
2022-05-08 23:17:04 - progress_bar.py[line:272] - INFO: epoch 001:   4357 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=389.7, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.872, expert1_balance_bottom=18.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.4, ups=0.55, wpb=389.7, bsz=32, num_updates=4350, lr=8.18746e-06, gnorm=3.931, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8892
2022-05-08 23:17:23 - progress_bar.py[line:272] - INFO: epoch 001:   4367 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890045, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.649, expert1_balance_bottom=18.842, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=206.7, ups=0.54, wpb=379.5, bsz=32, num_updates=4360, lr=8.20629e-06, gnorm=3.58, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8911
2022-05-08 23:17:41 - progress_bar.py[line:272] - INFO: epoch 001:   4377 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=35.569, expert1_balance_bottom=18.874, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.5, ups=0.55, wpb=380.7, bsz=32, num_updates=4370, lr=8.22511e-06, gnorm=3.81, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8929
2022-05-08 23:17:59 - progress_bar.py[line:272] - INFO: epoch 001:   4387 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.97, ntokens=387, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879187, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.773, expert1_balance_bottom=18.831, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=210.9, ups=0.55, wpb=387, bsz=32, num_updates=4380, lr=8.24393e-06, gnorm=3.862, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8947
2022-05-08 23:18:17 - progress_bar.py[line:272] - INFO: epoch 001:   4397 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889707, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.726, expert1_balance_bottom=18.72, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=208.8, ups=0.55, wpb=377.8, bsz=32, num_updates=4390, lr=8.26275e-06, gnorm=3.298, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8965
2022-05-08 23:18:35 - progress_bar.py[line:272] - INFO: epoch 001:   4407 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.846, expert1_balance_bottom=18.858, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.6, ups=0.55, wpb=382.1, bsz=32, num_updates=4400, lr=8.28157e-06, gnorm=3.138, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=8984
2022-05-08 23:18:53 - progress_bar.py[line:272] - INFO: epoch 001:   4417 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.67, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=214, ups=0.56, wpb=384.9, bsz=32, num_updates=4410, lr=8.3004e-06, gnorm=3.431, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9001
2022-05-08 23:19:11 - progress_bar.py[line:272] - INFO: epoch 001:   4427 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.986, expert1_balance_bottom=18.832, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.6, ups=0.56, wpb=384.2, bsz=32, num_updates=4420, lr=8.31922e-06, gnorm=3.642, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9019
2022-05-08 23:19:29 - progress_bar.py[line:272] - INFO: epoch 001:   4437 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=375, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.157, expert1_balance_bottom=19.091, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=205.8, ups=0.55, wpb=375, bsz=32, num_updates=4430, lr=8.33804e-06, gnorm=3.628, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9038
2022-05-08 23:19:48 - progress_bar.py[line:272] - INFO: epoch 001:   4447 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=380, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.664, expert1_balance_bottom=18.957, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.8, ups=0.55, wpb=380, bsz=32, num_updates=4440, lr=8.35686e-06, gnorm=3.372, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9056
2022-05-08 23:20:06 - progress_bar.py[line:272] - INFO: epoch 001:   4457 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=382.2, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888225, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.36, expert1_balance_bottom=18.993, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.5, ups=0.55, wpb=382.2, bsz=32, num_updates=4450, lr=8.37568e-06, gnorm=3.433, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9074
2022-05-08 23:20:24 - progress_bar.py[line:272] - INFO: epoch 001:   4467 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=375.8, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89006, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.533, expert1_balance_bottom=18.931, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=209.5, ups=0.56, wpb=375.8, bsz=32, num_updates=4460, lr=8.3945e-06, gnorm=3.827, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9092
2022-05-08 23:20:41 - progress_bar.py[line:272] - INFO: epoch 001:   4477 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=370.7, nsentences=32, sample_size=294.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904853, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.208, expert1_balance_top=33.757, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.4, ups=0.56, wpb=370.7, bsz=32, num_updates=4470, lr=8.41333e-06, gnorm=3.236, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9109
2022-05-08 23:20:45 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-08 23:21:01 - progress_bar.py[line:272] - INFO: epoch 001:   4488 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=382.9, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890386, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.284, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=193.6, ups=0.51, wpb=382.9, bsz=32, num_updates=4480, lr=8.43215e-06, gnorm=3.509, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9129
2022-05-08 23:21:19 - progress_bar.py[line:272] - INFO: epoch 001:   4498 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=389.2, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882663, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.542, expert1_balance_bottom=18.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=217.6, ups=0.56, wpb=389.2, bsz=32, num_updates=4490, lr=8.45097e-06, gnorm=3.375, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9147
2022-05-08 23:21:37 - progress_bar.py[line:272] - INFO: epoch 001:   4508 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=380.9, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.44, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=209.9, ups=0.55, wpb=380.9, bsz=32, num_updates=4500, lr=8.46979e-06, gnorm=3.213, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9165
2022-05-08 23:21:55 - progress_bar.py[line:272] - INFO: epoch 001:   4518 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=379.8, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.347, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=207.5, ups=0.55, wpb=379.8, bsz=32, num_updates=4510, lr=8.48861e-06, gnorm=3.246, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9183
2022-05-08 23:22:14 - progress_bar.py[line:272] - INFO: epoch 001:   4528 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=385.6, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888493, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.125, expert1_balance_bottom=18.944, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.2, ups=0.55, wpb=385.6, bsz=32, num_updates=4520, lr=8.50743e-06, gnorm=3.157, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9202
2022-05-08 23:22:32 - progress_bar.py[line:272] - INFO: epoch 001:   4538 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896633, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=34.013, expert1_balance_bottom=19.077, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.6, ups=0.55, wpb=384.7, bsz=32, num_updates=4530, lr=8.52626e-06, gnorm=3.397, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9220
2022-05-08 23:22:50 - progress_bar.py[line:272] - INFO: epoch 001:   4548 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.204, expert1_balance_top=33.919, expert1_balance_bottom=19.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=206.4, ups=0.55, wpb=378.2, bsz=32, num_updates=4540, lr=8.54508e-06, gnorm=3.626, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9238
2022-05-08 23:23:09 - progress_bar.py[line:272] - INFO: epoch 001:   4558 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=390.6, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.32, expert1_balance_bottom=19.137, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.3, ups=0.54, wpb=390.6, bsz=32, num_updates=4550, lr=8.5639e-06, gnorm=3.454, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9257
2022-05-08 23:23:27 - progress_bar.py[line:272] - INFO: epoch 001:   4568 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=374.4, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=34.006, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=201.9, ups=0.54, wpb=374.4, bsz=32, num_updates=4560, lr=8.58272e-06, gnorm=3.181, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9275
2022-05-08 23:23:46 - progress_bar.py[line:272] - INFO: epoch 001:   4578 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=373.7, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898929, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=33.554, expert1_balance_bottom=19.283, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=203, ups=0.54, wpb=373.7, bsz=32, num_updates=4570, lr=8.60154e-06, gnorm=3.136, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9294
2022-05-08 23:24:04 - progress_bar.py[line:272] - INFO: epoch 001:   4588 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=384.2, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89095, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.197, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=209.6, ups=0.55, wpb=384.2, bsz=32, num_updates=4580, lr=8.62037e-06, gnorm=3.284, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9312
2022-05-08 23:24:23 - progress_bar.py[line:272] - INFO: epoch 001:   4598 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.177, expert1_balance_bottom=19.087, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=205.5, ups=0.54, wpb=381.1, bsz=32, num_updates=4590, lr=8.63919e-06, gnorm=3.572, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9331
2022-05-08 23:24:41 - progress_bar.py[line:272] - INFO: epoch 001:   4608 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=379.4, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.521, expert1_balance_bottom=18.968, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=206.3, ups=0.54, wpb=379.4, bsz=32, num_updates=4600, lr=8.65801e-06, gnorm=3.843, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9349
2022-05-08 23:24:59 - progress_bar.py[line:272] - INFO: epoch 001:   4618 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=373.9, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=35.156, expert1_balance_bottom=18.688, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=204.4, ups=0.55, wpb=373.9, bsz=32, num_updates=4610, lr=8.67683e-06, gnorm=3.58, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9367
2022-05-08 23:25:18 - progress_bar.py[line:272] - INFO: epoch 001:   4628 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=374.3, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891406, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=33.993, expert1_balance_bottom=19.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=202.7, ups=0.54, wpb=374.3, bsz=32, num_updates=4620, lr=8.69565e-06, gnorm=3.338, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9386
2022-05-08 23:25:36 - progress_bar.py[line:272] - INFO: epoch 001:   4638 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884615, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.717, expert1_balance_bottom=18.786, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=212.5, ups=0.55, wpb=385.6, bsz=32, num_updates=4630, lr=8.71447e-06, gnorm=4.576, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9404
2022-05-08 23:25:54 - progress_bar.py[line:272] - INFO: epoch 001:   4648 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=385.8, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.896, expert1_balance_bottom=18.716, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=210.7, ups=0.55, wpb=385.8, bsz=32, num_updates=4640, lr=8.7333e-06, gnorm=3.395, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9422
2022-05-08 23:26:12 - progress_bar.py[line:272] - INFO: epoch 001:   4658 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=386.6, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877504, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.878, expert1_balance_bottom=18.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=212.3, ups=0.55, wpb=386.6, bsz=32, num_updates=4650, lr=8.75212e-06, gnorm=3.832, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9440
2022-05-08 23:26:30 - progress_bar.py[line:272] - INFO: epoch 001:   4668 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882082, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.707, expert1_balance_bottom=19.012, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.8, ups=0.57, wpb=386.8, bsz=32, num_updates=4660, lr=8.77094e-06, gnorm=3.171, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9458
2022-05-08 23:26:47 - progress_bar.py[line:272] - INFO: epoch 001:   4678 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=389, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87988, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.59, expert1_balance_bottom=18.871, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227.9, ups=0.59, wpb=389, bsz=32, num_updates=4670, lr=8.78976e-06, gnorm=3.982, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9475
2022-05-08 23:27:04 - progress_bar.py[line:272] - INFO: epoch 001:   4688 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=387.4, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.378, expert1_balance_bottom=18.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=223.8, ups=0.58, wpb=387.4, bsz=32, num_updates=4680, lr=8.80858e-06, gnorm=4.546, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9492
2022-05-08 23:27:22 - progress_bar.py[line:272] - INFO: epoch 001:   4698 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=383.2, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880411, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.835, expert1_balance_bottom=18.785, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.9, ups=0.58, wpb=383.2, bsz=32, num_updates=4690, lr=8.8274e-06, gnorm=3.399, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9510
2022-05-08 23:27:39 - progress_bar.py[line:272] - INFO: epoch 001:   4708 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=372.3, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.206, expert1_balance_top=33.67, expert1_balance_bottom=19.094, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.8, ups=0.58, wpb=372.3, bsz=32, num_updates=4700, lr=8.84623e-06, gnorm=3.733, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9527
2022-05-08 23:27:56 - progress_bar.py[line:272] - INFO: epoch 001:   4718 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=381.3, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.449, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.4, ups=0.57, wpb=381.3, bsz=32, num_updates=4710, lr=8.86505e-06, gnorm=3.113, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9544
2022-05-08 23:28:14 - progress_bar.py[line:272] - INFO: epoch 001:   4728 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=379.3, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.327, expert1_balance_bottom=19.044, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.3, ups=0.58, wpb=379.3, bsz=32, num_updates=4720, lr=8.88387e-06, gnorm=3.409, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9562
2022-05-08 23:28:31 - progress_bar.py[line:272] - INFO: epoch 001:   4738 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=379.7, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.783, expert1_balance_bottom=19.107, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.3, ups=0.58, wpb=379.7, bsz=32, num_updates=4730, lr=8.90269e-06, gnorm=4.02, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9579
2022-05-08 23:28:48 - progress_bar.py[line:272] - INFO: epoch 001:   4748 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=384.1, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=35.035, expert1_balance_bottom=18.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.5, ups=0.58, wpb=384.1, bsz=32, num_updates=4740, lr=8.92151e-06, gnorm=3.327, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9596
2022-05-08 23:29:05 - progress_bar.py[line:272] - INFO: epoch 001:   4758 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=383, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=33.65, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.4, ups=0.58, wpb=383, bsz=32, num_updates=4750, lr=8.94034e-06, gnorm=3.427, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9613
2022-05-08 23:29:23 - progress_bar.py[line:272] - INFO: epoch 001:   4768 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=375.1, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884102, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.936, expert1_balance_bottom=18.753, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=217.5, ups=0.58, wpb=375.1, bsz=32, num_updates=4760, lr=8.95916e-06, gnorm=3.333, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9631
2022-05-08 23:29:40 - progress_bar.py[line:272] - INFO: epoch 001:   4778 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891493, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.195, expert1_balance_bottom=19.108, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221.4, ups=0.57, wpb=385.1, bsz=32, num_updates=4770, lr=8.97798e-06, gnorm=3.733, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9648
2022-05-08 23:29:57 - progress_bar.py[line:272] - INFO: epoch 001:   4788 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=382.3, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894099, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=33.935, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220.6, ups=0.58, wpb=382.3, bsz=32, num_updates=4780, lr=8.9968e-06, gnorm=3.614, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9665
2022-05-08 23:30:15 - progress_bar.py[line:272] - INFO: epoch 001:   4798 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894357, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.593, expert1_balance_bottom=18.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.9, ups=0.58, wpb=379.5, bsz=32, num_updates=4790, lr=9.01562e-06, gnorm=4.002, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9683
2022-05-08 23:30:32 - progress_bar.py[line:272] - INFO: epoch 001:   4808 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=375.9, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=34.094, expert1_balance_bottom=19.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216.3, ups=0.58, wpb=375.9, bsz=32, num_updates=4800, lr=9.03444e-06, gnorm=3.013, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9700
2022-05-08 23:30:50 - progress_bar.py[line:272] - INFO: epoch 001:   4818 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=386.4, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899252, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.205, expert1_balance_top=33.776, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.5, ups=0.57, wpb=386.4, bsz=32, num_updates=4810, lr=9.05327e-06, gnorm=3.201, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9718
2022-05-08 23:31:07 - progress_bar.py[line:272] - INFO: epoch 001:   4828 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=380.9, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.77, expert1_balance_bottom=19.004, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218.5, ups=0.57, wpb=380.9, bsz=32, num_updates=4820, lr=9.07209e-06, gnorm=3.396, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9735
2022-05-08 23:31:25 - progress_bar.py[line:272] - INFO: epoch 001:   4838 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=390, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.238, expert1_balance_bottom=19.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.5, ups=0.58, wpb=390, bsz=32, num_updates=4830, lr=9.09091e-06, gnorm=3.338, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9753
2022-05-08 23:31:42 - progress_bar.py[line:272] - INFO: epoch 001:   4848 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=35.181, expert1_balance_bottom=18.749, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.1, ups=0.57, wpb=380.8, bsz=32, num_updates=4840, lr=9.10973e-06, gnorm=3.917, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9770
2022-05-08 23:31:59 - progress_bar.py[line:272] - INFO: epoch 001:   4858 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884213, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.858, expert1_balance_bottom=18.88, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.5, ups=0.58, wpb=379.9, bsz=32, num_updates=4850, lr=9.12855e-06, gnorm=2.838, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9787
2022-05-08 23:32:17 - progress_bar.py[line:272] - INFO: epoch 001:   4868 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=397.5, nsentences=32, sample_size=316.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=35.04, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.8, ups=0.58, wpb=397.5, bsz=32, num_updates=4860, lr=9.14737e-06, gnorm=3.138, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9805
2022-05-08 23:32:34 - progress_bar.py[line:272] - INFO: epoch 001:   4878 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=378.8, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894169, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=33.721, expert1_balance_bottom=19.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219.7, ups=0.58, wpb=378.8, bsz=32, num_updates=4870, lr=9.1662e-06, gnorm=3.372, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9822
2022-05-08 23:32:51 - progress_bar.py[line:272] - INFO: epoch 001:   4888 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.333, expert1_balance_bottom=19.12, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.2, ups=0.58, wpb=381.2, bsz=32, num_updates=4880, lr=9.18502e-06, gnorm=3.432, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9839
2022-05-08 23:33:09 - progress_bar.py[line:272] - INFO: epoch 001:   4898 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=379.9, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=35.337, expert1_balance_bottom=18.738, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220.3, ups=0.58, wpb=379.9, bsz=32, num_updates=4890, lr=9.20384e-06, gnorm=3.65, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9857
2022-05-08 23:33:26 - progress_bar.py[line:272] - INFO: epoch 001:   4908 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.128, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.5, ups=0.57, wpb=382.3, bsz=32, num_updates=4900, lr=9.22266e-06, gnorm=2.885, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9874
2022-05-08 23:33:43 - progress_bar.py[line:272] - INFO: epoch 001:   4918 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877804, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.716, expert1_balance_bottom=19.19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.2, ups=0.58, wpb=383.8, bsz=32, num_updates=4910, lr=9.24148e-06, gnorm=3.376, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9891
2022-05-08 23:34:01 - progress_bar.py[line:272] - INFO: epoch 001:   4928 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=378.2, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=33.86, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.6, ups=0.58, wpb=378.2, bsz=32, num_updates=4920, lr=9.2603e-06, gnorm=3.456, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9909
2022-05-08 23:34:18 - progress_bar.py[line:272] - INFO: epoch 001:   4938 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=35.637, expert1_balance_bottom=18.541, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223.6, ups=0.58, wpb=386, bsz=32, num_updates=4930, lr=9.27913e-06, gnorm=3.566, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9926
2022-05-08 23:34:35 - progress_bar.py[line:272] - INFO: epoch 001:   4948 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=386.4, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887841, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.217, expert1_balance_bottom=19.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.9, ups=0.58, wpb=386.4, bsz=32, num_updates=4940, lr=9.29795e-06, gnorm=3.709, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9943
2022-05-08 23:34:53 - progress_bar.py[line:272] - INFO: epoch 001:   4958 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=384.8, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890906, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.061, expert1_balance_bottom=19.171, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.1, ups=0.57, wpb=384.8, bsz=32, num_updates=4950, lr=9.31677e-06, gnorm=3.641, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9961
2022-05-08 23:35:10 - progress_bar.py[line:272] - INFO: epoch 001:   4968 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882317, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.982, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216, ups=0.57, wpb=382.1, bsz=32, num_updates=4960, lr=9.33559e-06, gnorm=3.038, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9978
2022-05-08 23:35:28 - progress_bar.py[line:272] - INFO: epoch 001:   4978 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=387, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88437, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.537, expert1_balance_bottom=18.876, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.5, ups=0.55, wpb=387, bsz=32, num_updates=4970, lr=9.35441e-06, gnorm=3.219, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=9997
2022-05-08 23:35:47 - progress_bar.py[line:272] - INFO: epoch 001:   4988 / 17711 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=371.6, nsentences=32, sample_size=295.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894457, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.167, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.681, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=205.2, ups=0.55, wpb=371.6, bsz=32, num_updates=4980, lr=9.37324e-06, gnorm=4.028, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10015
2022-05-08 23:36:05 - progress_bar.py[line:272] - INFO: epoch 001:   4998 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880973, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.551, expert1_balance_bottom=19.144, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214, ups=0.56, wpb=385.1, bsz=32, num_updates=4990, lr=9.39206e-06, gnorm=3.161, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10033
2022-05-08 23:36:23 - progress_bar.py[line:272] - INFO: epoch 001:   5008 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.75, expert1_balance_bottom=19.035, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.9, ups=0.55, wpb=381, bsz=32, num_updates=5000, lr=9.41088e-06, gnorm=3.551, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10051
2022-05-08 23:36:23 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-08 23:36:23 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-08 23:36:23 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-08 23:43:53 - train.py[line:517] - INFO: valid_step finished
2022-05-08 23:43:53 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.464 | loss_v1 0 | loss_v2 0 | nll_loss 7.768 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.9697 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.464 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.25 | expert1_balance_top 35.656 | expert1_balance_bottom 14.795 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 217.9 | cider 1.176 | wps 669.8 | wpb 481.7 | bsz 8 | num_updates 5000
2022-05-08 23:43:53 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 1 @ 5000 updates
2022-05-08 23:43:53 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_5000-rank-0.pt
2022-05-08 23:43:53 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_5000-rank-0.pt
2022-05-08 23:44:00 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_5000-rank-0.pt
2022-05-08 23:44:01 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_5000-shared.pt
2022-05-08 23:44:09 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_5000-shared.pt
2022-05-08 23:44:23 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_5000-rank-0.pt (epoch 1 @ 5000 updates, score 1.176) (writing took 30.342798501253128 seconds)
2022-05-08 23:44:41 - progress_bar.py[line:272] - INFO: epoch 001:   5018 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=377.2, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.513, expert1_balance_bottom=19.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=7.6, ups=0.02, wpb=377.2, bsz=32, num_updates=5010, lr=9.4297e-06, gnorm=3.106, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10549
2022-05-08 23:44:59 - progress_bar.py[line:272] - INFO: epoch 001:   5028 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=383.2, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.53, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=210.3, ups=0.55, wpb=383.2, bsz=32, num_updates=5020, lr=9.44852e-06, gnorm=3.441, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10567
2022-05-08 23:45:17 - progress_bar.py[line:272] - INFO: epoch 001:   5038 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885326, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.651, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.7, ups=0.55, wpb=382.2, bsz=32, num_updates=5030, lr=9.46734e-06, gnorm=3.651, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10585
2022-05-08 23:45:35 - progress_bar.py[line:272] - INFO: epoch 001:   5048 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.465, expert1_balance_bottom=19.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213, ups=0.55, wpb=384.9, bsz=32, num_updates=5040, lr=9.48617e-06, gnorm=3.593, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10603
2022-05-08 23:45:53 - progress_bar.py[line:272] - INFO: epoch 001:   5058 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=377.3, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885777, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.356, expert1_balance_bottom=19.071, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=212.3, ups=0.56, wpb=377.3, bsz=32, num_updates=5050, lr=9.50499e-06, gnorm=3.796, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10621
2022-05-08 23:46:11 - progress_bar.py[line:272] - INFO: epoch 001:   5068 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.848, expert1_balance_bottom=18.973, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213, ups=0.56, wpb=379.2, bsz=32, num_updates=5060, lr=9.52381e-06, gnorm=3.802, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10639
2022-05-08 23:46:29 - progress_bar.py[line:272] - INFO: epoch 001:   5078 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=34.772, expert1_balance_bottom=19.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.2, ups=0.56, wpb=380, bsz=32, num_updates=5070, lr=9.54263e-06, gnorm=3.498, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10657
2022-05-08 23:46:47 - progress_bar.py[line:272] - INFO: epoch 001:   5088 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=391.5, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892318, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.202, expert1_balance_top=33.926, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=218.6, ups=0.56, wpb=391.5, bsz=32, num_updates=5080, lr=9.56145e-06, gnorm=3.265, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10675
2022-05-08 23:47:05 - progress_bar.py[line:272] - INFO: epoch 001:   5098 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=380.6, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895867, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.203, expert1_balance_top=33.955, expert1_balance_bottom=19.291, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.1, ups=0.55, wpb=380.6, bsz=32, num_updates=5090, lr=9.58027e-06, gnorm=3.422, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10693
2022-05-08 23:47:23 - progress_bar.py[line:272] - INFO: epoch 001:   5108 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=34.002, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=206.2, ups=0.55, wpb=377.9, bsz=32, num_updates=5100, lr=9.5991e-06, gnorm=3.171, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10711
2022-05-08 23:47:41 - progress_bar.py[line:272] - INFO: epoch 001:   5118 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.563, expert1_balance_bottom=18.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.8, ups=0.56, wpb=384.5, bsz=32, num_updates=5110, lr=9.61792e-06, gnorm=3.344, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10729
2022-05-08 23:47:59 - progress_bar.py[line:272] - INFO: epoch 001:   5128 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888476, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=33.831, expert1_balance_bottom=19.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.8, ups=0.56, wpb=388.1, bsz=32, num_updates=5120, lr=9.63674e-06, gnorm=3.498, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10747
2022-05-08 23:48:17 - progress_bar.py[line:272] - INFO: epoch 001:   5138 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=393.1, nsentences=32, sample_size=313.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.873, expert1_balance_bottom=18.988, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.9, ups=0.55, wpb=393.1, bsz=32, num_updates=5130, lr=9.65556e-06, gnorm=3.436, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10765
2022-05-08 23:48:35 - progress_bar.py[line:272] - INFO: epoch 001:   5148 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=392.9, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876941, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.752, expert1_balance_bottom=19.111, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=217.2, ups=0.55, wpb=392.9, bsz=32, num_updates=5140, lr=9.67438e-06, gnorm=3.381, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10783
2022-05-08 23:48:53 - progress_bar.py[line:272] - INFO: epoch 001:   5158 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=33.559, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=210.6, ups=0.55, wpb=385.3, bsz=32, num_updates=5150, lr=9.69321e-06, gnorm=3.051, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10801
2022-05-08 23:49:12 - progress_bar.py[line:272] - INFO: epoch 001:   5168 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=384.9, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882095, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.293, expert1_balance_bottom=19.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=208.7, ups=0.54, wpb=384.9, bsz=32, num_updates=5160, lr=9.71203e-06, gnorm=3.228, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10820
2022-05-08 23:49:30 - progress_bar.py[line:272] - INFO: epoch 001:   5178 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.187, expert1_balance_bottom=19.056, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212.3, ups=0.55, wpb=385.7, bsz=32, num_updates=5170, lr=9.73085e-06, gnorm=3.244, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10838
2022-05-08 23:49:48 - progress_bar.py[line:272] - INFO: epoch 001:   5188 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.525, expert1_balance_bottom=18.834, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209.5, ups=0.55, wpb=379.7, bsz=32, num_updates=5180, lr=9.74967e-06, gnorm=3.294, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10856
2022-05-08 23:50:06 - progress_bar.py[line:272] - INFO: epoch 001:   5198 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.957, ntokens=386.6, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=35.503, expert1_balance_bottom=18.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=213.6, ups=0.55, wpb=386.6, bsz=32, num_updates=5190, lr=9.76849e-06, gnorm=3.455, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10874
2022-05-08 23:50:24 - progress_bar.py[line:272] - INFO: epoch 001:   5208 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=388, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.156, expert1_balance_bottom=19.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=216.4, ups=0.56, wpb=388, bsz=32, num_updates=5200, lr=9.78731e-06, gnorm=3.491, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10892
2022-05-08 23:50:42 - progress_bar.py[line:272] - INFO: epoch 001:   5218 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=388.7, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.799, expert1_balance_bottom=19.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.8, ups=0.56, wpb=388.7, bsz=32, num_updates=5210, lr=9.80614e-06, gnorm=3.508, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10910
2022-05-08 23:51:00 - progress_bar.py[line:272] - INFO: epoch 001:   5228 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=379.7, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.262, expert1_balance_bottom=19.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.2, ups=0.56, wpb=379.7, bsz=32, num_updates=5220, lr=9.82496e-06, gnorm=3, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10928
2022-05-08 23:51:18 - progress_bar.py[line:272] - INFO: epoch 001:   5238 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=390.9, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=34.741, expert1_balance_bottom=18.751, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=216.8, ups=0.55, wpb=390.9, bsz=32, num_updates=5230, lr=9.84378e-06, gnorm=3.918, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10946
2022-05-08 23:51:36 - progress_bar.py[line:272] - INFO: epoch 001:   5248 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883021, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=34.472, expert1_balance_bottom=19.157, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.9, ups=0.56, wpb=375.5, bsz=32, num_updates=5240, lr=9.8626e-06, gnorm=3.355, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10964
2022-05-08 23:51:54 - progress_bar.py[line:272] - INFO: epoch 001:   5258 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=383.9, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.2, expert1_balance_top=34.174, expert1_balance_bottom=19.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.8, ups=0.55, wpb=383.9, bsz=32, num_updates=5250, lr=9.88142e-06, gnorm=3.423, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=10982
2022-05-08 23:52:12 - progress_bar.py[line:272] - INFO: epoch 001:   5268 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881583, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.744, expert1_balance_bottom=19.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.5, ups=0.56, wpb=379.2, bsz=32, num_updates=5260, lr=9.90024e-06, gnorm=3.959, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11000
2022-05-08 23:52:30 - progress_bar.py[line:272] - INFO: epoch 001:   5278 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=378.7, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=35.013, expert1_balance_bottom=18.866, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=209.8, ups=0.55, wpb=378.7, bsz=32, num_updates=5270, lr=9.91907e-06, gnorm=3.475, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11018
2022-05-08 23:52:48 - progress_bar.py[line:272] - INFO: epoch 001:   5288 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=389.8, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.959, expert1_balance_bottom=18.85, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=216.1, ups=0.55, wpb=389.8, bsz=32, num_updates=5280, lr=9.93789e-06, gnorm=3.302, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11036
2022-05-08 23:53:06 - progress_bar.py[line:272] - INFO: epoch 001:   5298 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=387.6, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885314, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.299, expert1_balance_bottom=19.068, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.2, ups=0.56, wpb=387.6, bsz=32, num_updates=5290, lr=9.95671e-06, gnorm=3.037, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11054
2022-05-08 23:53:23 - progress_bar.py[line:272] - INFO: epoch 001:   5308 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=386, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.466, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=220.6, ups=0.57, wpb=386, bsz=32, num_updates=5300, lr=9.97553e-06, gnorm=3.424, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11071
2022-05-08 23:53:41 - progress_bar.py[line:272] - INFO: epoch 001:   5318 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.258, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=217.1, ups=0.56, wpb=384.8, bsz=32, num_updates=5310, lr=9.99435e-06, gnorm=3.577, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11089
2022-05-08 23:53:59 - progress_bar.py[line:272] - INFO: epoch 001:   5328 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875551, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.881, expert1_balance_bottom=18.841, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.7, ups=0.55, wpb=385.5, bsz=32, num_updates=5320, lr=9.99916e-06, gnorm=3.258, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11107
2022-05-08 23:54:17 - progress_bar.py[line:272] - INFO: epoch 001:   5338 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893758, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=33.853, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216, ups=0.56, wpb=384.8, bsz=32, num_updates=5330, lr=9.99796e-06, gnorm=3.1, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11125
2022-05-08 23:54:35 - progress_bar.py[line:272] - INFO: epoch 001:   5348 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887066, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=34.589, expert1_balance_bottom=18.948, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=208.9, ups=0.55, wpb=377.1, bsz=32, num_updates=5340, lr=9.99676e-06, gnorm=2.84, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11143
2022-05-08 23:54:53 - progress_bar.py[line:272] - INFO: epoch 001:   5358 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=370.4, nsentences=32, sample_size=294.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=34.279, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=204.1, ups=0.55, wpb=370.4, bsz=32, num_updates=5350, lr=9.99556e-06, gnorm=3.693, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11161
2022-05-08 23:55:11 - progress_bar.py[line:272] - INFO: epoch 001:   5368 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=389.5, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=35.1, expert1_balance_bottom=18.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.5, ups=0.57, wpb=389.5, bsz=32, num_updates=5360, lr=9.99435e-06, gnorm=3.23, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11179
2022-05-08 23:55:28 - progress_bar.py[line:272] - INFO: epoch 001:   5378 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=386.1, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878182, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=35.181, expert1_balance_bottom=18.78, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.1, ups=0.57, wpb=386.1, bsz=32, num_updates=5370, lr=9.99315e-06, gnorm=3.715, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11196
2022-05-08 23:55:46 - progress_bar.py[line:272] - INFO: epoch 001:   5388 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890449, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=33.888, expert1_balance_bottom=19.107, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.4, ups=0.56, wpb=379.3, bsz=32, num_updates=5380, lr=9.99195e-06, gnorm=3.256, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11214
2022-05-08 23:56:04 - progress_bar.py[line:272] - INFO: epoch 001:   5398 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=391, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=35.288, expert1_balance_bottom=18.797, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.2, ups=0.56, wpb=391, bsz=32, num_updates=5390, lr=9.99075e-06, gnorm=3.389, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11232
2022-05-08 23:56:22 - progress_bar.py[line:272] - INFO: epoch 001:   5408 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=386.7, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885359, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.453, expert1_balance_bottom=19.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.1, ups=0.56, wpb=386.7, bsz=32, num_updates=5400, lr=9.98955e-06, gnorm=2.965, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11250
2022-05-08 23:56:40 - progress_bar.py[line:272] - INFO: epoch 001:   5418 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=376.9, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894359, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=33.833, expert1_balance_bottom=19.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=205.5, ups=0.55, wpb=376.9, bsz=32, num_updates=5410, lr=9.98835e-06, gnorm=3.931, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11268
2022-05-08 23:56:59 - progress_bar.py[line:272] - INFO: epoch 001:   5428 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887479, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=33.83, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211, ups=0.55, wpb=382.6, bsz=32, num_updates=5420, lr=9.98715e-06, gnorm=3.079, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11287
2022-05-08 23:57:16 - progress_bar.py[line:272] - INFO: epoch 001:   5438 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.198, expert1_balance_bottom=19.157, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.1, ups=0.56, wpb=385.7, bsz=32, num_updates=5430, lr=9.98594e-06, gnorm=3.204, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11305
2022-05-08 23:57:34 - progress_bar.py[line:272] - INFO: epoch 001:   5448 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=388, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883181, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.394, expert1_balance_bottom=19.037, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.6, ups=0.56, wpb=388, bsz=32, num_updates=5440, lr=9.98474e-06, gnorm=3.354, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11323
2022-05-08 23:57:53 - progress_bar.py[line:272] - INFO: epoch 001:   5458 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=386.5, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=33.849, expert1_balance_bottom=19.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.4, ups=0.55, wpb=386.5, bsz=32, num_updates=5450, lr=9.98354e-06, gnorm=3.505, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11341
2022-05-08 23:58:11 - progress_bar.py[line:272] - INFO: epoch 001:   5468 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=384.9, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88131, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.366, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.3, ups=0.55, wpb=384.9, bsz=32, num_updates=5460, lr=9.98234e-06, gnorm=3.174, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11359
2022-05-08 23:58:29 - progress_bar.py[line:272] - INFO: epoch 001:   5478 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=384.4, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888749, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.361, expert1_balance_bottom=19.213, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.7, ups=0.56, wpb=384.4, bsz=32, num_updates=5470, lr=9.98114e-06, gnorm=3.378, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11377
2022-05-08 23:58:47 - progress_bar.py[line:272] - INFO: epoch 001:   5488 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=387.6, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=35.105, expert1_balance_bottom=18.786, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.6, ups=0.55, wpb=387.6, bsz=32, num_updates=5480, lr=9.97994e-06, gnorm=3.452, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11395
2022-05-08 23:59:05 - progress_bar.py[line:272] - INFO: epoch 001:   5498 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876553, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=35.071, expert1_balance_bottom=18.886, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.9, ups=0.56, wpb=382.3, bsz=32, num_updates=5490, lr=9.97874e-06, gnorm=3.281, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11413
2022-05-08 23:59:23 - progress_bar.py[line:272] - INFO: epoch 001:   5508 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.223, expert1_balance_bottom=19.143, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214, ups=0.56, wpb=380.8, bsz=32, num_updates=5500, lr=9.97754e-06, gnorm=3.431, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11431
2022-05-08 23:59:40 - progress_bar.py[line:272] - INFO: epoch 001:   5518 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878417, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.79, expert1_balance_bottom=18.862, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.4, ups=0.56, wpb=384.3, bsz=32, num_updates=5510, lr=9.97633e-06, gnorm=3.579, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11448
2022-05-08 23:59:58 - progress_bar.py[line:272] - INFO: epoch 001:   5528 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.98, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873112, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.763, expert1_balance_bottom=18.912, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=213.5, ups=0.55, wpb=386.3, bsz=32, num_updates=5520, lr=9.97513e-06, gnorm=3.732, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11467
2022-05-09 00:00:16 - progress_bar.py[line:272] - INFO: epoch 001:   5538 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=389.7, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881432, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.552, expert1_balance_bottom=18.941, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221.2, ups=0.57, wpb=389.7, bsz=32, num_updates=5530, lr=9.97393e-06, gnorm=3.305, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11484
2022-05-09 00:00:34 - progress_bar.py[line:272] - INFO: epoch 001:   5548 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=389.9, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.721, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=223.6, ups=0.57, wpb=389.9, bsz=32, num_updates=5540, lr=9.97273e-06, gnorm=3.524, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11502
2022-05-09 00:00:52 - progress_bar.py[line:272] - INFO: epoch 001:   5558 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=392.5, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88633, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.115, expert1_balance_bottom=19.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217.4, ups=0.55, wpb=392.5, bsz=32, num_updates=5550, lr=9.97153e-06, gnorm=3.391, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11520
2022-05-09 00:01:10 - progress_bar.py[line:272] - INFO: epoch 001:   5568 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=376.5, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892205, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=33.601, expert1_balance_bottom=19.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.1, ups=0.55, wpb=376.5, bsz=32, num_updates=5560, lr=9.97033e-06, gnorm=3.193, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11538
2022-05-09 00:01:23 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-09 00:01:30 - progress_bar.py[line:272] - INFO: epoch 001:   5579 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884599, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.81, expert1_balance_bottom=18.763, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=192.6, ups=0.5, wpb=383.9, bsz=32, num_updates=5570, lr=9.96913e-06, gnorm=3.189, loss_scale=128, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11558
2022-05-09 00:01:48 - progress_bar.py[line:272] - INFO: epoch 001:   5589 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=376.3, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=33.921, expert1_balance_bottom=19.096, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.9, ups=0.56, wpb=376.3, bsz=32, num_updates=5580, lr=9.96792e-06, gnorm=3.192, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11576
2022-05-09 00:02:06 - progress_bar.py[line:272] - INFO: epoch 001:   5599 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=382.8, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.205, expert1_balance_bottom=19.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.5, ups=0.56, wpb=382.8, bsz=32, num_updates=5590, lr=9.96672e-06, gnorm=2.914, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11594
2022-05-09 00:02:24 - progress_bar.py[line:272] - INFO: epoch 001:   5609 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=386.2, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870234, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=35.238, expert1_balance_bottom=18.748, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210, ups=0.54, wpb=386.2, bsz=32, num_updates=5600, lr=9.96552e-06, gnorm=3.632, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11612
2022-05-09 00:02:42 - progress_bar.py[line:272] - INFO: epoch 001:   5619 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.079, expert1_balance_bottom=19.191, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.8, ups=0.55, wpb=385.7, bsz=32, num_updates=5610, lr=9.96432e-06, gnorm=3.159, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11630
2022-05-09 00:03:00 - progress_bar.py[line:272] - INFO: epoch 001:   5629 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877974, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.655, expert1_balance_bottom=19.009, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.9, ups=0.55, wpb=382.5, bsz=32, num_updates=5620, lr=9.96312e-06, gnorm=3.249, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11648
2022-05-09 00:03:18 - progress_bar.py[line:272] - INFO: epoch 001:   5639 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=390.1, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=33.931, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.4, ups=0.55, wpb=390.1, bsz=32, num_updates=5630, lr=9.96192e-06, gnorm=3.212, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11666
2022-05-09 00:03:37 - progress_bar.py[line:272] - INFO: epoch 001:   5649 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=378.7, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=33.715, expert1_balance_bottom=19.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=207.2, ups=0.55, wpb=378.7, bsz=32, num_updates=5640, lr=9.96072e-06, gnorm=3.493, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11685
2022-05-09 00:03:55 - progress_bar.py[line:272] - INFO: epoch 001:   5659 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=378.9, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.716, expert1_balance_bottom=18.841, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=207.7, ups=0.55, wpb=378.9, bsz=32, num_updates=5650, lr=9.95952e-06, gnorm=3.41, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11703
2022-05-09 00:04:13 - progress_bar.py[line:272] - INFO: epoch 001:   5669 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=376.3, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=33.953, expert1_balance_bottom=19.112, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=210.9, ups=0.56, wpb=376.3, bsz=32, num_updates=5660, lr=9.95831e-06, gnorm=3.395, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11721
2022-05-09 00:04:31 - progress_bar.py[line:272] - INFO: epoch 001:   5679 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=391, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894752, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=33.943, expert1_balance_bottom=19.104, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.8, ups=0.55, wpb=391, bsz=32, num_updates=5670, lr=9.95711e-06, gnorm=3.337, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11739
2022-05-09 00:04:49 - progress_bar.py[line:272] - INFO: epoch 001:   5689 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=374.7, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885957, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.91, expert1_balance_bottom=19.013, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=205, ups=0.55, wpb=374.7, bsz=32, num_updates=5680, lr=9.95591e-06, gnorm=3.045, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11757
2022-05-09 00:05:08 - progress_bar.py[line:272] - INFO: epoch 001:   5699 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88073, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=35.111, expert1_balance_bottom=18.82, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.7, ups=0.55, wpb=383.3, bsz=32, num_updates=5690, lr=9.95471e-06, gnorm=3.698, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11776
2022-05-09 00:05:26 - progress_bar.py[line:272] - INFO: epoch 001:   5709 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=376, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=34.61, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=204.8, ups=0.54, wpb=376, bsz=32, num_updates=5700, lr=9.95351e-06, gnorm=3.225, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11794
2022-05-09 00:05:44 - progress_bar.py[line:272] - INFO: epoch 001:   5719 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=377.6, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888078, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=34.431, expert1_balance_bottom=18.969, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=212.8, ups=0.56, wpb=377.6, bsz=32, num_updates=5710, lr=9.95231e-06, gnorm=3.532, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11812
2022-05-09 00:06:02 - progress_bar.py[line:272] - INFO: epoch 001:   5729 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=387.2, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=35.237, expert1_balance_bottom=18.752, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.4, ups=0.55, wpb=387.2, bsz=32, num_updates=5720, lr=9.95111e-06, gnorm=3.024, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11830
2022-05-09 00:06:20 - progress_bar.py[line:272] - INFO: epoch 001:   5739 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=376.2, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.484, expert1_balance_bottom=18.879, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.9, ups=0.56, wpb=376.2, bsz=32, num_updates=5730, lr=9.94991e-06, gnorm=3.21, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11848
2022-05-09 00:06:37 - progress_bar.py[line:272] - INFO: epoch 001:   5749 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=384.6, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897834, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.201, expert1_balance_top=33.826, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=216.5, ups=0.56, wpb=384.6, bsz=32, num_updates=5740, lr=9.9487e-06, gnorm=3.442, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11865
2022-05-09 00:06:55 - progress_bar.py[line:272] - INFO: epoch 001:   5759 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=380.9, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.449, expert1_balance_bottom=18.963, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.8, ups=0.56, wpb=380.9, bsz=32, num_updates=5750, lr=9.9475e-06, gnorm=3.435, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11883
2022-05-09 00:07:13 - progress_bar.py[line:272] - INFO: epoch 001:   5769 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=379.8, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=33.374, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.9, ups=0.56, wpb=379.8, bsz=32, num_updates=5760, lr=9.9463e-06, gnorm=3.54, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11901
2022-05-09 00:07:31 - progress_bar.py[line:272] - INFO: epoch 001:   5779 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=375.1, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89075, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=33.898, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=207.2, ups=0.55, wpb=375.1, bsz=32, num_updates=5770, lr=9.9451e-06, gnorm=3.63, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11919
2022-05-09 00:07:49 - progress_bar.py[line:272] - INFO: epoch 001:   5789 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=33.718, expert1_balance_bottom=19.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=211.3, ups=0.55, wpb=382.3, bsz=32, num_updates=5780, lr=9.9439e-06, gnorm=3.268, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11938
2022-05-09 00:08:07 - progress_bar.py[line:272] - INFO: epoch 001:   5799 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=386.1, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=35.201, expert1_balance_bottom=18.855, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=214.6, ups=0.56, wpb=386.1, bsz=32, num_updates=5790, lr=9.9427e-06, gnorm=3.41, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11956
2022-05-09 00:08:25 - progress_bar.py[line:272] - INFO: epoch 001:   5809 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=375.4, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.401, expert1_balance_bottom=18.871, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.5, ups=0.56, wpb=375.4, bsz=32, num_updates=5800, lr=9.9415e-06, gnorm=3.325, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11973
2022-05-09 00:08:38 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 00:08:45 - progress_bar.py[line:272] - INFO: epoch 001:   5820 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=377.6, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89381, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=34.002, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=190.6, ups=0.5, wpb=377.6, bsz=32, num_updates=5810, lr=9.94029e-06, gnorm=2.879, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=11993
2022-05-09 00:09:03 - progress_bar.py[line:272] - INFO: epoch 001:   5830 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=33.348, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=210.9, ups=0.56, wpb=379.7, bsz=32, num_updates=5820, lr=9.93909e-06, gnorm=3.742, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12011
2022-05-09 00:09:21 - progress_bar.py[line:272] - INFO: epoch 001:   5840 / 17711 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=383.7, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.182, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.825, expert1_balance_bottom=18.541, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=214.3, ups=0.56, wpb=383.7, bsz=32, num_updates=5830, lr=9.93789e-06, gnorm=4.297, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12029
2022-05-09 00:09:39 - progress_bar.py[line:272] - INFO: epoch 001:   5850 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=389.1, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.45, expert1_balance_bottom=18.98, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=214, ups=0.55, wpb=389.1, bsz=32, num_updates=5840, lr=9.93669e-06, gnorm=3.803, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12047
2022-05-09 00:09:57 - progress_bar.py[line:272] - INFO: epoch 001:   5860 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=34.299, expert1_balance_bottom=19.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.3, ups=0.55, wpb=381.6, bsz=32, num_updates=5850, lr=9.93549e-06, gnorm=3.21, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12065
2022-05-09 00:10:15 - progress_bar.py[line:272] - INFO: epoch 001:   5870 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=373.2, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.866, expert1_balance_bottom=18.883, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.2, ups=0.56, wpb=373.2, bsz=32, num_updates=5860, lr=9.93429e-06, gnorm=3.853, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12083
2022-05-09 00:10:33 - progress_bar.py[line:272] - INFO: epoch 001:   5880 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.758, expert1_balance_bottom=18.857, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.5, ups=0.56, wpb=384.9, bsz=32, num_updates=5870, lr=9.93309e-06, gnorm=3.03, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12101
2022-05-09 00:10:51 - progress_bar.py[line:272] - INFO: epoch 001:   5890 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=376.8, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894317, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.029, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=210.9, ups=0.56, wpb=376.8, bsz=32, num_updates=5880, lr=9.93189e-06, gnorm=3.528, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12119
2022-05-09 00:11:09 - progress_bar.py[line:272] - INFO: epoch 001:   5900 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879489, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=35.062, expert1_balance_bottom=18.971, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.1, ups=0.56, wpb=381.3, bsz=32, num_updates=5890, lr=9.93068e-06, gnorm=3.92, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12137
2022-05-09 00:11:27 - progress_bar.py[line:272] - INFO: epoch 001:   5910 / 17711 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.974, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.188, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=34.283, expert1_balance_bottom=19.175, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=209.9, ups=0.56, wpb=377.4, bsz=32, num_updates=5900, lr=9.92948e-06, gnorm=4.168, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12155
2022-05-09 00:11:44 - progress_bar.py[line:272] - INFO: epoch 001:   5920 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.359, expert1_balance_bottom=19.227, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=217.7, ups=0.56, wpb=386.8, bsz=32, num_updates=5910, lr=9.92828e-06, gnorm=3.773, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12172
2022-05-09 00:12:02 - progress_bar.py[line:272] - INFO: epoch 001:   5930 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.198, expert1_balance_top=33.827, expert1_balance_bottom=19.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.7, ups=0.55, wpb=382.1, bsz=32, num_updates=5920, lr=9.92708e-06, gnorm=3.915, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12190
2022-05-09 00:12:21 - progress_bar.py[line:272] - INFO: epoch 001:   5940 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=380.4, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87898, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.548, expert1_balance_bottom=19.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=208.3, ups=0.55, wpb=380.4, bsz=32, num_updates=5930, lr=9.92588e-06, gnorm=3.703, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12209
2022-05-09 00:12:39 - progress_bar.py[line:272] - INFO: epoch 001:   5950 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=387.6, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=35.299, expert1_balance_bottom=18.953, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.4, ups=0.55, wpb=387.6, bsz=32, num_updates=5940, lr=9.92468e-06, gnorm=3.157, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12227
2022-05-09 00:12:56 - progress_bar.py[line:272] - INFO: epoch 001:   5960 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=383.5, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.325, expert1_balance_bottom=19.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.2, ups=0.57, wpb=383.5, bsz=32, num_updates=5950, lr=9.92348e-06, gnorm=3.289, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12244
2022-05-09 00:13:14 - progress_bar.py[line:272] - INFO: epoch 001:   5970 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888704, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=34.395, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=212.2, ups=0.56, wpb=381.2, bsz=32, num_updates=5960, lr=9.92227e-06, gnorm=3.421, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12262
2022-05-09 00:13:33 - progress_bar.py[line:272] - INFO: epoch 001:   5980 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883179, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.523, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206.9, ups=0.54, wpb=381.6, bsz=32, num_updates=5970, lr=9.92107e-06, gnorm=3.08, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12281
2022-05-09 00:13:51 - progress_bar.py[line:272] - INFO: epoch 001:   5990 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=389.9, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.501, expert1_balance_bottom=19.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.4, ups=0.56, wpb=389.9, bsz=32, num_updates=5980, lr=9.91987e-06, gnorm=3.495, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12299
2022-05-09 00:14:09 - progress_bar.py[line:272] - INFO: epoch 001:   6000 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=376.6, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880104, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.907, expert1_balance_bottom=18.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.2, ups=0.56, wpb=376.6, bsz=32, num_updates=5990, lr=9.91867e-06, gnorm=3.203, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12317
2022-05-09 00:14:26 - progress_bar.py[line:272] - INFO: epoch 001:   6010 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=388.5, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.222, expert1_balance_bottom=19.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.8, ups=0.57, wpb=388.5, bsz=32, num_updates=6000, lr=9.91747e-06, gnorm=3.372, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12334
2022-05-09 00:14:26 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 00:14:27 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 00:14:27 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 00:21:49 - train.py[line:517] - INFO: valid_step finished
2022-05-09 00:21:49 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.477 | loss_v1 0 | loss_v2 0 | nll_loss 7.782 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.97317 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.477 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.245 | expert1_balance_top 35.773 | expert1_balance_bottom 14.879 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 220.05 | cider 1.197 | wps 681 | wpb 481.7 | bsz 8 | num_updates 6000 | best_cider 1.197
2022-05-09 00:22:07 - progress_bar.py[line:272] - INFO: epoch 001:   6020 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.509, expert1_balance_bottom=19.041, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=8.3, ups=0.02, wpb=383.3, bsz=32, num_updates=6010, lr=9.91627e-06, gnorm=3.077, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12795
2022-05-09 00:22:25 - progress_bar.py[line:272] - INFO: epoch 001:   6030 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=378.7, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883565, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.541, expert1_balance_bottom=19.053, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.6, ups=0.56, wpb=378.7, bsz=32, num_updates=6020, lr=9.91507e-06, gnorm=3.774, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12813
2022-05-09 00:22:43 - progress_bar.py[line:272] - INFO: epoch 001:   6040 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=385.7, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882873, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.759, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.2, ups=0.55, wpb=385.7, bsz=32, num_updates=6030, lr=9.91387e-06, gnorm=3.495, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12831
2022-05-09 00:23:01 - progress_bar.py[line:272] - INFO: epoch 001:   6050 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.645, expert1_balance_bottom=19.013, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.3, ups=0.56, wpb=382.6, bsz=32, num_updates=6040, lr=9.91266e-06, gnorm=3.39, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12849
2022-05-09 00:23:19 - progress_bar.py[line:272] - INFO: epoch 001:   6060 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=390.7, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.707, expert1_balance_bottom=18.882, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=218.5, ups=0.56, wpb=390.7, bsz=32, num_updates=6050, lr=9.91146e-06, gnorm=4.109, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12867
2022-05-09 00:23:37 - progress_bar.py[line:272] - INFO: epoch 001:   6070 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.898, expert1_balance_bottom=18.953, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.8, ups=0.55, wpb=383.2, bsz=32, num_updates=6060, lr=9.91026e-06, gnorm=3.131, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12885
2022-05-09 00:23:56 - progress_bar.py[line:272] - INFO: epoch 001:   6080 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=35.297, expert1_balance_bottom=18.792, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=208.6, ups=0.54, wpb=385.7, bsz=32, num_updates=6070, lr=9.90906e-06, gnorm=3.02, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12904
2022-05-09 00:24:14 - progress_bar.py[line:272] - INFO: epoch 001:   6090 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=35.261, expert1_balance_bottom=18.85, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=212.2, ups=0.55, wpb=385.5, bsz=32, num_updates=6080, lr=9.90786e-06, gnorm=2.948, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12922
2022-05-09 00:24:32 - progress_bar.py[line:272] - INFO: epoch 001:   6100 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=379.1, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.199, expert1_balance_top=33.744, expert1_balance_bottom=19.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=211.3, ups=0.56, wpb=379.1, bsz=32, num_updates=6090, lr=9.90666e-06, gnorm=3.101, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12940
2022-05-09 00:24:50 - progress_bar.py[line:272] - INFO: epoch 001:   6110 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889401, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.486, expert1_balance_bottom=18.945, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.1, ups=0.56, wpb=376.7, bsz=32, num_updates=6100, lr=9.90546e-06, gnorm=3.337, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12958
2022-05-09 00:25:08 - progress_bar.py[line:272] - INFO: epoch 001:   6120 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=373, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8898, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=34.18, expert1_balance_bottom=19.083, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=205.5, ups=0.55, wpb=373, bsz=32, num_updates=6110, lr=9.90426e-06, gnorm=3.679, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12976
2022-05-09 00:25:26 - progress_bar.py[line:272] - INFO: epoch 001:   6130 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=375.5, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.02, expert1_balance_bottom=19.285, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=205.3, ups=0.55, wpb=375.5, bsz=32, num_updates=6120, lr=9.90305e-06, gnorm=3.475, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=12994
2022-05-09 00:25:44 - progress_bar.py[line:272] - INFO: epoch 001:   6140 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880068, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.757, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.9, ups=0.55, wpb=383.2, bsz=32, num_updates=6130, lr=9.90185e-06, gnorm=3.122, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13012
2022-05-09 00:26:02 - progress_bar.py[line:272] - INFO: epoch 001:   6150 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=370.6, nsentences=32, sample_size=294.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=33.774, expert1_balance_bottom=19.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.6, ups=0.57, wpb=370.6, bsz=32, num_updates=6140, lr=9.90065e-06, gnorm=3.529, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13030
2022-05-09 00:26:20 - progress_bar.py[line:272] - INFO: epoch 001:   6160 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885622, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.398, expert1_balance_bottom=19.145, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=209.5, ups=0.55, wpb=379.3, bsz=32, num_updates=6150, lr=9.89945e-06, gnorm=3.145, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13048
2022-05-09 00:26:38 - progress_bar.py[line:272] - INFO: epoch 001:   6170 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=33.8, expert1_balance_bottom=19.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209.3, ups=0.55, wpb=378.4, bsz=32, num_updates=6160, lr=9.89825e-06, gnorm=3.507, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13066
2022-05-09 00:26:56 - progress_bar.py[line:272] - INFO: epoch 001:   6180 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=387.5, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=34.977, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=212.7, ups=0.55, wpb=387.5, bsz=32, num_updates=6170, lr=9.89705e-06, gnorm=3.798, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13084
2022-05-09 00:27:15 - progress_bar.py[line:272] - INFO: epoch 001:   6190 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883235, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.575, expert1_balance_bottom=18.98, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=208.8, ups=0.55, wpb=381.9, bsz=32, num_updates=6180, lr=9.89585e-06, gnorm=3.49, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13103
2022-05-09 00:27:33 - progress_bar.py[line:272] - INFO: epoch 001:   6200 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88254, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.71, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.9, ups=0.55, wpb=382.7, bsz=32, num_updates=6190, lr=9.89464e-06, gnorm=3.19, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13121
2022-05-09 00:27:51 - progress_bar.py[line:272] - INFO: epoch 001:   6210 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383.6, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887785, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.148, expert1_balance_bottom=19.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212.7, ups=0.55, wpb=383.6, bsz=32, num_updates=6200, lr=9.89344e-06, gnorm=3.266, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13139
2022-05-09 00:28:09 - progress_bar.py[line:272] - INFO: epoch 001:   6220 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=392.8, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=35.391, expert1_balance_bottom=18.779, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215, ups=0.55, wpb=392.8, bsz=32, num_updates=6210, lr=9.89224e-06, gnorm=3.629, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13157
2022-05-09 00:28:27 - progress_bar.py[line:272] - INFO: epoch 001:   6230 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894467, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=34.436, expert1_balance_bottom=19.164, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.2, ups=0.56, wpb=380.5, bsz=32, num_updates=6220, lr=9.89104e-06, gnorm=3.472, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13175
2022-05-09 00:28:45 - progress_bar.py[line:272] - INFO: epoch 001:   6240 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.521, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217.1, ups=0.56, wpb=388.2, bsz=32, num_updates=6230, lr=9.88984e-06, gnorm=3.92, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13193
2022-05-09 00:29:03 - progress_bar.py[line:272] - INFO: epoch 001:   6250 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=380.6, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900476, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=33.669, expert1_balance_bottom=19.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214.4, ups=0.56, wpb=380.6, bsz=32, num_updates=6240, lr=9.88864e-06, gnorm=3.379, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13211
2022-05-09 00:29:21 - progress_bar.py[line:272] - INFO: epoch 001:   6260 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.614, expert1_balance_bottom=18.912, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.8, ups=0.56, wpb=382.5, bsz=32, num_updates=6250, lr=9.88744e-06, gnorm=4.141, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13229
2022-05-09 00:29:39 - progress_bar.py[line:272] - INFO: epoch 001:   6270 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=389.1, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88214, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.324, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.7, ups=0.56, wpb=389.1, bsz=32, num_updates=6260, lr=9.88624e-06, gnorm=3.273, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13247
2022-05-09 00:29:57 - progress_bar.py[line:272] - INFO: epoch 001:   6280 / 17711 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=385.1, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881136, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.184, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.456, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=214.4, ups=0.56, wpb=385.1, bsz=32, num_updates=6270, lr=9.88503e-06, gnorm=4.04, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13265
2022-05-09 00:30:14 - progress_bar.py[line:272] - INFO: epoch 001:   6290 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=379.4, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=34.001, expert1_balance_bottom=19.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.5, ups=0.56, wpb=379.4, bsz=32, num_updates=6280, lr=9.88383e-06, gnorm=3.398, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13282
2022-05-09 00:30:32 - progress_bar.py[line:272] - INFO: epoch 001:   6300 / 17711 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.163, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=33.653, expert1_balance_bottom=19.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=212.2, ups=0.55, wpb=382.3, bsz=32, num_updates=6290, lr=9.88263e-06, gnorm=3.624, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13300
2022-05-09 00:30:50 - progress_bar.py[line:272] - INFO: epoch 001:   6310 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=34.476, expert1_balance_bottom=18.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=211.4, ups=0.55, wpb=383.7, bsz=32, num_updates=6300, lr=9.88143e-06, gnorm=3.915, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13319
2022-05-09 00:31:09 - progress_bar.py[line:272] - INFO: epoch 001:   6320 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902911, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.197, expert1_balance_top=33.778, expert1_balance_bottom=19.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=212.9, ups=0.55, wpb=386, bsz=32, num_updates=6310, lr=9.88023e-06, gnorm=3.433, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13337
2022-05-09 00:31:27 - progress_bar.py[line:272] - INFO: epoch 001:   6330 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89127, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.491, expert1_balance_bottom=19.123, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.7, ups=0.55, wpb=385.3, bsz=32, num_updates=6320, lr=9.87903e-06, gnorm=3.371, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13355
2022-05-09 00:31:44 - progress_bar.py[line:272] - INFO: epoch 001:   6340 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=373.2, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.471, expert1_balance_bottom=18.995, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.7, ups=0.56, wpb=373.2, bsz=32, num_updates=6330, lr=9.87783e-06, gnorm=3.205, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13372
2022-05-09 00:32:02 - progress_bar.py[line:272] - INFO: epoch 001:   6350 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=391.3, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879168, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=35.239, expert1_balance_bottom=18.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220, ups=0.56, wpb=391.3, bsz=32, num_updates=6340, lr=9.87662e-06, gnorm=4.153, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13390
2022-05-09 00:32:20 - progress_bar.py[line:272] - INFO: epoch 001:   6360 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=385.3, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=33.742, expert1_balance_bottom=19.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.5, ups=0.56, wpb=385.3, bsz=32, num_updates=6350, lr=9.87542e-06, gnorm=4.087, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13408
2022-05-09 00:32:38 - progress_bar.py[line:272] - INFO: epoch 001:   6370 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=34.703, expert1_balance_bottom=19.017, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.4, ups=0.55, wpb=382.4, bsz=32, num_updates=6360, lr=9.87422e-06, gnorm=3.037, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13426
2022-05-09 00:32:56 - progress_bar.py[line:272] - INFO: epoch 001:   6380 / 17711 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=382.3, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.185, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=33.926, expert1_balance_bottom=19.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=209.8, ups=0.55, wpb=382.3, bsz=32, num_updates=6370, lr=9.87302e-06, gnorm=3.481, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13444
2022-05-09 00:33:15 - progress_bar.py[line:272] - INFO: epoch 001:   6390 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=374.1, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890514, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=34.352, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=206.3, ups=0.55, wpb=374.1, bsz=32, num_updates=6380, lr=9.87182e-06, gnorm=3.774, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13463
2022-05-09 00:33:33 - progress_bar.py[line:272] - INFO: epoch 001:   6400 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868959, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=35.668, expert1_balance_bottom=18.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=210.2, ups=0.55, wpb=384.7, bsz=32, num_updates=6390, lr=9.87062e-06, gnorm=3.681, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13481
2022-05-09 00:33:51 - progress_bar.py[line:272] - INFO: epoch 001:   6410 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889053, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.152, expert1_balance_bottom=19.146, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.7, ups=0.56, wpb=383.2, bsz=32, num_updates=6400, lr=9.86942e-06, gnorm=3.188, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13499
2022-05-09 00:34:09 - progress_bar.py[line:272] - INFO: epoch 001:   6420 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897968, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=33.783, expert1_balance_bottom=19.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=209.4, ups=0.55, wpb=377.5, bsz=32, num_updates=6410, lr=9.86822e-06, gnorm=3.215, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13517
2022-05-09 00:34:27 - progress_bar.py[line:272] - INFO: epoch 001:   6430 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=34.476, expert1_balance_bottom=19.238, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216, ups=0.56, wpb=384.4, bsz=32, num_updates=6420, lr=9.86701e-06, gnorm=3.405, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13535
2022-05-09 00:34:45 - progress_bar.py[line:272] - INFO: epoch 001:   6440 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=377.7, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888992, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.418, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=208.9, ups=0.55, wpb=377.7, bsz=32, num_updates=6430, lr=9.86581e-06, gnorm=3.689, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13553
2022-05-09 00:35:03 - progress_bar.py[line:272] - INFO: epoch 001:   6450 / 17711 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=387.1, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869783, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.155, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=35.443, expert1_balance_bottom=18.803, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=210.9, ups=0.54, wpb=387.1, bsz=32, num_updates=6440, lr=9.86461e-06, gnorm=3.315, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13571
2022-05-09 00:35:21 - progress_bar.py[line:272] - INFO: epoch 001:   6460 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=387.7, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=35.317, expert1_balance_bottom=18.759, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.2, ups=0.55, wpb=387.7, bsz=32, num_updates=6450, lr=9.86341e-06, gnorm=3.238, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13589
2022-05-09 00:35:40 - progress_bar.py[line:272] - INFO: epoch 001:   6470 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871315, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=35.168, expert1_balance_bottom=18.924, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=209.7, ups=0.55, wpb=382.9, bsz=32, num_updates=6460, lr=9.86221e-06, gnorm=3.848, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13608
2022-05-09 00:35:58 - progress_bar.py[line:272] - INFO: epoch 001:   6480 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=380.8, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.224, expert1_balance_bottom=19.146, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.2, ups=0.55, wpb=380.8, bsz=32, num_updates=6470, lr=9.86101e-06, gnorm=3.332, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13626
2022-05-09 00:36:16 - progress_bar.py[line:272] - INFO: epoch 001:   6490 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.496, expert1_balance_bottom=19.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=214.1, ups=0.56, wpb=382.9, bsz=32, num_updates=6480, lr=9.85981e-06, gnorm=4.458, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13644
2022-05-09 00:36:34 - progress_bar.py[line:272] - INFO: epoch 001:   6500 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=388.7, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.543, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=216.1, ups=0.56, wpb=388.7, bsz=32, num_updates=6490, lr=9.85861e-06, gnorm=3.869, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13662
2022-05-09 00:36:51 - progress_bar.py[line:272] - INFO: epoch 001:   6510 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888417, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.164, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.1, ups=0.56, wpb=380.2, bsz=32, num_updates=6500, lr=9.8574e-06, gnorm=3.819, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13679
2022-05-09 00:37:09 - progress_bar.py[line:272] - INFO: epoch 001:   6520 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=380.3, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885235, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=34.291, expert1_balance_bottom=19.137, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.1, ups=0.56, wpb=380.3, bsz=32, num_updates=6510, lr=9.8562e-06, gnorm=3.017, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13697
2022-05-09 00:37:27 - progress_bar.py[line:272] - INFO: epoch 001:   6530 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=34.482, expert1_balance_bottom=18.93, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.5, ups=0.56, wpb=380.5, bsz=32, num_updates=6520, lr=9.855e-06, gnorm=3.26, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13715
2022-05-09 00:37:45 - progress_bar.py[line:272] - INFO: epoch 001:   6540 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=387.2, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878678, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=34.49, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=216.2, ups=0.56, wpb=387.2, bsz=32, num_updates=6530, lr=9.8538e-06, gnorm=3.389, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13733
2022-05-09 00:38:03 - progress_bar.py[line:272] - INFO: epoch 001:   6550 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=33.956, expert1_balance_bottom=19.14, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214, ups=0.56, wpb=383.4, bsz=32, num_updates=6540, lr=9.8526e-06, gnorm=3.465, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13751
2022-05-09 00:38:21 - progress_bar.py[line:272] - INFO: epoch 001:   6560 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=366.1, nsentences=32, sample_size=290.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897169, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=33.55, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=201.4, ups=0.55, wpb=366.1, bsz=32, num_updates=6550, lr=9.8514e-06, gnorm=3.263, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13769
2022-05-09 00:38:39 - progress_bar.py[line:272] - INFO: epoch 001:   6570 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=388.6, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=34.949, expert1_balance_bottom=18.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.4, ups=0.55, wpb=388.6, bsz=32, num_updates=6560, lr=9.8502e-06, gnorm=2.819, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13787
2022-05-09 00:38:58 - progress_bar.py[line:272] - INFO: epoch 001:   6580 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=369.4, nsentences=32, sample_size=294, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.195, expert1_balance_top=33.416, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=201.4, ups=0.55, wpb=369.4, bsz=32, num_updates=6570, lr=9.84899e-06, gnorm=3.07, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13806
2022-05-09 00:39:16 - progress_bar.py[line:272] - INFO: epoch 001:   6590 / 17711 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=379.4, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.194, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.24, expert1_balance_bottom=19.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=207.9, ups=0.55, wpb=379.4, bsz=32, num_updates=6580, lr=9.84779e-06, gnorm=4.16, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13824
2022-05-09 00:39:34 - progress_bar.py[line:272] - INFO: epoch 001:   6600 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=383.7, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.308, expert1_balance_bottom=19.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211, ups=0.55, wpb=383.7, bsz=32, num_updates=6590, lr=9.84659e-06, gnorm=3.377, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13842
2022-05-09 00:39:52 - progress_bar.py[line:272] - INFO: epoch 001:   6610 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=393.1, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.383, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.2, ups=0.55, wpb=393.1, bsz=32, num_updates=6600, lr=9.84539e-06, gnorm=3.111, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13860
2022-05-09 00:40:11 - progress_bar.py[line:272] - INFO: epoch 001:   6620 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=387.9, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887393, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=34.113, expert1_balance_bottom=19.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=212.3, ups=0.55, wpb=387.9, bsz=32, num_updates=6610, lr=9.84419e-06, gnorm=4.336, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13879
2022-05-09 00:40:29 - progress_bar.py[line:272] - INFO: epoch 001:   6630 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882385, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=35.133, expert1_balance_bottom=18.845, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.3, ups=0.56, wpb=385.7, bsz=32, num_updates=6620, lr=9.84299e-06, gnorm=3.651, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13897
2022-05-09 00:40:46 - progress_bar.py[line:272] - INFO: epoch 001:   6640 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88534, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.858, expert1_balance_bottom=18.912, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214.5, ups=0.56, wpb=385, bsz=32, num_updates=6630, lr=9.84179e-06, gnorm=3.7, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13915
2022-05-09 00:41:05 - progress_bar.py[line:272] - INFO: epoch 001:   6650 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882557, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=34.734, expert1_balance_bottom=18.928, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=209.1, ups=0.55, wpb=378.6, bsz=32, num_updates=6640, lr=9.84059e-06, gnorm=3.346, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13933
2022-05-09 00:41:23 - progress_bar.py[line:272] - INFO: epoch 001:   6660 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=378.2, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887255, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.341, expert1_balance_bottom=19.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=209.2, ups=0.55, wpb=378.2, bsz=32, num_updates=6650, lr=9.83938e-06, gnorm=3.347, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13951
2022-05-09 00:41:41 - progress_bar.py[line:272] - INFO: epoch 001:   6670 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=374.5, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8872, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.494, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.9, ups=0.56, wpb=374.5, bsz=32, num_updates=6660, lr=9.83818e-06, gnorm=3.234, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13969
2022-05-09 00:41:59 - progress_bar.py[line:272] - INFO: epoch 001:   6680 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=374.8, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.32, expert1_balance_bottom=19.14, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=207.7, ups=0.55, wpb=374.8, bsz=32, num_updates=6670, lr=9.83698e-06, gnorm=3.491, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=13987
2022-05-09 00:42:17 - progress_bar.py[line:272] - INFO: epoch 001:   6690 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=392.7, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879483, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.932, expert1_balance_bottom=18.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=217.2, ups=0.55, wpb=392.7, bsz=32, num_updates=6680, lr=9.83578e-06, gnorm=3.412, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14005
2022-05-09 00:42:35 - progress_bar.py[line:272] - INFO: epoch 001:   6700 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=382.2, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.914, expert1_balance_bottom=18.765, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.3, ups=0.55, wpb=382.2, bsz=32, num_updates=6690, lr=9.83458e-06, gnorm=3.447, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14023
2022-05-09 00:42:53 - progress_bar.py[line:272] - INFO: epoch 001:   6710 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=375.9, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.136, expert1_balance_bottom=19.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209.5, ups=0.56, wpb=375.9, bsz=32, num_updates=6700, lr=9.83338e-06, gnorm=3.501, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14041
2022-05-09 00:43:11 - progress_bar.py[line:272] - INFO: epoch 001:   6720 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=380.3, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=33.597, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.1, ups=0.56, wpb=380.3, bsz=32, num_updates=6710, lr=9.83218e-06, gnorm=3.597, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14059
2022-05-09 00:43:29 - progress_bar.py[line:272] - INFO: epoch 001:   6730 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=392, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.633, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.4, ups=0.55, wpb=392, bsz=32, num_updates=6720, lr=9.83097e-06, gnorm=3.763, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14077
2022-05-09 00:43:47 - progress_bar.py[line:272] - INFO: epoch 001:   6740 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=388.3, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882873, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.574, expert1_balance_bottom=18.931, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=217.3, ups=0.56, wpb=388.3, bsz=32, num_updates=6730, lr=9.82977e-06, gnorm=3.209, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14095
2022-05-09 00:44:05 - progress_bar.py[line:272] - INFO: epoch 001:   6750 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=384.5, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.103, expert1_balance_bottom=19.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214, ups=0.56, wpb=384.5, bsz=32, num_updates=6740, lr=9.82857e-06, gnorm=3.864, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14113
2022-05-09 00:44:22 - progress_bar.py[line:272] - INFO: epoch 001:   6760 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=379.9, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887515, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=34.334, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.8, ups=0.57, wpb=379.9, bsz=32, num_updates=6750, lr=9.82737e-06, gnorm=3.071, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14130
2022-05-09 00:44:40 - progress_bar.py[line:272] - INFO: epoch 001:   6770 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=377.4, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875551, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=35.236, expert1_balance_bottom=18.733, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=207.8, ups=0.55, wpb=377.4, bsz=32, num_updates=6760, lr=9.82617e-06, gnorm=3.524, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14149
2022-05-09 00:44:59 - progress_bar.py[line:272] - INFO: epoch 001:   6780 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893957, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=33.656, expert1_balance_bottom=19.308, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.4, ups=0.55, wpb=382.9, bsz=32, num_updates=6770, lr=9.82497e-06, gnorm=3.792, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14167
2022-05-09 00:45:17 - progress_bar.py[line:272] - INFO: epoch 001:   6790 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=389.9, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.245, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.3, ups=0.56, wpb=389.9, bsz=32, num_updates=6780, lr=9.82377e-06, gnorm=3.404, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14185
2022-05-09 00:45:35 - progress_bar.py[line:272] - INFO: epoch 001:   6800 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=384.4, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890996, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.4, expert1_balance_bottom=19.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.7, ups=0.55, wpb=384.4, bsz=32, num_updates=6790, lr=9.82257e-06, gnorm=3.529, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14203
2022-05-09 00:45:53 - progress_bar.py[line:272] - INFO: epoch 001:   6810 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875124, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=34.899, expert1_balance_bottom=19.04, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=212.7, ups=0.55, wpb=385, bsz=32, num_updates=6800, lr=9.82136e-06, gnorm=3.743, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14221
2022-05-09 00:46:11 - progress_bar.py[line:272] - INFO: epoch 001:   6820 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=376.1, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889289, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.153, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=205.2, ups=0.55, wpb=376.1, bsz=32, num_updates=6810, lr=9.82016e-06, gnorm=3.695, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14239
2022-05-09 00:46:29 - progress_bar.py[line:272] - INFO: epoch 001:   6830 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=389.5, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=34.311, expert1_balance_bottom=18.996, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=215.6, ups=0.55, wpb=389.5, bsz=32, num_updates=6820, lr=9.81896e-06, gnorm=3.407, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14257
2022-05-09 00:46:47 - progress_bar.py[line:272] - INFO: epoch 001:   6840 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=385.4, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879821, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=35.144, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=212, ups=0.55, wpb=385.4, bsz=32, num_updates=6830, lr=9.81776e-06, gnorm=3.298, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14275
2022-05-09 00:46:55 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-09 00:47:07 - progress_bar.py[line:272] - INFO: epoch 001:   6851 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=377.1, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892471, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=33.723, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=190.3, ups=0.5, wpb=377.1, bsz=32, num_updates=6840, lr=9.81656e-06, gnorm=3.301, loss_scale=128, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14295
2022-05-09 00:47:26 - progress_bar.py[line:272] - INFO: epoch 001:   6861 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=33.969, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209.8, ups=0.54, wpb=385.5, bsz=32, num_updates=6850, lr=9.81536e-06, gnorm=3.119, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14314
2022-05-09 00:47:43 - progress_bar.py[line:272] - INFO: epoch 001:   6871 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878558, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.832, expert1_balance_bottom=18.905, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.2, ups=0.56, wpb=383.2, bsz=32, num_updates=6860, lr=9.81416e-06, gnorm=3.138, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14331
2022-05-09 00:48:02 - progress_bar.py[line:272] - INFO: epoch 001:   6881 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=374.4, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891041, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.193, expert1_balance_top=33.714, expert1_balance_bottom=19.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=206.1, ups=0.55, wpb=374.4, bsz=32, num_updates=6870, lr=9.81295e-06, gnorm=3.365, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14350
2022-05-09 00:48:18 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 00:48:21 - progress_bar.py[line:272] - INFO: epoch 001:   6892 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=374.6, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896429, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.196, expert1_balance_top=33.574, expert1_balance_bottom=19.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=189.7, ups=0.51, wpb=374.6, bsz=32, num_updates=6880, lr=9.81175e-06, gnorm=3.483, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14369
2022-05-09 00:48:39 - progress_bar.py[line:272] - INFO: epoch 001:   6902 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895102, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=33.545, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.8, ups=0.56, wpb=381.1, bsz=32, num_updates=6890, lr=9.81055e-06, gnorm=3.235, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14387
2022-05-09 00:48:57 - progress_bar.py[line:272] - INFO: epoch 001:   6912 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89145, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=33.711, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.1, ups=0.56, wpb=378.5, bsz=32, num_updates=6900, lr=9.80935e-06, gnorm=3.365, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14405
2022-05-09 00:49:15 - progress_bar.py[line:272] - INFO: epoch 001:   6922 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=378.3, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.624, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=209, ups=0.55, wpb=378.3, bsz=32, num_updates=6910, lr=9.80815e-06, gnorm=3.317, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14423
2022-05-09 00:49:33 - progress_bar.py[line:272] - INFO: epoch 001:   6932 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=386.1, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.061, expert1_balance_bottom=19.362, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215, ups=0.56, wpb=386.1, bsz=32, num_updates=6920, lr=9.80695e-06, gnorm=3.716, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14441
2022-05-09 00:49:51 - progress_bar.py[line:272] - INFO: epoch 001:   6942 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=390.9, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.812, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.3, ups=0.55, wpb=390.9, bsz=32, num_updates=6930, lr=9.80575e-06, gnorm=3.302, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14459
2022-05-09 00:50:09 - progress_bar.py[line:272] - INFO: epoch 001:   6952 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.194, expert1_balance_top=33.731, expert1_balance_bottom=19.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.1, ups=0.56, wpb=380.5, bsz=32, num_updates=6940, lr=9.80455e-06, gnorm=3.255, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14477
2022-05-09 00:50:27 - progress_bar.py[line:272] - INFO: epoch 001:   6962 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892341, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.191, expert1_balance_top=33.542, expert1_balance_bottom=19.226, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.4, ups=0.56, wpb=379, bsz=32, num_updates=6950, lr=9.80334e-06, gnorm=3.691, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14495
2022-05-09 00:50:45 - progress_bar.py[line:272] - INFO: epoch 001:   6972 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=380.2, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890526, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=34.064, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212.5, ups=0.56, wpb=380.2, bsz=32, num_updates=6960, lr=9.80214e-06, gnorm=3.283, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14513
2022-05-09 00:51:03 - progress_bar.py[line:272] - INFO: epoch 001:   6982 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=34.758, expert1_balance_bottom=19.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=216.7, ups=0.56, wpb=385.3, bsz=32, num_updates=6970, lr=9.80094e-06, gnorm=3.595, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14531
2022-05-09 00:51:20 - progress_bar.py[line:272] - INFO: epoch 001:   6992 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=379, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.189, expert1_balance_top=34.096, expert1_balance_bottom=19.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.1, ups=0.56, wpb=379, bsz=32, num_updates=6980, lr=9.79974e-06, gnorm=3.098, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14548
2022-05-09 00:51:38 - progress_bar.py[line:272] - INFO: epoch 001:   7002 / 17711 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=385.5, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875769, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.18, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=35.034, expert1_balance_bottom=18.757, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=215.7, ups=0.56, wpb=385.5, bsz=32, num_updates=6990, lr=9.79854e-06, gnorm=3.762, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14566
2022-05-09 00:51:56 - progress_bar.py[line:272] - INFO: epoch 001:   7012 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=375.7, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.34, expert1_balance_bottom=19.113, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=210.2, ups=0.56, wpb=375.7, bsz=32, num_updates=7000, lr=9.79734e-06, gnorm=3.565, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14584
2022-05-09 00:52:14 - progress_bar.py[line:272] - INFO: epoch 001:   7022 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=374.2, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=34.991, expert1_balance_bottom=18.848, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=207.1, ups=0.55, wpb=374.2, bsz=32, num_updates=7010, lr=9.79614e-06, gnorm=3.373, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14602
2022-05-09 00:52:32 - progress_bar.py[line:272] - INFO: epoch 001:   7032 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.192, expert1_balance_top=34.133, expert1_balance_bottom=19.001, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210, ups=0.55, wpb=378.5, bsz=32, num_updates=7020, lr=9.79494e-06, gnorm=3.402, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14620
2022-05-09 00:52:50 - progress_bar.py[line:272] - INFO: epoch 001:   7042 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=378.1, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.523, expert1_balance_bottom=18.925, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=210.6, ups=0.56, wpb=378.1, bsz=32, num_updates=7030, lr=9.79373e-06, gnorm=3.981, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14638
2022-05-09 00:53:08 - progress_bar.py[line:272] - INFO: epoch 001:   7052 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885746, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=34.277, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=211.6, ups=0.56, wpb=379.2, bsz=32, num_updates=7040, lr=9.79253e-06, gnorm=4.235, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14656
2022-05-09 00:53:26 - progress_bar.py[line:272] - INFO: epoch 001:   7062 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=387.3, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=35.01, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=217.8, ups=0.56, wpb=387.3, bsz=32, num_updates=7050, lr=9.79133e-06, gnorm=3.598, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14674
2022-05-09 00:53:44 - progress_bar.py[line:272] - INFO: epoch 001:   7072 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=34.462, expert1_balance_bottom=18.9, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.6, ups=0.56, wpb=383.3, bsz=32, num_updates=7060, lr=9.79013e-06, gnorm=3.62, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14692
2022-05-09 00:54:02 - progress_bar.py[line:272] - INFO: epoch 001:   7082 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=381.7, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=33.988, expert1_balance_bottom=19.295, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.7, ups=0.56, wpb=381.7, bsz=32, num_updates=7070, lr=9.78893e-06, gnorm=3.097, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14710
2022-05-09 00:54:19 - progress_bar.py[line:272] - INFO: epoch 001:   7092 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=391.8, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=33.955, expert1_balance_bottom=19.197, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=223.5, ups=0.57, wpb=391.8, bsz=32, num_updates=7080, lr=9.78773e-06, gnorm=3.745, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14727
2022-05-09 00:54:30 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 00:54:39 - progress_bar.py[line:272] - INFO: epoch 001:   7103 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=389.2, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.216, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=195.2, ups=0.5, wpb=389.2, bsz=32, num_updates=7090, lr=9.78653e-06, gnorm=3.303, loss_scale=32, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14747
2022-05-09 00:54:57 - progress_bar.py[line:272] - INFO: epoch 001:   7113 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=390.2, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875931, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.893, expert1_balance_bottom=18.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217, ups=0.56, wpb=390.2, bsz=32, num_updates=7100, lr=9.78532e-06, gnorm=3.327, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14765
2022-05-09 00:55:15 - progress_bar.py[line:272] - INFO: epoch 001:   7123 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=393, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.271, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.9, ups=0.55, wpb=393, bsz=32, num_updates=7110, lr=9.78412e-06, gnorm=3.669, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14783
2022-05-09 00:55:33 - progress_bar.py[line:272] - INFO: epoch 001:   7133 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.159, expert1_balance_bottom=19.14, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.9, ups=0.55, wpb=386.8, bsz=32, num_updates=7120, lr=9.78292e-06, gnorm=3.869, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14801
2022-05-09 00:55:51 - progress_bar.py[line:272] - INFO: epoch 001:   7143 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=381, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889973, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.11, expert1_balance_bottom=19.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=211.7, ups=0.56, wpb=381, bsz=32, num_updates=7130, lr=9.78172e-06, gnorm=3.219, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14819
2022-05-09 00:56:09 - progress_bar.py[line:272] - INFO: epoch 001:   7153 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=386.8, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.226, expert1_balance_bottom=19.122, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=213.7, ups=0.55, wpb=386.8, bsz=32, num_updates=7140, lr=9.78052e-06, gnorm=3.911, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14837
2022-05-09 00:56:27 - progress_bar.py[line:272] - INFO: epoch 001:   7163 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=383.2, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=35.111, expert1_balance_bottom=18.842, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.2, ups=0.56, wpb=383.2, bsz=32, num_updates=7150, lr=9.77932e-06, gnorm=3.599, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14855
2022-05-09 00:56:45 - progress_bar.py[line:272] - INFO: epoch 001:   7173 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=385.5, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=35.257, expert1_balance_bottom=18.874, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.3, ups=0.55, wpb=385.5, bsz=32, num_updates=7160, lr=9.77812e-06, gnorm=3.346, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14873
2022-05-09 00:57:03 - progress_bar.py[line:272] - INFO: epoch 001:   7183 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=34.093, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.4, ups=0.55, wpb=381.2, bsz=32, num_updates=7170, lr=9.77692e-06, gnorm=3.869, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14891
2022-05-09 00:57:21 - progress_bar.py[line:272] - INFO: epoch 001:   7193 / 17711 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=377.4, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.17, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.963, expert1_balance_bottom=18.863, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=210, ups=0.56, wpb=377.4, bsz=32, num_updates=7180, lr=9.77571e-06, gnorm=3.762, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14909
2022-05-09 00:57:39 - progress_bar.py[line:272] - INFO: epoch 001:   7203 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877623, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=34.754, expert1_balance_bottom=18.8, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=211.2, ups=0.55, wpb=380.8, bsz=32, num_updates=7190, lr=9.77451e-06, gnorm=3.838, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14927
2022-05-09 00:57:57 - progress_bar.py[line:272] - INFO: epoch 001:   7213 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.333, expert1_balance_bottom=19.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213.4, ups=0.56, wpb=384.4, bsz=32, num_updates=7200, lr=9.77331e-06, gnorm=3.411, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14945
2022-05-09 00:58:16 - progress_bar.py[line:272] - INFO: epoch 001:   7223 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.51, expert1_balance_bottom=19.025, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.3, ups=0.55, wpb=378.4, bsz=32, num_updates=7210, lr=9.77211e-06, gnorm=3.528, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14964
2022-05-09 00:58:34 - progress_bar.py[line:272] - INFO: epoch 001:   7233 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=381.2, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.517, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=210.6, ups=0.55, wpb=381.2, bsz=32, num_updates=7220, lr=9.77091e-06, gnorm=3.772, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=14982
2022-05-09 00:58:52 - progress_bar.py[line:272] - INFO: epoch 001:   7243 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=387.9, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891354, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=34.231, expert1_balance_bottom=19.068, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.8, ups=0.55, wpb=387.9, bsz=32, num_updates=7230, lr=9.76971e-06, gnorm=3.413, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15000
2022-05-09 00:59:10 - progress_bar.py[line:272] - INFO: epoch 001:   7253 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=35.134, expert1_balance_bottom=18.852, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=211.3, ups=0.55, wpb=382.2, bsz=32, num_updates=7240, lr=9.76851e-06, gnorm=3.927, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15018
2022-05-09 00:59:28 - progress_bar.py[line:272] - INFO: epoch 001:   7263 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=372.9, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894075, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=33.621, expert1_balance_bottom=19.504, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=207.1, ups=0.56, wpb=372.9, bsz=32, num_updates=7250, lr=9.7673e-06, gnorm=3.392, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15036
2022-05-09 00:59:46 - progress_bar.py[line:272] - INFO: epoch 001:   7273 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=371.1, nsentences=32, sample_size=295.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.19, expert1_balance_top=33.383, expert1_balance_bottom=19.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209.3, ups=0.56, wpb=371.1, bsz=32, num_updates=7260, lr=9.7661e-06, gnorm=3.446, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15054
2022-05-09 01:00:04 - progress_bar.py[line:272] - INFO: epoch 001:   7283 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=386.7, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881534, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.359, expert1_balance_bottom=18.901, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=213.9, ups=0.55, wpb=386.7, bsz=32, num_updates=7270, lr=9.7649e-06, gnorm=3.426, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15072
2022-05-09 01:00:22 - progress_bar.py[line:272] - INFO: epoch 001:   7293 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=372.2, nsentences=32, sample_size=296.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885743, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=34.34, expert1_balance_bottom=18.927, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=204.9, ups=0.55, wpb=372.2, bsz=32, num_updates=7280, lr=9.7637e-06, gnorm=3.455, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15090
2022-05-09 01:00:40 - progress_bar.py[line:272] - INFO: epoch 001:   7303 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.269, expert1_balance_bottom=19.181, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.4, ups=0.56, wpb=385.7, bsz=32, num_updates=7290, lr=9.7625e-06, gnorm=3.155, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15108
2022-05-09 01:00:58 - progress_bar.py[line:272] - INFO: epoch 001:   7313 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=376, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=35.066, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.9, ups=0.56, wpb=376, bsz=32, num_updates=7300, lr=9.7613e-06, gnorm=3.758, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15126
2022-05-09 01:01:16 - progress_bar.py[line:272] - INFO: epoch 001:   7323 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=377.4, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.515, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=207.7, ups=0.55, wpb=377.4, bsz=32, num_updates=7310, lr=9.7601e-06, gnorm=2.972, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15144
2022-05-09 01:01:34 - progress_bar.py[line:272] - INFO: epoch 001:   7333 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886223, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=34.147, expert1_balance_bottom=19.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=210.4, ups=0.55, wpb=381.4, bsz=32, num_updates=7320, lr=9.7589e-06, gnorm=3.432, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15162
2022-05-09 01:01:52 - progress_bar.py[line:272] - INFO: epoch 001:   7343 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=380.3, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877212, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.798, expert1_balance_bottom=18.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=210.8, ups=0.55, wpb=380.3, bsz=32, num_updates=7330, lr=9.75769e-06, gnorm=3.567, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15180
2022-05-09 01:02:10 - progress_bar.py[line:272] - INFO: epoch 001:   7353 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=384.1, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=34.505, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.3, ups=0.56, wpb=384.1, bsz=32, num_updates=7340, lr=9.75649e-06, gnorm=2.967, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15198
2022-05-09 01:02:28 - progress_bar.py[line:272] - INFO: epoch 001:   7363 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=375.6, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=33.91, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=211.3, ups=0.56, wpb=375.6, bsz=32, num_updates=7350, lr=9.75529e-06, gnorm=3.666, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15216
2022-05-09 01:02:46 - progress_bar.py[line:272] - INFO: epoch 001:   7373 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=381.9, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.714, expert1_balance_bottom=18.952, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.7, ups=0.56, wpb=381.9, bsz=32, num_updates=7360, lr=9.75409e-06, gnorm=3.414, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15234
2022-05-09 01:03:04 - progress_bar.py[line:272] - INFO: epoch 001:   7383 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=382, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=33.967, expert1_balance_bottom=19.191, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210.5, ups=0.55, wpb=382, bsz=32, num_updates=7370, lr=9.75289e-06, gnorm=3.502, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15252
2022-05-09 01:03:22 - progress_bar.py[line:272] - INFO: epoch 001:   7393 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=380.8, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88631, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=34.193, expert1_balance_bottom=19.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=208.7, ups=0.55, wpb=380.8, bsz=32, num_updates=7380, lr=9.75169e-06, gnorm=3.213, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15270
2022-05-09 01:03:40 - progress_bar.py[line:272] - INFO: epoch 001:   7403 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=379.2, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878943, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.563, expert1_balance_bottom=18.996, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.9, ups=0.56, wpb=379.2, bsz=32, num_updates=7390, lr=9.75049e-06, gnorm=3.754, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15288
2022-05-09 01:03:58 - progress_bar.py[line:272] - INFO: epoch 001:   7413 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=379.5, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.913, expert1_balance_bottom=18.954, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.7, ups=0.56, wpb=379.5, bsz=32, num_updates=7400, lr=9.74929e-06, gnorm=4.37, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15306
2022-05-09 01:04:16 - progress_bar.py[line:272] - INFO: epoch 001:   7423 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874111, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=34.788, expert1_balance_bottom=18.934, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=216, ups=0.56, wpb=388.2, bsz=32, num_updates=7410, lr=9.74808e-06, gnorm=3.83, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15324
2022-05-09 01:04:34 - progress_bar.py[line:272] - INFO: epoch 001:   7433 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=380.9, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.076, expert1_balance_bottom=19.059, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.3, ups=0.55, wpb=380.9, bsz=32, num_updates=7420, lr=9.74688e-06, gnorm=3.735, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15342
2022-05-09 01:04:52 - progress_bar.py[line:272] - INFO: epoch 001:   7443 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=376, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895405, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=34.097, expert1_balance_bottom=19.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206.7, ups=0.55, wpb=376, bsz=32, num_updates=7430, lr=9.74568e-06, gnorm=3.651, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15360
2022-05-09 01:05:10 - progress_bar.py[line:272] - INFO: epoch 001:   7453 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=383.8, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=34.608, expert1_balance_bottom=19.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.7, ups=0.56, wpb=383.8, bsz=32, num_updates=7440, lr=9.74448e-06, gnorm=3.173, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15378
2022-05-09 01:05:28 - progress_bar.py[line:272] - INFO: epoch 001:   7463 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=35.177, expert1_balance_bottom=18.948, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=214.1, ups=0.56, wpb=383.7, bsz=32, num_updates=7450, lr=9.74328e-06, gnorm=3.54, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15396
2022-05-09 01:05:46 - progress_bar.py[line:272] - INFO: epoch 001:   7473 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=380.6, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.291, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.9, ups=0.56, wpb=380.6, bsz=32, num_updates=7460, lr=9.74208e-06, gnorm=2.951, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15414
2022-05-09 01:06:03 - progress_bar.py[line:272] - INFO: epoch 001:   7483 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884407, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=34.382, expert1_balance_bottom=19.218, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.3, ups=0.56, wpb=385, bsz=32, num_updates=7470, lr=9.74088e-06, gnorm=3.156, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15431
2022-05-09 01:06:21 - progress_bar.py[line:272] - INFO: epoch 001:   7493 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878118, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.857, expert1_balance_bottom=18.917, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.6, ups=0.56, wpb=379.2, bsz=32, num_updates=7480, lr=9.73967e-06, gnorm=3.168, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15449
2022-05-09 01:06:39 - progress_bar.py[line:272] - INFO: epoch 001:   7503 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.874, expert1_balance_bottom=18.916, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.6, ups=0.56, wpb=383, bsz=32, num_updates=7490, lr=9.73847e-06, gnorm=3.164, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15467
2022-05-09 01:06:58 - progress_bar.py[line:272] - INFO: epoch 001:   7513 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=378.4, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.704, expert1_balance_bottom=18.954, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=205.5, ups=0.54, wpb=378.4, bsz=32, num_updates=7500, lr=9.73727e-06, gnorm=3.59, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15486
2022-05-09 01:07:16 - progress_bar.py[line:272] - INFO: epoch 001:   7523 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=375.6, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.152, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=205.5, ups=0.55, wpb=375.6, bsz=32, num_updates=7510, lr=9.73607e-06, gnorm=4.319, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15504
2022-05-09 01:07:34 - progress_bar.py[line:272] - INFO: epoch 001:   7533 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.187, expert1_balance_top=33.939, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.8, ups=0.56, wpb=380.9, bsz=32, num_updates=7520, lr=9.73487e-06, gnorm=3.543, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15522
2022-05-09 01:07:52 - progress_bar.py[line:272] - INFO: epoch 001:   7543 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=34.18, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=207, ups=0.55, wpb=378.5, bsz=32, num_updates=7530, lr=9.73367e-06, gnorm=3.098, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15540
2022-05-09 01:08:10 - progress_bar.py[line:272] - INFO: epoch 001:   7553 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886859, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=34.24, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=207.7, ups=0.55, wpb=377.8, bsz=32, num_updates=7540, lr=9.73247e-06, gnorm=3.491, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15558
2022-05-09 01:08:28 - progress_bar.py[line:272] - INFO: epoch 001:   7563 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=34.195, expert1_balance_bottom=19.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.8, ups=0.55, wpb=385.1, bsz=32, num_updates=7550, lr=9.73127e-06, gnorm=3.63, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15577
2022-05-09 01:08:47 - progress_bar.py[line:272] - INFO: epoch 001:   7573 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.976, expert1_balance_bottom=19.002, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=208.7, ups=0.55, wpb=382.2, bsz=32, num_updates=7560, lr=9.73006e-06, gnorm=2.696, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15595
2022-05-09 01:09:05 - progress_bar.py[line:272] - INFO: epoch 001:   7583 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=377.4, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87616, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.567, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.3, ups=0.55, wpb=377.4, bsz=32, num_updates=7570, lr=9.72886e-06, gnorm=3.894, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15613
2022-05-09 01:09:23 - progress_bar.py[line:272] - INFO: epoch 001:   7593 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887861, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.336, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211, ups=0.56, wpb=379.7, bsz=32, num_updates=7580, lr=9.72766e-06, gnorm=3.929, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15631
2022-05-09 01:09:41 - progress_bar.py[line:272] - INFO: epoch 001:   7603 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.954, ntokens=370.9, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=34.692, expert1_balance_bottom=18.688, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=207.6, ups=0.56, wpb=370.9, bsz=32, num_updates=7590, lr=9.72646e-06, gnorm=3.659, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15649
2022-05-09 01:09:58 - progress_bar.py[line:272] - INFO: epoch 001:   7613 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=389.2, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876062, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.875, expert1_balance_bottom=19.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.8, ups=0.56, wpb=389.2, bsz=32, num_updates=7600, lr=9.72526e-06, gnorm=3.649, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15667
2022-05-09 01:10:16 - progress_bar.py[line:272] - INFO: epoch 001:   7623 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=378.2, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877078, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.956, expert1_balance_bottom=18.978, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=210.6, ups=0.56, wpb=378.2, bsz=32, num_updates=7610, lr=9.72406e-06, gnorm=3.393, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15684
2022-05-09 01:10:34 - progress_bar.py[line:272] - INFO: epoch 001:   7633 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888993, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.091, expert1_balance_bottom=19.142, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=213.8, ups=0.56, wpb=383.3, bsz=32, num_updates=7620, lr=9.72286e-06, gnorm=3.565, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15702
2022-05-09 01:10:53 - progress_bar.py[line:272] - INFO: epoch 001:   7643 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=385.9, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.548, expert1_balance_bottom=19.027, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=204.9, ups=0.53, wpb=385.9, bsz=32, num_updates=7630, lr=9.72165e-06, gnorm=3.515, loss_scale=64, train_wall=18, cuda_gb_allocated=14.2, cuda_gb_reserved=15, cuda_gb_free=9.5, wall=15721
2022-05-09 01:11:11 - progress_bar.py[line:272] - INFO: epoch 001:   7653 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891531, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.373, expert1_balance_bottom=18.998, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.7, ups=0.56, wpb=381.1, bsz=32, num_updates=7640, lr=9.72045e-06, gnorm=2.976, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15739
2022-05-09 01:11:29 - progress_bar.py[line:272] - INFO: epoch 001:   7663 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=378.9, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.746, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=211.6, ups=0.56, wpb=378.9, bsz=32, num_updates=7650, lr=9.71925e-06, gnorm=3.259, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15757
2022-05-09 01:11:47 - progress_bar.py[line:272] - INFO: epoch 001:   7673 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=384.1, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=34.032, expert1_balance_bottom=19.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.8, ups=0.56, wpb=384.1, bsz=32, num_updates=7660, lr=9.71805e-06, gnorm=3.126, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15775
2022-05-09 01:12:05 - progress_bar.py[line:272] - INFO: epoch 001:   7683 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.791, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.2, ups=0.56, wpb=381.5, bsz=32, num_updates=7670, lr=9.71685e-06, gnorm=3.595, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15793
2022-05-09 01:12:23 - progress_bar.py[line:272] - INFO: epoch 001:   7693 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=375.9, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889661, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=33.964, expert1_balance_bottom=19.385, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=208.8, ups=0.56, wpb=375.9, bsz=32, num_updates=7680, lr=9.71565e-06, gnorm=3.001, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15811
2022-05-09 01:12:41 - progress_bar.py[line:272] - INFO: epoch 001:   7703 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872229, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.984, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=212.4, ups=0.56, wpb=381.7, bsz=32, num_updates=7690, lr=9.71445e-06, gnorm=3.45, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15829
2022-05-09 01:12:59 - progress_bar.py[line:272] - INFO: epoch 001:   7713 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885837, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.563, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=210.8, ups=0.56, wpb=378.7, bsz=32, num_updates=7700, lr=9.71325e-06, gnorm=3.218, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15847
2022-05-09 01:13:17 - progress_bar.py[line:272] - INFO: epoch 001:   7723 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878699, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.769, expert1_balance_bottom=19.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=210.3, ups=0.55, wpb=379.1, bsz=32, num_updates=7710, lr=9.71204e-06, gnorm=3.19, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15865
2022-05-09 01:13:35 - progress_bar.py[line:272] - INFO: epoch 001:   7733 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879743, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.693, expert1_balance_bottom=19.022, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.8, ups=0.57, wpb=384.3, bsz=32, num_updates=7720, lr=9.71084e-06, gnorm=3.74, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15883
2022-05-09 01:13:53 - progress_bar.py[line:272] - INFO: epoch 001:   7743 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.341, expert1_balance_bottom=19.081, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209.7, ups=0.55, wpb=378.8, bsz=32, num_updates=7730, lr=9.70964e-06, gnorm=3.232, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15901
2022-05-09 01:14:11 - progress_bar.py[line:272] - INFO: epoch 001:   7753 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=394.5, nsentences=32, sample_size=314.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=35.219, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.2, ups=0.56, wpb=394.5, bsz=32, num_updates=7740, lr=9.70844e-06, gnorm=3.146, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15919
2022-05-09 01:14:29 - progress_bar.py[line:272] - INFO: epoch 001:   7763 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=375.6, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.57, expert1_balance_bottom=19.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.1, ups=0.56, wpb=375.6, bsz=32, num_updates=7750, lr=9.70724e-06, gnorm=3.056, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15937
2022-05-09 01:14:46 - progress_bar.py[line:272] - INFO: epoch 001:   7773 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=33.587, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.5, ups=0.56, wpb=382.3, bsz=32, num_updates=7760, lr=9.70604e-06, gnorm=3.42, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15954
2022-05-09 01:15:04 - progress_bar.py[line:272] - INFO: epoch 001:   7783 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=380.5, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877988, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.738, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.1, ups=0.55, wpb=380.5, bsz=32, num_updates=7770, lr=9.70484e-06, gnorm=3.674, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15973
2022-05-09 01:15:22 - progress_bar.py[line:272] - INFO: epoch 001:   7793 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=382.8, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892305, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=33.867, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.9, ups=0.56, wpb=382.8, bsz=32, num_updates=7780, lr=9.70364e-06, gnorm=3.615, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=15990
2022-05-09 01:15:40 - progress_bar.py[line:272] - INFO: epoch 001:   7803 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=383, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888095, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=34.288, expert1_balance_bottom=19.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.8, ups=0.55, wpb=383, bsz=32, num_updates=7790, lr=9.70243e-06, gnorm=3.645, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16008
2022-05-09 01:15:58 - progress_bar.py[line:272] - INFO: epoch 001:   7813 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=397.2, nsentences=32, sample_size=316.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882116, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.741, expert1_balance_bottom=19.073, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.1, ups=0.55, wpb=397.2, bsz=32, num_updates=7800, lr=9.70123e-06, gnorm=3.393, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16026
2022-05-09 01:16:17 - progress_bar.py[line:272] - INFO: epoch 001:   7823 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=392.5, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=35.401, expert1_balance_bottom=18.898, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.4, ups=0.55, wpb=392.5, bsz=32, num_updates=7810, lr=9.70003e-06, gnorm=3.242, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16045
2022-05-09 01:16:35 - progress_bar.py[line:272] - INFO: epoch 001:   7833 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=390.8, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=34.314, expert1_balance_bottom=19.014, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.6, ups=0.55, wpb=390.8, bsz=32, num_updates=7820, lr=9.69883e-06, gnorm=3.589, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16063
2022-05-09 01:16:53 - progress_bar.py[line:272] - INFO: epoch 001:   7843 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875352, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=35.434, expert1_balance_bottom=18.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210.8, ups=0.55, wpb=379.9, bsz=32, num_updates=7830, lr=9.69763e-06, gnorm=3.131, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16081
2022-05-09 01:17:11 - progress_bar.py[line:272] - INFO: epoch 001:   7853 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=388.4, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.425, expert1_balance_bottom=19.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=215, ups=0.55, wpb=388.4, bsz=32, num_updates=7840, lr=9.69643e-06, gnorm=3.238, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16099
2022-05-09 01:17:29 - progress_bar.py[line:272] - INFO: epoch 001:   7863 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=390, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=34.498, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=213.3, ups=0.55, wpb=390, bsz=32, num_updates=7850, lr=9.69523e-06, gnorm=3.301, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16117
2022-05-09 01:17:48 - progress_bar.py[line:272] - INFO: epoch 001:   7873 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=386.6, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=35.537, expert1_balance_bottom=18.722, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.4, ups=0.55, wpb=386.6, bsz=32, num_updates=7860, lr=9.69402e-06, gnorm=3.337, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16136
2022-05-09 01:18:06 - progress_bar.py[line:272] - INFO: epoch 001:   7883 / 17711 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=372, nsentences=32, sample_size=295.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.165, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=33.936, expert1_balance_bottom=19.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=203.9, ups=0.55, wpb=372, bsz=32, num_updates=7870, lr=9.69282e-06, gnorm=3.718, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16154
2022-05-09 01:18:24 - progress_bar.py[line:272] - INFO: epoch 001:   7893 / 17711 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.988, ntokens=377.1, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.187, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.452, expert1_balance_bottom=19.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=208.1, ups=0.55, wpb=377.1, bsz=32, num_updates=7880, lr=9.69162e-06, gnorm=3.936, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16172
2022-05-09 01:18:42 - progress_bar.py[line:272] - INFO: epoch 001:   7903 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=34.057, expert1_balance_bottom=19.102, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=207.4, ups=0.54, wpb=381.8, bsz=32, num_updates=7890, lr=9.69042e-06, gnorm=3.378, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16190
2022-05-09 01:19:01 - progress_bar.py[line:272] - INFO: epoch 001:   7913 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=393.4, nsentences=32, sample_size=313.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889116, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=33.783, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.7, ups=0.54, wpb=393.4, bsz=32, num_updates=7900, lr=9.68922e-06, gnorm=3.505, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16209
2022-05-09 01:19:19 - progress_bar.py[line:272] - INFO: epoch 001:   7923 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=388.2, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.186, expert1_balance_top=33.496, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210, ups=0.54, wpb=388.2, bsz=32, num_updates=7910, lr=9.68802e-06, gnorm=3.329, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16227
2022-05-09 01:19:38 - progress_bar.py[line:272] - INFO: epoch 001:   7933 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=378.4, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.138, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=204.1, ups=0.54, wpb=378.4, bsz=32, num_updates=7920, lr=9.68682e-06, gnorm=4.337, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16246
2022-05-09 01:19:56 - progress_bar.py[line:272] - INFO: epoch 001:   7943 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=386.5, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.869, expert1_balance_bottom=18.829, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.3, ups=0.55, wpb=386.5, bsz=32, num_updates=7930, lr=9.68562e-06, gnorm=3.376, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16264
2022-05-09 01:20:14 - progress_bar.py[line:272] - INFO: epoch 001:   7953 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.361, expert1_balance_bottom=19.226, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213, ups=0.56, wpb=382.7, bsz=32, num_updates=7940, lr=9.68441e-06, gnorm=3.69, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16282
2022-05-09 01:20:32 - progress_bar.py[line:272] - INFO: epoch 001:   7963 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=375.9, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878237, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.44, expert1_balance_bottom=19.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=208.5, ups=0.55, wpb=375.9, bsz=32, num_updates=7950, lr=9.68321e-06, gnorm=3.631, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16300
2022-05-09 01:20:50 - progress_bar.py[line:272] - INFO: epoch 001:   7973 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=388.2, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.486, expert1_balance_bottom=18.985, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=218.3, ups=0.56, wpb=388.2, bsz=32, num_updates=7960, lr=9.68201e-06, gnorm=4.172, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16318
2022-05-09 01:21:08 - progress_bar.py[line:272] - INFO: epoch 001:   7983 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=388.9, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.987, expert1_balance_bottom=18.716, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=215.5, ups=0.55, wpb=388.9, bsz=32, num_updates=7970, lr=9.68081e-06, gnorm=3.133, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16336
2022-05-09 01:21:26 - progress_bar.py[line:272] - INFO: epoch 001:   7993 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874892, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.57, expert1_balance_bottom=19.073, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=209.2, ups=0.54, wpb=386.3, bsz=32, num_updates=7980, lr=9.67961e-06, gnorm=3.507, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16355
2022-05-09 01:21:45 - progress_bar.py[line:272] - INFO: epoch 001:   8003 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=387.8, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874088, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=34.331, expert1_balance_bottom=19.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=212.8, ups=0.55, wpb=387.8, bsz=32, num_updates=7990, lr=9.67841e-06, gnorm=3.974, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16373
2022-05-09 01:22:03 - progress_bar.py[line:272] - INFO: epoch 001:   8013 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=385.1, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871072, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=35.1, expert1_balance_bottom=18.797, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209.7, ups=0.54, wpb=385.1, bsz=32, num_updates=8000, lr=9.67721e-06, gnorm=3.582, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16391
2022-05-09 01:22:03 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 01:22:03 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 01:22:03 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 01:29:30 - train.py[line:517] - INFO: valid_step finished
2022-05-09 01:29:30 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.507 | loss_v1 0 | loss_v2 0 | nll_loss 7.803 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.972121 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.507 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.238 | expert1_balance_top 35.587 | expert1_balance_bottom 15.039 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 223.33 | cider 1.17 | wps 674.2 | wpb 481.7 | bsz 8 | num_updates 8000 | best_cider 1.176
2022-05-09 01:29:48 - progress_bar.py[line:272] - INFO: epoch 001:   8023 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.391, expert1_balance_bottom=19.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=8.2, ups=0.02, wpb=379.6, bsz=32, num_updates=8010, lr=9.676e-06, gnorm=3.83, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16856
2022-05-09 01:30:06 - progress_bar.py[line:272] - INFO: epoch 001:   8033 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=380.1, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.481, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209.7, ups=0.55, wpb=380.1, bsz=32, num_updates=8020, lr=9.6748e-06, gnorm=4.405, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16875
2022-05-09 01:30:24 - progress_bar.py[line:272] - INFO: epoch 001:   8043 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=389.1, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.474, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.6, ups=0.56, wpb=389.1, bsz=32, num_updates=8030, lr=9.6736e-06, gnorm=3.797, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16892
2022-05-09 01:30:43 - progress_bar.py[line:272] - INFO: epoch 001:   8053 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.959, ntokens=384.9, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=35.237, expert1_balance_bottom=18.708, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=212.3, ups=0.55, wpb=384.9, bsz=32, num_updates=8040, lr=9.6724e-06, gnorm=3.39, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16911
2022-05-09 01:31:01 - progress_bar.py[line:272] - INFO: epoch 001:   8063 / 17711 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.976, ntokens=387.5, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.183, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.284, expert1_balance_bottom=19.128, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=211.9, ups=0.55, wpb=387.5, bsz=32, num_updates=8050, lr=9.6712e-06, gnorm=3.51, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16929
2022-05-09 01:31:19 - progress_bar.py[line:272] - INFO: epoch 001:   8073 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=387.1, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88534, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.497, expert1_balance_bottom=19.069, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215, ups=0.56, wpb=387.1, bsz=32, num_updates=8060, lr=9.67e-06, gnorm=3.342, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16947
2022-05-09 01:31:37 - progress_bar.py[line:272] - INFO: epoch 001:   8083 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.696, expert1_balance_bottom=18.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.2, ups=0.55, wpb=381.8, bsz=32, num_updates=8070, lr=9.6688e-06, gnorm=3.676, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16965
2022-05-09 01:31:55 - progress_bar.py[line:272] - INFO: epoch 001:   8093 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=375.5, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.795, expert1_balance_bottom=18.952, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=206.9, ups=0.55, wpb=375.5, bsz=32, num_updates=8080, lr=9.6676e-06, gnorm=3.859, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=16983
2022-05-09 01:32:13 - progress_bar.py[line:272] - INFO: epoch 001:   8103 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.208, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.9, ups=0.57, wpb=387.9, bsz=32, num_updates=8090, lr=9.66639e-06, gnorm=3.272, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17001
2022-05-09 01:32:31 - progress_bar.py[line:272] - INFO: epoch 001:   8113 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.331, expert1_balance_bottom=19.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=209.2, ups=0.55, wpb=381.3, bsz=32, num_updates=8100, lr=9.66519e-06, gnorm=3.004, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17019
2022-05-09 01:32:49 - progress_bar.py[line:272] - INFO: epoch 001:   8123 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.804, expert1_balance_bottom=18.848, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.7, ups=0.56, wpb=381, bsz=32, num_updates=8110, lr=9.66399e-06, gnorm=3.363, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17037
2022-05-09 01:33:07 - progress_bar.py[line:272] - INFO: epoch 001:   8133 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=382.8, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.551, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.4, ups=0.55, wpb=382.8, bsz=32, num_updates=8120, lr=9.66279e-06, gnorm=3.228, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17055
2022-05-09 01:33:25 - progress_bar.py[line:272] - INFO: epoch 001:   8143 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=387.3, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884094, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.489, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.4, ups=0.55, wpb=387.3, bsz=32, num_updates=8130, lr=9.66159e-06, gnorm=3.43, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17073
2022-05-09 01:33:44 - progress_bar.py[line:272] - INFO: epoch 001:   8153 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=376, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890419, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.332, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=202.9, ups=0.54, wpb=376, bsz=32, num_updates=8140, lr=9.66039e-06, gnorm=3.727, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17092
2022-05-09 01:34:02 - progress_bar.py[line:272] - INFO: epoch 001:   8163 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=378.5, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=33.612, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=207.9, ups=0.55, wpb=378.5, bsz=32, num_updates=8150, lr=9.65919e-06, gnorm=3.241, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17110
2022-05-09 01:34:20 - progress_bar.py[line:272] - INFO: epoch 001:   8173 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=381.2, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.601, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.6, ups=0.56, wpb=381.2, bsz=32, num_updates=8160, lr=9.65799e-06, gnorm=4.12, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17128
2022-05-09 01:34:38 - progress_bar.py[line:272] - INFO: epoch 001:   8183 / 17711 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.173, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.531, expert1_balance_bottom=19.19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=214.8, ups=0.56, wpb=382.9, bsz=32, num_updates=8170, lr=9.65678e-06, gnorm=3.747, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17146
2022-05-09 01:34:56 - progress_bar.py[line:272] - INFO: epoch 001:   8193 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=375.6, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895055, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.188, expert1_balance_top=33.979, expert1_balance_bottom=19.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=208.6, ups=0.56, wpb=375.6, bsz=32, num_updates=8180, lr=9.65558e-06, gnorm=3.86, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17164
2022-05-09 01:35:14 - progress_bar.py[line:272] - INFO: epoch 001:   8203 / 17711 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.965, ntokens=383, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879488, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.161, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.843, expert1_balance_bottom=18.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=213.7, ups=0.56, wpb=383, bsz=32, num_updates=8190, lr=9.65438e-06, gnorm=2.97, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17182
2022-05-09 01:35:32 - progress_bar.py[line:272] - INFO: epoch 001:   8213 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894155, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=34.027, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.9, ups=0.55, wpb=382, bsz=32, num_updates=8200, lr=9.65318e-06, gnorm=3.007, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17200
2022-05-09 01:35:50 - progress_bar.py[line:272] - INFO: epoch 001:   8223 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=34.148, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=210.1, ups=0.55, wpb=381.8, bsz=32, num_updates=8210, lr=9.65198e-06, gnorm=3.02, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17218
2022-05-09 01:36:08 - progress_bar.py[line:272] - INFO: epoch 001:   8233 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=385.6, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.11, expert1_balance_bottom=19.128, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.5, ups=0.55, wpb=385.6, bsz=32, num_updates=8220, lr=9.65078e-06, gnorm=3.3, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17236
2022-05-09 01:36:26 - progress_bar.py[line:272] - INFO: epoch 001:   8243 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=381.9, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.715, expert1_balance_bottom=18.976, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.2, ups=0.55, wpb=381.9, bsz=32, num_updates=8230, lr=9.64958e-06, gnorm=3.18, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17254
2022-05-09 01:36:45 - progress_bar.py[line:272] - INFO: epoch 001:   8253 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=383.1, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=34.013, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209, ups=0.55, wpb=383.1, bsz=32, num_updates=8240, lr=9.64837e-06, gnorm=3.122, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17273
2022-05-09 01:37:03 - progress_bar.py[line:272] - INFO: epoch 001:   8263 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=389.2, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884502, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.051, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.5, ups=0.56, wpb=389.2, bsz=32, num_updates=8250, lr=9.64717e-06, gnorm=3.067, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17291
2022-05-09 01:37:21 - progress_bar.py[line:272] - INFO: epoch 001:   8273 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=33.946, expert1_balance_bottom=19.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.9, ups=0.56, wpb=383.4, bsz=32, num_updates=8260, lr=9.64597e-06, gnorm=3.427, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17309
2022-05-09 01:37:39 - progress_bar.py[line:272] - INFO: epoch 001:   8283 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=34.772, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212, ups=0.55, wpb=385.7, bsz=32, num_updates=8270, lr=9.64477e-06, gnorm=2.939, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17327
2022-05-09 01:37:57 - progress_bar.py[line:272] - INFO: epoch 001:   8293 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=385.2, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880298, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=34.578, expert1_balance_bottom=19.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.2, ups=0.56, wpb=385.2, bsz=32, num_updates=8280, lr=9.64357e-06, gnorm=3.695, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17345
2022-05-09 01:38:15 - progress_bar.py[line:272] - INFO: epoch 001:   8303 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=34.141, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209.9, ups=0.55, wpb=381.9, bsz=32, num_updates=8290, lr=9.64237e-06, gnorm=3.597, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17363
2022-05-09 01:38:33 - progress_bar.py[line:272] - INFO: epoch 001:   8313 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883861, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.08, expert1_balance_bottom=19.199, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.8, ups=0.56, wpb=382.6, bsz=32, num_updates=8300, lr=9.64117e-06, gnorm=2.961, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17381
2022-05-09 01:38:51 - progress_bar.py[line:272] - INFO: epoch 001:   8323 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=386.9, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=34.791, expert1_balance_bottom=18.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214, ups=0.55, wpb=386.9, bsz=32, num_updates=8310, lr=9.63997e-06, gnorm=3.704, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17399
2022-05-09 01:39:09 - progress_bar.py[line:272] - INFO: epoch 001:   8333 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.27, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209.5, ups=0.56, wpb=377.1, bsz=32, num_updates=8320, lr=9.63876e-06, gnorm=3.429, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17417
2022-05-09 01:39:26 - progress_bar.py[line:272] - INFO: epoch 001:   8343 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=387.3, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882748, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.146, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.2, ups=0.56, wpb=387.3, bsz=32, num_updates=8330, lr=9.63756e-06, gnorm=2.973, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17434
2022-05-09 01:39:44 - progress_bar.py[line:272] - INFO: epoch 001:   8353 / 17711 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889223, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.154, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=33.854, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=209, ups=0.55, wpb=378.2, bsz=32, num_updates=8340, lr=9.63636e-06, gnorm=3.656, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17453
2022-05-09 01:40:02 - progress_bar.py[line:272] - INFO: epoch 001:   8363 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=375.2, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.689, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=211.1, ups=0.56, wpb=375.2, bsz=32, num_updates=8350, lr=9.63516e-06, gnorm=3.207, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17470
2022-05-09 01:40:20 - progress_bar.py[line:272] - INFO: epoch 001:   8373 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=383.9, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.185, expert1_balance_top=33.884, expert1_balance_bottom=19.284, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.4, ups=0.55, wpb=383.9, bsz=32, num_updates=8360, lr=9.63396e-06, gnorm=2.986, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17488
2022-05-09 01:40:22 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 01:40:40 - progress_bar.py[line:272] - INFO: epoch 001:   8384 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881648, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=34.33, expert1_balance_bottom=19.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=193.1, ups=0.5, wpb=383.1, bsz=32, num_updates=8370, lr=9.63276e-06, gnorm=3.225, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17508
2022-05-09 01:40:44 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 01:41:00 - progress_bar.py[line:272] - INFO: epoch 001:   8395 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=34.809, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=190.6, ups=0.5, wpb=381.1, bsz=32, num_updates=8380, lr=9.63156e-06, gnorm=3.032, loss_scale=32, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17528
2022-05-09 01:41:18 - progress_bar.py[line:272] - INFO: epoch 001:   8405 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=374.9, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885168, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.144, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=206.3, ups=0.55, wpb=374.9, bsz=32, num_updates=8390, lr=9.63035e-06, gnorm=3.897, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17546
2022-05-09 01:41:37 - progress_bar.py[line:272] - INFO: epoch 001:   8415 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.963, ntokens=394.5, nsentences=32, sample_size=314.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.662, expert1_balance_bottom=18.967, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=216.8, ups=0.55, wpb=394.5, bsz=32, num_updates=8400, lr=9.62915e-06, gnorm=3.517, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17565
2022-05-09 01:41:54 - progress_bar.py[line:272] - INFO: epoch 001:   8425 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=379.1, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.578, expert1_balance_bottom=18.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.8, ups=0.56, wpb=379.1, bsz=32, num_updates=8410, lr=9.62795e-06, gnorm=3.777, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17582
2022-05-09 01:42:12 - progress_bar.py[line:272] - INFO: epoch 001:   8435 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=376.6, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=33.795, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.9, ups=0.56, wpb=376.6, bsz=32, num_updates=8420, lr=9.62675e-06, gnorm=3.633, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17600
2022-05-09 01:42:30 - progress_bar.py[line:272] - INFO: epoch 001:   8445 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=380.4, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.282, expert1_balance_bottom=19.093, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.2, ups=0.56, wpb=380.4, bsz=32, num_updates=8430, lr=9.62555e-06, gnorm=3.209, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17618
2022-05-09 01:42:48 - progress_bar.py[line:272] - INFO: epoch 001:   8455 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=379.1, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=33.413, expert1_balance_bottom=19.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=209.9, ups=0.55, wpb=379.1, bsz=32, num_updates=8440, lr=9.62435e-06, gnorm=3.135, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17636
2022-05-09 01:43:06 - progress_bar.py[line:272] - INFO: epoch 001:   8465 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=385.4, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868343, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=34.901, expert1_balance_bottom=19.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.3, ups=0.55, wpb=385.4, bsz=32, num_updates=8450, lr=9.62315e-06, gnorm=3.497, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17655
2022-05-09 01:43:24 - progress_bar.py[line:272] - INFO: epoch 001:   8475 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.136, expert1_balance_bottom=19.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.9, ups=0.56, wpb=381.7, bsz=32, num_updates=8460, lr=9.62195e-06, gnorm=3.642, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17672
2022-05-09 01:43:42 - progress_bar.py[line:272] - INFO: epoch 001:   8485 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=389.2, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=33.564, expert1_balance_bottom=19.572, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.1, ups=0.56, wpb=389.2, bsz=32, num_updates=8470, lr=9.62074e-06, gnorm=3.628, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17690
2022-05-09 01:44:00 - progress_bar.py[line:272] - INFO: epoch 001:   8495 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=392.9, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.828, expert1_balance_bottom=19.072, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=218.7, ups=0.56, wpb=392.9, bsz=32, num_updates=8480, lr=9.61954e-06, gnorm=3.531, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17708
2022-05-09 01:44:18 - progress_bar.py[line:272] - INFO: epoch 001:   8505 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=33.797, expert1_balance_bottom=19.465, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=212.5, ups=0.56, wpb=380.8, bsz=32, num_updates=8490, lr=9.61834e-06, gnorm=3.632, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17726
2022-05-09 01:44:36 - progress_bar.py[line:272] - INFO: epoch 001:   8515 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=34.612, expert1_balance_bottom=19.041, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.5, ups=0.55, wpb=384.5, bsz=32, num_updates=8500, lr=9.61714e-06, gnorm=3.72, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17744
2022-05-09 01:44:54 - progress_bar.py[line:272] - INFO: epoch 001:   8525 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=385.8, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.389, expert1_balance_bottom=18.949, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.9, ups=0.56, wpb=385.8, bsz=32, num_updates=8510, lr=9.61594e-06, gnorm=3.665, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17762
2022-05-09 01:45:12 - progress_bar.py[line:272] - INFO: epoch 001:   8535 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882305, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=33.836, expert1_balance_bottom=19.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=210.1, ups=0.56, wpb=378.4, bsz=32, num_updates=8520, lr=9.61474e-06, gnorm=4.087, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17780
2022-05-09 01:45:30 - progress_bar.py[line:272] - INFO: epoch 001:   8545 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=381.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879004, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.649, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.3, ups=0.56, wpb=381.8, bsz=32, num_updates=8530, lr=9.61354e-06, gnorm=3.396, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17798
2022-05-09 01:45:48 - progress_bar.py[line:272] - INFO: epoch 001:   8555 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=397.1, nsentences=32, sample_size=315.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88283, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=34.109, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=221, ups=0.56, wpb=397.1, bsz=32, num_updates=8540, lr=9.61234e-06, gnorm=3.337, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17816
2022-05-09 01:46:06 - progress_bar.py[line:272] - INFO: epoch 001:   8565 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=392.5, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871631, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=35.077, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=219, ups=0.56, wpb=392.5, bsz=32, num_updates=8550, lr=9.61113e-06, gnorm=3.172, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17834
2022-05-09 01:46:24 - progress_bar.py[line:272] - INFO: epoch 001:   8575 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=386.6, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876213, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.69, expert1_balance_bottom=18.912, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=219.4, ups=0.57, wpb=386.6, bsz=32, num_updates=8560, lr=9.60993e-06, gnorm=3.514, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17852
2022-05-09 01:46:41 - progress_bar.py[line:272] - INFO: epoch 001:   8585 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=383.5, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=35.182, expert1_balance_bottom=18.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.4, ups=0.56, wpb=383.5, bsz=32, num_updates=8570, lr=9.60873e-06, gnorm=3.615, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17870
2022-05-09 01:46:59 - progress_bar.py[line:272] - INFO: epoch 001:   8595 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888833, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=33.59, expert1_balance_bottom=19.514, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.5, ups=0.57, wpb=384.7, bsz=32, num_updates=8580, lr=9.60753e-06, gnorm=3.079, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17887
2022-05-09 01:47:17 - progress_bar.py[line:272] - INFO: epoch 001:   8605 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887219, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=33.572, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.8, ups=0.57, wpb=385, bsz=32, num_updates=8590, lr=9.60633e-06, gnorm=3.419, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17905
2022-05-09 01:47:35 - progress_bar.py[line:272] - INFO: epoch 001:   8615 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=381.9, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891643, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=33.514, expert1_balance_bottom=19.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214.2, ups=0.56, wpb=381.9, bsz=32, num_updates=8600, lr=9.60513e-06, gnorm=3.485, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17923
2022-05-09 01:47:53 - progress_bar.py[line:272] - INFO: epoch 001:   8625 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.136, expert1_balance_bottom=19.312, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.2, ups=0.55, wpb=377.8, bsz=32, num_updates=8610, lr=9.60393e-06, gnorm=3.446, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17941
2022-05-09 01:48:11 - progress_bar.py[line:272] - INFO: epoch 001:   8635 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=386.8, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.61, expert1_balance_bottom=19.155, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.6, ups=0.55, wpb=386.8, bsz=32, num_updates=8620, lr=9.60272e-06, gnorm=3.419, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17959
2022-05-09 01:48:29 - progress_bar.py[line:272] - INFO: epoch 001:   8645 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.067, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.6, ups=0.55, wpb=383.6, bsz=32, num_updates=8630, lr=9.60152e-06, gnorm=3.646, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17977
2022-05-09 01:48:47 - progress_bar.py[line:272] - INFO: epoch 001:   8655 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874301, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.987, expert1_balance_bottom=18.98, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.5, ups=0.55, wpb=386.3, bsz=32, num_updates=8640, lr=9.60032e-06, gnorm=3.606, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=17995
2022-05-09 01:49:05 - progress_bar.py[line:272] - INFO: epoch 001:   8665 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=391.8, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883047, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.245, expert1_balance_bottom=19.366, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.2, ups=0.56, wpb=391.8, bsz=32, num_updates=8650, lr=9.59912e-06, gnorm=4.12, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18013
2022-05-09 01:49:23 - progress_bar.py[line:272] - INFO: epoch 001:   8675 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=382.7, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875047, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=34.887, expert1_balance_bottom=19.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=210, ups=0.55, wpb=382.7, bsz=32, num_updates=8660, lr=9.59792e-06, gnorm=4.136, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18031
2022-05-09 01:49:41 - progress_bar.py[line:272] - INFO: epoch 001:   8685 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884396, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.484, expert1_balance_bottom=19.113, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.8, ups=0.56, wpb=384.4, bsz=32, num_updates=8670, lr=9.59672e-06, gnorm=3.911, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18049
2022-05-09 01:49:59 - progress_bar.py[line:272] - INFO: epoch 001:   8695 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88615, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.282, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=212.9, ups=0.56, wpb=380.6, bsz=32, num_updates=8680, lr=9.59552e-06, gnorm=3.694, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18067
2022-05-09 01:50:17 - progress_bar.py[line:272] - INFO: epoch 001:   8705 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=390, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.84, expert1_balance_bottom=18.941, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=217.8, ups=0.56, wpb=390, bsz=32, num_updates=8690, lr=9.59432e-06, gnorm=3.948, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18085
2022-05-09 01:50:35 - progress_bar.py[line:272] - INFO: epoch 001:   8715 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=373.7, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887454, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.203, expert1_balance_bottom=19.199, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=204, ups=0.55, wpb=373.7, bsz=32, num_updates=8700, lr=9.59311e-06, gnorm=4.354, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18103
2022-05-09 01:50:54 - progress_bar.py[line:272] - INFO: epoch 001:   8725 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=382, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.217, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=209.2, ups=0.55, wpb=382, bsz=32, num_updates=8710, lr=9.59191e-06, gnorm=3.346, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18122
2022-05-09 01:51:12 - progress_bar.py[line:272] - INFO: epoch 001:   8735 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=34.17, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209, ups=0.55, wpb=378.8, bsz=32, num_updates=8720, lr=9.59071e-06, gnorm=3.403, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18140
2022-05-09 01:51:30 - progress_bar.py[line:272] - INFO: epoch 001:   8745 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=390, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875029, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=34.836, expert1_balance_bottom=19.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.9, ups=0.54, wpb=390, bsz=32, num_updates=8730, lr=9.58951e-06, gnorm=3.563, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18158
2022-05-09 01:51:49 - progress_bar.py[line:272] - INFO: epoch 001:   8755 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=373.3, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902114, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.184, expert1_balance_top=33.042, expert1_balance_bottom=19.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=204.1, ups=0.55, wpb=373.3, bsz=32, num_updates=8740, lr=9.58831e-06, gnorm=3.225, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18177
2022-05-09 01:52:07 - progress_bar.py[line:272] - INFO: epoch 001:   8765 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=372.3, nsentences=32, sample_size=296.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=33.571, expert1_balance_bottom=19.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=204.2, ups=0.55, wpb=372.3, bsz=32, num_updates=8750, lr=9.58711e-06, gnorm=3.477, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18195
2022-05-09 01:52:25 - progress_bar.py[line:272] - INFO: epoch 001:   8775 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=34.769, expert1_balance_bottom=18.921, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=209.3, ups=0.55, wpb=382.3, bsz=32, num_updates=8760, lr=9.58591e-06, gnorm=3.86, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18213
2022-05-09 01:52:43 - progress_bar.py[line:272] - INFO: epoch 001:   8785 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=34.292, expert1_balance_bottom=19.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=214.4, ups=0.55, wpb=386.8, bsz=32, num_updates=8770, lr=9.5847e-06, gnorm=3.539, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18231
2022-05-09 01:53:01 - progress_bar.py[line:272] - INFO: epoch 001:   8795 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=378.3, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89402, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=33.84, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.5, ups=0.56, wpb=378.3, bsz=32, num_updates=8780, lr=9.5835e-06, gnorm=3.767, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18249
2022-05-09 01:53:19 - progress_bar.py[line:272] - INFO: epoch 001:   8805 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=380.2, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=33.876, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=211.8, ups=0.56, wpb=380.2, bsz=32, num_updates=8790, lr=9.5823e-06, gnorm=4.165, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18267
2022-05-09 01:53:37 - progress_bar.py[line:272] - INFO: epoch 001:   8815 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=380.1, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=34.14, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.5, ups=0.56, wpb=380.1, bsz=32, num_updates=8800, lr=9.5811e-06, gnorm=3.707, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18285
2022-05-09 01:53:55 - progress_bar.py[line:272] - INFO: epoch 001:   8825 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=382.5, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892502, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=33.666, expert1_balance_bottom=19.308, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.4, ups=0.56, wpb=382.5, bsz=32, num_updates=8810, lr=9.5799e-06, gnorm=3.549, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18303
2022-05-09 01:54:13 - progress_bar.py[line:272] - INFO: epoch 001:   8835 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=372.1, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893068, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.181, expert1_balance_top=33.685, expert1_balance_bottom=19.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=204.9, ups=0.55, wpb=372.1, bsz=32, num_updates=8820, lr=9.5787e-06, gnorm=3.71, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18321
2022-05-09 01:54:31 - progress_bar.py[line:272] - INFO: epoch 001:   8845 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=35.133, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209.8, ups=0.55, wpb=381, bsz=32, num_updates=8830, lr=9.5775e-06, gnorm=3.397, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18339
2022-05-09 01:54:49 - progress_bar.py[line:272] - INFO: epoch 001:   8855 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=377.7, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89696, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=33.785, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.1, ups=0.55, wpb=377.7, bsz=32, num_updates=8840, lr=9.5763e-06, gnorm=6.235, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18357
2022-05-09 01:55:07 - progress_bar.py[line:272] - INFO: epoch 001:   8865 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=383.8, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884467, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.431, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.7, ups=0.56, wpb=383.8, bsz=32, num_updates=8850, lr=9.57509e-06, gnorm=3.773, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18375
2022-05-09 01:55:25 - progress_bar.py[line:272] - INFO: epoch 001:   8875 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=382.7, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=35.049, expert1_balance_bottom=18.83, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213, ups=0.56, wpb=382.7, bsz=32, num_updates=8860, lr=9.57389e-06, gnorm=3.93, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18393
2022-05-09 01:55:43 - progress_bar.py[line:272] - INFO: epoch 001:   8885 / 17711 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.138, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.231, expert1_balance_bottom=19.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=212.5, ups=0.56, wpb=380.2, bsz=32, num_updates=8870, lr=9.57269e-06, gnorm=4.082, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18411
2022-05-09 01:56:00 - progress_bar.py[line:272] - INFO: epoch 001:   8895 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=382.8, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873501, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=34.545, expert1_balance_bottom=19.12, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=216.7, ups=0.57, wpb=382.8, bsz=32, num_updates=8880, lr=9.57149e-06, gnorm=3.504, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18429
2022-05-09 01:56:18 - progress_bar.py[line:272] - INFO: epoch 001:   8905 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=374.8, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=34.038, expert1_balance_bottom=19.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=208.2, ups=0.56, wpb=374.8, bsz=32, num_updates=8890, lr=9.57029e-06, gnorm=3.217, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18447
2022-05-09 01:56:37 - progress_bar.py[line:272] - INFO: epoch 001:   8915 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.123, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=208.8, ups=0.55, wpb=378.8, bsz=32, num_updates=8900, lr=9.56909e-06, gnorm=3.843, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18465
2022-05-09 01:56:55 - progress_bar.py[line:272] - INFO: epoch 001:   8925 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=379.9, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=33.976, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=211, ups=0.56, wpb=379.9, bsz=32, num_updates=8910, lr=9.56789e-06, gnorm=3.875, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18483
2022-05-09 01:57:13 - progress_bar.py[line:272] - INFO: epoch 001:   8935 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=384.6, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=33.965, expert1_balance_bottom=19.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.9, ups=0.55, wpb=384.6, bsz=32, num_updates=8920, lr=9.56669e-06, gnorm=3.42, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18501
2022-05-09 01:57:31 - progress_bar.py[line:272] - INFO: epoch 001:   8945 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.863218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=35.389, expert1_balance_bottom=18.73, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=208.2, ups=0.54, wpb=387.2, bsz=32, num_updates=8930, lr=9.56548e-06, gnorm=3.576, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18519
2022-05-09 01:57:50 - progress_bar.py[line:272] - INFO: epoch 001:   8955 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=377.7, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879082, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.61, expert1_balance_bottom=19.013, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=206, ups=0.55, wpb=377.7, bsz=32, num_updates=8940, lr=9.56428e-06, gnorm=3.307, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18538
2022-05-09 01:58:08 - progress_bar.py[line:272] - INFO: epoch 001:   8965 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=379.9, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=34.249, expert1_balance_bottom=19.128, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=213.5, ups=0.56, wpb=379.9, bsz=32, num_updates=8950, lr=9.56308e-06, gnorm=3.421, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18556
2022-05-09 01:58:26 - progress_bar.py[line:272] - INFO: epoch 001:   8975 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=371.2, nsentences=32, sample_size=295.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=34.272, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=204.5, ups=0.55, wpb=371.2, bsz=32, num_updates=8960, lr=9.56188e-06, gnorm=3.532, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18574
2022-05-09 01:58:44 - progress_bar.py[line:272] - INFO: epoch 001:   8985 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=373.7, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.452, expert1_balance_bottom=19.05, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=206.5, ups=0.55, wpb=373.7, bsz=32, num_updates=8970, lr=9.56068e-06, gnorm=3.157, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18592
2022-05-09 01:59:02 - progress_bar.py[line:272] - INFO: epoch 001:   8995 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898405, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.183, expert1_balance_top=33.335, expert1_balance_bottom=19.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.2, ups=0.56, wpb=383.2, bsz=32, num_updates=8980, lr=9.55948e-06, gnorm=3.157, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18610
2022-05-09 01:59:20 - progress_bar.py[line:272] - INFO: epoch 001:   9005 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=376.7, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89203, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.026, expert1_balance_bottom=19.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.7, ups=0.55, wpb=376.7, bsz=32, num_updates=8990, lr=9.55828e-06, gnorm=3.076, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18628
2022-05-09 01:59:38 - progress_bar.py[line:272] - INFO: epoch 001:   9015 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=390.2, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878429, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.316, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.6, ups=0.56, wpb=390.2, bsz=32, num_updates=9000, lr=9.55707e-06, gnorm=4.164, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18646
2022-05-09 01:59:56 - progress_bar.py[line:272] - INFO: epoch 001:   9025 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=378.3, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894981, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=33.966, expert1_balance_bottom=19.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=207.2, ups=0.55, wpb=378.3, bsz=32, num_updates=9010, lr=9.55587e-06, gnorm=3.639, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18664
2022-05-09 02:00:14 - progress_bar.py[line:272] - INFO: epoch 001:   9035 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=390.7, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=35.034, expert1_balance_bottom=18.886, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=218.1, ups=0.56, wpb=390.7, bsz=32, num_updates=9020, lr=9.55467e-06, gnorm=3.303, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18682
2022-05-09 02:00:32 - progress_bar.py[line:272] - INFO: epoch 001:   9045 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=384.6, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.259, expert1_balance_bottom=19.009, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.2, ups=0.55, wpb=384.6, bsz=32, num_updates=9030, lr=9.55347e-06, gnorm=3.284, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18700
2022-05-09 02:00:50 - progress_bar.py[line:272] - INFO: epoch 001:   9055 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=388.2, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887484, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.057, expert1_balance_bottom=19.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.8, ups=0.55, wpb=388.2, bsz=32, num_updates=9040, lr=9.55227e-06, gnorm=3.346, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18718
2022-05-09 02:01:08 - progress_bar.py[line:272] - INFO: epoch 001:   9065 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=377.1, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.286, expert1_balance_bottom=19.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=209, ups=0.55, wpb=377.1, bsz=32, num_updates=9050, lr=9.55107e-06, gnorm=3.641, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18736
2022-05-09 02:01:26 - progress_bar.py[line:272] - INFO: epoch 001:   9075 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=384.8, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891959, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=33.636, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.9, ups=0.55, wpb=384.8, bsz=32, num_updates=9060, lr=9.54987e-06, gnorm=3.338, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18754
2022-05-09 02:01:44 - progress_bar.py[line:272] - INFO: epoch 001:   9085 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=394.4, nsentences=32, sample_size=313.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.127, expert1_balance_bottom=19.116, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=218, ups=0.55, wpb=394.4, bsz=32, num_updates=9070, lr=9.54867e-06, gnorm=3.656, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18773
2022-05-09 02:02:03 - progress_bar.py[line:272] - INFO: epoch 001:   9095 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=384.5, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=33.876, expert1_balance_bottom=19.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.7, ups=0.55, wpb=384.5, bsz=32, num_updates=9080, lr=9.54746e-06, gnorm=3.31, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18791
2022-05-09 02:02:21 - progress_bar.py[line:272] - INFO: epoch 001:   9105 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.182, expert1_balance_top=33.509, expert1_balance_bottom=19.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=210.4, ups=0.55, wpb=380.1, bsz=32, num_updates=9090, lr=9.54626e-06, gnorm=3.282, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18809
2022-05-09 02:02:39 - progress_bar.py[line:272] - INFO: epoch 001:   9115 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=384, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883866, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.412, expert1_balance_bottom=19.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.1, ups=0.55, wpb=384, bsz=32, num_updates=9100, lr=9.54506e-06, gnorm=3.014, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18827
2022-05-09 02:02:57 - progress_bar.py[line:272] - INFO: epoch 001:   9125 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878464, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.979, expert1_balance_bottom=18.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=210.3, ups=0.55, wpb=383.3, bsz=32, num_updates=9110, lr=9.54386e-06, gnorm=3.24, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18845
2022-05-09 02:03:15 - progress_bar.py[line:272] - INFO: epoch 001:   9135 / 17711 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=1.006, ntokens=387, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.197, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=34.704, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=214.1, ups=0.55, wpb=387, bsz=32, num_updates=9120, lr=9.54266e-06, gnorm=4.11, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18863
2022-05-09 02:03:34 - progress_bar.py[line:272] - INFO: epoch 001:   9145 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=33.544, expert1_balance_bottom=19.295, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.4, ups=0.55, wpb=381.8, bsz=32, num_updates=9130, lr=9.54146e-06, gnorm=3.675, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18882
2022-05-09 02:03:51 - progress_bar.py[line:272] - INFO: epoch 001:   9155 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=377.6, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=34.459, expert1_balance_bottom=19.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=210.3, ups=0.56, wpb=377.6, bsz=32, num_updates=9140, lr=9.54026e-06, gnorm=3.136, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18900
2022-05-09 02:04:09 - progress_bar.py[line:272] - INFO: epoch 001:   9165 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=378.8, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880911, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=34.672, expert1_balance_bottom=18.954, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210.5, ups=0.56, wpb=378.8, bsz=32, num_updates=9150, lr=9.53905e-06, gnorm=3.374, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18918
2022-05-09 02:04:27 - progress_bar.py[line:272] - INFO: epoch 001:   9175 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=388.4, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=34.549, expert1_balance_bottom=19.108, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.5, ups=0.56, wpb=388.4, bsz=32, num_updates=9160, lr=9.53785e-06, gnorm=3.453, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18935
2022-05-09 02:04:45 - progress_bar.py[line:272] - INFO: epoch 001:   9185 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=385.4, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=33.943, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.4, ups=0.56, wpb=385.4, bsz=32, num_updates=9170, lr=9.53665e-06, gnorm=4.278, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18953
2022-05-09 02:05:02 - progress_bar.py[line:272] - INFO: epoch 001:   9195 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.221, expert1_balance_bottom=19.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=223.1, ups=0.58, wpb=381.8, bsz=32, num_updates=9180, lr=9.53545e-06, gnorm=3.723, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18970
2022-05-09 02:05:20 - progress_bar.py[line:272] - INFO: epoch 001:   9205 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=397, nsentences=32, sample_size=316.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88622, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=33.767, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=231.1, ups=0.58, wpb=397, bsz=32, num_updates=9190, lr=9.53425e-06, gnorm=2.934, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=18988
2022-05-09 02:05:37 - progress_bar.py[line:272] - INFO: epoch 001:   9215 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=389.8, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.926, expert1_balance_bottom=18.921, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=225.1, ups=0.58, wpb=389.8, bsz=32, num_updates=9200, lr=9.53305e-06, gnorm=3.085, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19005
2022-05-09 02:05:54 - progress_bar.py[line:272] - INFO: epoch 001:   9225 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=373.2, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=33.787, expert1_balance_bottom=19.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212, ups=0.57, wpb=373.2, bsz=32, num_updates=9210, lr=9.53185e-06, gnorm=3.709, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19022
2022-05-09 02:06:12 - progress_bar.py[line:272] - INFO: epoch 001:   9235 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=373.9, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=33.752, expert1_balance_bottom=19.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.5, ups=0.56, wpb=373.9, bsz=32, num_updates=9220, lr=9.53065e-06, gnorm=3.636, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19040
2022-05-09 02:06:30 - progress_bar.py[line:272] - INFO: epoch 001:   9245 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869589, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=35.729, expert1_balance_bottom=18.913, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=220.4, ups=0.57, wpb=384.7, bsz=32, num_updates=9230, lr=9.52944e-06, gnorm=3.393, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19058
2022-05-09 02:06:47 - progress_bar.py[line:272] - INFO: epoch 001:   9255 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=388.7, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876017, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=35.021, expert1_balance_bottom=19.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=222.3, ups=0.57, wpb=388.7, bsz=32, num_updates=9240, lr=9.52824e-06, gnorm=3.155, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19075
2022-05-09 02:07:04 - progress_bar.py[line:272] - INFO: epoch 001:   9265 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=388.6, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=34.145, expert1_balance_bottom=19.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.2, ups=0.58, wpb=388.6, bsz=32, num_updates=9250, lr=9.52704e-06, gnorm=3.405, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19093
2022-05-09 02:07:22 - progress_bar.py[line:272] - INFO: epoch 001:   9275 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=374.5, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=34.634, expert1_balance_bottom=19.078, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214, ups=0.57, wpb=374.5, bsz=32, num_updates=9260, lr=9.52584e-06, gnorm=2.836, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19110
2022-05-09 02:07:39 - progress_bar.py[line:272] - INFO: epoch 001:   9285 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=380.3, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=33.674, expert1_balance_bottom=19.618, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.2, ups=0.58, wpb=380.3, bsz=32, num_updates=9270, lr=9.52464e-06, gnorm=3.069, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19127
2022-05-09 02:07:57 - progress_bar.py[line:272] - INFO: epoch 001:   9295 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=33.886, expert1_balance_bottom=19.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219.5, ups=0.58, wpb=381.6, bsz=32, num_updates=9280, lr=9.52344e-06, gnorm=3.381, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19145
2022-05-09 02:08:14 - progress_bar.py[line:272] - INFO: epoch 001:   9305 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=386.1, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874497, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.554, expert1_balance_bottom=19.044, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=226.1, ups=0.59, wpb=386.1, bsz=32, num_updates=9290, lr=9.52224e-06, gnorm=3.26, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19162
2022-05-09 02:08:31 - progress_bar.py[line:272] - INFO: epoch 001:   9315 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=391.1, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.312, expert1_balance_bottom=19.032, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=223.5, ups=0.57, wpb=391.1, bsz=32, num_updates=9300, lr=9.52104e-06, gnorm=3.351, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19179
2022-05-09 02:08:49 - progress_bar.py[line:272] - INFO: epoch 001:   9325 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=34.048, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219, ups=0.57, wpb=382.3, bsz=32, num_updates=9310, lr=9.51983e-06, gnorm=3.481, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19197
2022-05-09 02:09:06 - progress_bar.py[line:272] - INFO: epoch 001:   9335 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.275, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.1, ups=0.57, wpb=382.5, bsz=32, num_updates=9320, lr=9.51863e-06, gnorm=3.652, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19214
2022-05-09 02:09:24 - progress_bar.py[line:272] - INFO: epoch 001:   9345 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=376.8, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896507, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=33.666, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=214.4, ups=0.57, wpb=376.8, bsz=32, num_updates=9330, lr=9.51743e-06, gnorm=3.656, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19232
2022-05-09 02:09:41 - progress_bar.py[line:272] - INFO: epoch 001:   9355 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=383.8, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.375, expert1_balance_bottom=19.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.8, ups=0.58, wpb=383.8, bsz=32, num_updates=9340, lr=9.51623e-06, gnorm=3.281, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19249
2022-05-09 02:09:59 - progress_bar.py[line:272] - INFO: epoch 001:   9365 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=384.6, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879209, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=34.991, expert1_balance_bottom=18.803, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.5, ups=0.57, wpb=384.6, bsz=32, num_updates=9350, lr=9.51503e-06, gnorm=3.461, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19267
2022-05-09 02:10:16 - progress_bar.py[line:272] - INFO: epoch 001:   9375 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886616, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.423, expert1_balance_bottom=19.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.2, ups=0.57, wpb=383.9, bsz=32, num_updates=9360, lr=9.51383e-06, gnorm=3.165, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19284
2022-05-09 02:10:33 - progress_bar.py[line:272] - INFO: epoch 001:   9385 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=33.877, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=225.2, ups=0.58, wpb=385.6, bsz=32, num_updates=9370, lr=9.51263e-06, gnorm=3.621, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19301
2022-05-09 02:10:51 - progress_bar.py[line:272] - INFO: epoch 001:   9395 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=379.1, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=33.785, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=219.1, ups=0.58, wpb=379.1, bsz=32, num_updates=9380, lr=9.51142e-06, gnorm=3.787, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19319
2022-05-09 02:11:08 - progress_bar.py[line:272] - INFO: epoch 001:   9405 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889026, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=33.872, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223.3, ups=0.58, wpb=382.7, bsz=32, num_updates=9390, lr=9.51022e-06, gnorm=3.008, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19336
2022-05-09 02:11:25 - progress_bar.py[line:272] - INFO: epoch 001:   9415 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=383.8, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87401, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.917, expert1_balance_bottom=18.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.1, ups=0.57, wpb=383.8, bsz=32, num_updates=9400, lr=9.50902e-06, gnorm=3.093, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19353
2022-05-09 02:11:42 - progress_bar.py[line:272] - INFO: epoch 001:   9425 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=390, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.178, expert1_balance_top=33.276, expert1_balance_bottom=19.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.4, ups=0.58, wpb=390, bsz=32, num_updates=9410, lr=9.50782e-06, gnorm=3.041, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19370
2022-05-09 02:12:00 - progress_bar.py[line:272] - INFO: epoch 001:   9435 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=387.1, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.553, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220.3, ups=0.57, wpb=387.1, bsz=32, num_updates=9420, lr=9.50662e-06, gnorm=3.458, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19388
2022-05-09 02:12:17 - progress_bar.py[line:272] - INFO: epoch 001:   9445 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=391.5, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884458, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.325, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=224, ups=0.57, wpb=391.5, bsz=32, num_updates=9430, lr=9.50542e-06, gnorm=2.986, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19405
2022-05-09 02:12:35 - progress_bar.py[line:272] - INFO: epoch 001:   9455 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=372.1, nsentences=32, sample_size=296.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=34.046, expert1_balance_bottom=19.231, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=216.5, ups=0.58, wpb=372.1, bsz=32, num_updates=9440, lr=9.50422e-06, gnorm=3.764, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19423
2022-05-09 02:12:52 - progress_bar.py[line:272] - INFO: epoch 001:   9465 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=390.3, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=33.743, expert1_balance_bottom=19.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=227.6, ups=0.58, wpb=390.3, bsz=32, num_updates=9450, lr=9.50302e-06, gnorm=3.578, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19440
2022-05-09 02:13:10 - progress_bar.py[line:272] - INFO: epoch 001:   9475 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=382.1, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88448, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.304, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=215.3, ups=0.56, wpb=382.1, bsz=32, num_updates=9460, lr=9.50181e-06, gnorm=3.235, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19458
2022-05-09 02:13:27 - progress_bar.py[line:272] - INFO: epoch 001:   9485 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=388.4, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874927, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.542, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216.5, ups=0.56, wpb=388.4, bsz=32, num_updates=9470, lr=9.50061e-06, gnorm=3.272, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19476
2022-05-09 02:13:45 - progress_bar.py[line:272] - INFO: epoch 001:   9495 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=33.856, expert1_balance_bottom=19.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.6, ups=0.56, wpb=382.4, bsz=32, num_updates=9480, lr=9.49941e-06, gnorm=3.622, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19493
2022-05-09 02:14:03 - progress_bar.py[line:272] - INFO: epoch 001:   9505 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=383.5, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.178, expert1_balance_bottom=19.186, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.1, ups=0.56, wpb=383.5, bsz=32, num_updates=9490, lr=9.49821e-06, gnorm=2.78, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19511
2022-05-09 02:14:21 - progress_bar.py[line:272] - INFO: epoch 001:   9515 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880881, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.723, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211, ups=0.55, wpb=381.9, bsz=32, num_updates=9500, lr=9.49701e-06, gnorm=3.214, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19530
2022-05-09 02:14:40 - progress_bar.py[line:272] - INFO: epoch 001:   9525 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=380, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=33.706, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.5, ups=0.55, wpb=380, bsz=32, num_updates=9510, lr=9.49581e-06, gnorm=3.132, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19548
2022-05-09 02:14:58 - progress_bar.py[line:272] - INFO: epoch 001:   9535 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=393.6, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=34.555, expert1_balance_bottom=19.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=217.4, ups=0.55, wpb=393.6, bsz=32, num_updates=9520, lr=9.49461e-06, gnorm=3.396, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19566
2022-05-09 02:15:15 - progress_bar.py[line:272] - INFO: epoch 001:   9545 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=382.3, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.735, expert1_balance_bottom=19.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=215.5, ups=0.56, wpb=382.3, bsz=32, num_updates=9530, lr=9.4934e-06, gnorm=3.118, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19583
2022-05-09 02:15:33 - progress_bar.py[line:272] - INFO: epoch 001:   9555 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890648, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=33.843, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.6, ups=0.56, wpb=380.6, bsz=32, num_updates=9540, lr=9.4922e-06, gnorm=3.157, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19601
2022-05-09 02:15:52 - progress_bar.py[line:272] - INFO: epoch 001:   9565 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=379.6, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=33.297, expert1_balance_bottom=19.716, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.7, ups=0.55, wpb=379.6, bsz=32, num_updates=9550, lr=9.491e-06, gnorm=3.28, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19620
2022-05-09 02:16:09 - progress_bar.py[line:272] - INFO: epoch 001:   9575 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=388.4, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881124, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.137, expert1_balance_bottom=19.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=216.4, ups=0.56, wpb=388.4, bsz=32, num_updates=9560, lr=9.4898e-06, gnorm=3.454, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19638
2022-05-09 02:16:27 - progress_bar.py[line:272] - INFO: epoch 001:   9585 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=385.1, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.453, expert1_balance_bottom=19.128, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=219.6, ups=0.57, wpb=385.1, bsz=32, num_updates=9570, lr=9.4886e-06, gnorm=3.59, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19655
2022-05-09 02:16:45 - progress_bar.py[line:272] - INFO: epoch 001:   9595 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=34.14, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.2, ups=0.55, wpb=380.7, bsz=32, num_updates=9580, lr=9.4874e-06, gnorm=3.126, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19673
2022-05-09 02:17:03 - progress_bar.py[line:272] - INFO: epoch 001:   9605 / 17711 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.98, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869227, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.169, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.962, expert1_balance_bottom=19.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=215.5, ups=0.56, wpb=386.1, bsz=32, num_updates=9590, lr=9.4862e-06, gnorm=3.651, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19691
2022-05-09 02:17:21 - progress_bar.py[line:272] - INFO: epoch 001:   9615 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=373.8, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895457, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=33.467, expert1_balance_bottom=19.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=207.8, ups=0.56, wpb=373.8, bsz=32, num_updates=9600, lr=9.485e-06, gnorm=3.495, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19709
2022-05-09 02:17:39 - progress_bar.py[line:272] - INFO: epoch 001:   9625 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=34.298, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.9, ups=0.56, wpb=383.5, bsz=32, num_updates=9610, lr=9.48379e-06, gnorm=3.849, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19727
2022-05-09 02:17:57 - progress_bar.py[line:272] - INFO: epoch 001:   9635 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=373.3, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.23, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.9, ups=0.57, wpb=373.3, bsz=32, num_updates=9620, lr=9.48259e-06, gnorm=3.199, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19745
2022-05-09 02:18:04 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 02:18:16 - progress_bar.py[line:272] - INFO: epoch 001:   9646 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=390.9, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=34.053, expert1_balance_bottom=19.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=197.9, ups=0.51, wpb=390.9, bsz=32, num_updates=9630, lr=9.48139e-06, gnorm=2.978, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19764
2022-05-09 02:18:35 - progress_bar.py[line:272] - INFO: epoch 001:   9656 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=372.7, nsentences=32, sample_size=296.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886964, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.006, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=205.3, ups=0.55, wpb=372.7, bsz=32, num_updates=9640, lr=9.48019e-06, gnorm=3.034, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19783
2022-05-09 02:18:53 - progress_bar.py[line:272] - INFO: epoch 001:   9666 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=380.9, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.025, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=207.5, ups=0.54, wpb=380.9, bsz=32, num_updates=9650, lr=9.47899e-06, gnorm=3.595, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19801
2022-05-09 02:19:11 - progress_bar.py[line:272] - INFO: epoch 001:   9676 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=33.588, expert1_balance_bottom=19.51, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.6, ups=0.55, wpb=385.7, bsz=32, num_updates=9660, lr=9.47779e-06, gnorm=3.101, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19819
2022-05-09 02:19:29 - progress_bar.py[line:272] - INFO: epoch 001:   9686 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=377.6, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.698, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=207.9, ups=0.55, wpb=377.6, bsz=32, num_updates=9670, lr=9.47659e-06, gnorm=3.238, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19837
2022-05-09 02:19:47 - progress_bar.py[line:272] - INFO: epoch 001:   9696 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=387.5, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.17, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.5, ups=0.55, wpb=387.5, bsz=32, num_updates=9680, lr=9.47539e-06, gnorm=3.056, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19855
2022-05-09 02:20:06 - progress_bar.py[line:272] - INFO: epoch 001:   9706 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=388.1, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.668, expert1_balance_bottom=19.016, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.3, ups=0.55, wpb=388.1, bsz=32, num_updates=9690, lr=9.47418e-06, gnorm=2.961, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19874
2022-05-09 02:20:23 - progress_bar.py[line:272] - INFO: epoch 001:   9716 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=386.5, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.494, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=216, ups=0.56, wpb=386.5, bsz=32, num_updates=9700, lr=9.47298e-06, gnorm=3.606, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19891
2022-05-09 02:20:42 - progress_bar.py[line:272] - INFO: epoch 001:   9726 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=385.8, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.606, expert1_balance_bottom=18.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.7, ups=0.55, wpb=385.8, bsz=32, num_updates=9710, lr=9.47178e-06, gnorm=3.061, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19910
2022-05-09 02:21:00 - progress_bar.py[line:272] - INFO: epoch 001:   9736 / 17711 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.157, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.179, expert1_balance_top=33.677, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=210.9, ups=0.56, wpb=379.1, bsz=32, num_updates=9720, lr=9.47058e-06, gnorm=3.517, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19928
2022-05-09 02:21:18 - progress_bar.py[line:272] - INFO: epoch 001:   9746 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=382, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883771, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.339, expert1_balance_bottom=19.188, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.3, ups=0.55, wpb=382, bsz=32, num_updates=9730, lr=9.46938e-06, gnorm=2.951, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19946
2022-05-09 02:21:35 - progress_bar.py[line:272] - INFO: epoch 001:   9756 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880067, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.277, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=217, ups=0.56, wpb=385.7, bsz=32, num_updates=9740, lr=9.46818e-06, gnorm=3.254, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19963
2022-05-09 02:21:53 - progress_bar.py[line:272] - INFO: epoch 001:   9766 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=385.1, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.243, expert1_balance_bottom=19.292, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.8, ups=0.56, wpb=385.1, bsz=32, num_updates=9750, lr=9.46698e-06, gnorm=3.601, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19981
2022-05-09 02:22:11 - progress_bar.py[line:272] - INFO: epoch 001:   9776 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881121, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.339, expert1_balance_bottom=19.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=212.8, ups=0.56, wpb=380.6, bsz=32, num_updates=9760, lr=9.46577e-06, gnorm=3.816, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=19999
2022-05-09 02:22:29 - progress_bar.py[line:272] - INFO: epoch 001:   9786 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=384.8, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=33.972, expert1_balance_bottom=19.312, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.6, ups=0.55, wpb=384.8, bsz=32, num_updates=9770, lr=9.46457e-06, gnorm=3.089, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20017
2022-05-09 02:22:47 - progress_bar.py[line:272] - INFO: epoch 001:   9796 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=389.5, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874338, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.798, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=216.7, ups=0.56, wpb=389.5, bsz=32, num_updates=9780, lr=9.46337e-06, gnorm=3.259, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20035
2022-05-09 02:23:05 - progress_bar.py[line:272] - INFO: epoch 001:   9806 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=371, nsentences=32, sample_size=295.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=33.831, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=206.6, ups=0.56, wpb=371, bsz=32, num_updates=9790, lr=9.46217e-06, gnorm=3.203, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20053
2022-05-09 02:23:23 - progress_bar.py[line:272] - INFO: epoch 001:   9816 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.071, expert1_balance_bottom=19.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.3, ups=0.56, wpb=378.8, bsz=32, num_updates=9800, lr=9.46097e-06, gnorm=3.914, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20071
2022-05-09 02:23:41 - progress_bar.py[line:272] - INFO: epoch 001:   9826 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=386.5, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886103, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=34.431, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.1, ups=0.56, wpb=386.5, bsz=32, num_updates=9810, lr=9.45977e-06, gnorm=3.203, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20089
2022-05-09 02:23:59 - progress_bar.py[line:272] - INFO: epoch 001:   9836 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=376, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88079, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.75, expert1_balance_bottom=18.848, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=208.4, ups=0.55, wpb=376, bsz=32, num_updates=9820, lr=9.45857e-06, gnorm=3.369, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20107
2022-05-09 02:24:17 - progress_bar.py[line:272] - INFO: epoch 001:   9846 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=376.8, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881421, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.623, expert1_balance_bottom=19.181, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.3, ups=0.55, wpb=376.8, bsz=32, num_updates=9830, lr=9.45737e-06, gnorm=3.475, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20125
2022-05-09 02:24:35 - progress_bar.py[line:272] - INFO: epoch 001:   9856 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=33.666, expert1_balance_bottom=19.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211, ups=0.56, wpb=378.6, bsz=32, num_updates=9840, lr=9.45616e-06, gnorm=3.31, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20143
2022-05-09 02:24:53 - progress_bar.py[line:272] - INFO: epoch 001:   9866 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=381.3, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88901, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=33.756, expert1_balance_bottom=19.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.7, ups=0.56, wpb=381.3, bsz=32, num_updates=9850, lr=9.45496e-06, gnorm=3.73, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20161
2022-05-09 02:25:11 - progress_bar.py[line:272] - INFO: epoch 001:   9876 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89175, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=33.465, expert1_balance_bottom=19.446, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.3, ups=0.56, wpb=381.8, bsz=32, num_updates=9860, lr=9.45376e-06, gnorm=3.47, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20179
2022-05-09 02:25:29 - progress_bar.py[line:272] - INFO: epoch 001:   9886 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=387.8, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8927, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=33.7, expert1_balance_bottom=19.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.7, ups=0.55, wpb=387.8, bsz=32, num_updates=9870, lr=9.45256e-06, gnorm=3.19, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20197
2022-05-09 02:25:47 - progress_bar.py[line:272] - INFO: epoch 001:   9896 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=381.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891604, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=33.722, expert1_balance_bottom=19.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.8, ups=0.55, wpb=381.8, bsz=32, num_updates=9880, lr=9.45136e-06, gnorm=3.848, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20215
2022-05-09 02:26:05 - progress_bar.py[line:272] - INFO: epoch 001:   9906 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=387.1, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.633, expert1_balance_bottom=19.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.5, ups=0.56, wpb=387.1, bsz=32, num_updates=9890, lr=9.45016e-06, gnorm=3.551, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20233
2022-05-09 02:26:23 - progress_bar.py[line:272] - INFO: epoch 001:   9916 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=390.8, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.757, expert1_balance_bottom=19.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.8, ups=0.56, wpb=390.8, bsz=32, num_updates=9900, lr=9.44896e-06, gnorm=2.916, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20251
2022-05-09 02:26:41 - progress_bar.py[line:272] - INFO: epoch 001:   9926 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885251, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=34.335, expert1_balance_bottom=19.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=216, ups=0.56, wpb=384.2, bsz=32, num_updates=9910, lr=9.44775e-06, gnorm=3.213, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20269
2022-05-09 02:26:59 - progress_bar.py[line:272] - INFO: epoch 001:   9936 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=386.8, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880442, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.281, expert1_balance_bottom=19.193, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=216.6, ups=0.56, wpb=386.8, bsz=32, num_updates=9920, lr=9.44655e-06, gnorm=2.95, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20287
2022-05-09 02:27:17 - progress_bar.py[line:272] - INFO: epoch 001:   9946 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=382.6, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886642, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=33.981, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.6, ups=0.56, wpb=382.6, bsz=32, num_updates=9930, lr=9.44535e-06, gnorm=3.173, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20305
2022-05-09 02:27:35 - progress_bar.py[line:272] - INFO: epoch 001:   9956 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=369.9, nsentences=32, sample_size=293.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889263, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=33.907, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=199.4, ups=0.54, wpb=369.9, bsz=32, num_updates=9940, lr=9.44415e-06, gnorm=3.112, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20323
2022-05-09 02:27:53 - progress_bar.py[line:272] - INFO: epoch 001:   9966 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=378, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88873, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=33.559, expert1_balance_bottom=19.333, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=209.4, ups=0.55, wpb=378, bsz=32, num_updates=9950, lr=9.44295e-06, gnorm=3.315, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20341
2022-05-09 02:28:11 - progress_bar.py[line:272] - INFO: epoch 001:   9976 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=376, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88867, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=33.937, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.2, ups=0.56, wpb=376, bsz=32, num_updates=9960, lr=9.44175e-06, gnorm=3.385, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20359
2022-05-09 02:28:29 - progress_bar.py[line:272] - INFO: epoch 001:   9986 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=379, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879405, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.243, expert1_balance_bottom=19.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=212, ups=0.56, wpb=379, bsz=32, num_updates=9970, lr=9.44055e-06, gnorm=4.188, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20377
2022-05-09 02:28:47 - progress_bar.py[line:272] - INFO: epoch 001:   9996 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=379.2, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.599, expert1_balance_bottom=19.155, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.8, ups=0.56, wpb=379.2, bsz=32, num_updates=9980, lr=9.43935e-06, gnorm=3.08, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20395
2022-05-09 02:29:05 - progress_bar.py[line:272] - INFO: epoch 001:  10006 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893696, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=33.786, expert1_balance_bottom=19.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.8, ups=0.56, wpb=379.3, bsz=32, num_updates=9990, lr=9.43814e-06, gnorm=3.106, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20413
2022-05-09 02:29:23 - progress_bar.py[line:272] - INFO: epoch 001:  10016 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=377.6, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880058, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.444, expert1_balance_bottom=19.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=208.8, ups=0.55, wpb=377.6, bsz=32, num_updates=10000, lr=9.43694e-06, gnorm=3.519, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20431
2022-05-09 02:29:23 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 02:29:23 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 02:29:23 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 02:36:46 - train.py[line:517] - INFO: valid_step finished
2022-05-09 02:36:46 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.641 | loss_v1 0 | loss_v2 0 | nll_loss 7.941 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.976395 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.641 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.229 | expert1_balance_top 35.807 | expert1_balance_bottom 15.021 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 245.82 | cider 1.198 | wps 679.2 | wpb 481.7 | bsz 8 | num_updates 10000 | best_cider 1.198
2022-05-09 02:36:46 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 1 @ 10000 updates
2022-05-09 02:36:46 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_10000-rank-0.pt
2022-05-09 02:36:46 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_10000-rank-0.pt
2022-05-09 02:36:56 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_10000-rank-0.pt
2022-05-09 02:36:56 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_10000-shared.pt
2022-05-09 02:37:05 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_10000-shared.pt
2022-05-09 02:37:38 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_10000-rank-0.pt (epoch 1 @ 10000 updates, score 1.198) (writing took 51.13172905892134 seconds)
2022-05-09 02:37:56 - progress_bar.py[line:272] - INFO: epoch 001:  10026 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=390.2, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877768, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.85, expert1_balance_bottom=18.866, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=7.6, ups=0.02, wpb=390.2, bsz=32, num_updates=10010, lr=9.43574e-06, gnorm=3.181, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20944
2022-05-09 02:38:14 - progress_bar.py[line:272] - INFO: epoch 001:  10036 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=384.6, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.057, expert1_balance_bottom=19.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.5, ups=0.56, wpb=384.6, bsz=32, num_updates=10020, lr=9.43454e-06, gnorm=2.785, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20962
2022-05-09 02:38:32 - progress_bar.py[line:272] - INFO: epoch 001:  10046 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.338, expert1_balance_bottom=19.143, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=212.7, ups=0.55, wpb=383.3, bsz=32, num_updates=10030, lr=9.43334e-06, gnorm=3.434, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20980
2022-05-09 02:38:51 - progress_bar.py[line:272] - INFO: epoch 001:  10056 / 17711 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=380.4, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886135, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.152, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.343, expert1_balance_bottom=19.063, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=208.9, ups=0.55, wpb=380.4, bsz=32, num_updates=10040, lr=9.43214e-06, gnorm=3.651, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=20999
2022-05-09 02:39:09 - progress_bar.py[line:272] - INFO: epoch 001:  10066 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886406, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.827, expert1_balance_bottom=19.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=208.6, ups=0.55, wpb=379.9, bsz=32, num_updates=10050, lr=9.43094e-06, gnorm=3.303, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21017
2022-05-09 02:39:27 - progress_bar.py[line:272] - INFO: epoch 001:  10076 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=372, nsentences=32, sample_size=296.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889856, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=33.872, expert1_balance_bottom=19.124, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=204.3, ups=0.55, wpb=372, bsz=32, num_updates=10060, lr=9.42973e-06, gnorm=3.09, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21035
2022-05-09 02:39:45 - progress_bar.py[line:272] - INFO: epoch 001:  10086 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=383, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.598, expert1_balance_bottom=18.991, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.4, ups=0.55, wpb=383, bsz=32, num_updates=10070, lr=9.42853e-06, gnorm=3.009, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21053
2022-05-09 02:40:03 - progress_bar.py[line:272] - INFO: epoch 001:  10096 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=375.3, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=33.466, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=205.9, ups=0.55, wpb=375.3, bsz=32, num_updates=10080, lr=9.42733e-06, gnorm=3.731, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21071
2022-05-09 02:40:22 - progress_bar.py[line:272] - INFO: epoch 001:  10106 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=390.6, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.167, expert1_balance_bottom=19.083, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.5, ups=0.55, wpb=390.6, bsz=32, num_updates=10090, lr=9.42613e-06, gnorm=2.884, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21090
2022-05-09 02:40:40 - progress_bar.py[line:272] - INFO: epoch 001:  10116 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=376.9, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.356, expert1_balance_bottom=19.073, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=209.8, ups=0.56, wpb=376.9, bsz=32, num_updates=10100, lr=9.42493e-06, gnorm=3.019, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21108
2022-05-09 02:40:58 - progress_bar.py[line:272] - INFO: epoch 001:  10126 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=386.1, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.67, expert1_balance_bottom=18.97, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.9, ups=0.56, wpb=386.1, bsz=32, num_updates=10110, lr=9.42373e-06, gnorm=3.019, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21126
2022-05-09 02:41:16 - progress_bar.py[line:272] - INFO: epoch 001:  10136 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=382.6, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=33.842, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=207.4, ups=0.54, wpb=382.6, bsz=32, num_updates=10120, lr=9.42253e-06, gnorm=3.823, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21144
2022-05-09 02:41:34 - progress_bar.py[line:272] - INFO: epoch 001:  10146 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=376.4, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892038, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=33.801, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=207.8, ups=0.55, wpb=376.4, bsz=32, num_updates=10130, lr=9.42133e-06, gnorm=3.222, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21162
2022-05-09 02:41:52 - progress_bar.py[line:272] - INFO: epoch 001:  10156 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=391.2, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88118, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.219, expert1_balance_bottom=19.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.3, ups=0.55, wpb=391.2, bsz=32, num_updates=10140, lr=9.42012e-06, gnorm=3.386, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21180
2022-05-09 02:42:11 - progress_bar.py[line:272] - INFO: epoch 001:  10166 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=383.6, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=33.488, expert1_balance_bottom=19.526, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=207.8, ups=0.54, wpb=383.6, bsz=32, num_updates=10150, lr=9.41892e-06, gnorm=2.984, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21199
2022-05-09 02:42:29 - progress_bar.py[line:272] - INFO: epoch 001:  10176 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=377.9, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.189, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.4, ups=0.56, wpb=377.9, bsz=32, num_updates=10160, lr=9.41772e-06, gnorm=3.381, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21217
2022-05-09 02:42:47 - progress_bar.py[line:272] - INFO: epoch 001:  10186 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=380.8, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873668, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.942, expert1_balance_bottom=18.961, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=207.9, ups=0.55, wpb=380.8, bsz=32, num_updates=10170, lr=9.41652e-06, gnorm=2.894, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21235
2022-05-09 02:43:05 - progress_bar.py[line:272] - INFO: epoch 001:  10196 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882733, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.903, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.5, ups=0.55, wpb=382.1, bsz=32, num_updates=10180, lr=9.41532e-06, gnorm=3.215, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21253
2022-05-09 02:43:23 - progress_bar.py[line:272] - INFO: epoch 001:  10206 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902038, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.18, expert1_balance_top=33.091, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.9, ups=0.57, wpb=382, bsz=32, num_updates=10190, lr=9.41412e-06, gnorm=3.517, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21271
2022-05-09 02:43:41 - progress_bar.py[line:272] - INFO: epoch 001:  10216 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=380.2, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873877, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.446, expert1_balance_bottom=19.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=206.9, ups=0.54, wpb=380.2, bsz=32, num_updates=10200, lr=9.41292e-06, gnorm=2.935, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21289
2022-05-09 02:43:59 - progress_bar.py[line:272] - INFO: epoch 001:  10226 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=33.99, expert1_balance_bottom=19.26, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208, ups=0.55, wpb=380.1, bsz=32, num_updates=10210, lr=9.41172e-06, gnorm=3.52, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21308
2022-05-09 02:44:18 - progress_bar.py[line:272] - INFO: epoch 001:  10236 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=378.7, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884874, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.02, expert1_balance_bottom=19.417, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=206.8, ups=0.55, wpb=378.7, bsz=32, num_updates=10220, lr=9.41051e-06, gnorm=3.34, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21326
2022-05-09 02:44:36 - progress_bar.py[line:272] - INFO: epoch 001:  10246 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=384.5, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.645, expert1_balance_bottom=19.22, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=211.4, ups=0.55, wpb=384.5, bsz=32, num_updates=10230, lr=9.40931e-06, gnorm=3.428, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21344
2022-05-09 02:44:54 - progress_bar.py[line:272] - INFO: epoch 001:  10256 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=385.4, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.664, expert1_balance_bottom=19.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=214.1, ups=0.56, wpb=385.4, bsz=32, num_updates=10240, lr=9.40811e-06, gnorm=3.194, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21362
2022-05-09 02:45:12 - progress_bar.py[line:272] - INFO: epoch 001:  10266 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=375.7, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873769, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.958, expert1_balance_bottom=19.093, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.4, ups=0.56, wpb=375.7, bsz=32, num_updates=10250, lr=9.40691e-06, gnorm=3.698, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21380
2022-05-09 02:45:30 - progress_bar.py[line:272] - INFO: epoch 001:  10276 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=382.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=33.641, expert1_balance_bottom=19.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.9, ups=0.56, wpb=382.8, bsz=32, num_updates=10260, lr=9.40571e-06, gnorm=3.823, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21398
2022-05-09 02:45:48 - progress_bar.py[line:272] - INFO: epoch 001:  10286 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888745, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=33.775, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.5, ups=0.56, wpb=383.3, bsz=32, num_updates=10270, lr=9.40451e-06, gnorm=3.494, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21416
2022-05-09 02:46:05 - progress_bar.py[line:272] - INFO: epoch 001:  10296 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880515, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.555, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=215.5, ups=0.57, wpb=380.7, bsz=32, num_updates=10280, lr=9.40331e-06, gnorm=3.735, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21433
2022-05-09 02:46:23 - progress_bar.py[line:272] - INFO: epoch 001:  10306 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879172, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.444, expert1_balance_bottom=19.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.3, ups=0.56, wpb=382.3, bsz=32, num_updates=10290, lr=9.4021e-06, gnorm=3.439, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21451
2022-05-09 02:46:41 - progress_bar.py[line:272] - INFO: epoch 001:  10316 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=381.5, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=33.325, expert1_balance_bottom=19.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.5, ups=0.56, wpb=381.5, bsz=32, num_updates=10300, lr=9.4009e-06, gnorm=3.268, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21469
2022-05-09 02:46:59 - progress_bar.py[line:272] - INFO: epoch 001:  10326 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883677, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.489, expert1_balance_bottom=19.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.9, ups=0.56, wpb=378.7, bsz=32, num_updates=10310, lr=9.3997e-06, gnorm=3.281, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21487
2022-05-09 02:47:17 - progress_bar.py[line:272] - INFO: epoch 001:  10336 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.133, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=207, ups=0.55, wpb=378.7, bsz=32, num_updates=10320, lr=9.3985e-06, gnorm=2.83, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21505
2022-05-09 02:47:36 - progress_bar.py[line:272] - INFO: epoch 001:  10346 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=377, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.796, expert1_balance_bottom=19.124, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=204.1, ups=0.54, wpb=377, bsz=32, num_updates=10330, lr=9.3973e-06, gnorm=3.358, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21524
2022-05-09 02:47:54 - progress_bar.py[line:272] - INFO: epoch 001:  10356 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=373.3, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899762, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.177, expert1_balance_top=33.521, expert1_balance_bottom=19.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=206.6, ups=0.55, wpb=373.3, bsz=32, num_updates=10340, lr=9.3961e-06, gnorm=3.425, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21542
2022-05-09 02:48:12 - progress_bar.py[line:272] - INFO: epoch 001:  10366 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=383.7, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878227, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.757, expert1_balance_bottom=19.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=211.7, ups=0.55, wpb=383.7, bsz=32, num_updates=10350, lr=9.3949e-06, gnorm=3.581, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21560
2022-05-09 02:48:30 - progress_bar.py[line:272] - INFO: epoch 001:  10376 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=386.4, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.578, expert1_balance_bottom=19.097, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.8, ups=0.55, wpb=386.4, bsz=32, num_updates=10360, lr=9.3937e-06, gnorm=3.665, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21578
2022-05-09 02:48:48 - progress_bar.py[line:272] - INFO: epoch 001:  10386 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=379.3, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=33.967, expert1_balance_bottom=19.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.4, ups=0.56, wpb=379.3, bsz=32, num_updates=10370, lr=9.39249e-06, gnorm=3.073, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21596
2022-05-09 02:49:06 - progress_bar.py[line:272] - INFO: epoch 001:  10396 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=33.575, expert1_balance_bottom=19.559, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.4, ups=0.56, wpb=381.8, bsz=32, num_updates=10380, lr=9.39129e-06, gnorm=3.413, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21614
2022-05-09 02:49:24 - progress_bar.py[line:272] - INFO: epoch 001:  10406 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.865, expert1_balance_bottom=18.972, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.5, ups=0.56, wpb=383.5, bsz=32, num_updates=10390, lr=9.39009e-06, gnorm=3.324, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21632
2022-05-09 02:49:41 - progress_bar.py[line:272] - INFO: epoch 001:  10416 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=387.6, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877776, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.729, expert1_balance_bottom=18.99, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=218.8, ups=0.56, wpb=387.6, bsz=32, num_updates=10400, lr=9.38889e-06, gnorm=3.684, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21649
2022-05-09 02:49:59 - progress_bar.py[line:272] - INFO: epoch 001:  10426 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.176, expert1_balance_top=33.672, expert1_balance_bottom=19.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213, ups=0.56, wpb=381.2, bsz=32, num_updates=10410, lr=9.38769e-06, gnorm=3.34, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21667
2022-05-09 02:50:17 - progress_bar.py[line:272] - INFO: epoch 001:  10436 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884931, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.151, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.7, ups=0.56, wpb=380.3, bsz=32, num_updates=10420, lr=9.38649e-06, gnorm=3.168, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21685
2022-05-09 02:50:35 - progress_bar.py[line:272] - INFO: epoch 001:  10446 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=380.2, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889344, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=34.094, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.6, ups=0.56, wpb=380.2, bsz=32, num_updates=10430, lr=9.38529e-06, gnorm=3.316, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21703
2022-05-09 02:50:52 - progress_bar.py[line:272] - INFO: epoch 001:  10456 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.529, expert1_balance_bottom=19.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216.1, ups=0.56, wpb=383.9, bsz=32, num_updates=10440, lr=9.38408e-06, gnorm=3.575, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21720
2022-05-09 02:51:10 - progress_bar.py[line:272] - INFO: epoch 001:  10466 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=34.432, expert1_balance_bottom=19.239, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.5, ups=0.56, wpb=378.4, bsz=32, num_updates=10450, lr=9.38288e-06, gnorm=3.572, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21738
2022-05-09 02:51:28 - progress_bar.py[line:272] - INFO: epoch 001:  10476 / 17711 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=375.3, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.137, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=33.873, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=208.8, ups=0.56, wpb=375.3, bsz=32, num_updates=10460, lr=9.38168e-06, gnorm=3.922, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21756
2022-05-09 02:51:46 - progress_bar.py[line:272] - INFO: epoch 001:  10486 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=391.9, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882214, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.27, expert1_balance_bottom=19.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=220.1, ups=0.56, wpb=391.9, bsz=32, num_updates=10470, lr=9.38048e-06, gnorm=4.172, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21774
2022-05-09 02:52:04 - progress_bar.py[line:272] - INFO: epoch 001:  10496 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886811, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.1, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.8, ups=0.56, wpb=383.9, bsz=32, num_updates=10480, lr=9.37928e-06, gnorm=3.372, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21792
2022-05-09 02:52:22 - progress_bar.py[line:272] - INFO: epoch 001:  10506 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=375.4, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.175, expert1_balance_top=34.043, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=207.7, ups=0.55, wpb=375.4, bsz=32, num_updates=10490, lr=9.37808e-06, gnorm=3.562, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21810
2022-05-09 02:52:40 - progress_bar.py[line:272] - INFO: epoch 001:  10516 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879604, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=33.987, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.4, ups=0.55, wpb=385.7, bsz=32, num_updates=10500, lr=9.37688e-06, gnorm=3.593, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21828
2022-05-09 02:52:58 - progress_bar.py[line:272] - INFO: epoch 001:  10526 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=386.1, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.031, expert1_balance_bottom=19.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=215.9, ups=0.56, wpb=386.1, bsz=32, num_updates=10510, lr=9.37568e-06, gnorm=3.721, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21846
2022-05-09 02:53:16 - progress_bar.py[line:272] - INFO: epoch 001:  10536 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=374.8, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.146, expert1_balance_bottom=19.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.6, ups=0.57, wpb=374.8, bsz=32, num_updates=10520, lr=9.37447e-06, gnorm=3.565, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21864
2022-05-09 02:53:33 - progress_bar.py[line:272] - INFO: epoch 001:  10546 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=381.9, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885321, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.794, expert1_balance_bottom=19.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.1, ups=0.56, wpb=381.9, bsz=32, num_updates=10530, lr=9.37327e-06, gnorm=3.427, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21882
2022-05-09 02:53:51 - progress_bar.py[line:272] - INFO: epoch 001:  10556 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=379, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.301, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.3, ups=0.56, wpb=379, bsz=32, num_updates=10540, lr=9.37207e-06, gnorm=3.368, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21899
2022-05-09 02:54:09 - progress_bar.py[line:272] - INFO: epoch 001:  10566 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.071, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=214.6, ups=0.56, wpb=382.8, bsz=32, num_updates=10550, lr=9.37087e-06, gnorm=3.306, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21917
2022-05-09 02:54:27 - progress_bar.py[line:272] - INFO: epoch 001:  10576 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=374.3, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.174, expert1_balance_top=33.382, expert1_balance_bottom=19.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209, ups=0.56, wpb=374.3, bsz=32, num_updates=10560, lr=9.36967e-06, gnorm=3.334, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21935
2022-05-09 02:54:45 - progress_bar.py[line:272] - INFO: epoch 001:  10586 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=380.4, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878684, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.366, expert1_balance_bottom=19.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=209.8, ups=0.55, wpb=380.4, bsz=32, num_updates=10570, lr=9.36847e-06, gnorm=3.326, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21953
2022-05-09 02:55:03 - progress_bar.py[line:272] - INFO: epoch 001:  10596 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=33.922, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=209.3, ups=0.55, wpb=381.1, bsz=32, num_updates=10580, lr=9.36727e-06, gnorm=3.618, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21971
2022-05-09 02:55:22 - progress_bar.py[line:272] - INFO: epoch 001:  10606 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=33.745, expert1_balance_bottom=19.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=207.5, ups=0.55, wpb=379.9, bsz=32, num_updates=10590, lr=9.36607e-06, gnorm=3.059, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=21990
2022-05-09 02:55:39 - progress_bar.py[line:272] - INFO: epoch 001:  10616 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=392.1, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871497, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.981, expert1_balance_bottom=19.161, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=220, ups=0.56, wpb=392.1, bsz=32, num_updates=10600, lr=9.36486e-06, gnorm=3.546, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22008
2022-05-09 02:55:57 - progress_bar.py[line:272] - INFO: epoch 001:  10626 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880082, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.365, expert1_balance_bottom=19.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213.1, ups=0.56, wpb=383.3, bsz=32, num_updates=10610, lr=9.36366e-06, gnorm=3.123, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22026
2022-05-09 02:56:15 - progress_bar.py[line:272] - INFO: epoch 001:  10636 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=388.5, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.324, expert1_balance_bottom=19.041, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=218, ups=0.56, wpb=388.5, bsz=32, num_updates=10620, lr=9.36246e-06, gnorm=3.002, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22043
2022-05-09 02:56:33 - progress_bar.py[line:272] - INFO: epoch 001:  10646 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=387.9, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.222, expert1_balance_bottom=19.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.3, ups=0.55, wpb=387.9, bsz=32, num_updates=10630, lr=9.36126e-06, gnorm=3.188, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22062
2022-05-09 02:56:51 - progress_bar.py[line:272] - INFO: epoch 001:  10656 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=384.4, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.615, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.8, ups=0.56, wpb=384.4, bsz=32, num_updates=10640, lr=9.36006e-06, gnorm=2.993, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22080
2022-05-09 02:57:09 - progress_bar.py[line:272] - INFO: epoch 001:  10666 / 17711 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878051, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.156, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.309, expert1_balance_bottom=19.002, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=213.6, ups=0.56, wpb=383.8, bsz=32, num_updates=10650, lr=9.35886e-06, gnorm=3.738, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22097
2022-05-09 02:57:27 - progress_bar.py[line:272] - INFO: epoch 001:  10676 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=377.3, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.052, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.3, ups=0.56, wpb=377.3, bsz=32, num_updates=10660, lr=9.35766e-06, gnorm=3.226, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22115
2022-05-09 02:57:45 - progress_bar.py[line:272] - INFO: epoch 001:  10686 / 17711 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=386.5, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884738, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.19, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.832, expert1_balance_bottom=19.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=217, ups=0.56, wpb=386.5, bsz=32, num_updates=10670, lr=9.35645e-06, gnorm=4.24, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22133
2022-05-09 02:58:03 - progress_bar.py[line:272] - INFO: epoch 001:  10696 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=33.86, expert1_balance_bottom=19.395, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.5, ups=0.56, wpb=379.3, bsz=32, num_updates=10680, lr=9.35525e-06, gnorm=3.158, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22151
2022-05-09 02:58:08 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-09 02:58:23 - progress_bar.py[line:272] - INFO: epoch 001:  10707 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=380.9, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889726, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=33.598, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=190.1, ups=0.5, wpb=380.9, bsz=32, num_updates=10690, lr=9.35405e-06, gnorm=3.303, loss_scale=128, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22171
2022-05-09 02:58:41 - progress_bar.py[line:272] - INFO: epoch 001:  10717 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.167, expert1_balance_bottom=19.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.5, ups=0.55, wpb=382.4, bsz=32, num_updates=10700, lr=9.35285e-06, gnorm=3.252, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22189
2022-05-09 02:58:48 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 02:59:01 - progress_bar.py[line:272] - INFO: epoch 001:  10728 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=33.844, expert1_balance_bottom=19.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=187.1, ups=0.49, wpb=378.8, bsz=32, num_updates=10710, lr=9.35165e-06, gnorm=3.299, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22209
2022-05-09 02:59:19 - progress_bar.py[line:272] - INFO: epoch 001:  10738 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=383.7, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.495, expert1_balance_bottom=19.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=211.1, ups=0.55, wpb=383.7, bsz=32, num_updates=10720, lr=9.35045e-06, gnorm=3.418, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22228
2022-05-09 02:59:37 - progress_bar.py[line:272] - INFO: epoch 001:  10748 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=377.6, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.827, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.8, ups=0.56, wpb=377.6, bsz=32, num_updates=10730, lr=9.34925e-06, gnorm=2.749, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22245
2022-05-09 02:59:55 - progress_bar.py[line:272] - INFO: epoch 001:  10758 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882993, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.071, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.9, ups=0.56, wpb=382.9, bsz=32, num_updates=10740, lr=9.34805e-06, gnorm=3.516, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22263
2022-05-09 03:00:13 - progress_bar.py[line:272] - INFO: epoch 001:  10768 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=387.3, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886856, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.006, expert1_balance_bottom=19.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.5, ups=0.55, wpb=387.3, bsz=32, num_updates=10750, lr=9.34684e-06, gnorm=3.318, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22281
2022-05-09 03:00:31 - progress_bar.py[line:272] - INFO: epoch 001:  10778 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887641, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.288, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.1, ups=0.58, wpb=382.2, bsz=32, num_updates=10760, lr=9.34564e-06, gnorm=3.602, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22299
2022-05-09 03:00:48 - progress_bar.py[line:272] - INFO: epoch 001:  10788 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876283, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.774, expert1_balance_bottom=19.135, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=217.9, ups=0.57, wpb=384.3, bsz=32, num_updates=10770, lr=9.34444e-06, gnorm=3.452, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22316
2022-05-09 03:01:06 - progress_bar.py[line:272] - INFO: epoch 001:  10798 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=384.4, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887981, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.017, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.5, ups=0.56, wpb=384.4, bsz=32, num_updates=10780, lr=9.34324e-06, gnorm=3.488, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22334
2022-05-09 03:01:24 - progress_bar.py[line:272] - INFO: epoch 001:  10808 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.091, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.8, ups=0.55, wpb=377.2, bsz=32, num_updates=10790, lr=9.34204e-06, gnorm=3.576, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22352
2022-05-09 03:01:42 - progress_bar.py[line:272] - INFO: epoch 001:  10818 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=382.8, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87892, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.611, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.3, ups=0.56, wpb=382.8, bsz=32, num_updates=10800, lr=9.34084e-06, gnorm=3.36, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22370
2022-05-09 03:02:00 - progress_bar.py[line:272] - INFO: epoch 001:  10828 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=392.6, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876004, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=35.03, expert1_balance_bottom=18.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216, ups=0.55, wpb=392.6, bsz=32, num_updates=10810, lr=9.33964e-06, gnorm=3.518, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22388
2022-05-09 03:02:18 - progress_bar.py[line:272] - INFO: epoch 001:  10838 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=381.8, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888155, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.302, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.6, ups=0.55, wpb=381.8, bsz=32, num_updates=10820, lr=9.33843e-06, gnorm=3.843, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22406
2022-05-09 03:02:36 - progress_bar.py[line:272] - INFO: epoch 001:  10848 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888169, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.057, expert1_balance_bottom=19.175, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.8, ups=0.56, wpb=383.2, bsz=32, num_updates=10830, lr=9.33723e-06, gnorm=3.18, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22424
2022-05-09 03:02:55 - progress_bar.py[line:272] - INFO: epoch 001:  10858 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=390.3, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.458, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.6, ups=0.54, wpb=390.3, bsz=32, num_updates=10840, lr=9.33603e-06, gnorm=3.046, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22443
2022-05-09 03:03:13 - progress_bar.py[line:272] - INFO: epoch 001:  10868 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=375.5, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.003, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.8, ups=0.55, wpb=375.5, bsz=32, num_updates=10850, lr=9.33483e-06, gnorm=3.345, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22461
2022-05-09 03:03:31 - progress_bar.py[line:272] - INFO: epoch 001:  10878 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=388.5, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=35.07, expert1_balance_bottom=18.864, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210.4, ups=0.54, wpb=388.5, bsz=32, num_updates=10860, lr=9.33363e-06, gnorm=3.755, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22479
2022-05-09 03:03:50 - progress_bar.py[line:272] - INFO: epoch 001:  10888 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8833, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.2, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=209.4, ups=0.55, wpb=383.6, bsz=32, num_updates=10870, lr=9.33243e-06, gnorm=4.441, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22498
2022-05-09 03:04:08 - progress_bar.py[line:272] - INFO: epoch 001:  10898 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=387.7, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.993, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.9, ups=0.55, wpb=387.7, bsz=32, num_updates=10880, lr=9.33123e-06, gnorm=3.378, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22516
2022-05-09 03:04:25 - progress_bar.py[line:272] - INFO: epoch 001:  10908 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=391.4, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.899, expert1_balance_bottom=19.067, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=221.4, ups=0.57, wpb=391.4, bsz=32, num_updates=10890, lr=9.33003e-06, gnorm=3.509, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22534
2022-05-09 03:04:44 - progress_bar.py[line:272] - INFO: epoch 001:  10918 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884357, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.361, expert1_balance_bottom=19.137, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.8, ups=0.55, wpb=382.4, bsz=32, num_updates=10900, lr=9.32882e-06, gnorm=3.812, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22552
2022-05-09 03:05:01 - progress_bar.py[line:272] - INFO: epoch 001:  10928 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=376.6, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.996, expert1_balance_bottom=19.186, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.8, ups=0.56, wpb=376.6, bsz=32, num_updates=10910, lr=9.32762e-06, gnorm=3.344, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22569
2022-05-09 03:05:19 - progress_bar.py[line:272] - INFO: epoch 001:  10938 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=381.4, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=33.731, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.9, ups=0.56, wpb=381.4, bsz=32, num_updates=10920, lr=9.32642e-06, gnorm=3.273, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22587
2022-05-09 03:05:37 - progress_bar.py[line:272] - INFO: epoch 001:  10948 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=388.5, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882677, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=33.951, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.1, ups=0.55, wpb=388.5, bsz=32, num_updates=10930, lr=9.32522e-06, gnorm=3.237, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22605
2022-05-09 03:05:55 - progress_bar.py[line:272] - INFO: epoch 001:  10958 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=382.4, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.52, expert1_balance_bottom=19.097, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=211.8, ups=0.55, wpb=382.4, bsz=32, num_updates=10940, lr=9.32402e-06, gnorm=3.595, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22623
2022-05-09 03:06:13 - progress_bar.py[line:272] - INFO: epoch 001:  10968 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=379.2, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.736, expert1_balance_bottom=19.116, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212, ups=0.56, wpb=379.2, bsz=32, num_updates=10950, lr=9.32282e-06, gnorm=3.579, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22641
2022-05-09 03:06:32 - progress_bar.py[line:272] - INFO: epoch 001:  10978 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=385.8, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.495, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=208.6, ups=0.54, wpb=385.8, bsz=32, num_updates=10960, lr=9.32162e-06, gnorm=3.258, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22660
2022-05-09 03:06:50 - progress_bar.py[line:272] - INFO: epoch 001:  10988 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=384.8, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.91, expert1_balance_bottom=19.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.3, ups=0.56, wpb=384.8, bsz=32, num_updates=10970, lr=9.32042e-06, gnorm=3.836, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22678
2022-05-09 03:07:08 - progress_bar.py[line:272] - INFO: epoch 001:  10998 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=382.7, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.898, expert1_balance_bottom=19.017, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=212, ups=0.55, wpb=382.7, bsz=32, num_updates=10980, lr=9.31921e-06, gnorm=4.256, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22696
2022-05-09 03:07:26 - progress_bar.py[line:272] - INFO: epoch 001:  11008 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.705, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.5, ups=0.56, wpb=381.8, bsz=32, num_updates=10990, lr=9.31801e-06, gnorm=3.823, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22714
2022-05-09 03:07:44 - progress_bar.py[line:272] - INFO: epoch 001:  11018 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.841, expert1_balance_bottom=19.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=211.4, ups=0.55, wpb=381.6, bsz=32, num_updates=11000, lr=9.31681e-06, gnorm=3.468, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22732
2022-05-09 03:08:02 - progress_bar.py[line:272] - INFO: epoch 001:  11028 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=369.5, nsentences=32, sample_size=293.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.111, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=204.1, ups=0.55, wpb=369.5, bsz=32, num_updates=11010, lr=9.31561e-06, gnorm=3.362, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22750
2022-05-09 03:08:20 - progress_bar.py[line:272] - INFO: epoch 001:  11038 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891868, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.94, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.1, ups=0.56, wpb=380.5, bsz=32, num_updates=11020, lr=9.31441e-06, gnorm=3.346, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22768
2022-05-09 03:08:37 - progress_bar.py[line:272] - INFO: epoch 001:  11048 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.006, expert1_balance_bottom=19.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=215.6, ups=0.56, wpb=385.7, bsz=32, num_updates=11030, lr=9.31321e-06, gnorm=3.356, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22785
2022-05-09 03:08:55 - progress_bar.py[line:272] - INFO: epoch 001:  11058 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=378.2, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892171, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.805, expert1_balance_bottom=19.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.2, ups=0.56, wpb=378.2, bsz=32, num_updates=11040, lr=9.31201e-06, gnorm=3.325, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22803
2022-05-09 03:09:13 - progress_bar.py[line:272] - INFO: epoch 001:  11068 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=389.2, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.621, expert1_balance_bottom=19.017, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.6, ups=0.56, wpb=389.2, bsz=32, num_updates=11050, lr=9.3108e-06, gnorm=3.019, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22821
2022-05-09 03:09:31 - progress_bar.py[line:272] - INFO: epoch 001:  11078 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=380.6, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.179, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.9, ups=0.56, wpb=380.6, bsz=32, num_updates=11060, lr=9.3096e-06, gnorm=3.687, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22839
2022-05-09 03:09:48 - progress_bar.py[line:272] - INFO: epoch 001:  11088 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=381.4, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=33.848, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=218, ups=0.57, wpb=381.4, bsz=32, num_updates=11070, lr=9.3084e-06, gnorm=3.138, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22856
2022-05-09 03:10:06 - progress_bar.py[line:272] - INFO: epoch 001:  11098 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.852, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.5, ups=0.56, wpb=382, bsz=32, num_updates=11080, lr=9.3072e-06, gnorm=3.571, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22874
2022-05-09 03:10:24 - progress_bar.py[line:272] - INFO: epoch 001:  11108 / 17711 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.999, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.193, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.329, expert1_balance_bottom=19.308, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2, wps=212.8, ups=0.56, wpb=382.2, bsz=32, num_updates=11090, lr=9.306e-06, gnorm=5.337, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22892
2022-05-09 03:10:42 - progress_bar.py[line:272] - INFO: epoch 001:  11118 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=33.871, expert1_balance_bottom=19.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.6, ups=0.55, wpb=379.9, bsz=32, num_updates=11100, lr=9.3048e-06, gnorm=3.179, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22910
2022-05-09 03:11:01 - progress_bar.py[line:272] - INFO: epoch 001:  11128 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=387.3, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.171, expert1_balance_top=33.615, expert1_balance_bottom=19.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.2, ups=0.55, wpb=387.3, bsz=32, num_updates=11110, lr=9.3036e-06, gnorm=3.344, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22929
2022-05-09 03:11:19 - progress_bar.py[line:272] - INFO: epoch 001:  11138 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.986, expert1_balance_bottom=19.197, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210, ups=0.55, wpb=381.8, bsz=32, num_updates=11120, lr=9.3024e-06, gnorm=3.173, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22947
2022-05-09 03:11:37 - progress_bar.py[line:272] - INFO: epoch 001:  11148 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88369, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.789, expert1_balance_bottom=19.126, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.4, ups=0.55, wpb=382.1, bsz=32, num_updates=11130, lr=9.30119e-06, gnorm=3.416, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22965
2022-05-09 03:11:55 - progress_bar.py[line:272] - INFO: epoch 001:  11158 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=380.7, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.43, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=208.8, ups=0.55, wpb=380.7, bsz=32, num_updates=11140, lr=9.29999e-06, gnorm=3.434, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=22983
2022-05-09 03:12:14 - progress_bar.py[line:272] - INFO: epoch 001:  11168 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=387.2, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.244, expert1_balance_bottom=19.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=210.6, ups=0.54, wpb=387.2, bsz=32, num_updates=11150, lr=9.29879e-06, gnorm=3.454, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23002
2022-05-09 03:12:32 - progress_bar.py[line:272] - INFO: epoch 001:  11178 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89443, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.173, expert1_balance_top=33.47, expert1_balance_bottom=19.461, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.2, ups=0.55, wpb=380.2, bsz=32, num_updates=11160, lr=9.29759e-06, gnorm=3.607, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23020
2022-05-09 03:12:50 - progress_bar.py[line:272] - INFO: epoch 001:  11188 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=377.1, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.221, expert1_balance_bottom=19.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.2, ups=0.56, wpb=377.1, bsz=32, num_updates=11170, lr=9.29639e-06, gnorm=3.354, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23038
2022-05-09 03:13:09 - progress_bar.py[line:272] - INFO: epoch 001:  11198 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=378.8, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.592, expert1_balance_bottom=19.029, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=203.5, ups=0.54, wpb=378.8, bsz=32, num_updates=11180, lr=9.29519e-06, gnorm=3.073, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23057
2022-05-09 03:13:27 - progress_bar.py[line:272] - INFO: epoch 001:  11208 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=395.1, nsentences=32, sample_size=314.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.860627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=35.627, expert1_balance_bottom=18.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=218.1, ups=0.55, wpb=395.1, bsz=32, num_updates=11190, lr=9.29399e-06, gnorm=3.231, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23075
2022-05-09 03:13:45 - progress_bar.py[line:272] - INFO: epoch 001:  11218 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=378.1, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896393, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.366, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210.2, ups=0.56, wpb=378.1, bsz=32, num_updates=11200, lr=9.29278e-06, gnorm=3.902, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23093
2022-05-09 03:14:02 - progress_bar.py[line:272] - INFO: epoch 001:  11228 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=382.8, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.409, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215.2, ups=0.56, wpb=382.8, bsz=32, num_updates=11210, lr=9.29158e-06, gnorm=2.897, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23110
2022-05-09 03:14:21 - progress_bar.py[line:272] - INFO: epoch 001:  11238 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=376.9, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877528, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.495, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=208, ups=0.55, wpb=376.9, bsz=32, num_updates=11220, lr=9.29038e-06, gnorm=3.763, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23129
2022-05-09 03:14:38 - progress_bar.py[line:272] - INFO: epoch 001:  11248 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=381.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.51, expert1_balance_bottom=19.034, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.6, ups=0.56, wpb=381.8, bsz=32, num_updates=11230, lr=9.28918e-06, gnorm=3.365, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23146
2022-05-09 03:14:56 - progress_bar.py[line:272] - INFO: epoch 001:  11258 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885082, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=33.986, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210, ups=0.56, wpb=377.5, bsz=32, num_updates=11240, lr=9.28798e-06, gnorm=3.369, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23164
2022-05-09 03:15:14 - progress_bar.py[line:272] - INFO: epoch 001:  11268 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874413, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.902, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.4, ups=0.56, wpb=384.9, bsz=32, num_updates=11250, lr=9.28678e-06, gnorm=3.685, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23182
2022-05-09 03:15:32 - progress_bar.py[line:272] - INFO: epoch 001:  11278 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=389.9, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871462, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=35.059, expert1_balance_bottom=18.782, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=218, ups=0.56, wpb=389.9, bsz=32, num_updates=11260, lr=9.28558e-06, gnorm=3.343, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23200
2022-05-09 03:15:50 - progress_bar.py[line:272] - INFO: epoch 001:  11288 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.532, expert1_balance_bottom=19.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=211.9, ups=0.56, wpb=380.9, bsz=32, num_updates=11270, lr=9.28438e-06, gnorm=3.306, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23218
2022-05-09 03:16:08 - progress_bar.py[line:272] - INFO: epoch 001:  11298 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=381, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880616, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.619, expert1_balance_bottom=19.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.8, ups=0.55, wpb=381, bsz=32, num_updates=11280, lr=9.28317e-06, gnorm=3.33, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23236
2022-05-09 03:16:26 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 03:16:28 - progress_bar.py[line:272] - INFO: epoch 001:  11309 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=387.9, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887531, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.29, expert1_balance_bottom=19.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=194.2, ups=0.5, wpb=387.9, bsz=32, num_updates=11290, lr=9.28197e-06, gnorm=3.033, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23256
2022-05-09 03:16:46 - progress_bar.py[line:272] - INFO: epoch 001:  11319 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.648, expert1_balance_bottom=19.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.4, ups=0.55, wpb=383.3, bsz=32, num_updates=11300, lr=9.28077e-06, gnorm=3.407, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23274
2022-05-09 03:17:04 - progress_bar.py[line:272] - INFO: epoch 001:  11329 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=385.1, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892756, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=33.806, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221.1, ups=0.57, wpb=385.1, bsz=32, num_updates=11310, lr=9.27957e-06, gnorm=3.399, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23292
2022-05-09 03:17:21 - progress_bar.py[line:272] - INFO: epoch 001:  11339 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383.1, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.269, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219.7, ups=0.57, wpb=383.1, bsz=32, num_updates=11320, lr=9.27837e-06, gnorm=3.354, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23309
2022-05-09 03:17:39 - progress_bar.py[line:272] - INFO: epoch 001:  11349 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=376.4, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.512, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.1, ups=0.56, wpb=376.4, bsz=32, num_updates=11330, lr=9.27717e-06, gnorm=2.954, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23327
2022-05-09 03:17:57 - progress_bar.py[line:272] - INFO: epoch 001:  11359 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=375.2, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=33.676, expert1_balance_bottom=19.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=208.1, ups=0.55, wpb=375.2, bsz=32, num_updates=11340, lr=9.27597e-06, gnorm=3.221, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23345
2022-05-09 03:18:15 - progress_bar.py[line:272] - INFO: epoch 001:  11369 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.035, expert1_balance_bottom=19.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.3, ups=0.55, wpb=383.4, bsz=32, num_updates=11350, lr=9.27477e-06, gnorm=3.254, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23363
2022-05-09 03:18:33 - progress_bar.py[line:272] - INFO: epoch 001:  11379 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890878, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.617, expert1_balance_bottom=19.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.5, ups=0.55, wpb=380.6, bsz=32, num_updates=11360, lr=9.27356e-06, gnorm=3.53, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23381
2022-05-09 03:18:51 - progress_bar.py[line:272] - INFO: epoch 001:  11389 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=381.2, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.119, expert1_balance_bottom=19.253, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.6, ups=0.55, wpb=381.2, bsz=32, num_updates=11370, lr=9.27236e-06, gnorm=2.921, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23399
2022-05-09 03:19:09 - progress_bar.py[line:272] - INFO: epoch 001:  11399 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=387.4, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.081, expert1_balance_bottom=19.359, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212.8, ups=0.55, wpb=387.4, bsz=32, num_updates=11380, lr=9.27116e-06, gnorm=3.281, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23417
2022-05-09 03:19:27 - progress_bar.py[line:272] - INFO: epoch 001:  11409 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.399, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212.1, ups=0.55, wpb=386.2, bsz=32, num_updates=11390, lr=9.26996e-06, gnorm=3.562, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23435
2022-05-09 03:19:45 - progress_bar.py[line:272] - INFO: epoch 001:  11419 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=380.6, nsentences=31.5, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=35.048, expert1_balance_bottom=18.99, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.2, ups=0.56, wpb=380.6, bsz=31.5, num_updates=11400, lr=9.26876e-06, gnorm=3.454, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23453
2022-05-09 03:20:04 - progress_bar.py[line:272] - INFO: epoch 001:  11429 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=380.3, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.4, expert1_balance_bottom=19.268, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=206.8, ups=0.54, wpb=380.3, bsz=32, num_updates=11410, lr=9.26756e-06, gnorm=3.234, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23472
2022-05-09 03:20:21 - progress_bar.py[line:272] - INFO: epoch 001:  11439 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=389.5, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.096, expert1_balance_bottom=19.081, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=218.8, ups=0.56, wpb=389.5, bsz=32, num_updates=11420, lr=9.26636e-06, gnorm=3.985, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23489
2022-05-09 03:20:39 - progress_bar.py[line:272] - INFO: epoch 001:  11449 / 17711 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.974, ntokens=382, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.176, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.409, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=212, ups=0.56, wpb=382, bsz=32, num_updates=11430, lr=9.26515e-06, gnorm=4.123, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23507
2022-05-09 03:20:57 - progress_bar.py[line:272] - INFO: epoch 001:  11459 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=380.1, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.978, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.9, ups=0.56, wpb=380.1, bsz=32, num_updates=11440, lr=9.26395e-06, gnorm=3.176, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23525
2022-05-09 03:21:16 - progress_bar.py[line:272] - INFO: epoch 001:  11469 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=392.5, nsentences=32, sample_size=312.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=35.223, expert1_balance_bottom=18.923, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.5, ups=0.55, wpb=392.5, bsz=32, num_updates=11450, lr=9.26275e-06, gnorm=3.153, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23544
2022-05-09 03:21:34 - progress_bar.py[line:272] - INFO: epoch 001:  11479 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=385.2, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.551, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.1, ups=0.56, wpb=385.2, bsz=32, num_updates=11460, lr=9.26155e-06, gnorm=3.28, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23562
2022-05-09 03:21:52 - progress_bar.py[line:272] - INFO: epoch 001:  11489 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=396, nsentences=32, sample_size=314.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883275, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.426, expert1_balance_bottom=18.965, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221, ups=0.56, wpb=396, bsz=32, num_updates=11470, lr=9.26035e-06, gnorm=2.797, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23580
2022-05-09 03:22:10 - progress_bar.py[line:272] - INFO: epoch 001:  11499 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=390.7, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.03, expert1_balance_bottom=19.536, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.8, ups=0.56, wpb=390.7, bsz=32, num_updates=11480, lr=9.25915e-06, gnorm=3.081, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23598
2022-05-09 03:22:28 - progress_bar.py[line:272] - INFO: epoch 001:  11509 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=395, nsentences=32, sample_size=314.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.052, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=217.7, ups=0.55, wpb=395, bsz=32, num_updates=11490, lr=9.25795e-06, gnorm=3.904, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23616
2022-05-09 03:22:46 - progress_bar.py[line:272] - INFO: epoch 001:  11519 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.521, expert1_balance_bottom=19.351, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=211.7, ups=0.55, wpb=382.9, bsz=32, num_updates=11500, lr=9.25675e-06, gnorm=3.215, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23634
2022-05-09 03:23:04 - progress_bar.py[line:272] - INFO: epoch 001:  11529 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882034, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.773, expert1_balance_bottom=19.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.5, ups=0.56, wpb=381.5, bsz=32, num_updates=11510, lr=9.25554e-06, gnorm=3.807, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23652
2022-05-09 03:23:22 - progress_bar.py[line:272] - INFO: epoch 001:  11539 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870531, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=35.348, expert1_balance_bottom=18.942, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=209.6, ups=0.55, wpb=380.7, bsz=32, num_updates=11520, lr=9.25434e-06, gnorm=3.325, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23670
2022-05-09 03:23:40 - progress_bar.py[line:272] - INFO: epoch 001:  11549 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=382.9, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88393, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.186, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.9, ups=0.56, wpb=382.9, bsz=32, num_updates=11530, lr=9.25314e-06, gnorm=2.868, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23688
2022-05-09 03:23:58 - progress_bar.py[line:272] - INFO: epoch 001:  11559 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.655, expert1_balance_bottom=19.059, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=209.8, ups=0.55, wpb=381.6, bsz=32, num_updates=11540, lr=9.25194e-06, gnorm=3.278, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23706
2022-05-09 03:24:16 - progress_bar.py[line:272] - INFO: epoch 001:  11569 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=386.2, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886599, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.207, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.7, ups=0.56, wpb=386.2, bsz=32, num_updates=11550, lr=9.25074e-06, gnorm=3.48, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23724
2022-05-09 03:24:34 - progress_bar.py[line:272] - INFO: epoch 001:  11579 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886315, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.31, expert1_balance_bottom=19.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.5, ups=0.57, wpb=378.6, bsz=32, num_updates=11560, lr=9.24954e-06, gnorm=3.635, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23742
2022-05-09 03:24:51 - progress_bar.py[line:272] - INFO: epoch 001:  11589 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=382.2, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.976, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=214.3, ups=0.56, wpb=382.2, bsz=32, num_updates=11570, lr=9.24834e-06, gnorm=3.911, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23759
2022-05-09 03:25:09 - progress_bar.py[line:272] - INFO: epoch 001:  11599 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=380, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88862, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.167, expert1_balance_bottom=19.041, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.2, ups=0.57, wpb=380, bsz=32, num_updates=11580, lr=9.24713e-06, gnorm=3.32, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23777
2022-05-09 03:25:27 - progress_bar.py[line:272] - INFO: epoch 001:  11609 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881568, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.403, expert1_balance_bottom=19.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214.2, ups=0.56, wpb=383.1, bsz=32, num_updates=11590, lr=9.24593e-06, gnorm=3.452, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23795
2022-05-09 03:25:45 - progress_bar.py[line:272] - INFO: epoch 001:  11619 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=378, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893434, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.727, expert1_balance_bottom=19.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.8, ups=0.56, wpb=378, bsz=32, num_updates=11600, lr=9.24473e-06, gnorm=3.312, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23813
2022-05-09 03:26:03 - progress_bar.py[line:272] - INFO: epoch 001:  11629 / 17711 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.148, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.993, expert1_balance_bottom=19.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=214.5, ups=0.56, wpb=383.6, bsz=32, num_updates=11610, lr=9.24353e-06, gnorm=3.71, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23831
2022-05-09 03:26:21 - progress_bar.py[line:272] - INFO: epoch 001:  11639 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=381.6, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875475, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.666, expert1_balance_bottom=19.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.2, ups=0.56, wpb=381.6, bsz=32, num_updates=11620, lr=9.24233e-06, gnorm=3.101, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23849
2022-05-09 03:26:38 - progress_bar.py[line:272] - INFO: epoch 001:  11649 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=387.2, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89043, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=33.746, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216.4, ups=0.56, wpb=387.2, bsz=32, num_updates=11630, lr=9.24113e-06, gnorm=3.243, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23867
2022-05-09 03:26:56 - progress_bar.py[line:272] - INFO: epoch 001:  11659 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881467, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.002, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.1, ups=0.56, wpb=380.1, bsz=32, num_updates=11640, lr=9.23993e-06, gnorm=3.237, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23884
2022-05-09 03:27:14 - progress_bar.py[line:272] - INFO: epoch 001:  11669 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=374.8, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=33.799, expert1_balance_bottom=19.333, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.4, ups=0.56, wpb=374.8, bsz=32, num_updates=11650, lr=9.23873e-06, gnorm=3.57, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23902
2022-05-09 03:27:25 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 03:27:34 - progress_bar.py[line:272] - INFO: epoch 001:  11680 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=377, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892849, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.393, expert1_balance_bottom=19.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=192.3, ups=0.51, wpb=377, bsz=32, num_updates=11660, lr=9.23752e-06, gnorm=3.706, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23922
2022-05-09 03:27:52 - progress_bar.py[line:272] - INFO: epoch 001:  11690 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887156, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=33.893, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.8, ups=0.56, wpb=381.7, bsz=32, num_updates=11670, lr=9.23632e-06, gnorm=3.292, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23940
2022-05-09 03:28:10 - progress_bar.py[line:272] - INFO: epoch 001:  11700 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=384, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.531, expert1_balance_bottom=19.547, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=215, ups=0.56, wpb=384, bsz=32, num_updates=11680, lr=9.23512e-06, gnorm=3.439, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23958
2022-05-09 03:28:28 - progress_bar.py[line:272] - INFO: epoch 001:  11710 / 17711 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=374, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.162, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.639, expert1_balance_bottom=19.48, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=207.3, ups=0.55, wpb=374, bsz=32, num_updates=11690, lr=9.23392e-06, gnorm=3.56, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23976
2022-05-09 03:28:45 - progress_bar.py[line:272] - INFO: epoch 001:  11720 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=378.6, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889174, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.199, expert1_balance_bottom=19.186, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213, ups=0.56, wpb=378.6, bsz=32, num_updates=11700, lr=9.23272e-06, gnorm=3.561, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=23993
2022-05-09 03:29:03 - progress_bar.py[line:272] - INFO: epoch 001:  11730 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.995, expert1_balance_bottom=18.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.6, ups=0.56, wpb=381.9, bsz=32, num_updates=11710, lr=9.23152e-06, gnorm=3.034, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24011
2022-05-09 03:29:21 - progress_bar.py[line:272] - INFO: epoch 001:  11740 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=389.5, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.247, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.5, ups=0.55, wpb=389.5, bsz=32, num_updates=11720, lr=9.23032e-06, gnorm=3.375, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24029
2022-05-09 03:29:40 - progress_bar.py[line:272] - INFO: epoch 001:  11750 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.794, expert1_balance_bottom=19.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=210.4, ups=0.55, wpb=385.3, bsz=32, num_updates=11730, lr=9.22912e-06, gnorm=3.309, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24048
2022-05-09 03:29:58 - progress_bar.py[line:272] - INFO: epoch 001:  11760 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=378.1, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.526, expert1_balance_bottom=19.002, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209.9, ups=0.56, wpb=378.1, bsz=32, num_updates=11740, lr=9.22791e-06, gnorm=4.014, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24066
2022-05-09 03:30:16 - progress_bar.py[line:272] - INFO: epoch 001:  11770 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=372.2, nsentences=32, sample_size=296.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.742, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=203.1, ups=0.55, wpb=372.2, bsz=32, num_updates=11750, lr=9.22671e-06, gnorm=3.295, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24084
2022-05-09 03:30:34 - progress_bar.py[line:272] - INFO: epoch 001:  11780 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=388.4, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.326, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.6, ups=0.56, wpb=388.4, bsz=32, num_updates=11760, lr=9.22551e-06, gnorm=3.398, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24102
2022-05-09 03:30:52 - progress_bar.py[line:272] - INFO: epoch 001:  11790 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=381.5, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890301, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=33.871, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.3, ups=0.56, wpb=381.5, bsz=32, num_updates=11770, lr=9.22431e-06, gnorm=3.863, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24120
2022-05-09 03:31:10 - progress_bar.py[line:272] - INFO: epoch 001:  11800 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=377.4, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881051, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.539, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=212, ups=0.56, wpb=377.4, bsz=32, num_updates=11780, lr=9.22311e-06, gnorm=3.392, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24138
2022-05-09 03:31:27 - progress_bar.py[line:272] - INFO: epoch 001:  11810 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882839, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.402, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.1, ups=0.56, wpb=383.3, bsz=32, num_updates=11790, lr=9.22191e-06, gnorm=3.556, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24156
2022-05-09 03:31:45 - progress_bar.py[line:272] - INFO: epoch 001:  11820 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=376.8, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883557, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.021, expert1_balance_bottom=19.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.4, ups=0.56, wpb=376.8, bsz=32, num_updates=11800, lr=9.22071e-06, gnorm=3.837, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24173
2022-05-09 03:32:03 - progress_bar.py[line:272] - INFO: epoch 001:  11830 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=389.7, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87716, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.472, expert1_balance_bottom=19.181, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=218.1, ups=0.56, wpb=389.7, bsz=32, num_updates=11810, lr=9.2195e-06, gnorm=3.987, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24191
2022-05-09 03:32:21 - progress_bar.py[line:272] - INFO: epoch 001:  11840 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886781, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.054, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.5, ups=0.57, wpb=386.5, bsz=32, num_updates=11820, lr=9.2183e-06, gnorm=3.703, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24209
2022-05-09 03:32:38 - progress_bar.py[line:272] - INFO: epoch 001:  11850 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=386.6, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=35.304, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=219.2, ups=0.57, wpb=386.6, bsz=32, num_updates=11830, lr=9.2171e-06, gnorm=3.826, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24227
2022-05-09 03:32:56 - progress_bar.py[line:272] - INFO: epoch 001:  11860 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=377, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87656, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=35.001, expert1_balance_bottom=19.001, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.2, ups=0.57, wpb=377, bsz=32, num_updates=11840, lr=9.2159e-06, gnorm=4.054, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24244
2022-05-09 03:33:14 - progress_bar.py[line:272] - INFO: epoch 001:  11870 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=385.5, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885229, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=33.981, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.8, ups=0.55, wpb=385.5, bsz=32, num_updates=11850, lr=9.2147e-06, gnorm=3.323, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24262
2022-05-09 03:33:33 - progress_bar.py[line:272] - INFO: epoch 001:  11880 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.313, expert1_balance_bottom=19.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=208.2, ups=0.54, wpb=383, bsz=32, num_updates=11860, lr=9.2135e-06, gnorm=3.232, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24281
2022-05-09 03:33:51 - progress_bar.py[line:272] - INFO: epoch 001:  11890 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=388.7, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=33.276, expert1_balance_bottom=19.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.2, ups=0.55, wpb=388.7, bsz=32, num_updates=11870, lr=9.2123e-06, gnorm=3.493, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24299
2022-05-09 03:34:09 - progress_bar.py[line:272] - INFO: epoch 001:  11900 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=35.061, expert1_balance_bottom=18.986, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=214.3, ups=0.56, wpb=384.2, bsz=32, num_updates=11880, lr=9.2111e-06, gnorm=3.983, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24317
2022-05-09 03:34:27 - progress_bar.py[line:272] - INFO: epoch 001:  11910 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883651, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.402, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210.7, ups=0.55, wpb=383.5, bsz=32, num_updates=11890, lr=9.20989e-06, gnorm=3.514, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24335
2022-05-09 03:34:45 - progress_bar.py[line:272] - INFO: epoch 001:  11920 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=382.9, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890837, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=33.602, expert1_balance_bottom=19.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.3, ups=0.55, wpb=382.9, bsz=32, num_updates=11900, lr=9.20869e-06, gnorm=3.314, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24353
2022-05-09 03:35:03 - progress_bar.py[line:272] - INFO: epoch 001:  11930 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877892, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.56, expert1_balance_bottom=19.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209, ups=0.55, wpb=376.7, bsz=32, num_updates=11910, lr=9.20749e-06, gnorm=3.28, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24371
2022-05-09 03:35:21 - progress_bar.py[line:272] - INFO: epoch 001:  11940 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=385.1, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877995, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.784, expert1_balance_bottom=19.072, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=212.8, ups=0.55, wpb=385.1, bsz=32, num_updates=11920, lr=9.20629e-06, gnorm=4.62, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24389
2022-05-09 03:35:39 - progress_bar.py[line:272] - INFO: epoch 001:  11950 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=385.3, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878352, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.739, expert1_balance_bottom=19.12, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=211.9, ups=0.55, wpb=385.3, bsz=32, num_updates=11930, lr=9.20509e-06, gnorm=3.516, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24407
2022-05-09 03:35:57 - progress_bar.py[line:272] - INFO: epoch 001:  11960 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=380.4, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880031, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.677, expert1_balance_bottom=19.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.5, ups=0.56, wpb=380.4, bsz=32, num_updates=11940, lr=9.20389e-06, gnorm=4.061, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24425
2022-05-09 03:36:15 - progress_bar.py[line:272] - INFO: epoch 001:  11970 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=373.9, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889746, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.86, expert1_balance_bottom=19.245, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=209.3, ups=0.56, wpb=373.9, bsz=32, num_updates=11950, lr=9.20269e-06, gnorm=3.955, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24443
2022-05-09 03:36:33 - progress_bar.py[line:272] - INFO: epoch 001:  11980 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886066, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.26, expert1_balance_bottom=19.285, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215, ups=0.56, wpb=382.2, bsz=32, num_updates=11960, lr=9.20148e-06, gnorm=3.338, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24461
2022-05-09 03:36:51 - progress_bar.py[line:272] - INFO: epoch 001:  11990 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888903, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.169, expert1_balance_top=33.647, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.9, ups=0.55, wpb=384.7, bsz=32, num_updates=11970, lr=9.20028e-06, gnorm=3.019, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24479
2022-05-09 03:37:09 - progress_bar.py[line:272] - INFO: epoch 001:  12000 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=378.5, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.699, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=209.2, ups=0.55, wpb=378.5, bsz=32, num_updates=11980, lr=9.19908e-06, gnorm=5.474, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24497
2022-05-09 03:37:27 - progress_bar.py[line:272] - INFO: epoch 001:  12010 / 17711 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=388.7, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.159, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=34.255, expert1_balance_bottom=19.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=217.8, ups=0.56, wpb=388.7, bsz=32, num_updates=11990, lr=9.19788e-06, gnorm=4.105, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24515
2022-05-09 03:37:45 - progress_bar.py[line:272] - INFO: epoch 001:  12020 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.464, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.7, ups=0.56, wpb=383.6, bsz=32, num_updates=12000, lr=9.19668e-06, gnorm=3.508, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24533
2022-05-09 03:37:45 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 03:37:45 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 03:37:45 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 03:45:10 - train.py[line:517] - INFO: valid_step finished
2022-05-09 03:45:10 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.762 | loss_v1 0 | loss_v2 0 | nll_loss 8.089 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.974928 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.762 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.225 | expert1_balance_top 36.087 | expert1_balance_bottom 15.098 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 272.36 | cider 1.2 | wps 676.2 | wpb 481.7 | bsz 8 | num_updates 12000 | best_cider 1.2
2022-05-09 03:45:28 - progress_bar.py[line:272] - INFO: epoch 001:  12030 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=379, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885598, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=34.448, expert1_balance_bottom=19.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=8.2, ups=0.02, wpb=379, bsz=32, num_updates=12010, lr=9.19548e-06, gnorm=3.327, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=24996
2022-05-09 03:45:46 - progress_bar.py[line:272] - INFO: epoch 001:  12040 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=372.5, nsentences=32, sample_size=296.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.172, expert1_balance_top=33.874, expert1_balance_bottom=19.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=208.7, ups=0.56, wpb=372.5, bsz=32, num_updates=12020, lr=9.19428e-06, gnorm=3.706, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25014
2022-05-09 03:46:04 - progress_bar.py[line:272] - INFO: epoch 001:  12050 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=379.6, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=33.949, expert1_balance_bottom=19.341, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.4, ups=0.56, wpb=379.6, bsz=32, num_updates=12030, lr=9.19308e-06, gnorm=3.356, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25032
2022-05-09 03:46:22 - progress_bar.py[line:272] - INFO: epoch 001:  12060 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=379.1, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89333, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.748, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.3, ups=0.56, wpb=379.1, bsz=32, num_updates=12040, lr=9.19187e-06, gnorm=3.463, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25050
2022-05-09 03:46:40 - progress_bar.py[line:272] - INFO: epoch 001:  12070 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=385.8, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.806, expert1_balance_bottom=19.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.4, ups=0.55, wpb=385.8, bsz=32, num_updates=12050, lr=9.19067e-06, gnorm=3.837, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25068
2022-05-09 03:46:57 - progress_bar.py[line:272] - INFO: epoch 001:  12080 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873342, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.537, expert1_balance_bottom=19.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=216, ups=0.56, wpb=382.3, bsz=32, num_updates=12060, lr=9.18947e-06, gnorm=3.173, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25085
2022-05-09 03:47:15 - progress_bar.py[line:272] - INFO: epoch 001:  12090 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=386.1, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879458, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.563, expert1_balance_bottom=19.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=218.1, ups=0.56, wpb=386.1, bsz=32, num_updates=12070, lr=9.18827e-06, gnorm=3.305, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25103
2022-05-09 03:47:33 - progress_bar.py[line:272] - INFO: epoch 001:  12100 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891073, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=33.807, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217.3, ups=0.57, wpb=382.9, bsz=32, num_updates=12080, lr=9.18707e-06, gnorm=3.167, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25121
2022-05-09 03:47:51 - progress_bar.py[line:272] - INFO: epoch 001:  12110 / 17711 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.142, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.656, expert1_balance_bottom=19.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=215.9, ups=0.56, wpb=384.9, bsz=32, num_updates=12090, lr=9.18587e-06, gnorm=3.652, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25139
2022-05-09 03:48:09 - progress_bar.py[line:272] - INFO: epoch 001:  12120 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883756, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.133, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=213.4, ups=0.55, wpb=384.9, bsz=32, num_updates=12100, lr=9.18467e-06, gnorm=3.416, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25157
2022-05-09 03:48:26 - progress_bar.py[line:272] - INFO: epoch 001:  12130 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=371.9, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.083, expert1_balance_bottom=19.128, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209.4, ups=0.56, wpb=371.9, bsz=32, num_updates=12110, lr=9.18347e-06, gnorm=3.781, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25174
2022-05-09 03:48:44 - progress_bar.py[line:272] - INFO: epoch 001:  12140 / 17711 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=377.2, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.15, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.17, expert1_balance_top=34.124, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.3, ups=0.57, wpb=377.2, bsz=32, num_updates=12120, lr=9.18226e-06, gnorm=3.438, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25192
2022-05-09 03:49:03 - progress_bar.py[line:272] - INFO: epoch 001:  12150 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=394.5, nsentences=32, sample_size=314.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.838, expert1_balance_bottom=19.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=208.5, ups=0.53, wpb=394.5, bsz=32, num_updates=12130, lr=9.18106e-06, gnorm=3.241, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25211
2022-05-09 03:49:21 - progress_bar.py[line:272] - INFO: epoch 001:  12160 / 17711 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=1.004, ntokens=389.5, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879124, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.195, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.859, expert1_balance_bottom=19.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.01, wps=221.3, ups=0.57, wpb=389.5, bsz=32, num_updates=12140, lr=9.17986e-06, gnorm=3.959, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25229
2022-05-09 03:49:38 - progress_bar.py[line:272] - INFO: epoch 001:  12170 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=383, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.624, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=218.7, ups=0.57, wpb=383, bsz=32, num_updates=12150, lr=9.17866e-06, gnorm=3.581, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25246
2022-05-09 03:49:56 - progress_bar.py[line:272] - INFO: epoch 001:  12180 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=380.4, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.613, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.4, ups=0.56, wpb=380.4, bsz=32, num_updates=12160, lr=9.17746e-06, gnorm=2.998, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25264
2022-05-09 03:50:14 - progress_bar.py[line:272] - INFO: epoch 001:  12190 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893077, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=33.901, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.5, ups=0.55, wpb=378.1, bsz=32, num_updates=12170, lr=9.17626e-06, gnorm=3.811, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25282
2022-05-09 03:50:32 - progress_bar.py[line:272] - INFO: epoch 001:  12200 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=379.8, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890241, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.215, expert1_balance_bottom=19.112, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.6, ups=0.55, wpb=379.8, bsz=32, num_updates=12180, lr=9.17506e-06, gnorm=3.589, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25300
2022-05-09 03:50:50 - progress_bar.py[line:272] - INFO: epoch 001:  12210 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.315, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.8, ups=0.55, wpb=385.4, bsz=32, num_updates=12190, lr=9.17385e-06, gnorm=3.139, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25318
2022-05-09 03:51:09 - progress_bar.py[line:272] - INFO: epoch 001:  12220 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=377.8, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.855, expert1_balance_bottom=19.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=206.7, ups=0.55, wpb=377.8, bsz=32, num_updates=12200, lr=9.17265e-06, gnorm=3.621, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25337
2022-05-09 03:51:27 - progress_bar.py[line:272] - INFO: epoch 001:  12230 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=384.9, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=33.98, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.4, ups=0.54, wpb=384.9, bsz=32, num_updates=12210, lr=9.17145e-06, gnorm=2.99, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25355
2022-05-09 03:51:45 - progress_bar.py[line:272] - INFO: epoch 001:  12240 / 17711 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.136, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.708, expert1_balance_bottom=19.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.2, ups=0.56, wpb=382.5, bsz=32, num_updates=12220, lr=9.17025e-06, gnorm=3.764, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25373
2022-05-09 03:52:03 - progress_bar.py[line:272] - INFO: epoch 001:  12250 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=391.6, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873013, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.615, expert1_balance_bottom=19.108, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=219.5, ups=0.56, wpb=391.6, bsz=32, num_updates=12230, lr=9.16905e-06, gnorm=3.179, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25391
2022-05-09 03:52:20 - progress_bar.py[line:272] - INFO: epoch 001:  12260 / 17711 loss=3.114, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=382.6, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.114, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.557, expert1_balance_bottom=19.341, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=217.8, ups=0.57, wpb=382.6, bsz=32, num_updates=12240, lr=9.16785e-06, gnorm=3.094, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25408
2022-05-09 03:52:38 - progress_bar.py[line:272] - INFO: epoch 001:  12270 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=374.6, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893742, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=33.996, expert1_balance_bottom=19.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=209.5, ups=0.56, wpb=374.6, bsz=32, num_updates=12250, lr=9.16665e-06, gnorm=3.53, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25426
2022-05-09 03:52:56 - progress_bar.py[line:272] - INFO: epoch 001:  12280 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=35.202, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.9, ups=0.56, wpb=386.1, bsz=32, num_updates=12260, lr=9.16545e-06, gnorm=3.111, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25444
2022-05-09 03:53:14 - progress_bar.py[line:272] - INFO: epoch 001:  12290 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=33.902, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209.3, ups=0.55, wpb=377.9, bsz=32, num_updates=12270, lr=9.16424e-06, gnorm=3.486, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25462
2022-05-09 03:53:32 - progress_bar.py[line:272] - INFO: epoch 001:  12300 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=396.5, nsentences=32, sample_size=315.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=35.356, expert1_balance_bottom=18.96, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=220.3, ups=0.56, wpb=396.5, bsz=32, num_updates=12280, lr=9.16304e-06, gnorm=3.861, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25480
2022-05-09 03:53:50 - progress_bar.py[line:272] - INFO: epoch 001:  12310 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=388.2, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877026, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.691, expert1_balance_bottom=19.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.1, ups=0.56, wpb=388.2, bsz=32, num_updates=12290, lr=9.16184e-06, gnorm=3.19, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25498
2022-05-09 03:54:08 - progress_bar.py[line:272] - INFO: epoch 001:  12320 / 17711 loss=3.145, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=384.8, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877551, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.145, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.998, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=216.3, ups=0.56, wpb=384.8, bsz=32, num_updates=12300, lr=9.16064e-06, gnorm=3.222, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25516
2022-05-09 03:54:25 - progress_bar.py[line:272] - INFO: epoch 001:  12330 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=379.6, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=34.093, expert1_balance_bottom=19.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=216.1, ups=0.57, wpb=379.6, bsz=32, num_updates=12310, lr=9.15944e-06, gnorm=3.188, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25533
2022-05-09 03:54:43 - progress_bar.py[line:272] - INFO: epoch 001:  12340 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=379.9, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869847, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=35.324, expert1_balance_bottom=18.825, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.5, ups=0.56, wpb=379.9, bsz=32, num_updates=12320, lr=9.15824e-06, gnorm=3.304, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25551
2022-05-09 03:55:01 - progress_bar.py[line:272] - INFO: epoch 001:  12350 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=33.855, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.6, ups=0.56, wpb=381.6, bsz=32, num_updates=12330, lr=9.15704e-06, gnorm=3.193, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25569
2022-05-09 03:55:19 - progress_bar.py[line:272] - INFO: epoch 001:  12360 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=376.1, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=33.715, expert1_balance_bottom=19.366, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.3, ups=0.56, wpb=376.1, bsz=32, num_updates=12340, lr=9.15583e-06, gnorm=3.151, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25587
2022-05-09 03:55:37 - progress_bar.py[line:272] - INFO: epoch 001:  12370 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.162, expert1_balance_bottom=19.227, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.8, ups=0.55, wpb=382.4, bsz=32, num_updates=12350, lr=9.15463e-06, gnorm=3.199, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25605
2022-05-09 03:55:55 - progress_bar.py[line:272] - INFO: epoch 001:  12380 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=378.3, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.863, expert1_balance_bottom=19.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.4, ups=0.56, wpb=378.3, bsz=32, num_updates=12360, lr=9.15343e-06, gnorm=3.546, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25623
2022-05-09 03:56:14 - progress_bar.py[line:272] - INFO: epoch 001:  12390 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=392.3, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887243, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.533, expert1_balance_bottom=19.071, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.4, ups=0.55, wpb=392.3, bsz=32, num_updates=12370, lr=9.15223e-06, gnorm=3.447, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25642
2022-05-09 03:56:32 - progress_bar.py[line:272] - INFO: epoch 001:  12400 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=383.4, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890888, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=33.723, expert1_balance_bottom=19.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.1, ups=0.56, wpb=383.4, bsz=32, num_updates=12380, lr=9.15103e-06, gnorm=3.146, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25660
2022-05-09 03:56:50 - progress_bar.py[line:272] - INFO: epoch 001:  12410 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=387.4, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.858946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=36.014, expert1_balance_bottom=18.741, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=213.8, ups=0.55, wpb=387.4, bsz=32, num_updates=12390, lr=9.14983e-06, gnorm=3.515, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25678
2022-05-09 03:57:08 - progress_bar.py[line:272] - INFO: epoch 001:  12420 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=379.3, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89229, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.074, expert1_balance_bottom=19.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=209, ups=0.55, wpb=379.3, bsz=32, num_updates=12400, lr=9.14863e-06, gnorm=3.105, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25696
2022-05-09 03:57:26 - progress_bar.py[line:272] - INFO: epoch 001:  12430 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=376.3, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=33.704, expert1_balance_bottom=19.577, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=205.7, ups=0.55, wpb=376.3, bsz=32, num_updates=12410, lr=9.14743e-06, gnorm=3.436, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25714
2022-05-09 03:57:44 - progress_bar.py[line:272] - INFO: epoch 001:  12440 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=378.9, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=33.657, expert1_balance_bottom=19.365, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=206.4, ups=0.54, wpb=378.9, bsz=32, num_updates=12420, lr=9.14622e-06, gnorm=3.223, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25733
2022-05-09 03:58:02 - progress_bar.py[line:272] - INFO: epoch 001:  12450 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891393, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=33.511, expert1_balance_bottom=19.34, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.8, ups=0.56, wpb=378.7, bsz=32, num_updates=12430, lr=9.14502e-06, gnorm=2.865, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25750
2022-05-09 03:58:20 - progress_bar.py[line:272] - INFO: epoch 001:  12460 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=33.641, expert1_balance_bottom=19.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216.8, ups=0.56, wpb=386.2, bsz=32, num_updates=12440, lr=9.14382e-06, gnorm=3.274, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25768
2022-05-09 03:58:38 - progress_bar.py[line:272] - INFO: epoch 001:  12470 / 17711 loss=3.135, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=387.5, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.135, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.241, expert1_balance_bottom=19.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219.3, ups=0.57, wpb=387.5, bsz=32, num_updates=12450, lr=9.14262e-06, gnorm=3.576, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25786
2022-05-09 03:58:56 - progress_bar.py[line:272] - INFO: epoch 001:  12480 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=379, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891588, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=33.897, expert1_balance_bottom=19.132, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.1, ups=0.56, wpb=379, bsz=32, num_updates=12460, lr=9.14142e-06, gnorm=3.213, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25804
2022-05-09 03:59:13 - progress_bar.py[line:272] - INFO: epoch 001:  12490 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887563, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.077, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=217.7, ups=0.57, wpb=383.8, bsz=32, num_updates=12470, lr=9.14022e-06, gnorm=3.636, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25821
2022-05-09 03:59:31 - progress_bar.py[line:272] - INFO: epoch 001:  12500 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.635, expert1_balance_bottom=19.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.3, ups=0.56, wpb=379.9, bsz=32, num_updates=12480, lr=9.13902e-06, gnorm=3.782, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25839
2022-05-09 03:59:49 - progress_bar.py[line:272] - INFO: epoch 001:  12510 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=375, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887996, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.592, expert1_balance_bottom=19.002, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=210.9, ups=0.56, wpb=375, bsz=32, num_updates=12490, lr=9.13782e-06, gnorm=3.221, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25857
2022-05-09 04:00:07 - progress_bar.py[line:272] - INFO: epoch 001:  12520 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.615, expert1_balance_bottom=19.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=212.8, ups=0.56, wpb=380.8, bsz=32, num_updates=12500, lr=9.13661e-06, gnorm=3.698, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25875
2022-05-09 04:00:25 - progress_bar.py[line:272] - INFO: epoch 001:  12530 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=33.99, expert1_balance_bottom=19.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214.4, ups=0.55, wpb=388.3, bsz=32, num_updates=12510, lr=9.13541e-06, gnorm=3.21, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25893
2022-05-09 04:00:43 - progress_bar.py[line:272] - INFO: epoch 001:  12540 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=389.2, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.639, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=216.8, ups=0.56, wpb=389.2, bsz=32, num_updates=12520, lr=9.13421e-06, gnorm=3.675, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25911
2022-05-09 04:01:01 - progress_bar.py[line:272] - INFO: epoch 001:  12550 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=390.8, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881594, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.473, expert1_balance_bottom=19.162, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=216.9, ups=0.55, wpb=390.8, bsz=32, num_updates=12530, lr=9.13301e-06, gnorm=3.414, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25929
2022-05-09 04:01:19 - progress_bar.py[line:272] - INFO: epoch 001:  12560 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=389.9, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.98, expert1_balance_bottom=19.044, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.5, ups=0.57, wpb=389.9, bsz=32, num_updates=12540, lr=9.13181e-06, gnorm=2.959, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25947
2022-05-09 04:01:37 - progress_bar.py[line:272] - INFO: epoch 001:  12570 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=387.4, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887124, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.645, expert1_balance_bottom=19.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.8, ups=0.55, wpb=387.4, bsz=32, num_updates=12550, lr=9.13061e-06, gnorm=3.867, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25965
2022-05-09 04:01:55 - progress_bar.py[line:272] - INFO: epoch 001:  12580 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=383.2, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.752, expert1_balance_bottom=19.219, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=208.5, ups=0.54, wpb=383.2, bsz=32, num_updates=12560, lr=9.12941e-06, gnorm=3.148, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=25983
2022-05-09 04:02:13 - progress_bar.py[line:272] - INFO: epoch 001:  12590 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=377.6, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.756, expert1_balance_bottom=19.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.4, ups=0.56, wpb=377.6, bsz=32, num_updates=12570, lr=9.1282e-06, gnorm=3.548, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26001
2022-05-09 04:02:31 - progress_bar.py[line:272] - INFO: epoch 001:  12600 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.37, expert1_balance_bottom=19.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.5, ups=0.56, wpb=381, bsz=32, num_updates=12580, lr=9.127e-06, gnorm=3.415, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26019
2022-05-09 04:02:49 - progress_bar.py[line:272] - INFO: epoch 001:  12610 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.355, expert1_balance_bottom=19.161, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=211.6, ups=0.56, wpb=379.5, bsz=32, num_updates=12590, lr=9.1258e-06, gnorm=3.626, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26037
2022-05-09 04:03:07 - progress_bar.py[line:272] - INFO: epoch 001:  12620 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885081, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.677, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.7, ups=0.56, wpb=380, bsz=32, num_updates=12600, lr=9.1246e-06, gnorm=2.975, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26055
2022-05-09 04:03:25 - progress_bar.py[line:272] - INFO: epoch 001:  12630 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.608, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=215.1, ups=0.56, wpb=383.3, bsz=32, num_updates=12610, lr=9.1234e-06, gnorm=3.483, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26073
2022-05-09 04:03:42 - progress_bar.py[line:272] - INFO: epoch 001:  12640 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=386.4, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879217, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.732, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=216.4, ups=0.56, wpb=386.4, bsz=32, num_updates=12620, lr=9.1222e-06, gnorm=3.434, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26090
2022-05-09 04:04:00 - progress_bar.py[line:272] - INFO: epoch 001:  12650 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=379.8, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.421, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=215.5, ups=0.57, wpb=379.8, bsz=32, num_updates=12630, lr=9.121e-06, gnorm=2.932, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26108
2022-05-09 04:04:18 - progress_bar.py[line:272] - INFO: epoch 001:  12660 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.949, ntokens=373.2, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.578, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=210.5, ups=0.56, wpb=373.2, bsz=32, num_updates=12640, lr=9.1198e-06, gnorm=3.584, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26126
2022-05-09 04:04:36 - progress_bar.py[line:272] - INFO: epoch 001:  12670 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879006, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.888, expert1_balance_bottom=19.004, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.1, ups=0.56, wpb=383.6, bsz=32, num_updates=12650, lr=9.11859e-06, gnorm=3.206, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26144
2022-05-09 04:04:54 - progress_bar.py[line:272] - INFO: epoch 001:  12680 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=387.1, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.451, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.9, ups=0.55, wpb=387.1, bsz=32, num_updates=12660, lr=9.11739e-06, gnorm=3.462, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26162
2022-05-09 04:05:11 - progress_bar.py[line:272] - INFO: epoch 001:  12690 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=366.4, nsentences=32, sample_size=291.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.168, expert1_balance_top=33.114, expert1_balance_bottom=19.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=208.8, ups=0.57, wpb=366.4, bsz=32, num_updates=12670, lr=9.11619e-06, gnorm=3.319, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26179
2022-05-09 04:05:29 - progress_bar.py[line:272] - INFO: epoch 001:  12700 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=373.1, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.074, expert1_balance_bottom=19.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.8, ups=0.56, wpb=373.1, bsz=32, num_updates=12680, lr=9.11499e-06, gnorm=3.03, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26197
2022-05-09 04:05:47 - progress_bar.py[line:272] - INFO: epoch 001:  12710 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883978, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.198, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.7, ups=0.56, wpb=384.5, bsz=32, num_updates=12690, lr=9.11379e-06, gnorm=3.077, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26215
2022-05-09 04:06:05 - progress_bar.py[line:272] - INFO: epoch 001:  12720 / 17711 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892214, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.109, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=33.579, expert1_balance_bottom=19.51, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=208.6, ups=0.55, wpb=381.3, bsz=32, num_updates=12700, lr=9.11259e-06, gnorm=3.355, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26233
2022-05-09 04:06:24 - progress_bar.py[line:272] - INFO: epoch 001:  12730 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=391.9, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=35.442, expert1_balance_bottom=18.752, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214, ups=0.55, wpb=391.9, bsz=32, num_updates=12710, lr=9.11139e-06, gnorm=3.548, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26252
2022-05-09 04:06:42 - progress_bar.py[line:272] - INFO: epoch 001:  12740 / 17711 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=388.2, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.128, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.204, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.3, ups=0.54, wpb=388.2, bsz=32, num_updates=12720, lr=9.11018e-06, gnorm=3.342, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26270
2022-05-09 04:07:00 - progress_bar.py[line:272] - INFO: epoch 001:  12750 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889895, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.576, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209.7, ups=0.55, wpb=378.2, bsz=32, num_updates=12730, lr=9.10898e-06, gnorm=3.74, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26288
2022-05-09 04:07:18 - progress_bar.py[line:272] - INFO: epoch 001:  12760 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891769, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.01, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=209.9, ups=0.55, wpb=381.5, bsz=32, num_updates=12740, lr=9.10778e-06, gnorm=3.302, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26306
2022-05-09 04:07:36 - progress_bar.py[line:272] - INFO: epoch 001:  12770 / 17711 loss=3.144, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=379.7, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.144, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.578, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=212, ups=0.56, wpb=379.7, bsz=32, num_updates=12750, lr=9.10658e-06, gnorm=3.247, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26324
2022-05-09 04:07:54 - progress_bar.py[line:272] - INFO: epoch 001:  12780 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=391, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873078, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=34.703, expert1_balance_bottom=19.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.3, ups=0.56, wpb=391, bsz=32, num_updates=12760, lr=9.10538e-06, gnorm=3.423, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26342
2022-05-09 04:08:12 - progress_bar.py[line:272] - INFO: epoch 001:  12790 / 17711 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=1.064, ntokens=381.9, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882498, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.253, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.501, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.09, wps=211, ups=0.55, wpb=381.9, bsz=32, num_updates=12770, lr=9.10418e-06, gnorm=4.089, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26360
2022-05-09 04:08:30 - progress_bar.py[line:272] - INFO: epoch 001:  12800 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=378.7, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89617, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=34.291, expert1_balance_bottom=19.291, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.7, ups=0.56, wpb=378.7, bsz=32, num_updates=12780, lr=9.10298e-06, gnorm=3.368, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26378
2022-05-09 04:08:48 - progress_bar.py[line:272] - INFO: epoch 001:  12810 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=385.5, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878959, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=35.495, expert1_balance_bottom=18.919, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.3, ups=0.56, wpb=385.5, bsz=32, num_updates=12790, lr=9.10178e-06, gnorm=3.36, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26396
2022-05-09 04:09:05 - progress_bar.py[line:272] - INFO: epoch 001:  12820 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=391.2, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882443, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=35.341, expert1_balance_bottom=18.988, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.4, ups=0.57, wpb=391.2, bsz=32, num_updates=12800, lr=9.10057e-06, gnorm=3.489, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26413
2022-05-09 04:09:23 - progress_bar.py[line:272] - INFO: epoch 001:  12830 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=385.1, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885745, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=35.293, expert1_balance_bottom=18.913, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.9, ups=0.57, wpb=385.1, bsz=32, num_updates=12810, lr=9.09937e-06, gnorm=2.718, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26431
2022-05-09 04:09:41 - progress_bar.py[line:272] - INFO: epoch 001:  12840 / 17711 loss=3.134, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887065, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.134, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=35.038, expert1_balance_bottom=19.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=211.2, ups=0.56, wpb=378.4, bsz=32, num_updates=12820, lr=9.09817e-06, gnorm=3.942, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26449
2022-05-09 04:09:59 - progress_bar.py[line:272] - INFO: epoch 001:  12850 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=390.5, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888386, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.453, expert1_balance_bottom=19.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.6, ups=0.55, wpb=390.5, bsz=32, num_updates=12830, lr=9.09697e-06, gnorm=3.541, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26467
2022-05-09 04:10:17 - progress_bar.py[line:272] - INFO: epoch 001:  12860 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.837, expert1_balance_bottom=19.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=215, ups=0.57, wpb=380.1, bsz=32, num_updates=12840, lr=9.09577e-06, gnorm=3.213, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26485
2022-05-09 04:10:34 - progress_bar.py[line:272] - INFO: epoch 001:  12870 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=383.5, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.167, expert1_balance_top=34.118, expert1_balance_bottom=19.365, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.5, ups=0.57, wpb=383.5, bsz=32, num_updates=12850, lr=9.09457e-06, gnorm=3.182, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26502
2022-05-09 04:10:52 - progress_bar.py[line:272] - INFO: epoch 001:  12880 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=387.8, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.979, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.6, ups=0.56, wpb=387.8, bsz=32, num_updates=12860, lr=9.09337e-06, gnorm=3.734, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26520
2022-05-09 04:11:10 - progress_bar.py[line:272] - INFO: epoch 001:  12890 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=35.722, expert1_balance_bottom=18.84, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.1, ups=0.55, wpb=385, bsz=32, num_updates=12870, lr=9.09217e-06, gnorm=3.632, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26538
2022-05-09 04:11:29 - progress_bar.py[line:272] - INFO: epoch 001:  12900 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=35.114, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=207.3, ups=0.55, wpb=377.5, bsz=32, num_updates=12880, lr=9.09096e-06, gnorm=3.348, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26557
2022-05-09 04:11:47 - progress_bar.py[line:272] - INFO: epoch 001:  12910 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=34.945, expert1_balance_bottom=18.907, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=209.9, ups=0.55, wpb=382.3, bsz=32, num_updates=12890, lr=9.08976e-06, gnorm=2.998, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26575
2022-05-09 04:12:05 - progress_bar.py[line:272] - INFO: epoch 001:  12920 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.772, expert1_balance_bottom=19.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.9, ups=0.55, wpb=383.8, bsz=32, num_updates=12900, lr=9.08856e-06, gnorm=3.546, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26593
2022-05-09 04:12:23 - progress_bar.py[line:272] - INFO: epoch 001:  12930 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=33.619, expert1_balance_bottom=19.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=205, ups=0.54, wpb=377.5, bsz=32, num_updates=12910, lr=9.08736e-06, gnorm=3.226, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26611
2022-05-09 04:12:41 - progress_bar.py[line:272] - INFO: epoch 001:  12940 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885853, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.475, expert1_balance_bottom=19.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=211.2, ups=0.56, wpb=380.4, bsz=32, num_updates=12920, lr=9.08616e-06, gnorm=3.107, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26629
2022-05-09 04:12:59 - progress_bar.py[line:272] - INFO: epoch 001:  12950 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=382.2, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.415, expert1_balance_bottom=19.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.8, ups=0.55, wpb=382.2, bsz=32, num_updates=12930, lr=9.08496e-06, gnorm=3.16, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26647
2022-05-09 04:13:17 - progress_bar.py[line:272] - INFO: epoch 001:  12960 / 17711 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=383.8, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883847, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.153, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.433, expert1_balance_bottom=19.22, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=215.3, ups=0.56, wpb=383.8, bsz=32, num_updates=12940, lr=9.08376e-06, gnorm=3.638, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26665
2022-05-09 04:13:35 - progress_bar.py[line:272] - INFO: epoch 001:  12970 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=390.3, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873386, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=35.095, expert1_balance_bottom=19.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=219, ups=0.56, wpb=390.3, bsz=32, num_updates=12950, lr=9.08255e-06, gnorm=3.588, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26683
2022-05-09 04:13:53 - progress_bar.py[line:272] - INFO: epoch 001:  12980 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=390.4, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887623, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.018, expert1_balance_bottom=19.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.2, ups=0.55, wpb=390.4, bsz=32, num_updates=12960, lr=9.08135e-06, gnorm=2.908, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26701
2022-05-09 04:14:11 - progress_bar.py[line:272] - INFO: epoch 001:  12990 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=377.3, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.791, expert1_balance_bottom=18.941, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=208.6, ups=0.55, wpb=377.3, bsz=32, num_updates=12970, lr=9.08015e-06, gnorm=2.82, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26719
2022-05-09 04:14:29 - progress_bar.py[line:272] - INFO: epoch 001:  13000 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=390.2, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.072, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=218.4, ups=0.56, wpb=390.2, bsz=32, num_updates=12980, lr=9.07895e-06, gnorm=3.051, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26737
2022-05-09 04:14:47 - progress_bar.py[line:272] - INFO: epoch 001:  13010 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=389.6, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.676, expert1_balance_bottom=19.064, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216, ups=0.55, wpb=389.6, bsz=32, num_updates=12990, lr=9.07775e-06, gnorm=3.219, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26755
2022-05-09 04:15:05 - progress_bar.py[line:272] - INFO: epoch 001:  13020 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.306, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.7, ups=0.55, wpb=386.6, bsz=32, num_updates=13000, lr=9.07655e-06, gnorm=3.236, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26773
2022-05-09 04:15:23 - progress_bar.py[line:272] - INFO: epoch 001:  13030 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.077, expert1_balance_bottom=19.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.1, ups=0.56, wpb=381.1, bsz=32, num_updates=13010, lr=9.07535e-06, gnorm=4.072, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26791
2022-05-09 04:15:41 - progress_bar.py[line:272] - INFO: epoch 001:  13040 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=371.4, nsentences=32, sample_size=295.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=33.892, expert1_balance_bottom=19.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=205.7, ups=0.55, wpb=371.4, bsz=32, num_updates=13020, lr=9.07415e-06, gnorm=3.227, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26809
2022-05-09 04:15:59 - progress_bar.py[line:272] - INFO: epoch 001:  13050 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=34.361, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.1, ups=0.56, wpb=380.7, bsz=32, num_updates=13030, lr=9.07294e-06, gnorm=2.891, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26827
2022-05-09 04:16:17 - progress_bar.py[line:272] - INFO: epoch 001:  13060 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=387.8, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885938, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=34.038, expert1_balance_bottom=19.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.4, ups=0.55, wpb=387.8, bsz=32, num_updates=13040, lr=9.07174e-06, gnorm=3.272, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26846
2022-05-09 04:16:35 - progress_bar.py[line:272] - INFO: epoch 001:  13070 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=384, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.813, expert1_balance_bottom=19.104, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.1, ups=0.56, wpb=384, bsz=32, num_updates=13050, lr=9.07054e-06, gnorm=3.299, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26863
2022-05-09 04:16:53 - progress_bar.py[line:272] - INFO: epoch 001:  13080 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=383.4, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880626, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.543, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=215.4, ups=0.56, wpb=383.4, bsz=32, num_updates=13060, lr=9.06934e-06, gnorm=3.681, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26881
2022-05-09 04:17:11 - progress_bar.py[line:272] - INFO: epoch 001:  13090 / 17711 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.961, ntokens=376, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891385, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.167, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.166, expert1_balance_top=33.564, expert1_balance_bottom=19.434, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=209.1, ups=0.56, wpb=376, bsz=32, num_updates=13070, lr=9.06814e-06, gnorm=4.493, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26899
2022-05-09 04:17:29 - progress_bar.py[line:272] - INFO: epoch 001:  13100 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=386.5, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87971, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.677, expert1_balance_bottom=19.003, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=216.6, ups=0.56, wpb=386.5, bsz=32, num_updates=13080, lr=9.06694e-06, gnorm=3.25, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26917
2022-05-09 04:17:47 - progress_bar.py[line:272] - INFO: epoch 001:  13110 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=383.7, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.843, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.4, ups=0.55, wpb=383.7, bsz=32, num_updates=13090, lr=9.06574e-06, gnorm=3.242, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26935
2022-05-09 04:18:05 - progress_bar.py[line:272] - INFO: epoch 001:  13120 / 17711 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=388.1, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.185, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=33.96, expert1_balance_bottom=19.365, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=218.4, ups=0.56, wpb=388.1, bsz=32, num_updates=13100, lr=9.06453e-06, gnorm=3.812, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26953
2022-05-09 04:18:23 - progress_bar.py[line:272] - INFO: epoch 001:  13130 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=388.5, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.74, expert1_balance_bottom=19.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=217.2, ups=0.56, wpb=388.5, bsz=32, num_updates=13110, lr=9.06333e-06, gnorm=3.068, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26971
2022-05-09 04:18:41 - progress_bar.py[line:272] - INFO: epoch 001:  13140 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=34.069, expert1_balance_bottom=19.343, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=208.1, ups=0.55, wpb=379.8, bsz=32, num_updates=13120, lr=9.06213e-06, gnorm=2.881, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=26989
2022-05-09 04:18:59 - progress_bar.py[line:272] - INFO: epoch 001:  13150 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884196, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.294, expert1_balance_bottom=19.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=207.6, ups=0.55, wpb=380.1, bsz=32, num_updates=13130, lr=9.06093e-06, gnorm=2.752, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27007
2022-05-09 04:19:17 - progress_bar.py[line:272] - INFO: epoch 001:  13160 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=385.1, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888619, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.94, expert1_balance_bottom=19.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.8, ups=0.56, wpb=385.1, bsz=32, num_updates=13140, lr=9.05973e-06, gnorm=3.032, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27025
2022-05-09 04:19:35 - progress_bar.py[line:272] - INFO: epoch 001:  13170 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=397.9, nsentences=32, sample_size=316.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886758, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.886, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.9, ups=0.56, wpb=397.9, bsz=32, num_updates=13150, lr=9.05853e-06, gnorm=3.092, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27043
2022-05-09 04:19:53 - progress_bar.py[line:272] - INFO: epoch 001:  13180 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=379.7, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=33.376, expert1_balance_bottom=19.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.6, ups=0.55, wpb=379.7, bsz=32, num_updates=13160, lr=9.05733e-06, gnorm=3.789, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27061
2022-05-09 04:20:11 - progress_bar.py[line:272] - INFO: epoch 001:  13190 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=33.547, expert1_balance_bottom=19.395, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.1, ups=0.56, wpb=381.6, bsz=32, num_updates=13170, lr=9.05613e-06, gnorm=3.683, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27079
2022-05-09 04:20:29 - progress_bar.py[line:272] - INFO: epoch 001:  13200 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874582, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=35.154, expert1_balance_bottom=18.898, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.6, ups=0.56, wpb=378.2, bsz=32, num_updates=13180, lr=9.05492e-06, gnorm=3.04, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27097
2022-05-09 04:20:47 - progress_bar.py[line:272] - INFO: epoch 001:  13210 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=381.2, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881629, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.835, expert1_balance_bottom=18.863, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.5, ups=0.56, wpb=381.2, bsz=32, num_updates=13190, lr=9.05372e-06, gnorm=3.457, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27115
2022-05-09 04:21:05 - progress_bar.py[line:272] - INFO: epoch 001:  13220 / 17711 loss=3.13, loss_v1=0, loss_v2=0, nll_loss=0.936, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.13, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.57, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=210.7, ups=0.56, wpb=378, bsz=32, num_updates=13200, lr=9.05252e-06, gnorm=3.037, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27133
2022-05-09 04:21:23 - progress_bar.py[line:272] - INFO: epoch 001:  13230 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=378.3, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890901, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.163, expert1_balance_top=33.778, expert1_balance_bottom=19.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212, ups=0.56, wpb=378.3, bsz=32, num_updates=13210, lr=9.05132e-06, gnorm=3.377, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27151
2022-05-09 04:21:41 - progress_bar.py[line:272] - INFO: epoch 001:  13240 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.6, expert1_balance_bottom=19.072, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.9, ups=0.54, wpb=383.3, bsz=32, num_updates=13220, lr=9.05012e-06, gnorm=3.411, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27169
2022-05-09 04:21:59 - progress_bar.py[line:272] - INFO: epoch 001:  13250 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=379.4, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=33.557, expert1_balance_bottom=19.595, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.4, ups=0.56, wpb=379.4, bsz=32, num_updates=13230, lr=9.04892e-06, gnorm=3.168, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27187
2022-05-09 04:22:15 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-09 04:22:18 - progress_bar.py[line:272] - INFO: epoch 001:  13261 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=373.4, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=33.562, expert1_balance_bottom=19.454, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=190.3, ups=0.51, wpb=373.4, bsz=32, num_updates=13240, lr=9.04772e-06, gnorm=3.116, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27206
2022-05-09 04:22:36 - progress_bar.py[line:272] - INFO: epoch 001:  13271 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=374.8, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889632, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.572, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=210.5, ups=0.56, wpb=374.8, bsz=32, num_updates=13250, lr=9.04651e-06, gnorm=3.471, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27224
2022-05-09 04:22:54 - progress_bar.py[line:272] - INFO: epoch 001:  13281 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.063, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=214.5, ups=0.56, wpb=384.9, bsz=32, num_updates=13260, lr=9.04531e-06, gnorm=3.745, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27242
2022-05-09 04:23:12 - progress_bar.py[line:272] - INFO: epoch 001:  13291 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=387.3, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882658, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.308, expert1_balance_bottom=19.087, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=218.1, ups=0.56, wpb=387.3, bsz=32, num_updates=13270, lr=9.04411e-06, gnorm=3.076, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27260
2022-05-09 04:23:30 - progress_bar.py[line:272] - INFO: epoch 001:  13301 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=35.138, expert1_balance_bottom=18.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.4, ups=0.55, wpb=385.4, bsz=32, num_updates=13280, lr=9.04291e-06, gnorm=3.402, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27278
2022-05-09 04:23:48 - progress_bar.py[line:272] - INFO: epoch 001:  13311 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.539, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.8, ups=0.56, wpb=380.6, bsz=32, num_updates=13290, lr=9.04171e-06, gnorm=3.308, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27296
2022-05-09 04:24:06 - progress_bar.py[line:272] - INFO: epoch 001:  13321 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901625, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.165, expert1_balance_top=33.379, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210.8, ups=0.56, wpb=377.8, bsz=32, num_updates=13300, lr=9.04051e-06, gnorm=2.882, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27314
2022-05-09 04:24:23 - progress_bar.py[line:272] - INFO: epoch 001:  13331 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=378, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887756, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.58, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.4, ups=0.56, wpb=378, bsz=32, num_updates=13310, lr=9.03931e-06, gnorm=3.075, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27331
2022-05-09 04:24:41 - progress_bar.py[line:272] - INFO: epoch 001:  13341 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=388.4, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=33.334, expert1_balance_bottom=19.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.4, ups=0.56, wpb=388.4, bsz=32, num_updates=13320, lr=9.03811e-06, gnorm=2.96, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27349
2022-05-09 04:24:59 - progress_bar.py[line:272] - INFO: epoch 001:  13351 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=392.5, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.172, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220.7, ups=0.56, wpb=392.5, bsz=32, num_updates=13330, lr=9.0369e-06, gnorm=3.001, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27367
2022-05-09 04:25:17 - progress_bar.py[line:272] - INFO: epoch 001:  13361 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=387.2, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=33.812, expert1_balance_bottom=19.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.8, ups=0.57, wpb=387.2, bsz=32, num_updates=13340, lr=9.0357e-06, gnorm=3.144, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27385
2022-05-09 04:25:35 - progress_bar.py[line:272] - INFO: epoch 001:  13371 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=35.133, expert1_balance_bottom=18.925, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.4, ups=0.56, wpb=382.1, bsz=32, num_updates=13350, lr=9.0345e-06, gnorm=3.418, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27403
2022-05-09 04:25:52 - progress_bar.py[line:272] - INFO: epoch 001:  13381 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=386.9, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877614, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.593, expert1_balance_bottom=19.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.1, ups=0.57, wpb=386.9, bsz=32, num_updates=13360, lr=9.0333e-06, gnorm=2.914, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27420
2022-05-09 04:26:10 - progress_bar.py[line:272] - INFO: epoch 001:  13391 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=379.4, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.172, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.2, ups=0.55, wpb=379.4, bsz=32, num_updates=13370, lr=9.0321e-06, gnorm=3.836, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27438
2022-05-09 04:26:28 - progress_bar.py[line:272] - INFO: epoch 001:  13401 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=34.156, expert1_balance_bottom=19.283, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.8, ups=0.56, wpb=381.2, bsz=32, num_updates=13380, lr=9.0309e-06, gnorm=3.394, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27456
2022-05-09 04:26:46 - progress_bar.py[line:272] - INFO: epoch 001:  13411 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=382.4, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885366, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.328, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.5, ups=0.56, wpb=382.4, bsz=32, num_updates=13390, lr=9.0297e-06, gnorm=3.017, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27474
2022-05-09 04:27:03 - progress_bar.py[line:272] - INFO: epoch 001:  13421 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.283, expert1_balance_bottom=19.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.9, ups=0.56, wpb=385.8, bsz=32, num_updates=13400, lr=9.0285e-06, gnorm=3.043, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27492
2022-05-09 04:27:22 - progress_bar.py[line:272] - INFO: epoch 001:  13431 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=387.3, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.206, expert1_balance_bottom=19.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=215.1, ups=0.56, wpb=387.3, bsz=32, num_updates=13410, lr=9.02729e-06, gnorm=3.094, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27510
2022-05-09 04:27:39 - progress_bar.py[line:272] - INFO: epoch 001:  13441 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=34.807, expert1_balance_bottom=19.123, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=215.4, ups=0.56, wpb=381.9, bsz=32, num_updates=13420, lr=9.02609e-06, gnorm=3.198, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27527
2022-05-09 04:27:57 - progress_bar.py[line:272] - INFO: epoch 001:  13451 / 17711 loss=3.122, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891143, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.122, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=33.558, expert1_balance_bottom=19.465, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.9, ups=0.56, wpb=379.6, bsz=32, num_updates=13430, lr=9.02489e-06, gnorm=3.218, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27545
2022-05-09 04:28:15 - progress_bar.py[line:272] - INFO: epoch 001:  13461 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=386.9, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=34.018, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.7, ups=0.56, wpb=386.9, bsz=32, num_updates=13440, lr=9.02369e-06, gnorm=3.245, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27563
2022-05-09 04:28:33 - progress_bar.py[line:272] - INFO: epoch 001:  13471 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=34.019, expert1_balance_bottom=19.302, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=209.2, ups=0.55, wpb=379.7, bsz=32, num_updates=13450, lr=9.02249e-06, gnorm=3.14, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27581
2022-05-09 04:28:51 - progress_bar.py[line:272] - INFO: epoch 001:  13481 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=384.8, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883038, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.595, expert1_balance_bottom=19.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.9, ups=0.55, wpb=384.8, bsz=32, num_updates=13460, lr=9.02129e-06, gnorm=3.295, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27599
2022-05-09 04:29:09 - progress_bar.py[line:272] - INFO: epoch 001:  13491 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=375.6, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884226, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=34.328, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=207.4, ups=0.55, wpb=375.6, bsz=32, num_updates=13470, lr=9.02009e-06, gnorm=3.736, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27617
2022-05-09 04:29:27 - progress_bar.py[line:272] - INFO: epoch 001:  13501 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=390.1, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=33.629, expert1_balance_bottom=19.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=216, ups=0.55, wpb=390.1, bsz=32, num_updates=13480, lr=9.01888e-06, gnorm=3.281, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27635
2022-05-09 04:29:46 - progress_bar.py[line:272] - INFO: epoch 001:  13511 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=377.6, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.703, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=207.9, ups=0.55, wpb=377.6, bsz=32, num_updates=13490, lr=9.01768e-06, gnorm=3.416, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27654
2022-05-09 04:30:04 - progress_bar.py[line:272] - INFO: epoch 001:  13521 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=375.9, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.055, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=198.3, ups=0.53, wpb=375.9, bsz=32, num_updates=13500, lr=9.01648e-06, gnorm=3.183, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27673
2022-05-09 04:30:22 - progress_bar.py[line:272] - INFO: epoch 001:  13531 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=384.6, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=34.03, expert1_balance_bottom=19.533, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218.9, ups=0.57, wpb=384.6, bsz=32, num_updates=13510, lr=9.01528e-06, gnorm=2.633, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27690
2022-05-09 04:30:40 - progress_bar.py[line:272] - INFO: epoch 001:  13541 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=381.1, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.456, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.3, ups=0.57, wpb=381.1, bsz=32, num_updates=13520, lr=9.01408e-06, gnorm=3.121, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27708
2022-05-09 04:30:57 - progress_bar.py[line:272] - INFO: epoch 001:  13551 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=389.8, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880321, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.508, expert1_balance_bottom=19.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220, ups=0.56, wpb=389.8, bsz=32, num_updates=13530, lr=9.01288e-06, gnorm=3.571, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27726
2022-05-09 04:31:15 - progress_bar.py[line:272] - INFO: epoch 001:  13561 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.808, expert1_balance_bottom=19.351, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.5, ups=0.56, wpb=381, bsz=32, num_updates=13540, lr=9.01168e-06, gnorm=3.129, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27743
2022-05-09 04:31:33 - progress_bar.py[line:272] - INFO: epoch 001:  13571 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=386.6, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893127, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.725, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.5, ups=0.56, wpb=386.6, bsz=32, num_updates=13550, lr=9.01048e-06, gnorm=3.112, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27761
2022-05-09 04:31:51 - progress_bar.py[line:272] - INFO: epoch 001:  13581 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=386.2, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87738, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.781, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.8, ups=0.55, wpb=386.2, bsz=32, num_updates=13560, lr=9.00927e-06, gnorm=3.081, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27779
2022-05-09 04:32:09 - progress_bar.py[line:272] - INFO: epoch 001:  13591 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=385.1, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=34.336, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.8, ups=0.57, wpb=385.1, bsz=32, num_updates=13570, lr=9.00807e-06, gnorm=2.858, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27797
2022-05-09 04:32:27 - progress_bar.py[line:272] - INFO: epoch 001:  13601 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889045, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.468, expert1_balance_bottom=19.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.5, ups=0.56, wpb=381.9, bsz=32, num_updates=13580, lr=9.00687e-06, gnorm=3.155, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27815
2022-05-09 04:32:45 - progress_bar.py[line:272] - INFO: epoch 001:  13611 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873785, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.572, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.8, ups=0.56, wpb=383.3, bsz=32, num_updates=13590, lr=9.00567e-06, gnorm=3.561, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27833
2022-05-09 04:33:02 - progress_bar.py[line:272] - INFO: epoch 001:  13621 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878475, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.895, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.3, ups=0.57, wpb=383.9, bsz=32, num_updates=13600, lr=9.00447e-06, gnorm=3.263, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27851
2022-05-09 04:33:20 - progress_bar.py[line:272] - INFO: epoch 001:  13631 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=391.8, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881261, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.122, expert1_balance_bottom=19.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.7, ups=0.56, wpb=391.8, bsz=32, num_updates=13610, lr=9.00327e-06, gnorm=3.43, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27868
2022-05-09 04:33:38 - progress_bar.py[line:272] - INFO: epoch 001:  13641 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.575, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=221.1, ups=0.57, wpb=386.1, bsz=32, num_updates=13620, lr=9.00207e-06, gnorm=3.401, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27886
2022-05-09 04:33:56 - progress_bar.py[line:272] - INFO: epoch 001:  13651 / 17711 loss=3.123, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.123, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.368, expert1_balance_bottom=19.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=216.6, ups=0.56, wpb=385.7, bsz=32, num_updates=13630, lr=9.00086e-06, gnorm=3.537, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27904
2022-05-09 04:34:13 - progress_bar.py[line:272] - INFO: epoch 001:  13661 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.371, expert1_balance_bottom=19.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=214.5, ups=0.56, wpb=382.8, bsz=32, num_updates=13640, lr=8.99966e-06, gnorm=3.79, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27921
2022-05-09 04:34:31 - progress_bar.py[line:272] - INFO: epoch 001:  13671 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=33.569, expert1_balance_bottom=19.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.4, ups=0.56, wpb=386.8, bsz=32, num_updates=13650, lr=8.99846e-06, gnorm=2.884, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27939
2022-05-09 04:34:49 - progress_bar.py[line:272] - INFO: epoch 001:  13681 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=391.1, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867104, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=35.074, expert1_balance_bottom=18.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=215.4, ups=0.55, wpb=391.1, bsz=32, num_updates=13660, lr=8.99726e-06, gnorm=3.352, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27958
2022-05-09 04:35:07 - progress_bar.py[line:272] - INFO: epoch 001:  13691 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=384.8, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881945, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.102, expert1_balance_bottom=19.001, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.6, ups=0.56, wpb=384.8, bsz=32, num_updates=13670, lr=8.99606e-06, gnorm=3.506, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27976
2022-05-09 04:35:26 - progress_bar.py[line:272] - INFO: epoch 001:  13701 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875042, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=34.521, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=212.1, ups=0.55, wpb=385.7, bsz=32, num_updates=13680, lr=8.99486e-06, gnorm=3.032, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=27994
2022-05-09 04:35:44 - progress_bar.py[line:272] - INFO: epoch 001:  13711 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=378.9, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884137, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.134, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.7, ups=0.56, wpb=378.9, bsz=32, num_updates=13690, lr=8.99366e-06, gnorm=3.154, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28012
2022-05-09 04:36:02 - progress_bar.py[line:272] - INFO: epoch 001:  13721 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=385.2, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881262, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.47, expert1_balance_bottom=19.128, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.2, ups=0.56, wpb=385.2, bsz=32, num_updates=13700, lr=8.99246e-06, gnorm=3.316, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28030
2022-05-09 04:36:20 - progress_bar.py[line:272] - INFO: epoch 001:  13731 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.421, expert1_balance_bottom=19.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=210.2, ups=0.55, wpb=379.7, bsz=32, num_updates=13710, lr=8.99125e-06, gnorm=3.401, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28048
2022-05-09 04:36:38 - progress_bar.py[line:272] - INFO: epoch 001:  13741 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=378, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.9024, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.164, expert1_balance_top=32.921, expert1_balance_bottom=19.572, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=210.5, ups=0.56, wpb=378, bsz=32, num_updates=13720, lr=8.99005e-06, gnorm=3.682, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28066
2022-05-09 04:36:56 - progress_bar.py[line:272] - INFO: epoch 001:  13751 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=379.5, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874882, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.532, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=208.3, ups=0.55, wpb=379.5, bsz=32, num_updates=13730, lr=8.98885e-06, gnorm=3.916, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28084
2022-05-09 04:37:14 - progress_bar.py[line:272] - INFO: epoch 001:  13761 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88573, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=33.78, expert1_balance_bottom=19.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.9, ups=0.55, wpb=386.8, bsz=32, num_updates=13740, lr=8.98765e-06, gnorm=3.467, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28102
2022-05-09 04:37:32 - progress_bar.py[line:272] - INFO: epoch 001:  13771 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=383.7, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.062, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.9, ups=0.55, wpb=383.7, bsz=32, num_updates=13750, lr=8.98645e-06, gnorm=4.06, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28120
2022-05-09 04:37:51 - progress_bar.py[line:272] - INFO: epoch 001:  13781 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=383.5, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.544, expert1_balance_bottom=19.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=209.3, ups=0.55, wpb=383.5, bsz=32, num_updates=13760, lr=8.98525e-06, gnorm=3.277, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28139
2022-05-09 04:38:09 - progress_bar.py[line:272] - INFO: epoch 001:  13791 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.696, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.1, ups=0.55, wpb=385.4, bsz=32, num_updates=13770, lr=8.98405e-06, gnorm=3.532, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28157
2022-05-09 04:38:26 - progress_bar.py[line:272] - INFO: epoch 001:  13801 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=385.1, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.446, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=216.8, ups=0.56, wpb=385.1, bsz=32, num_updates=13780, lr=8.98285e-06, gnorm=3.703, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28174
2022-05-09 04:38:44 - progress_bar.py[line:272] - INFO: epoch 001:  13811 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=375.3, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=33.083, expert1_balance_bottom=19.605, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.3, ups=0.57, wpb=375.3, bsz=32, num_updates=13790, lr=8.98164e-06, gnorm=3.201, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28192
2022-05-09 04:39:02 - progress_bar.py[line:272] - INFO: epoch 001:  13821 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=374.8, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900133, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.162, expert1_balance_top=33.507, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212, ups=0.57, wpb=374.8, bsz=32, num_updates=13800, lr=8.98044e-06, gnorm=2.886, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28210
2022-05-09 04:39:19 - progress_bar.py[line:272] - INFO: epoch 001:  13831 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877535, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.903, expert1_balance_bottom=18.991, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.4, ups=0.56, wpb=383.1, bsz=32, num_updates=13810, lr=8.97924e-06, gnorm=3.393, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28228
2022-05-09 04:39:37 - progress_bar.py[line:272] - INFO: epoch 001:  13841 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887177, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.144, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.6, ups=0.57, wpb=385.3, bsz=32, num_updates=13820, lr=8.97804e-06, gnorm=3.155, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28245
2022-05-09 04:39:55 - progress_bar.py[line:272] - INFO: epoch 001:  13851 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=386.9, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.519, expert1_balance_bottom=19.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=219.1, ups=0.57, wpb=386.9, bsz=32, num_updates=13830, lr=8.97684e-06, gnorm=3.216, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28263
2022-05-09 04:40:13 - progress_bar.py[line:272] - INFO: epoch 001:  13861 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.541, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.4, ups=0.56, wpb=380.4, bsz=32, num_updates=13840, lr=8.97564e-06, gnorm=2.992, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28281
2022-05-09 04:40:30 - progress_bar.py[line:272] - INFO: epoch 001:  13871 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=33.931, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.8, ups=0.56, wpb=384.3, bsz=32, num_updates=13850, lr=8.97444e-06, gnorm=2.947, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28298
2022-05-09 04:40:48 - progress_bar.py[line:272] - INFO: epoch 001:  13881 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=373.9, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=34.039, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.1, ups=0.58, wpb=373.9, bsz=32, num_updates=13860, lr=8.97323e-06, gnorm=3.213, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28316
2022-05-09 04:41:06 - progress_bar.py[line:272] - INFO: epoch 001:  13891 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=391.1, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=34.479, expert1_balance_bottom=19.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.4, ups=0.55, wpb=391.1, bsz=32, num_updates=13870, lr=8.97203e-06, gnorm=3.098, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28334
2022-05-09 04:41:23 - progress_bar.py[line:272] - INFO: epoch 001:  13901 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=386.5, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892408, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=33.313, expert1_balance_bottom=19.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.5, ups=0.57, wpb=386.5, bsz=32, num_updates=13880, lr=8.97083e-06, gnorm=3.165, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28351
2022-05-09 04:41:41 - progress_bar.py[line:272] - INFO: epoch 001:  13911 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=374.1, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=33.094, expert1_balance_bottom=19.658, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=209.1, ups=0.56, wpb=374.1, bsz=32, num_updates=13890, lr=8.96963e-06, gnorm=3.209, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28369
2022-05-09 04:41:59 - progress_bar.py[line:272] - INFO: epoch 001:  13921 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=377.7, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.33, expert1_balance_bottom=19.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=215, ups=0.57, wpb=377.7, bsz=32, num_updates=13900, lr=8.96843e-06, gnorm=3.354, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28387
2022-05-09 04:42:17 - progress_bar.py[line:272] - INFO: epoch 001:  13931 / 17711 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.975, ntokens=380.3, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888458, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.177, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=33.629, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=213.1, ups=0.56, wpb=380.3, bsz=32, num_updates=13910, lr=8.96723e-06, gnorm=3.464, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28405
2022-05-09 04:42:35 - progress_bar.py[line:272] - INFO: epoch 001:  13941 / 17711 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=376.4, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.158, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=33.924, expert1_balance_bottom=19.385, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=209.5, ups=0.56, wpb=376.4, bsz=32, num_updates=13920, lr=8.96603e-06, gnorm=3.003, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28423
2022-05-09 04:42:52 - progress_bar.py[line:272] - INFO: epoch 001:  13951 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=374.1, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891172, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=33.953, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.7, ups=0.58, wpb=374.1, bsz=32, num_updates=13930, lr=8.96483e-06, gnorm=3.018, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28440
2022-05-09 04:43:09 - progress_bar.py[line:272] - INFO: epoch 001:  13961 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=390.5, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.161, expert1_balance_top=33.495, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=228.8, ups=0.59, wpb=390.5, bsz=32, num_updates=13940, lr=8.96362e-06, gnorm=3.283, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28457
2022-05-09 04:43:26 - progress_bar.py[line:272] - INFO: epoch 001:  13971 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.602, expert1_balance_bottom=19.093, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=221.8, ups=0.58, wpb=382.9, bsz=32, num_updates=13950, lr=8.96242e-06, gnorm=3.047, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28474
2022-05-09 04:43:44 - progress_bar.py[line:272] - INFO: epoch 001:  13981 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=34.562, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.1, ups=0.58, wpb=386.6, bsz=32, num_updates=13960, lr=8.96122e-06, gnorm=3.477, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28492
2022-05-09 04:44:01 - progress_bar.py[line:272] - INFO: epoch 001:  13991 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=388.3, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890023, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=34.36, expert1_balance_bottom=19.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=226.6, ups=0.58, wpb=388.3, bsz=32, num_updates=13970, lr=8.96002e-06, gnorm=3.641, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28509
2022-05-09 04:44:18 - progress_bar.py[line:272] - INFO: epoch 001:  14001 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=382.6, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=34.885, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=220.8, ups=0.58, wpb=382.6, bsz=32, num_updates=13980, lr=8.95882e-06, gnorm=2.766, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28526
2022-05-09 04:44:35 - progress_bar.py[line:272] - INFO: epoch 001:  14011 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=384.3, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892579, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=33.463, expert1_balance_bottom=19.607, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=219.9, ups=0.57, wpb=384.3, bsz=32, num_updates=13990, lr=8.95762e-06, gnorm=3.304, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28544
2022-05-09 04:44:53 - progress_bar.py[line:272] - INFO: epoch 001:  14021 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884229, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.194, expert1_balance_bottom=19.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.2, ups=0.58, wpb=387.9, bsz=32, num_updates=14000, lr=8.95642e-06, gnorm=3.315, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=28561
2022-05-09 04:44:53 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 04:44:53 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 04:44:53 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 04:52:16 - train.py[line:517] - INFO: valid_step finished
2022-05-09 04:52:16 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.691 | loss_v1 0 | loss_v2 0 | nll_loss 8.016 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.97511 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.691 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.218 | expert1_balance_top 36.391 | expert1_balance_bottom 15.178 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 258.9 | cider 1.194 | wps 679.3 | wpb 481.7 | bsz 8 | num_updates 14000 | best_cider 1.198
2022-05-09 04:52:34 - progress_bar.py[line:272] - INFO: epoch 001:  14031 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=381.3, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=34.069, expert1_balance_bottom=19.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=8.3, ups=0.02, wpb=381.3, bsz=32, num_updates=14010, lr=8.95521e-06, gnorm=3.58, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29023
2022-05-09 04:52:52 - progress_bar.py[line:272] - INFO: epoch 001:  14041 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=377.8, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886597, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=33.894, expert1_balance_bottom=19.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=211.3, ups=0.56, wpb=377.8, bsz=32, num_updates=14020, lr=8.95401e-06, gnorm=3.119, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29040
2022-05-09 04:53:10 - progress_bar.py[line:272] - INFO: epoch 001:  14051 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=389.2, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.777, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=218.7, ups=0.56, wpb=389.2, bsz=32, num_updates=14030, lr=8.95281e-06, gnorm=3.518, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29058
2022-05-09 04:53:28 - progress_bar.py[line:272] - INFO: epoch 001:  14061 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880369, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=34.586, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220, ups=0.57, wpb=383.8, bsz=32, num_updates=14040, lr=8.95161e-06, gnorm=3.065, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29076
2022-05-09 04:53:46 - progress_bar.py[line:272] - INFO: epoch 001:  14071 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=394.6, nsentences=32, sample_size=313.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880716, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=33.826, expert1_balance_bottom=19.341, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219, ups=0.55, wpb=394.6, bsz=32, num_updates=14050, lr=8.95041e-06, gnorm=2.847, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29094
2022-05-09 04:54:03 - progress_bar.py[line:272] - INFO: epoch 001:  14081 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877051, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.447, expert1_balance_bottom=19.161, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=219.4, ups=0.57, wpb=385.3, bsz=32, num_updates=14060, lr=8.94921e-06, gnorm=3.348, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29111
2022-05-09 04:54:21 - progress_bar.py[line:272] - INFO: epoch 001:  14091 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=392.2, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88807, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.297, expert1_balance_bottom=19.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.9, ups=0.57, wpb=392.2, bsz=32, num_updates=14070, lr=8.94801e-06, gnorm=3.201, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29129
2022-05-09 04:54:39 - progress_bar.py[line:272] - INFO: epoch 001:  14101 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888072, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.769, expert1_balance_bottom=19.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.1, ups=0.55, wpb=384.1, bsz=32, num_updates=14080, lr=8.94681e-06, gnorm=3.32, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29147
2022-05-09 04:54:42 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-09 04:54:59 - progress_bar.py[line:272] - INFO: epoch 001:  14112 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=377.8, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886471, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.242, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=191.5, ups=0.51, wpb=377.8, bsz=32, num_updates=14090, lr=8.9456e-06, gnorm=3.336, loss_scale=128, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29167
2022-05-09 04:55:17 - progress_bar.py[line:272] - INFO: epoch 001:  14122 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=33.709, expert1_balance_bottom=19.499, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.6, ups=0.55, wpb=384.2, bsz=32, num_updates=14100, lr=8.9444e-06, gnorm=3.023, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29185
2022-05-09 04:55:35 - progress_bar.py[line:272] - INFO: epoch 001:  14132 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=33.765, expert1_balance_bottom=19.226, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213.9, ups=0.56, wpb=381.4, bsz=32, num_updates=14110, lr=8.9432e-06, gnorm=3.563, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29203
2022-05-09 04:55:53 - progress_bar.py[line:272] - INFO: epoch 001:  14142 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=376.4, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.222, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=209.6, ups=0.56, wpb=376.4, bsz=32, num_updates=14120, lr=8.942e-06, gnorm=3.15, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29221
2022-05-09 04:56:10 - progress_bar.py[line:272] - INFO: epoch 001:  14152 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=375.9, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889626, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=33.822, expert1_balance_bottom=19.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.5, ups=0.56, wpb=375.9, bsz=32, num_updates=14130, lr=8.9408e-06, gnorm=3.076, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29238
2022-05-09 04:56:29 - progress_bar.py[line:272] - INFO: epoch 001:  14162 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=375.9, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886656, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.24, expert1_balance_bottom=19.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=206.8, ups=0.55, wpb=375.9, bsz=32, num_updates=14140, lr=8.9396e-06, gnorm=4.51, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29257
reach the end of datafile, start a new reader
2022-05-09 04:56:46 - progress_bar.py[line:272] - INFO: epoch 001:  14172 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=373, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.497, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=208.3, ups=0.56, wpb=373, bsz=32, num_updates=14150, lr=8.9384e-06, gnorm=3.457, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29275
2022-05-09 04:57:04 - progress_bar.py[line:272] - INFO: epoch 001:  14182 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=382.7, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=35.073, expert1_balance_bottom=19.012, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.4, ups=0.56, wpb=382.7, bsz=32, num_updates=14160, lr=8.9372e-06, gnorm=3.116, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29292
2022-05-09 04:57:22 - progress_bar.py[line:272] - INFO: epoch 001:  14192 / 17711 loss=3.132, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.132, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=33.725, expert1_balance_bottom=19.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.7, ups=0.56, wpb=379.2, bsz=32, num_updates=14170, lr=8.93599e-06, gnorm=3.481, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29310
2022-05-09 04:57:40 - progress_bar.py[line:272] - INFO: epoch 001:  14202 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=377.1, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880841, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=34.74, expert1_balance_bottom=19.102, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.3, ups=0.55, wpb=377.1, bsz=32, num_updates=14180, lr=8.93479e-06, gnorm=3.263, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29328
2022-05-09 04:57:58 - progress_bar.py[line:272] - INFO: epoch 001:  14212 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=377.2, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.665, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.5, ups=0.56, wpb=377.2, bsz=32, num_updates=14190, lr=8.93359e-06, gnorm=3.114, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29346
2022-05-09 04:58:16 - progress_bar.py[line:272] - INFO: epoch 001:  14222 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=392.1, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886326, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.558, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.3, ups=0.56, wpb=392.1, bsz=32, num_updates=14200, lr=8.93239e-06, gnorm=3.131, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29364
2022-05-09 04:58:34 - progress_bar.py[line:272] - INFO: epoch 001:  14232 / 17711 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.979, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.167, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=34.729, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=214.7, ups=0.56, wpb=384.3, bsz=32, num_updates=14210, lr=8.93119e-06, gnorm=4.018, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29382
2022-05-09 04:58:52 - progress_bar.py[line:272] - INFO: epoch 001:  14242 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=374.7, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880396, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.591, expert1_balance_bottom=19.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.7, ups=0.57, wpb=374.7, bsz=32, num_updates=14220, lr=8.92999e-06, gnorm=2.656, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29400
2022-05-09 04:59:09 - progress_bar.py[line:272] - INFO: epoch 001:  14252 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=382.9, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883699, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.251, expert1_balance_bottom=19.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.3, ups=0.57, wpb=382.9, bsz=32, num_updates=14230, lr=8.92879e-06, gnorm=3.363, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29417
2022-05-09 04:59:27 - progress_bar.py[line:272] - INFO: epoch 001:  14262 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=385.8, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=33.623, expert1_balance_bottom=19.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.8, ups=0.56, wpb=385.8, bsz=32, num_updates=14240, lr=8.92758e-06, gnorm=3.093, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29435
2022-05-09 04:59:45 - progress_bar.py[line:272] - INFO: epoch 001:  14272 / 17711 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=392.2, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872793, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.117, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=35.026, expert1_balance_bottom=18.984, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=216.3, ups=0.55, wpb=392.2, bsz=32, num_updates=14250, lr=8.92638e-06, gnorm=3.123, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29453
2022-05-09 05:00:03 - progress_bar.py[line:272] - INFO: epoch 001:  14282 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=386.9, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888929, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.979, expert1_balance_bottom=19.34, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.9, ups=0.56, wpb=386.9, bsz=32, num_updates=14260, lr=8.92518e-06, gnorm=3.612, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29471
2022-05-09 05:00:21 - progress_bar.py[line:272] - INFO: epoch 001:  14292 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=378.5, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=33.927, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.9, ups=0.56, wpb=378.5, bsz=32, num_updates=14270, lr=8.92398e-06, gnorm=3.148, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29489
2022-05-09 05:00:39 - progress_bar.py[line:272] - INFO: epoch 001:  14302 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=373.2, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.19, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=204.2, ups=0.55, wpb=373.2, bsz=32, num_updates=14280, lr=8.92278e-06, gnorm=3.223, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29507
2022-05-09 05:00:57 - progress_bar.py[line:272] - INFO: epoch 001:  14312 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890231, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=33.868, expert1_balance_bottom=19.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=209.2, ups=0.55, wpb=378.2, bsz=32, num_updates=14290, lr=8.92158e-06, gnorm=3.529, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29525
2022-05-09 05:01:15 - progress_bar.py[line:272] - INFO: epoch 001:  14322 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.449, expert1_balance_bottom=19.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=207.8, ups=0.55, wpb=379, bsz=32, num_updates=14300, lr=8.92038e-06, gnorm=3.443, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29543
2022-05-09 05:01:34 - progress_bar.py[line:272] - INFO: epoch 001:  14332 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=375.7, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889215, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.886, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=206.5, ups=0.55, wpb=375.7, bsz=32, num_updates=14310, lr=8.91918e-06, gnorm=3.285, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29562
2022-05-09 05:01:52 - progress_bar.py[line:272] - INFO: epoch 001:  14342 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.763, expert1_balance_bottom=19.357, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.7, ups=0.56, wpb=377.8, bsz=32, num_updates=14320, lr=8.91797e-06, gnorm=3.089, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29580
2022-05-09 05:02:10 - progress_bar.py[line:272] - INFO: epoch 001:  14352 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=379.8, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.993, expert1_balance_bottom=19.161, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.5, ups=0.56, wpb=379.8, bsz=32, num_updates=14330, lr=8.91677e-06, gnorm=3.253, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29598
2022-05-09 05:02:28 - progress_bar.py[line:272] - INFO: epoch 001:  14362 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=386, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.924, expert1_balance_bottom=19.194, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=214.6, ups=0.56, wpb=386, bsz=32, num_updates=14340, lr=8.91557e-06, gnorm=3.295, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29616
2022-05-09 05:02:45 - progress_bar.py[line:272] - INFO: epoch 001:  14372 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886974, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.685, expert1_balance_bottom=18.912, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=215.1, ups=0.56, wpb=385.5, bsz=32, num_updates=14350, lr=8.91437e-06, gnorm=3.083, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29633
2022-05-09 05:03:03 - progress_bar.py[line:272] - INFO: epoch 001:  14382 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=379.3, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.849, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=212.6, ups=0.56, wpb=379.3, bsz=32, num_updates=14360, lr=8.91317e-06, gnorm=3.583, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29651
2022-05-09 05:03:21 - progress_bar.py[line:272] - INFO: epoch 001:  14392 / 17711 loss=3.131, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.131, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=33.993, expert1_balance_bottom=19.341, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=211.2, ups=0.55, wpb=382.9, bsz=32, num_updates=14370, lr=8.91197e-06, gnorm=2.97, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29669
2022-05-09 05:03:39 - progress_bar.py[line:272] - INFO: epoch 001:  14402 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=371.5, nsentences=32, sample_size=295.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=33.893, expert1_balance_bottom=19.465, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.4, ups=0.56, wpb=371.5, bsz=32, num_updates=14380, lr=8.91077e-06, gnorm=3.319, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29687
2022-05-09 05:03:57 - progress_bar.py[line:272] - INFO: epoch 001:  14412 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=382.7, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.860988, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=35.561, expert1_balance_bottom=18.997, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.5, ups=0.55, wpb=382.7, bsz=32, num_updates=14390, lr=8.90956e-06, gnorm=3.663, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29705
2022-05-09 05:04:15 - progress_bar.py[line:272] - INFO: epoch 001:  14422 / 17711 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=381.3, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.133, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.293, expert1_balance_bottom=19.188, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213, ups=0.56, wpb=381.3, bsz=32, num_updates=14400, lr=8.90836e-06, gnorm=3.717, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29723
2022-05-09 05:04:33 - progress_bar.py[line:272] - INFO: epoch 001:  14432 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=385.9, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=35.12, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.5, ups=0.56, wpb=385.9, bsz=32, num_updates=14410, lr=8.90716e-06, gnorm=3.35, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29741
2022-05-09 05:04:51 - progress_bar.py[line:272] - INFO: epoch 001:  14442 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=379.3, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882059, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.4, expert1_balance_bottom=19.084, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212, ups=0.56, wpb=379.3, bsz=32, num_updates=14420, lr=8.90596e-06, gnorm=3.355, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29759
2022-05-09 05:05:09 - progress_bar.py[line:272] - INFO: epoch 001:  14452 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897642, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=33.707, expert1_balance_bottom=19.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.6, ups=0.55, wpb=385.2, bsz=32, num_updates=14430, lr=8.90476e-06, gnorm=3.095, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29777
2022-05-09 05:05:27 - progress_bar.py[line:272] - INFO: epoch 001:  14462 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=374.2, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893964, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=33.856, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=209.4, ups=0.56, wpb=374.2, bsz=32, num_updates=14440, lr=8.90356e-06, gnorm=2.961, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29795
2022-05-09 05:05:46 - progress_bar.py[line:272] - INFO: epoch 001:  14472 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876141, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.749, expert1_balance_bottom=18.975, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.1, ups=0.55, wpb=384.2, bsz=32, num_updates=14450, lr=8.90236e-06, gnorm=2.98, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29814
2022-05-09 05:06:04 - progress_bar.py[line:272] - INFO: epoch 001:  14482 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893415, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.445, expert1_balance_bottom=19.394, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.3, ups=0.56, wpb=379.2, bsz=32, num_updates=14460, lr=8.90116e-06, gnorm=3.268, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29832
2022-05-09 05:06:22 - progress_bar.py[line:272] - INFO: epoch 001:  14492 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.524, expert1_balance_bottom=19.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.6, ups=0.55, wpb=383.8, bsz=32, num_updates=14470, lr=8.89995e-06, gnorm=3.562, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29850
2022-05-09 05:06:40 - progress_bar.py[line:272] - INFO: epoch 001:  14502 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=386, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=33.939, expert1_balance_bottom=19.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.2, ups=0.55, wpb=386, bsz=32, num_updates=14480, lr=8.89875e-06, gnorm=3.768, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29868
2022-05-09 05:06:58 - progress_bar.py[line:272] - INFO: epoch 001:  14512 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=378.8, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.71, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.2, ups=0.56, wpb=378.8, bsz=32, num_updates=14490, lr=8.89755e-06, gnorm=3.521, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29886
2022-05-09 05:07:16 - progress_bar.py[line:272] - INFO: epoch 001:  14522 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90298, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.16, expert1_balance_top=33.168, expert1_balance_bottom=19.535, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.7, ups=0.56, wpb=380.2, bsz=32, num_updates=14500, lr=8.89635e-06, gnorm=3.235, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29904
2022-05-09 05:07:34 - progress_bar.py[line:272] - INFO: epoch 001:  14532 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=34.098, expert1_balance_bottom=19.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.1, ups=0.55, wpb=381.9, bsz=32, num_updates=14510, lr=8.89515e-06, gnorm=3.156, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29922
2022-05-09 05:07:52 - progress_bar.py[line:272] - INFO: epoch 001:  14542 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=390.2, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892782, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.089, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.6, ups=0.56, wpb=390.2, bsz=32, num_updates=14520, lr=8.89395e-06, gnorm=3.494, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29940
2022-05-09 05:08:09 - progress_bar.py[line:272] - INFO: epoch 001:  14552 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.159, expert1_balance_top=33.917, expert1_balance_bottom=19.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.7, ups=0.56, wpb=381.8, bsz=32, num_updates=14530, lr=8.89275e-06, gnorm=3.329, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29957
2022-05-09 05:08:27 - progress_bar.py[line:272] - INFO: epoch 001:  14562 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=392.2, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=33.992, expert1_balance_bottom=19.343, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.7, ups=0.55, wpb=392.2, bsz=32, num_updates=14540, lr=8.89155e-06, gnorm=3.367, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29976
2022-05-09 05:08:45 - progress_bar.py[line:272] - INFO: epoch 001:  14572 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=385.3, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=35.026, expert1_balance_bottom=19.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=217.1, ups=0.56, wpb=385.3, bsz=32, num_updates=14550, lr=8.89034e-06, gnorm=3.352, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=29993
2022-05-09 05:09:03 - progress_bar.py[line:272] - INFO: epoch 001:  14582 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=376.3, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883433, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=34.168, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=212.3, ups=0.56, wpb=376.3, bsz=32, num_updates=14560, lr=8.88914e-06, gnorm=3.363, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30011
2022-05-09 05:09:21 - progress_bar.py[line:272] - INFO: epoch 001:  14592 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.107, expert1_balance_bottom=19.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210.5, ups=0.55, wpb=380.5, bsz=32, num_updates=14570, lr=8.88794e-06, gnorm=3.48, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30029
2022-05-09 05:09:39 - progress_bar.py[line:272] - INFO: epoch 001:  14602 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885379, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.141, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.7, ups=0.56, wpb=380.8, bsz=32, num_updates=14580, lr=8.88674e-06, gnorm=3.065, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30047
2022-05-09 05:09:57 - progress_bar.py[line:272] - INFO: epoch 001:  14612 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=379.8, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.021, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.7, ups=0.55, wpb=379.8, bsz=32, num_updates=14590, lr=8.88554e-06, gnorm=3.101, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30065
2022-05-09 05:10:15 - progress_bar.py[line:272] - INFO: epoch 001:  14622 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=382.2, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890852, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=34.403, expert1_balance_bottom=19.113, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.6, ups=0.55, wpb=382.2, bsz=32, num_updates=14600, lr=8.88434e-06, gnorm=3.7, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30083
2022-05-09 05:10:33 - progress_bar.py[line:272] - INFO: epoch 001:  14632 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.583, expert1_balance_bottom=19.227, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.3, ups=0.56, wpb=380.4, bsz=32, num_updates=14610, lr=8.88314e-06, gnorm=3.371, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30101
2022-05-09 05:10:51 - progress_bar.py[line:272] - INFO: epoch 001:  14642 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=383.5, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.22, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214.7, ups=0.56, wpb=383.5, bsz=32, num_updates=14620, lr=8.88193e-06, gnorm=3.501, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30119
2022-05-09 05:11:09 - progress_bar.py[line:272] - INFO: epoch 001:  14652 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.158, expert1_balance_top=33.665, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=210.6, ups=0.56, wpb=378.7, bsz=32, num_updates=14630, lr=8.88073e-06, gnorm=3.343, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30137
2022-05-09 05:11:27 - progress_bar.py[line:272] - INFO: epoch 001:  14662 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=394.4, nsentences=32, sample_size=313.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=35.08, expert1_balance_bottom=19.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220.3, ups=0.56, wpb=394.4, bsz=32, num_updates=14640, lr=8.87953e-06, gnorm=3.719, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30155
2022-05-09 05:11:32 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-09 05:11:47 - progress_bar.py[line:272] - INFO: epoch 001:  14673 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=383.3, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888594, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=33.811, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=193.3, ups=0.5, wpb=383.3, bsz=32, num_updates=14650, lr=8.87833e-06, gnorm=2.766, loss_scale=128, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30175
2022-05-09 05:12:04 - progress_bar.py[line:272] - INFO: epoch 001:  14683 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=386.2, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892273, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=33.899, expert1_balance_bottom=19.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218.6, ups=0.57, wpb=386.2, bsz=32, num_updates=14660, lr=8.87713e-06, gnorm=3.442, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30192
2022-05-09 05:12:22 - progress_bar.py[line:272] - INFO: epoch 001:  14693 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=388.2, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88611, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=34.123, expert1_balance_bottom=19.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=216.5, ups=0.56, wpb=388.2, bsz=32, num_updates=14670, lr=8.87593e-06, gnorm=3.361, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30210
2022-05-09 05:12:40 - progress_bar.py[line:272] - INFO: epoch 001:  14703 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=379.5, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89173, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.891, expert1_balance_bottom=19.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.5, ups=0.56, wpb=379.5, bsz=32, num_updates=14680, lr=8.87473e-06, gnorm=3.725, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30228
2022-05-09 05:12:58 - progress_bar.py[line:272] - INFO: epoch 001:  14713 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=34.532, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.6, ups=0.55, wpb=383.4, bsz=32, num_updates=14690, lr=8.87353e-06, gnorm=3.515, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30246
2022-05-09 05:13:17 - progress_bar.py[line:272] - INFO: epoch 001:  14723 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=385.1, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.531, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.7, ups=0.55, wpb=385.1, bsz=32, num_updates=14700, lr=8.87232e-06, gnorm=3.497, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30265
2022-05-09 05:13:33 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 05:13:37 - progress_bar.py[line:272] - INFO: epoch 001:  14734 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=386.7, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883492, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.15, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=192.9, ups=0.5, wpb=386.7, bsz=32, num_updates=14710, lr=8.87112e-06, gnorm=3.101, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30285
2022-05-09 05:13:55 - progress_bar.py[line:272] - INFO: epoch 001:  14744 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=389, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.488, expert1_balance_bottom=19.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.1, ups=0.55, wpb=389, bsz=32, num_updates=14720, lr=8.86992e-06, gnorm=3.171, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30303
2022-05-09 05:14:13 - progress_bar.py[line:272] - INFO: epoch 001:  14754 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=389.7, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.307, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.4, ups=0.56, wpb=389.7, bsz=32, num_updates=14730, lr=8.86872e-06, gnorm=3.935, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30321
2022-05-09 05:14:30 - progress_bar.py[line:272] - INFO: epoch 001:  14764 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.787, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217.6, ups=0.56, wpb=386.3, bsz=32, num_updates=14740, lr=8.86752e-06, gnorm=3.79, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30339
2022-05-09 05:14:48 - progress_bar.py[line:272] - INFO: epoch 001:  14774 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=384.5, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891162, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.392, expert1_balance_bottom=19.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215.9, ups=0.56, wpb=384.5, bsz=32, num_updates=14750, lr=8.86632e-06, gnorm=3.104, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30356
2022-05-09 05:15:06 - progress_bar.py[line:272] - INFO: epoch 001:  14784 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=386.7, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877523, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.354, expert1_balance_bottom=19.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=215.3, ups=0.56, wpb=386.7, bsz=32, num_updates=14760, lr=8.86512e-06, gnorm=3.593, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30374
2022-05-09 05:15:24 - progress_bar.py[line:272] - INFO: epoch 001:  14794 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=370.3, nsentences=32, sample_size=294.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889777, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=33.729, expert1_balance_bottom=19.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=207.7, ups=0.56, wpb=370.3, bsz=32, num_updates=14770, lr=8.86391e-06, gnorm=3.542, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30392
2022-05-09 05:15:42 - progress_bar.py[line:272] - INFO: epoch 001:  14804 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=384.2, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877576, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.162, expert1_balance_bottom=19.283, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=214.3, ups=0.56, wpb=384.2, bsz=32, num_updates=14780, lr=8.86271e-06, gnorm=3.347, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30410
2022-05-09 05:16:00 - progress_bar.py[line:272] - INFO: epoch 001:  14814 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=380.3, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879587, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.535, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211, ups=0.55, wpb=380.3, bsz=32, num_updates=14790, lr=8.86151e-06, gnorm=3.507, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30428
2022-05-09 05:16:18 - progress_bar.py[line:272] - INFO: epoch 001:  14824 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=388.2, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.964, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215, ups=0.55, wpb=388.2, bsz=32, num_updates=14800, lr=8.86031e-06, gnorm=3.107, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30446
2022-05-09 05:16:36 - progress_bar.py[line:272] - INFO: epoch 001:  14834 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=33.546, expert1_balance_bottom=19.452, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.2, ups=0.56, wpb=387.2, bsz=32, num_updates=14810, lr=8.85911e-06, gnorm=3.187, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30464
2022-05-09 05:16:54 - progress_bar.py[line:272] - INFO: epoch 001:  14844 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.327, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.5, ups=0.56, wpb=386.4, bsz=32, num_updates=14820, lr=8.85791e-06, gnorm=2.975, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30482
2022-05-09 05:17:12 - progress_bar.py[line:272] - INFO: epoch 001:  14854 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=390, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=35.375, expert1_balance_bottom=18.983, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=218.6, ups=0.56, wpb=390, bsz=32, num_updates=14830, lr=8.85671e-06, gnorm=3.504, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30500
2022-05-09 05:17:30 - progress_bar.py[line:272] - INFO: epoch 001:  14864 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=380.8, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.554, expert1_balance_bottom=19.542, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213, ups=0.56, wpb=380.8, bsz=32, num_updates=14840, lr=8.85551e-06, gnorm=3.357, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30518
2022-05-09 05:17:48 - progress_bar.py[line:272] - INFO: epoch 001:  14874 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=377.8, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881068, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.408, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=210.2, ups=0.56, wpb=377.8, bsz=32, num_updates=14850, lr=8.8543e-06, gnorm=3.554, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30536
2022-05-09 05:18:05 - progress_bar.py[line:272] - INFO: epoch 001:  14884 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=390.7, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878806, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.524, expert1_balance_bottom=19.145, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=222.6, ups=0.57, wpb=390.7, bsz=32, num_updates=14860, lr=8.8531e-06, gnorm=3.725, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30553
2022-05-09 05:18:23 - progress_bar.py[line:272] - INFO: epoch 001:  14894 / 17711 loss=3.106, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.106, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=34.378, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.5, ups=0.55, wpb=383.3, bsz=32, num_updates=14870, lr=8.8519e-06, gnorm=3.673, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30571
2022-05-09 05:18:41 - progress_bar.py[line:272] - INFO: epoch 001:  14904 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=378.2, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888443, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.848, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=208.7, ups=0.55, wpb=378.2, bsz=32, num_updates=14880, lr=8.8507e-06, gnorm=4.312, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30589
2022-05-09 05:18:59 - progress_bar.py[line:272] - INFO: epoch 001:  14914 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=34.536, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.9, ups=0.56, wpb=381.1, bsz=32, num_updates=14890, lr=8.8495e-06, gnorm=3.253, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30607
2022-05-09 05:19:17 - progress_bar.py[line:272] - INFO: epoch 001:  14924 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=375.3, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=34.082, expert1_balance_bottom=19.327, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=207.9, ups=0.55, wpb=375.3, bsz=32, num_updates=14900, lr=8.8483e-06, gnorm=3.416, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30625
2022-05-09 05:19:35 - progress_bar.py[line:272] - INFO: epoch 001:  14934 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=377.2, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884378, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.756, expert1_balance_bottom=19.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.9, ups=0.55, wpb=377.2, bsz=32, num_updates=14910, lr=8.8471e-06, gnorm=3.673, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30643
2022-05-09 05:19:54 - progress_bar.py[line:272] - INFO: epoch 001:  14944 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=393.6, nsentences=32, sample_size=313.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877105, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.275, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=216.2, ups=0.55, wpb=393.6, bsz=32, num_updates=14920, lr=8.8459e-06, gnorm=3.574, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30662
2022-05-09 05:20:11 - progress_bar.py[line:272] - INFO: epoch 001:  14954 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=385.5, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.043, expert1_balance_bottom=19.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.2, ups=0.56, wpb=385.5, bsz=32, num_updates=14930, lr=8.84469e-06, gnorm=2.979, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30679
2022-05-09 05:20:29 - progress_bar.py[line:272] - INFO: epoch 001:  14964 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=386.8, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88261, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.312, expert1_balance_bottom=19.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.2, ups=0.56, wpb=386.8, bsz=32, num_updates=14940, lr=8.84349e-06, gnorm=3.45, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30697
2022-05-09 05:20:47 - progress_bar.py[line:272] - INFO: epoch 001:  14974 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=379.1, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.285, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.8, ups=0.56, wpb=379.1, bsz=32, num_updates=14950, lr=8.84229e-06, gnorm=3.283, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30715
2022-05-09 05:21:05 - progress_bar.py[line:272] - INFO: epoch 001:  14984 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=377.4, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.245, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.9, ups=0.56, wpb=377.4, bsz=32, num_updates=14960, lr=8.84109e-06, gnorm=3.646, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30733
2022-05-09 05:21:23 - progress_bar.py[line:272] - INFO: epoch 001:  14994 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891432, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=33.126, expert1_balance_bottom=19.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.8, ups=0.55, wpb=380.8, bsz=32, num_updates=14970, lr=8.83989e-06, gnorm=2.955, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30751
2022-05-09 05:21:40 - progress_bar.py[line:272] - INFO: epoch 001:  15004 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=374.8, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.788, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.2, ups=0.56, wpb=374.8, bsz=32, num_updates=14980, lr=8.83869e-06, gnorm=3.156, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30768
2022-05-09 05:21:59 - progress_bar.py[line:272] - INFO: epoch 001:  15014 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=387.9, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.201, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.1, ups=0.55, wpb=387.9, bsz=32, num_updates=14990, lr=8.83749e-06, gnorm=3.703, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30787
2022-05-09 05:22:17 - progress_bar.py[line:272] - INFO: epoch 001:  15024 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880963, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.122, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.4, ups=0.55, wpb=385.1, bsz=32, num_updates=15000, lr=8.83628e-06, gnorm=2.952, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=30805
2022-05-09 05:22:17 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 05:22:17 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 05:22:17 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 05:29:42 - train.py[line:517] - INFO: valid_step finished
2022-05-09 05:29:42 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 10.009 | loss_v1 0 | loss_v2 0 | nll_loss 8.342 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.9779 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.009 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.214 | expert1_balance_top 36.403 | expert1_balance_bottom 14.973 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 324.4 | cider 1.193 | wps 677.3 | wpb 481.7 | bsz 8 | num_updates 15000 | best_cider 1.198
2022-05-09 05:29:42 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 1 @ 15000 updates
2022-05-09 05:29:42 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_15000-rank-0.pt
2022-05-09 05:29:42 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_15000-rank-0.pt
2022-05-09 05:29:50 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_15000-rank-0.pt
2022-05-09 05:29:50 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_15000-shared.pt
2022-05-09 05:29:59 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_15000-shared.pt
2022-05-09 05:30:11 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_1_15000-rank-0.pt (epoch 1 @ 15000 updates, score 1.193) (writing took 28.87860614620149 seconds)
2022-05-09 05:30:28 - progress_bar.py[line:272] - INFO: epoch 001:  15034 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=373.2, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.651, expert1_balance_bottom=18.996, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=7.6, ups=0.02, wpb=373.2, bsz=32, num_updates=15010, lr=8.83508e-06, gnorm=3.467, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31296
2022-05-09 05:30:46 - progress_bar.py[line:272] - INFO: epoch 001:  15044 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=387.2, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=33.194, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=219.3, ups=0.57, wpb=387.2, bsz=32, num_updates=15020, lr=8.83388e-06, gnorm=2.976, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31314
2022-05-09 05:31:04 - progress_bar.py[line:272] - INFO: epoch 001:  15054 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=385.5, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879544, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.569, expert1_balance_bottom=19.087, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.9, ups=0.56, wpb=385.5, bsz=32, num_updates=15030, lr=8.83268e-06, gnorm=3.226, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31332
2022-05-09 05:31:21 - progress_bar.py[line:272] - INFO: epoch 001:  15064 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.291, expert1_balance_bottom=19.145, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213.2, ups=0.56, wpb=380.9, bsz=32, num_updates=15040, lr=8.83148e-06, gnorm=4.871, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31350
2022-05-09 05:31:25 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 05:31:41 - progress_bar.py[line:272] - INFO: epoch 001:  15075 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=384, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=34.26, expert1_balance_bottom=19.035, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=199.4, ups=0.52, wpb=384, bsz=32, num_updates=15050, lr=8.83028e-06, gnorm=3.13, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31369
2022-05-09 05:31:58 - progress_bar.py[line:272] - INFO: epoch 001:  15085 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=395.1, nsentences=32, sample_size=314.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877799, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.761, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=224.5, ups=0.57, wpb=395.1, bsz=32, num_updates=15060, lr=8.82908e-06, gnorm=3.132, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31386
2022-05-09 05:32:16 - progress_bar.py[line:272] - INFO: epoch 001:  15095 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=393.6, nsentences=32, sample_size=313.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.459, expert1_balance_bottom=19.067, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=223, ups=0.57, wpb=393.6, bsz=32, num_updates=15070, lr=8.82788e-06, gnorm=2.951, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31404
2022-05-09 05:32:34 - progress_bar.py[line:272] - INFO: epoch 001:  15105 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=384, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.325, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.2, ups=0.55, wpb=384, bsz=32, num_updates=15080, lr=8.82667e-06, gnorm=3.054, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31422
2022-05-09 05:32:52 - progress_bar.py[line:272] - INFO: epoch 001:  15115 / 17711 loss=3.113, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=385.6, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.113, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=33.573, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=218, ups=0.57, wpb=385.6, bsz=32, num_updates=15090, lr=8.82547e-06, gnorm=3.907, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31440
2022-05-09 05:33:09 - progress_bar.py[line:272] - INFO: epoch 001:  15125 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=374.7, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.805, expert1_balance_bottom=19.26, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.6, ups=0.56, wpb=374.7, bsz=32, num_updates=15100, lr=8.82427e-06, gnorm=3.399, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31458
2022-05-09 05:33:27 - progress_bar.py[line:272] - INFO: epoch 001:  15135 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=384.4, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.408, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.4, ups=0.57, wpb=384.4, bsz=32, num_updates=15110, lr=8.82307e-06, gnorm=2.999, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31475
2022-05-09 05:33:45 - progress_bar.py[line:272] - INFO: epoch 001:  15145 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=377.5, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885637, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.782, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.5, ups=0.56, wpb=377.5, bsz=32, num_updates=15120, lr=8.82187e-06, gnorm=3.151, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31493
2022-05-09 05:34:03 - progress_bar.py[line:272] - INFO: epoch 001:  15155 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=392.2, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88643, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.884, expert1_balance_bottom=19.374, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=222.7, ups=0.57, wpb=392.2, bsz=32, num_updates=15130, lr=8.82067e-06, gnorm=3.261, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31511
2022-05-09 05:34:20 - progress_bar.py[line:272] - INFO: epoch 001:  15165 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=389.2, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=33.808, expert1_balance_bottom=19.561, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=218.5, ups=0.56, wpb=389.2, bsz=32, num_updates=15140, lr=8.81947e-06, gnorm=3.188, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31528
2022-05-09 05:34:38 - progress_bar.py[line:272] - INFO: epoch 001:  15175 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=387, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876139, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.633, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=219.5, ups=0.57, wpb=387, bsz=32, num_updates=15150, lr=8.81826e-06, gnorm=3.587, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31546
2022-05-09 05:34:56 - progress_bar.py[line:272] - INFO: epoch 001:  15185 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.117, expert1_balance_bottom=19.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.5, ups=0.56, wpb=384.3, bsz=32, num_updates=15160, lr=8.81706e-06, gnorm=3.086, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31564
2022-05-09 05:35:13 - progress_bar.py[line:272] - INFO: epoch 001:  15195 / 17711 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.951, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.725, expert1_balance_bottom=19.575, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=218.2, ups=0.56, wpb=386.4, bsz=32, num_updates=15170, lr=8.81586e-06, gnorm=2.694, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31581
2022-05-09 05:35:31 - progress_bar.py[line:272] - INFO: epoch 001:  15205 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=387.5, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887833, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.806, expert1_balance_bottom=19.343, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.5, ups=0.56, wpb=387.5, bsz=32, num_updates=15180, lr=8.81466e-06, gnorm=3.693, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31599
2022-05-09 05:35:49 - progress_bar.py[line:272] - INFO: epoch 001:  15215 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=368.9, nsentences=32, sample_size=293.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890855, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=34.043, expert1_balance_bottom=19.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209, ups=0.57, wpb=368.9, bsz=32, num_updates=15190, lr=8.81346e-06, gnorm=3.193, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31617
2022-05-09 05:36:07 - progress_bar.py[line:272] - INFO: epoch 001:  15225 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=373.2, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885855, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.554, expert1_balance_bottom=19.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.7, ups=0.56, wpb=373.2, bsz=32, num_updates=15200, lr=8.81226e-06, gnorm=3.265, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31635
2022-05-09 05:36:25 - progress_bar.py[line:272] - INFO: epoch 001:  15235 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=375.4, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.155, expert1_balance_top=33.698, expert1_balance_bottom=19.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209.7, ups=0.56, wpb=375.4, bsz=32, num_updates=15210, lr=8.81106e-06, gnorm=3.266, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31653
2022-05-09 05:36:43 - progress_bar.py[line:272] - INFO: epoch 001:  15245 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=382, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885722, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.211, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=213.1, ups=0.56, wpb=382, bsz=32, num_updates=15220, lr=8.80986e-06, gnorm=2.928, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31671
2022-05-09 05:37:01 - progress_bar.py[line:272] - INFO: epoch 001:  15255 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900993, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=33.265, expert1_balance_bottom=19.546, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.5, ups=0.56, wpb=383.9, bsz=32, num_updates=15230, lr=8.80865e-06, gnorm=3.648, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31689
2022-05-09 05:37:18 - progress_bar.py[line:272] - INFO: epoch 001:  15265 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.859, expert1_balance_bottom=19.064, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=215.7, ups=0.56, wpb=385.8, bsz=32, num_updates=15240, lr=8.80745e-06, gnorm=3.245, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31707
2022-05-09 05:37:36 - progress_bar.py[line:272] - INFO: epoch 001:  15275 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=383.1, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867586, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=34.897, expert1_balance_bottom=19.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.6, ups=0.56, wpb=383.1, bsz=32, num_updates=15250, lr=8.80625e-06, gnorm=3.192, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31725
2022-05-09 05:37:54 - progress_bar.py[line:272] - INFO: epoch 001:  15285 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=386.2, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.974, expert1_balance_bottom=19.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215.8, ups=0.56, wpb=386.2, bsz=32, num_updates=15260, lr=8.80505e-06, gnorm=3.068, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31742
2022-05-09 05:38:12 - progress_bar.py[line:272] - INFO: epoch 001:  15295 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=381.4, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884103, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.181, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=215, ups=0.56, wpb=381.4, bsz=32, num_updates=15270, lr=8.80385e-06, gnorm=3.386, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31760
2022-05-09 05:38:30 - progress_bar.py[line:272] - INFO: epoch 001:  15305 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=384.8, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887515, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=33.438, expert1_balance_bottom=19.514, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=214.1, ups=0.56, wpb=384.8, bsz=32, num_updates=15280, lr=8.80265e-06, gnorm=3.272, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31778
2022-05-09 05:38:48 - progress_bar.py[line:272] - INFO: epoch 001:  15315 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882077, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.325, expert1_balance_bottom=19.168, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=211.2, ups=0.55, wpb=383.2, bsz=32, num_updates=15290, lr=8.80145e-06, gnorm=3.132, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31796
2022-05-09 05:39:06 - progress_bar.py[line:272] - INFO: epoch 001:  15325 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=389.7, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874386, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.349, expert1_balance_bottom=19.226, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.7, ups=0.55, wpb=389.7, bsz=32, num_updates=15300, lr=8.80025e-06, gnorm=3.352, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31815
2022-05-09 05:39:25 - progress_bar.py[line:272] - INFO: epoch 001:  15335 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=396.3, nsentences=32, sample_size=315.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=34.928, expert1_balance_bottom=18.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.4, ups=0.55, wpb=396.3, bsz=32, num_updates=15310, lr=8.79904e-06, gnorm=3.577, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31833
2022-05-09 05:39:43 - progress_bar.py[line:272] - INFO: epoch 001:  15345 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=384.2, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=33.475, expert1_balance_bottom=19.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.1, ups=0.56, wpb=384.2, bsz=32, num_updates=15320, lr=8.79784e-06, gnorm=3.068, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31851
2022-05-09 05:40:01 - progress_bar.py[line:272] - INFO: epoch 001:  15355 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=382.3, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879658, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.139, expert1_balance_bottom=19.395, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=208, ups=0.54, wpb=382.3, bsz=32, num_updates=15330, lr=8.79664e-06, gnorm=3.241, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31869
2022-05-09 05:40:19 - progress_bar.py[line:272] - INFO: epoch 001:  15365 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.363, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.1, ups=0.55, wpb=382.9, bsz=32, num_updates=15340, lr=8.79544e-06, gnorm=3.04, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31887
2022-05-09 05:40:37 - progress_bar.py[line:272] - INFO: epoch 001:  15375 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=385.3, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880236, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.499, expert1_balance_bottom=19.22, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.3, ups=0.56, wpb=385.3, bsz=32, num_updates=15350, lr=8.79424e-06, gnorm=3.862, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31905
2022-05-09 05:40:55 - progress_bar.py[line:272] - INFO: epoch 001:  15385 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=379.6, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.376, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.8, ups=0.56, wpb=379.6, bsz=32, num_updates=15360, lr=8.79304e-06, gnorm=3.154, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31923
2022-05-09 05:41:12 - progress_bar.py[line:272] - INFO: epoch 001:  15395 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.45, expert1_balance_bottom=19.674, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.1, ups=0.56, wpb=381.1, bsz=32, num_updates=15370, lr=8.79184e-06, gnorm=3.101, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31940
2022-05-09 05:41:30 - progress_bar.py[line:272] - INFO: epoch 001:  15405 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=376, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=33.388, expert1_balance_bottom=19.551, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.5, ups=0.56, wpb=376, bsz=32, num_updates=15380, lr=8.79063e-06, gnorm=3.291, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31958
2022-05-09 05:41:48 - progress_bar.py[line:272] - INFO: epoch 001:  15415 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=388.1, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.755, expert1_balance_bottom=19.128, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221, ups=0.57, wpb=388.1, bsz=32, num_updates=15390, lr=8.78943e-06, gnorm=3.275, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31976
2022-05-09 05:42:05 - progress_bar.py[line:272] - INFO: epoch 001:  15425 / 17711 loss=3.104, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=381.6, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.104, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.584, expert1_balance_bottom=19.157, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.2, ups=0.56, wpb=381.6, bsz=32, num_updates=15400, lr=8.78823e-06, gnorm=3.435, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=31993
2022-05-09 05:42:23 - progress_bar.py[line:272] - INFO: epoch 001:  15435 / 17711 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=392.1, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883517, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.139, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.541, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=219.4, ups=0.56, wpb=392.1, bsz=32, num_updates=15410, lr=8.78703e-06, gnorm=3.691, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32011
2022-05-09 05:42:41 - progress_bar.py[line:272] - INFO: epoch 001:  15445 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=386.5, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.156, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.8, ups=0.56, wpb=386.5, bsz=32, num_updates=15420, lr=8.78583e-06, gnorm=3.035, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32029
2022-05-09 05:42:59 - progress_bar.py[line:272] - INFO: epoch 001:  15455 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.552, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210.1, ups=0.55, wpb=379.7, bsz=32, num_updates=15430, lr=8.78463e-06, gnorm=3.376, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32047
2022-05-09 05:43:17 - progress_bar.py[line:272] - INFO: epoch 001:  15465 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88782, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.147, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=212, ups=0.56, wpb=381.7, bsz=32, num_updates=15440, lr=8.78343e-06, gnorm=3.63, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32065
2022-05-09 05:43:36 - progress_bar.py[line:272] - INFO: epoch 001:  15475 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=374.2, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885015, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.546, expert1_balance_bottom=19.027, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=205.7, ups=0.55, wpb=374.2, bsz=32, num_updates=15450, lr=8.78223e-06, gnorm=3.137, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32084
2022-05-09 05:43:54 - progress_bar.py[line:272] - INFO: epoch 001:  15485 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=379.7, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.706, expert1_balance_bottom=19.539, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=207.3, ups=0.55, wpb=379.7, bsz=32, num_updates=15460, lr=8.78102e-06, gnorm=3.611, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32102
2022-05-09 05:44:12 - progress_bar.py[line:272] - INFO: epoch 001:  15495 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=385.8, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.395, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212, ups=0.55, wpb=385.8, bsz=32, num_updates=15470, lr=8.77982e-06, gnorm=3.364, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32120
2022-05-09 05:44:30 - progress_bar.py[line:272] - INFO: epoch 001:  15505 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=386.6, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.82, expert1_balance_bottom=19.377, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.8, ups=0.56, wpb=386.6, bsz=32, num_updates=15480, lr=8.77862e-06, gnorm=3.308, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32138
2022-05-09 05:44:48 - progress_bar.py[line:272] - INFO: epoch 001:  15515 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=387.3, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.777, expert1_balance_bottom=18.901, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.1, ups=0.56, wpb=387.3, bsz=32, num_updates=15490, lr=8.77742e-06, gnorm=3.929, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32156
2022-05-09 05:45:06 - progress_bar.py[line:272] - INFO: epoch 001:  15525 / 17711 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=388.5, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.147, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.682, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=217.7, ups=0.56, wpb=388.5, bsz=32, num_updates=15500, lr=8.77622e-06, gnorm=3.906, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32174
2022-05-09 05:45:24 - progress_bar.py[line:272] - INFO: epoch 001:  15535 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.139, expert1_balance_bottom=19.086, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=212.2, ups=0.56, wpb=379.2, bsz=32, num_updates=15510, lr=8.77502e-06, gnorm=3.44, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32192
2022-05-09 05:45:42 - progress_bar.py[line:272] - INFO: epoch 001:  15545 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=388, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870249, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.951, expert1_balance_bottom=19.02, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217, ups=0.56, wpb=388, bsz=32, num_updates=15520, lr=8.77382e-06, gnorm=3.182, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32210
2022-05-09 05:45:59 - progress_bar.py[line:272] - INFO: epoch 001:  15555 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=386.5, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.381, expert1_balance_bottom=19.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=217.4, ups=0.56, wpb=386.5, bsz=32, num_updates=15530, lr=8.77261e-06, gnorm=3.187, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32227
2022-05-09 05:46:17 - progress_bar.py[line:272] - INFO: epoch 001:  15565 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.282, expert1_balance_bottom=19.047, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216.3, ups=0.57, wpb=382.5, bsz=32, num_updates=15540, lr=8.77141e-06, gnorm=3.021, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32245
2022-05-09 05:46:35 - progress_bar.py[line:272] - INFO: epoch 001:  15575 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890689, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=33.206, expert1_balance_bottom=19.649, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.4, ups=0.56, wpb=379.7, bsz=32, num_updates=15550, lr=8.77021e-06, gnorm=3.865, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32263
2022-05-09 05:46:53 - progress_bar.py[line:272] - INFO: epoch 001:  15585 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=387.7, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.386, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.5, ups=0.56, wpb=387.7, bsz=32, num_updates=15560, lr=8.76901e-06, gnorm=3.512, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32281
2022-05-09 05:47:11 - progress_bar.py[line:272] - INFO: epoch 001:  15595 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=33.47, expert1_balance_bottom=19.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.2, ups=0.55, wpb=381, bsz=32, num_updates=15570, lr=8.76781e-06, gnorm=3.381, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32299
2022-05-09 05:47:29 - progress_bar.py[line:272] - INFO: epoch 001:  15605 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=386, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=33.041, expert1_balance_bottom=19.464, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.4, ups=0.55, wpb=386, bsz=32, num_updates=15580, lr=8.76661e-06, gnorm=3.558, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32317
2022-05-09 05:47:47 - progress_bar.py[line:272] - INFO: epoch 001:  15615 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888565, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=34.04, expert1_balance_bottom=19.3, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.3, ups=0.55, wpb=380.5, bsz=32, num_updates=15590, lr=8.76541e-06, gnorm=3.2, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32335
2022-05-09 05:48:05 - progress_bar.py[line:272] - INFO: epoch 001:  15625 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=388.7, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876685, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.477, expert1_balance_bottom=19.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216.7, ups=0.56, wpb=388.7, bsz=32, num_updates=15600, lr=8.76421e-06, gnorm=3.618, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32353
2022-05-09 05:48:23 - progress_bar.py[line:272] - INFO: epoch 001:  15635 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=386.5, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.28, expert1_balance_bottom=19.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=218, ups=0.56, wpb=386.5, bsz=32, num_updates=15610, lr=8.763e-06, gnorm=3.353, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32371
2022-05-09 05:48:41 - progress_bar.py[line:272] - INFO: epoch 001:  15645 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885028, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.912, expert1_balance_bottom=19.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.5, ups=0.56, wpb=378.2, bsz=32, num_updates=15620, lr=8.7618e-06, gnorm=3.154, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32389
2022-05-09 05:48:58 - progress_bar.py[line:272] - INFO: epoch 001:  15655 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=33.615, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.4, ups=0.56, wpb=380.1, bsz=32, num_updates=15630, lr=8.7606e-06, gnorm=3.078, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32406
2022-05-09 05:49:16 - progress_bar.py[line:272] - INFO: epoch 001:  15665 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=381.6, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88906, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=33.873, expert1_balance_bottom=19.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.6, ups=0.56, wpb=381.6, bsz=32, num_updates=15640, lr=8.7594e-06, gnorm=3.164, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32424
2022-05-09 05:49:34 - progress_bar.py[line:272] - INFO: epoch 001:  15675 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885791, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.373, expert1_balance_bottom=19.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.4, ups=0.55, wpb=383.2, bsz=32, num_updates=15650, lr=8.7582e-06, gnorm=3.768, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32442
2022-05-09 05:49:52 - progress_bar.py[line:272] - INFO: epoch 001:  15685 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=389.5, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880449, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.266, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=222.2, ups=0.57, wpb=389.5, bsz=32, num_updates=15660, lr=8.757e-06, gnorm=3.507, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32460
2022-05-09 05:50:10 - progress_bar.py[line:272] - INFO: epoch 001:  15695 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.105, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215, ups=0.56, wpb=385.5, bsz=32, num_updates=15670, lr=8.7558e-06, gnorm=3.466, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32478
2022-05-09 05:50:28 - progress_bar.py[line:272] - INFO: epoch 001:  15705 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.675, expert1_balance_bottom=19.584, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.9, ups=0.56, wpb=384.3, bsz=32, num_updates=15680, lr=8.7546e-06, gnorm=2.903, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32496
2022-05-09 05:50:46 - progress_bar.py[line:272] - INFO: epoch 001:  15715 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882397, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.083, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=207.5, ups=0.55, wpb=375.5, bsz=32, num_updates=15690, lr=8.75339e-06, gnorm=3.133, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32514
2022-05-09 05:51:04 - progress_bar.py[line:272] - INFO: epoch 001:  15725 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.812, expert1_balance_bottom=19.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.6, ups=0.56, wpb=381.3, bsz=32, num_updates=15700, lr=8.75219e-06, gnorm=3.128, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32532
2022-05-09 05:51:22 - progress_bar.py[line:272] - INFO: epoch 001:  15735 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882408, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.546, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.7, ups=0.56, wpb=382.1, bsz=32, num_updates=15710, lr=8.75099e-06, gnorm=3.446, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32550
2022-05-09 05:51:40 - progress_bar.py[line:272] - INFO: epoch 001:  15745 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=387, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870141, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=35.178, expert1_balance_bottom=19.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.3, ups=0.55, wpb=387, bsz=32, num_updates=15720, lr=8.74979e-06, gnorm=3.302, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32568
2022-05-09 05:51:58 - progress_bar.py[line:272] - INFO: epoch 001:  15755 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=382.7, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.3, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.8, ups=0.55, wpb=382.7, bsz=32, num_updates=15730, lr=8.74859e-06, gnorm=3.336, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32586
2022-05-09 05:52:16 - progress_bar.py[line:272] - INFO: epoch 001:  15765 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876637, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.813, expert1_balance_bottom=19.155, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=207.9, ups=0.55, wpb=377.9, bsz=32, num_updates=15740, lr=8.74739e-06, gnorm=3.343, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32604
2022-05-09 05:52:34 - progress_bar.py[line:272] - INFO: epoch 001:  15775 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=386, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882245, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.198, expert1_balance_bottom=19.404, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.1, ups=0.57, wpb=386, bsz=32, num_updates=15750, lr=8.74619e-06, gnorm=3.194, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32622
2022-05-09 05:52:51 - progress_bar.py[line:272] - INFO: epoch 001:  15785 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=385.6, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=34.311, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.1, ups=0.56, wpb=385.6, bsz=32, num_updates=15760, lr=8.74498e-06, gnorm=3.571, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32639
2022-05-09 05:53:09 - progress_bar.py[line:272] - INFO: epoch 001:  15795 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=379.1, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887012, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.08, expert1_balance_bottom=19.438, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.1, ups=0.56, wpb=379.1, bsz=32, num_updates=15770, lr=8.74378e-06, gnorm=2.919, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32657
2022-05-09 05:53:27 - progress_bar.py[line:272] - INFO: epoch 001:  15805 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=386.9, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882127, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.53, expert1_balance_bottom=19.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.6, ups=0.57, wpb=386.9, bsz=32, num_updates=15780, lr=8.74258e-06, gnorm=3.224, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32675
2022-05-09 05:53:44 - progress_bar.py[line:272] - INFO: epoch 001:  15815 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=374.6, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.899, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.1, ups=0.57, wpb=374.6, bsz=32, num_updates=15790, lr=8.74138e-06, gnorm=3.352, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32692
2022-05-09 05:54:02 - progress_bar.py[line:272] - INFO: epoch 001:  15825 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.838, expert1_balance_bottom=19.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.3, ups=0.57, wpb=383.1, bsz=32, num_updates=15800, lr=8.74018e-06, gnorm=3.099, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32710
2022-05-09 05:54:20 - progress_bar.py[line:272] - INFO: epoch 001:  15835 / 17711 loss=3.14, loss_v1=0, loss_v2=0, nll_loss=0.941, ntokens=385.6, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87693, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.14, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.652, expert1_balance_bottom=19.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=215.7, ups=0.56, wpb=385.6, bsz=32, num_updates=15810, lr=8.73898e-06, gnorm=4.751, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32728
2022-05-09 05:54:38 - progress_bar.py[line:272] - INFO: epoch 001:  15845 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=384, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887095, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=34.211, expert1_balance_bottom=19.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.4, ups=0.56, wpb=384, bsz=32, num_updates=15820, lr=8.73778e-06, gnorm=5.271, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32746
2022-05-09 05:54:56 - progress_bar.py[line:272] - INFO: epoch 001:  15855 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=391.4, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.647, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=213.9, ups=0.55, wpb=391.4, bsz=32, num_updates=15830, lr=8.73658e-06, gnorm=3.709, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32764
2022-05-09 05:55:14 - progress_bar.py[line:272] - INFO: epoch 001:  15865 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=378.8, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.206, expert1_balance_bottom=19.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.4, ups=0.55, wpb=378.8, bsz=32, num_updates=15840, lr=8.73537e-06, gnorm=3.094, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32782
2022-05-09 05:55:32 - progress_bar.py[line:272] - INFO: epoch 001:  15875 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=386.5, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.235, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.8, ups=0.57, wpb=386.5, bsz=32, num_updates=15850, lr=8.73417e-06, gnorm=3.545, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32800
2022-05-09 05:55:50 - progress_bar.py[line:272] - INFO: epoch 001:  15885 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892594, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.495, expert1_balance_bottom=19.632, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=212.9, ups=0.56, wpb=383.2, bsz=32, num_updates=15860, lr=8.73297e-06, gnorm=3.445, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32818
2022-05-09 05:56:08 - progress_bar.py[line:272] - INFO: epoch 001:  15895 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893171, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.411, expert1_balance_bottom=19.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=214.6, ups=0.56, wpb=386.2, bsz=32, num_updates=15870, lr=8.73177e-06, gnorm=3.137, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32836
2022-05-09 05:56:25 - progress_bar.py[line:272] - INFO: epoch 001:  15905 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890797, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.174, expert1_balance_bottom=19.5, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=215.3, ups=0.56, wpb=384.1, bsz=32, num_updates=15880, lr=8.73057e-06, gnorm=4.379, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32853
2022-05-09 05:56:43 - progress_bar.py[line:272] - INFO: epoch 001:  15915 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=379, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882134, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.278, expert1_balance_bottom=19.26, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.8, ups=0.56, wpb=379, bsz=32, num_updates=15890, lr=8.72937e-06, gnorm=3.296, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32871
2022-05-09 05:57:01 - progress_bar.py[line:272] - INFO: epoch 001:  15925 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=386.6, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=35.023, expert1_balance_bottom=18.92, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.4, ups=0.56, wpb=386.6, bsz=32, num_updates=15900, lr=8.72817e-06, gnorm=3.774, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32889
2022-05-09 05:57:19 - progress_bar.py[line:272] - INFO: epoch 001:  15935 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895311, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=33.808, expert1_balance_bottom=19.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.5, ups=0.55, wpb=380.9, bsz=32, num_updates=15910, lr=8.72696e-06, gnorm=3.316, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32907
2022-05-09 05:57:37 - progress_bar.py[line:272] - INFO: epoch 001:  15945 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=373, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892059, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=33.595, expert1_balance_bottom=19.474, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.3, ups=0.56, wpb=373, bsz=32, num_updates=15920, lr=8.72576e-06, gnorm=3.25, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32925
2022-05-09 05:57:55 - progress_bar.py[line:272] - INFO: epoch 001:  15955 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=378.4, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.301, expert1_balance_bottom=19.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210, ups=0.55, wpb=378.4, bsz=32, num_updates=15930, lr=8.72456e-06, gnorm=3.089, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32943
2022-05-09 05:58:13 - progress_bar.py[line:272] - INFO: epoch 001:  15965 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879576, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.018, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.5, ups=0.56, wpb=384.8, bsz=32, num_updates=15940, lr=8.72336e-06, gnorm=2.981, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32961
2022-05-09 05:58:31 - progress_bar.py[line:272] - INFO: epoch 001:  15975 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=378.5, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.276, expert1_balance_bottom=19.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.8, ups=0.56, wpb=378.5, bsz=32, num_updates=15950, lr=8.72216e-06, gnorm=3.346, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32979
2022-05-09 05:58:48 - progress_bar.py[line:272] - INFO: epoch 001:  15985 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=386, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.071, expert1_balance_bottom=19.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218, ups=0.56, wpb=386, bsz=32, num_updates=15960, lr=8.72096e-06, gnorm=3.824, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=32996
2022-05-09 05:59:06 - progress_bar.py[line:272] - INFO: epoch 001:  15995 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=389.8, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876177, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.6, expert1_balance_bottom=19.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.8, ups=0.55, wpb=389.8, bsz=32, num_updates=15970, lr=8.71976e-06, gnorm=3.776, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33014
2022-05-09 05:59:24 - progress_bar.py[line:272] - INFO: epoch 001:  16005 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882452, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.971, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=211.4, ups=0.55, wpb=381.1, bsz=32, num_updates=15980, lr=8.71856e-06, gnorm=3.759, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33032
2022-05-09 05:59:42 - progress_bar.py[line:272] - INFO: epoch 001:  16015 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=382, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.291, expert1_balance_bottom=19.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.4, ups=0.56, wpb=382, bsz=32, num_updates=15990, lr=8.71735e-06, gnorm=3.257, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33050
2022-05-09 06:00:00 - progress_bar.py[line:272] - INFO: epoch 001:  16025 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=384.3, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887807, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.129, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.6, ups=0.56, wpb=384.3, bsz=32, num_updates=16000, lr=8.71615e-06, gnorm=3.129, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33068
2022-05-09 06:00:00 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 06:00:00 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 06:00:00 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 06:07:20 - train.py[line:517] - INFO: valid_step finished
2022-05-09 06:07:20 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.942 | loss_v1 0 | loss_v2 0 | nll_loss 8.268 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.977919 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.942 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.209 | expert1_balance_top 36.808 | expert1_balance_bottom 15.079 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 308.29 | cider 1.18 | wps 686 | wpb 481.7 | bsz 8 | num_updates 16000 | best_cider 1.198
2022-05-09 06:07:38 - progress_bar.py[line:272] - INFO: epoch 001:  16035 / 17711 loss=3.126, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=387.1, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.126, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.383, expert1_balance_bottom=19.492, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=8.5, ups=0.02, wpb=387.1, bsz=32, num_updates=16010, lr=8.71495e-06, gnorm=3.502, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33526
2022-05-09 06:07:56 - progress_bar.py[line:272] - INFO: epoch 001:  16045 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=374, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889236, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=34.189, expert1_balance_bottom=19.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=208.2, ups=0.56, wpb=374, bsz=32, num_updates=16020, lr=8.71375e-06, gnorm=3.464, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33544
2022-05-09 06:08:14 - progress_bar.py[line:272] - INFO: epoch 001:  16055 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=389.3, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.188, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.2, ups=0.56, wpb=389.3, bsz=32, num_updates=16030, lr=8.71255e-06, gnorm=3.486, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33562
2022-05-09 06:08:31 - progress_bar.py[line:272] - INFO: epoch 001:  16065 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89748, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=33.212, expert1_balance_bottom=19.622, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.6, ups=0.56, wpb=383.7, bsz=32, num_updates=16040, lr=8.71135e-06, gnorm=3.083, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33579
2022-05-09 06:08:49 - progress_bar.py[line:272] - INFO: epoch 001:  16075 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=398.6, nsentences=32, sample_size=317.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.237, expert1_balance_bottom=19.302, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=220.9, ups=0.55, wpb=398.6, bsz=32, num_updates=16050, lr=8.71015e-06, gnorm=3.404, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33597
2022-05-09 06:09:07 - progress_bar.py[line:272] - INFO: epoch 001:  16085 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=373.1, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.978, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=207.1, ups=0.56, wpb=373.1, bsz=32, num_updates=16060, lr=8.70895e-06, gnorm=3.302, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33615
2022-05-09 06:09:25 - progress_bar.py[line:272] - INFO: epoch 001:  16095 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.499, expert1_balance_bottom=19.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=216.8, ups=0.56, wpb=385.5, bsz=32, num_updates=16070, lr=8.70774e-06, gnorm=3.315, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33633
2022-05-09 06:09:43 - progress_bar.py[line:272] - INFO: epoch 001:  16105 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=370.8, nsentences=32, sample_size=295.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881179, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.511, expert1_balance_bottom=19.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=205.8, ups=0.56, wpb=370.8, bsz=32, num_updates=16080, lr=8.70654e-06, gnorm=3.886, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33651
2022-05-09 06:10:01 - progress_bar.py[line:272] - INFO: epoch 001:  16115 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=378.3, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898644, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=33.583, expert1_balance_bottom=19.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.2, ups=0.56, wpb=378.3, bsz=32, num_updates=16090, lr=8.70534e-06, gnorm=3.302, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33669
2022-05-09 06:10:19 - progress_bar.py[line:272] - INFO: epoch 001:  16125 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=383.5, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887499, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=34.182, expert1_balance_bottom=19.189, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=210.7, ups=0.55, wpb=383.5, bsz=32, num_updates=16100, lr=8.70414e-06, gnorm=3.608, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33687
2022-05-09 06:10:37 - progress_bar.py[line:272] - INFO: epoch 001:  16135 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=373.5, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904211, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.154, expert1_balance_top=32.77, expert1_balance_bottom=19.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.7, ups=0.57, wpb=373.5, bsz=32, num_updates=16110, lr=8.70294e-06, gnorm=3.485, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33705
2022-05-09 06:10:54 - progress_bar.py[line:272] - INFO: epoch 001:  16145 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882877, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.526, expert1_balance_bottom=19.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.4, ups=0.57, wpb=383.8, bsz=32, num_updates=16120, lr=8.70174e-06, gnorm=3.467, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33722
2022-05-09 06:11:12 - progress_bar.py[line:272] - INFO: epoch 001:  16155 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=380.1, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.647, expert1_balance_bottom=19.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=218, ups=0.57, wpb=380.1, bsz=32, num_updates=16130, lr=8.70054e-06, gnorm=3.463, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33740
2022-05-09 06:11:29 - progress_bar.py[line:272] - INFO: epoch 001:  16165 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=382.6, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897637, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.698, expert1_balance_bottom=19.459, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.2, ups=0.57, wpb=382.6, bsz=32, num_updates=16140, lr=8.69933e-06, gnorm=3.114, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33757
2022-05-09 06:11:47 - progress_bar.py[line:272] - INFO: epoch 001:  16175 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=390.9, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867749, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=35.219, expert1_balance_bottom=18.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.1, ups=0.57, wpb=390.9, bsz=32, num_updates=16150, lr=8.69813e-06, gnorm=3.875, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33775
2022-05-09 06:12:04 - progress_bar.py[line:272] - INFO: epoch 001:  16185 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=388, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.947, expert1_balance_bottom=19.357, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222, ups=0.57, wpb=388, bsz=32, num_updates=16160, lr=8.69693e-06, gnorm=3.67, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33792
2022-05-09 06:12:22 - progress_bar.py[line:272] - INFO: epoch 001:  16195 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=375.3, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895459, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=33.776, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.1, ups=0.57, wpb=375.3, bsz=32, num_updates=16170, lr=8.69573e-06, gnorm=2.998, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33810
2022-05-09 06:12:39 - progress_bar.py[line:272] - INFO: epoch 001:  16205 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.762, expert1_balance_bottom=19.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=218.9, ups=0.58, wpb=379.6, bsz=32, num_updates=16180, lr=8.69453e-06, gnorm=3.197, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33827
2022-05-09 06:12:57 - progress_bar.py[line:272] - INFO: epoch 001:  16215 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=382.7, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.17, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=219.4, ups=0.57, wpb=382.7, bsz=32, num_updates=16190, lr=8.69333e-06, gnorm=3.658, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33845
2022-05-09 06:13:14 - progress_bar.py[line:272] - INFO: epoch 001:  16225 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=377, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895608, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.233, expert1_balance_bottom=19.549, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.2, ups=0.57, wpb=377, bsz=32, num_updates=16200, lr=8.69213e-06, gnorm=3.665, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33862
2022-05-09 06:13:32 - progress_bar.py[line:272] - INFO: epoch 001:  16235 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=389.6, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.874, expert1_balance_bottom=19.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=222.7, ups=0.57, wpb=389.6, bsz=32, num_updates=16210, lr=8.69093e-06, gnorm=2.914, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33880
2022-05-09 06:13:49 - progress_bar.py[line:272] - INFO: epoch 001:  16245 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.097, expert1_balance_bottom=19.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.6, ups=0.57, wpb=381.6, bsz=32, num_updates=16220, lr=8.68972e-06, gnorm=3.275, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33897
2022-05-09 06:14:07 - progress_bar.py[line:272] - INFO: epoch 001:  16255 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=388.5, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885589, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.824, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.3, ups=0.57, wpb=388.5, bsz=32, num_updates=16230, lr=8.68852e-06, gnorm=3.014, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33915
2022-05-09 06:14:24 - progress_bar.py[line:272] - INFO: epoch 001:  16265 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=395.3, nsentences=32, sample_size=314.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.529, expert1_balance_bottom=19.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227.5, ups=0.58, wpb=395.3, bsz=32, num_updates=16240, lr=8.68732e-06, gnorm=3.756, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33932
2022-05-09 06:14:42 - progress_bar.py[line:272] - INFO: epoch 001:  16275 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=379.4, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885821, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.962, expert1_balance_bottom=19.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216.4, ups=0.57, wpb=379.4, bsz=32, num_updates=16250, lr=8.68612e-06, gnorm=4.239, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33950
2022-05-09 06:14:59 - progress_bar.py[line:272] - INFO: epoch 001:  16285 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=383.1, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877051, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.555, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.7, ups=0.57, wpb=383.1, bsz=32, num_updates=16260, lr=8.68492e-06, gnorm=3.431, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33967
2022-05-09 06:15:17 - progress_bar.py[line:272] - INFO: epoch 001:  16295 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=381.6, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900143, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.517, expert1_balance_bottom=19.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.7, ups=0.57, wpb=381.6, bsz=32, num_updates=16270, lr=8.68372e-06, gnorm=3.894, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=33985
2022-05-09 06:15:34 - progress_bar.py[line:272] - INFO: epoch 001:  16305 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=391, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.11, expert1_balance_bottom=19.398, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=222.3, ups=0.57, wpb=391, bsz=32, num_updates=16280, lr=8.68252e-06, gnorm=3.352, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34002
2022-05-09 06:15:52 - progress_bar.py[line:272] - INFO: epoch 001:  16315 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=376.9, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882978, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.317, expert1_balance_bottom=19.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.2, ups=0.57, wpb=376.9, bsz=32, num_updates=16290, lr=8.68131e-06, gnorm=3.683, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34020
2022-05-09 06:16:10 - progress_bar.py[line:272] - INFO: epoch 001:  16325 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=379.1, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.019, expert1_balance_bottom=19.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=214.4, ups=0.57, wpb=379.1, bsz=32, num_updates=16300, lr=8.68011e-06, gnorm=3.389, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34038
2022-05-09 06:16:27 - progress_bar.py[line:272] - INFO: epoch 001:  16335 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=380.2, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.318, expert1_balance_bottom=19.561, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.5, ups=0.57, wpb=380.2, bsz=32, num_updates=16310, lr=8.67891e-06, gnorm=3.781, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34055
2022-05-09 06:16:45 - progress_bar.py[line:272] - INFO: epoch 001:  16345 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=382, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888508, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.86, expert1_balance_bottom=19.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216, ups=0.57, wpb=382, bsz=32, num_updates=16320, lr=8.67771e-06, gnorm=3.135, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34073
2022-05-09 06:17:02 - progress_bar.py[line:272] - INFO: epoch 001:  16355 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.403, expert1_balance_bottom=19.479, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=220.7, ups=0.57, wpb=383.8, bsz=32, num_updates=16330, lr=8.67651e-06, gnorm=2.658, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34090
2022-05-09 06:17:20 - progress_bar.py[line:272] - INFO: epoch 001:  16365 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890582, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.32, expert1_balance_bottom=19.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.7, ups=0.57, wpb=380.8, bsz=32, num_updates=16340, lr=8.67531e-06, gnorm=3.511, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34108
2022-05-09 06:17:37 - progress_bar.py[line:272] - INFO: epoch 001:  16375 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=383.2, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.475, expert1_balance_bottom=19.415, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=221.3, ups=0.58, wpb=383.2, bsz=32, num_updates=16350, lr=8.67411e-06, gnorm=3.849, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34125
2022-05-09 06:17:54 - progress_bar.py[line:272] - INFO: epoch 001:  16385 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902526, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.156, expert1_balance_top=32.802, expert1_balance_bottom=19.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.6, ups=0.58, wpb=381.6, bsz=32, num_updates=16360, lr=8.67291e-06, gnorm=3.541, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34142
2022-05-09 06:18:11 - progress_bar.py[line:272] - INFO: epoch 001:  16395 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=388.1, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87681, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.266, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.5, ups=0.58, wpb=388.1, bsz=32, num_updates=16370, lr=8.6717e-06, gnorm=3.234, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34160
2022-05-09 06:18:29 - progress_bar.py[line:272] - INFO: epoch 001:  16405 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.337, expert1_balance_bottom=19.645, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=226.3, ups=0.59, wpb=385.7, bsz=32, num_updates=16380, lr=8.6705e-06, gnorm=3.1, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34177
2022-05-09 06:18:46 - progress_bar.py[line:272] - INFO: epoch 001:  16415 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=378.4, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872162, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.548, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.4, ups=0.58, wpb=378.4, bsz=32, num_updates=16390, lr=8.6693e-06, gnorm=3.957, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34194
2022-05-09 06:19:03 - progress_bar.py[line:272] - INFO: epoch 001:  16425 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=387.6, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=33.552, expert1_balance_bottom=19.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224, ups=0.58, wpb=387.6, bsz=32, num_updates=16400, lr=8.6681e-06, gnorm=3.501, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34211
2022-05-09 06:19:21 - progress_bar.py[line:272] - INFO: epoch 001:  16435 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.281, expert1_balance_bottom=18.973, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=211.4, ups=0.56, wpb=379.2, bsz=32, num_updates=16410, lr=8.6669e-06, gnorm=3.199, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34229
2022-05-09 06:19:39 - progress_bar.py[line:272] - INFO: epoch 001:  16445 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.302, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.9, ups=0.56, wpb=381.2, bsz=32, num_updates=16420, lr=8.6657e-06, gnorm=3.966, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34247
2022-05-09 06:19:57 - progress_bar.py[line:272] - INFO: epoch 001:  16455 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882433, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.943, expert1_balance_bottom=19.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.1, ups=0.56, wpb=382, bsz=32, num_updates=16430, lr=8.6645e-06, gnorm=3.296, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34265
2022-05-09 06:20:15 - progress_bar.py[line:272] - INFO: epoch 001:  16465 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.316, expert1_balance_bottom=19.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.3, ups=0.56, wpb=383.2, bsz=32, num_updates=16440, lr=8.66329e-06, gnorm=3.265, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34283
2022-05-09 06:20:32 - progress_bar.py[line:272] - INFO: epoch 001:  16475 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=379.4, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888235, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.872, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.2, ups=0.56, wpb=379.4, bsz=32, num_updates=16450, lr=8.66209e-06, gnorm=3.281, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34301
2022-05-09 06:20:50 - progress_bar.py[line:272] - INFO: epoch 001:  16485 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=391.8, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878709, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.172, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219.5, ups=0.56, wpb=391.8, bsz=32, num_updates=16460, lr=8.66089e-06, gnorm=3.46, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34318
2022-05-09 06:21:08 - progress_bar.py[line:272] - INFO: epoch 001:  16495 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=388.5, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871597, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=34.376, expert1_balance_bottom=19.377, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=222.9, ups=0.57, wpb=388.5, bsz=32, num_updates=16470, lr=8.65969e-06, gnorm=3.093, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34336
2022-05-09 06:21:26 - progress_bar.py[line:272] - INFO: epoch 001:  16505 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=32.973, expert1_balance_bottom=19.724, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=210.6, ups=0.56, wpb=377.1, bsz=32, num_updates=16480, lr=8.65849e-06, gnorm=3.336, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34354
2022-05-09 06:21:44 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 06:21:45 - progress_bar.py[line:272] - INFO: epoch 001:  16516 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=389, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.088, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=196.9, ups=0.51, wpb=389, bsz=32, num_updates=16490, lr=8.65729e-06, gnorm=3.369, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34373
2022-05-09 06:22:03 - progress_bar.py[line:272] - INFO: epoch 001:  16526 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=392.3, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864991, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=35.025, expert1_balance_bottom=18.993, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220.4, ups=0.56, wpb=392.3, bsz=32, num_updates=16500, lr=8.65609e-06, gnorm=3.952, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34391
2022-05-09 06:22:21 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 06:22:23 - progress_bar.py[line:272] - INFO: epoch 001:  16537 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=377.8, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889686, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.984, expert1_balance_bottom=19.228, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=193, ups=0.51, wpb=377.8, bsz=32, num_updates=16510, lr=8.65489e-06, gnorm=3.966, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34411
2022-05-09 06:22:40 - progress_bar.py[line:272] - INFO: epoch 001:  16547 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.382, expert1_balance_bottom=19.365, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.8, ups=0.57, wpb=380.5, bsz=32, num_updates=16520, lr=8.65368e-06, gnorm=3.145, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34428
2022-05-09 06:22:58 - progress_bar.py[line:272] - INFO: epoch 001:  16557 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=390.3, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.743, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220, ups=0.56, wpb=390.3, bsz=32, num_updates=16530, lr=8.65248e-06, gnorm=3.4, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34446
2022-05-09 06:23:16 - progress_bar.py[line:272] - INFO: epoch 001:  16567 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878579, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=35.044, expert1_balance_bottom=19.071, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.5, ups=0.56, wpb=383.8, bsz=32, num_updates=16540, lr=8.65128e-06, gnorm=3.322, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34464
2022-05-09 06:23:34 - progress_bar.py[line:272] - INFO: epoch 001:  16577 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=384.6, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893461, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.84, expert1_balance_bottom=19.474, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.7, ups=0.56, wpb=384.6, bsz=32, num_updates=16550, lr=8.65008e-06, gnorm=4.443, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34482
2022-05-09 06:23:52 - progress_bar.py[line:272] - INFO: epoch 001:  16587 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891525, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.698, expert1_balance_bottom=19.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.5, ups=0.56, wpb=379.1, bsz=32, num_updates=16560, lr=8.64888e-06, gnorm=3.602, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34500
2022-05-09 06:24:09 - progress_bar.py[line:272] - INFO: epoch 001:  16597 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=375.8, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898761, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.53, expert1_balance_bottom=19.593, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.6, ups=0.56, wpb=375.8, bsz=32, num_updates=16570, lr=8.64768e-06, gnorm=3.31, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34517
2022-05-09 06:24:27 - progress_bar.py[line:272] - INFO: epoch 001:  16607 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=379, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898828, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=33.438, expert1_balance_bottom=19.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.5, ups=0.56, wpb=379, bsz=32, num_updates=16580, lr=8.64648e-06, gnorm=3.132, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34535
2022-05-09 06:24:45 - progress_bar.py[line:272] - INFO: epoch 001:  16617 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=389.8, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88251, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.209, expert1_balance_bottom=19.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.9, ups=0.56, wpb=389.8, bsz=32, num_updates=16590, lr=8.64528e-06, gnorm=3.245, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34553
2022-05-09 06:25:03 - progress_bar.py[line:272] - INFO: epoch 001:  16627 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=384.6, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88617, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.752, expert1_balance_bottom=19.567, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.4, ups=0.56, wpb=384.6, bsz=32, num_updates=16600, lr=8.64407e-06, gnorm=3.311, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34571
2022-05-09 06:25:21 - progress_bar.py[line:272] - INFO: epoch 001:  16637 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.639, expert1_balance_bottom=19.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.6, ups=0.56, wpb=381.6, bsz=32, num_updates=16610, lr=8.64287e-06, gnorm=3.549, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34589
2022-05-09 06:25:39 - progress_bar.py[line:272] - INFO: epoch 001:  16647 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=385.5, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.071, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.5, ups=0.57, wpb=385.5, bsz=32, num_updates=16620, lr=8.64167e-06, gnorm=3.624, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34607
2022-05-09 06:25:57 - progress_bar.py[line:272] - INFO: epoch 001:  16657 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.026, expert1_balance_bottom=19.455, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.7, ups=0.55, wpb=383.2, bsz=32, num_updates=16630, lr=8.64047e-06, gnorm=3.244, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34625
2022-05-09 06:26:14 - progress_bar.py[line:272] - INFO: epoch 001:  16667 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=378.5, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887476, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=34.199, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.9, ups=0.56, wpb=378.5, bsz=32, num_updates=16640, lr=8.63927e-06, gnorm=3.731, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34643
2022-05-09 06:26:33 - progress_bar.py[line:272] - INFO: epoch 001:  16677 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=381.4, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879622, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.54, expert1_balance_bottom=18.972, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.1, ups=0.55, wpb=381.4, bsz=32, num_updates=16650, lr=8.63807e-06, gnorm=3.864, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34661
2022-05-09 06:26:50 - progress_bar.py[line:272] - INFO: epoch 001:  16687 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=375.7, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.797, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=209.8, ups=0.56, wpb=375.7, bsz=32, num_updates=16660, lr=8.63687e-06, gnorm=3.828, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34679
2022-05-09 06:27:08 - progress_bar.py[line:272] - INFO: epoch 001:  16697 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=387.5, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884855, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=34.028, expert1_balance_bottom=19.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.5, ups=0.57, wpb=387.5, bsz=32, num_updates=16670, lr=8.63566e-06, gnorm=3.662, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34696
2022-05-09 06:27:26 - progress_bar.py[line:272] - INFO: epoch 001:  16707 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=381.3, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.425, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.6, ups=0.56, wpb=381.3, bsz=32, num_updates=16680, lr=8.63446e-06, gnorm=4.086, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34714
2022-05-09 06:27:44 - progress_bar.py[line:272] - INFO: epoch 001:  16717 / 17711 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.939, ntokens=386, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.149, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.828, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=216.2, ups=0.56, wpb=386, bsz=32, num_updates=16690, lr=8.63326e-06, gnorm=3.724, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34732
2022-05-09 06:28:02 - progress_bar.py[line:272] - INFO: epoch 001:  16727 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=378.3, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890929, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=34.165, expert1_balance_bottom=19.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=211.1, ups=0.56, wpb=378.3, bsz=32, num_updates=16700, lr=8.63206e-06, gnorm=3.437, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34750
2022-05-09 06:28:19 - progress_bar.py[line:272] - INFO: epoch 001:  16737 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877715, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.931, expert1_balance_bottom=19.003, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.6, ups=0.57, wpb=376.7, bsz=32, num_updates=16710, lr=8.63086e-06, gnorm=2.983, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34767
2022-05-09 06:28:37 - progress_bar.py[line:272] - INFO: epoch 001:  16747 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=381.3, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884587, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.879, expert1_balance_bottom=19.459, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.5, ups=0.56, wpb=381.3, bsz=32, num_updates=16720, lr=8.62966e-06, gnorm=4.919, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34785
2022-05-09 06:28:55 - progress_bar.py[line:272] - INFO: epoch 001:  16757 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=372.9, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905355, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=32.606, expert1_balance_bottom=19.61, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=212.7, ups=0.57, wpb=372.9, bsz=32, num_updates=16730, lr=8.62846e-06, gnorm=3.117, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34803
2022-05-09 06:29:13 - progress_bar.py[line:272] - INFO: epoch 001:  16767 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866745, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=35.011, expert1_balance_bottom=18.969, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.2, ups=0.56, wpb=384.7, bsz=32, num_updates=16740, lr=8.62726e-06, gnorm=3.405, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34821
2022-05-09 06:29:30 - progress_bar.py[line:272] - INFO: epoch 001:  16777 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881081, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.876, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212, ups=0.56, wpb=379.3, bsz=32, num_updates=16750, lr=8.62605e-06, gnorm=3.219, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34839
2022-05-09 06:29:48 - progress_bar.py[line:272] - INFO: epoch 001:  16787 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88164, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.519, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.3, ups=0.56, wpb=381.2, bsz=32, num_updates=16760, lr=8.62485e-06, gnorm=3.727, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34856
2022-05-09 06:30:06 - progress_bar.py[line:272] - INFO: epoch 001:  16797 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=382, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891094, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.93, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=217.3, ups=0.57, wpb=382, bsz=32, num_updates=16770, lr=8.62365e-06, gnorm=3.239, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34874
2022-05-09 06:30:23 - progress_bar.py[line:272] - INFO: epoch 001:  16807 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.426, expert1_balance_bottom=19.188, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.4, ups=0.57, wpb=377.4, bsz=32, num_updates=16780, lr=8.62245e-06, gnorm=3.833, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34891
2022-05-09 06:30:41 - progress_bar.py[line:272] - INFO: epoch 001:  16817 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=384.3, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.696, expert1_balance_bottom=19.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.5, ups=0.56, wpb=384.3, bsz=32, num_updates=16790, lr=8.62125e-06, gnorm=3.382, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34909
2022-05-09 06:31:00 - progress_bar.py[line:272] - INFO: epoch 001:  16827 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=378.3, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890826, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.881, expert1_balance_bottom=19.366, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=207.6, ups=0.55, wpb=378.3, bsz=32, num_updates=16800, lr=8.62005e-06, gnorm=3.939, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34928
2022-05-09 06:31:17 - progress_bar.py[line:272] - INFO: epoch 001:  16837 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=377.8, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.916, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.7, ups=0.56, wpb=377.8, bsz=32, num_updates=16810, lr=8.61885e-06, gnorm=3.218, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34945
2022-05-09 06:31:35 - progress_bar.py[line:272] - INFO: epoch 001:  16847 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=388.4, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880706, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.263, expert1_balance_bottom=19.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.9, ups=0.56, wpb=388.4, bsz=32, num_updates=16820, lr=8.61764e-06, gnorm=3.444, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34963
2022-05-09 06:31:53 - progress_bar.py[line:272] - INFO: epoch 001:  16857 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=386.5, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875148, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.407, expert1_balance_bottom=19.213, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.9, ups=0.56, wpb=386.5, bsz=32, num_updates=16830, lr=8.61644e-06, gnorm=3.37, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34981
2022-05-09 06:32:11 - progress_bar.py[line:272] - INFO: epoch 001:  16867 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=375, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.741, expert1_balance_bottom=19.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.3, ups=0.56, wpb=375, bsz=32, num_updates=16840, lr=8.61524e-06, gnorm=3.511, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=34999
2022-05-09 06:32:29 - progress_bar.py[line:272] - INFO: epoch 001:  16877 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=374.7, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.912393, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.157, expert1_balance_top=32.447, expert1_balance_bottom=19.889, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.2, ups=0.56, wpb=374.7, bsz=32, num_updates=16850, lr=8.61404e-06, gnorm=3.165, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35017
2022-05-09 06:32:47 - progress_bar.py[line:272] - INFO: epoch 001:  16887 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.538, expert1_balance_bottom=19.514, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213.6, ups=0.56, wpb=381.3, bsz=32, num_updates=16860, lr=8.61284e-06, gnorm=3.434, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35035
2022-05-09 06:33:05 - progress_bar.py[line:272] - INFO: epoch 001:  16897 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.82, expert1_balance_bottom=19.327, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=218.2, ups=0.57, wpb=384.2, bsz=32, num_updates=16870, lr=8.61164e-06, gnorm=3.292, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35053
2022-05-09 06:33:23 - progress_bar.py[line:272] - INFO: epoch 001:  16907 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=385.6, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.855708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=35.311, expert1_balance_bottom=18.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213, ups=0.55, wpb=385.6, bsz=32, num_updates=16880, lr=8.61044e-06, gnorm=3.323, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35071
2022-05-09 06:33:40 - progress_bar.py[line:272] - INFO: epoch 001:  16917 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=384.5, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872415, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.431, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218.3, ups=0.57, wpb=384.5, bsz=32, num_updates=16890, lr=8.60924e-06, gnorm=3.716, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35088
2022-05-09 06:33:58 - progress_bar.py[line:272] - INFO: epoch 001:  16927 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=376.7, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899112, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=33.316, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210.8, ups=0.56, wpb=376.7, bsz=32, num_updates=16900, lr=8.60803e-06, gnorm=3.548, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35106
2022-05-09 06:34:16 - progress_bar.py[line:272] - INFO: epoch 001:  16937 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886053, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.676, expert1_balance_bottom=19.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.1, ups=0.56, wpb=384.2, bsz=32, num_updates=16910, lr=8.60683e-06, gnorm=3.46, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35124
2022-05-09 06:34:34 - progress_bar.py[line:272] - INFO: epoch 001:  16947 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.24, expert1_balance_bottom=19.238, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216, ups=0.56, wpb=384.1, bsz=32, num_updates=16920, lr=8.60563e-06, gnorm=4.297, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35142
2022-05-09 06:34:52 - progress_bar.py[line:272] - INFO: epoch 001:  16957 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889594, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.906, expert1_balance_bottom=19.392, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.5, ups=0.56, wpb=380.5, bsz=32, num_updates=16930, lr=8.60443e-06, gnorm=4.389, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35160
2022-05-09 06:35:10 - progress_bar.py[line:272] - INFO: epoch 001:  16967 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885789, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.149, expert1_balance_bottom=19.074, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.2, ups=0.55, wpb=384.3, bsz=32, num_updates=16940, lr=8.60323e-06, gnorm=4.043, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35178
2022-05-09 06:35:28 - progress_bar.py[line:272] - INFO: epoch 001:  16977 / 17711 loss=3.127, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=382.3, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893379, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.127, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.205, expert1_balance_bottom=19.676, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.3, ups=0.56, wpb=382.3, bsz=32, num_updates=16950, lr=8.60203e-06, gnorm=4.173, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35196
2022-05-09 06:35:46 - progress_bar.py[line:272] - INFO: epoch 001:  16987 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=380.1, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883563, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.318, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=210.7, ups=0.55, wpb=380.1, bsz=32, num_updates=16960, lr=8.60083e-06, gnorm=5.21, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35214
2022-05-09 06:36:04 - progress_bar.py[line:272] - INFO: epoch 001:  16997 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=376.7, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.717, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=209.6, ups=0.56, wpb=376.7, bsz=32, num_updates=16970, lr=8.59963e-06, gnorm=3.627, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35232
2022-05-09 06:36:22 - progress_bar.py[line:272] - INFO: epoch 001:  17007 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=375.7, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890898, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.65, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.2, ups=0.56, wpb=375.7, bsz=32, num_updates=16980, lr=8.59842e-06, gnorm=3.683, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35250
2022-05-09 06:36:40 - progress_bar.py[line:272] - INFO: epoch 001:  17017 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886921, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.532, expert1_balance_bottom=19.292, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.1, ups=0.55, wpb=380.5, bsz=32, num_updates=16990, lr=8.59722e-06, gnorm=3.45, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35268
2022-05-09 06:36:58 - progress_bar.py[line:272] - INFO: epoch 001:  17027 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=385.6, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.699, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.7, ups=0.56, wpb=385.6, bsz=32, num_updates=17000, lr=8.59602e-06, gnorm=2.885, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35286
2022-05-09 06:37:16 - progress_bar.py[line:272] - INFO: epoch 001:  17037 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=378.9, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874746, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.703, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210, ups=0.55, wpb=378.9, bsz=32, num_updates=17010, lr=8.59482e-06, gnorm=3.38, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35304
2022-05-09 06:37:34 - progress_bar.py[line:272] - INFO: epoch 001:  17047 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888609, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.353, expert1_balance_bottom=19.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.4, ups=0.56, wpb=383.9, bsz=32, num_updates=17020, lr=8.59362e-06, gnorm=3.88, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35322
2022-05-09 06:37:52 - progress_bar.py[line:272] - INFO: epoch 001:  17057 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=370.3, nsentences=32, sample_size=294.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893482, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.527, expert1_balance_bottom=19.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=205.8, ups=0.56, wpb=370.3, bsz=32, num_updates=17030, lr=8.59242e-06, gnorm=3.093, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35340
2022-05-09 06:38:10 - progress_bar.py[line:272] - INFO: epoch 001:  17067 / 17711 loss=3.099, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=374.9, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886941, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.099, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.837, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=208.7, ups=0.56, wpb=374.9, bsz=32, num_updates=17040, lr=8.59122e-06, gnorm=3.544, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35358
2022-05-09 06:38:27 - progress_bar.py[line:272] - INFO: epoch 001:  17077 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=379.1, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.862077, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.835, expert1_balance_bottom=18.812, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214, ups=0.56, wpb=379.1, bsz=32, num_updates=17050, lr=8.59001e-06, gnorm=3.46, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35375
2022-05-09 06:38:45 - progress_bar.py[line:272] - INFO: epoch 001:  17087 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886053, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.521, expert1_balance_bottom=19.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.8, ups=0.56, wpb=382.5, bsz=32, num_updates=17060, lr=8.58881e-06, gnorm=3.785, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35393
2022-05-09 06:39:03 - progress_bar.py[line:272] - INFO: epoch 001:  17097 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885868, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.758, expert1_balance_bottom=19.284, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=215.1, ups=0.56, wpb=382.8, bsz=32, num_updates=17070, lr=8.58761e-06, gnorm=3.642, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35411
2022-05-09 06:39:21 - progress_bar.py[line:272] - INFO: epoch 001:  17107 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=391.2, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88977, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=32.906, expert1_balance_bottom=19.666, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=219.6, ups=0.56, wpb=391.2, bsz=32, num_updates=17080, lr=8.58641e-06, gnorm=3.353, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35429
2022-05-09 06:39:38 - progress_bar.py[line:272] - INFO: epoch 001:  17117 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=390.4, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.71, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=220.3, ups=0.56, wpb=390.4, bsz=32, num_updates=17090, lr=8.58521e-06, gnorm=3.648, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35446
2022-05-09 06:39:56 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 06:39:58 - progress_bar.py[line:272] - INFO: epoch 001:  17128 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=377.7, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893615, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=33.425, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=192.3, ups=0.51, wpb=377.7, bsz=32, num_updates=17100, lr=8.58401e-06, gnorm=3.392, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35466
2022-05-09 06:40:16 - progress_bar.py[line:272] - INFO: epoch 001:  17138 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=379.2, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881268, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.057, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.7, ups=0.56, wpb=379.2, bsz=32, num_updates=17110, lr=8.58281e-06, gnorm=3.214, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35484
2022-05-09 06:40:34 - progress_bar.py[line:272] - INFO: epoch 001:  17148 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.216, expert1_balance_bottom=19.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217, ups=0.56, wpb=384.9, bsz=32, num_updates=17120, lr=8.58161e-06, gnorm=3.812, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35502
2022-05-09 06:40:51 - progress_bar.py[line:272] - INFO: epoch 001:  17158 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896585, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.323, expert1_balance_bottom=19.564, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.7, ups=0.56, wpb=382.3, bsz=32, num_updates=17130, lr=8.5804e-06, gnorm=3.16, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35519
2022-05-09 06:41:09 - progress_bar.py[line:272] - INFO: epoch 001:  17168 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=374.3, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897942, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=33.398, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=212.7, ups=0.57, wpb=374.3, bsz=32, num_updates=17140, lr=8.5792e-06, gnorm=3.437, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35537
2022-05-09 06:41:27 - progress_bar.py[line:272] - INFO: epoch 001:  17178 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=379, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888523, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.714, expert1_balance_bottom=19.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.6, ups=0.56, wpb=379, bsz=32, num_updates=17150, lr=8.578e-06, gnorm=3.541, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35555
2022-05-09 06:41:45 - progress_bar.py[line:272] - INFO: epoch 001:  17188 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=389.3, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.336, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=214.4, ups=0.55, wpb=389.3, bsz=32, num_updates=17160, lr=8.5768e-06, gnorm=3.016, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35573
2022-05-09 06:42:03 - progress_bar.py[line:272] - INFO: epoch 001:  17198 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=34.335, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.7, ups=0.56, wpb=384.4, bsz=32, num_updates=17170, lr=8.5756e-06, gnorm=3.529, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35591
2022-05-09 06:42:21 - progress_bar.py[line:272] - INFO: epoch 001:  17208 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.015, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.2, ups=0.56, wpb=381.6, bsz=32, num_updates=17180, lr=8.5744e-06, gnorm=3.391, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35609
2022-05-09 06:42:39 - progress_bar.py[line:272] - INFO: epoch 001:  17218 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.503, expert1_balance_bottom=19.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215, ups=0.56, wpb=383.6, bsz=32, num_updates=17190, lr=8.5732e-06, gnorm=3.047, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35627
2022-05-09 06:42:57 - progress_bar.py[line:272] - INFO: epoch 001:  17228 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=385.5, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88482, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.858, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.4, ups=0.55, wpb=385.5, bsz=32, num_updates=17200, lr=8.57199e-06, gnorm=4.172, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35645
2022-05-09 06:43:14 - progress_bar.py[line:272] - INFO: epoch 001:  17238 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.02, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=219.1, ups=0.57, wpb=386.4, bsz=32, num_updates=17210, lr=8.57079e-06, gnorm=3.523, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35662
2022-05-09 06:43:33 - progress_bar.py[line:272] - INFO: epoch 001:  17248 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877622, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.669, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=210.6, ups=0.55, wpb=383.6, bsz=32, num_updates=17220, lr=8.56959e-06, gnorm=2.946, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35681
2022-05-09 06:43:51 - progress_bar.py[line:272] - INFO: epoch 001:  17258 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=374.2, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.153, expert1_balance_top=32.777, expert1_balance_bottom=19.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=208.9, ups=0.56, wpb=374.2, bsz=32, num_updates=17230, lr=8.56839e-06, gnorm=3.118, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35699
2022-05-09 06:44:08 - progress_bar.py[line:272] - INFO: epoch 001:  17268 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=379.4, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.91, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=211.4, ups=0.56, wpb=379.4, bsz=32, num_updates=17240, lr=8.56719e-06, gnorm=3.468, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35717
2022-05-09 06:44:26 - progress_bar.py[line:272] - INFO: epoch 001:  17278 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.295, expert1_balance_bottom=19.511, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=209.7, ups=0.56, wpb=377.1, bsz=32, num_updates=17250, lr=8.56599e-06, gnorm=3.133, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35734
2022-05-09 06:44:44 - progress_bar.py[line:272] - INFO: epoch 001:  17288 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.476, expert1_balance_bottom=19.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=212, ups=0.56, wpb=381.7, bsz=32, num_updates=17260, lr=8.56479e-06, gnorm=3.403, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35752
2022-05-09 06:45:02 - progress_bar.py[line:272] - INFO: epoch 001:  17298 / 17711 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=385.9, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.129, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.325, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=215.3, ups=0.56, wpb=385.9, bsz=32, num_updates=17270, lr=8.56359e-06, gnorm=3.935, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35770
2022-05-09 06:45:20 - progress_bar.py[line:272] - INFO: epoch 001:  17308 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.852, expert1_balance_bottom=19.327, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.8, ups=0.56, wpb=380.7, bsz=32, num_updates=17280, lr=8.56238e-06, gnorm=3.413, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35788
2022-05-09 06:45:38 - progress_bar.py[line:272] - INFO: epoch 001:  17318 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.545, expert1_balance_bottom=19.454, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.2, ups=0.56, wpb=382.8, bsz=32, num_updates=17290, lr=8.56118e-06, gnorm=3.498, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35806
2022-05-09 06:45:55 - progress_bar.py[line:272] - INFO: epoch 001:  17328 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=378.1, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.227, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.8, ups=0.57, wpb=378.1, bsz=32, num_updates=17300, lr=8.55998e-06, gnorm=3.559, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35823
2022-05-09 06:46:13 - progress_bar.py[line:272] - INFO: epoch 001:  17338 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.86, expert1_balance_bottom=19.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.8, ups=0.56, wpb=384.3, bsz=32, num_updates=17310, lr=8.55878e-06, gnorm=3.624, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35841
2022-05-09 06:46:31 - progress_bar.py[line:272] - INFO: epoch 001:  17348 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.603, expert1_balance_bottom=19.46, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.9, ups=0.56, wpb=384.1, bsz=32, num_updates=17320, lr=8.55758e-06, gnorm=3.709, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35859
2022-05-09 06:46:49 - progress_bar.py[line:272] - INFO: epoch 001:  17358 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=378.5, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.81, expert1_balance_bottom=19.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211, ups=0.56, wpb=378.5, bsz=32, num_updates=17330, lr=8.55638e-06, gnorm=3.622, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35877
2022-05-09 06:47:07 - progress_bar.py[line:272] - INFO: epoch 001:  17368 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=389.6, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.422, expert1_balance_bottom=19.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=218.4, ups=0.56, wpb=389.6, bsz=32, num_updates=17340, lr=8.55518e-06, gnorm=3.457, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35895
2022-05-09 06:47:24 - progress_bar.py[line:272] - INFO: epoch 001:  17378 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=373.9, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.401, expert1_balance_bottom=19.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=210.7, ups=0.56, wpb=373.9, bsz=32, num_updates=17350, lr=8.55398e-06, gnorm=4.084, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35912
2022-05-09 06:47:42 - progress_bar.py[line:272] - INFO: epoch 001:  17388 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.361, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.2, ups=0.57, wpb=383.9, bsz=32, num_updates=17360, lr=8.55277e-06, gnorm=3.587, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35930
2022-05-09 06:48:00 - progress_bar.py[line:272] - INFO: epoch 001:  17398 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878782, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.253, expert1_balance_bottom=19.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.1, ups=0.56, wpb=385.4, bsz=32, num_updates=17370, lr=8.55157e-06, gnorm=3.861, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35948
2022-05-09 06:48:18 - progress_bar.py[line:272] - INFO: epoch 001:  17408 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87758, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=34.376, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.6, ups=0.56, wpb=384.9, bsz=32, num_updates=17380, lr=8.55037e-06, gnorm=3.332, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35966
2022-05-09 06:48:35 - progress_bar.py[line:272] - INFO: epoch 001:  17418 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.683, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.4, ups=0.57, wpb=386.3, bsz=32, num_updates=17390, lr=8.54917e-06, gnorm=3.617, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=35983
2022-05-09 06:48:53 - progress_bar.py[line:272] - INFO: epoch 001:  17428 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=377.5, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.15, expert1_balance_top=33.463, expert1_balance_bottom=19.636, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.6, ups=0.57, wpb=377.5, bsz=32, num_updates=17400, lr=8.54797e-06, gnorm=3.328, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36001
2022-05-09 06:49:11 - progress_bar.py[line:272] - INFO: epoch 001:  17438 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=395.8, nsentences=32, sample_size=315.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880452, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.081, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.1, ups=0.57, wpb=395.8, bsz=32, num_updates=17410, lr=8.54677e-06, gnorm=3.467, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36019
2022-05-09 06:49:28 - progress_bar.py[line:272] - INFO: epoch 001:  17448 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.767, expert1_balance_bottom=19.434, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.9, ups=0.57, wpb=383, bsz=32, num_updates=17420, lr=8.54557e-06, gnorm=3.637, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36036
2022-05-09 06:49:46 - progress_bar.py[line:272] - INFO: epoch 001:  17458 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878026, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.385, expert1_balance_bottom=19.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.5, ups=0.56, wpb=388, bsz=32, num_updates=17430, lr=8.54436e-06, gnorm=3.296, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36054
2022-05-09 06:50:04 - progress_bar.py[line:272] - INFO: epoch 001:  17468 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=380.9, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.516, expert1_balance_bottom=19.556, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.7, ups=0.56, wpb=380.9, bsz=32, num_updates=17440, lr=8.54316e-06, gnorm=3.405, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36072
2022-05-09 06:50:22 - progress_bar.py[line:272] - INFO: epoch 001:  17478 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=379.1, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891109, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.705, expert1_balance_bottom=19.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.6, ups=0.56, wpb=379.1, bsz=32, num_updates=17450, lr=8.54196e-06, gnorm=3.481, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36090
2022-05-09 06:50:39 - progress_bar.py[line:272] - INFO: epoch 001:  17488 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=33.261, expert1_balance_bottom=19.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.8, ups=0.56, wpb=384.4, bsz=32, num_updates=17460, lr=8.54076e-06, gnorm=3.649, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36107
2022-05-09 06:50:58 - progress_bar.py[line:272] - INFO: epoch 001:  17498 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=375.6, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.769, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=206.8, ups=0.55, wpb=375.6, bsz=32, num_updates=17470, lr=8.53956e-06, gnorm=3.138, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36126
2022-05-09 06:51:15 - progress_bar.py[line:272] - INFO: epoch 001:  17508 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=375.6, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.447, expert1_balance_bottom=19.547, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210.1, ups=0.56, wpb=375.6, bsz=32, num_updates=17480, lr=8.53836e-06, gnorm=3.376, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36143
2022-05-09 06:51:33 - progress_bar.py[line:272] - INFO: epoch 001:  17518 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=385.5, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868973, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.706, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.7, ups=0.56, wpb=385.5, bsz=32, num_updates=17490, lr=8.53716e-06, gnorm=3.411, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36161
2022-05-09 06:51:51 - progress_bar.py[line:272] - INFO: epoch 001:  17528 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.217, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.9, ups=0.56, wpb=382.1, bsz=32, num_updates=17500, lr=8.53596e-06, gnorm=3.351, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36179
2022-05-09 06:52:09 - progress_bar.py[line:272] - INFO: epoch 001:  17538 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=377.5, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.516, expert1_balance_bottom=19.511, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=209.6, ups=0.56, wpb=377.5, bsz=32, num_updates=17510, lr=8.53475e-06, gnorm=3.054, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36197
2022-05-09 06:52:27 - progress_bar.py[line:272] - INFO: epoch 001:  17548 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=376.3, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.883, expert1_balance_bottom=19.434, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.4, ups=0.56, wpb=376.3, bsz=32, num_updates=17520, lr=8.53355e-06, gnorm=3.337, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36215
2022-05-09 06:52:45 - progress_bar.py[line:272] - INFO: epoch 001:  17558 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=382.1, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.459, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=212.6, ups=0.56, wpb=382.1, bsz=32, num_updates=17530, lr=8.53235e-06, gnorm=3.497, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36233
2022-05-09 06:53:03 - progress_bar.py[line:272] - INFO: epoch 001:  17568 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=385.4, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.191, expert1_balance_bottom=19.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216.3, ups=0.56, wpb=385.4, bsz=32, num_updates=17540, lr=8.53115e-06, gnorm=3.218, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36251
2022-05-09 06:53:21 - progress_bar.py[line:272] - INFO: epoch 001:  17578 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=387.3, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870121, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.334, expert1_balance_bottom=19.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=218.7, ups=0.56, wpb=387.3, bsz=32, num_updates=17550, lr=8.52995e-06, gnorm=3.33, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36269
2022-05-09 06:53:38 - progress_bar.py[line:272] - INFO: epoch 001:  17588 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887099, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.755, expert1_balance_bottom=19.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.9, ups=0.57, wpb=383.7, bsz=32, num_updates=17560, lr=8.52875e-06, gnorm=4.25, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36286
2022-05-09 06:53:56 - progress_bar.py[line:272] - INFO: epoch 001:  17598 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=387.4, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.289, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.1, ups=0.57, wpb=387.4, bsz=32, num_updates=17570, lr=8.52755e-06, gnorm=3.155, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36304
2022-05-09 06:54:14 - progress_bar.py[line:272] - INFO: epoch 001:  17608 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=386.9, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876632, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.265, expert1_balance_bottom=19.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=219.4, ups=0.57, wpb=386.9, bsz=32, num_updates=17580, lr=8.52634e-06, gnorm=4.085, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36322
2022-05-09 06:54:31 - progress_bar.py[line:272] - INFO: epoch 001:  17618 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=392.3, nsentences=32, sample_size=312.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888546, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.814, expert1_balance_bottom=19.399, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.6, ups=0.56, wpb=392.3, bsz=32, num_updates=17590, lr=8.52514e-06, gnorm=3.626, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36339
2022-05-09 06:54:49 - progress_bar.py[line:272] - INFO: epoch 001:  17628 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.569, expert1_balance_bottom=19.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.3, ups=0.56, wpb=382.3, bsz=32, num_updates=17600, lr=8.52394e-06, gnorm=3.386, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36357
2022-05-09 06:55:07 - progress_bar.py[line:272] - INFO: epoch 001:  17638 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.445, expert1_balance_bottom=19.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.2, ups=0.56, wpb=384.8, bsz=32, num_updates=17610, lr=8.52274e-06, gnorm=3.037, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36375
2022-05-09 06:55:25 - progress_bar.py[line:272] - INFO: epoch 001:  17648 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880718, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.515, expert1_balance_bottom=19.094, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=209.2, ups=0.55, wpb=379.7, bsz=32, num_updates=17620, lr=8.52154e-06, gnorm=3.381, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36393
2022-05-09 06:55:43 - progress_bar.py[line:272] - INFO: epoch 001:  17658 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=371.3, nsentences=32, sample_size=295.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901386, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.152, expert1_balance_top=32.812, expert1_balance_bottom=19.681, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=206.1, ups=0.56, wpb=371.3, bsz=32, num_updates=17630, lr=8.52034e-06, gnorm=2.995, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36411
2022-05-09 06:56:01 - progress_bar.py[line:272] - INFO: epoch 001:  17668 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=387.6, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.292, expert1_balance_bottom=19.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.1, ups=0.54, wpb=387.6, bsz=32, num_updates=17640, lr=8.51914e-06, gnorm=3.571, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36430
2022-05-09 06:56:19 - progress_bar.py[line:272] - INFO: epoch 001:  17678 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889431, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.627, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=211.5, ups=0.56, wpb=380.2, bsz=32, num_updates=17650, lr=8.51794e-06, gnorm=3.364, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36447
2022-05-09 06:56:37 - progress_bar.py[line:272] - INFO: epoch 001:  17688 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=375.3, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890629, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.909, expert1_balance_bottom=19.359, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=208.6, ups=0.56, wpb=375.3, bsz=32, num_updates=17660, lr=8.51673e-06, gnorm=3.255, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36465
2022-05-09 06:56:55 - progress_bar.py[line:272] - INFO: epoch 001:  17698 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.933, expert1_balance_bottom=19.172, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.9, ups=0.56, wpb=380.2, bsz=32, num_updates=17670, lr=8.51553e-06, gnorm=3.363, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36483
2022-05-09 06:57:13 - progress_bar.py[line:272] - INFO: epoch 001:  17708 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.303, expert1_balance_bottom=19.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.2, ups=0.56, wpb=381.7, bsz=32, num_updates=17680, lr=8.51433e-06, gnorm=3.862, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=36501
2022-05-09 06:57:18 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 06:57:18 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 06:57:18 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 07:04:45 - train.py[line:517] - INFO: valid_step finished
2022-05-09 07:04:45 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 9.954 | loss_v1 0 | loss_v2 0 | nll_loss 8.282 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.98613 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.954 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.206 | expert1_balance_top 37.594 | expert1_balance_bottom 15.136 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 311.32 | cider 1.192 | wps 674.5 | wpb 481.7 | bsz 8 | num_updates 17683 | best_cider 1.198
2022-05-09 07:04:45 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 1 @ 17683 updates
2022-05-09 07:04:45 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-rank-0.pt
2022-05-09 07:04:45 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-rank-0.pt
2022-05-09 07:04:57 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-rank-0.pt
2022-05-09 07:04:57 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-shared.pt
2022-05-09 07:05:10 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-shared.pt
2022-05-09 07:05:10 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-rank-0.pt (epoch 1 @ 17683 updates, score 1.192) (writing took 25.36737544927746 seconds)
2022-05-09 07:05:10 - train.py[line:342] - INFO: end of epoch 1 (average epoch stats below)
2022-05-09 07:05:10 - progress_bar.py[line:282] - INFO: epoch 001 | loss 3.249 | loss_v1 0 | loss_v2 0 | nll_loss 1.023 | ntokens 382.697 | nsentences 32 | sample_size 315.625 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.88479 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 3.249 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.179 | expert1_balance_top 34.303 | expert1_balance_bottom 19.163 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 2.03 | wps 183.2 | ups 0.48 | wpb 382.7 | bsz 32 | num_updates 17683 | lr 8.51397e-06 | gnorm 3.436 | loss_scale 64 | train_wall 29786 | cuda_gb_allocated 14.1 | cuda_gb_reserved 15 | cuda_gb_free 9.6 | wall 36978
2022-05-09 07:05:10 - trainer.py[line:743] - INFO: loading train data for epoch 2
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 row count 566747 total row count 566747
slice_id 0 seek offset 0
2022-05-09 07:05:37 - trainer.py[line:807] - INFO: begin training epoch 2
2022-05-09 07:05:37 - train.py[line:315] - INFO: Start iterating over samples
2022-05-09 07:05:50 - progress_bar.py[line:272] - INFO: epoch 002:      7 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=382.6, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=34.01, expert1_balance_bottom=19.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=7.4, ups=0.02, wpb=382.6, bsz=32, num_updates=17690, lr=8.51313e-06, gnorm=3.673, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37018
2022-05-09 07:06:07 - progress_bar.py[line:272] - INFO: epoch 002:     17 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=386.3, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876212, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.086, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=220.6, ups=0.57, wpb=386.3, bsz=32, num_updates=17700, lr=8.51193e-06, gnorm=3.275, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37035
2022-05-09 07:06:25 - progress_bar.py[line:272] - INFO: epoch 002:     27 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=378.7, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.552, expert1_balance_bottom=19.511, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216.5, ups=0.57, wpb=378.7, bsz=32, num_updates=17710, lr=8.51073e-06, gnorm=3.217, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37053
2022-05-09 07:06:43 - progress_bar.py[line:272] - INFO: epoch 002:     37 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=374.2, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.152, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.1, ups=0.57, wpb=374.2, bsz=32, num_updates=17720, lr=8.50953e-06, gnorm=3.23, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37071
2022-05-09 07:07:00 - progress_bar.py[line:272] - INFO: epoch 002:     47 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.773, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=217.7, ups=0.56, wpb=385.7, bsz=32, num_updates=17730, lr=8.50833e-06, gnorm=2.788, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37088
2022-05-09 07:07:18 - progress_bar.py[line:272] - INFO: epoch 002:     57 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=385, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.383, expert1_balance_bottom=19.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216.3, ups=0.56, wpb=385, bsz=32, num_updates=17740, lr=8.50712e-06, gnorm=3.63, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37106
2022-05-09 07:07:36 - progress_bar.py[line:272] - INFO: epoch 002:     67 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=379.3, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.887, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.2, ups=0.56, wpb=379.3, bsz=32, num_updates=17750, lr=8.50592e-06, gnorm=3.202, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37124
2022-05-09 07:07:54 - progress_bar.py[line:272] - INFO: epoch 002:     77 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=376.3, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879881, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=34.104, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.5, ups=0.56, wpb=376.3, bsz=32, num_updates=17760, lr=8.50472e-06, gnorm=3.7, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37142
2022-05-09 07:08:11 - progress_bar.py[line:272] - INFO: epoch 002:     87 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885229, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.776, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.3, ups=0.57, wpb=387.2, bsz=32, num_updates=17770, lr=8.50352e-06, gnorm=3.122, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37159
2022-05-09 07:08:29 - progress_bar.py[line:272] - INFO: epoch 002:     97 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=389.6, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893403, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.142, expert1_balance_bottom=19.782, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.3, ups=0.57, wpb=389.6, bsz=32, num_updates=17780, lr=8.50232e-06, gnorm=3.335, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37177
2022-05-09 07:08:46 - progress_bar.py[line:272] - INFO: epoch 002:    107 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=395, nsentences=32, sample_size=314.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.276, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.1, ups=0.57, wpb=395, bsz=32, num_updates=17790, lr=8.50112e-06, gnorm=3.135, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37194
2022-05-09 07:09:04 - progress_bar.py[line:272] - INFO: epoch 002:    117 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=377.6, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878433, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=34.241, expert1_balance_bottom=19.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=213.5, ups=0.57, wpb=377.6, bsz=32, num_updates=17800, lr=8.49992e-06, gnorm=3.305, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37212
2022-05-09 07:09:22 - progress_bar.py[line:272] - INFO: epoch 002:    127 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=379.9, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89964, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=32.968, expert1_balance_bottom=19.409, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=213.9, ups=0.56, wpb=379.9, bsz=32, num_updates=17810, lr=8.49871e-06, gnorm=3.334, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37230
2022-05-09 07:09:40 - progress_bar.py[line:272] - INFO: epoch 002:    137 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=381.2, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.621, expert1_balance_bottom=19.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215.2, ups=0.56, wpb=381.2, bsz=32, num_updates=17820, lr=8.49751e-06, gnorm=3.635, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37248
2022-05-09 07:09:57 - progress_bar.py[line:272] - INFO: epoch 002:    147 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89092, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.272, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=216.7, ups=0.57, wpb=380.3, bsz=32, num_updates=17830, lr=8.49631e-06, gnorm=3.378, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37265
2022-05-09 07:10:15 - progress_bar.py[line:272] - INFO: epoch 002:    157 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=380.3, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890881, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.863, expert1_balance_bottom=19.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.5, ups=0.56, wpb=380.3, bsz=32, num_updates=17840, lr=8.49511e-06, gnorm=3.479, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37283
2022-05-09 07:10:33 - progress_bar.py[line:272] - INFO: epoch 002:    167 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=383.4, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.965, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216.4, ups=0.56, wpb=383.4, bsz=32, num_updates=17850, lr=8.49391e-06, gnorm=4.135, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37301
2022-05-09 07:10:50 - progress_bar.py[line:272] - INFO: epoch 002:    177 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=376.5, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=32.933, expert1_balance_bottom=19.74, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.9, ups=0.57, wpb=376.5, bsz=32, num_updates=17860, lr=8.49271e-06, gnorm=3.397, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37318
2022-05-09 07:11:08 - progress_bar.py[line:272] - INFO: epoch 002:    187 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87722, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=34.164, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.6, ups=0.57, wpb=386.3, bsz=32, num_updates=17870, lr=8.49151e-06, gnorm=3.259, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37336
2022-05-09 07:11:26 - progress_bar.py[line:272] - INFO: epoch 002:    197 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=384.6, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.106, expert1_balance_bottom=19.265, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=219, ups=0.57, wpb=384.6, bsz=32, num_updates=17880, lr=8.49031e-06, gnorm=3.219, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37354
2022-05-09 07:11:43 - progress_bar.py[line:272] - INFO: epoch 002:    207 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=383.4, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=34.126, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.2, ups=0.56, wpb=383.4, bsz=32, num_updates=17890, lr=8.4891e-06, gnorm=3.34, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37371
2022-05-09 07:12:01 - progress_bar.py[line:272] - INFO: epoch 002:    217 / 17711 loss=3.125, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=375, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.125, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.805, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=213.8, ups=0.57, wpb=375, bsz=32, num_updates=17900, lr=8.4879e-06, gnorm=3.445, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37389
2022-05-09 07:12:18 - progress_bar.py[line:272] - INFO: epoch 002:    227 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.872, expert1_balance_bottom=19.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.5, ups=0.57, wpb=380.5, bsz=32, num_updates=17910, lr=8.4867e-06, gnorm=3.403, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37406
2022-05-09 07:12:36 - progress_bar.py[line:272] - INFO: epoch 002:    237 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=374.6, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.863, expert1_balance_bottom=19.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=209.8, ups=0.56, wpb=374.6, bsz=32, num_updates=17920, lr=8.4855e-06, gnorm=3.688, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37424
2022-05-09 07:12:54 - progress_bar.py[line:272] - INFO: epoch 002:    247 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866681, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.78, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.7, ups=0.57, wpb=386.1, bsz=32, num_updates=17930, lr=8.4843e-06, gnorm=3.449, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37442
2022-05-09 07:13:12 - progress_bar.py[line:272] - INFO: epoch 002:    257 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.803, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.3, ups=0.56, wpb=388.3, bsz=32, num_updates=17940, lr=8.4831e-06, gnorm=3.614, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37460
2022-05-09 07:13:29 - progress_bar.py[line:272] - INFO: epoch 002:    267 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.795, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.4, ups=0.56, wpb=385, bsz=32, num_updates=17950, lr=8.4819e-06, gnorm=3.435, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37478
2022-05-09 07:13:47 - progress_bar.py[line:272] - INFO: epoch 002:    277 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=379.9, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900261, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.066, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=213.9, ups=0.56, wpb=379.9, bsz=32, num_updates=17960, lr=8.48069e-06, gnorm=3.038, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37495
2022-05-09 07:14:05 - progress_bar.py[line:272] - INFO: epoch 002:    287 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.034, expert1_balance_bottom=19.292, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.9, ups=0.55, wpb=383.3, bsz=32, num_updates=17970, lr=8.47949e-06, gnorm=3.282, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37513
2022-05-09 07:14:23 - progress_bar.py[line:272] - INFO: epoch 002:    297 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=374.4, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894156, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.125, expert1_balance_bottom=19.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.7, ups=0.56, wpb=374.4, bsz=32, num_updates=17980, lr=8.47829e-06, gnorm=2.822, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37531
2022-05-09 07:14:41 - progress_bar.py[line:272] - INFO: epoch 002:    307 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.131, expert1_balance_bottom=19.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=213.6, ups=0.56, wpb=381.3, bsz=32, num_updates=17990, lr=8.47709e-06, gnorm=2.929, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37549
2022-05-09 07:14:59 - progress_bar.py[line:272] - INFO: epoch 002:    317 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.772, expert1_balance_bottom=19.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.8, ups=0.56, wpb=382.9, bsz=32, num_updates=18000, lr=8.47589e-06, gnorm=3.144, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=37567
2022-05-09 07:14:59 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 07:14:59 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 07:14:59 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 07:22:28 - train.py[line:517] - INFO: valid_step finished
2022-05-09 07:22:28 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 9.858 | loss_v1 0 | loss_v2 0 | nll_loss 8.177 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.987271 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.858 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.203 | expert1_balance_top 37.905 | expert1_balance_bottom 15.057 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 289.35 | cider 1.192 | wps 670.6 | wpb 481.7 | bsz 8 | num_updates 18000 | best_cider 1.198
2022-05-09 07:22:46 - progress_bar.py[line:272] - INFO: epoch 002:    327 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=382.4, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888197, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.436, expert1_balance_bottom=19.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=8.2, ups=0.02, wpb=382.4, bsz=32, num_updates=18010, lr=8.47469e-06, gnorm=3.573, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38034
2022-05-09 07:23:04 - progress_bar.py[line:272] - INFO: epoch 002:    337 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=388.1, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.399, expert1_balance_bottom=19.528, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=219.9, ups=0.57, wpb=388.1, bsz=32, num_updates=18020, lr=8.47349e-06, gnorm=3.44, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38052
2022-05-09 07:23:21 - progress_bar.py[line:272] - INFO: epoch 002:    347 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=380.7, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89343, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=33.254, expert1_balance_bottom=19.783, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.2, ups=0.57, wpb=380.7, bsz=32, num_updates=18030, lr=8.47229e-06, gnorm=3.193, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38069
2022-05-09 07:23:39 - progress_bar.py[line:272] - INFO: epoch 002:    357 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=32.828, expert1_balance_bottom=19.79, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.7, ups=0.56, wpb=382.5, bsz=32, num_updates=18040, lr=8.47108e-06, gnorm=3.079, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38087
2022-05-09 07:23:57 - progress_bar.py[line:272] - INFO: epoch 002:    367 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.84, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220.4, ups=0.57, wpb=386, bsz=32, num_updates=18050, lr=8.46988e-06, gnorm=2.969, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38105
2022-05-09 07:24:14 - progress_bar.py[line:272] - INFO: epoch 002:    377 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.906767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.151, expert1_balance_top=32.82, expert1_balance_bottom=19.789, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217.4, ups=0.56, wpb=385.2, bsz=32, num_updates=18060, lr=8.46868e-06, gnorm=3.663, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38122
2022-05-09 07:24:32 - progress_bar.py[line:272] - INFO: epoch 002:    387 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889355, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.558, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=218, ups=0.56, wpb=387.9, bsz=32, num_updates=18070, lr=8.46748e-06, gnorm=2.877, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38140
2022-05-09 07:24:50 - progress_bar.py[line:272] - INFO: epoch 002:    397 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=395.6, nsentences=32, sample_size=314.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86588, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.539, expert1_balance_bottom=19.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.4, ups=0.56, wpb=395.6, bsz=32, num_updates=18080, lr=8.46628e-06, gnorm=2.994, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38158
2022-05-09 07:25:08 - progress_bar.py[line:272] - INFO: epoch 002:    407 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883094, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.63, expert1_balance_bottom=19.295, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.6, ups=0.56, wpb=384.5, bsz=32, num_updates=18090, lr=8.46508e-06, gnorm=3.426, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38176
2022-05-09 07:25:26 - progress_bar.py[line:272] - INFO: epoch 002:    417 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=374.5, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.608, expert1_balance_bottom=19.535, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=208, ups=0.56, wpb=374.5, bsz=32, num_updates=18100, lr=8.46388e-06, gnorm=2.917, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38194
2022-05-09 07:25:44 - progress_bar.py[line:272] - INFO: epoch 002:    427 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=385.1, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881088, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.143, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.5, ups=0.56, wpb=385.1, bsz=32, num_updates=18110, lr=8.46268e-06, gnorm=3.239, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38212
2022-05-09 07:26:02 - progress_bar.py[line:272] - INFO: epoch 002:    437 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=382.6, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.557, expert1_balance_bottom=19.534, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=211.9, ups=0.55, wpb=382.6, bsz=32, num_updates=18120, lr=8.46147e-06, gnorm=3.458, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38230
2022-05-09 07:26:20 - progress_bar.py[line:272] - INFO: epoch 002:    447 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=373.1, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889651, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.414, expert1_balance_bottom=19.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209.6, ups=0.56, wpb=373.1, bsz=32, num_updates=18130, lr=8.46027e-06, gnorm=3.091, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38248
2022-05-09 07:26:38 - progress_bar.py[line:272] - INFO: epoch 002:    457 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.137, expert1_balance_bottom=19.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.9, ups=0.56, wpb=379.9, bsz=32, num_updates=18140, lr=8.45907e-06, gnorm=3.683, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38266
2022-05-09 07:26:56 - progress_bar.py[line:272] - INFO: epoch 002:    467 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=376.6, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888423, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.659, expert1_balance_bottom=19.238, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=208.6, ups=0.55, wpb=376.6, bsz=32, num_updates=18150, lr=8.45787e-06, gnorm=3.136, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38284
2022-05-09 07:27:14 - progress_bar.py[line:272] - INFO: epoch 002:    477 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=381.8, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.853, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.7, ups=0.55, wpb=381.8, bsz=32, num_updates=18160, lr=8.45667e-06, gnorm=3.377, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38302
2022-05-09 07:27:31 - progress_bar.py[line:272] - INFO: epoch 002:    487 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=381.4, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899186, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.149, expert1_balance_top=33.159, expert1_balance_bottom=19.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=215.2, ups=0.56, wpb=381.4, bsz=32, num_updates=18170, lr=8.45547e-06, gnorm=3.387, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38319
2022-05-09 07:27:48 - progress_bar.py[line:272] - INFO: epoch 002:    497 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.728, expert1_balance_bottom=19.554, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=226.4, ups=0.59, wpb=384.7, bsz=32, num_updates=18180, lr=8.45427e-06, gnorm=3.466, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38336
2022-05-09 07:28:06 - progress_bar.py[line:272] - INFO: epoch 002:    507 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.368, expert1_balance_bottom=19.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.2, ups=0.58, wpb=382.4, bsz=32, num_updates=18190, lr=8.45306e-06, gnorm=3.347, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38354
2022-05-09 07:28:23 - progress_bar.py[line:272] - INFO: epoch 002:    517 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.389, expert1_balance_bottom=19.605, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.5, ups=0.58, wpb=383.3, bsz=32, num_updates=18200, lr=8.45186e-06, gnorm=3.736, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38371
2022-05-09 07:28:41 - progress_bar.py[line:272] - INFO: epoch 002:    527 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.01, expert1_balance_bottom=19.474, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220, ups=0.57, wpb=386.3, bsz=32, num_updates=18210, lr=8.45066e-06, gnorm=3.429, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38389
2022-05-09 07:28:58 - progress_bar.py[line:272] - INFO: epoch 002:    537 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=377, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885462, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=34.098, expert1_balance_bottom=19.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=216.4, ups=0.57, wpb=377, bsz=32, num_updates=18220, lr=8.44946e-06, gnorm=3.886, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38406
2022-05-09 07:29:15 - progress_bar.py[line:272] - INFO: epoch 002:    547 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884599, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.865, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.4, ups=0.58, wpb=386.1, bsz=32, num_updates=18230, lr=8.44826e-06, gnorm=3.032, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38423
2022-05-09 07:29:33 - progress_bar.py[line:272] - INFO: epoch 002:    557 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.582, expert1_balance_bottom=19.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=222.9, ups=0.58, wpb=385.4, bsz=32, num_updates=18240, lr=8.44706e-06, gnorm=3.327, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38441
2022-05-09 07:29:50 - progress_bar.py[line:272] - INFO: epoch 002:    567 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=388.2, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885728, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=34.062, expert1_balance_bottom=19.173, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221.4, ups=0.57, wpb=388.2, bsz=32, num_updates=18250, lr=8.44586e-06, gnorm=3.416, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38458
2022-05-09 07:30:08 - progress_bar.py[line:272] - INFO: epoch 002:    577 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=386.6, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884169, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=34.318, expert1_balance_bottom=19.217, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=222.7, ups=0.58, wpb=386.6, bsz=32, num_updates=18260, lr=8.44466e-06, gnorm=3.672, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38476
2022-05-09 07:30:25 - progress_bar.py[line:272] - INFO: epoch 002:    587 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=384.3, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878777, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.307, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.1, ups=0.58, wpb=384.3, bsz=32, num_updates=18270, lr=8.44345e-06, gnorm=3.684, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38493
2022-05-09 07:30:42 - progress_bar.py[line:272] - INFO: epoch 002:    597 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=387.3, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=34.458, expert1_balance_bottom=19.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=221.9, ups=0.57, wpb=387.3, bsz=32, num_updates=18280, lr=8.44225e-06, gnorm=3.408, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38510
2022-05-09 07:31:00 - progress_bar.py[line:272] - INFO: epoch 002:    607 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=375.7, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.723, expert1_balance_bottom=19.622, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=218.4, ups=0.58, wpb=375.7, bsz=32, num_updates=18290, lr=8.44105e-06, gnorm=3.311, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38528
2022-05-09 07:31:17 - progress_bar.py[line:272] - INFO: epoch 002:    617 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=386.7, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882192, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=34.11, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=226.2, ups=0.58, wpb=386.7, bsz=32, num_updates=18300, lr=8.43985e-06, gnorm=3.561, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38545
2022-05-09 07:31:33 - progress_bar.py[line:272] - INFO: epoch 002:    627 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=373.6, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895731, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=33.634, expert1_balance_bottom=19.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.9, ups=0.59, wpb=373.6, bsz=32, num_updates=18310, lr=8.43865e-06, gnorm=3.335, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38561
2022-05-09 07:31:51 - progress_bar.py[line:272] - INFO: epoch 002:    637 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=386.4, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.401, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.7, ups=0.58, wpb=386.4, bsz=32, num_updates=18320, lr=8.43745e-06, gnorm=3.357, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38579
2022-05-09 07:32:08 - progress_bar.py[line:272] - INFO: epoch 002:    647 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.747, expert1_balance_bottom=19.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220.4, ups=0.58, wpb=380.5, bsz=32, num_updates=18330, lr=8.43625e-06, gnorm=3.1, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38596
2022-05-09 07:32:25 - progress_bar.py[line:272] - INFO: epoch 002:    657 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=388.9, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.695, expert1_balance_bottom=19.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=225.6, ups=0.58, wpb=388.9, bsz=32, num_updates=18340, lr=8.43504e-06, gnorm=3.5, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38613
2022-05-09 07:32:42 - progress_bar.py[line:272] - INFO: epoch 002:    667 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=385, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890658, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.671, expert1_balance_bottom=19.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=223.4, ups=0.58, wpb=385, bsz=32, num_updates=18350, lr=8.43384e-06, gnorm=2.939, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38630
2022-05-09 07:32:59 - progress_bar.py[line:272] - INFO: epoch 002:    677 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=388.4, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878034, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.272, expert1_balance_bottom=19.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=226.2, ups=0.58, wpb=388.4, bsz=32, num_updates=18360, lr=8.43264e-06, gnorm=2.964, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38648
2022-05-09 07:33:17 - progress_bar.py[line:272] - INFO: epoch 002:    687 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.488, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.9, ups=0.57, wpb=386, bsz=32, num_updates=18370, lr=8.43144e-06, gnorm=3.626, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38665
2022-05-09 07:33:34 - progress_bar.py[line:272] - INFO: epoch 002:    697 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=379.8, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.816, expert1_balance_bottom=19.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.6, ups=0.57, wpb=379.8, bsz=32, num_updates=18380, lr=8.43024e-06, gnorm=3.024, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38683
2022-05-09 07:33:52 - progress_bar.py[line:272] - INFO: epoch 002:    707 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=389.2, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=34.124, expert1_balance_bottom=19.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.7, ups=0.57, wpb=389.2, bsz=32, num_updates=18390, lr=8.42904e-06, gnorm=3.507, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38700
2022-05-09 07:34:10 - progress_bar.py[line:272] - INFO: epoch 002:    717 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.703, expert1_balance_bottom=19.194, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.5, ups=0.57, wpb=385.4, bsz=32, num_updates=18400, lr=8.42784e-06, gnorm=3.947, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38718
2022-05-09 07:34:27 - progress_bar.py[line:272] - INFO: epoch 002:    727 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=390.4, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880293, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.856, expert1_balance_bottom=19.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=227.8, ups=0.58, wpb=390.4, bsz=32, num_updates=18410, lr=8.42664e-06, gnorm=3.443, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38735
2022-05-09 07:34:44 - progress_bar.py[line:272] - INFO: epoch 002:    737 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=372.1, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892702, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.327, expert1_balance_bottom=19.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.1, ups=0.58, wpb=372.1, bsz=32, num_updates=18420, lr=8.42543e-06, gnorm=3.854, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38752
2022-05-09 07:35:01 - progress_bar.py[line:272] - INFO: epoch 002:    747 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882388, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.05, expert1_balance_bottom=19.327, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=225.3, ups=0.59, wpb=383.9, bsz=32, num_updates=18430, lr=8.42423e-06, gnorm=2.98, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38769
2022-05-09 07:35:18 - progress_bar.py[line:272] - INFO: epoch 002:    757 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=375.1, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891332, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.609, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.2, ups=0.58, wpb=375.1, bsz=32, num_updates=18440, lr=8.42303e-06, gnorm=3.159, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38786
2022-05-09 07:35:36 - progress_bar.py[line:272] - INFO: epoch 002:    767 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=382.8, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.688, expert1_balance_bottom=19.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217.8, ups=0.57, wpb=382.8, bsz=32, num_updates=18450, lr=8.42183e-06, gnorm=3.2, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38804
2022-05-09 07:35:54 - progress_bar.py[line:272] - INFO: epoch 002:    777 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=393.1, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.265, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214.9, ups=0.55, wpb=393.1, bsz=32, num_updates=18460, lr=8.42063e-06, gnorm=3.077, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38822
2022-05-09 07:36:12 - progress_bar.py[line:272] - INFO: epoch 002:    787 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=384.9, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.763, expert1_balance_bottom=19.362, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215.3, ups=0.56, wpb=384.9, bsz=32, num_updates=18470, lr=8.41943e-06, gnorm=3.875, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38840
2022-05-09 07:36:30 - progress_bar.py[line:272] - INFO: epoch 002:    797 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=387.9, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881775, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=34.023, expert1_balance_bottom=19.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220.8, ups=0.57, wpb=387.9, bsz=32, num_updates=18480, lr=8.41823e-06, gnorm=3.308, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38858
2022-05-09 07:36:47 - progress_bar.py[line:272] - INFO: epoch 002:    807 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=381.1, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.699, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.1, ups=0.56, wpb=381.1, bsz=32, num_updates=18490, lr=8.41703e-06, gnorm=3.493, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38875
2022-05-09 07:37:05 - progress_bar.py[line:272] - INFO: epoch 002:    817 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=377.7, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898502, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.031, expert1_balance_bottom=19.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.2, ups=0.56, wpb=377.7, bsz=32, num_updates=18500, lr=8.41582e-06, gnorm=3.733, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38893
2022-05-09 07:37:23 - progress_bar.py[line:272] - INFO: epoch 002:    827 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.211, expert1_balance_bottom=19.617, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.4, ups=0.57, wpb=381.1, bsz=32, num_updates=18510, lr=8.41462e-06, gnorm=3.16, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38911
2022-05-09 07:37:41 - progress_bar.py[line:272] - INFO: epoch 002:    837 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=378.4, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.651, expert1_balance_bottom=19.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.4, ups=0.56, wpb=378.4, bsz=32, num_updates=18520, lr=8.41342e-06, gnorm=3.272, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38929
2022-05-09 07:37:59 - progress_bar.py[line:272] - INFO: epoch 002:    847 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.42, expert1_balance_bottom=19.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.6, ups=0.56, wpb=384.7, bsz=32, num_updates=18530, lr=8.41222e-06, gnorm=3.755, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38947
2022-05-09 07:38:16 - progress_bar.py[line:272] - INFO: epoch 002:    857 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=384.2, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877862, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=34.088, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.7, ups=0.56, wpb=384.2, bsz=32, num_updates=18540, lr=8.41102e-06, gnorm=3.143, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38964
2022-05-09 07:38:34 - progress_bar.py[line:272] - INFO: epoch 002:    867 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=375.6, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.614, expert1_balance_bottom=19.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.1, ups=0.56, wpb=375.6, bsz=32, num_updates=18550, lr=8.40982e-06, gnorm=3.491, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=38982
2022-05-09 07:38:52 - progress_bar.py[line:272] - INFO: epoch 002:    877 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894359, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=32.965, expert1_balance_bottom=19.599, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=216.6, ups=0.57, wpb=381.2, bsz=32, num_updates=18560, lr=8.40862e-06, gnorm=3.133, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39000
2022-05-09 07:39:10 - progress_bar.py[line:272] - INFO: epoch 002:    887 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=383.5, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.2, expert1_balance_bottom=19.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.8, ups=0.56, wpb=383.5, bsz=32, num_updates=18570, lr=8.40741e-06, gnorm=3.166, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39018
2022-05-09 07:39:27 - progress_bar.py[line:272] - INFO: epoch 002:    897 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=375.3, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887047, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.886, expert1_balance_bottom=19.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=209.6, ups=0.56, wpb=375.3, bsz=32, num_updates=18580, lr=8.40621e-06, gnorm=3.324, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39036
2022-05-09 07:39:29 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 07:39:47 - progress_bar.py[line:272] - INFO: epoch 002:    908 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=384.1, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.915, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=195.6, ups=0.51, wpb=384.1, bsz=32, num_updates=18590, lr=8.40501e-06, gnorm=3.015, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39055
2022-05-09 07:40:05 - progress_bar.py[line:272] - INFO: epoch 002:    918 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=388.8, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.758, expert1_balance_bottom=19.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221.8, ups=0.57, wpb=388.8, bsz=32, num_updates=18600, lr=8.40381e-06, gnorm=3.233, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39073
2022-05-09 07:40:22 - progress_bar.py[line:272] - INFO: epoch 002:    928 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883494, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.676, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.2, ups=0.57, wpb=386, bsz=32, num_updates=18610, lr=8.40261e-06, gnorm=3.589, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39090
2022-05-09 07:40:40 - progress_bar.py[line:272] - INFO: epoch 002:    938 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=386, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.115, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.1, ups=0.57, wpb=386, bsz=32, num_updates=18620, lr=8.40141e-06, gnorm=3.568, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39108
2022-05-09 07:40:58 - progress_bar.py[line:272] - INFO: epoch 002:    948 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.164, expert1_balance_bottom=19.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.6, ups=0.57, wpb=384.7, bsz=32, num_updates=18630, lr=8.40021e-06, gnorm=3.283, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39126
2022-05-09 07:41:15 - progress_bar.py[line:272] - INFO: epoch 002:    958 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=377, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881588, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.916, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212.1, ups=0.56, wpb=377, bsz=32, num_updates=18640, lr=8.39901e-06, gnorm=3.857, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39143
2022-05-09 07:41:33 - progress_bar.py[line:272] - INFO: epoch 002:    968 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=382.7, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892429, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.231, expert1_balance_bottom=19.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=213.7, ups=0.56, wpb=382.7, bsz=32, num_updates=18650, lr=8.3978e-06, gnorm=3.33, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39161
2022-05-09 07:41:51 - progress_bar.py[line:272] - INFO: epoch 002:    978 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=381.4, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.451, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.1, ups=0.56, wpb=381.4, bsz=32, num_updates=18660, lr=8.3966e-06, gnorm=3.393, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39179
2022-05-09 07:42:09 - progress_bar.py[line:272] - INFO: epoch 002:    988 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=393.3, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.356, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.2, ups=0.57, wpb=393.3, bsz=32, num_updates=18670, lr=8.3954e-06, gnorm=3.197, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39197
2022-05-09 07:42:26 - progress_bar.py[line:272] - INFO: epoch 002:    998 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=390.1, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.663, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221, ups=0.57, wpb=390.1, bsz=32, num_updates=18680, lr=8.3942e-06, gnorm=2.868, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39214
2022-05-09 07:42:44 - progress_bar.py[line:272] - INFO: epoch 002:   1008 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=382.7, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.791, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.8, ups=0.57, wpb=382.7, bsz=32, num_updates=18690, lr=8.393e-06, gnorm=3.239, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39232
2022-05-09 07:43:02 - progress_bar.py[line:272] - INFO: epoch 002:   1018 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=389.3, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884562, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.748, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=219.5, ups=0.56, wpb=389.3, bsz=32, num_updates=18700, lr=8.3918e-06, gnorm=3.347, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39250
2022-05-09 07:43:20 - progress_bar.py[line:272] - INFO: epoch 002:   1028 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=382.4, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.57, expert1_balance_bottom=19.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=212.4, ups=0.56, wpb=382.4, bsz=32, num_updates=18710, lr=8.3906e-06, gnorm=3.01, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39268
2022-05-09 07:43:38 - progress_bar.py[line:272] - INFO: epoch 002:   1038 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891073, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.228, expert1_balance_bottom=19.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214.5, ups=0.56, wpb=383.2, bsz=32, num_updates=18720, lr=8.38939e-06, gnorm=3.334, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39286
2022-05-09 07:43:55 - progress_bar.py[line:272] - INFO: epoch 002:   1048 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=372.3, nsentences=32, sample_size=296.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.72, expert1_balance_bottom=19.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.3, ups=0.57, wpb=372.3, bsz=32, num_updates=18730, lr=8.38819e-06, gnorm=3.749, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39303
2022-05-09 07:44:13 - progress_bar.py[line:272] - INFO: epoch 002:   1058 / 17711 loss=2.931, loss_v1=0, loss_v2=0, nll_loss=0.716, ntokens=376.6, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.931, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.404, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=214.6, ups=0.57, wpb=376.6, bsz=32, num_updates=18740, lr=8.38699e-06, gnorm=3.495, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39321
2022-05-09 07:44:30 - progress_bar.py[line:272] - INFO: epoch 002:   1068 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=374.3, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.9005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.148, expert1_balance_top=33.019, expert1_balance_bottom=19.394, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.2, ups=0.57, wpb=374.3, bsz=32, num_updates=18750, lr=8.38579e-06, gnorm=4.205, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39338
2022-05-09 07:44:48 - progress_bar.py[line:272] - INFO: epoch 002:   1078 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892352, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=32.983, expert1_balance_bottom=19.629, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=218.1, ups=0.57, wpb=381.8, bsz=32, num_updates=18760, lr=8.38459e-06, gnorm=3.362, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39356
2022-05-09 07:45:06 - progress_bar.py[line:272] - INFO: epoch 002:   1088 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=383.7, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.1, expert1_balance_bottom=19.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214.5, ups=0.56, wpb=383.7, bsz=32, num_updates=18770, lr=8.38339e-06, gnorm=3.347, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39374
2022-05-09 07:45:23 - progress_bar.py[line:272] - INFO: epoch 002:   1098 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.727, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.1, ups=0.57, wpb=381.3, bsz=32, num_updates=18780, lr=8.38219e-06, gnorm=3.354, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39391
2022-05-09 07:45:41 - progress_bar.py[line:272] - INFO: epoch 002:   1108 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=385.7, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876075, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.306, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=221.2, ups=0.57, wpb=385.7, bsz=32, num_updates=18790, lr=8.38099e-06, gnorm=3.682, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39409
2022-05-09 07:45:58 - progress_bar.py[line:272] - INFO: epoch 002:   1118 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=375.9, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.499, expert1_balance_bottom=19.548, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=213.5, ups=0.57, wpb=375.9, bsz=32, num_updates=18800, lr=8.37978e-06, gnorm=3.192, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39427
2022-05-09 07:46:16 - progress_bar.py[line:272] - INFO: epoch 002:   1128 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.629, expert1_balance_bottom=19.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.2, ups=0.57, wpb=382.3, bsz=32, num_updates=18810, lr=8.37858e-06, gnorm=3.384, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39444
2022-05-09 07:46:34 - progress_bar.py[line:272] - INFO: epoch 002:   1138 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=386.2, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=32.338, expert1_balance_bottom=19.782, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.7, ups=0.56, wpb=386.2, bsz=32, num_updates=18820, lr=8.37738e-06, gnorm=3.379, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39462
2022-05-09 07:46:52 - progress_bar.py[line:272] - INFO: epoch 002:   1148 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=388.5, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.812, expert1_balance_bottom=19.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217.7, ups=0.56, wpb=388.5, bsz=32, num_updates=18830, lr=8.37618e-06, gnorm=3.132, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39480
2022-05-09 07:47:09 - progress_bar.py[line:272] - INFO: epoch 002:   1158 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87471, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.867, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=218.9, ups=0.57, wpb=386.4, bsz=32, num_updates=18840, lr=8.37498e-06, gnorm=3.492, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39497
2022-05-09 07:47:27 - progress_bar.py[line:272] - INFO: epoch 002:   1168 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=390.9, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.408, expert1_balance_bottom=19.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.6, ups=0.57, wpb=390.9, bsz=32, num_updates=18850, lr=8.37378e-06, gnorm=4.402, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39515
2022-05-09 07:47:45 - progress_bar.py[line:272] - INFO: epoch 002:   1178 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888114, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.346, expert1_balance_bottom=19.51, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.6, ups=0.56, wpb=383.9, bsz=32, num_updates=18860, lr=8.37258e-06, gnorm=2.891, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39533
2022-05-09 07:48:03 - progress_bar.py[line:272] - INFO: epoch 002:   1188 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=382.1, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.518, expert1_balance_bottom=19.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.3, ups=0.56, wpb=382.1, bsz=32, num_updates=18870, lr=8.37138e-06, gnorm=3.395, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39551
2022-05-09 07:48:21 - progress_bar.py[line:272] - INFO: epoch 002:   1198 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=395.6, nsentences=32, sample_size=314.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877942, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.893, expert1_balance_bottom=19.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.7, ups=0.56, wpb=395.6, bsz=32, num_updates=18880, lr=8.37017e-06, gnorm=3.347, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39569
2022-05-09 07:48:39 - progress_bar.py[line:272] - INFO: epoch 002:   1208 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.658, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=217.3, ups=0.56, wpb=385.3, bsz=32, num_updates=18890, lr=8.36897e-06, gnorm=3.318, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39587
2022-05-09 07:48:57 - progress_bar.py[line:272] - INFO: epoch 002:   1218 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=376.6, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876586, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.928, expert1_balance_bottom=19.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=208.4, ups=0.55, wpb=376.6, bsz=32, num_updates=18900, lr=8.36777e-06, gnorm=2.942, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39605
2022-05-09 07:49:15 - progress_bar.py[line:272] - INFO: epoch 002:   1228 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=32.826, expert1_balance_bottom=19.789, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.3, ups=0.56, wpb=380.7, bsz=32, num_updates=18910, lr=8.36657e-06, gnorm=4.341, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39623
2022-05-09 07:49:33 - progress_bar.py[line:272] - INFO: epoch 002:   1238 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889563, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.239, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=210, ups=0.55, wpb=379.5, bsz=32, num_updates=18920, lr=8.36537e-06, gnorm=3.178, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39641
2022-05-09 07:49:50 - progress_bar.py[line:272] - INFO: epoch 002:   1248 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884729, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.927, expert1_balance_bottom=19.188, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=216.8, ups=0.57, wpb=383.1, bsz=32, num_updates=18930, lr=8.36417e-06, gnorm=3.337, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39658
2022-05-09 07:50:08 - progress_bar.py[line:272] - INFO: epoch 002:   1258 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886943, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.5, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.5, ups=0.56, wpb=382.4, bsz=32, num_updates=18940, lr=8.36297e-06, gnorm=3.377, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39676
2022-05-09 07:50:25 - progress_bar.py[line:272] - INFO: epoch 002:   1268 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=389.1, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.419, expert1_balance_bottom=19.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.4, ups=0.57, wpb=389.1, bsz=32, num_updates=18950, lr=8.36176e-06, gnorm=3.827, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39693
2022-05-09 07:50:43 - progress_bar.py[line:272] - INFO: epoch 002:   1278 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=387.5, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882567, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.757, expert1_balance_bottom=19.416, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=215.7, ups=0.56, wpb=387.5, bsz=32, num_updates=18960, lr=8.36056e-06, gnorm=3.069, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39711
2022-05-09 07:51:01 - progress_bar.py[line:272] - INFO: epoch 002:   1288 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=384.6, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.729, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=217.5, ups=0.57, wpb=384.6, bsz=32, num_updates=18970, lr=8.35936e-06, gnorm=3.068, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39729
2022-05-09 07:51:19 - progress_bar.py[line:272] - INFO: epoch 002:   1298 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891017, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.267, expert1_balance_bottom=19.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=214.9, ups=0.56, wpb=385.2, bsz=32, num_updates=18980, lr=8.35816e-06, gnorm=3.075, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39747
2022-05-09 07:51:37 - progress_bar.py[line:272] - INFO: epoch 002:   1308 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=372.6, nsentences=32, sample_size=296.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894699, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.535, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=208, ups=0.56, wpb=372.6, bsz=32, num_updates=18990, lr=8.35696e-06, gnorm=3.365, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39765
2022-05-09 07:51:55 - progress_bar.py[line:272] - INFO: epoch 002:   1318 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=381.8, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878508, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.745, expert1_balance_bottom=19.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=213.5, ups=0.56, wpb=381.8, bsz=32, num_updates=19000, lr=8.35576e-06, gnorm=3.307, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39783
2022-05-09 07:52:13 - progress_bar.py[line:272] - INFO: epoch 002:   1328 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89371, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=32.965, expert1_balance_bottom=19.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215.8, ups=0.56, wpb=385.7, bsz=32, num_updates=19010, lr=8.35456e-06, gnorm=3.611, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39801
2022-05-09 07:52:31 - progress_bar.py[line:272] - INFO: epoch 002:   1338 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881873, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.212, expert1_balance_bottom=19.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.4, ups=0.55, wpb=382.1, bsz=32, num_updates=19020, lr=8.35336e-06, gnorm=3.279, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39819
2022-05-09 07:52:49 - progress_bar.py[line:272] - INFO: epoch 002:   1348 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=388.7, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.223, expert1_balance_bottom=19.057, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.4, ups=0.56, wpb=388.7, bsz=32, num_updates=19030, lr=8.35215e-06, gnorm=3.469, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39837
2022-05-09 07:53:06 - progress_bar.py[line:272] - INFO: epoch 002:   1358 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.047, expert1_balance_bottom=19.556, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.7, ups=0.56, wpb=383.2, bsz=32, num_updates=19040, lr=8.35095e-06, gnorm=3.346, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39854
2022-05-09 07:53:24 - progress_bar.py[line:272] - INFO: epoch 002:   1368 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879502, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.926, expert1_balance_bottom=19.164, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.6, ups=0.56, wpb=384.3, bsz=32, num_updates=19050, lr=8.34975e-06, gnorm=3.526, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39872
2022-05-09 07:53:42 - progress_bar.py[line:272] - INFO: epoch 002:   1378 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=383.5, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884504, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.302, expert1_balance_bottom=19.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=214, ups=0.56, wpb=383.5, bsz=32, num_updates=19060, lr=8.34855e-06, gnorm=3.277, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39890
2022-05-09 07:54:00 - progress_bar.py[line:272] - INFO: epoch 002:   1388 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=387.5, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876718, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.718, expert1_balance_bottom=19.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.1, ups=0.55, wpb=387.5, bsz=32, num_updates=19070, lr=8.34735e-06, gnorm=3.332, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39908
2022-05-09 07:54:18 - progress_bar.py[line:272] - INFO: epoch 002:   1398 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=383.4, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.056, expert1_balance_bottom=19.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.2, ups=0.56, wpb=383.4, bsz=32, num_updates=19080, lr=8.34615e-06, gnorm=2.789, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39926
2022-05-09 07:54:36 - progress_bar.py[line:272] - INFO: epoch 002:   1408 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.225, expert1_balance_bottom=19.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=214.8, ups=0.57, wpb=378.6, bsz=32, num_updates=19090, lr=8.34495e-06, gnorm=3.691, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39944
2022-05-09 07:54:54 - progress_bar.py[line:272] - INFO: epoch 002:   1418 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885978, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.403, expert1_balance_bottom=19.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=216.1, ups=0.56, wpb=383.6, bsz=32, num_updates=19100, lr=8.34374e-06, gnorm=3.445, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39962
2022-05-09 07:55:11 - progress_bar.py[line:272] - INFO: epoch 002:   1428 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88791, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.62, expert1_balance_bottom=19.265, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.8, ups=0.56, wpb=386.3, bsz=32, num_updates=19110, lr=8.34254e-06, gnorm=3.169, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39979
2022-05-09 07:55:29 - progress_bar.py[line:272] - INFO: epoch 002:   1438 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=387.4, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900044, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=32.658, expert1_balance_bottom=19.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=220.4, ups=0.57, wpb=387.4, bsz=32, num_updates=19120, lr=8.34134e-06, gnorm=2.993, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=39997
2022-05-09 07:55:47 - progress_bar.py[line:272] - INFO: epoch 002:   1448 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=376.2, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895596, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.229, expert1_balance_bottom=19.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=209, ups=0.56, wpb=376.2, bsz=32, num_updates=19130, lr=8.34014e-06, gnorm=2.94, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40015
2022-05-09 07:56:05 - progress_bar.py[line:272] - INFO: epoch 002:   1458 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=394.4, nsentences=32, sample_size=314.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.156, expert1_balance_bottom=19.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.4, ups=0.56, wpb=394.4, bsz=32, num_updates=19140, lr=8.33894e-06, gnorm=3.308, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40033
2022-05-09 07:56:23 - progress_bar.py[line:272] - INFO: epoch 002:   1468 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.323, expert1_balance_bottom=19.418, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.2, ups=0.56, wpb=378.4, bsz=32, num_updates=19150, lr=8.33774e-06, gnorm=3.845, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40051
2022-05-09 07:56:40 - progress_bar.py[line:272] - INFO: epoch 002:   1478 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881693, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.65, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=213.8, ups=0.56, wpb=383.1, bsz=32, num_updates=19160, lr=8.33654e-06, gnorm=3.003, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40069
2022-05-09 07:56:58 - progress_bar.py[line:272] - INFO: epoch 002:   1488 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=378.1, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891088, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.145, expert1_balance_top=33.336, expert1_balance_bottom=19.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=210.5, ups=0.56, wpb=378.1, bsz=32, num_updates=19170, lr=8.33534e-06, gnorm=3.03, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40087
2022-05-09 07:57:17 - progress_bar.py[line:272] - INFO: epoch 002:   1498 / 17711 loss=2.932, loss_v1=0, loss_v2=0, nll_loss=0.699, ntokens=380.4, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890307, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.932, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.186, expert1_balance_bottom=19.563, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=208.3, ups=0.55, wpb=380.4, bsz=32, num_updates=19180, lr=8.33413e-06, gnorm=3.28, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40105
2022-05-09 07:57:35 - progress_bar.py[line:272] - INFO: epoch 002:   1508 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.646, expert1_balance_bottom=19.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=211.2, ups=0.55, wpb=381.2, bsz=32, num_updates=19190, lr=8.33293e-06, gnorm=3.132, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40123
2022-05-09 07:57:53 - progress_bar.py[line:272] - INFO: epoch 002:   1518 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.05, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=213.4, ups=0.55, wpb=384.7, bsz=32, num_updates=19200, lr=8.33173e-06, gnorm=3.083, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40141
2022-05-09 07:58:11 - progress_bar.py[line:272] - INFO: epoch 002:   1528 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=390.9, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888936, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.492, expert1_balance_bottom=19.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.9, ups=0.56, wpb=390.9, bsz=32, num_updates=19210, lr=8.33053e-06, gnorm=3.261, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40159
2022-05-09 07:58:29 - progress_bar.py[line:272] - INFO: epoch 002:   1538 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891504, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=32.978, expert1_balance_bottom=19.685, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.6, ups=0.56, wpb=382.1, bsz=32, num_updates=19220, lr=8.32933e-06, gnorm=2.994, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40177
2022-05-09 07:58:46 - progress_bar.py[line:272] - INFO: epoch 002:   1548 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878768, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.005, expert1_balance_bottom=19.238, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.3, ups=0.56, wpb=378.4, bsz=32, num_updates=19230, lr=8.32813e-06, gnorm=3.352, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40195
2022-05-09 07:59:04 - progress_bar.py[line:272] - INFO: epoch 002:   1558 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879684, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.443, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.5, ups=0.57, wpb=380.1, bsz=32, num_updates=19240, lr=8.32693e-06, gnorm=3.55, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40212
2022-05-09 07:59:22 - progress_bar.py[line:272] - INFO: epoch 002:   1568 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.108, expert1_balance_bottom=19.265, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217, ups=0.56, wpb=384.7, bsz=32, num_updates=19250, lr=8.32572e-06, gnorm=3.196, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40230
2022-05-09 07:59:40 - progress_bar.py[line:272] - INFO: epoch 002:   1578 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=387.3, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87324, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.092, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.6, ups=0.56, wpb=387.3, bsz=32, num_updates=19260, lr=8.32452e-06, gnorm=3.293, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40248
2022-05-09 07:59:57 - progress_bar.py[line:272] - INFO: epoch 002:   1588 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.393, expert1_balance_bottom=19.544, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216, ups=0.56, wpb=382.4, bsz=32, num_updates=19270, lr=8.32332e-06, gnorm=3.594, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40265
2022-05-09 08:00:15 - progress_bar.py[line:272] - INFO: epoch 002:   1598 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=377.8, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883515, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.877, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.5, ups=0.56, wpb=377.8, bsz=32, num_updates=19280, lr=8.32212e-06, gnorm=3.429, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40283
2022-05-09 08:00:33 - progress_bar.py[line:272] - INFO: epoch 002:   1608 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=32.997, expert1_balance_bottom=19.644, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=214.2, ups=0.56, wpb=383.7, bsz=32, num_updates=19290, lr=8.32092e-06, gnorm=3.245, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40301
2022-05-09 08:00:51 - progress_bar.py[line:272] - INFO: epoch 002:   1618 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892831, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.529, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=213.5, ups=0.56, wpb=383.8, bsz=32, num_updates=19300, lr=8.31972e-06, gnorm=4.231, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40319
2022-05-09 08:01:09 - progress_bar.py[line:272] - INFO: epoch 002:   1628 / 17711 loss=2.94, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877921, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.94, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.106, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=213, ups=0.56, wpb=381.6, bsz=32, num_updates=19310, lr=8.31852e-06, gnorm=2.843, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40337
2022-05-09 08:01:26 - progress_bar.py[line:272] - INFO: epoch 002:   1638 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.762, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.9, ups=0.57, wpb=384.7, bsz=32, num_updates=19320, lr=8.31732e-06, gnorm=3.007, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40354
2022-05-09 08:01:44 - progress_bar.py[line:272] - INFO: epoch 002:   1648 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=373.8, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88084, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.669, expert1_balance_bottom=19.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=209.1, ups=0.56, wpb=373.8, bsz=32, num_updates=19330, lr=8.31611e-06, gnorm=3.534, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40372
2022-05-09 08:02:02 - progress_bar.py[line:272] - INFO: epoch 002:   1658 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.135, expert1_balance_bottom=19.096, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.5, ups=0.56, wpb=385.7, bsz=32, num_updates=19340, lr=8.31491e-06, gnorm=3.266, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40390
2022-05-09 08:02:20 - progress_bar.py[line:272] - INFO: epoch 002:   1668 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=384.8, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.571, expert1_balance_bottom=19.039, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.9, ups=0.56, wpb=384.8, bsz=32, num_updates=19350, lr=8.31371e-06, gnorm=3.379, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40408
2022-05-09 08:02:38 - progress_bar.py[line:272] - INFO: epoch 002:   1678 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=382.8, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.253, expert1_balance_bottom=19.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.6, ups=0.56, wpb=382.8, bsz=32, num_updates=19360, lr=8.31251e-06, gnorm=3.964, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40426
2022-05-09 08:02:56 - progress_bar.py[line:272] - INFO: epoch 002:   1688 / 17711 loss=2.939, loss_v1=0, loss_v2=0, nll_loss=0.717, ntokens=392.6, nsentences=32, sample_size=312.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878318, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.939, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.977, expert1_balance_bottom=19.351, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=222.2, ups=0.57, wpb=392.6, bsz=32, num_updates=19370, lr=8.31131e-06, gnorm=3.624, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40444
2022-05-09 08:03:13 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 08:03:15 - progress_bar.py[line:272] - INFO: epoch 002:   1699 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=381.9, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891249, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.23, expert1_balance_bottom=19.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=194.7, ups=0.51, wpb=381.9, bsz=32, num_updates=19380, lr=8.31011e-06, gnorm=3.215, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40463
2022-05-09 08:03:33 - progress_bar.py[line:272] - INFO: epoch 002:   1709 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888724, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.46, expert1_balance_bottom=19.327, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215.6, ups=0.57, wpb=380.6, bsz=32, num_updates=19390, lr=8.30891e-06, gnorm=3.283, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40481
2022-05-09 08:03:51 - progress_bar.py[line:272] - INFO: epoch 002:   1719 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.486, expert1_balance_bottom=19.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.3, ups=0.56, wpb=383.9, bsz=32, num_updates=19400, lr=8.30771e-06, gnorm=3.453, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40499
2022-05-09 08:04:09 - progress_bar.py[line:272] - INFO: epoch 002:   1729 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=32.928, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.5, ups=0.55, wpb=383.9, bsz=32, num_updates=19410, lr=8.3065e-06, gnorm=3.784, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40517
2022-05-09 08:04:27 - progress_bar.py[line:272] - INFO: epoch 002:   1739 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=389.6, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883038, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.45, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.3, ups=0.54, wpb=389.6, bsz=32, num_updates=19420, lr=8.3053e-06, gnorm=4.12, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40535
2022-05-09 08:04:46 - progress_bar.py[line:272] - INFO: epoch 002:   1749 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=380.8, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.414, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=208, ups=0.55, wpb=380.8, bsz=32, num_updates=19430, lr=8.3041e-06, gnorm=4.109, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40554
2022-05-09 08:05:04 - progress_bar.py[line:272] - INFO: epoch 002:   1759 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=34.239, expert1_balance_bottom=19.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=213.7, ups=0.55, wpb=387.2, bsz=32, num_updates=19440, lr=8.3029e-06, gnorm=3.359, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40572
2022-05-09 08:05:22 - progress_bar.py[line:272] - INFO: epoch 002:   1769 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=377.5, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.741, expert1_balance_bottom=19.245, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.4, ups=0.56, wpb=377.5, bsz=32, num_updates=19450, lr=8.3017e-06, gnorm=3.117, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40590
2022-05-09 08:05:40 - progress_bar.py[line:272] - INFO: epoch 002:   1779 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=377.3, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902103, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.147, expert1_balance_top=32.697, expert1_balance_bottom=19.74, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.4, ups=0.56, wpb=377.3, bsz=32, num_updates=19460, lr=8.3005e-06, gnorm=3.226, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40608
2022-05-09 08:05:58 - progress_bar.py[line:272] - INFO: epoch 002:   1789 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889315, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.317, expert1_balance_bottom=19.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.5, ups=0.56, wpb=381.7, bsz=32, num_updates=19470, lr=8.2993e-06, gnorm=3.306, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40626
2022-05-09 08:06:16 - progress_bar.py[line:272] - INFO: epoch 002:   1799 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883332, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.619, expert1_balance_bottom=19.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212, ups=0.55, wpb=384.3, bsz=32, num_updates=19480, lr=8.29809e-06, gnorm=3.172, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40644
2022-05-09 08:06:34 - progress_bar.py[line:272] - INFO: epoch 002:   1809 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=386.5, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886758, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.497, expert1_balance_bottom=19.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=212, ups=0.55, wpb=386.5, bsz=32, num_updates=19490, lr=8.29689e-06, gnorm=3.088, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40662
2022-05-09 08:06:52 - progress_bar.py[line:272] - INFO: epoch 002:   1819 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88111, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.716, expert1_balance_bottom=19.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.7, ups=0.56, wpb=388, bsz=32, num_updates=19500, lr=8.29569e-06, gnorm=3.221, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40680
2022-05-09 08:07:10 - progress_bar.py[line:272] - INFO: epoch 002:   1829 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.902, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.2, ups=0.56, wpb=383.9, bsz=32, num_updates=19510, lr=8.29449e-06, gnorm=3.272, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40698
2022-05-09 08:07:28 - progress_bar.py[line:272] - INFO: epoch 002:   1839 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.762, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.2, ups=0.55, wpb=383.4, bsz=32, num_updates=19520, lr=8.29329e-06, gnorm=3.523, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40716
2022-05-09 08:07:46 - progress_bar.py[line:272] - INFO: epoch 002:   1849 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.381, expert1_balance_bottom=19.351, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=209.4, ups=0.56, wpb=377.1, bsz=32, num_updates=19530, lr=8.29209e-06, gnorm=3.244, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40734
2022-05-09 08:08:04 - progress_bar.py[line:272] - INFO: epoch 002:   1859 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=388.3, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886333, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.078, expert1_balance_bottom=19.664, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.8, ups=0.55, wpb=388.3, bsz=32, num_updates=19540, lr=8.29089e-06, gnorm=3.262, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40752
2022-05-09 08:08:22 - progress_bar.py[line:272] - INFO: epoch 002:   1869 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=387.5, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884405, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.439, expert1_balance_bottom=19.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216.7, ups=0.56, wpb=387.5, bsz=32, num_updates=19550, lr=8.28969e-06, gnorm=3.677, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40770
2022-05-09 08:08:40 - progress_bar.py[line:272] - INFO: epoch 002:   1879 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.591, expert1_balance_bottom=19.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.2, ups=0.56, wpb=376.7, bsz=32, num_updates=19560, lr=8.28848e-06, gnorm=3.323, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40788
2022-05-09 08:08:58 - progress_bar.py[line:272] - INFO: epoch 002:   1889 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.362, expert1_balance_bottom=19.554, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.9, ups=0.56, wpb=383.9, bsz=32, num_updates=19570, lr=8.28728e-06, gnorm=3.278, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40806
2022-05-09 08:09:16 - progress_bar.py[line:272] - INFO: epoch 002:   1899 / 17711 loss=2.943, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879141, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.943, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.517, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=213.3, ups=0.55, wpb=386.2, bsz=32, num_updates=19580, lr=8.28608e-06, gnorm=3.14, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40824
2022-05-09 08:09:33 - progress_bar.py[line:272] - INFO: epoch 002:   1909 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=394.2, nsentences=32, sample_size=313.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873154, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.961, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223, ups=0.57, wpb=394.2, bsz=32, num_updates=19590, lr=8.28488e-06, gnorm=3.734, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40841
2022-05-09 08:09:51 - progress_bar.py[line:272] - INFO: epoch 002:   1919 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.312, expert1_balance_bottom=19.205, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=213.8, ups=0.56, wpb=378.6, bsz=32, num_updates=19600, lr=8.28368e-06, gnorm=3.186, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40859
2022-05-09 08:10:09 - progress_bar.py[line:272] - INFO: epoch 002:   1929 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=389.6, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.323, expert1_balance_bottom=19.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217.9, ups=0.56, wpb=389.6, bsz=32, num_updates=19610, lr=8.28248e-06, gnorm=3.649, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40877
2022-05-09 08:10:27 - progress_bar.py[line:272] - INFO: epoch 002:   1939 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=372.7, nsentences=32, sample_size=296.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.709, expert1_balance_bottom=19.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=209.5, ups=0.56, wpb=372.7, bsz=32, num_updates=19620, lr=8.28128e-06, gnorm=3.239, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40895
2022-05-09 08:10:45 - progress_bar.py[line:272] - INFO: epoch 002:   1949 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=379, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=32.936, expert1_balance_bottom=19.622, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.4, ups=0.56, wpb=379, bsz=32, num_updates=19630, lr=8.28007e-06, gnorm=3.07, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40913
2022-05-09 08:11:03 - progress_bar.py[line:272] - INFO: epoch 002:   1959 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=380.4, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886131, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.232, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.8, ups=0.56, wpb=380.4, bsz=32, num_updates=19640, lr=8.27887e-06, gnorm=3.841, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40931
2022-05-09 08:11:21 - progress_bar.py[line:272] - INFO: epoch 002:   1969 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=376.5, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=32.624, expert1_balance_bottom=19.633, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=205.7, ups=0.55, wpb=376.5, bsz=32, num_updates=19650, lr=8.27767e-06, gnorm=3.322, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40949
2022-05-09 08:11:39 - progress_bar.py[line:272] - INFO: epoch 002:   1979 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=380.6, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881131, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.463, expert1_balance_bottom=19.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.8, ups=0.55, wpb=380.6, bsz=32, num_updates=19660, lr=8.27647e-06, gnorm=3.405, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40967
2022-05-09 08:11:57 - progress_bar.py[line:272] - INFO: epoch 002:   1989 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=385.2, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=32.803, expert1_balance_bottom=19.76, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215, ups=0.56, wpb=385.2, bsz=32, num_updates=19670, lr=8.27527e-06, gnorm=3.435, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=40985
2022-05-09 08:12:15 - progress_bar.py[line:272] - INFO: epoch 002:   1999 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895761, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=32.69, expert1_balance_bottom=19.761, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.2, ups=0.55, wpb=384.7, bsz=32, num_updates=19680, lr=8.27407e-06, gnorm=3.638, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41003
2022-05-09 08:12:33 - progress_bar.py[line:272] - INFO: epoch 002:   2009 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=394.7, nsentences=32, sample_size=314.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.137, expert1_balance_bottom=19.03, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.5, ups=0.55, wpb=394.7, bsz=32, num_updates=19690, lr=8.27287e-06, gnorm=3.947, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41021
2022-05-09 08:12:51 - progress_bar.py[line:272] - INFO: epoch 002:   2019 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=382.5, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883193, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.731, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=215.2, ups=0.56, wpb=382.5, bsz=32, num_updates=19700, lr=8.27167e-06, gnorm=3.306, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41039
2022-05-09 08:13:09 - progress_bar.py[line:272] - INFO: epoch 002:   2029 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=377.6, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.1, expert1_balance_bottom=19.415, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211, ups=0.56, wpb=377.6, bsz=32, num_updates=19710, lr=8.27046e-06, gnorm=3.433, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41057
2022-05-09 08:13:26 - progress_bar.py[line:272] - INFO: epoch 002:   2039 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87978, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.604, expert1_balance_bottom=19.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=214.8, ups=0.56, wpb=384.1, bsz=32, num_updates=19720, lr=8.26926e-06, gnorm=3.438, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41075
2022-05-09 08:13:44 - progress_bar.py[line:272] - INFO: epoch 002:   2049 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.459, expert1_balance_bottom=19.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.6, ups=0.56, wpb=381.2, bsz=32, num_updates=19730, lr=8.26806e-06, gnorm=3.406, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41093
2022-05-09 08:14:02 - progress_bar.py[line:272] - INFO: epoch 002:   2059 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=385.7, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.144, expert1_balance_bottom=19.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.1, ups=0.56, wpb=385.7, bsz=32, num_updates=19740, lr=8.26686e-06, gnorm=3.202, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41110
2022-05-09 08:14:20 - progress_bar.py[line:272] - INFO: epoch 002:   2069 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886677, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.271, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.8, ups=0.56, wpb=386.3, bsz=32, num_updates=19750, lr=8.26566e-06, gnorm=2.959, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41128
2022-05-09 08:14:38 - progress_bar.py[line:272] - INFO: epoch 002:   2079 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894111, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.108, expert1_balance_bottom=19.664, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=214.7, ups=0.56, wpb=381.9, bsz=32, num_updates=19760, lr=8.26446e-06, gnorm=3.986, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41146
2022-05-09 08:14:56 - progress_bar.py[line:272] - INFO: epoch 002:   2089 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893745, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.113, expert1_balance_bottom=19.738, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.1, ups=0.55, wpb=382.1, bsz=32, num_updates=19770, lr=8.26326e-06, gnorm=3.058, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41164
2022-05-09 08:15:14 - progress_bar.py[line:272] - INFO: epoch 002:   2099 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=401.6, nsentences=32, sample_size=319.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873514, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.651, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.9, ups=0.55, wpb=401.6, bsz=32, num_updates=19780, lr=8.26206e-06, gnorm=3.824, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41182
2022-05-09 08:15:32 - progress_bar.py[line:272] - INFO: epoch 002:   2109 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.563, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.2, ups=0.56, wpb=382.1, bsz=32, num_updates=19790, lr=8.26085e-06, gnorm=3.696, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41200
2022-05-09 08:15:50 - progress_bar.py[line:272] - INFO: epoch 002:   2119 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=377.3, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.408, expert1_balance_bottom=19.417, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=210.3, ups=0.56, wpb=377.3, bsz=32, num_updates=19800, lr=8.25965e-06, gnorm=3.338, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41218
2022-05-09 08:16:08 - progress_bar.py[line:272] - INFO: epoch 002:   2129 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897579, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=33.222, expert1_balance_bottom=19.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.6, ups=0.56, wpb=381.7, bsz=32, num_updates=19810, lr=8.25845e-06, gnorm=3.543, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41236
2022-05-09 08:16:26 - progress_bar.py[line:272] - INFO: epoch 002:   2139 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=389.5, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.345, expert1_balance_bottom=19.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=215.9, ups=0.55, wpb=389.5, bsz=32, num_updates=19820, lr=8.25725e-06, gnorm=3.638, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41254
2022-05-09 08:16:44 - progress_bar.py[line:272] - INFO: epoch 002:   2149 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.929, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.2, ups=0.55, wpb=384.9, bsz=32, num_updates=19830, lr=8.25605e-06, gnorm=3.348, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41272
2022-05-09 08:17:02 - progress_bar.py[line:272] - INFO: epoch 002:   2159 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=375, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896264, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=32.666, expert1_balance_bottom=19.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=205.2, ups=0.55, wpb=375, bsz=32, num_updates=19840, lr=8.25485e-06, gnorm=3.697, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41290
2022-05-09 08:17:20 - progress_bar.py[line:272] - INFO: epoch 002:   2169 / 17711 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.951, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=32.94, expert1_balance_bottom=19.547, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=213.9, ups=0.56, wpb=380.4, bsz=32, num_updates=19850, lr=8.25365e-06, gnorm=3.092, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41308
2022-05-09 08:17:38 - progress_bar.py[line:272] - INFO: epoch 002:   2179 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=374.5, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880752, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.124, expert1_balance_bottom=19.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=207.7, ups=0.55, wpb=374.5, bsz=32, num_updates=19860, lr=8.25244e-06, gnorm=3.523, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41326
2022-05-09 08:17:56 - progress_bar.py[line:272] - INFO: epoch 002:   2189 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=380.8, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.824, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=212.8, ups=0.56, wpb=380.8, bsz=32, num_updates=19870, lr=8.25124e-06, gnorm=2.911, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41344
2022-05-09 08:18:14 - progress_bar.py[line:272] - INFO: epoch 002:   2199 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=385.8, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.279, expert1_balance_bottom=19.681, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.6, ups=0.55, wpb=385.8, bsz=32, num_updates=19880, lr=8.25004e-06, gnorm=3.447, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41362
2022-05-09 08:18:32 - progress_bar.py[line:272] - INFO: epoch 002:   2209 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901531, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=32.858, expert1_balance_bottom=19.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.1, ups=0.56, wpb=381.7, bsz=32, num_updates=19890, lr=8.24884e-06, gnorm=4.918, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41380
2022-05-09 08:18:50 - progress_bar.py[line:272] - INFO: epoch 002:   2219 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.422, expert1_balance_bottom=19.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212, ups=0.56, wpb=381.2, bsz=32, num_updates=19900, lr=8.24764e-06, gnorm=3.269, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41398
2022-05-09 08:19:07 - progress_bar.py[line:272] - INFO: epoch 002:   2229 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.72, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.668, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=218.2, ups=0.57, wpb=385.3, bsz=32, num_updates=19910, lr=8.24644e-06, gnorm=3.205, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41416
2022-05-09 08:19:25 - progress_bar.py[line:272] - INFO: epoch 002:   2239 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88565, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.643, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=214.6, ups=0.56, wpb=385.8, bsz=32, num_updates=19920, lr=8.24524e-06, gnorm=3.577, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41434
2022-05-09 08:19:43 - progress_bar.py[line:272] - INFO: epoch 002:   2249 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=377.2, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880048, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.067, expert1_balance_bottom=19.231, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=209.6, ups=0.56, wpb=377.2, bsz=32, num_updates=19930, lr=8.24404e-06, gnorm=3.336, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41451
2022-05-09 08:19:58 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 08:20:03 - progress_bar.py[line:272] - INFO: epoch 002:   2260 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896264, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.256, expert1_balance_bottom=19.564, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=191.8, ups=0.5, wpb=382.8, bsz=32, num_updates=19940, lr=8.24283e-06, gnorm=3.417, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41471
2022-05-09 08:20:22 - progress_bar.py[line:272] - INFO: epoch 002:   2270 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=380.9, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.655, expert1_balance_bottom=18.908, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.2, ups=0.55, wpb=380.9, bsz=32, num_updates=19950, lr=8.24163e-06, gnorm=3.647, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41490
2022-05-09 08:20:40 - progress_bar.py[line:272] - INFO: epoch 002:   2280 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=377.5, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891838, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.407, expert1_balance_bottom=19.486, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=208.4, ups=0.55, wpb=377.5, bsz=32, num_updates=19960, lr=8.24043e-06, gnorm=3.432, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41508
2022-05-09 08:20:58 - progress_bar.py[line:272] - INFO: epoch 002:   2290 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.413, expert1_balance_bottom=19.42, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.6, ups=0.55, wpb=383.6, bsz=32, num_updates=19970, lr=8.23923e-06, gnorm=3.188, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41526
2022-05-09 08:21:16 - progress_bar.py[line:272] - INFO: epoch 002:   2300 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=388.1, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.761, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.9, ups=0.56, wpb=388.1, bsz=32, num_updates=19980, lr=8.23803e-06, gnorm=4.014, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41544
2022-05-09 08:21:33 - progress_bar.py[line:272] - INFO: epoch 002:   2310 / 17711 loss=2.948, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.948, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.504, expert1_balance_bottom=19.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=216.9, ups=0.57, wpb=382.5, bsz=32, num_updates=19990, lr=8.23683e-06, gnorm=3.288, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41561
2022-05-09 08:21:51 - progress_bar.py[line:272] - INFO: epoch 002:   2320 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=392.9, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.125, expert1_balance_bottom=19.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.1, ups=0.56, wpb=392.9, bsz=32, num_updates=20000, lr=8.23563e-06, gnorm=3.073, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=41579
2022-05-09 08:21:51 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 08:21:51 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 08:21:51 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 08:29:16 - train.py[line:517] - INFO: valid_step finished
2022-05-09 08:29:16 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 10.069 | loss_v1 0 | loss_v2 0 | nll_loss 8.411 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.986197 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.069 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.198 | expert1_balance_top 37.713 | expert1_balance_bottom 15.041 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 340.3 | cider 1.194 | wps 677.3 | wpb 481.7 | bsz 8 | num_updates 20000 | best_cider 1.198
2022-05-09 08:29:16 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 20000 updates
2022-05-09 08:29:16 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_20000-rank-0.pt
2022-05-09 08:29:16 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_20000-rank-0.pt
2022-05-09 08:29:25 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_20000-rank-0.pt
2022-05-09 08:29:25 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_20000-shared.pt
2022-05-09 08:29:34 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_20000-shared.pt
2022-05-09 08:29:45 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_20000-rank-0.pt (epoch 2 @ 20000 updates, score 1.194) (writing took 29.5260230852291 seconds)
2022-05-09 08:30:04 - progress_bar.py[line:272] - INFO: epoch 002:   2330 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=386.4, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.181, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=7.8, ups=0.02, wpb=386.4, bsz=32, num_updates=20010, lr=8.23442e-06, gnorm=4.17, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42072
2022-05-09 08:30:22 - progress_bar.py[line:272] - INFO: epoch 002:   2340 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89026, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.398, expert1_balance_bottom=19.566, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=212.6, ups=0.56, wpb=380.5, bsz=32, num_updates=20020, lr=8.23322e-06, gnorm=3.186, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42090
2022-05-09 08:30:40 - progress_bar.py[line:272] - INFO: epoch 002:   2350 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=393.4, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.87, expert1_balance_bottom=19.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223, ups=0.57, wpb=393.4, bsz=32, num_updates=20030, lr=8.23202e-06, gnorm=3.202, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42108
2022-05-09 08:30:58 - progress_bar.py[line:272] - INFO: epoch 002:   2360 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=394.8, nsentences=32, sample_size=314.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.476, expert1_balance_bottom=18.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.2, ups=0.56, wpb=394.8, bsz=32, num_updates=20040, lr=8.23082e-06, gnorm=3.662, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42126
2022-05-09 08:31:15 - progress_bar.py[line:272] - INFO: epoch 002:   2370 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=374.5, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=32.726, expert1_balance_bottom=19.573, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=209.7, ups=0.56, wpb=374.5, bsz=32, num_updates=20050, lr=8.22962e-06, gnorm=3.123, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42143
2022-05-09 08:31:33 - progress_bar.py[line:272] - INFO: epoch 002:   2380 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=373.6, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=32.84, expert1_balance_bottom=19.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=206.8, ups=0.55, wpb=373.6, bsz=32, num_updates=20060, lr=8.22842e-06, gnorm=3.184, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42162
2022-05-09 08:31:51 - progress_bar.py[line:272] - INFO: epoch 002:   2390 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=390.2, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879594, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.093, expert1_balance_bottom=19.189, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=218.1, ups=0.56, wpb=390.2, bsz=32, num_updates=20070, lr=8.22722e-06, gnorm=3.156, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42179
2022-05-09 08:32:09 - progress_bar.py[line:272] - INFO: epoch 002:   2400 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879378, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.025, expert1_balance_bottom=19.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.4, ups=0.57, wpb=385.8, bsz=32, num_updates=20080, lr=8.22602e-06, gnorm=3.596, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42197
2022-05-09 08:32:27 - progress_bar.py[line:272] - INFO: epoch 002:   2410 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.639, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.2, ups=0.56, wpb=382.3, bsz=32, num_updates=20090, lr=8.22481e-06, gnorm=3.391, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42215
2022-05-09 08:32:45 - progress_bar.py[line:272] - INFO: epoch 002:   2420 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=385.8, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.311, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=217.6, ups=0.56, wpb=385.8, bsz=32, num_updates=20100, lr=8.22361e-06, gnorm=3.849, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42233
2022-05-09 08:33:03 - progress_bar.py[line:272] - INFO: epoch 002:   2430 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=374.9, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.403, expert1_balance_bottom=19.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=208.4, ups=0.56, wpb=374.9, bsz=32, num_updates=20110, lr=8.22241e-06, gnorm=3.681, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42251
2022-05-09 08:33:21 - progress_bar.py[line:272] - INFO: epoch 002:   2440 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=32.971, expert1_balance_bottom=19.648, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.5, ups=0.56, wpb=380.4, bsz=32, num_updates=20120, lr=8.22121e-06, gnorm=3.417, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42269
2022-05-09 08:33:38 - progress_bar.py[line:272] - INFO: epoch 002:   2450 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.56, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.7, ups=0.56, wpb=382.5, bsz=32, num_updates=20130, lr=8.22001e-06, gnorm=3.373, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42286
2022-05-09 08:33:56 - progress_bar.py[line:272] - INFO: epoch 002:   2460 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.614, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=211.2, ups=0.56, wpb=379.3, bsz=32, num_updates=20140, lr=8.21881e-06, gnorm=3.344, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42304
2022-05-09 08:34:14 - progress_bar.py[line:272] - INFO: epoch 002:   2470 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=32.853, expert1_balance_bottom=19.614, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=213.8, ups=0.56, wpb=381, bsz=32, num_updates=20150, lr=8.21761e-06, gnorm=3.063, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42322
2022-05-09 08:34:32 - progress_bar.py[line:272] - INFO: epoch 002:   2480 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=391.1, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885664, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.727, expert1_balance_bottom=19.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221.5, ups=0.57, wpb=391.1, bsz=32, num_updates=20160, lr=8.21641e-06, gnorm=3.207, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42340
2022-05-09 08:34:50 - progress_bar.py[line:272] - INFO: epoch 002:   2490 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883369, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.524, expert1_balance_bottom=19.649, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.9, ups=0.56, wpb=381.6, bsz=32, num_updates=20170, lr=8.2152e-06, gnorm=3.23, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42358
2022-05-09 08:35:07 - progress_bar.py[line:272] - INFO: epoch 002:   2500 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=380.1, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.7, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.2, ups=0.56, wpb=380.1, bsz=32, num_updates=20180, lr=8.214e-06, gnorm=3.364, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42375
2022-05-09 08:35:25 - progress_bar.py[line:272] - INFO: epoch 002:   2510 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87377, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.314, expert1_balance_bottom=19.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.4, ups=0.56, wpb=382.5, bsz=32, num_updates=20190, lr=8.2128e-06, gnorm=3.813, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42393
2022-05-09 08:35:43 - progress_bar.py[line:272] - INFO: epoch 002:   2520 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.653, expert1_balance_bottom=19.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=210.6, ups=0.55, wpb=380.5, bsz=32, num_updates=20200, lr=8.2116e-06, gnorm=3.628, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42411
2022-05-09 08:36:01 - progress_bar.py[line:272] - INFO: epoch 002:   2530 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=389.2, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875582, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.919, expert1_balance_bottom=19.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.9, ups=0.55, wpb=389.2, bsz=32, num_updates=20210, lr=8.2104e-06, gnorm=3.763, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42430
2022-05-09 08:36:19 - progress_bar.py[line:272] - INFO: epoch 002:   2540 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=375.5, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.681, expert1_balance_bottom=19.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.8, ups=0.56, wpb=375.5, bsz=32, num_updates=20220, lr=8.2092e-06, gnorm=3.773, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42447
2022-05-09 08:36:38 - progress_bar.py[line:272] - INFO: epoch 002:   2550 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=389.8, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=32.985, expert1_balance_bottom=19.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.1, ups=0.55, wpb=389.8, bsz=32, num_updates=20230, lr=8.208e-06, gnorm=3.94, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42466
2022-05-09 08:36:56 - progress_bar.py[line:272] - INFO: epoch 002:   2560 / 17711 loss=3.091, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=374.8, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.091, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.264, expert1_balance_bottom=19.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=207.8, ups=0.55, wpb=374.8, bsz=32, num_updates=20240, lr=8.20679e-06, gnorm=3.23, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42484
2022-05-09 08:37:14 - progress_bar.py[line:272] - INFO: epoch 002:   2570 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.056, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=208.8, ups=0.55, wpb=377.9, bsz=32, num_updates=20250, lr=8.20559e-06, gnorm=2.982, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42502
2022-05-09 08:37:32 - progress_bar.py[line:272] - INFO: epoch 002:   2580 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=377.3, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.088, expert1_balance_bottom=19.844, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=209.2, ups=0.55, wpb=377.3, bsz=32, num_updates=20260, lr=8.20439e-06, gnorm=3.685, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42520
2022-05-09 08:37:50 - progress_bar.py[line:272] - INFO: epoch 002:   2590 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=376.1, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=32.49, expert1_balance_bottom=19.759, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=204.5, ups=0.54, wpb=376.1, bsz=32, num_updates=20270, lr=8.20319e-06, gnorm=3.334, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42538
2022-05-09 08:38:08 - progress_bar.py[line:272] - INFO: epoch 002:   2600 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868971, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.624, expert1_balance_bottom=19.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.8, ups=0.55, wpb=380.8, bsz=32, num_updates=20280, lr=8.20199e-06, gnorm=3.428, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42556
2022-05-09 08:38:27 - progress_bar.py[line:272] - INFO: epoch 002:   2610 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.773, expert1_balance_bottom=19.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.7, ups=0.55, wpb=384.1, bsz=32, num_updates=20290, lr=8.20079e-06, gnorm=3.794, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42575
2022-05-09 08:38:44 - progress_bar.py[line:272] - INFO: epoch 002:   2620 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=379.4, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.877, expert1_balance_bottom=19.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.9, ups=0.56, wpb=379.4, bsz=32, num_updates=20300, lr=8.19959e-06, gnorm=3.624, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42592
2022-05-09 08:39:02 - progress_bar.py[line:272] - INFO: epoch 002:   2630 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=377.7, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.605, expert1_balance_bottom=19.415, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.7, ups=0.56, wpb=377.7, bsz=32, num_updates=20310, lr=8.19839e-06, gnorm=3.419, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42610
2022-05-09 08:39:20 - progress_bar.py[line:272] - INFO: epoch 002:   2640 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=380.4, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893048, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.327, expert1_balance_bottom=19.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.2, ups=0.56, wpb=380.4, bsz=32, num_updates=20320, lr=8.19718e-06, gnorm=3.211, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42628
2022-05-09 08:39:38 - progress_bar.py[line:272] - INFO: epoch 002:   2650 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888988, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.47, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.7, ups=0.56, wpb=386.1, bsz=32, num_updates=20330, lr=8.19598e-06, gnorm=3.251, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42646
2022-05-09 08:39:56 - progress_bar.py[line:272] - INFO: epoch 002:   2660 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.963, expert1_balance_bottom=19.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=214.8, ups=0.56, wpb=384.1, bsz=32, num_updates=20340, lr=8.19478e-06, gnorm=3.093, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42664
2022-05-09 08:40:14 - progress_bar.py[line:272] - INFO: epoch 002:   2670 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=377.7, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.409, expert1_balance_bottom=19.231, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=213.3, ups=0.56, wpb=377.7, bsz=32, num_updates=20350, lr=8.19358e-06, gnorm=3.181, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42682
2022-05-09 08:40:32 - progress_bar.py[line:272] - INFO: epoch 002:   2680 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=390.1, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.755, expert1_balance_bottom=19.569, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.6, ups=0.56, wpb=390.1, bsz=32, num_updates=20360, lr=8.19238e-06, gnorm=3.168, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42700
2022-05-09 08:40:49 - progress_bar.py[line:272] - INFO: epoch 002:   2690 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=376, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.085, expert1_balance_bottom=19.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.3, ups=0.56, wpb=376, bsz=32, num_updates=20370, lr=8.19118e-06, gnorm=4.718, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42717
2022-05-09 08:41:07 - progress_bar.py[line:272] - INFO: epoch 002:   2700 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=376.2, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896452, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.142, expert1_balance_bottom=19.697, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=208.9, ups=0.56, wpb=376.2, bsz=32, num_updates=20380, lr=8.18998e-06, gnorm=4.05, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42735
2022-05-09 08:41:25 - progress_bar.py[line:272] - INFO: epoch 002:   2710 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=376.7, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.144, expert1_balance_top=32.944, expert1_balance_bottom=19.823, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=207.7, ups=0.55, wpb=376.7, bsz=32, num_updates=20390, lr=8.18877e-06, gnorm=3.317, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42754
2022-05-09 08:41:44 - progress_bar.py[line:272] - INFO: epoch 002:   2720 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.819, expert1_balance_bottom=19.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209.3, ups=0.55, wpb=381.6, bsz=32, num_updates=20400, lr=8.18757e-06, gnorm=3.441, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42772
2022-05-09 08:42:02 - progress_bar.py[line:272] - INFO: epoch 002:   2730 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=379.3, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879325, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.754, expert1_balance_bottom=19.397, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=208.6, ups=0.55, wpb=379.3, bsz=32, num_updates=20410, lr=8.18637e-06, gnorm=3.047, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42790
2022-05-09 08:42:20 - progress_bar.py[line:272] - INFO: epoch 002:   2740 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=391.1, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.862717, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.909, expert1_balance_bottom=18.999, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.9, ups=0.55, wpb=391.1, bsz=32, num_updates=20420, lr=8.18517e-06, gnorm=3.57, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42808
2022-05-09 08:42:38 - progress_bar.py[line:272] - INFO: epoch 002:   2750 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=387.5, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.643, expert1_balance_bottom=19.011, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.6, ups=0.56, wpb=387.5, bsz=32, num_updates=20430, lr=8.18397e-06, gnorm=3.611, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42826
2022-05-09 08:42:56 - progress_bar.py[line:272] - INFO: epoch 002:   2760 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=381, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=32.954, expert1_balance_bottom=19.599, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=208, ups=0.55, wpb=381, bsz=32, num_updates=20440, lr=8.18277e-06, gnorm=3.433, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42844
2022-05-09 08:43:14 - progress_bar.py[line:272] - INFO: epoch 002:   2770 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889078, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.342, expert1_balance_bottom=19.547, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=211.9, ups=0.56, wpb=381.6, bsz=32, num_updates=20450, lr=8.18157e-06, gnorm=3.064, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42862
2022-05-09 08:43:32 - progress_bar.py[line:272] - INFO: epoch 002:   2780 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878148, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.462, expert1_balance_bottom=19.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=214.1, ups=0.56, wpb=383.1, bsz=32, num_updates=20460, lr=8.18037e-06, gnorm=4.02, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42880
2022-05-09 08:43:49 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 08:43:52 - progress_bar.py[line:272] - INFO: epoch 002:   2791 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=381, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.714, expert1_balance_bottom=19.446, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=189.2, ups=0.5, wpb=381, bsz=32, num_updates=20470, lr=8.17916e-06, gnorm=3.316, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42900
2022-05-09 08:44:10 - progress_bar.py[line:272] - INFO: epoch 002:   2801 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=382.7, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890318, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.268, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.2, ups=0.56, wpb=382.7, bsz=32, num_updates=20480, lr=8.17796e-06, gnorm=3.543, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42918
2022-05-09 08:44:28 - progress_bar.py[line:272] - INFO: epoch 002:   2811 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=385.3, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888553, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.608, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.8, ups=0.56, wpb=385.3, bsz=32, num_updates=20490, lr=8.17676e-06, gnorm=3.964, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42936
2022-05-09 08:44:46 - progress_bar.py[line:272] - INFO: epoch 002:   2821 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=380.4, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.813, expert1_balance_bottom=19.497, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.3, ups=0.56, wpb=380.4, bsz=32, num_updates=20500, lr=8.17556e-06, gnorm=4.079, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42954
2022-05-09 08:45:04 - progress_bar.py[line:272] - INFO: epoch 002:   2831 / 17711 loss=2.914, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=376.4, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.914, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.14, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=208.5, ups=0.55, wpb=376.4, bsz=32, num_updates=20510, lr=8.17436e-06, gnorm=3.214, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42972
2022-05-09 08:45:22 - progress_bar.py[line:272] - INFO: epoch 002:   2841 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=376.3, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887726, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.38, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.3, ups=0.56, wpb=376.3, bsz=32, num_updates=20520, lr=8.17316e-06, gnorm=3.751, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=42990
2022-05-09 08:45:40 - progress_bar.py[line:272] - INFO: epoch 002:   2851 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895044, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.122, expert1_balance_bottom=19.576, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212.2, ups=0.56, wpb=379.9, bsz=32, num_updates=20530, lr=8.17196e-06, gnorm=3.796, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43008
2022-05-09 08:45:57 - progress_bar.py[line:272] - INFO: epoch 002:   2861 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=390.5, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.298, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=221.6, ups=0.57, wpb=390.5, bsz=32, num_updates=20540, lr=8.17076e-06, gnorm=3.037, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43025
2022-05-09 08:46:16 - progress_bar.py[line:272] - INFO: epoch 002:   2871 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=383.5, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878688, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.485, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212.3, ups=0.55, wpb=383.5, bsz=32, num_updates=20550, lr=8.16955e-06, gnorm=3.307, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43044
2022-05-09 08:46:34 - progress_bar.py[line:272] - INFO: epoch 002:   2881 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=386.9, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881165, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.885, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.8, ups=0.56, wpb=386.9, bsz=32, num_updates=20560, lr=8.16835e-06, gnorm=3.407, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43062
2022-05-09 08:46:52 - progress_bar.py[line:272] - INFO: epoch 002:   2891 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=373, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897558, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.338, expert1_balance_bottom=19.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=206, ups=0.55, wpb=373, bsz=32, num_updates=20570, lr=8.16715e-06, gnorm=3.516, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43080
2022-05-09 08:47:10 - progress_bar.py[line:272] - INFO: epoch 002:   2901 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=374.8, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888779, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.324, expert1_balance_bottom=19.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=203.5, ups=0.54, wpb=374.8, bsz=32, num_updates=20580, lr=8.16595e-06, gnorm=3.339, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43098
2022-05-09 08:47:29 - progress_bar.py[line:272] - INFO: epoch 002:   2911 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871722, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.344, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=204.6, ups=0.54, wpb=378.6, bsz=32, num_updates=20590, lr=8.16475e-06, gnorm=3.647, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43117
2022-05-09 08:47:47 - progress_bar.py[line:272] - INFO: epoch 002:   2921 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.182, expert1_balance_bottom=19.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.7, ups=0.55, wpb=384.3, bsz=32, num_updates=20600, lr=8.16355e-06, gnorm=3.49, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43135
2022-05-09 08:48:05 - progress_bar.py[line:272] - INFO: epoch 002:   2931 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=392, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.228, expert1_balance_bottom=19.536, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=213.1, ups=0.54, wpb=392, bsz=32, num_updates=20610, lr=8.16235e-06, gnorm=3.013, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43153
2022-05-09 08:48:23 - progress_bar.py[line:272] - INFO: epoch 002:   2941 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=384.3, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.564, expert1_balance_bottom=19.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.9, ups=0.55, wpb=384.3, bsz=32, num_updates=20620, lr=8.16114e-06, gnorm=3.698, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43171
2022-05-09 08:48:41 - progress_bar.py[line:272] - INFO: epoch 002:   2951 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=377.7, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890192, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.455, expert1_balance_bottom=19.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=206.5, ups=0.55, wpb=377.7, bsz=32, num_updates=20630, lr=8.15994e-06, gnorm=3.418, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43189
2022-05-09 08:49:00 - progress_bar.py[line:272] - INFO: epoch 002:   2961 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=375.8, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892251, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.468, expert1_balance_bottom=19.398, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=205.6, ups=0.55, wpb=375.8, bsz=32, num_updates=20640, lr=8.15874e-06, gnorm=3.516, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43208
2022-05-09 08:49:18 - progress_bar.py[line:272] - INFO: epoch 002:   2971 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=379.7, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.627, expert1_balance_bottom=19.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.8, ups=0.56, wpb=379.7, bsz=32, num_updates=20650, lr=8.15754e-06, gnorm=3.197, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43226
2022-05-09 08:49:36 - progress_bar.py[line:272] - INFO: epoch 002:   2981 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=386.3, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877385, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.028, expert1_balance_bottom=19.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.4, ups=0.56, wpb=386.3, bsz=32, num_updates=20660, lr=8.15634e-06, gnorm=3.57, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43244
2022-05-09 08:49:53 - progress_bar.py[line:272] - INFO: epoch 002:   2991 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889974, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.476, expert1_balance_bottom=19.727, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=216, ups=0.56, wpb=386.2, bsz=32, num_updates=20670, lr=8.15514e-06, gnorm=3.66, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43261
2022-05-09 08:50:11 - progress_bar.py[line:272] - INFO: epoch 002:   3001 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.707, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.202, expert1_balance_bottom=19.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=211.7, ups=0.56, wpb=380.8, bsz=32, num_updates=20680, lr=8.15394e-06, gnorm=3.393, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43279
2022-05-09 08:50:22 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 08:50:31 - progress_bar.py[line:272] - INFO: epoch 002:   3012 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.586, expert1_balance_bottom=19.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=195.5, ups=0.51, wpb=382.3, bsz=32, num_updates=20690, lr=8.15274e-06, gnorm=3.524, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43299
2022-05-09 08:50:49 - progress_bar.py[line:272] - INFO: epoch 002:   3022 / 17711 loss=2.94, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=394.4, nsentences=32, sample_size=313.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.94, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.635, expert1_balance_bottom=19.417, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=219.8, ups=0.56, wpb=394.4, bsz=32, num_updates=20700, lr=8.15153e-06, gnorm=3.178, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43317
2022-05-09 08:51:06 - progress_bar.py[line:272] - INFO: epoch 002:   3032 / 17711 loss=2.926, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875716, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.926, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.424, expert1_balance_bottom=19.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=218.9, ups=0.57, wpb=385.1, bsz=32, num_updates=20710, lr=8.15033e-06, gnorm=3.03, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43335
2022-05-09 08:51:25 - progress_bar.py[line:272] - INFO: epoch 002:   3042 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=382, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877964, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.722, expert1_balance_bottom=19.497, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=210.8, ups=0.55, wpb=382, bsz=32, num_updates=20720, lr=8.14913e-06, gnorm=4.012, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43353
2022-05-09 08:51:43 - progress_bar.py[line:272] - INFO: epoch 002:   3052 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=389.8, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.084, expert1_balance_bottom=19.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.2, ups=0.55, wpb=389.8, bsz=32, num_updates=20730, lr=8.14793e-06, gnorm=3.478, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43371
2022-05-09 08:52:01 - progress_bar.py[line:272] - INFO: epoch 002:   3062 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882332, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.939, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=213.7, ups=0.56, wpb=384.2, bsz=32, num_updates=20740, lr=8.14673e-06, gnorm=3.621, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43389
2022-05-09 08:52:19 - progress_bar.py[line:272] - INFO: epoch 002:   3072 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=374.5, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889768, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.576, expert1_balance_bottom=19.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=209.1, ups=0.56, wpb=374.5, bsz=32, num_updates=20750, lr=8.14553e-06, gnorm=4.093, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43407
2022-05-09 08:52:36 - progress_bar.py[line:272] - INFO: epoch 002:   3082 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881215, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.652, expert1_balance_bottom=19.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.4, ups=0.56, wpb=381.9, bsz=32, num_updates=20760, lr=8.14433e-06, gnorm=3.601, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43424
2022-05-09 08:52:54 - progress_bar.py[line:272] - INFO: epoch 002:   3092 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=378.8, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.42, expert1_balance_bottom=19.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=210.6, ups=0.56, wpb=378.8, bsz=32, num_updates=20770, lr=8.14312e-06, gnorm=3.424, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43442
2022-05-09 08:53:12 - progress_bar.py[line:272] - INFO: epoch 002:   3102 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=375.6, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887359, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.829, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.5, ups=0.56, wpb=375.6, bsz=32, num_updates=20780, lr=8.14192e-06, gnorm=3.188, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43460
2022-05-09 08:53:30 - progress_bar.py[line:272] - INFO: epoch 002:   3112 / 17711 loss=2.927, loss_v1=0, loss_v2=0, nll_loss=0.697, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.927, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.962, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=211.4, ups=0.55, wpb=385.7, bsz=32, num_updates=20790, lr=8.14072e-06, gnorm=2.868, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43479
2022-05-09 08:53:49 - progress_bar.py[line:272] - INFO: epoch 002:   3122 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.451, expert1_balance_bottom=19.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=208.3, ups=0.55, wpb=381.1, bsz=32, num_updates=20800, lr=8.13952e-06, gnorm=3.465, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43497
2022-05-09 08:54:07 - progress_bar.py[line:272] - INFO: epoch 002:   3132 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886215, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.597, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.3, ups=0.55, wpb=381.2, bsz=32, num_updates=20810, lr=8.13832e-06, gnorm=3.605, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43515
2022-05-09 08:54:25 - progress_bar.py[line:272] - INFO: epoch 002:   3142 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=377.2, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884716, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.714, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210, ups=0.56, wpb=377.2, bsz=32, num_updates=20820, lr=8.13712e-06, gnorm=3.24, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43533
2022-05-09 08:54:43 - progress_bar.py[line:272] - INFO: epoch 002:   3152 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881047, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.89, expert1_balance_bottom=19.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.5, ups=0.57, wpb=381.1, bsz=32, num_updates=20830, lr=8.13592e-06, gnorm=3.473, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43551
2022-05-09 08:55:00 - progress_bar.py[line:272] - INFO: epoch 002:   3162 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=371.7, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.735, expert1_balance_bottom=19.416, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=207.9, ups=0.56, wpb=371.7, bsz=32, num_updates=20840, lr=8.13472e-06, gnorm=3.241, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43568
2022-05-09 08:55:18 - progress_bar.py[line:272] - INFO: epoch 002:   3172 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=384.8, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.021, expert1_balance_bottom=19.357, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215, ups=0.56, wpb=384.8, bsz=32, num_updates=20850, lr=8.13351e-06, gnorm=3.277, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43586
2022-05-09 08:55:36 - progress_bar.py[line:272] - INFO: epoch 002:   3182 / 17711 loss=2.923, loss_v1=0, loss_v2=0, nll_loss=0.693, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.923, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=34.072, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=211.2, ups=0.55, wpb=381.7, bsz=32, num_updates=20860, lr=8.13231e-06, gnorm=3.564, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43604
2022-05-09 08:55:54 - progress_bar.py[line:272] - INFO: epoch 002:   3192 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.584, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=213.8, ups=0.56, wpb=382.5, bsz=32, num_updates=20870, lr=8.13111e-06, gnorm=3.237, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43622
2022-05-09 08:56:12 - progress_bar.py[line:272] - INFO: epoch 002:   3202 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=387.8, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.931, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=215.1, ups=0.55, wpb=387.8, bsz=32, num_updates=20880, lr=8.12991e-06, gnorm=3.686, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43640
2022-05-09 08:56:31 - progress_bar.py[line:272] - INFO: epoch 002:   3212 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=384.4, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.488, expert1_balance_bottom=19.48, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=211.3, ups=0.55, wpb=384.4, bsz=32, num_updates=20890, lr=8.12871e-06, gnorm=3.877, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43659
2022-05-09 08:56:49 - progress_bar.py[line:272] - INFO: epoch 002:   3222 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=386.7, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.541, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=211.5, ups=0.55, wpb=386.7, bsz=32, num_updates=20900, lr=8.12751e-06, gnorm=3.79, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43677
2022-05-09 08:57:07 - progress_bar.py[line:272] - INFO: epoch 002:   3232 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=388.9, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.467, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.3, ups=0.56, wpb=388.9, bsz=32, num_updates=20910, lr=8.12631e-06, gnorm=4.342, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43695
2022-05-09 08:57:24 - progress_bar.py[line:272] - INFO: epoch 002:   3242 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880595, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.789, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216.5, ups=0.56, wpb=386.3, bsz=32, num_updates=20920, lr=8.12511e-06, gnorm=3.255, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43712
2022-05-09 08:57:42 - progress_bar.py[line:272] - INFO: epoch 002:   3252 / 17711 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891134, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.549, expert1_balance_bottom=19.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.1, ups=0.56, wpb=381.7, bsz=32, num_updates=20930, lr=8.1239e-06, gnorm=3.488, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43730
2022-05-09 08:58:00 - progress_bar.py[line:272] - INFO: epoch 002:   3262 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=382.4, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.319, expert1_balance_bottom=19.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=212.4, ups=0.56, wpb=382.4, bsz=32, num_updates=20940, lr=8.1227e-06, gnorm=3.147, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43748
2022-05-09 08:58:18 - progress_bar.py[line:272] - INFO: epoch 002:   3272 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=390.1, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.412, expert1_balance_bottom=19.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216.7, ups=0.56, wpb=390.1, bsz=32, num_updates=20950, lr=8.1215e-06, gnorm=3.612, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43766
2022-05-09 08:58:36 - progress_bar.py[line:272] - INFO: epoch 002:   3282 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.772, expert1_balance_bottom=19.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.2, ups=0.55, wpb=384.5, bsz=32, num_updates=20960, lr=8.1203e-06, gnorm=3.159, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43784
2022-05-09 08:58:54 - progress_bar.py[line:272] - INFO: epoch 002:   3292 / 17711 loss=2.948, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883344, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.948, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.815, expert1_balance_bottom=19.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=216, ups=0.57, wpb=382.3, bsz=32, num_updates=20970, lr=8.1191e-06, gnorm=3.289, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43802
2022-05-09 08:59:12 - progress_bar.py[line:272] - INFO: epoch 002:   3302 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.651, expert1_balance_bottom=19.492, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.4, ups=0.56, wpb=383.2, bsz=32, num_updates=20980, lr=8.1179e-06, gnorm=3.508, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43820
2022-05-09 08:59:29 - progress_bar.py[line:272] - INFO: epoch 002:   3312 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896162, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.321, expert1_balance_bottom=19.563, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=220.8, ups=0.57, wpb=386.3, bsz=32, num_updates=20990, lr=8.1167e-06, gnorm=3.433, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43837
2022-05-09 08:59:47 - progress_bar.py[line:272] - INFO: epoch 002:   3322 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887689, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.568, expert1_balance_bottom=19.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215.2, ups=0.56, wpb=382.7, bsz=32, num_updates=21000, lr=8.11549e-06, gnorm=3.494, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43855
2022-05-09 09:00:05 - progress_bar.py[line:272] - INFO: epoch 002:   3332 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.717, ntokens=375.3, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887614, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.882, expert1_balance_bottom=19.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=210.1, ups=0.56, wpb=375.3, bsz=32, num_updates=21010, lr=8.11429e-06, gnorm=3.967, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43873
2022-05-09 09:00:23 - progress_bar.py[line:272] - INFO: epoch 002:   3342 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=379.4, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.933, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=209.2, ups=0.55, wpb=379.4, bsz=32, num_updates=21020, lr=8.11309e-06, gnorm=3.646, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43891
2022-05-09 09:00:41 - progress_bar.py[line:272] - INFO: epoch 002:   3352 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=371.6, nsentences=32, sample_size=295.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.592, expert1_balance_bottom=19.557, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=208.9, ups=0.56, wpb=371.6, bsz=32, num_updates=21030, lr=8.11189e-06, gnorm=3.844, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43909
2022-05-09 09:00:59 - progress_bar.py[line:272] - INFO: epoch 002:   3362 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878407, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.052, expert1_balance_bottom=19.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.7, ups=0.56, wpb=386, bsz=32, num_updates=21040, lr=8.11069e-06, gnorm=3.891, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43927
2022-05-09 09:01:17 - progress_bar.py[line:272] - INFO: epoch 002:   3372 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.258, expert1_balance_bottom=19.682, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.4, ups=0.56, wpb=385.5, bsz=32, num_updates=21050, lr=8.10949e-06, gnorm=3.323, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43945
2022-05-09 09:01:34 - progress_bar.py[line:272] - INFO: epoch 002:   3382 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=376.5, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895443, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.258, expert1_balance_bottom=19.514, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.9, ups=0.56, wpb=376.5, bsz=32, num_updates=21060, lr=8.10829e-06, gnorm=3.138, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43963
2022-05-09 09:01:52 - progress_bar.py[line:272] - INFO: epoch 002:   3392 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.356, expert1_balance_bottom=19.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219, ups=0.56, wpb=388, bsz=32, num_updates=21070, lr=8.10709e-06, gnorm=3.467, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43980
2022-05-09 09:02:10 - progress_bar.py[line:272] - INFO: epoch 002:   3402 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=378.2, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87747, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.763, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=209, ups=0.55, wpb=378.2, bsz=32, num_updates=21080, lr=8.10588e-06, gnorm=4.304, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=43998
2022-05-09 09:02:28 - progress_bar.py[line:272] - INFO: epoch 002:   3412 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=388.4, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881449, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.977, expert1_balance_bottom=19.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.5, ups=0.56, wpb=388.4, bsz=32, num_updates=21090, lr=8.10468e-06, gnorm=4.193, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44016
2022-05-09 09:02:46 - progress_bar.py[line:272] - INFO: epoch 002:   3422 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.175, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.7, ups=0.56, wpb=382.5, bsz=32, num_updates=21100, lr=8.10348e-06, gnorm=3.956, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44034
2022-05-09 09:03:04 - progress_bar.py[line:272] - INFO: epoch 002:   3432 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=379.4, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878464, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.332, expert1_balance_bottom=19.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.2, ups=0.55, wpb=379.4, bsz=32, num_updates=21110, lr=8.10228e-06, gnorm=3.429, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44052
2022-05-09 09:03:23 - progress_bar.py[line:272] - INFO: epoch 002:   3442 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=381.8, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888219, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.815, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.4, ups=0.55, wpb=381.8, bsz=32, num_updates=21120, lr=8.10108e-06, gnorm=3.613, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44071
2022-05-09 09:03:41 - progress_bar.py[line:272] - INFO: epoch 002:   3452 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=383.1, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899435, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.245, expert1_balance_bottom=19.62, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212.3, ups=0.55, wpb=383.1, bsz=32, num_updates=21130, lr=8.09988e-06, gnorm=4.218, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44089
2022-05-09 09:03:59 - progress_bar.py[line:272] - INFO: epoch 002:   3462 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.054, expert1_balance_bottom=19.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214, ups=0.55, wpb=386.1, bsz=32, num_updates=21140, lr=8.09868e-06, gnorm=3.25, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44107
2022-05-09 09:04:16 - progress_bar.py[line:272] - INFO: epoch 002:   3472 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.24, expert1_balance_bottom=19.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=215.1, ups=0.56, wpb=382.8, bsz=32, num_updates=21150, lr=8.09747e-06, gnorm=2.985, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44125
2022-05-09 09:04:35 - progress_bar.py[line:272] - INFO: epoch 002:   3482 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884015, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.711, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=208.3, ups=0.55, wpb=381.5, bsz=32, num_updates=21160, lr=8.09627e-06, gnorm=3.547, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44143
2022-05-09 09:04:53 - progress_bar.py[line:272] - INFO: epoch 002:   3492 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897084, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=32.904, expert1_balance_bottom=19.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=210.4, ups=0.56, wpb=375.5, bsz=32, num_updates=21170, lr=8.09507e-06, gnorm=3.131, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44161
2022-05-09 09:05:11 - progress_bar.py[line:272] - INFO: epoch 002:   3502 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=391.5, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.717, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=216.1, ups=0.55, wpb=391.5, bsz=32, num_updates=21180, lr=8.09387e-06, gnorm=3.094, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44179
2022-05-09 09:05:29 - progress_bar.py[line:272] - INFO: epoch 002:   3512 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.339, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=211.7, ups=0.56, wpb=381.3, bsz=32, num_updates=21190, lr=8.09267e-06, gnorm=3.288, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44197
2022-05-09 09:05:47 - progress_bar.py[line:272] - INFO: epoch 002:   3522 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=371.5, nsentences=32, sample_size=295.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88476, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.227, expert1_balance_bottom=19.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=209.2, ups=0.56, wpb=371.5, bsz=32, num_updates=21200, lr=8.09147e-06, gnorm=3.503, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44215
2022-05-09 09:06:04 - progress_bar.py[line:272] - INFO: epoch 002:   3532 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.314, expert1_balance_bottom=19.548, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.2, ups=0.56, wpb=387, bsz=32, num_updates=21210, lr=8.09027e-06, gnorm=3.498, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44232
2022-05-09 09:06:22 - progress_bar.py[line:272] - INFO: epoch 002:   3542 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=377, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.5, expert1_balance_bottom=19.592, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.1, ups=0.56, wpb=377, bsz=32, num_updates=21220, lr=8.08907e-06, gnorm=3.777, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44250
2022-05-09 09:06:40 - progress_bar.py[line:272] - INFO: epoch 002:   3552 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887895, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.141, expert1_balance_bottom=19.649, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=218.1, ups=0.57, wpb=384.7, bsz=32, num_updates=21230, lr=8.08786e-06, gnorm=4.039, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44268
2022-05-09 09:06:58 - progress_bar.py[line:272] - INFO: epoch 002:   3562 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=383.5, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884597, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.731, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.6, ups=0.56, wpb=383.5, bsz=32, num_updates=21240, lr=8.08666e-06, gnorm=3.426, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44286
2022-05-09 09:07:16 - progress_bar.py[line:272] - INFO: epoch 002:   3572 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=387.1, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870826, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.588, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214.5, ups=0.55, wpb=387.1, bsz=32, num_updates=21250, lr=8.08546e-06, gnorm=3.418, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44304
2022-05-09 09:07:34 - progress_bar.py[line:272] - INFO: epoch 002:   3582 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.769, expert1_balance_bottom=19.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.6, ups=0.56, wpb=384.5, bsz=32, num_updates=21260, lr=8.08426e-06, gnorm=3.166, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44322
2022-05-09 09:07:52 - progress_bar.py[line:272] - INFO: epoch 002:   3592 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=378.3, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898843, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.143, expert1_balance_top=33.336, expert1_balance_bottom=19.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.6, ups=0.56, wpb=378.3, bsz=32, num_updates=21270, lr=8.08306e-06, gnorm=3.755, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44340
2022-05-09 09:08:10 - progress_bar.py[line:272] - INFO: epoch 002:   3602 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.07, expert1_balance_bottom=19.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214.7, ups=0.56, wpb=383.1, bsz=32, num_updates=21280, lr=8.08186e-06, gnorm=3.591, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44358
2022-05-09 09:08:28 - progress_bar.py[line:272] - INFO: epoch 002:   3612 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=378.5, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.229, expert1_balance_bottom=19.698, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.6, ups=0.56, wpb=378.5, bsz=32, num_updates=21290, lr=8.08066e-06, gnorm=3.482, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44376
2022-05-09 09:08:45 - progress_bar.py[line:272] - INFO: epoch 002:   3622 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=382.9, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.859, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.3, ups=0.56, wpb=382.9, bsz=32, num_updates=21300, lr=8.07946e-06, gnorm=3.585, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44393
2022-05-09 09:09:03 - progress_bar.py[line:272] - INFO: epoch 002:   3632 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=379.8, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.019, expert1_balance_bottom=19.722, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.4, ups=0.57, wpb=379.8, bsz=32, num_updates=21310, lr=8.07825e-06, gnorm=3.269, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44411
2022-05-09 09:09:21 - progress_bar.py[line:272] - INFO: epoch 002:   3642 / 17711 loss=3.112, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=388.8, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881134, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.112, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.052, expert1_balance_bottom=19.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218, ups=0.56, wpb=388.8, bsz=32, num_updates=21320, lr=8.07705e-06, gnorm=4.064, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44429
2022-05-09 09:09:39 - progress_bar.py[line:272] - INFO: epoch 002:   3652 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=387.3, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.34, expert1_balance_bottom=19.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211, ups=0.54, wpb=387.3, bsz=32, num_updates=21330, lr=8.07585e-06, gnorm=3.335, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44447
2022-05-09 09:09:58 - progress_bar.py[line:272] - INFO: epoch 002:   3662 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=384, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.121, expert1_balance_bottom=19.42, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=208, ups=0.54, wpb=384, bsz=32, num_updates=21340, lr=8.07465e-06, gnorm=3.868, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44466
2022-05-09 09:10:16 - progress_bar.py[line:272] - INFO: epoch 002:   3672 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.314, expert1_balance_bottom=19.567, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=211.3, ups=0.55, wpb=382.5, bsz=32, num_updates=21350, lr=8.07345e-06, gnorm=3.399, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44484
2022-05-09 09:10:34 - progress_bar.py[line:272] - INFO: epoch 002:   3682 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=378.3, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884877, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.881, expert1_balance_bottom=19.474, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.2, ups=0.55, wpb=378.3, bsz=32, num_updates=21360, lr=8.07225e-06, gnorm=3.82, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44502
2022-05-09 09:10:52 - progress_bar.py[line:272] - INFO: epoch 002:   3692 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.211, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211, ups=0.55, wpb=384.2, bsz=32, num_updates=21370, lr=8.07105e-06, gnorm=3.988, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44520
2022-05-09 09:11:10 - progress_bar.py[line:272] - INFO: epoch 002:   3702 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892783, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.567, expert1_balance_bottom=19.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=211.5, ups=0.55, wpb=382.7, bsz=32, num_updates=21380, lr=8.06984e-06, gnorm=3.801, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44538
2022-05-09 09:11:28 - progress_bar.py[line:272] - INFO: epoch 002:   3712 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=379, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883478, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.127, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211, ups=0.56, wpb=379, bsz=32, num_updates=21390, lr=8.06864e-06, gnorm=3.721, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44556
2022-05-09 09:11:46 - progress_bar.py[line:272] - INFO: epoch 002:   3722 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=387.5, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.738, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.3, ups=0.55, wpb=387.5, bsz=32, num_updates=21400, lr=8.06744e-06, gnorm=3.28, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44574
2022-05-09 09:12:04 - progress_bar.py[line:272] - INFO: epoch 002:   3732 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=381, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886099, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.622, expert1_balance_bottom=19.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.3, ups=0.56, wpb=381, bsz=32, num_updates=21410, lr=8.06624e-06, gnorm=3.801, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44592
2022-05-09 09:12:22 - progress_bar.py[line:272] - INFO: epoch 002:   3742 / 17711 loss=3.101, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=386.9, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882834, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.101, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.56, expert1_balance_bottom=19.51, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.7, ups=0.55, wpb=386.9, bsz=32, num_updates=21420, lr=8.06504e-06, gnorm=3.717, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44610
2022-05-09 09:12:40 - progress_bar.py[line:272] - INFO: epoch 002:   3752 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=386.5, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.055, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=216.1, ups=0.56, wpb=386.5, bsz=32, num_updates=21430, lr=8.06384e-06, gnorm=3.667, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44628
2022-05-09 09:12:58 - progress_bar.py[line:272] - INFO: epoch 002:   3762 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=386.4, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.698, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216, ups=0.56, wpb=386.4, bsz=32, num_updates=21440, lr=8.06264e-06, gnorm=4.249, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44646
2022-05-09 09:13:16 - progress_bar.py[line:272] - INFO: epoch 002:   3772 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=386.7, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.611, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.5, ups=0.57, wpb=386.7, bsz=32, num_updates=21450, lr=8.06144e-06, gnorm=4.154, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44664
2022-05-09 09:13:34 - progress_bar.py[line:272] - INFO: epoch 002:   3782 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878531, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.934, expert1_balance_bottom=19.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.7, ups=0.56, wpb=386.1, bsz=32, num_updates=21460, lr=8.06023e-06, gnorm=3.7, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44682
2022-05-09 09:13:52 - progress_bar.py[line:272] - INFO: epoch 002:   3792 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.609, expert1_balance_bottom=19.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.2, ups=0.55, wpb=377.5, bsz=32, num_updates=21470, lr=8.05903e-06, gnorm=3.665, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44700
2022-05-09 09:14:10 - progress_bar.py[line:272] - INFO: epoch 002:   3802 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.81, expert1_balance_bottom=19.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=209.8, ups=0.55, wpb=379.6, bsz=32, num_updates=21480, lr=8.05783e-06, gnorm=3.382, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44718
2022-05-09 09:14:27 - progress_bar.py[line:272] - INFO: epoch 002:   3812 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88597, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.838, expert1_balance_bottom=19.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=216.1, ups=0.57, wpb=381.4, bsz=32, num_updates=21490, lr=8.05663e-06, gnorm=3.221, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44735
2022-05-09 09:14:45 - progress_bar.py[line:272] - INFO: epoch 002:   3822 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=380.9, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.812, expert1_balance_bottom=19.569, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212, ups=0.56, wpb=380.9, bsz=32, num_updates=21500, lr=8.05543e-06, gnorm=3.538, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44753
2022-05-09 09:15:03 - progress_bar.py[line:272] - INFO: epoch 002:   3832 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=392.3, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868581, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.187, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216, ups=0.55, wpb=392.3, bsz=32, num_updates=21510, lr=8.05423e-06, gnorm=3.274, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44772
2022-05-09 09:15:21 - progress_bar.py[line:272] - INFO: epoch 002:   3842 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=385.5, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.535, expert1_balance_bottom=19.609, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.4, ups=0.56, wpb=385.5, bsz=32, num_updates=21520, lr=8.05303e-06, gnorm=3.215, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44789
2022-05-09 09:15:39 - progress_bar.py[line:272] - INFO: epoch 002:   3852 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=388.5, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88405, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.907, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.4, ups=0.56, wpb=388.5, bsz=32, num_updates=21530, lr=8.05182e-06, gnorm=3.49, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44807
2022-05-09 09:15:57 - progress_bar.py[line:272] - INFO: epoch 002:   3862 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=385.6, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.874, expert1_balance_bottom=19.333, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214.6, ups=0.56, wpb=385.6, bsz=32, num_updates=21540, lr=8.05062e-06, gnorm=3.909, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44825
2022-05-09 09:16:15 - progress_bar.py[line:272] - INFO: epoch 002:   3872 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=390.1, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885766, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.791, expert1_balance_bottom=19.285, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.9, ups=0.55, wpb=390.1, bsz=32, num_updates=21550, lr=8.04942e-06, gnorm=3.766, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44843
2022-05-09 09:16:33 - progress_bar.py[line:272] - INFO: epoch 002:   3882 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=382.6, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892943, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.327, expert1_balance_bottom=19.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.6, ups=0.56, wpb=382.6, bsz=32, num_updates=21560, lr=8.04822e-06, gnorm=3.437, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44861
2022-05-09 09:16:51 - progress_bar.py[line:272] - INFO: epoch 002:   3892 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.371, expert1_balance_bottom=19.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.3, ups=0.56, wpb=383.6, bsz=32, num_updates=21570, lr=8.04702e-06, gnorm=3.744, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44879
2022-05-09 09:17:09 - progress_bar.py[line:272] - INFO: epoch 002:   3902 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.979, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.8, ups=0.56, wpb=378.5, bsz=32, num_updates=21580, lr=8.04582e-06, gnorm=3.442, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44897
2022-05-09 09:17:26 - progress_bar.py[line:272] - INFO: epoch 002:   3912 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.536, expert1_balance_bottom=19.372, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.9, ups=0.56, wpb=385.3, bsz=32, num_updates=21590, lr=8.04462e-06, gnorm=3.718, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44915
2022-05-09 09:17:44 - progress_bar.py[line:272] - INFO: epoch 002:   3922 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890318, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.694, expert1_balance_bottom=19.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212.9, ups=0.56, wpb=380, bsz=32, num_updates=21600, lr=8.04342e-06, gnorm=3.887, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44932
2022-05-09 09:18:02 - progress_bar.py[line:272] - INFO: epoch 002:   3932 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=379.4, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.806, expert1_balance_bottom=19.522, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212, ups=0.56, wpb=379.4, bsz=32, num_updates=21610, lr=8.04221e-06, gnorm=4.529, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44950
2022-05-09 09:18:20 - progress_bar.py[line:272] - INFO: epoch 002:   3942 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=390.9, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.585, expert1_balance_bottom=19.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.8, ups=0.56, wpb=390.9, bsz=32, num_updates=21620, lr=8.04101e-06, gnorm=3.338, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44968
2022-05-09 09:18:38 - progress_bar.py[line:272] - INFO: epoch 002:   3952 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.925, expert1_balance_bottom=19.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=206.4, ups=0.54, wpb=379.8, bsz=32, num_updates=21630, lr=8.03981e-06, gnorm=4.122, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=44987
2022-05-09 09:18:56 - progress_bar.py[line:272] - INFO: epoch 002:   3962 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=384.8, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884226, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.171, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=213.7, ups=0.56, wpb=384.8, bsz=32, num_updates=21640, lr=8.03861e-06, gnorm=3.315, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45005
2022-05-09 09:19:15 - progress_bar.py[line:272] - INFO: epoch 002:   3972 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.556, expert1_balance_bottom=19.6, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.2, ups=0.55, wpb=382.5, bsz=32, num_updates=21650, lr=8.03741e-06, gnorm=3.481, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45023
2022-05-09 09:19:32 - progress_bar.py[line:272] - INFO: epoch 002:   3982 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.67, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.1, ups=0.56, wpb=383.6, bsz=32, num_updates=21660, lr=8.03621e-06, gnorm=3.517, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45040
2022-05-09 09:19:50 - progress_bar.py[line:272] - INFO: epoch 002:   3992 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.958, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.1, ups=0.56, wpb=384.3, bsz=32, num_updates=21670, lr=8.03501e-06, gnorm=3.278, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45058
2022-05-09 09:20:08 - progress_bar.py[line:272] - INFO: epoch 002:   4002 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.093, expert1_balance_bottom=19.455, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.1, ups=0.56, wpb=382.8, bsz=32, num_updates=21680, lr=8.03381e-06, gnorm=3.236, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45076
2022-05-09 09:20:26 - progress_bar.py[line:272] - INFO: epoch 002:   4012 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=386.5, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.845, expert1_balance_bottom=19.597, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.8, ups=0.56, wpb=386.5, bsz=32, num_updates=21690, lr=8.0326e-06, gnorm=3.459, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45094
2022-05-09 09:20:44 - progress_bar.py[line:272] - INFO: epoch 002:   4022 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=381.2, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891031, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.537, expert1_balance_bottom=19.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=209.3, ups=0.55, wpb=381.2, bsz=32, num_updates=21700, lr=8.0314e-06, gnorm=3.931, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45112
2022-05-09 09:21:02 - progress_bar.py[line:272] - INFO: epoch 002:   4032 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.3, expert1_balance_bottom=19.354, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.3, ups=0.56, wpb=384.3, bsz=32, num_updates=21710, lr=8.0302e-06, gnorm=3.259, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45130
2022-05-09 09:21:20 - progress_bar.py[line:272] - INFO: epoch 002:   4042 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=381.9, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891652, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.602, expert1_balance_bottom=19.596, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.6, ups=0.55, wpb=381.9, bsz=32, num_updates=21720, lr=8.029e-06, gnorm=4.467, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45148
2022-05-09 09:21:38 - progress_bar.py[line:272] - INFO: epoch 002:   4052 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876033, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.829, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.8, ups=0.56, wpb=383.6, bsz=32, num_updates=21730, lr=8.0278e-06, gnorm=3.56, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45166
2022-05-09 09:21:56 - progress_bar.py[line:272] - INFO: epoch 002:   4062 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=382, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877332, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.151, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=209.9, ups=0.55, wpb=382, bsz=32, num_updates=21740, lr=8.0266e-06, gnorm=3.818, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45184
2022-05-09 09:22:14 - progress_bar.py[line:272] - INFO: epoch 002:   4072 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=401.5, nsentences=32, sample_size=319.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874177, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.385, expert1_balance_bottom=19.106, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224, ups=0.56, wpb=401.5, bsz=32, num_updates=21750, lr=8.0254e-06, gnorm=3.413, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45202
2022-05-09 09:22:32 - progress_bar.py[line:272] - INFO: epoch 002:   4082 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=383.3, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.131, expert1_balance_bottom=19.592, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.1, ups=0.55, wpb=383.3, bsz=32, num_updates=21760, lr=8.02419e-06, gnorm=4.081, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45220
2022-05-09 09:22:50 - progress_bar.py[line:272] - INFO: epoch 002:   4092 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889144, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.87, expert1_balance_bottom=19.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.9, ups=0.56, wpb=381.8, bsz=32, num_updates=21770, lr=8.02299e-06, gnorm=3.597, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45238
2022-05-09 09:23:08 - progress_bar.py[line:272] - INFO: epoch 002:   4102 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=388.3, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.922, expert1_balance_bottom=19.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.8, ups=0.56, wpb=388.3, bsz=32, num_updates=21780, lr=8.02179e-06, gnorm=3.913, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45256
2022-05-09 09:23:26 - progress_bar.py[line:272] - INFO: epoch 002:   4112 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=392.9, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877624, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.892, expert1_balance_bottom=19.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=221.1, ups=0.56, wpb=392.9, bsz=32, num_updates=21790, lr=8.02059e-06, gnorm=3.982, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45274
2022-05-09 09:23:43 - progress_bar.py[line:272] - INFO: epoch 002:   4122 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.46, expert1_balance_bottom=19.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.1, ups=0.57, wpb=381, bsz=32, num_updates=21800, lr=8.01939e-06, gnorm=3.612, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45291
2022-05-09 09:24:01 - progress_bar.py[line:272] - INFO: epoch 002:   4132 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88791, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.419, expert1_balance_bottom=19.637, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.7, ups=0.55, wpb=383.8, bsz=32, num_updates=21810, lr=8.01819e-06, gnorm=3.512, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45309
2022-05-09 09:24:19 - progress_bar.py[line:272] - INFO: epoch 002:   4142 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=386.9, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892173, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.492, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216.2, ups=0.56, wpb=386.9, bsz=32, num_updates=21820, lr=8.01699e-06, gnorm=3.85, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45327
2022-05-09 09:24:37 - progress_bar.py[line:272] - INFO: epoch 002:   4152 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880273, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.036, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.1, ups=0.56, wpb=387, bsz=32, num_updates=21830, lr=8.01579e-06, gnorm=3.506, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45345
2022-05-09 09:24:55 - progress_bar.py[line:272] - INFO: epoch 002:   4162 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.019, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213, ups=0.56, wpb=382.5, bsz=32, num_updates=21840, lr=8.01458e-06, gnorm=3.625, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45363
2022-05-09 09:25:13 - progress_bar.py[line:272] - INFO: epoch 002:   4172 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.168, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.7, ups=0.57, wpb=381.3, bsz=32, num_updates=21850, lr=8.01338e-06, gnorm=3.786, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45381
2022-05-09 09:25:30 - progress_bar.py[line:272] - INFO: epoch 002:   4182 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.157, expert1_balance_bottom=19.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.9, ups=0.57, wpb=380.7, bsz=32, num_updates=21860, lr=8.01218e-06, gnorm=4.318, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45398
2022-05-09 09:25:48 - progress_bar.py[line:272] - INFO: epoch 002:   4192 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.161, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215.5, ups=0.56, wpb=381.5, bsz=32, num_updates=21870, lr=8.01098e-06, gnorm=3.269, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45416
2022-05-09 09:26:06 - progress_bar.py[line:272] - INFO: epoch 002:   4202 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=390.6, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878173, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.146, expert1_balance_bottom=19.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.8, ups=0.56, wpb=390.6, bsz=32, num_updates=21880, lr=8.00978e-06, gnorm=4.072, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45434
2022-05-09 09:26:24 - progress_bar.py[line:272] - INFO: epoch 002:   4212 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.849, expert1_balance_bottom=19.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=213.6, ups=0.56, wpb=383.4, bsz=32, num_updates=21890, lr=8.00858e-06, gnorm=3.463, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45452
2022-05-09 09:26:42 - progress_bar.py[line:272] - INFO: epoch 002:   4222 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=379.5, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.707, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.5, ups=0.56, wpb=379.5, bsz=32, num_updates=21900, lr=8.00738e-06, gnorm=3.538, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45470
2022-05-09 09:27:00 - progress_bar.py[line:272] - INFO: epoch 002:   4232 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892684, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.718, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.5, ups=0.56, wpb=383.3, bsz=32, num_updates=21910, lr=8.00617e-06, gnorm=3.622, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45488
2022-05-09 09:27:18 - progress_bar.py[line:272] - INFO: epoch 002:   4242 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.751, expert1_balance_bottom=19.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=208.2, ups=0.55, wpb=378.7, bsz=32, num_updates=21920, lr=8.00497e-06, gnorm=3.752, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45506
2022-05-09 09:27:36 - progress_bar.py[line:272] - INFO: epoch 002:   4252 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=387.1, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877325, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.492, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.4, ups=0.55, wpb=387.1, bsz=32, num_updates=21930, lr=8.00377e-06, gnorm=3.403, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45524
2022-05-09 09:27:54 - progress_bar.py[line:272] - INFO: epoch 002:   4262 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887304, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.817, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209.1, ups=0.55, wpb=377.1, bsz=32, num_updates=21940, lr=8.00257e-06, gnorm=3.856, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45542
2022-05-09 09:28:12 - progress_bar.py[line:272] - INFO: epoch 002:   4272 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886613, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.92, expert1_balance_bottom=19.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=208.8, ups=0.55, wpb=380.4, bsz=32, num_updates=21950, lr=8.00137e-06, gnorm=3.207, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45560
2022-05-09 09:28:30 - progress_bar.py[line:272] - INFO: epoch 002:   4282 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892614, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.712, expert1_balance_bottom=19.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.3, ups=0.56, wpb=381.7, bsz=32, num_updates=21960, lr=8.00017e-06, gnorm=3.561, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45578
2022-05-09 09:28:48 - progress_bar.py[line:272] - INFO: epoch 002:   4292 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88704, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.974, expert1_balance_bottom=19.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.1, ups=0.56, wpb=388.1, bsz=32, num_updates=21970, lr=7.99897e-06, gnorm=3.519, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45596
2022-05-09 09:29:06 - progress_bar.py[line:272] - INFO: epoch 002:   4302 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=393.2, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.987, expert1_balance_bottom=18.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=220.5, ups=0.56, wpb=393.2, bsz=32, num_updates=21980, lr=7.99777e-06, gnorm=3.697, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45614
2022-05-09 09:29:24 - progress_bar.py[line:272] - INFO: epoch 002:   4312 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=391, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872315, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=35.288, expert1_balance_bottom=18.818, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221.2, ups=0.57, wpb=391, bsz=32, num_updates=21990, lr=7.99656e-06, gnorm=3.8, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45632
2022-05-09 09:29:41 - progress_bar.py[line:272] - INFO: epoch 002:   4322 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=386.2, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.332, expert1_balance_bottom=19.537, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217, ups=0.56, wpb=386.2, bsz=32, num_updates=22000, lr=7.99536e-06, gnorm=3.866, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=45649
2022-05-09 09:29:41 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 09:29:41 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 09:29:41 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 09:37:07 - train.py[line:517] - INFO: valid_step finished
2022-05-09 09:37:07 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 9.805 | loss_v1 0 | loss_v2 0 | nll_loss 8.132 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.990235 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.805 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.194 | expert1_balance_top 38.814 | expert1_balance_bottom 15.182 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 280.6 | cider 1.193 | wps 676.5 | wpb 481.7 | bsz 8 | num_updates 22000 | best_cider 1.198
2022-05-09 09:37:25 - progress_bar.py[line:272] - INFO: epoch 002:   4332 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885968, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.906, expert1_balance_bottom=19.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=8.2, ups=0.02, wpb=379.7, bsz=32, num_updates=22010, lr=7.99416e-06, gnorm=3.294, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46113
2022-05-09 09:37:43 - progress_bar.py[line:272] - INFO: epoch 002:   4342 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=375.7, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890791, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.841, expert1_balance_bottom=19.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.4, ups=0.57, wpb=375.7, bsz=32, num_updates=22020, lr=7.99296e-06, gnorm=3.147, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46131
2022-05-09 09:38:01 - progress_bar.py[line:272] - INFO: epoch 002:   4352 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884461, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.251, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.1, ups=0.55, wpb=386.5, bsz=32, num_updates=22030, lr=7.99176e-06, gnorm=3.799, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46149
2022-05-09 09:38:19 - progress_bar.py[line:272] - INFO: epoch 002:   4362 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=388.7, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882974, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.033, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.4, ups=0.56, wpb=388.7, bsz=32, num_updates=22040, lr=7.99056e-06, gnorm=3.584, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46167
2022-05-09 09:38:37 - progress_bar.py[line:272] - INFO: epoch 002:   4372 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882118, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.121, expert1_balance_bottom=19.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209, ups=0.55, wpb=376.7, bsz=32, num_updates=22050, lr=7.98936e-06, gnorm=3.828, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46185
2022-05-09 09:38:54 - progress_bar.py[line:272] - INFO: epoch 002:   4382 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=388, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=35.293, expert1_balance_bottom=18.984, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.6, ups=0.57, wpb=388, bsz=32, num_updates=22060, lr=7.98816e-06, gnorm=3.708, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46202
2022-05-09 09:39:12 - progress_bar.py[line:272] - INFO: epoch 002:   4392 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=384.1, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889684, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.577, expert1_balance_bottom=19.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.7, ups=0.56, wpb=384.1, bsz=32, num_updates=22070, lr=7.98695e-06, gnorm=3.627, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46220
2022-05-09 09:39:30 - progress_bar.py[line:272] - INFO: epoch 002:   4402 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=376.4, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891261, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.756, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=212, ups=0.56, wpb=376.4, bsz=32, num_updates=22080, lr=7.98575e-06, gnorm=3.135, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46238
2022-05-09 09:39:48 - progress_bar.py[line:272] - INFO: epoch 002:   4412 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.552, expert1_balance_bottom=19.287, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.6, ups=0.55, wpb=380.5, bsz=32, num_updates=22090, lr=7.98455e-06, gnorm=3.622, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46256
2022-05-09 09:40:06 - progress_bar.py[line:272] - INFO: epoch 002:   4422 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.934, expert1_balance_bottom=19.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=217.6, ups=0.56, wpb=385.4, bsz=32, num_updates=22100, lr=7.98335e-06, gnorm=3.329, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46274
2022-05-09 09:40:24 - progress_bar.py[line:272] - INFO: epoch 002:   4432 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=383.7, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877356, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.479, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=210.3, ups=0.55, wpb=383.7, bsz=32, num_updates=22110, lr=7.98215e-06, gnorm=3.694, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46292
2022-05-09 09:40:42 - progress_bar.py[line:272] - INFO: epoch 002:   4442 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=372.8, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.285, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.5, ups=0.56, wpb=372.8, bsz=32, num_updates=22120, lr=7.98095e-06, gnorm=3.22, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46310
2022-05-09 09:41:00 - progress_bar.py[line:272] - INFO: epoch 002:   4452 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=380.7, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889687, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.572, expert1_balance_bottom=19.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=212.5, ups=0.56, wpb=380.7, bsz=32, num_updates=22130, lr=7.97975e-06, gnorm=3.511, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46328
2022-05-09 09:41:18 - progress_bar.py[line:272] - INFO: epoch 002:   4462 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=379.9, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881493, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.956, expert1_balance_bottom=19.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.6, ups=0.56, wpb=379.9, bsz=32, num_updates=22140, lr=7.97854e-06, gnorm=3.525, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46346
2022-05-09 09:41:35 - progress_bar.py[line:272] - INFO: epoch 002:   4472 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=372.6, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899531, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.432, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.9, ups=0.56, wpb=372.6, bsz=32, num_updates=22150, lr=7.97734e-06, gnorm=3.627, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46364
2022-05-09 09:41:48 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 09:41:55 - progress_bar.py[line:272] - INFO: epoch 002:   4483 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=33.276, expert1_balance_bottom=19.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=189.8, ups=0.51, wpb=375.5, bsz=32, num_updates=22160, lr=7.97614e-06, gnorm=3.703, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46383
2022-05-09 09:42:14 - progress_bar.py[line:272] - INFO: epoch 002:   4493 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=385.8, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889094, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.422, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=210.4, ups=0.55, wpb=385.8, bsz=32, num_updates=22170, lr=7.97494e-06, gnorm=3.262, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46402
2022-05-09 09:42:32 - progress_bar.py[line:272] - INFO: epoch 002:   4503 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=391.1, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874416, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.295, expert1_balance_bottom=19.039, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=214.2, ups=0.55, wpb=391.1, bsz=32, num_updates=22180, lr=7.97374e-06, gnorm=4.094, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46420
2022-05-09 09:42:50 - progress_bar.py[line:272] - INFO: epoch 002:   4513 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=379.7, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885741, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.685, expert1_balance_bottom=19.377, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=209.8, ups=0.55, wpb=379.7, bsz=32, num_updates=22190, lr=7.97254e-06, gnorm=3.276, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46438
2022-05-09 09:43:08 - progress_bar.py[line:272] - INFO: epoch 002:   4523 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.04, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.4, ups=0.55, wpb=384.1, bsz=32, num_updates=22200, lr=7.97134e-06, gnorm=3.402, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46456
2022-05-09 09:43:26 - progress_bar.py[line:272] - INFO: epoch 002:   4533 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898268, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.142, expert1_balance_top=32.978, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214.3, ups=0.56, wpb=384.5, bsz=32, num_updates=22210, lr=7.97014e-06, gnorm=3.339, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46474
2022-05-09 09:43:44 - progress_bar.py[line:272] - INFO: epoch 002:   4543 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89453, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.073, expert1_balance_bottom=19.647, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.9, ups=0.56, wpb=377.8, bsz=32, num_updates=22220, lr=7.96893e-06, gnorm=3.657, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46492
2022-05-09 09:44:02 - progress_bar.py[line:272] - INFO: epoch 002:   4553 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=385.7, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888716, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.186, expert1_balance_bottom=19.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.1, ups=0.56, wpb=385.7, bsz=32, num_updates=22230, lr=7.96773e-06, gnorm=3.54, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46510
2022-05-09 09:44:19 - progress_bar.py[line:272] - INFO: epoch 002:   4563 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.497, expert1_balance_bottom=19.6, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.1, ups=0.56, wpb=382.7, bsz=32, num_updates=22240, lr=7.96653e-06, gnorm=3.653, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46527
2022-05-09 09:44:37 - progress_bar.py[line:272] - INFO: epoch 002:   4573 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=374.8, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.236, expert1_balance_bottom=19.583, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=208.9, ups=0.56, wpb=374.8, bsz=32, num_updates=22250, lr=7.96533e-06, gnorm=3.538, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46545
2022-05-09 09:44:55 - progress_bar.py[line:272] - INFO: epoch 002:   4583 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=375.7, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.907793, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.146, expert1_balance_top=32.436, expert1_balance_bottom=19.75, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.9, ups=0.56, wpb=375.7, bsz=32, num_updates=22260, lr=7.96413e-06, gnorm=3.132, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46563
2022-05-09 09:45:13 - progress_bar.py[line:272] - INFO: epoch 002:   4593 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=386.8, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.935, expert1_balance_bottom=19.42, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.9, ups=0.55, wpb=386.8, bsz=32, num_updates=22270, lr=7.96293e-06, gnorm=4.074, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46581
2022-05-09 09:45:31 - progress_bar.py[line:272] - INFO: epoch 002:   4603 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=382.4, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891039, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.332, expert1_balance_bottom=19.584, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212.2, ups=0.55, wpb=382.4, bsz=32, num_updates=22280, lr=7.96173e-06, gnorm=3.495, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46599
2022-05-09 09:45:50 - progress_bar.py[line:272] - INFO: epoch 002:   4613 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=376.3, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883289, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.322, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=206.3, ups=0.55, wpb=376.3, bsz=32, num_updates=22290, lr=7.96052e-06, gnorm=3.728, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46618
2022-05-09 09:46:08 - progress_bar.py[line:272] - INFO: epoch 002:   4623 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=367.2, nsentences=32, sample_size=292.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.506, expert1_balance_bottom=19.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=203, ups=0.55, wpb=367.2, bsz=32, num_updates=22300, lr=7.95932e-06, gnorm=3.317, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46636
2022-05-09 09:46:26 - progress_bar.py[line:272] - INFO: epoch 002:   4633 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=381.2, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.128, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.7, ups=0.55, wpb=381.2, bsz=32, num_updates=22310, lr=7.95812e-06, gnorm=3.125, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46654
2022-05-09 09:46:44 - progress_bar.py[line:272] - INFO: epoch 002:   4643 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=385.1, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884469, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.153, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.1, ups=0.56, wpb=385.1, bsz=32, num_updates=22320, lr=7.95692e-06, gnorm=4.037, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46672
2022-05-09 09:47:01 - progress_bar.py[line:272] - INFO: epoch 002:   4653 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=387.5, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87405, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.722, expert1_balance_bottom=19.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.2, ups=0.56, wpb=387.5, bsz=32, num_updates=22330, lr=7.95572e-06, gnorm=3.547, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46689
2022-05-09 09:47:20 - progress_bar.py[line:272] - INFO: epoch 002:   4663 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=392.7, nsentences=32, sample_size=312.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.975, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.9, ups=0.55, wpb=392.7, bsz=32, num_updates=22340, lr=7.95452e-06, gnorm=3.173, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46708
2022-05-09 09:47:38 - progress_bar.py[line:272] - INFO: epoch 002:   4673 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=388.8, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879396, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.293, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212.2, ups=0.55, wpb=388.8, bsz=32, num_updates=22350, lr=7.95332e-06, gnorm=3.05, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46726
2022-05-09 09:47:56 - progress_bar.py[line:272] - INFO: epoch 002:   4683 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889718, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.524, expert1_balance_bottom=19.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=208.5, ups=0.55, wpb=380.5, bsz=32, num_updates=22360, lr=7.95212e-06, gnorm=4.434, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46744
2022-05-09 09:48:14 - progress_bar.py[line:272] - INFO: epoch 002:   4693 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=388.5, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883512, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.667, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.2, ups=0.55, wpb=388.5, bsz=32, num_updates=22370, lr=7.95091e-06, gnorm=3.866, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46762
2022-05-09 09:48:32 - progress_bar.py[line:272] - INFO: epoch 002:   4703 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=374.2, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.515, expert1_balance_bottom=19.433, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.4, ups=0.55, wpb=374.2, bsz=32, num_updates=22380, lr=7.94971e-06, gnorm=3.906, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46780
2022-05-09 09:48:50 - progress_bar.py[line:272] - INFO: epoch 002:   4713 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=384.2, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.999, expert1_balance_bottom=19.308, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.7, ups=0.56, wpb=384.2, bsz=32, num_updates=22390, lr=7.94851e-06, gnorm=3.31, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46798
2022-05-09 09:49:08 - progress_bar.py[line:272] - INFO: epoch 002:   4723 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=371.9, nsentences=32, sample_size=295.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897871, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=32.987, expert1_balance_bottom=19.757, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=207.1, ups=0.56, wpb=371.9, bsz=32, num_updates=22400, lr=7.94731e-06, gnorm=2.942, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46816
2022-05-09 09:49:26 - progress_bar.py[line:272] - INFO: epoch 002:   4733 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.975, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.1, ups=0.55, wpb=383.3, bsz=32, num_updates=22410, lr=7.94611e-06, gnorm=3.332, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46834
2022-05-09 09:49:44 - progress_bar.py[line:272] - INFO: epoch 002:   4743 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.858, expert1_balance_bottom=19.46, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=214.4, ups=0.56, wpb=381.5, bsz=32, num_updates=22420, lr=7.94491e-06, gnorm=3.263, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46852
2022-05-09 09:50:02 - progress_bar.py[line:272] - INFO: epoch 002:   4753 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=382.7, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888065, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.689, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.7, ups=0.56, wpb=382.7, bsz=32, num_updates=22430, lr=7.94371e-06, gnorm=3.634, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46870
2022-05-09 09:50:20 - progress_bar.py[line:272] - INFO: epoch 002:   4763 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=377.3, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879901, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.085, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=211.4, ups=0.56, wpb=377.3, bsz=32, num_updates=22440, lr=7.9425e-06, gnorm=3.143, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46888
2022-05-09 09:50:38 - progress_bar.py[line:272] - INFO: epoch 002:   4773 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=383.7, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887931, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.833, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217, ups=0.57, wpb=383.7, bsz=32, num_updates=22450, lr=7.9413e-06, gnorm=3.537, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46906
2022-05-09 09:50:55 - progress_bar.py[line:272] - INFO: epoch 002:   4783 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=383.6, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900619, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=32.797, expert1_balance_bottom=19.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215.6, ups=0.56, wpb=383.6, bsz=32, num_updates=22460, lr=7.9401e-06, gnorm=3.564, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46924
2022-05-09 09:51:13 - progress_bar.py[line:272] - INFO: epoch 002:   4793 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=379.4, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.984, expert1_balance_bottom=19.308, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.7, ups=0.56, wpb=379.4, bsz=32, num_updates=22470, lr=7.9389e-06, gnorm=3.307, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46941
2022-05-09 09:51:31 - progress_bar.py[line:272] - INFO: epoch 002:   4803 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=377.6, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.233, expert1_balance_bottom=19.651, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215, ups=0.57, wpb=377.6, bsz=32, num_updates=22480, lr=7.9377e-06, gnorm=3.398, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46959
2022-05-09 09:51:49 - progress_bar.py[line:272] - INFO: epoch 002:   4813 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=376.9, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.399, expert1_balance_bottom=19.551, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.9, ups=0.56, wpb=376.9, bsz=32, num_updates=22490, lr=7.9365e-06, gnorm=3.191, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46977
2022-05-09 09:52:06 - progress_bar.py[line:272] - INFO: epoch 002:   4823 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=388.3, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882717, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.831, expert1_balance_bottom=19.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.4, ups=0.56, wpb=388.3, bsz=32, num_updates=22500, lr=7.9353e-06, gnorm=2.902, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=46994
2022-05-09 09:52:24 - progress_bar.py[line:272] - INFO: epoch 002:   4833 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=386.7, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.514, expert1_balance_bottom=19.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.6, ups=0.57, wpb=386.7, bsz=32, num_updates=22510, lr=7.9341e-06, gnorm=3.523, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47012
2022-05-09 09:52:42 - progress_bar.py[line:272] - INFO: epoch 002:   4843 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.466, expert1_balance_bottom=19.168, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.3, ups=0.57, wpb=384.9, bsz=32, num_updates=22520, lr=7.93289e-06, gnorm=3.737, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47030
2022-05-09 09:53:00 - progress_bar.py[line:272] - INFO: epoch 002:   4853 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=34.144, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.9, ups=0.55, wpb=380.3, bsz=32, num_updates=22530, lr=7.93169e-06, gnorm=3.339, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47048
2022-05-09 09:53:18 - progress_bar.py[line:272] - INFO: epoch 002:   4863 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=393.1, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879181, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.627, expert1_balance_bottom=19.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=216.6, ups=0.55, wpb=393.1, bsz=32, num_updates=22540, lr=7.93049e-06, gnorm=4.058, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47066
2022-05-09 09:53:36 - progress_bar.py[line:272] - INFO: epoch 002:   4873 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=380.4, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889693, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.536, expert1_balance_bottom=19.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=208, ups=0.55, wpb=380.4, bsz=32, num_updates=22550, lr=7.92929e-06, gnorm=3.516, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47084
2022-05-09 09:53:54 - progress_bar.py[line:272] - INFO: epoch 002:   4883 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=383.8, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886225, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.868, expert1_balance_bottom=19.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210, ups=0.55, wpb=383.8, bsz=32, num_updates=22560, lr=7.92809e-06, gnorm=3.173, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47102
2022-05-09 09:54:12 - progress_bar.py[line:272] - INFO: epoch 002:   4893 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=379.9, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881526, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.236, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.7, ups=0.55, wpb=379.9, bsz=32, num_updates=22570, lr=7.92689e-06, gnorm=3.379, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47121
2022-05-09 09:54:30 - progress_bar.py[line:272] - INFO: epoch 002:   4903 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=380.6, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.484, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.5, ups=0.56, wpb=380.6, bsz=32, num_updates=22580, lr=7.92569e-06, gnorm=3.348, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47138
2022-05-09 09:54:49 - progress_bar.py[line:272] - INFO: epoch 002:   4913 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.15, expert1_balance_bottom=19.675, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210.1, ups=0.55, wpb=383.3, bsz=32, num_updates=22590, lr=7.92449e-06, gnorm=3.104, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47157
2022-05-09 09:55:06 - progress_bar.py[line:272] - INFO: epoch 002:   4923 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=382.3, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.04, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.1, ups=0.57, wpb=382.3, bsz=32, num_updates=22600, lr=7.92328e-06, gnorm=3.714, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47174
2022-05-09 09:55:24 - progress_bar.py[line:272] - INFO: epoch 002:   4933 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878756, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.338, expert1_balance_bottom=19.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.9, ups=0.56, wpb=379.6, bsz=32, num_updates=22610, lr=7.92208e-06, gnorm=3.24, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47192
2022-05-09 09:55:42 - progress_bar.py[line:272] - INFO: epoch 002:   4943 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=388.7, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872599, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.645, expert1_balance_bottom=19.162, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.7, ups=0.57, wpb=388.7, bsz=32, num_updates=22620, lr=7.92088e-06, gnorm=3.469, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47210
2022-05-09 09:56:00 - progress_bar.py[line:272] - INFO: epoch 002:   4953 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=385.1, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895977, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=32.953, expert1_balance_bottom=19.741, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.3, ups=0.56, wpb=385.1, bsz=32, num_updates=22630, lr=7.91968e-06, gnorm=3.365, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47228
2022-05-09 09:56:18 - progress_bar.py[line:272] - INFO: epoch 002:   4963 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=381.7, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.65, expert1_balance_bottom=19.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=213.7, ups=0.56, wpb=381.7, bsz=32, num_updates=22640, lr=7.91848e-06, gnorm=3.338, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47246
2022-05-09 09:56:36 - progress_bar.py[line:272] - INFO: epoch 002:   4973 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887232, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.008, expert1_balance_bottom=19.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=215.4, ups=0.56, wpb=385, bsz=32, num_updates=22650, lr=7.91728e-06, gnorm=3.128, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47264
2022-05-09 09:56:54 - progress_bar.py[line:272] - INFO: epoch 002:   4983 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893109, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.495, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=210.7, ups=0.56, wpb=378.2, bsz=32, num_updates=22660, lr=7.91608e-06, gnorm=3.466, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47282
2022-05-09 09:57:12 - progress_bar.py[line:272] - INFO: epoch 002:   4993 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885416, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.844, expert1_balance_bottom=19.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.3, ups=0.55, wpb=379.2, bsz=32, num_updates=22670, lr=7.91487e-06, gnorm=3.297, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47300
2022-05-09 09:57:29 - progress_bar.py[line:272] - INFO: epoch 002:   5003 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882573, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.932, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.3, ups=0.56, wpb=383.1, bsz=32, num_updates=22680, lr=7.91367e-06, gnorm=3.36, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47317
2022-05-09 09:57:47 - progress_bar.py[line:272] - INFO: epoch 002:   5013 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884196, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.577, expert1_balance_bottom=19.479, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=215.3, ups=0.57, wpb=380.4, bsz=32, num_updates=22690, lr=7.91247e-06, gnorm=3.135, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47335
2022-05-09 09:58:05 - progress_bar.py[line:272] - INFO: epoch 002:   5023 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=377.3, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886179, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.188, expert1_balance_bottom=19.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=210.2, ups=0.56, wpb=377.3, bsz=32, num_updates=22700, lr=7.91127e-06, gnorm=3.512, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47353
2022-05-09 09:58:23 - progress_bar.py[line:272] - INFO: epoch 002:   5033 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.003, expert1_balance_bottom=19.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.5, ups=0.56, wpb=384.3, bsz=32, num_updates=22710, lr=7.91007e-06, gnorm=3.354, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47371
2022-05-09 09:58:41 - progress_bar.py[line:272] - INFO: epoch 002:   5043 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=386, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890344, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.647, expert1_balance_bottom=19.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.6, ups=0.56, wpb=386, bsz=32, num_updates=22720, lr=7.90887e-06, gnorm=3.235, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47389
2022-05-09 09:58:59 - progress_bar.py[line:272] - INFO: epoch 002:   5053 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=381, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.284, expert1_balance_bottom=19.606, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.3, ups=0.55, wpb=381, bsz=32, num_updates=22730, lr=7.90767e-06, gnorm=3.623, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47407
2022-05-09 09:59:17 - progress_bar.py[line:272] - INFO: epoch 002:   5063 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=379.9, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.796, expert1_balance_bottom=19.503, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210.5, ups=0.55, wpb=379.9, bsz=32, num_updates=22740, lr=7.90647e-06, gnorm=3.761, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47425
2022-05-09 09:59:35 - progress_bar.py[line:272] - INFO: epoch 002:   5073 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=375.7, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.015, expert1_balance_bottom=19.497, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.9, ups=0.56, wpb=375.7, bsz=32, num_updates=22750, lr=7.90526e-06, gnorm=3.874, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47443
2022-05-09 09:59:53 - progress_bar.py[line:272] - INFO: epoch 002:   5083 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.477, expert1_balance_bottom=19.604, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.1, ups=0.56, wpb=384.3, bsz=32, num_updates=22760, lr=7.90406e-06, gnorm=3.135, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47461
2022-05-09 10:00:10 - progress_bar.py[line:272] - INFO: epoch 002:   5093 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=384.4, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.397, expert1_balance_bottom=19.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215, ups=0.56, wpb=384.4, bsz=32, num_updates=22770, lr=7.90286e-06, gnorm=2.929, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47478
2022-05-09 10:00:28 - progress_bar.py[line:272] - INFO: epoch 002:   5103 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889888, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.276, expert1_balance_bottom=19.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.2, ups=0.57, wpb=382.2, bsz=32, num_updates=22780, lr=7.90166e-06, gnorm=3.698, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47496
2022-05-09 10:00:46 - progress_bar.py[line:272] - INFO: epoch 002:   5113 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=384.6, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880819, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.473, expert1_balance_bottom=19.647, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.1, ups=0.56, wpb=384.6, bsz=32, num_updates=22790, lr=7.90046e-06, gnorm=3.026, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47514
2022-05-09 10:01:04 - progress_bar.py[line:272] - INFO: epoch 002:   5123 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.059, expert1_balance_bottom=19.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.6, ups=0.55, wpb=384.2, bsz=32, num_updates=22800, lr=7.89926e-06, gnorm=3.315, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47532
2022-05-09 10:01:22 - progress_bar.py[line:272] - INFO: epoch 002:   5133 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=388.6, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.422, expert1_balance_bottom=19.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=212.2, ups=0.55, wpb=388.6, bsz=32, num_updates=22810, lr=7.89806e-06, gnorm=3.367, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47550
2022-05-09 10:01:40 - progress_bar.py[line:272] - INFO: epoch 002:   5143 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=393.8, nsentences=32, sample_size=313.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876775, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.93, expert1_balance_bottom=19.446, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.6, ups=0.56, wpb=393.8, bsz=32, num_updates=22820, lr=7.89685e-06, gnorm=3.787, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47568
2022-05-09 10:01:58 - progress_bar.py[line:272] - INFO: epoch 002:   5153 / 17711 loss=2.909, loss_v1=0, loss_v2=0, nll_loss=0.681, ntokens=388.9, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.909, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.662, expert1_balance_bottom=19.593, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=214.6, ups=0.55, wpb=388.9, bsz=32, num_updates=22830, lr=7.89565e-06, gnorm=3.217, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47586
2022-05-09 10:02:16 - progress_bar.py[line:272] - INFO: epoch 002:   5163 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=33.316, expert1_balance_bottom=19.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.8, ups=0.56, wpb=382.9, bsz=32, num_updates=22840, lr=7.89445e-06, gnorm=3.321, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47604
2022-05-09 10:02:34 - progress_bar.py[line:272] - INFO: epoch 002:   5173 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=390.9, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877673, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.819, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.5, ups=0.56, wpb=390.9, bsz=32, num_updates=22850, lr=7.89325e-06, gnorm=3.392, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47622
2022-05-09 10:02:52 - progress_bar.py[line:272] - INFO: epoch 002:   5183 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893269, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.555, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215, ups=0.57, wpb=380.4, bsz=32, num_updates=22860, lr=7.89205e-06, gnorm=3.53, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47640
2022-05-09 10:03:09 - progress_bar.py[line:272] - INFO: epoch 002:   5193 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=383.4, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.739, expert1_balance_bottom=18.994, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218, ups=0.57, wpb=383.4, bsz=32, num_updates=22870, lr=7.89085e-06, gnorm=3.221, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47657
2022-05-09 10:03:27 - progress_bar.py[line:272] - INFO: epoch 002:   5203 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878241, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.796, expert1_balance_bottom=19.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=216.2, ups=0.56, wpb=388, bsz=32, num_updates=22880, lr=7.88965e-06, gnorm=3.955, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47675
2022-05-09 10:03:45 - progress_bar.py[line:272] - INFO: epoch 002:   5213 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=389.5, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.479, expert1_balance_bottom=19.637, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.4, ups=0.57, wpb=389.5, bsz=32, num_updates=22890, lr=7.88845e-06, gnorm=3.704, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47693
2022-05-09 10:04:03 - progress_bar.py[line:272] - INFO: epoch 002:   5223 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=381, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887132, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.792, expert1_balance_bottom=19.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214, ups=0.56, wpb=381, bsz=32, num_updates=22900, lr=7.88724e-06, gnorm=3.179, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47711
2022-05-09 10:04:20 - progress_bar.py[line:272] - INFO: epoch 002:   5233 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.492, expert1_balance_bottom=19.354, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.7, ups=0.57, wpb=385, bsz=32, num_updates=22910, lr=7.88604e-06, gnorm=3.706, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47728
2022-05-09 10:04:38 - progress_bar.py[line:272] - INFO: epoch 002:   5243 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.805, expert1_balance_bottom=19.24, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.2, ups=0.56, wpb=382.7, bsz=32, num_updates=22920, lr=7.88484e-06, gnorm=3.477, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47746
2022-05-09 10:04:56 - progress_bar.py[line:272] - INFO: epoch 002:   5253 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890609, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.249, expert1_balance_bottom=19.668, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.1, ups=0.57, wpb=381.5, bsz=32, num_updates=22930, lr=7.88364e-06, gnorm=3.24, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47764
2022-05-09 10:05:13 - progress_bar.py[line:272] - INFO: epoch 002:   5263 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=378.7, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883434, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.734, expert1_balance_bottom=19.497, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219, ups=0.58, wpb=378.7, bsz=32, num_updates=22940, lr=7.88244e-06, gnorm=3.596, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47781
2022-05-09 10:05:30 - progress_bar.py[line:272] - INFO: epoch 002:   5273 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.86, expert1_balance_bottom=19.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=219.3, ups=0.57, wpb=383, bsz=32, num_updates=22950, lr=7.88124e-06, gnorm=4.014, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47798
2022-05-09 10:05:48 - progress_bar.py[line:272] - INFO: epoch 002:   5283 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=385.3, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.26, expert1_balance_bottom=19.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=219.8, ups=0.57, wpb=385.3, bsz=32, num_updates=22960, lr=7.88004e-06, gnorm=3.483, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47816
2022-05-09 10:06:05 - progress_bar.py[line:272] - INFO: epoch 002:   5293 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=385.5, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.934, expert1_balance_bottom=19.372, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.7, ups=0.58, wpb=385.5, bsz=32, num_updates=22970, lr=7.87884e-06, gnorm=3.397, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47833
2022-05-09 10:06:22 - progress_bar.py[line:272] - INFO: epoch 002:   5303 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=389.7, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.639, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226.2, ups=0.58, wpb=389.7, bsz=32, num_updates=22980, lr=7.87763e-06, gnorm=3.514, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47850
2022-05-09 10:06:40 - progress_bar.py[line:272] - INFO: epoch 002:   5313 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=379.3, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.052, expert1_balance_bottom=19.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.7, ups=0.57, wpb=379.3, bsz=32, num_updates=22990, lr=7.87643e-06, gnorm=3.644, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47868
2022-05-09 10:06:57 - progress_bar.py[line:272] - INFO: epoch 002:   5323 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=392.9, nsentences=32, sample_size=312.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87632, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.791, expert1_balance_bottom=19.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=230.4, ups=0.59, wpb=392.9, bsz=32, num_updates=23000, lr=7.87523e-06, gnorm=3.777, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47885
2022-05-09 10:07:14 - progress_bar.py[line:272] - INFO: epoch 002:   5333 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=385.3, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881304, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.806, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.2, ups=0.58, wpb=385.3, bsz=32, num_updates=23010, lr=7.87403e-06, gnorm=3.363, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47902
2022-05-09 10:07:31 - progress_bar.py[line:272] - INFO: epoch 002:   5343 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=379.3, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892728, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.342, expert1_balance_bottom=19.643, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=219.6, ups=0.58, wpb=379.3, bsz=32, num_updates=23020, lr=7.87283e-06, gnorm=2.87, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47919
2022-05-09 10:07:49 - progress_bar.py[line:272] - INFO: epoch 002:   5353 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=365.1, nsentences=32, sample_size=290.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895646, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.223, expert1_balance_bottom=19.418, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.2, ups=0.58, wpb=365.1, bsz=32, num_updates=23030, lr=7.87163e-06, gnorm=3.174, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47937
2022-05-09 10:08:06 - progress_bar.py[line:272] - INFO: epoch 002:   5363 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.052, expert1_balance_bottom=19.253, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.2, ups=0.57, wpb=386.8, bsz=32, num_updates=23040, lr=7.87043e-06, gnorm=3.497, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47954
2022-05-09 10:08:23 - progress_bar.py[line:272] - INFO: epoch 002:   5373 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=389.3, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879906, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.942, expert1_balance_bottom=19.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=228.1, ups=0.59, wpb=389.3, bsz=32, num_updates=23050, lr=7.86922e-06, gnorm=4.019, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47971
2022-05-09 10:08:41 - progress_bar.py[line:272] - INFO: epoch 002:   5383 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.764, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=219.5, ups=0.58, wpb=380.9, bsz=32, num_updates=23060, lr=7.86802e-06, gnorm=3.087, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=47989
2022-05-09 10:08:58 - progress_bar.py[line:272] - INFO: epoch 002:   5393 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=383.6, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885793, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.556, expert1_balance_bottom=19.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.2, ups=0.58, wpb=383.6, bsz=32, num_updates=23070, lr=7.86682e-06, gnorm=3.197, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48006
2022-05-09 10:09:15 - progress_bar.py[line:272] - INFO: epoch 002:   5403 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=394.2, nsentences=32, sample_size=313.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.899, expert1_balance_bottom=19.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=227.7, ups=0.58, wpb=394.2, bsz=32, num_updates=23080, lr=7.86562e-06, gnorm=3.209, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48023
2022-05-09 10:09:32 - progress_bar.py[line:272] - INFO: epoch 002:   5413 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=378.3, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888437, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.184, expert1_balance_bottom=19.479, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220, ups=0.58, wpb=378.3, bsz=32, num_updates=23090, lr=7.86442e-06, gnorm=3.881, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48040
2022-05-09 10:09:50 - progress_bar.py[line:272] - INFO: epoch 002:   5423 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=381.9, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887078, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.457, expert1_balance_bottom=19.343, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.2, ups=0.58, wpb=381.9, bsz=32, num_updates=23100, lr=7.86322e-06, gnorm=3.47, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48058
2022-05-09 10:10:07 - progress_bar.py[line:272] - INFO: epoch 002:   5433 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892839, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.084, expert1_balance_bottom=19.653, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.4, ups=0.57, wpb=385.2, bsz=32, num_updates=23110, lr=7.86202e-06, gnorm=3.873, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48075
2022-05-09 10:10:24 - progress_bar.py[line:272] - INFO: epoch 002:   5443 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883371, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.905, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=221.8, ups=0.58, wpb=384.1, bsz=32, num_updates=23120, lr=7.86082e-06, gnorm=3.384, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48092
2022-05-09 10:10:42 - progress_bar.py[line:272] - INFO: epoch 002:   5453 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=388.5, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881293, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.666, expert1_balance_bottom=19.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223.8, ups=0.58, wpb=388.5, bsz=32, num_updates=23130, lr=7.85961e-06, gnorm=3.237, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48110
2022-05-09 10:10:59 - progress_bar.py[line:272] - INFO: epoch 002:   5463 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=388.4, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.303, expert1_balance_bottom=19.577, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=222.9, ups=0.57, wpb=388.4, bsz=32, num_updates=23140, lr=7.85841e-06, gnorm=3.163, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48127
2022-05-09 10:11:17 - progress_bar.py[line:272] - INFO: epoch 002:   5473 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=379.3, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.583, expert1_balance_bottom=19.573, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.2, ups=0.58, wpb=379.3, bsz=32, num_updates=23150, lr=7.85721e-06, gnorm=3.832, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48145
2022-05-09 10:11:34 - progress_bar.py[line:272] - INFO: epoch 002:   5483 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=387, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.863, expert1_balance_bottom=19.3, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=222.2, ups=0.57, wpb=387, bsz=32, num_updates=23160, lr=7.85601e-06, gnorm=3.418, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48162
2022-05-09 10:11:52 - progress_bar.py[line:272] - INFO: epoch 002:   5493 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874396, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.206, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.7, ups=0.57, wpb=383.6, bsz=32, num_updates=23170, lr=7.85481e-06, gnorm=3.744, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48180
2022-05-09 10:11:58 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 10:12:11 - progress_bar.py[line:272] - INFO: epoch 002:   5504 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=379.8, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.724, expert1_balance_bottom=19.259, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=198.1, ups=0.52, wpb=379.8, bsz=32, num_updates=23180, lr=7.85361e-06, gnorm=3.644, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48199
2022-05-09 10:12:28 - progress_bar.py[line:272] - INFO: epoch 002:   5514 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=386.8, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.806, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=224.2, ups=0.58, wpb=386.8, bsz=32, num_updates=23190, lr=7.85241e-06, gnorm=3.936, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48216
2022-05-09 10:12:45 - progress_bar.py[line:272] - INFO: epoch 002:   5524 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873431, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.232, expert1_balance_bottom=19.093, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=221.8, ups=0.58, wpb=383, bsz=32, num_updates=23200, lr=7.8512e-06, gnorm=3.675, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48233
2022-05-09 10:13:03 - progress_bar.py[line:272] - INFO: epoch 002:   5534 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=389.8, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.266, expert1_balance_bottom=19.193, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.2, ups=0.58, wpb=389.8, bsz=32, num_updates=23210, lr=7.85e-06, gnorm=3.172, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48251
2022-05-09 10:13:21 - progress_bar.py[line:272] - INFO: epoch 002:   5544 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=390.9, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.816, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216, ups=0.55, wpb=390.9, bsz=32, num_updates=23220, lr=7.8488e-06, gnorm=4.163, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48269
2022-05-09 10:13:39 - progress_bar.py[line:272] - INFO: epoch 002:   5554 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=387.8, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34, expert1_balance_bottom=19.399, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.9, ups=0.55, wpb=387.8, bsz=32, num_updates=23230, lr=7.8476e-06, gnorm=2.949, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48287
2022-05-09 10:13:57 - progress_bar.py[line:272] - INFO: epoch 002:   5564 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=384, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88931, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.058, expert1_balance_bottom=19.664, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.3, ups=0.56, wpb=384, bsz=32, num_updates=23240, lr=7.8464e-06, gnorm=3.253, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48305
2022-05-09 10:14:15 - progress_bar.py[line:272] - INFO: epoch 002:   5574 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.534, expert1_balance_bottom=19.526, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.8, ups=0.56, wpb=381.7, bsz=32, num_updates=23250, lr=7.8452e-06, gnorm=3.293, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48323
2022-05-09 10:14:33 - progress_bar.py[line:272] - INFO: epoch 002:   5584 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=373.8, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.233, expert1_balance_bottom=19.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=206.4, ups=0.55, wpb=373.8, bsz=32, num_updates=23260, lr=7.844e-06, gnorm=3.54, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48341
2022-05-09 10:14:51 - progress_bar.py[line:272] - INFO: epoch 002:   5594 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.58, expert1_balance_bottom=19.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=208.9, ups=0.54, wpb=383.7, bsz=32, num_updates=23270, lr=7.8428e-06, gnorm=3.665, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48359
2022-05-09 10:15:09 - progress_bar.py[line:272] - INFO: epoch 002:   5604 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.758, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=208, ups=0.54, wpb=381.8, bsz=32, num_updates=23280, lr=7.84159e-06, gnorm=3.015, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48377
2022-05-09 10:15:28 - progress_bar.py[line:272] - INFO: epoch 002:   5614 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.722, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210.9, ups=0.55, wpb=386.1, bsz=32, num_updates=23290, lr=7.84039e-06, gnorm=3.892, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48396
2022-05-09 10:15:46 - progress_bar.py[line:272] - INFO: epoch 002:   5624 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.601, expert1_balance_bottom=19.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.8, ups=0.55, wpb=385.3, bsz=32, num_updates=23300, lr=7.83919e-06, gnorm=3.113, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48414
2022-05-09 10:16:04 - progress_bar.py[line:272] - INFO: epoch 002:   5634 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=390.7, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.143, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=212.8, ups=0.54, wpb=390.7, bsz=32, num_updates=23310, lr=7.83799e-06, gnorm=3.301, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48432
2022-05-09 10:16:22 - progress_bar.py[line:272] - INFO: epoch 002:   5644 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=380, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=32.958, expert1_balance_bottom=19.732, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.9, ups=0.56, wpb=380, bsz=32, num_updates=23320, lr=7.83679e-06, gnorm=3.674, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48450
2022-05-09 10:16:41 - progress_bar.py[line:272] - INFO: epoch 002:   5654 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=379.3, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88432, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.89, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=205.7, ups=0.54, wpb=379.3, bsz=32, num_updates=23330, lr=7.83559e-06, gnorm=3.463, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48469
2022-05-09 10:16:58 - progress_bar.py[line:272] - INFO: epoch 002:   5664 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=378.3, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891345, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.447, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.8, ups=0.56, wpb=378.3, bsz=32, num_updates=23340, lr=7.83439e-06, gnorm=3.072, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48487
2022-05-09 10:17:16 - progress_bar.py[line:272] - INFO: epoch 002:   5674 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=379.3, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.642, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212.4, ups=0.56, wpb=379.3, bsz=32, num_updates=23350, lr=7.83319e-06, gnorm=3.386, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48504
2022-05-09 10:17:34 - progress_bar.py[line:272] - INFO: epoch 002:   5684 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.493, expert1_balance_bottom=19.537, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.7, ups=0.56, wpb=383.2, bsz=32, num_updates=23360, lr=7.83198e-06, gnorm=3.67, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48522
2022-05-09 10:17:52 - progress_bar.py[line:272] - INFO: epoch 002:   5694 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=381.4, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883218, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.527, expert1_balance_bottom=19.157, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=213.5, ups=0.56, wpb=381.4, bsz=32, num_updates=23370, lr=7.83078e-06, gnorm=3.537, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48540
2022-05-09 10:18:10 - progress_bar.py[line:272] - INFO: epoch 002:   5704 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=381.2, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886935, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.237, expert1_balance_bottom=19.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=213.1, ups=0.56, wpb=381.2, bsz=32, num_updates=23380, lr=7.82958e-06, gnorm=3.331, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48558
2022-05-09 10:18:28 - progress_bar.py[line:272] - INFO: epoch 002:   5714 / 17711 loss=3.096, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883273, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.096, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.023, expert1_balance_bottom=19.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209.4, ups=0.55, wpb=378.2, bsz=32, num_updates=23390, lr=7.82838e-06, gnorm=3.644, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48576
2022-05-09 10:18:46 - progress_bar.py[line:272] - INFO: epoch 002:   5724 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.246, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=212.8, ups=0.56, wpb=382.2, bsz=32, num_updates=23400, lr=7.82718e-06, gnorm=3.025, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48594
2022-05-09 10:19:04 - progress_bar.py[line:272] - INFO: epoch 002:   5734 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891055, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.735, expert1_balance_bottom=19.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.4, ups=0.55, wpb=380.7, bsz=32, num_updates=23410, lr=7.82598e-06, gnorm=3.23, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48612
2022-05-09 10:19:23 - progress_bar.py[line:272] - INFO: epoch 002:   5744 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.76, expert1_balance_bottom=19.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=207.1, ups=0.55, wpb=377.1, bsz=32, num_updates=23420, lr=7.82478e-06, gnorm=3.035, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48631
2022-05-09 10:19:41 - progress_bar.py[line:272] - INFO: epoch 002:   5754 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=386, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.565, expert1_balance_bottom=19.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.4, ups=0.56, wpb=386, bsz=32, num_updates=23430, lr=7.82357e-06, gnorm=3.537, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48649
2022-05-09 10:19:59 - progress_bar.py[line:272] - INFO: epoch 002:   5764 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886797, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.191, expert1_balance_bottom=19.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.6, ups=0.55, wpb=380.7, bsz=32, num_updates=23440, lr=7.82237e-06, gnorm=3.511, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48667
2022-05-09 10:20:17 - progress_bar.py[line:272] - INFO: epoch 002:   5774 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=373.3, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.169, expert1_balance_bottom=19.605, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=205.2, ups=0.55, wpb=373.3, bsz=32, num_updates=23450, lr=7.82117e-06, gnorm=3.211, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48685
2022-05-09 10:20:35 - progress_bar.py[line:272] - INFO: epoch 002:   5784 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=32.904, expert1_balance_bottom=19.708, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.5, ups=0.55, wpb=382.4, bsz=32, num_updates=23460, lr=7.81997e-06, gnorm=3.822, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48703
2022-05-09 10:20:53 - progress_bar.py[line:272] - INFO: epoch 002:   5794 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892341, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.061, expert1_balance_bottom=19.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=207.8, ups=0.55, wpb=380.5, bsz=32, num_updates=23470, lr=7.81877e-06, gnorm=4.137, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48721
2022-05-09 10:21:11 - progress_bar.py[line:272] - INFO: epoch 002:   5804 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=381.9, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.529, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.9, ups=0.57, wpb=381.9, bsz=32, num_updates=23480, lr=7.81757e-06, gnorm=3.131, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48739
2022-05-09 10:21:29 - progress_bar.py[line:272] - INFO: epoch 002:   5814 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=376.8, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891693, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.585, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=211.8, ups=0.56, wpb=376.8, bsz=32, num_updates=23490, lr=7.81637e-06, gnorm=3.008, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48757
2022-05-09 10:21:47 - progress_bar.py[line:272] - INFO: epoch 002:   5824 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=375.4, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=32.385, expert1_balance_bottom=19.86, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=208.5, ups=0.56, wpb=375.4, bsz=32, num_updates=23500, lr=7.81517e-06, gnorm=3.438, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48775
2022-05-09 10:22:05 - progress_bar.py[line:272] - INFO: epoch 002:   5834 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887182, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.271, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.9, ups=0.55, wpb=383.4, bsz=32, num_updates=23510, lr=7.81396e-06, gnorm=3.238, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48793
2022-05-09 10:22:23 - progress_bar.py[line:272] - INFO: epoch 002:   5844 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=394.1, nsentences=32, sample_size=313.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87411, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.995, expert1_balance_bottom=19.366, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.4, ups=0.55, wpb=394.1, bsz=32, num_updates=23520, lr=7.81276e-06, gnorm=4.14, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48811
2022-05-09 10:22:41 - progress_bar.py[line:272] - INFO: epoch 002:   5854 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=374.8, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889534, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.306, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=205.5, ups=0.55, wpb=374.8, bsz=32, num_updates=23530, lr=7.81156e-06, gnorm=3.457, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48829
2022-05-09 10:22:59 - progress_bar.py[line:272] - INFO: epoch 002:   5864 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.83, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=208.2, ups=0.54, wpb=382.8, bsz=32, num_updates=23540, lr=7.81036e-06, gnorm=3.306, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48847
2022-05-09 10:23:17 - progress_bar.py[line:272] - INFO: epoch 002:   5874 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=377, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877224, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.105, expert1_balance_bottom=19.312, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.5, ups=0.56, wpb=377, bsz=32, num_updates=23550, lr=7.80916e-06, gnorm=3.73, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48865
2022-05-09 10:23:35 - progress_bar.py[line:272] - INFO: epoch 002:   5884 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=377.6, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895034, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.393, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.6, ups=0.56, wpb=377.6, bsz=32, num_updates=23560, lr=7.80796e-06, gnorm=3.214, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48883
2022-05-09 10:23:53 - progress_bar.py[line:272] - INFO: epoch 002:   5894 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879156, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.118, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.1, ups=0.55, wpb=384.7, bsz=32, num_updates=23570, lr=7.80676e-06, gnorm=3.94, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48901
2022-05-09 10:24:11 - progress_bar.py[line:272] - INFO: epoch 002:   5904 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882435, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.965, expert1_balance_bottom=19.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.7, ups=0.56, wpb=380.4, bsz=32, num_updates=23580, lr=7.80555e-06, gnorm=3.9, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48919
2022-05-09 10:24:30 - progress_bar.py[line:272] - INFO: epoch 002:   5914 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892377, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=32.999, expert1_balance_bottom=19.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209.5, ups=0.55, wpb=381.5, bsz=32, num_updates=23590, lr=7.80435e-06, gnorm=3.41, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48938
2022-05-09 10:24:48 - progress_bar.py[line:272] - INFO: epoch 002:   5924 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=390, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.706, expert1_balance_bottom=19.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.1, ups=0.55, wpb=390, bsz=32, num_updates=23600, lr=7.80315e-06, gnorm=3.612, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48956
2022-05-09 10:25:05 - progress_bar.py[line:272] - INFO: epoch 002:   5934 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=374.1, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893628, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=32.811, expert1_balance_bottom=19.76, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210, ups=0.56, wpb=374.1, bsz=32, num_updates=23610, lr=7.80195e-06, gnorm=3.595, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48973
2022-05-09 10:25:24 - progress_bar.py[line:272] - INFO: epoch 002:   5944 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.53, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=205.5, ups=0.54, wpb=378.7, bsz=32, num_updates=23620, lr=7.80075e-06, gnorm=4.128, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=48992
2022-05-09 10:25:42 - progress_bar.py[line:272] - INFO: epoch 002:   5954 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=393.5, nsentences=32, sample_size=313.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878895, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.005, expert1_balance_bottom=19.372, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.1, ups=0.54, wpb=393.5, bsz=32, num_updates=23630, lr=7.79955e-06, gnorm=3.603, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49010
2022-05-09 10:26:00 - progress_bar.py[line:272] - INFO: epoch 002:   5964 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.249, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.4, ups=0.55, wpb=382.8, bsz=32, num_updates=23640, lr=7.79835e-06, gnorm=3.52, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49028
2022-05-09 10:26:18 - progress_bar.py[line:272] - INFO: epoch 002:   5974 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896581, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.25, expert1_balance_bottom=19.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.4, ups=0.56, wpb=379.2, bsz=32, num_updates=23650, lr=7.79715e-06, gnorm=3.084, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49046
2022-05-09 10:26:36 - progress_bar.py[line:272] - INFO: epoch 002:   5984 / 17711 loss=2.937, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=387.1, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.937, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.247, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=212.4, ups=0.55, wpb=387.1, bsz=32, num_updates=23660, lr=7.79594e-06, gnorm=2.9, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49064
2022-05-09 10:26:54 - progress_bar.py[line:272] - INFO: epoch 002:   5994 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876704, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.26, expert1_balance_bottom=19.374, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.9, ups=0.56, wpb=381.1, bsz=32, num_updates=23670, lr=7.79474e-06, gnorm=3.159, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49082
2022-05-09 10:27:13 - progress_bar.py[line:272] - INFO: epoch 002:   6004 / 17711 loss=2.927, loss_v1=0, loss_v2=0, nll_loss=0.695, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889219, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.927, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.348, expert1_balance_bottom=19.563, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=205.9, ups=0.54, wpb=378.1, bsz=32, num_updates=23680, lr=7.79354e-06, gnorm=2.758, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49101
2022-05-09 10:27:31 - progress_bar.py[line:272] - INFO: epoch 002:   6014 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=393.4, nsentences=32, sample_size=313.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883576, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.691, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.6, ups=0.55, wpb=393.4, bsz=32, num_updates=23690, lr=7.79234e-06, gnorm=3.036, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49119
2022-05-09 10:27:49 - progress_bar.py[line:272] - INFO: epoch 002:   6024 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=375.1, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.78, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=204, ups=0.54, wpb=375.1, bsz=32, num_updates=23700, lr=7.79114e-06, gnorm=3.413, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49137
2022-05-09 10:28:07 - progress_bar.py[line:272] - INFO: epoch 002:   6034 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=383.4, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.088, expert1_balance_bottom=19.454, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.3, ups=0.56, wpb=383.4, bsz=32, num_updates=23710, lr=7.78994e-06, gnorm=3.776, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49155
2022-05-09 10:28:25 - progress_bar.py[line:272] - INFO: epoch 002:   6044 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=386, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886322, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.312, expert1_balance_bottom=19.705, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.3, ups=0.55, wpb=386, bsz=32, num_updates=23720, lr=7.78874e-06, gnorm=3.168, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49173
2022-05-09 10:28:27 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 10:28:45 - progress_bar.py[line:272] - INFO: epoch 002:   6055 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=381, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876596, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.903, expert1_balance_bottom=19.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=191.9, ups=0.5, wpb=381, bsz=32, num_updates=23730, lr=7.78754e-06, gnorm=3.371, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49193
2022-05-09 10:29:03 - progress_bar.py[line:272] - INFO: epoch 002:   6065 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=395, nsentences=32, sample_size=314.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.471, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217, ups=0.55, wpb=395, bsz=32, num_updates=23740, lr=7.78633e-06, gnorm=3.609, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49211
2022-05-09 10:29:22 - progress_bar.py[line:272] - INFO: epoch 002:   6075 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.668, expert1_balance_bottom=19.717, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206.5, ups=0.54, wpb=380.4, bsz=32, num_updates=23750, lr=7.78513e-06, gnorm=3.178, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49230
2022-05-09 10:29:40 - progress_bar.py[line:272] - INFO: epoch 002:   6085 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=387.2, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870115, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.471, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=212.4, ups=0.55, wpb=387.2, bsz=32, num_updates=23760, lr=7.78393e-06, gnorm=3.286, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49248
2022-05-09 10:29:58 - progress_bar.py[line:272] - INFO: epoch 002:   6095 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=382.6, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895419, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=32.962, expert1_balance_bottom=19.787, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210.8, ups=0.55, wpb=382.6, bsz=32, num_updates=23770, lr=7.78273e-06, gnorm=3.115, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49266
2022-05-09 10:30:16 - progress_bar.py[line:272] - INFO: epoch 002:   6105 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=376.2, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=32.692, expert1_balance_bottom=19.666, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=207.4, ups=0.55, wpb=376.2, bsz=32, num_updates=23780, lr=7.78153e-06, gnorm=3.358, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49284
2022-05-09 10:30:34 - progress_bar.py[line:272] - INFO: epoch 002:   6115 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=376.1, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.813, expert1_balance_bottom=19.46, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=208.9, ups=0.56, wpb=376.1, bsz=32, num_updates=23790, lr=7.78033e-06, gnorm=3.838, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49302
2022-05-09 10:30:52 - progress_bar.py[line:272] - INFO: epoch 002:   6125 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=371.8, nsentences=32, sample_size=295.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.139, expert1_balance_top=32.817, expert1_balance_bottom=19.717, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=208, ups=0.56, wpb=371.8, bsz=32, num_updates=23800, lr=7.77913e-06, gnorm=3.51, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49320
2022-05-09 10:31:10 - progress_bar.py[line:272] - INFO: epoch 002:   6135 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=380.9, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875322, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.278, expert1_balance_bottom=19.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.7, ups=0.56, wpb=380.9, bsz=32, num_updates=23810, lr=7.77792e-06, gnorm=3.504, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49338
2022-05-09 10:31:29 - progress_bar.py[line:272] - INFO: epoch 002:   6145 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=376.2, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885553, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.742, expert1_balance_bottom=19.592, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=204.2, ups=0.54, wpb=376.2, bsz=32, num_updates=23820, lr=7.77672e-06, gnorm=3.479, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49357
2022-05-09 10:31:46 - progress_bar.py[line:272] - INFO: epoch 002:   6155 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=374.5, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=32.835, expert1_balance_bottom=19.668, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=209.6, ups=0.56, wpb=374.5, bsz=32, num_updates=23830, lr=7.77552e-06, gnorm=3.207, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49374
2022-05-09 10:32:04 - progress_bar.py[line:272] - INFO: epoch 002:   6165 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=381.4, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.532, expert1_balance_bottom=19.706, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.7, ups=0.56, wpb=381.4, bsz=32, num_updates=23840, lr=7.77432e-06, gnorm=3.329, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49392
2022-05-09 10:32:22 - progress_bar.py[line:272] - INFO: epoch 002:   6175 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874877, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.384, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=215.2, ups=0.56, wpb=385.7, bsz=32, num_updates=23850, lr=7.77312e-06, gnorm=3.6, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49410
2022-05-09 10:32:40 - progress_bar.py[line:272] - INFO: epoch 002:   6185 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.611, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.1, ups=0.55, wpb=382.6, bsz=32, num_updates=23860, lr=7.77192e-06, gnorm=3.806, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49428
2022-05-09 10:32:59 - progress_bar.py[line:272] - INFO: epoch 002:   6195 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=377.1, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.722, expert1_balance_bottom=19.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=205.5, ups=0.55, wpb=377.1, bsz=32, num_updates=23870, lr=7.77072e-06, gnorm=3.842, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49447
2022-05-09 10:33:17 - progress_bar.py[line:272] - INFO: epoch 002:   6205 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=384.4, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.113, expert1_balance_bottom=19.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=211.3, ups=0.55, wpb=384.4, bsz=32, num_updates=23880, lr=7.76952e-06, gnorm=2.981, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49465
2022-05-09 10:33:35 - progress_bar.py[line:272] - INFO: epoch 002:   6215 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=391.3, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.914, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.3, ups=0.55, wpb=391.3, bsz=32, num_updates=23890, lr=7.76831e-06, gnorm=3.232, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49483
2022-05-09 10:33:53 - progress_bar.py[line:272] - INFO: epoch 002:   6225 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.469, expert1_balance_bottom=19.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.3, ups=0.56, wpb=382.9, bsz=32, num_updates=23900, lr=7.76711e-06, gnorm=3.732, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49501
2022-05-09 10:34:11 - progress_bar.py[line:272] - INFO: epoch 002:   6235 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=388.9, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.243, expert1_balance_bottom=19.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216.9, ups=0.56, wpb=388.9, bsz=32, num_updates=23910, lr=7.76591e-06, gnorm=3.373, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49519
2022-05-09 10:34:29 - progress_bar.py[line:272] - INFO: epoch 002:   6245 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.78, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.7, ups=0.55, wpb=381.7, bsz=32, num_updates=23920, lr=7.76471e-06, gnorm=3.201, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49537
2022-05-09 10:34:47 - progress_bar.py[line:272] - INFO: epoch 002:   6255 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=387.1, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891483, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.483, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.2, ups=0.56, wpb=387.1, bsz=32, num_updates=23930, lr=7.76351e-06, gnorm=3.511, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49555
2022-05-09 10:35:05 - progress_bar.py[line:272] - INFO: epoch 002:   6265 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.589, expert1_balance_bottom=19.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=208.5, ups=0.55, wpb=378, bsz=32, num_updates=23940, lr=7.76231e-06, gnorm=3.149, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49573
2022-05-09 10:35:23 - progress_bar.py[line:272] - INFO: epoch 002:   6275 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=390.9, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879628, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.616, expert1_balance_bottom=19.438, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217, ups=0.56, wpb=390.9, bsz=32, num_updates=23950, lr=7.76111e-06, gnorm=3.677, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49591
2022-05-09 10:35:41 - progress_bar.py[line:272] - INFO: epoch 002:   6285 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884467, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.621, expert1_balance_bottom=19.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.9, ups=0.56, wpb=379.9, bsz=32, num_updates=23960, lr=7.7599e-06, gnorm=3.83, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49609
2022-05-09 10:35:59 - progress_bar.py[line:272] - INFO: epoch 002:   6295 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=32.739, expert1_balance_bottom=19.879, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.7, ups=0.56, wpb=382.2, bsz=32, num_updates=23970, lr=7.7587e-06, gnorm=3.57, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49627
2022-05-09 10:36:17 - progress_bar.py[line:272] - INFO: epoch 002:   6305 / 17711 loss=3.115, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=380.4, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.115, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.162, expert1_balance_bottom=19.713, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=211.4, ups=0.56, wpb=380.4, bsz=32, num_updates=23980, lr=7.7575e-06, gnorm=3.943, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49645
2022-05-09 10:36:35 - progress_bar.py[line:272] - INFO: epoch 002:   6315 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893099, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.494, expert1_balance_bottom=19.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215, ups=0.56, wpb=381.3, bsz=32, num_updates=23990, lr=7.7563e-06, gnorm=3.61, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49663
2022-05-09 10:36:53 - progress_bar.py[line:272] - INFO: epoch 002:   6325 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=388.6, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895051, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.313, expert1_balance_bottom=19.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.3, ups=0.55, wpb=388.6, bsz=32, num_updates=24000, lr=7.7551e-06, gnorm=3.307, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=49681
2022-05-09 10:36:53 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 10:36:53 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 10:36:53 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 10:44:21 - train.py[line:517] - INFO: valid_step finished
2022-05-09 10:44:21 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 9.803 | loss_v1 0 | loss_v2 0 | nll_loss 8.133 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.990224 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.803 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.192 | expert1_balance_top 38.67 | expert1_balance_bottom 15.168 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 280.78 | cider 1.19 | wps 671.7 | wpb 481.7 | bsz 8 | num_updates 24000 | best_cider 1.198
2022-05-09 10:44:40 - progress_bar.py[line:272] - INFO: epoch 002:   6335 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.764, expert1_balance_bottom=19.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=8.2, ups=0.02, wpb=383.5, bsz=32, num_updates=24010, lr=7.7539e-06, gnorm=3.443, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50148
2022-05-09 10:44:58 - progress_bar.py[line:272] - INFO: epoch 002:   6345 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880806, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.469, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216.1, ups=0.56, wpb=384.7, bsz=32, num_updates=24020, lr=7.7527e-06, gnorm=3.214, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50166
2022-05-09 10:45:16 - progress_bar.py[line:272] - INFO: epoch 002:   6355 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=385.3, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892604, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.534, expert1_balance_bottom=19.459, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=211.3, ups=0.55, wpb=385.3, bsz=32, num_updates=24030, lr=7.7515e-06, gnorm=3.53, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50184
2022-05-09 10:45:34 - progress_bar.py[line:272] - INFO: epoch 002:   6365 / 17711 loss=2.927, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.927, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.72, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=211.3, ups=0.55, wpb=383.6, bsz=32, num_updates=24040, lr=7.75029e-06, gnorm=3.036, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50202
2022-05-09 10:45:52 - progress_bar.py[line:272] - INFO: epoch 002:   6375 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=388.5, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.566, expert1_balance_bottom=19.55, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=217, ups=0.56, wpb=388.5, bsz=32, num_updates=24050, lr=7.74909e-06, gnorm=3.677, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50220
2022-05-09 10:46:10 - progress_bar.py[line:272] - INFO: epoch 002:   6385 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=370.3, nsentences=32, sample_size=294.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.057, expert1_balance_bottom=19.633, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=205.6, ups=0.56, wpb=370.3, bsz=32, num_updates=24060, lr=7.74789e-06, gnorm=3.557, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50238
2022-05-09 10:46:28 - progress_bar.py[line:272] - INFO: epoch 002:   6395 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=380, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882416, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.354, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=209.1, ups=0.55, wpb=380, bsz=32, num_updates=24070, lr=7.74669e-06, gnorm=3.542, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50256
2022-05-09 10:46:46 - progress_bar.py[line:272] - INFO: epoch 002:   6405 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=381.4, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.221, expert1_balance_bottom=19.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=208, ups=0.55, wpb=381.4, bsz=32, num_updates=24080, lr=7.74549e-06, gnorm=3.271, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50275
2022-05-09 10:47:04 - progress_bar.py[line:272] - INFO: epoch 002:   6415 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=384, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893834, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.574, expert1_balance_bottom=19.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=214, ups=0.56, wpb=384, bsz=32, num_updates=24090, lr=7.74429e-06, gnorm=3.377, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50292
2022-05-09 10:47:23 - progress_bar.py[line:272] - INFO: epoch 002:   6425 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=382.9, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885502, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.954, expert1_balance_bottom=19.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=209.4, ups=0.55, wpb=382.9, bsz=32, num_updates=24100, lr=7.74309e-06, gnorm=3.472, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50311
2022-05-09 10:47:41 - progress_bar.py[line:272] - INFO: epoch 002:   6435 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=380, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.616, expert1_balance_bottom=19.5, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=207, ups=0.54, wpb=380, bsz=32, num_updates=24110, lr=7.74189e-06, gnorm=4.133, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50329
2022-05-09 10:47:59 - progress_bar.py[line:272] - INFO: epoch 002:   6445 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874353, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.931, expert1_balance_bottom=19.458, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209, ups=0.55, wpb=382.9, bsz=32, num_updates=24120, lr=7.74068e-06, gnorm=3.432, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50347
2022-05-09 10:48:18 - progress_bar.py[line:272] - INFO: epoch 002:   6455 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=389, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.135, expert1_balance_bottom=19.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.4, ups=0.55, wpb=389, bsz=32, num_updates=24130, lr=7.73948e-06, gnorm=3.371, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50366
2022-05-09 10:48:36 - progress_bar.py[line:272] - INFO: epoch 002:   6465 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.944, expert1_balance_bottom=18.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209.8, ups=0.55, wpb=380.5, bsz=32, num_updates=24140, lr=7.73828e-06, gnorm=3.524, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50384
2022-05-09 10:48:54 - progress_bar.py[line:272] - INFO: epoch 002:   6475 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878722, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.025, expert1_balance_bottom=19.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210, ups=0.54, wpb=385.5, bsz=32, num_updates=24150, lr=7.73708e-06, gnorm=3.808, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50402
2022-05-09 10:49:12 - progress_bar.py[line:272] - INFO: epoch 002:   6485 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=384.3, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90045, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.117, expert1_balance_bottom=19.631, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=211.8, ups=0.55, wpb=384.3, bsz=32, num_updates=24160, lr=7.73588e-06, gnorm=3.348, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50420
2022-05-09 10:49:30 - progress_bar.py[line:272] - INFO: epoch 002:   6495 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.277, expert1_balance_bottom=19.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.1, ups=0.56, wpb=382.2, bsz=32, num_updates=24170, lr=7.73468e-06, gnorm=3.867, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50438
2022-05-09 10:49:48 - progress_bar.py[line:272] - INFO: epoch 002:   6505 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=32.999, expert1_balance_bottom=19.702, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209.2, ups=0.55, wpb=380.6, bsz=32, num_updates=24180, lr=7.73348e-06, gnorm=4.268, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50457
2022-05-09 10:50:07 - progress_bar.py[line:272] - INFO: epoch 002:   6515 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.565, expert1_balance_bottom=19.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=208.5, ups=0.54, wpb=383.2, bsz=32, num_updates=24190, lr=7.73227e-06, gnorm=3.691, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50475
2022-05-09 10:50:25 - progress_bar.py[line:272] - INFO: epoch 002:   6525 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.019, expert1_balance_bottom=19.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.3, ups=0.55, wpb=382, bsz=32, num_updates=24200, lr=7.73107e-06, gnorm=3.299, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50493
2022-05-09 10:50:43 - progress_bar.py[line:272] - INFO: epoch 002:   6535 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=382.5, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879638, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.003, expert1_balance_bottom=19.312, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.9, ups=0.55, wpb=382.5, bsz=32, num_updates=24210, lr=7.72987e-06, gnorm=3.212, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50511
2022-05-09 10:51:01 - progress_bar.py[line:272] - INFO: epoch 002:   6545 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=388.2, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892128, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.645, expert1_balance_bottom=19.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.9, ups=0.56, wpb=388.2, bsz=32, num_updates=24220, lr=7.72867e-06, gnorm=3.463, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50529
2022-05-09 10:51:20 - progress_bar.py[line:272] - INFO: epoch 002:   6555 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=374.4, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.244, expert1_balance_bottom=19.578, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=204.9, ups=0.55, wpb=374.4, bsz=32, num_updates=24230, lr=7.72747e-06, gnorm=3.548, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50548
2022-05-09 10:51:38 - progress_bar.py[line:272] - INFO: epoch 002:   6565 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884818, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.626, expert1_balance_bottom=19.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=210.2, ups=0.55, wpb=379.5, bsz=32, num_updates=24240, lr=7.72627e-06, gnorm=2.953, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50566
2022-05-09 10:51:56 - progress_bar.py[line:272] - INFO: epoch 002:   6575 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=376.6, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.567, expert1_balance_bottom=19.292, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.7, ups=0.56, wpb=376.6, bsz=32, num_updates=24250, lr=7.72507e-06, gnorm=3.118, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50584
2022-05-09 10:52:14 - progress_bar.py[line:272] - INFO: epoch 002:   6585 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=373.6, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.099, expert1_balance_bottom=19.666, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206, ups=0.55, wpb=373.6, bsz=32, num_updates=24260, lr=7.72387e-06, gnorm=3.604, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50602
2022-05-09 10:52:32 - progress_bar.py[line:272] - INFO: epoch 002:   6595 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=377.3, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.327, expert1_balance_bottom=19.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=209, ups=0.55, wpb=377.3, bsz=32, num_updates=24270, lr=7.72266e-06, gnorm=4.123, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50620
2022-05-09 10:52:50 - progress_bar.py[line:272] - INFO: epoch 002:   6605 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=391.2, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.925, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.2, ups=0.55, wpb=391.2, bsz=32, num_updates=24280, lr=7.72146e-06, gnorm=3.707, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50638
2022-05-09 10:53:08 - progress_bar.py[line:272] - INFO: epoch 002:   6615 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=388.3, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886743, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.6, expert1_balance_bottom=19.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.4, ups=0.55, wpb=388.3, bsz=32, num_updates=24290, lr=7.72026e-06, gnorm=3.57, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50656
2022-05-09 10:53:26 - progress_bar.py[line:272] - INFO: epoch 002:   6625 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=384.8, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.547, expert1_balance_bottom=19.511, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.7, ups=0.56, wpb=384.8, bsz=32, num_updates=24300, lr=7.71906e-06, gnorm=3.574, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50674
2022-05-09 10:53:44 - progress_bar.py[line:272] - INFO: epoch 002:   6635 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.392, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.5, ups=0.56, wpb=382.9, bsz=32, num_updates=24310, lr=7.71786e-06, gnorm=3.659, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50692
2022-05-09 10:54:02 - progress_bar.py[line:272] - INFO: epoch 002:   6645 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=388.9, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.321, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.9, ups=0.57, wpb=388.9, bsz=32, num_updates=24320, lr=7.71666e-06, gnorm=3.812, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50710
2022-05-09 10:54:19 - progress_bar.py[line:272] - INFO: epoch 002:   6655 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=374.5, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888631, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.64, expert1_balance_bottom=19.34, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.5, ups=0.57, wpb=374.5, bsz=32, num_updates=24330, lr=7.71546e-06, gnorm=3.526, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50727
2022-05-09 10:54:37 - progress_bar.py[line:272] - INFO: epoch 002:   6665 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890073, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.462, expert1_balance_bottom=19.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.9, ups=0.56, wpb=379.5, bsz=32, num_updates=24340, lr=7.71425e-06, gnorm=3.432, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50745
2022-05-09 10:54:55 - progress_bar.py[line:272] - INFO: epoch 002:   6675 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=373.4, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887135, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.126, expert1_balance_bottom=19.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209.6, ups=0.56, wpb=373.4, bsz=32, num_updates=24350, lr=7.71305e-06, gnorm=3.676, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50763
2022-05-09 10:55:13 - progress_bar.py[line:272] - INFO: epoch 002:   6685 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=383.7, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884124, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.976, expert1_balance_bottom=19.472, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.6, ups=0.56, wpb=383.7, bsz=32, num_updates=24360, lr=7.71185e-06, gnorm=3.508, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50781
2022-05-09 10:55:31 - progress_bar.py[line:272] - INFO: epoch 002:   6695 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.972, expert1_balance_bottom=19.433, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.9, ups=0.56, wpb=386.3, bsz=32, num_updates=24370, lr=7.71065e-06, gnorm=3.811, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50799
2022-05-09 10:55:48 - progress_bar.py[line:272] - INFO: epoch 002:   6705 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.445, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.9, ups=0.56, wpb=377.9, bsz=32, num_updates=24380, lr=7.70945e-06, gnorm=3.531, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50816
2022-05-09 10:56:06 - progress_bar.py[line:272] - INFO: epoch 002:   6715 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.619, expert1_balance_bottom=19.458, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.2, ups=0.56, wpb=382.7, bsz=32, num_updates=24390, lr=7.70825e-06, gnorm=3.392, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50834
2022-05-09 10:56:24 - progress_bar.py[line:272] - INFO: epoch 002:   6725 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=32.76, expert1_balance_bottom=19.787, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.9, ups=0.56, wpb=385.7, bsz=32, num_updates=24400, lr=7.70705e-06, gnorm=3.426, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50852
2022-05-09 10:56:42 - progress_bar.py[line:272] - INFO: epoch 002:   6735 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=393.5, nsentences=32, sample_size=313.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866136, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=35.061, expert1_balance_bottom=19.063, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=217.6, ups=0.55, wpb=393.5, bsz=32, num_updates=24410, lr=7.70585e-06, gnorm=4.309, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50870
2022-05-09 10:57:00 - progress_bar.py[line:272] - INFO: epoch 002:   6745 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900353, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=32.944, expert1_balance_bottom=19.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=211.1, ups=0.55, wpb=381.1, bsz=32, num_updates=24420, lr=7.70464e-06, gnorm=3.087, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50888
2022-05-09 10:57:18 - progress_bar.py[line:272] - INFO: epoch 002:   6755 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=387, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883129, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.89, expert1_balance_bottom=19.372, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.8, ups=0.55, wpb=387, bsz=32, num_updates=24430, lr=7.70344e-06, gnorm=3.596, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50906
2022-05-09 10:57:37 - progress_bar.py[line:272] - INFO: epoch 002:   6765 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=377.6, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884585, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.742, expert1_balance_bottom=19.385, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=206.3, ups=0.55, wpb=377.6, bsz=32, num_updates=24440, lr=7.70224e-06, gnorm=3.293, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50925
2022-05-09 10:57:55 - progress_bar.py[line:272] - INFO: epoch 002:   6775 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=374.6, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890637, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.651, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=203.6, ups=0.54, wpb=374.6, bsz=32, num_updates=24450, lr=7.70104e-06, gnorm=3.306, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50943
2022-05-09 10:58:13 - progress_bar.py[line:272] - INFO: epoch 002:   6785 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=387.1, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.694, expert1_balance_bottom=19.712, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.9, ups=0.55, wpb=387.1, bsz=32, num_updates=24460, lr=7.69984e-06, gnorm=3.598, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50961
2022-05-09 10:58:31 - progress_bar.py[line:272] - INFO: epoch 002:   6795 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=388.8, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.735, expert1_balance_bottom=19.479, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.5, ups=0.56, wpb=388.8, bsz=32, num_updates=24470, lr=7.69864e-06, gnorm=3.777, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50979
2022-05-09 10:58:50 - progress_bar.py[line:272] - INFO: epoch 002:   6805 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877722, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.969, expert1_balance_bottom=19.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.6, ups=0.55, wpb=386.1, bsz=32, num_updates=24480, lr=7.69744e-06, gnorm=3.625, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=50998
2022-05-09 10:59:08 - progress_bar.py[line:272] - INFO: epoch 002:   6815 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=376.1, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.736, expert1_balance_bottom=19.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=206.4, ups=0.55, wpb=376.1, bsz=32, num_updates=24490, lr=7.69624e-06, gnorm=3.462, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51016
2022-05-09 10:59:25 - progress_bar.py[line:272] - INFO: epoch 002:   6825 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=387.3, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892349, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.085, expert1_balance_bottom=19.675, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.2, ups=0.56, wpb=387.3, bsz=32, num_updates=24500, lr=7.69503e-06, gnorm=3.877, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51034
2022-05-09 10:59:43 - progress_bar.py[line:272] - INFO: epoch 002:   6835 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=388.6, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877531, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.472, expert1_balance_bottom=19.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216.9, ups=0.56, wpb=388.6, bsz=32, num_updates=24510, lr=7.69383e-06, gnorm=3.663, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51051
2022-05-09 11:00:01 - progress_bar.py[line:272] - INFO: epoch 002:   6845 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=377.5, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888131, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.206, expert1_balance_bottom=19.078, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212, ups=0.56, wpb=377.5, bsz=32, num_updates=24520, lr=7.69263e-06, gnorm=3.771, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51069
2022-05-09 11:00:19 - progress_bar.py[line:272] - INFO: epoch 002:   6855 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=380.7, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.398, expert1_balance_bottom=19.69, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=208.9, ups=0.55, wpb=380.7, bsz=32, num_updates=24530, lr=7.69143e-06, gnorm=3.456, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51087
2022-05-09 11:00:38 - progress_bar.py[line:272] - INFO: epoch 002:   6865 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=387.3, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.599, expert1_balance_bottom=19.632, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.2, ups=0.55, wpb=387.3, bsz=32, num_updates=24540, lr=7.69023e-06, gnorm=3.688, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51106
2022-05-09 11:00:56 - progress_bar.py[line:272] - INFO: epoch 002:   6875 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=375.7, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.301, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=206, ups=0.55, wpb=375.7, bsz=32, num_updates=24550, lr=7.68903e-06, gnorm=3.555, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51124
2022-05-09 11:01:14 - progress_bar.py[line:272] - INFO: epoch 002:   6885 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=375.6, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.14, expert1_balance_top=33.392, expert1_balance_bottom=19.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=206.2, ups=0.55, wpb=375.6, bsz=32, num_updates=24560, lr=7.68783e-06, gnorm=3.608, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51142
2022-05-09 11:01:23 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 11:01:34 - progress_bar.py[line:272] - INFO: epoch 002:   6896 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=378.1, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.349, expert1_balance_bottom=19.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=189.8, ups=0.5, wpb=378.1, bsz=32, num_updates=24570, lr=7.68662e-06, gnorm=3.483, loss_scale=64, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51162
2022-05-09 11:01:52 - progress_bar.py[line:272] - INFO: epoch 002:   6906 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=378.1, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.391, expert1_balance_bottom=19.617, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=209.6, ups=0.55, wpb=378.1, bsz=32, num_updates=24580, lr=7.68542e-06, gnorm=3.225, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51180
2022-05-09 11:02:10 - progress_bar.py[line:272] - INFO: epoch 002:   6916 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884393, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.708, expert1_balance_bottom=19.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=208.8, ups=0.55, wpb=379.6, bsz=32, num_updates=24590, lr=7.68422e-06, gnorm=3.475, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51198
2022-05-09 11:02:28 - progress_bar.py[line:272] - INFO: epoch 002:   6926 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=382.7, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.746, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.4, ups=0.56, wpb=382.7, bsz=32, num_updates=24600, lr=7.68302e-06, gnorm=3.656, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51216
2022-05-09 11:02:46 - progress_bar.py[line:272] - INFO: epoch 002:   6936 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=389.8, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884034, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.032, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220.4, ups=0.57, wpb=389.8, bsz=32, num_updates=24610, lr=7.68182e-06, gnorm=3.529, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51234
2022-05-09 11:03:03 - progress_bar.py[line:272] - INFO: epoch 002:   6946 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885437, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.186, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=217.8, ups=0.56, wpb=386.3, bsz=32, num_updates=24620, lr=7.68062e-06, gnorm=3.917, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51251
2022-05-09 11:03:21 - progress_bar.py[line:272] - INFO: epoch 002:   6956 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=373.1, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.141, expert1_balance_top=33.04, expert1_balance_bottom=19.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.1, ups=0.56, wpb=373.1, bsz=32, num_updates=24630, lr=7.67942e-06, gnorm=3.486, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51269
2022-05-09 11:03:39 - progress_bar.py[line:272] - INFO: epoch 002:   6966 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.905, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.3, ups=0.56, wpb=383.9, bsz=32, num_updates=24640, lr=7.67822e-06, gnorm=3.362, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51287
2022-05-09 11:03:57 - progress_bar.py[line:272] - INFO: epoch 002:   6976 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896141, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.743, expert1_balance_bottom=19.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.5, ups=0.55, wpb=380.5, bsz=32, num_updates=24650, lr=7.67701e-06, gnorm=3.626, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51305
2022-05-09 11:04:15 - progress_bar.py[line:272] - INFO: epoch 002:   6986 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=383.4, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884632, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.064, expert1_balance_bottom=19.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.8, ups=0.55, wpb=383.4, bsz=32, num_updates=24660, lr=7.67581e-06, gnorm=4.004, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51323
2022-05-09 11:04:33 - progress_bar.py[line:272] - INFO: epoch 002:   6996 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=387.4, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.921, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.2, ups=0.55, wpb=387.4, bsz=32, num_updates=24670, lr=7.67461e-06, gnorm=3.698, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51341
2022-05-09 11:04:52 - progress_bar.py[line:272] - INFO: epoch 002:   7006 / 17711 loss=3.116, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=377.3, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882311, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.116, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.073, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=205.3, ups=0.54, wpb=377.3, bsz=32, num_updates=24680, lr=7.67341e-06, gnorm=4.006, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51360
2022-05-09 11:05:10 - progress_bar.py[line:272] - INFO: epoch 002:   7016 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=372.3, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885322, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.145, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=206.3, ups=0.55, wpb=372.3, bsz=32, num_updates=24690, lr=7.67221e-06, gnorm=3.951, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51378
2022-05-09 11:05:28 - progress_bar.py[line:272] - INFO: epoch 002:   7026 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=376.9, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.341, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=209, ups=0.55, wpb=376.9, bsz=32, num_updates=24700, lr=7.67101e-06, gnorm=4.203, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51396
2022-05-09 11:05:46 - progress_bar.py[line:272] - INFO: epoch 002:   7036 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=376.6, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.919, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=208.5, ups=0.55, wpb=376.6, bsz=32, num_updates=24710, lr=7.66981e-06, gnorm=3.769, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51414
2022-05-09 11:06:04 - progress_bar.py[line:272] - INFO: epoch 002:   7046 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=381.2, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889519, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.549, expert1_balance_bottom=19.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.5, ups=0.55, wpb=381.2, bsz=32, num_updates=24720, lr=7.6686e-06, gnorm=3.775, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51432
2022-05-09 11:06:22 - progress_bar.py[line:272] - INFO: epoch 002:   7056 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=379.5, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883154, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.144, expert1_balance_bottom=19.23, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=207.9, ups=0.55, wpb=379.5, bsz=32, num_updates=24730, lr=7.6674e-06, gnorm=3.87, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51450
2022-05-09 11:06:40 - progress_bar.py[line:272] - INFO: epoch 002:   7066 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=391.6, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.722, expert1_balance_bottom=19.032, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=215.1, ups=0.55, wpb=391.6, bsz=32, num_updates=24740, lr=7.6662e-06, gnorm=4.01, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51468
2022-05-09 11:06:58 - progress_bar.py[line:272] - INFO: epoch 002:   7076 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894392, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.356, expert1_balance_bottom=19.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=209.3, ups=0.55, wpb=380.7, bsz=32, num_updates=24750, lr=7.665e-06, gnorm=3.66, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51486
2022-05-09 11:07:17 - progress_bar.py[line:272] - INFO: epoch 002:   7086 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=383.5, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.534, expert1_balance_bottom=19.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.3, ups=0.55, wpb=383.5, bsz=32, num_updates=24760, lr=7.6638e-06, gnorm=3.79, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51505
2022-05-09 11:07:34 - progress_bar.py[line:272] - INFO: epoch 002:   7096 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=388.9, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.502, expert1_balance_bottom=19.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.8, ups=0.56, wpb=388.9, bsz=32, num_updates=24770, lr=7.6626e-06, gnorm=3.36, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51522
2022-05-09 11:07:38 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 11:07:54 - progress_bar.py[line:272] - INFO: epoch 002:   7107 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=395.1, nsentences=32, sample_size=314.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878794, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.016, expert1_balance_bottom=19.514, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=197.8, ups=0.5, wpb=395.1, bsz=32, num_updates=24780, lr=7.6614e-06, gnorm=3.792, loss_scale=32, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51542
2022-05-09 11:08:13 - progress_bar.py[line:272] - INFO: epoch 002:   7117 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=392.9, nsentences=32, sample_size=313.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880919, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.105, expert1_balance_bottom=19.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.3, ups=0.55, wpb=392.9, bsz=32, num_updates=24790, lr=7.6602e-06, gnorm=3.62, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51561
2022-05-09 11:08:31 - progress_bar.py[line:272] - INFO: epoch 002:   7127 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=393.6, nsentences=32, sample_size=312.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886765, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.557, expert1_balance_bottom=19.635, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.4, ups=0.55, wpb=393.6, bsz=32, num_updates=24800, lr=7.65899e-06, gnorm=3.839, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51579
2022-05-09 11:08:49 - progress_bar.py[line:272] - INFO: epoch 002:   7137 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=385.5, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885547, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.975, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.2, ups=0.55, wpb=385.5, bsz=32, num_updates=24810, lr=7.65779e-06, gnorm=2.991, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51597
2022-05-09 11:09:07 - progress_bar.py[line:272] - INFO: epoch 002:   7147 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890834, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.567, expert1_balance_bottom=19.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=208.3, ups=0.55, wpb=378.4, bsz=32, num_updates=24820, lr=7.65659e-06, gnorm=3.219, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51615
2022-05-09 11:09:25 - progress_bar.py[line:272] - INFO: epoch 002:   7157 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87519, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.745, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=208, ups=0.55, wpb=380.9, bsz=32, num_updates=24830, lr=7.65539e-06, gnorm=3.81, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51633
2022-05-09 11:09:43 - progress_bar.py[line:272] - INFO: epoch 002:   7167 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=387.9, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8817, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.667, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.8, ups=0.56, wpb=387.9, bsz=32, num_updates=24840, lr=7.65419e-06, gnorm=3.721, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51651
2022-05-09 11:10:02 - progress_bar.py[line:272] - INFO: epoch 002:   7177 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881707, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.625, expert1_balance_bottom=19.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=207.5, ups=0.54, wpb=381.6, bsz=32, num_updates=24850, lr=7.65299e-06, gnorm=3.065, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51670
2022-05-09 11:10:20 - progress_bar.py[line:272] - INFO: epoch 002:   7187 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=378.9, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.093, expert1_balance_bottom=19.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=208, ups=0.55, wpb=378.9, bsz=32, num_updates=24860, lr=7.65179e-06, gnorm=4.239, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51688
2022-05-09 11:10:38 - progress_bar.py[line:272] - INFO: epoch 002:   7197 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878043, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.926, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=207.2, ups=0.54, wpb=382.1, bsz=32, num_updates=24870, lr=7.65059e-06, gnorm=4.022, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51706
2022-05-09 11:10:57 - progress_bar.py[line:272] - INFO: epoch 002:   7207 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.953, expert1_balance_bottom=19.588, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206.6, ups=0.55, wpb=377.5, bsz=32, num_updates=24880, lr=7.64938e-06, gnorm=3.919, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51725
2022-05-09 11:11:15 - progress_bar.py[line:272] - INFO: epoch 002:   7217 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=384.9, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.455, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.4, ups=0.56, wpb=384.9, bsz=32, num_updates=24890, lr=7.64818e-06, gnorm=3.506, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51743
2022-05-09 11:11:33 - progress_bar.py[line:272] - INFO: epoch 002:   7227 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=382, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887626, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.193, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.5, ups=0.56, wpb=382, bsz=32, num_updates=24900, lr=7.64698e-06, gnorm=3.588, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51761
2022-05-09 11:11:51 - progress_bar.py[line:272] - INFO: epoch 002:   7237 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.443, expert1_balance_bottom=19.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.5, ups=0.55, wpb=378.2, bsz=32, num_updates=24910, lr=7.64578e-06, gnorm=3.29, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51779
2022-05-09 11:12:09 - progress_bar.py[line:272] - INFO: epoch 002:   7247 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.318, expert1_balance_bottom=19.175, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.9, ups=0.55, wpb=383.9, bsz=32, num_updates=24920, lr=7.64458e-06, gnorm=3.706, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51797
2022-05-09 11:12:26 - progress_bar.py[line:272] - INFO: epoch 002:   7257 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882433, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.255, expert1_balance_bottom=19.456, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=216.7, ups=0.57, wpb=383, bsz=32, num_updates=24930, lr=7.64338e-06, gnorm=3.819, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51815
2022-05-09 11:12:45 - progress_bar.py[line:272] - INFO: epoch 002:   7267 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=377.2, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.095, expert1_balance_bottom=19.808, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209, ups=0.55, wpb=377.2, bsz=32, num_updates=24940, lr=7.64218e-06, gnorm=3.397, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51833
2022-05-09 11:13:03 - progress_bar.py[line:272] - INFO: epoch 002:   7277 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=368.8, nsentences=32, sample_size=293.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901238, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.089, expert1_balance_bottom=19.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=204.1, ups=0.55, wpb=368.8, bsz=32, num_updates=24950, lr=7.64097e-06, gnorm=3.463, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51851
2022-05-09 11:13:21 - progress_bar.py[line:272] - INFO: epoch 002:   7287 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.732, expert1_balance_bottom=19.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.1, ups=0.55, wpb=385.9, bsz=32, num_updates=24960, lr=7.63977e-06, gnorm=3.379, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51869
2022-05-09 11:13:39 - progress_bar.py[line:272] - INFO: epoch 002:   7297 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.524, expert1_balance_bottom=19.086, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=208.7, ups=0.55, wpb=378.8, bsz=32, num_updates=24970, lr=7.63857e-06, gnorm=3.256, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51887
2022-05-09 11:13:57 - progress_bar.py[line:272] - INFO: epoch 002:   7307 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887973, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.003, expert1_balance_bottom=19.416, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.1, ups=0.56, wpb=377.1, bsz=32, num_updates=24980, lr=7.63737e-06, gnorm=3.732, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51905
2022-05-09 11:14:15 - progress_bar.py[line:272] - INFO: epoch 002:   7317 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=379.8, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.572, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=211.6, ups=0.56, wpb=379.8, bsz=32, num_updates=24990, lr=7.63617e-06, gnorm=3.458, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51923
2022-05-09 11:14:33 - progress_bar.py[line:272] - INFO: epoch 002:   7327 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=377.6, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890635, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.856, expert1_balance_bottom=19.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=208.6, ups=0.55, wpb=377.6, bsz=32, num_updates=25000, lr=7.63497e-06, gnorm=2.975, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=51941
2022-05-09 11:14:33 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 11:14:33 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 11:14:33 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 11:21:51 - train.py[line:517] - INFO: valid_step finished
2022-05-09 11:21:51 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 10.102 | loss_v1 0 | loss_v2 0 | nll_loss 8.448 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.991748 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.102 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.191 | expert1_balance_top 38.521 | expert1_balance_bottom 14.935 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 349.18 | cider 1.188 | wps 687.6 | wpb 481.7 | bsz 8 | num_updates 25000 | best_cider 1.198
2022-05-09 11:21:51 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 25000 updates
2022-05-09 11:21:51 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_25000-rank-0.pt
2022-05-09 11:21:51 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_25000-rank-0.pt
2022-05-09 11:22:00 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_25000-rank-0.pt
2022-05-09 11:22:00 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_25000-shared.pt
2022-05-09 11:22:09 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_25000-shared.pt
2022-05-09 11:22:20 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_25000-rank-0.pt (epoch 2 @ 25000 updates, score 1.188) (writing took 29.083607274107635 seconds)
2022-05-09 11:22:38 - progress_bar.py[line:272] - INFO: epoch 002:   7337 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88182, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.998, expert1_balance_bottom=19.629, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=7.9, ups=0.02, wpb=381.2, bsz=32, num_updates=25010, lr=7.63377e-06, gnorm=3.662, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52426
2022-05-09 11:22:56 - progress_bar.py[line:272] - INFO: epoch 002:   7347 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.696, expert1_balance_bottom=19.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=219, ups=0.57, wpb=382.3, bsz=32, num_updates=25020, lr=7.63257e-06, gnorm=3.362, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52444
2022-05-09 11:23:13 - progress_bar.py[line:272] - INFO: epoch 002:   7357 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=378.5, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.472, expert1_balance_bottom=19.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=213.1, ups=0.56, wpb=378.5, bsz=32, num_updates=25030, lr=7.63136e-06, gnorm=3.244, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52461
2022-05-09 11:23:32 - progress_bar.py[line:272] - INFO: epoch 002:   7367 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=375.7, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.182, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=205.8, ups=0.55, wpb=375.7, bsz=32, num_updates=25040, lr=7.63016e-06, gnorm=3.181, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52480
2022-05-09 11:23:50 - progress_bar.py[line:272] - INFO: epoch 002:   7377 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=390.2, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883177, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.941, expert1_balance_bottom=19.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=215.3, ups=0.55, wpb=390.2, bsz=32, num_updates=25050, lr=7.62896e-06, gnorm=4.123, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52498
2022-05-09 11:24:08 - progress_bar.py[line:272] - INFO: epoch 002:   7387 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.332, expert1_balance_bottom=19.738, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212, ups=0.56, wpb=381.9, bsz=32, num_updates=25060, lr=7.62776e-06, gnorm=3.126, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52516
2022-05-09 11:24:26 - progress_bar.py[line:272] - INFO: epoch 002:   7397 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=376.8, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883423, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.014, expert1_balance_bottom=19.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209, ups=0.55, wpb=376.8, bsz=32, num_updates=25070, lr=7.62656e-06, gnorm=3.382, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52534
2022-05-09 11:24:44 - progress_bar.py[line:272] - INFO: epoch 002:   7407 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.775, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.8, ups=0.56, wpb=378.4, bsz=32, num_updates=25080, lr=7.62536e-06, gnorm=3.37, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52552
2022-05-09 11:25:01 - progress_bar.py[line:272] - INFO: epoch 002:   7417 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876853, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.485, expert1_balance_bottom=19.157, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215, ups=0.56, wpb=382.3, bsz=32, num_updates=25090, lr=7.62416e-06, gnorm=3.464, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52569
2022-05-09 11:25:19 - progress_bar.py[line:272] - INFO: epoch 002:   7427 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=387.1, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884479, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.082, expert1_balance_bottom=19.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.9, ups=0.57, wpb=387.1, bsz=32, num_updates=25100, lr=7.62295e-06, gnorm=3.235, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52587
2022-05-09 11:25:37 - progress_bar.py[line:272] - INFO: epoch 002:   7437 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=33.769, expert1_balance_bottom=19.536, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.7, ups=0.56, wpb=377.1, bsz=32, num_updates=25110, lr=7.62175e-06, gnorm=3.235, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52605
2022-05-09 11:25:55 - progress_bar.py[line:272] - INFO: epoch 002:   7447 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=378.5, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.808, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=210.3, ups=0.56, wpb=378.5, bsz=32, num_updates=25120, lr=7.62055e-06, gnorm=3.512, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52623
2022-05-09 11:26:13 - progress_bar.py[line:272] - INFO: epoch 002:   7457 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878214, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.299, expert1_balance_bottom=19.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=212.7, ups=0.55, wpb=388, bsz=32, num_updates=25130, lr=7.61935e-06, gnorm=3.646, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52641
2022-05-09 11:26:31 - progress_bar.py[line:272] - INFO: epoch 002:   7467 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.568, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.8, ups=0.55, wpb=385.4, bsz=32, num_updates=25140, lr=7.61815e-06, gnorm=3.187, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52659
2022-05-09 11:26:50 - progress_bar.py[line:272] - INFO: epoch 002:   7477 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=375.3, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.891, expert1_balance_bottom=19.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=204.2, ups=0.54, wpb=375.3, bsz=32, num_updates=25150, lr=7.61695e-06, gnorm=3.222, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52678
2022-05-09 11:27:08 - progress_bar.py[line:272] - INFO: epoch 002:   7487 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=385.7, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.32, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.2, ups=0.55, wpb=385.7, bsz=32, num_updates=25160, lr=7.61575e-06, gnorm=3.156, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52696
2022-05-09 11:27:26 - progress_bar.py[line:272] - INFO: epoch 002:   7497 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877065, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.596, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212, ups=0.56, wpb=378.7, bsz=32, num_updates=25170, lr=7.61455e-06, gnorm=3.057, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52714
2022-05-09 11:27:44 - progress_bar.py[line:272] - INFO: epoch 002:   7507 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880223, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.251, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.5, ups=0.55, wpb=385, bsz=32, num_updates=25180, lr=7.61334e-06, gnorm=3.512, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52732
2022-05-09 11:28:02 - progress_bar.py[line:272] - INFO: epoch 002:   7517 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=374.8, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893275, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.511, expert1_balance_bottom=19.479, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=206.3, ups=0.55, wpb=374.8, bsz=32, num_updates=25190, lr=7.61214e-06, gnorm=3.484, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52750
2022-05-09 11:28:20 - progress_bar.py[line:272] - INFO: epoch 002:   7527 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=375.5, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.987, expert1_balance_bottom=19.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=207.8, ups=0.55, wpb=375.5, bsz=32, num_updates=25200, lr=7.61094e-06, gnorm=3.697, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52768
2022-05-09 11:28:38 - progress_bar.py[line:272] - INFO: epoch 002:   7537 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.6, expert1_balance_bottom=19.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=207.7, ups=0.55, wpb=379.2, bsz=32, num_updates=25210, lr=7.60974e-06, gnorm=3.427, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52786
2022-05-09 11:28:56 - progress_bar.py[line:272] - INFO: epoch 002:   7547 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=377.3, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889063, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.887, expert1_balance_bottom=19.584, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=208.5, ups=0.55, wpb=377.3, bsz=32, num_updates=25220, lr=7.60854e-06, gnorm=3.195, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52804
2022-05-09 11:29:14 - progress_bar.py[line:272] - INFO: epoch 002:   7557 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=385.1, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888497, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.817, expert1_balance_bottom=19.392, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=213, ups=0.55, wpb=385.1, bsz=32, num_updates=25230, lr=7.60734e-06, gnorm=4.019, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52822
2022-05-09 11:29:32 - progress_bar.py[line:272] - INFO: epoch 002:   7567 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887699, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.17, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.3, ups=0.56, wpb=382, bsz=32, num_updates=25240, lr=7.60614e-06, gnorm=3.09, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52840
2022-05-09 11:29:50 - progress_bar.py[line:272] - INFO: epoch 002:   7577 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=377.5, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.44, expert1_balance_bottom=19.312, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.2, ups=0.56, wpb=377.5, bsz=32, num_updates=25250, lr=7.60494e-06, gnorm=3.528, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52858
2022-05-09 11:30:08 - progress_bar.py[line:272] - INFO: epoch 002:   7587 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=380.4, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886217, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.814, expert1_balance_bottom=19.582, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.6, ups=0.55, wpb=380.4, bsz=32, num_updates=25260, lr=7.60373e-06, gnorm=3.436, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52876
2022-05-09 11:30:26 - progress_bar.py[line:272] - INFO: epoch 002:   7597 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=375.6, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884866, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.111, expert1_balance_bottom=19.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=208.7, ups=0.56, wpb=375.6, bsz=32, num_updates=25270, lr=7.60253e-06, gnorm=3.314, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52894
2022-05-09 11:30:45 - progress_bar.py[line:272] - INFO: epoch 002:   7607 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882066, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.629, expert1_balance_bottom=18.938, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=207.2, ups=0.55, wpb=379.5, bsz=32, num_updates=25280, lr=7.60133e-06, gnorm=3.472, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52913
2022-05-09 11:31:03 - progress_bar.py[line:272] - INFO: epoch 002:   7617 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.556, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=213.4, ups=0.56, wpb=384.3, bsz=32, num_updates=25290, lr=7.60013e-06, gnorm=3.672, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52931
2022-05-09 11:31:21 - progress_bar.py[line:272] - INFO: epoch 002:   7627 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.086, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=207.6, ups=0.54, wpb=381.2, bsz=32, num_updates=25300, lr=7.59893e-06, gnorm=3.827, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52949
2022-05-09 11:31:39 - progress_bar.py[line:272] - INFO: epoch 002:   7637 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=381.6, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.381, expert1_balance_bottom=19.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.7, ups=0.56, wpb=381.6, bsz=32, num_updates=25310, lr=7.59773e-06, gnorm=3.714, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52967
2022-05-09 11:31:57 - progress_bar.py[line:272] - INFO: epoch 002:   7647 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=390.2, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878427, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.336, expert1_balance_bottom=19.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=219.3, ups=0.56, wpb=390.2, bsz=32, num_updates=25320, lr=7.59653e-06, gnorm=3.687, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=52985
2022-05-09 11:32:15 - progress_bar.py[line:272] - INFO: epoch 002:   7657 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=378, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889662, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.989, expert1_balance_bottom=19.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210.6, ups=0.56, wpb=378, bsz=32, num_updates=25330, lr=7.59532e-06, gnorm=3.552, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53003
2022-05-09 11:32:33 - progress_bar.py[line:272] - INFO: epoch 002:   7667 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=379.3, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.369, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.7, ups=0.56, wpb=379.3, bsz=32, num_updates=25340, lr=7.59412e-06, gnorm=3.446, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53021
2022-05-09 11:32:51 - progress_bar.py[line:272] - INFO: epoch 002:   7677 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=383.6, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885681, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.06, expert1_balance_bottom=19.395, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209.9, ups=0.55, wpb=383.6, bsz=32, num_updates=25350, lr=7.59292e-06, gnorm=3.095, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53039
2022-05-09 11:33:09 - progress_bar.py[line:272] - INFO: epoch 002:   7687 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=381.1, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.636, expert1_balance_bottom=19.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210.5, ups=0.55, wpb=381.1, bsz=32, num_updates=25360, lr=7.59172e-06, gnorm=4.036, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53057
2022-05-09 11:33:27 - progress_bar.py[line:272] - INFO: epoch 002:   7697 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=373.9, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889341, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=34.008, expert1_balance_bottom=19.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=208.5, ups=0.56, wpb=373.9, bsz=32, num_updates=25370, lr=7.59052e-06, gnorm=3.191, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53075
2022-05-09 11:33:45 - progress_bar.py[line:272] - INFO: epoch 002:   7707 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=385.9, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868756, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=35.494, expert1_balance_bottom=18.951, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216, ups=0.56, wpb=385.9, bsz=32, num_updates=25380, lr=7.58932e-06, gnorm=3.301, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53093
2022-05-09 11:34:03 - progress_bar.py[line:272] - INFO: epoch 002:   7717 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=376.6, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887238, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=34.046, expert1_balance_bottom=19.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=208.3, ups=0.55, wpb=376.6, bsz=32, num_updates=25390, lr=7.58812e-06, gnorm=3.663, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53111
2022-05-09 11:34:21 - progress_bar.py[line:272] - INFO: epoch 002:   7727 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=373.5, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888905, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.909, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=208, ups=0.56, wpb=373.5, bsz=32, num_updates=25400, lr=7.58692e-06, gnorm=3.096, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53129
2022-05-09 11:34:39 - progress_bar.py[line:272] - INFO: epoch 002:   7737 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=392.6, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.38, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.1, ups=0.54, wpb=392.6, bsz=32, num_updates=25410, lr=7.58571e-06, gnorm=3.495, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53147
2022-05-09 11:34:57 - progress_bar.py[line:272] - INFO: epoch 002:   7747 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886685, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.219, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=207.4, ups=0.55, wpb=378.5, bsz=32, num_updates=25420, lr=7.58451e-06, gnorm=3.076, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53165
2022-05-09 11:35:16 - progress_bar.py[line:272] - INFO: epoch 002:   7757 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=388.9, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.863981, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=35.145, expert1_balance_bottom=19.024, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213, ups=0.55, wpb=388.9, bsz=32, num_updates=25430, lr=7.58331e-06, gnorm=3.27, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53184
2022-05-09 11:35:34 - progress_bar.py[line:272] - INFO: epoch 002:   7767 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=378.6, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892546, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=33.478, expert1_balance_bottom=19.493, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=209.5, ups=0.55, wpb=378.6, bsz=32, num_updates=25440, lr=7.58211e-06, gnorm=3.201, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53202
2022-05-09 11:35:52 - progress_bar.py[line:272] - INFO: epoch 002:   7777 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=383.7, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88461, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.257, expert1_balance_bottom=19.226, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210.7, ups=0.55, wpb=383.7, bsz=32, num_updates=25450, lr=7.58091e-06, gnorm=3.471, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53220
2022-05-09 11:36:10 - progress_bar.py[line:272] - INFO: epoch 002:   7787 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=382.8, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.271, expert1_balance_bottom=19.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=215.6, ups=0.56, wpb=382.8, bsz=32, num_updates=25460, lr=7.57971e-06, gnorm=3.289, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53238
2022-05-09 11:36:28 - progress_bar.py[line:272] - INFO: epoch 002:   7797 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898562, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.614, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=212.7, ups=0.56, wpb=381.6, bsz=32, num_updates=25470, lr=7.57851e-06, gnorm=3.372, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53256
2022-05-09 11:36:46 - progress_bar.py[line:272] - INFO: epoch 002:   7807 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889213, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.159, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=210.9, ups=0.55, wpb=382.7, bsz=32, num_updates=25480, lr=7.5773e-06, gnorm=3.252, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53274
2022-05-09 11:37:04 - progress_bar.py[line:272] - INFO: epoch 002:   7817 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=401.8, nsentences=32, sample_size=320, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878063, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.625, expert1_balance_bottom=19.164, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.8, ups=0.55, wpb=401.8, bsz=32, num_updates=25490, lr=7.5761e-06, gnorm=3.275, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53292
2022-05-09 11:37:22 - progress_bar.py[line:272] - INFO: epoch 002:   7827 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=392.1, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88196, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.438, expert1_balance_bottom=19.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.2, ups=0.56, wpb=392.1, bsz=32, num_updates=25500, lr=7.5749e-06, gnorm=3.201, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53310
2022-05-09 11:37:40 - progress_bar.py[line:272] - INFO: epoch 002:   7837 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=381.5, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875181, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.597, expert1_balance_bottom=19.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=211.2, ups=0.55, wpb=381.5, bsz=32, num_updates=25510, lr=7.5737e-06, gnorm=3.784, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53328
2022-05-09 11:37:58 - progress_bar.py[line:272] - INFO: epoch 002:   7847 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=387.2, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876901, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.769, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211, ups=0.54, wpb=387.2, bsz=32, num_updates=25520, lr=7.5725e-06, gnorm=3.096, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53346
2022-05-09 11:38:16 - progress_bar.py[line:272] - INFO: epoch 002:   7857 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=389.4, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877626, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.384, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=217.3, ups=0.56, wpb=389.4, bsz=32, num_updates=25530, lr=7.5713e-06, gnorm=3.26, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53364
2022-05-09 11:38:34 - progress_bar.py[line:272] - INFO: epoch 002:   7867 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=391.6, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=35.042, expert1_balance_bottom=19.14, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=216.8, ups=0.55, wpb=391.6, bsz=32, num_updates=25540, lr=7.5701e-06, gnorm=3.245, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53382
2022-05-09 11:38:52 - progress_bar.py[line:272] - INFO: epoch 002:   7877 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=376, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896333, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.137, expert1_balance_top=33.778, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=208.3, ups=0.55, wpb=376, bsz=32, num_updates=25550, lr=7.5689e-06, gnorm=3.1, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53400
2022-05-09 11:39:11 - progress_bar.py[line:272] - INFO: epoch 002:   7887 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=373.3, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.259, expert1_balance_bottom=19.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=203.6, ups=0.55, wpb=373.3, bsz=32, num_updates=25560, lr=7.56769e-06, gnorm=4.295, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53419
2022-05-09 11:39:29 - progress_bar.py[line:272] - INFO: epoch 002:   7897 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=380.3, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887772, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.812, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.1, ups=0.55, wpb=380.3, bsz=32, num_updates=25570, lr=7.56649e-06, gnorm=4.183, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53437
2022-05-09 11:39:47 - progress_bar.py[line:272] - INFO: epoch 002:   7907 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=386, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887182, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.874, expert1_balance_bottom=19.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.5, ups=0.55, wpb=386, bsz=32, num_updates=25580, lr=7.56529e-06, gnorm=3.172, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53455
2022-05-09 11:40:05 - progress_bar.py[line:272] - INFO: epoch 002:   7917 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=385, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.906361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=32.579, expert1_balance_bottom=19.745, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.7, ups=0.55, wpb=385, bsz=32, num_updates=25590, lr=7.56409e-06, gnorm=3.154, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53473
2022-05-09 11:40:23 - progress_bar.py[line:272] - INFO: epoch 002:   7927 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=395.2, nsentences=32, sample_size=314.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875991, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.183, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.8, ups=0.55, wpb=395.2, bsz=32, num_updates=25600, lr=7.56289e-06, gnorm=3.043, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53491
2022-05-09 11:40:41 - progress_bar.py[line:272] - INFO: epoch 002:   7937 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=376.9, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.684, expert1_balance_bottom=19.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=207.9, ups=0.55, wpb=376.9, bsz=32, num_updates=25610, lr=7.56169e-06, gnorm=3.491, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53510
2022-05-09 11:40:59 - progress_bar.py[line:272] - INFO: epoch 002:   7947 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883859, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.883, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=213.1, ups=0.56, wpb=383.4, bsz=32, num_updates=25620, lr=7.56049e-06, gnorm=3.249, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53528
2022-05-09 11:41:18 - progress_bar.py[line:272] - INFO: epoch 002:   7957 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=382.9, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880962, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.049, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.2, ups=0.55, wpb=382.9, bsz=32, num_updates=25630, lr=7.55928e-06, gnorm=3.298, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53546
2022-05-09 11:41:35 - progress_bar.py[line:272] - INFO: epoch 002:   7967 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=379.3, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876747, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.49, expert1_balance_bottom=19.327, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=214.8, ups=0.57, wpb=379.3, bsz=32, num_updates=25640, lr=7.55808e-06, gnorm=3.592, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53563
2022-05-09 11:41:53 - progress_bar.py[line:272] - INFO: epoch 002:   7977 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=387.8, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875707, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.621, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.5, ups=0.56, wpb=387.8, bsz=32, num_updates=25650, lr=7.55688e-06, gnorm=3.64, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53581
2022-05-09 11:42:11 - progress_bar.py[line:272] - INFO: epoch 002:   7987 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=387.5, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.396, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.6, ups=0.56, wpb=387.5, bsz=32, num_updates=25660, lr=7.55568e-06, gnorm=3.663, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53599
2022-05-09 11:42:29 - progress_bar.py[line:272] - INFO: epoch 002:   7997 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=391.3, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877416, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.996, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.7, ups=0.55, wpb=391.3, bsz=32, num_updates=25670, lr=7.55448e-06, gnorm=3.363, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53617
2022-05-09 11:42:47 - progress_bar.py[line:272] - INFO: epoch 002:   8007 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=35.016, expert1_balance_bottom=19.04, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210.7, ups=0.55, wpb=382.1, bsz=32, num_updates=25680, lr=7.55328e-06, gnorm=3.673, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53635
2022-05-09 11:43:05 - progress_bar.py[line:272] - INFO: epoch 002:   8017 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=384.7, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881504, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.331, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.1, ups=0.56, wpb=384.7, bsz=32, num_updates=25690, lr=7.55208e-06, gnorm=3.271, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53653
2022-05-09 11:43:23 - progress_bar.py[line:272] - INFO: epoch 002:   8027 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.555, expert1_balance_bottom=19.102, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.2, ups=0.55, wpb=386, bsz=32, num_updates=25700, lr=7.55088e-06, gnorm=3.534, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53671
2022-05-09 11:43:40 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 11:43:43 - progress_bar.py[line:272] - INFO: epoch 002:   8038 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=376.2, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.125, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=189.2, ups=0.5, wpb=376.2, bsz=32, num_updates=25710, lr=7.54967e-06, gnorm=4.216, loss_scale=32, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53691
2022-05-09 11:44:01 - progress_bar.py[line:272] - INFO: epoch 002:   8048 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=391, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=35.092, expert1_balance_bottom=19.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.2, ups=0.56, wpb=391, bsz=32, num_updates=25720, lr=7.54847e-06, gnorm=3.243, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53709
2022-05-09 11:44:19 - progress_bar.py[line:272] - INFO: epoch 002:   8058 / 17711 loss=3.141, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887682, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.141, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.9, expert1_balance_bottom=19.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=210.3, ups=0.55, wpb=383.1, bsz=32, num_updates=25730, lr=7.54727e-06, gnorm=3.737, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53728
2022-05-09 11:44:38 - progress_bar.py[line:272] - INFO: epoch 002:   8068 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=395.3, nsentences=32, sample_size=314.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878065, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.362, expert1_balance_bottom=19.354, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=217.9, ups=0.55, wpb=395.3, bsz=32, num_updates=25740, lr=7.54607e-06, gnorm=4.046, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53746
2022-05-09 11:44:56 - progress_bar.py[line:272] - INFO: epoch 002:   8078 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.205, expert1_balance_bottom=19.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209, ups=0.55, wpb=381.9, bsz=32, num_updates=25750, lr=7.54487e-06, gnorm=3.406, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53764
2022-05-09 11:45:14 - progress_bar.py[line:272] - INFO: epoch 002:   8088 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=374.9, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883569, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.211, expert1_balance_bottom=19.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=205.1, ups=0.55, wpb=374.9, bsz=32, num_updates=25760, lr=7.54367e-06, gnorm=3.444, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53782
2022-05-09 11:45:33 - progress_bar.py[line:272] - INFO: epoch 002:   8098 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881821, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.483, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=207.1, ups=0.54, wpb=381.7, bsz=32, num_updates=25770, lr=7.54247e-06, gnorm=4.099, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53801
2022-05-09 11:45:51 - progress_bar.py[line:272] - INFO: epoch 002:   8108 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=383, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891105, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.683, expert1_balance_bottom=19.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=209.1, ups=0.55, wpb=383, bsz=32, num_updates=25780, lr=7.54127e-06, gnorm=3.28, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53819
2022-05-09 11:46:09 - progress_bar.py[line:272] - INFO: epoch 002:   8118 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=34.141, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.7, ups=0.55, wpb=384.3, bsz=32, num_updates=25790, lr=7.54006e-06, gnorm=3.878, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53837
2022-05-09 11:46:27 - progress_bar.py[line:272] - INFO: epoch 002:   8128 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883329, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.272, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=211.6, ups=0.55, wpb=381.8, bsz=32, num_updates=25800, lr=7.53886e-06, gnorm=3.213, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53855
2022-05-09 11:46:46 - progress_bar.py[line:272] - INFO: epoch 002:   8138 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.224, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.6, ups=0.55, wpb=383.9, bsz=32, num_updates=25810, lr=7.53766e-06, gnorm=3.416, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53874
2022-05-09 11:47:04 - progress_bar.py[line:272] - INFO: epoch 002:   8148 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885589, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.99, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.6, ups=0.55, wpb=385, bsz=32, num_updates=25820, lr=7.53646e-06, gnorm=3.96, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53892
2022-05-09 11:47:22 - progress_bar.py[line:272] - INFO: epoch 002:   8158 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=374.3, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.079, expert1_balance_bottom=19.684, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=206.3, ups=0.55, wpb=374.3, bsz=32, num_updates=25830, lr=7.53526e-06, gnorm=3.329, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53910
2022-05-09 11:47:40 - progress_bar.py[line:272] - INFO: epoch 002:   8168 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.167, expert1_balance_bottom=19.757, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=208.7, ups=0.54, wpb=383, bsz=32, num_updates=25840, lr=7.53406e-06, gnorm=4.182, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53928
2022-05-09 11:47:58 - progress_bar.py[line:272] - INFO: epoch 002:   8178 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=383.3, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879634, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.395, expert1_balance_bottom=19.3, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=209.9, ups=0.55, wpb=383.3, bsz=32, num_updates=25850, lr=7.53286e-06, gnorm=3.788, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53946
2022-05-09 11:48:16 - progress_bar.py[line:272] - INFO: epoch 002:   8188 / 17711 loss=3.095, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=372.4, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894091, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.095, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.478, expert1_balance_bottom=19.563, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=206.8, ups=0.56, wpb=372.4, bsz=32, num_updates=25860, lr=7.53165e-06, gnorm=3.447, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53964
2022-05-09 11:48:34 - progress_bar.py[line:272] - INFO: epoch 002:   8198 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=380.5, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886715, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.754, expert1_balance_bottom=19.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210.5, ups=0.55, wpb=380.5, bsz=32, num_updates=25870, lr=7.53045e-06, gnorm=3.678, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=53983
2022-05-09 11:48:53 - progress_bar.py[line:272] - INFO: epoch 002:   8208 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=385.7, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.857, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.5, ups=0.55, wpb=385.7, bsz=32, num_updates=25880, lr=7.52925e-06, gnorm=3.072, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54001
2022-05-09 11:49:11 - progress_bar.py[line:272] - INFO: epoch 002:   8218 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.855, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.5, ups=0.56, wpb=381.2, bsz=32, num_updates=25890, lr=7.52805e-06, gnorm=3.412, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54019
2022-05-09 11:49:28 - progress_bar.py[line:272] - INFO: epoch 002:   8228 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=383.5, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.196, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.7, ups=0.57, wpb=383.5, bsz=32, num_updates=25900, lr=7.52685e-06, gnorm=3.815, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54036
2022-05-09 11:49:46 - progress_bar.py[line:272] - INFO: epoch 002:   8238 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=389.6, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879107, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.367, expert1_balance_bottom=19.23, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.4, ups=0.56, wpb=389.6, bsz=32, num_updates=25910, lr=7.52565e-06, gnorm=3.99, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54054
2022-05-09 11:50:04 - progress_bar.py[line:272] - INFO: epoch 002:   8248 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=377, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.803, expert1_balance_bottom=19.357, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=210.1, ups=0.56, wpb=377, bsz=32, num_updates=25920, lr=7.52445e-06, gnorm=3.445, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54072
2022-05-09 11:50:22 - progress_bar.py[line:272] - INFO: epoch 002:   8258 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=388.3, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882417, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.226, expert1_balance_bottom=19.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210.5, ups=0.54, wpb=388.3, bsz=32, num_updates=25930, lr=7.52325e-06, gnorm=3.748, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54091
2022-05-09 11:50:40 - progress_bar.py[line:272] - INFO: epoch 002:   8268 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=380.3, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.641, expert1_balance_bottom=19.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=211.6, ups=0.56, wpb=380.3, bsz=32, num_updates=25940, lr=7.52204e-06, gnorm=3.078, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54108
2022-05-09 11:50:59 - progress_bar.py[line:272] - INFO: epoch 002:   8278 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=389.6, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.559, expert1_balance_bottom=19.23, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=214.4, ups=0.55, wpb=389.6, bsz=32, num_updates=25950, lr=7.52084e-06, gnorm=3.359, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54127
2022-05-09 11:51:17 - progress_bar.py[line:272] - INFO: epoch 002:   8288 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876355, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=35.031, expert1_balance_bottom=19.162, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.6, ups=0.55, wpb=385.7, bsz=32, num_updates=25960, lr=7.51964e-06, gnorm=3.164, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54145
2022-05-09 11:51:35 - progress_bar.py[line:272] - INFO: epoch 002:   8298 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89075, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.805, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.8, ups=0.56, wpb=384.1, bsz=32, num_updates=25970, lr=7.51844e-06, gnorm=3.39, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54163
2022-05-09 11:51:53 - progress_bar.py[line:272] - INFO: epoch 002:   8308 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883151, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.217, expert1_balance_bottom=19.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.1, ups=0.55, wpb=381.7, bsz=32, num_updates=25980, lr=7.51724e-06, gnorm=3.531, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54181
2022-05-09 11:52:11 - progress_bar.py[line:272] - INFO: epoch 002:   8318 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.177, expert1_balance_bottom=19.476, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=212.6, ups=0.56, wpb=381.6, bsz=32, num_updates=25990, lr=7.51604e-06, gnorm=3.3, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54199
2022-05-09 11:52:29 - progress_bar.py[line:272] - INFO: epoch 002:   8328 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=383.5, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.719, expert1_balance_bottom=19.268, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=210.7, ups=0.55, wpb=383.5, bsz=32, num_updates=26000, lr=7.51484e-06, gnorm=3.653, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54217
2022-05-09 11:52:29 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 11:52:29 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 11:52:29 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 11:59:53 - train.py[line:517] - INFO: valid_step finished
2022-05-09 11:59:53 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 10.131 | loss_v1 0 | loss_v2 0 | nll_loss 8.483 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.993584 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.131 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.189 | expert1_balance_top 38.797 | expert1_balance_bottom 14.92 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 357.81 | cider 1.194 | wps 679.2 | wpb 481.7 | bsz 8 | num_updates 26000 | best_cider 1.198
2022-05-09 12:00:11 - progress_bar.py[line:272] - INFO: epoch 002:   8338 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=384.4, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881719, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.428, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=8.3, ups=0.02, wpb=384.4, bsz=32, num_updates=26010, lr=7.51363e-06, gnorm=3.154, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54679
2022-05-09 12:00:29 - progress_bar.py[line:272] - INFO: epoch 002:   8348 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.974, expert1_balance_bottom=19.359, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215.2, ups=0.57, wpb=379.5, bsz=32, num_updates=26020, lr=7.51243e-06, gnorm=3.324, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54697
2022-05-09 12:00:46 - progress_bar.py[line:272] - INFO: epoch 002:   8358 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=376.8, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.191, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.7, ups=0.56, wpb=376.8, bsz=32, num_updates=26030, lr=7.51123e-06, gnorm=3.331, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54714
2022-05-09 12:01:05 - progress_bar.py[line:272] - INFO: epoch 002:   8368 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=378, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.867, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206.2, ups=0.55, wpb=378, bsz=32, num_updates=26040, lr=7.51003e-06, gnorm=3.759, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54733
2022-05-09 12:01:23 - progress_bar.py[line:272] - INFO: epoch 002:   8378 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=385.8, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=34.003, expert1_balance_bottom=19.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.4, ups=0.55, wpb=385.8, bsz=32, num_updates=26050, lr=7.50883e-06, gnorm=3.691, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54751
2022-05-09 12:01:41 - progress_bar.py[line:272] - INFO: epoch 002:   8388 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.501, expert1_balance_bottom=19.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=207.9, ups=0.54, wpb=382.5, bsz=32, num_updates=26060, lr=7.50763e-06, gnorm=3.383, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54769
2022-05-09 12:01:59 - progress_bar.py[line:272] - INFO: epoch 002:   8398 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=379.8, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.165, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=208.9, ups=0.55, wpb=379.8, bsz=32, num_updates=26070, lr=7.50643e-06, gnorm=3.842, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54787
2022-05-09 12:02:18 - progress_bar.py[line:272] - INFO: epoch 002:   8408 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877573, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.274, expert1_balance_bottom=19.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.9, ups=0.55, wpb=382.8, bsz=32, num_updates=26080, lr=7.50523e-06, gnorm=3.755, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54806
2022-05-09 12:02:36 - progress_bar.py[line:272] - INFO: epoch 002:   8418 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=387.6, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877532, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.337, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.5, ups=0.55, wpb=387.6, bsz=32, num_updates=26090, lr=7.50402e-06, gnorm=3.659, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54824
2022-05-09 12:02:54 - progress_bar.py[line:272] - INFO: epoch 002:   8428 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=379.6, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.366, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=209.1, ups=0.55, wpb=379.6, bsz=32, num_updates=26100, lr=7.50282e-06, gnorm=3.687, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54842
2022-05-09 12:03:13 - progress_bar.py[line:272] - INFO: epoch 002:   8438 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=375.9, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.627, expert1_balance_bottom=19.599, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=204.1, ups=0.54, wpb=375.9, bsz=32, num_updates=26110, lr=7.50162e-06, gnorm=3.488, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54861
2022-05-09 12:03:31 - progress_bar.py[line:272] - INFO: epoch 002:   8448 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=380.2, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.048, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=208.1, ups=0.55, wpb=380.2, bsz=32, num_updates=26120, lr=7.50042e-06, gnorm=2.962, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54879
2022-05-09 12:03:49 - progress_bar.py[line:272] - INFO: epoch 002:   8458 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=382.6, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.479, expert1_balance_bottom=19.69, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=207.5, ups=0.54, wpb=382.6, bsz=32, num_updates=26130, lr=7.49922e-06, gnorm=3.225, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54897
2022-05-09 12:04:08 - progress_bar.py[line:272] - INFO: epoch 002:   8468 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=381.3, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.879, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=205.3, ups=0.54, wpb=381.3, bsz=32, num_updates=26140, lr=7.49802e-06, gnorm=3.554, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54916
2022-05-09 12:04:26 - progress_bar.py[line:272] - INFO: epoch 002:   8478 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=388, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.572, expert1_balance_bottom=19.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.5, ups=0.55, wpb=388, bsz=32, num_updates=26150, lr=7.49682e-06, gnorm=3.59, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54934
2022-05-09 12:04:44 - progress_bar.py[line:272] - INFO: epoch 002:   8488 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=392.1, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884535, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.292, expert1_balance_bottom=19.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=213.9, ups=0.55, wpb=392.1, bsz=32, num_updates=26160, lr=7.49562e-06, gnorm=3.439, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54952
2022-05-09 12:05:02 - progress_bar.py[line:272] - INFO: epoch 002:   8498 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=384, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.993, expert1_balance_bottom=19.557, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.9, ups=0.56, wpb=384, bsz=32, num_updates=26170, lr=7.49441e-06, gnorm=3.496, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54970
2022-05-09 12:05:21 - progress_bar.py[line:272] - INFO: epoch 002:   8508 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=383, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.332, expert1_balance_bottom=19.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.1, ups=0.55, wpb=383, bsz=32, num_updates=26180, lr=7.49321e-06, gnorm=3.409, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=54989
2022-05-09 12:05:39 - progress_bar.py[line:272] - INFO: epoch 002:   8518 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=389.1, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.567, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214, ups=0.55, wpb=389.1, bsz=32, num_updates=26190, lr=7.49201e-06, gnorm=3.658, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55007
2022-05-09 12:05:57 - progress_bar.py[line:272] - INFO: epoch 002:   8528 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=378.3, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887395, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.918, expert1_balance_bottom=19.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=208.5, ups=0.55, wpb=378.3, bsz=32, num_updates=26200, lr=7.49081e-06, gnorm=3.753, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55025
2022-05-09 12:06:15 - progress_bar.py[line:272] - INFO: epoch 002:   8538 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.927, expert1_balance_bottom=19.52, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=208.8, ups=0.54, wpb=383.6, bsz=32, num_updates=26210, lr=7.48961e-06, gnorm=3.346, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55043
2022-05-09 12:06:33 - progress_bar.py[line:272] - INFO: epoch 002:   8548 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874322, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=35.089, expert1_balance_bottom=19.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213, ups=0.55, wpb=385.6, bsz=32, num_updates=26220, lr=7.48841e-06, gnorm=3.357, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55061
2022-05-09 12:06:51 - progress_bar.py[line:272] - INFO: epoch 002:   8558 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=396.5, nsentences=32, sample_size=315.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.364, expert1_balance_bottom=19.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.9, ups=0.55, wpb=396.5, bsz=32, num_updates=26230, lr=7.48721e-06, gnorm=3.702, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55080
2022-05-09 12:07:09 - progress_bar.py[line:272] - INFO: epoch 002:   8568 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.586, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.9, ups=0.56, wpb=388.2, bsz=32, num_updates=26240, lr=7.486e-06, gnorm=3.545, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55097
2022-05-09 12:07:27 - progress_bar.py[line:272] - INFO: epoch 002:   8578 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=389.8, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872237, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.972, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=217.8, ups=0.56, wpb=389.8, bsz=32, num_updates=26250, lr=7.4848e-06, gnorm=3.591, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55115
2022-05-09 12:07:45 - progress_bar.py[line:272] - INFO: epoch 002:   8588 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876193, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.822, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.7, ups=0.56, wpb=380.2, bsz=32, num_updates=26260, lr=7.4836e-06, gnorm=3.41, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55133
2022-05-09 12:08:03 - progress_bar.py[line:272] - INFO: epoch 002:   8598 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=387.9, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.023, expert1_balance_bottom=19.535, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.5, ups=0.56, wpb=387.9, bsz=32, num_updates=26270, lr=7.4824e-06, gnorm=3.762, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55151
2022-05-09 12:08:21 - progress_bar.py[line:272] - INFO: epoch 002:   8608 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=378.7, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=32.953, expert1_balance_bottom=19.822, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=209.8, ups=0.55, wpb=378.7, bsz=32, num_updates=26280, lr=7.4812e-06, gnorm=3.33, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55169
2022-05-09 12:08:39 - progress_bar.py[line:272] - INFO: epoch 002:   8618 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=385.2, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.311, expert1_balance_bottom=19.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=211.3, ups=0.55, wpb=385.2, bsz=32, num_updates=26290, lr=7.48e-06, gnorm=3.957, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55187
2022-05-09 12:08:58 - progress_bar.py[line:272] - INFO: epoch 002:   8628 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.679, expert1_balance_bottom=19.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=207.1, ups=0.55, wpb=377.5, bsz=32, num_updates=26300, lr=7.4788e-06, gnorm=3.671, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55206
2022-05-09 12:09:16 - progress_bar.py[line:272] - INFO: epoch 002:   8638 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=387.1, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881464, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.86, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.8, ups=0.55, wpb=387.1, bsz=32, num_updates=26310, lr=7.4776e-06, gnorm=3.67, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55224
2022-05-09 12:09:34 - progress_bar.py[line:272] - INFO: epoch 002:   8648 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=386.9, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887596, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.18, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214.6, ups=0.55, wpb=386.9, bsz=32, num_updates=26320, lr=7.47639e-06, gnorm=4.1, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55242
2022-05-09 12:09:52 - progress_bar.py[line:272] - INFO: epoch 002:   8658 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=388.1, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.914, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.2, ups=0.55, wpb=388.1, bsz=32, num_updates=26330, lr=7.47519e-06, gnorm=4.087, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55260
2022-05-09 12:10:10 - progress_bar.py[line:272] - INFO: epoch 002:   8668 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=386.7, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888164, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.071, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.1, ups=0.56, wpb=386.7, bsz=32, num_updates=26340, lr=7.47399e-06, gnorm=3.554, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55278
2022-05-09 12:10:28 - progress_bar.py[line:272] - INFO: epoch 002:   8678 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=378.8, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.83, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.4, ups=0.55, wpb=378.8, bsz=32, num_updates=26350, lr=7.47279e-06, gnorm=4.626, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55296
2022-05-09 12:10:46 - progress_bar.py[line:272] - INFO: epoch 002:   8688 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.398, expert1_balance_bottom=19.218, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.2, ups=0.55, wpb=384.5, bsz=32, num_updates=26360, lr=7.47159e-06, gnorm=4.19, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55314
2022-05-09 12:11:04 - progress_bar.py[line:272] - INFO: epoch 002:   8698 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.997, expert1_balance_bottom=19.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.3, ups=0.55, wpb=386.8, bsz=32, num_updates=26370, lr=7.47039e-06, gnorm=3.923, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55332
2022-05-09 12:11:22 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 12:11:24 - progress_bar.py[line:272] - INFO: epoch 002:   8709 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87515, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.961, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=190.5, ups=0.5, wpb=383.9, bsz=32, num_updates=26380, lr=7.46919e-06, gnorm=3.472, loss_scale=32, train_wall=19, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55352
2022-05-09 12:11:42 - progress_bar.py[line:272] - INFO: epoch 002:   8719 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=374.7, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886187, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.223, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=208.7, ups=0.56, wpb=374.7, bsz=32, num_updates=26390, lr=7.46798e-06, gnorm=3.32, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55370
2022-05-09 12:12:01 - progress_bar.py[line:272] - INFO: epoch 002:   8729 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.005, expert1_balance_bottom=19.456, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=208.6, ups=0.55, wpb=381.1, bsz=32, num_updates=26400, lr=7.46678e-06, gnorm=3.266, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55389
2022-05-09 12:12:19 - progress_bar.py[line:272] - INFO: epoch 002:   8739 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.068, expert1_balance_bottom=19.573, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.6, ups=0.55, wpb=384.4, bsz=32, num_updates=26410, lr=7.46558e-06, gnorm=3.942, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55407
2022-05-09 12:12:37 - progress_bar.py[line:272] - INFO: epoch 002:   8749 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.294, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.9, ups=0.56, wpb=382.4, bsz=32, num_updates=26420, lr=7.46438e-06, gnorm=3.872, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55425
2022-05-09 12:12:55 - progress_bar.py[line:272] - INFO: epoch 002:   8759 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.715, ntokens=373.3, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.136, expert1_balance_top=32.792, expert1_balance_bottom=19.897, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=208.3, ups=0.56, wpb=373.3, bsz=32, num_updates=26430, lr=7.46318e-06, gnorm=2.868, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55443
2022-05-09 12:13:13 - progress_bar.py[line:272] - INFO: epoch 002:   8769 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=376.3, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.948, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=207, ups=0.55, wpb=376.3, bsz=32, num_updates=26440, lr=7.46198e-06, gnorm=3.508, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55461
2022-05-09 12:13:31 - progress_bar.py[line:272] - INFO: epoch 002:   8779 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=386, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.261, expert1_balance_bottom=19.268, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=215.2, ups=0.56, wpb=386, bsz=32, num_updates=26450, lr=7.46078e-06, gnorm=3.645, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55479
2022-05-09 12:13:49 - progress_bar.py[line:272] - INFO: epoch 002:   8789 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.861, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.1, ups=0.55, wpb=385.6, bsz=32, num_updates=26460, lr=7.45958e-06, gnorm=3.446, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55497
2022-05-09 12:14:07 - progress_bar.py[line:272] - INFO: epoch 002:   8799 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=375.2, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.771, expert1_balance_bottom=19.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=205.8, ups=0.55, wpb=375.2, bsz=32, num_updates=26470, lr=7.45837e-06, gnorm=3.939, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55515
2022-05-09 12:14:26 - progress_bar.py[line:272] - INFO: epoch 002:   8809 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=381.2, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891696, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=34.014, expert1_balance_bottom=19.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=204.2, ups=0.54, wpb=381.2, bsz=32, num_updates=26480, lr=7.45717e-06, gnorm=3.673, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55534
2022-05-09 12:14:44 - progress_bar.py[line:272] - INFO: epoch 002:   8819 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=383.3, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.272, expert1_balance_bottom=19.455, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=208.5, ups=0.54, wpb=383.3, bsz=32, num_updates=26490, lr=7.45597e-06, gnorm=3.752, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55552
2022-05-09 12:15:02 - progress_bar.py[line:272] - INFO: epoch 002:   8829 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=375, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900353, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.135, expert1_balance_top=33.079, expert1_balance_bottom=19.663, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=206.7, ups=0.55, wpb=375, bsz=32, num_updates=26500, lr=7.45477e-06, gnorm=3.916, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55570
2022-05-09 12:15:20 - progress_bar.py[line:272] - INFO: epoch 002:   8839 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=377.6, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.187, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.4, ups=0.55, wpb=377.6, bsz=32, num_updates=26510, lr=7.45357e-06, gnorm=3.841, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55588
2022-05-09 12:15:38 - progress_bar.py[line:272] - INFO: epoch 002:   8849 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=379, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.792, expert1_balance_bottom=19.175, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.2, ups=0.55, wpb=379, bsz=32, num_updates=26520, lr=7.45237e-06, gnorm=3.759, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55606
2022-05-09 12:15:56 - progress_bar.py[line:272] - INFO: epoch 002:   8859 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=380, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.365, expert1_balance_bottom=19.684, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.2, ups=0.56, wpb=380, bsz=32, num_updates=26530, lr=7.45117e-06, gnorm=3.607, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55624
2022-05-09 12:16:14 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-05-09 12:16:16 - progress_bar.py[line:272] - INFO: epoch 002:   8870 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=381.7, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.524, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=192.3, ups=0.5, wpb=381.7, bsz=32, num_updates=26540, lr=7.44997e-06, gnorm=4.135, loss_scale=16, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55644
2022-05-09 12:16:34 - progress_bar.py[line:272] - INFO: epoch 002:   8880 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=384.6, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87174, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.851, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215.3, ups=0.56, wpb=384.6, bsz=32, num_updates=26550, lr=7.44876e-06, gnorm=3.212, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55662
2022-05-09 12:16:52 - progress_bar.py[line:272] - INFO: epoch 002:   8890 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876938, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.532, expert1_balance_bottom=19.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209.6, ups=0.55, wpb=378.6, bsz=32, num_updates=26560, lr=7.44756e-06, gnorm=3.816, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55680
2022-05-09 12:17:10 - progress_bar.py[line:272] - INFO: epoch 002:   8900 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=379.4, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887478, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.781, expert1_balance_bottom=19.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=207.7, ups=0.55, wpb=379.4, bsz=32, num_updates=26570, lr=7.44636e-06, gnorm=3.447, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55698
2022-05-09 12:17:29 - progress_bar.py[line:272] - INFO: epoch 002:   8910 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=376.8, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.211, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=207.2, ups=0.55, wpb=376.8, bsz=32, num_updates=26580, lr=7.44516e-06, gnorm=3.828, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55717
2022-05-09 12:17:47 - progress_bar.py[line:272] - INFO: epoch 002:   8920 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=382.2, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881249, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.883, expert1_balance_bottom=19.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.5, ups=0.55, wpb=382.2, bsz=32, num_updates=26590, lr=7.44396e-06, gnorm=3.239, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55735
2022-05-09 12:18:05 - progress_bar.py[line:272] - INFO: epoch 002:   8930 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888777, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.768, expert1_balance_bottom=19.434, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.1, ups=0.54, wpb=384.9, bsz=32, num_updates=26600, lr=7.44276e-06, gnorm=4.202, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55753
2022-05-09 12:18:23 - progress_bar.py[line:272] - INFO: epoch 002:   8940 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.629, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.6, ups=0.55, wpb=383.6, bsz=32, num_updates=26610, lr=7.44156e-06, gnorm=3.777, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55771
2022-05-09 12:18:42 - progress_bar.py[line:272] - INFO: epoch 002:   8950 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=383.7, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=35.069, expert1_balance_bottom=19.037, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=207.8, ups=0.54, wpb=383.7, bsz=32, num_updates=26620, lr=7.44035e-06, gnorm=4.234, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55790
2022-05-09 12:19:00 - progress_bar.py[line:272] - INFO: epoch 002:   8960 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=373.7, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.282, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=203.5, ups=0.54, wpb=373.7, bsz=32, num_updates=26630, lr=7.43915e-06, gnorm=3.544, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55808
2022-05-09 12:19:18 - progress_bar.py[line:272] - INFO: epoch 002:   8970 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=379.4, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.309, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=209.9, ups=0.55, wpb=379.4, bsz=32, num_updates=26640, lr=7.43795e-06, gnorm=3.491, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55826
2022-05-09 12:19:36 - progress_bar.py[line:272] - INFO: epoch 002:   8980 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=374.6, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885386, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.014, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=207.7, ups=0.55, wpb=374.6, bsz=32, num_updates=26650, lr=7.43675e-06, gnorm=3.189, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55844
2022-05-09 12:19:54 - progress_bar.py[line:272] - INFO: epoch 002:   8990 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=372.5, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898879, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.586, expert1_balance_bottom=19.635, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=206.8, ups=0.56, wpb=372.5, bsz=32, num_updates=26660, lr=7.43555e-06, gnorm=3.443, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55862
2022-05-09 12:20:12 - progress_bar.py[line:272] - INFO: epoch 002:   9000 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890662, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.906, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=209.8, ups=0.55, wpb=383.3, bsz=32, num_updates=26670, lr=7.43435e-06, gnorm=3.398, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55881
2022-05-09 12:20:31 - progress_bar.py[line:272] - INFO: epoch 002:   9010 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.476, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=208.2, ups=0.55, wpb=381.1, bsz=32, num_updates=26680, lr=7.43315e-06, gnorm=3.639, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55899
2022-05-09 12:20:49 - progress_bar.py[line:272] - INFO: epoch 002:   9020 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898458, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.285, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.6, ups=0.55, wpb=384.2, bsz=32, num_updates=26690, lr=7.43195e-06, gnorm=3.975, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55917
2022-05-09 12:21:07 - progress_bar.py[line:272] - INFO: epoch 002:   9030 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=384.1, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.151, expert1_balance_bottom=19.362, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.2, ups=0.55, wpb=384.1, bsz=32, num_updates=26700, lr=7.43074e-06, gnorm=3.526, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55935
2022-05-09 12:21:26 - progress_bar.py[line:272] - INFO: epoch 002:   9040 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=392.4, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.913, expert1_balance_bottom=19.231, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.5, ups=0.55, wpb=392.4, bsz=32, num_updates=26710, lr=7.42954e-06, gnorm=3.405, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55954
2022-05-09 12:21:44 - progress_bar.py[line:272] - INFO: epoch 002:   9050 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.677, expert1_balance_bottom=19.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.8, ups=0.55, wpb=381.7, bsz=32, num_updates=26720, lr=7.42834e-06, gnorm=4.004, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55972
2022-05-09 12:22:02 - progress_bar.py[line:272] - INFO: epoch 002:   9060 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885083, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.862, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=209.6, ups=0.55, wpb=380.8, bsz=32, num_updates=26730, lr=7.42714e-06, gnorm=3.548, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=55990
2022-05-09 12:22:20 - progress_bar.py[line:272] - INFO: epoch 002:   9070 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=386.8, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889517, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.932, expert1_balance_bottom=19.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.4, ups=0.55, wpb=386.8, bsz=32, num_updates=26740, lr=7.42594e-06, gnorm=4.123, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56008
2022-05-09 12:22:38 - progress_bar.py[line:272] - INFO: epoch 002:   9080 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=380.7, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.365, expert1_balance_bottom=19.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.5, ups=0.56, wpb=380.7, bsz=32, num_updates=26750, lr=7.42474e-06, gnorm=3.655, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56026
2022-05-09 12:22:56 - progress_bar.py[line:272] - INFO: epoch 002:   9090 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=395.8, nsentences=32, sample_size=314.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877947, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.379, expert1_balance_bottom=19.392, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=218.7, ups=0.55, wpb=395.8, bsz=32, num_updates=26760, lr=7.42354e-06, gnorm=3.288, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56044
2022-05-09 12:23:14 - progress_bar.py[line:272] - INFO: epoch 002:   9100 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.138, expert1_balance_top=32.869, expert1_balance_bottom=19.658, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.9, ups=0.55, wpb=382, bsz=32, num_updates=26770, lr=7.42233e-06, gnorm=3.696, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56062
2022-05-09 12:23:33 - progress_bar.py[line:272] - INFO: epoch 002:   9110 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887417, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.993, expert1_balance_bottom=19.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210, ups=0.55, wpb=384.7, bsz=32, num_updates=26780, lr=7.42113e-06, gnorm=4.005, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56081
2022-05-09 12:23:51 - progress_bar.py[line:272] - INFO: epoch 002:   9120 / 17711 loss=2.933, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=378.4, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886397, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.933, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.411, expert1_balance_bottom=19.186, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=201.5, ups=0.53, wpb=378.4, bsz=32, num_updates=26790, lr=7.41993e-06, gnorm=3.338, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56099
2022-05-09 12:24:10 - progress_bar.py[line:272] - INFO: epoch 002:   9130 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=388.4, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.605, expert1_balance_bottom=19.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=213, ups=0.55, wpb=388.4, bsz=32, num_updates=26800, lr=7.41873e-06, gnorm=3.8, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56118
2022-05-09 12:24:28 - progress_bar.py[line:272] - INFO: epoch 002:   9140 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884353, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.985, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.3, ups=0.55, wpb=384.7, bsz=32, num_updates=26810, lr=7.41753e-06, gnorm=3.964, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56136
2022-05-09 12:24:46 - progress_bar.py[line:272] - INFO: epoch 002:   9150 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=373.8, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.016, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=210.2, ups=0.56, wpb=373.8, bsz=32, num_updates=26820, lr=7.41633e-06, gnorm=3.582, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56154
2022-05-09 12:25:04 - progress_bar.py[line:272] - INFO: epoch 002:   9160 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=381, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887068, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.92, expert1_balance_bottom=19.64, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.5, ups=0.55, wpb=381, bsz=32, num_updates=26830, lr=7.41513e-06, gnorm=3.869, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56172
2022-05-09 12:25:22 - progress_bar.py[line:272] - INFO: epoch 002:   9170 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873273, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.518, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=209, ups=0.54, wpb=385.5, bsz=32, num_updates=26840, lr=7.41393e-06, gnorm=3.998, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56190
2022-05-09 12:25:40 - progress_bar.py[line:272] - INFO: epoch 002:   9180 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=383.4, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.494, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=214, ups=0.56, wpb=383.4, bsz=32, num_updates=26850, lr=7.41272e-06, gnorm=3.341, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56208
2022-05-09 12:25:58 - progress_bar.py[line:272] - INFO: epoch 002:   9190 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=390.1, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878986, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.977, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.4, ups=0.56, wpb=390.1, bsz=32, num_updates=26860, lr=7.41152e-06, gnorm=3.52, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56226
2022-05-09 12:26:16 - progress_bar.py[line:272] - INFO: epoch 002:   9200 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=391.4, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875892, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.305, expert1_balance_bottom=19.265, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.1, ups=0.56, wpb=391.4, bsz=32, num_updates=26870, lr=7.41032e-06, gnorm=3.666, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56244
2022-05-09 12:26:34 - progress_bar.py[line:272] - INFO: epoch 002:   9210 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892964, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.581, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=214.1, ups=0.55, wpb=386, bsz=32, num_updates=26880, lr=7.40912e-06, gnorm=3.063, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56262
2022-05-09 12:26:52 - progress_bar.py[line:272] - INFO: epoch 002:   9220 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871775, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.556, expert1_balance_bottom=19.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.7, ups=0.56, wpb=382.7, bsz=32, num_updates=26890, lr=7.40792e-06, gnorm=3.441, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56280
2022-05-09 12:27:10 - progress_bar.py[line:272] - INFO: epoch 002:   9230 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=375.4, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.04, expert1_balance_bottom=19.645, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=206.4, ups=0.55, wpb=375.4, bsz=32, num_updates=26900, lr=7.40672e-06, gnorm=3.658, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56298
2022-05-09 12:27:28 - progress_bar.py[line:272] - INFO: epoch 002:   9240 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875782, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.232, expert1_balance_bottom=19.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=208.9, ups=0.55, wpb=380.6, bsz=32, num_updates=26910, lr=7.40552e-06, gnorm=3.891, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56316
2022-05-09 12:27:46 - progress_bar.py[line:272] - INFO: epoch 002:   9250 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=382.9, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875898, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=35.011, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210.1, ups=0.55, wpb=382.9, bsz=32, num_updates=26920, lr=7.40432e-06, gnorm=3.413, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56334
2022-05-09 12:28:05 - progress_bar.py[line:272] - INFO: epoch 002:   9260 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=394.8, nsentences=32, sample_size=314.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.24, expert1_balance_bottom=19.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214, ups=0.54, wpb=394.8, bsz=32, num_updates=26930, lr=7.40311e-06, gnorm=3.142, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56353
2022-05-09 12:28:23 - progress_bar.py[line:272] - INFO: epoch 002:   9270 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=372.3, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88567, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.614, expert1_balance_bottom=19.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=203.2, ups=0.55, wpb=372.3, bsz=32, num_updates=26940, lr=7.40191e-06, gnorm=3.099, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56371
2022-05-09 12:28:41 - progress_bar.py[line:272] - INFO: epoch 002:   9280 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=381.1, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.217, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=210.7, ups=0.55, wpb=381.1, bsz=32, num_updates=26950, lr=7.40071e-06, gnorm=3.378, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56389
2022-05-09 12:28:59 - progress_bar.py[line:272] - INFO: epoch 002:   9290 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884685, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.086, expert1_balance_bottom=19.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.1, ups=0.55, wpb=383.9, bsz=32, num_updates=26960, lr=7.39951e-06, gnorm=3.315, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56407
2022-05-09 12:29:18 - progress_bar.py[line:272] - INFO: epoch 002:   9300 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=386.7, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886709, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.21, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.3, ups=0.55, wpb=386.7, bsz=32, num_updates=26970, lr=7.39831e-06, gnorm=3.578, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56426
2022-05-09 12:29:36 - progress_bar.py[line:272] - INFO: epoch 002:   9310 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880041, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.306, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.1, ups=0.55, wpb=385.2, bsz=32, num_updates=26980, lr=7.39711e-06, gnorm=3.506, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56444
2022-05-09 12:29:54 - progress_bar.py[line:272] - INFO: epoch 002:   9320 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.112, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211, ups=0.55, wpb=384.7, bsz=32, num_updates=26990, lr=7.39591e-06, gnorm=3.512, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56462
2022-05-09 12:30:12 - progress_bar.py[line:272] - INFO: epoch 002:   9330 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=378.8, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.463, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210.6, ups=0.56, wpb=378.8, bsz=32, num_updates=27000, lr=7.3947e-06, gnorm=3.725, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56480
2022-05-09 12:30:30 - progress_bar.py[line:272] - INFO: epoch 002:   9340 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897315, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.55, expert1_balance_bottom=19.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.8, ups=0.56, wpb=382.6, bsz=32, num_updates=27010, lr=7.3935e-06, gnorm=3.915, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56498
2022-05-09 12:30:48 - progress_bar.py[line:272] - INFO: epoch 002:   9350 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=381.2, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890407, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.755, expert1_balance_bottom=19.578, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212.2, ups=0.56, wpb=381.2, bsz=32, num_updates=27020, lr=7.3923e-06, gnorm=3.449, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56516
2022-05-09 12:31:06 - progress_bar.py[line:272] - INFO: epoch 002:   9360 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=387.8, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882677, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.318, expert1_balance_bottom=19.395, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=214.5, ups=0.55, wpb=387.8, bsz=32, num_updates=27030, lr=7.3911e-06, gnorm=3.251, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56534
2022-05-09 12:31:24 - progress_bar.py[line:272] - INFO: epoch 002:   9370 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=380, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88881, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.749, expert1_balance_bottom=19.027, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.2, ups=0.56, wpb=380, bsz=32, num_updates=27040, lr=7.3899e-06, gnorm=3.691, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56552
2022-05-09 12:31:42 - progress_bar.py[line:272] - INFO: epoch 002:   9380 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=387.4, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.619, expert1_balance_bottom=19.127, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=210.6, ups=0.54, wpb=387.4, bsz=32, num_updates=27050, lr=7.3887e-06, gnorm=3.442, loss_scale=16, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56570
2022-05-09 12:32:00 - progress_bar.py[line:272] - INFO: epoch 002:   9390 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.482, expert1_balance_bottom=19.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=209.1, ups=0.55, wpb=381.9, bsz=32, num_updates=27060, lr=7.3875e-06, gnorm=3.07, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56588
2022-05-09 12:32:19 - progress_bar.py[line:272] - INFO: epoch 002:   9400 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=381.4, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89401, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.829, expert1_balance_bottom=19.627, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.6, ups=0.55, wpb=381.4, bsz=32, num_updates=27070, lr=7.3863e-06, gnorm=3.505, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56607
2022-05-09 12:32:37 - progress_bar.py[line:272] - INFO: epoch 002:   9410 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=382.5, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873956, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.781, expert1_balance_bottom=19.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=207.4, ups=0.54, wpb=382.5, bsz=32, num_updates=27080, lr=7.38509e-06, gnorm=3.362, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56625
2022-05-09 12:32:55 - progress_bar.py[line:272] - INFO: epoch 002:   9420 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=386.5, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.091, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=210.6, ups=0.54, wpb=386.5, bsz=32, num_updates=27090, lr=7.38389e-06, gnorm=3.345, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56643
2022-05-09 12:33:13 - progress_bar.py[line:272] - INFO: epoch 002:   9430 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=389.5, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.743, expert1_balance_bottom=19.643, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.4, ups=0.55, wpb=389.5, bsz=32, num_updates=27100, lr=7.38269e-06, gnorm=3.237, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56661
2022-05-09 12:33:31 - progress_bar.py[line:272] - INFO: epoch 002:   9440 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=387.8, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.435, expert1_balance_bottom=19.607, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=215.2, ups=0.56, wpb=387.8, bsz=32, num_updates=27110, lr=7.38149e-06, gnorm=3.616, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56680
2022-05-09 12:33:49 - progress_bar.py[line:272] - INFO: epoch 002:   9450 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.248, expert1_balance_bottom=19.359, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=214.1, ups=0.56, wpb=385.7, bsz=32, num_updates=27120, lr=7.38029e-06, gnorm=3.789, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56698
2022-05-09 12:34:08 - progress_bar.py[line:272] - INFO: epoch 002:   9460 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=381.2, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89643, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.557, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.1, ups=0.54, wpb=381.2, bsz=32, num_updates=27130, lr=7.37909e-06, gnorm=3.634, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56716
2022-05-09 12:34:26 - progress_bar.py[line:272] - INFO: epoch 002:   9470 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=379.4, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.164, expert1_balance_bottom=19.776, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=209.1, ups=0.55, wpb=379.4, bsz=32, num_updates=27140, lr=7.37789e-06, gnorm=3.516, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56734
2022-05-09 12:34:44 - progress_bar.py[line:272] - INFO: epoch 002:   9480 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=388.7, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876327, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.318, expert1_balance_bottom=19.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.3, ups=0.55, wpb=388.7, bsz=32, num_updates=27150, lr=7.37668e-06, gnorm=3.722, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56752
2022-05-09 12:35:02 - progress_bar.py[line:272] - INFO: epoch 002:   9490 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=380.2, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.524, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=209.8, ups=0.55, wpb=380.2, bsz=32, num_updates=27160, lr=7.37548e-06, gnorm=3.341, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56771
2022-05-09 12:35:21 - progress_bar.py[line:272] - INFO: epoch 002:   9500 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890873, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.63, expert1_balance_bottom=19.661, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=208.3, ups=0.54, wpb=383.8, bsz=32, num_updates=27170, lr=7.37428e-06, gnorm=3.438, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56789
2022-05-09 12:35:39 - progress_bar.py[line:272] - INFO: epoch 002:   9510 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=389.1, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870429, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.653, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216, ups=0.56, wpb=389.1, bsz=32, num_updates=27180, lr=7.37308e-06, gnorm=3.112, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56807
2022-05-09 12:35:57 - progress_bar.py[line:272] - INFO: epoch 002:   9520 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=379.4, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888342, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.208, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=210.3, ups=0.55, wpb=379.4, bsz=32, num_updates=27190, lr=7.37188e-06, gnorm=3.577, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56825
2022-05-09 12:36:15 - progress_bar.py[line:272] - INFO: epoch 002:   9530 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=388.4, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.048, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=214.5, ups=0.55, wpb=388.4, bsz=32, num_updates=27200, lr=7.37068e-06, gnorm=3.14, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56843
2022-05-09 12:36:33 - progress_bar.py[line:272] - INFO: epoch 002:   9540 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=383, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.953, expert1_balance_bottom=19.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209.8, ups=0.55, wpb=383, bsz=32, num_updates=27210, lr=7.36948e-06, gnorm=3.86, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56861
2022-05-09 12:36:52 - progress_bar.py[line:272] - INFO: epoch 002:   9550 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.716, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210.5, ups=0.55, wpb=385.7, bsz=32, num_updates=27220, lr=7.36828e-06, gnorm=3.234, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56880
2022-05-09 12:37:10 - progress_bar.py[line:272] - INFO: epoch 002:   9560 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=374.1, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897105, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.753, expert1_balance_bottom=19.504, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=205.2, ups=0.55, wpb=374.1, bsz=32, num_updates=27230, lr=7.36707e-06, gnorm=3.491, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56898
2022-05-09 12:37:28 - progress_bar.py[line:272] - INFO: epoch 002:   9570 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=392.5, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.709, expert1_balance_bottom=19.631, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.9, ups=0.54, wpb=392.5, bsz=32, num_updates=27240, lr=7.36587e-06, gnorm=3.067, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56916
2022-05-09 12:37:47 - progress_bar.py[line:272] - INFO: epoch 002:   9580 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=378.4, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.365, expert1_balance_bottom=19.268, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=207.6, ups=0.55, wpb=378.4, bsz=32, num_updates=27250, lr=7.36467e-06, gnorm=3.699, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56935
2022-05-09 12:38:05 - progress_bar.py[line:272] - INFO: epoch 002:   9590 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=385, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.993, expert1_balance_bottom=19.526, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.1, ups=0.55, wpb=385, bsz=32, num_updates=27260, lr=7.36347e-06, gnorm=3.327, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56953
2022-05-09 12:38:23 - progress_bar.py[line:272] - INFO: epoch 002:   9600 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.928, ntokens=386.1, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.785, expert1_balance_bottom=19.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=213.3, ups=0.55, wpb=386.1, bsz=32, num_updates=27270, lr=7.36227e-06, gnorm=3.541, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56971
2022-05-09 12:38:41 - progress_bar.py[line:272] - INFO: epoch 002:   9610 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=378.2, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887997, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.083, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210.4, ups=0.56, wpb=378.2, bsz=32, num_updates=27280, lr=7.36107e-06, gnorm=3.524, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=56989
2022-05-09 12:38:59 - progress_bar.py[line:272] - INFO: epoch 002:   9620 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.84, expert1_balance_bottom=19.486, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=214.5, ups=0.56, wpb=382.9, bsz=32, num_updates=27290, lr=7.35987e-06, gnorm=3.423, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57007
2022-05-09 12:39:16 - progress_bar.py[line:272] - INFO: epoch 002:   9630 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=376.3, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.544, expert1_balance_bottom=19.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=209.3, ups=0.56, wpb=376.3, bsz=32, num_updates=27300, lr=7.35867e-06, gnorm=3.319, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57025
2022-05-09 12:39:34 - progress_bar.py[line:272] - INFO: epoch 002:   9640 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=379.6, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898795, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.705, expert1_balance_bottom=19.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.9, ups=0.56, wpb=379.6, bsz=32, num_updates=27310, lr=7.35746e-06, gnorm=3.457, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57042
2022-05-09 12:39:53 - progress_bar.py[line:272] - INFO: epoch 002:   9650 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=385.3, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.277, expert1_balance_bottom=19.461, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.8, ups=0.55, wpb=385.3, bsz=32, num_updates=27320, lr=7.35626e-06, gnorm=3.481, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57061
2022-05-09 12:40:11 - progress_bar.py[line:272] - INFO: epoch 002:   9660 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=375.1, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.056, expert1_balance_bottom=19.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=207.8, ups=0.55, wpb=375.1, bsz=32, num_updates=27330, lr=7.35506e-06, gnorm=3.102, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57079
2022-05-09 12:40:29 - progress_bar.py[line:272] - INFO: epoch 002:   9670 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=384.5, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892508, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.797, expert1_balance_bottom=19.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.4, ups=0.56, wpb=384.5, bsz=32, num_updates=27340, lr=7.35386e-06, gnorm=3.636, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57097
2022-05-09 12:40:47 - progress_bar.py[line:272] - INFO: epoch 002:   9680 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=377.1, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88711, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.288, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=206.4, ups=0.55, wpb=377.1, bsz=32, num_updates=27350, lr=7.35266e-06, gnorm=3.079, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57115
2022-05-09 12:41:05 - progress_bar.py[line:272] - INFO: epoch 002:   9690 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.251, expert1_balance_bottom=19.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.9, ups=0.55, wpb=384, bsz=32, num_updates=27360, lr=7.35146e-06, gnorm=3.298, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57133
2022-05-09 12:41:23 - progress_bar.py[line:272] - INFO: epoch 002:   9700 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=383.4, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889479, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.038, expert1_balance_bottom=19.455, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=209.5, ups=0.55, wpb=383.4, bsz=32, num_updates=27370, lr=7.35026e-06, gnorm=3.308, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57151
2022-05-09 12:41:42 - progress_bar.py[line:272] - INFO: epoch 002:   9710 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=389.6, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=35.269, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212.2, ups=0.54, wpb=389.6, bsz=32, num_updates=27380, lr=7.34905e-06, gnorm=3.066, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57170
2022-05-09 12:42:00 - progress_bar.py[line:272] - INFO: epoch 002:   9720 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891923, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.666, expert1_balance_bottom=19.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.2, ups=0.56, wpb=382.9, bsz=32, num_updates=27390, lr=7.34785e-06, gnorm=3.161, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57188
2022-05-09 12:42:18 - progress_bar.py[line:272] - INFO: epoch 002:   9730 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.645, expert1_balance_bottom=19.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=209.4, ups=0.54, wpb=388.2, bsz=32, num_updates=27400, lr=7.34665e-06, gnorm=3.563, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57206
2022-05-09 12:42:36 - progress_bar.py[line:272] - INFO: epoch 002:   9740 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=377.7, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.721, expert1_balance_bottom=19.374, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210.2, ups=0.56, wpb=377.7, bsz=32, num_updates=27410, lr=7.34545e-06, gnorm=3.425, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57224
2022-05-09 12:42:54 - progress_bar.py[line:272] - INFO: epoch 002:   9750 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=386.9, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885734, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.088, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213, ups=0.55, wpb=386.9, bsz=32, num_updates=27420, lr=7.34425e-06, gnorm=3.397, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57242
2022-05-09 12:43:12 - progress_bar.py[line:272] - INFO: epoch 002:   9760 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879003, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.198, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.4, ups=0.56, wpb=381.8, bsz=32, num_updates=27430, lr=7.34305e-06, gnorm=3.425, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57260
2022-05-09 12:43:30 - progress_bar.py[line:272] - INFO: epoch 002:   9770 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=383.3, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88473, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.023, expert1_balance_bottom=19.534, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.6, ups=0.57, wpb=383.3, bsz=32, num_updates=27440, lr=7.34185e-06, gnorm=3.563, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57278
2022-05-09 12:43:47 - progress_bar.py[line:272] - INFO: epoch 002:   9780 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884514, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.314, expert1_balance_bottom=19.287, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.7, ups=0.57, wpb=381.9, bsz=32, num_updates=27450, lr=7.34065e-06, gnorm=3.613, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57295
2022-05-09 12:44:05 - progress_bar.py[line:272] - INFO: epoch 002:   9790 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=388.6, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.355, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.9, ups=0.56, wpb=388.6, bsz=32, num_updates=27460, lr=7.33944e-06, gnorm=3.141, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57313
2022-05-09 12:44:23 - progress_bar.py[line:272] - INFO: epoch 002:   9800 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=383.1, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.832, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=219.9, ups=0.57, wpb=383.1, bsz=32, num_updates=27470, lr=7.33824e-06, gnorm=3.866, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57331
2022-05-09 12:44:40 - progress_bar.py[line:272] - INFO: epoch 002:   9810 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=371.7, nsentences=32, sample_size=295.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892552, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.891, expert1_balance_bottom=19.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215, ups=0.58, wpb=371.7, bsz=32, num_updates=27480, lr=7.33704e-06, gnorm=3.342, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57348
2022-05-09 12:44:57 - progress_bar.py[line:272] - INFO: epoch 002:   9820 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=385, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.944, expert1_balance_bottom=19.631, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.2, ups=0.57, wpb=385, bsz=32, num_updates=27490, lr=7.33584e-06, gnorm=3.754, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57365
2022-05-09 12:45:15 - progress_bar.py[line:272] - INFO: epoch 002:   9830 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=35.189, expert1_balance_bottom=18.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.2, ups=0.57, wpb=379.5, bsz=32, num_updates=27500, lr=7.33464e-06, gnorm=3.386, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57383
2022-05-09 12:45:32 - progress_bar.py[line:272] - INFO: epoch 002:   9840 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=374.7, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891444, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=34.343, expert1_balance_bottom=19.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.5, ups=0.57, wpb=374.7, bsz=32, num_updates=27510, lr=7.33344e-06, gnorm=3.128, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57400
2022-05-09 12:45:50 - progress_bar.py[line:272] - INFO: epoch 002:   9850 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876735, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.487, expert1_balance_bottom=19.228, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.2, ups=0.57, wpb=383.9, bsz=32, num_updates=27520, lr=7.33224e-06, gnorm=3.387, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57418
2022-05-09 12:46:07 - progress_bar.py[line:272] - INFO: epoch 002:   9860 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=33.386, expert1_balance_bottom=19.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218, ups=0.58, wpb=378.2, bsz=32, num_updates=27530, lr=7.33103e-06, gnorm=4.154, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57435
2022-05-09 12:46:25 - progress_bar.py[line:272] - INFO: epoch 002:   9870 / 17711 loss=2.948, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.948, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.112, expert1_balance_bottom=19.568, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=217.1, ups=0.57, wpb=379.3, bsz=32, num_updates=27540, lr=7.32983e-06, gnorm=2.998, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57453
2022-05-09 12:46:42 - progress_bar.py[line:272] - INFO: epoch 002:   9880 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=386.7, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886629, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.996, expert1_balance_bottom=19.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.9, ups=0.57, wpb=386.7, bsz=32, num_updates=27550, lr=7.32863e-06, gnorm=4.246, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57470
2022-05-09 12:47:00 - progress_bar.py[line:272] - INFO: epoch 002:   9890 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=385.4, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.642, expert1_balance_bottom=19.624, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.1, ups=0.58, wpb=385.4, bsz=32, num_updates=27560, lr=7.32743e-06, gnorm=3.674, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57488
2022-05-09 12:47:17 - progress_bar.py[line:272] - INFO: epoch 002:   9900 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=380.4, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886035, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.109, expert1_balance_bottom=19.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.2, ups=0.57, wpb=380.4, bsz=32, num_updates=27570, lr=7.32623e-06, gnorm=3.763, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57505
2022-05-09 12:47:35 - progress_bar.py[line:272] - INFO: epoch 002:   9910 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=386.4, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879081, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.533, expert1_balance_bottom=19.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=219.5, ups=0.57, wpb=386.4, bsz=32, num_updates=27580, lr=7.32503e-06, gnorm=3.218, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57523
2022-05-09 12:47:52 - progress_bar.py[line:272] - INFO: epoch 002:   9920 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=386.2, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.483, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.6, ups=0.57, wpb=386.2, bsz=32, num_updates=27590, lr=7.32383e-06, gnorm=3.365, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57540
2022-05-09 12:48:10 - progress_bar.py[line:272] - INFO: epoch 002:   9930 / 17711 loss=3.094, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=392, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879138, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.094, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.355, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=219.5, ups=0.56, wpb=392, bsz=32, num_updates=27600, lr=7.32263e-06, gnorm=3.457, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57558
2022-05-09 12:48:28 - progress_bar.py[line:272] - INFO: epoch 002:   9940 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889721, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.847, expert1_balance_bottom=19.559, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.7, ups=0.57, wpb=386.8, bsz=32, num_updates=27610, lr=7.32142e-06, gnorm=3.367, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57576
2022-05-09 12:48:45 - progress_bar.py[line:272] - INFO: epoch 002:   9950 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=376.6, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.012, expert1_balance_bottom=19.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.6, ups=0.57, wpb=376.6, bsz=32, num_updates=27620, lr=7.32022e-06, gnorm=3.405, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57593
2022-05-09 12:49:02 - progress_bar.py[line:272] - INFO: epoch 002:   9960 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=372.7, nsentences=32, sample_size=296.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90102, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=33.108, expert1_balance_bottom=19.694, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.8, ups=0.58, wpb=372.7, bsz=32, num_updates=27630, lr=7.31902e-06, gnorm=3.254, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57610
2022-05-09 12:49:20 - progress_bar.py[line:272] - INFO: epoch 002:   9970 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885747, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.196, expert1_balance_bottom=19.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=215.8, ups=0.57, wpb=378.4, bsz=32, num_updates=27640, lr=7.31782e-06, gnorm=4.458, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57628
2022-05-09 12:49:37 - progress_bar.py[line:272] - INFO: epoch 002:   9980 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=374.2, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.179, expert1_balance_bottom=19.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.7, ups=0.57, wpb=374.2, bsz=32, num_updates=27650, lr=7.31662e-06, gnorm=4.11, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57645
2022-05-09 12:49:55 - progress_bar.py[line:272] - INFO: epoch 002:   9990 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876646, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.579, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.7, ups=0.58, wpb=380.5, bsz=32, num_updates=27660, lr=7.31542e-06, gnorm=3.642, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57663
2022-05-09 12:50:12 - progress_bar.py[line:272] - INFO: epoch 002:  10000 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881648, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.592, expert1_balance_bottom=19.295, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=216.3, ups=0.57, wpb=377.9, bsz=32, num_updates=27670, lr=7.31422e-06, gnorm=3.017, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57680
2022-05-09 12:50:29 - progress_bar.py[line:272] - INFO: epoch 002:  10010 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.131, expert1_balance_top=33.171, expert1_balance_bottom=19.806, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.3, ups=0.58, wpb=380.1, bsz=32, num_updates=27680, lr=7.31302e-06, gnorm=3.023, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57697
2022-05-09 12:50:47 - progress_bar.py[line:272] - INFO: epoch 002:  10020 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=382.7, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874861, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.741, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.5, ups=0.58, wpb=382.7, bsz=32, num_updates=27690, lr=7.31181e-06, gnorm=3.515, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57715
2022-05-09 12:51:04 - progress_bar.py[line:272] - INFO: epoch 002:  10030 / 17711 loss=2.921, loss_v1=0, loss_v2=0, nll_loss=0.71, ntokens=391.8, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.921, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.943, expert1_balance_bottom=19.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=225.5, ups=0.58, wpb=391.8, bsz=32, num_updates=27700, lr=7.31061e-06, gnorm=3.032, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57732
2022-05-09 12:51:21 - progress_bar.py[line:272] - INFO: epoch 002:  10040 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=376.3, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89876, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.133, expert1_balance_top=32.929, expert1_balance_bottom=19.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=215.1, ups=0.57, wpb=376.3, bsz=32, num_updates=27710, lr=7.30941e-06, gnorm=3.024, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57750
2022-05-09 12:51:40 - progress_bar.py[line:272] - INFO: epoch 002:  10050 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=389.4, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.583, expert1_balance_bottom=19.072, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=213, ups=0.55, wpb=389.4, bsz=32, num_updates=27720, lr=7.30821e-06, gnorm=3.992, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57768
2022-05-09 12:51:58 - progress_bar.py[line:272] - INFO: epoch 002:  10060 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895333, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.383, expert1_balance_bottom=19.747, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=206.9, ups=0.55, wpb=376.7, bsz=32, num_updates=27730, lr=7.30701e-06, gnorm=3.39, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57786
2022-05-09 12:52:16 - progress_bar.py[line:272] - INFO: epoch 002:  10070 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=377, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.379, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.1, ups=0.56, wpb=377, bsz=32, num_updates=27740, lr=7.30581e-06, gnorm=3.482, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57804
2022-05-09 12:52:34 - progress_bar.py[line:272] - INFO: epoch 002:  10080 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=373.4, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.388, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=205.5, ups=0.55, wpb=373.4, bsz=32, num_updates=27750, lr=7.30461e-06, gnorm=3.608, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57822
2022-05-09 12:52:52 - progress_bar.py[line:272] - INFO: epoch 002:  10090 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.927, expert1_balance_bottom=19.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=210.8, ups=0.55, wpb=383.2, bsz=32, num_updates=27760, lr=7.3034e-06, gnorm=3.298, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57840
2022-05-09 12:53:11 - progress_bar.py[line:272] - INFO: epoch 002:  10100 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=379, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.542, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=205.4, ups=0.54, wpb=379, bsz=32, num_updates=27770, lr=7.3022e-06, gnorm=3.852, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57859
2022-05-09 12:53:29 - progress_bar.py[line:272] - INFO: epoch 002:  10110 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884968, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.18, expert1_balance_bottom=19.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.2, ups=0.55, wpb=387, bsz=32, num_updates=27780, lr=7.301e-06, gnorm=3.209, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57877
2022-05-09 12:53:47 - progress_bar.py[line:272] - INFO: epoch 002:  10120 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884582, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.393, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=211.9, ups=0.55, wpb=382.6, bsz=32, num_updates=27790, lr=7.2998e-06, gnorm=3.393, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57895
2022-05-09 12:54:05 - progress_bar.py[line:272] - INFO: epoch 002:  10130 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885472, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.164, expert1_balance_bottom=19.238, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=210.9, ups=0.55, wpb=384.4, bsz=32, num_updates=27800, lr=7.2986e-06, gnorm=3.238, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57913
2022-05-09 12:54:24 - progress_bar.py[line:272] - INFO: epoch 002:  10140 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=380.3, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89154, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.844, expert1_balance_bottom=19.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=206.7, ups=0.54, wpb=380.3, bsz=32, num_updates=27810, lr=7.2974e-06, gnorm=3.698, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57932
2022-05-09 12:54:42 - progress_bar.py[line:272] - INFO: epoch 002:  10150 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.654, expert1_balance_bottom=19.155, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=208.9, ups=0.55, wpb=378.7, bsz=32, num_updates=27820, lr=7.2962e-06, gnorm=3.243, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57950
2022-05-09 12:55:00 - progress_bar.py[line:272] - INFO: epoch 002:  10160 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=388.1, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.328, expert1_balance_bottom=19.588, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.6, ups=0.55, wpb=388.1, bsz=32, num_updates=27830, lr=7.295e-06, gnorm=3.395, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57968
2022-05-09 12:55:18 - progress_bar.py[line:272] - INFO: epoch 002:  10170 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884761, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.427, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=209.1, ups=0.55, wpb=381.7, bsz=32, num_updates=27840, lr=7.29379e-06, gnorm=3.248, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=57986
2022-05-09 12:55:36 - progress_bar.py[line:272] - INFO: epoch 002:  10180 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=381.2, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.356, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=210.3, ups=0.55, wpb=381.2, bsz=32, num_updates=27850, lr=7.29259e-06, gnorm=2.958, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58004
2022-05-09 12:55:54 - progress_bar.py[line:272] - INFO: epoch 002:  10190 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878215, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.771, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=211.4, ups=0.55, wpb=381.1, bsz=32, num_updates=27860, lr=7.29139e-06, gnorm=3.231, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58022
2022-05-09 12:56:13 - progress_bar.py[line:272] - INFO: epoch 002:  10200 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.969, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=208.2, ups=0.54, wpb=382.7, bsz=32, num_updates=27870, lr=7.29019e-06, gnorm=3.439, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58041
2022-05-09 12:56:31 - progress_bar.py[line:272] - INFO: epoch 002:  10210 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=378.8, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.979, expert1_balance_bottom=19.434, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=207.7, ups=0.55, wpb=378.8, bsz=32, num_updates=27880, lr=7.28899e-06, gnorm=3.989, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58059
2022-05-09 12:56:49 - progress_bar.py[line:272] - INFO: epoch 002:  10220 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.414, expert1_balance_bottom=19.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=209, ups=0.55, wpb=382.6, bsz=32, num_updates=27890, lr=7.28779e-06, gnorm=3.418, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58077
2022-05-09 12:57:07 - progress_bar.py[line:272] - INFO: epoch 002:  10230 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=372.9, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893622, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.975, expert1_balance_bottom=19.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=204.9, ups=0.55, wpb=372.9, bsz=32, num_updates=27900, lr=7.28659e-06, gnorm=3.591, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58095
2022-05-09 12:57:25 - progress_bar.py[line:272] - INFO: epoch 002:  10240 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=385.1, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.265, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.4, ups=0.55, wpb=385.1, bsz=32, num_updates=27910, lr=7.28538e-06, gnorm=3.637, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58113
2022-05-09 12:57:44 - progress_bar.py[line:272] - INFO: epoch 002:  10250 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876182, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.716, expert1_balance_bottom=19.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=210.6, ups=0.55, wpb=383.2, bsz=32, num_updates=27920, lr=7.28418e-06, gnorm=3.106, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58132
2022-05-09 12:58:02 - progress_bar.py[line:272] - INFO: epoch 002:  10260 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875175, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.554, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.6, ups=0.56, wpb=384, bsz=32, num_updates=27930, lr=7.28298e-06, gnorm=3.389, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58150
2022-05-09 12:58:20 - progress_bar.py[line:272] - INFO: epoch 002:  10270 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.732, expert1_balance_bottom=19.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210.7, ups=0.55, wpb=380.7, bsz=32, num_updates=27940, lr=7.28178e-06, gnorm=3.704, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58168
2022-05-09 12:58:38 - progress_bar.py[line:272] - INFO: epoch 002:  10280 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=380.3, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89031, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.794, expert1_balance_bottom=19.409, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=206.7, ups=0.54, wpb=380.3, bsz=32, num_updates=27950, lr=7.28058e-06, gnorm=3.297, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58186
2022-05-09 12:58:56 - progress_bar.py[line:272] - INFO: epoch 002:  10290 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881682, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.498, expert1_balance_bottom=19.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=210.8, ups=0.55, wpb=382.5, bsz=32, num_updates=27960, lr=7.27938e-06, gnorm=3.372, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58204
2022-05-09 12:59:14 - progress_bar.py[line:272] - INFO: epoch 002:  10300 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.506, expert1_balance_bottom=19.632, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=213.5, ups=0.56, wpb=380.8, bsz=32, num_updates=27970, lr=7.27818e-06, gnorm=3.349, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58222
2022-05-09 12:59:32 - progress_bar.py[line:272] - INFO: epoch 002:  10310 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880062, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.493, expert1_balance_bottom=19.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=211.9, ups=0.55, wpb=381.8, bsz=32, num_updates=27980, lr=7.27698e-06, gnorm=3.485, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58240
2022-05-09 12:59:50 - progress_bar.py[line:272] - INFO: epoch 002:  10320 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=380.3, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.42, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=208.9, ups=0.55, wpb=380.3, bsz=32, num_updates=27990, lr=7.27577e-06, gnorm=3.445, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58258
2022-05-09 13:00:08 - progress_bar.py[line:272] - INFO: epoch 002:  10330 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.816, expert1_balance_bottom=19.362, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=209, ups=0.55, wpb=381.8, bsz=32, num_updates=28000, lr=7.27457e-06, gnorm=3.836, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58277
2022-05-09 13:00:08 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 13:00:09 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 13:00:09 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 13:07:37 - train.py[line:517] - INFO: valid_step finished
2022-05-09 13:07:37 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 10.108 | loss_v1 0 | loss_v2 0 | nll_loss 8.456 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.990814 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.108 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.185 | expert1_balance_top 38.805 | expert1_balance_bottom 15.069 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 351.08 | cider 1.199 | wps 672.1 | wpb 481.7 | bsz 8 | num_updates 28000 | best_cider 1.199
2022-05-09 13:07:55 - progress_bar.py[line:272] - INFO: epoch 002:  10340 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=375.8, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.849, expert1_balance_bottom=19.259, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=8.1, ups=0.02, wpb=375.8, bsz=32, num_updates=28010, lr=7.27337e-06, gnorm=3.508, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58743
2022-05-09 13:08:13 - progress_bar.py[line:272] - INFO: epoch 002:  10350 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=374, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.132, expert1_balance_top=33.536, expert1_balance_bottom=19.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=202.9, ups=0.54, wpb=374, bsz=32, num_updates=28020, lr=7.27217e-06, gnorm=3.076, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58761
2022-05-09 13:08:32 - progress_bar.py[line:272] - INFO: epoch 002:  10360 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=376.3, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887743, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.42, expert1_balance_bottom=19.404, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=204.8, ups=0.54, wpb=376.3, bsz=32, num_updates=28030, lr=7.27097e-06, gnorm=3.68, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58780
2022-05-09 13:08:50 - progress_bar.py[line:272] - INFO: epoch 002:  10370 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.484, expert1_balance_bottom=19.417, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=207.2, ups=0.54, wpb=385.2, bsz=32, num_updates=28040, lr=7.26977e-06, gnorm=3.682, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58798
2022-05-09 13:09:09 - progress_bar.py[line:272] - INFO: epoch 002:  10380 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=384.2, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875141, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.748, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=208.3, ups=0.54, wpb=384.2, bsz=32, num_updates=28050, lr=7.26857e-06, gnorm=3.704, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58817
2022-05-09 13:09:27 - progress_bar.py[line:272] - INFO: epoch 002:  10390 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=379.5, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.152, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=206.6, ups=0.54, wpb=379.5, bsz=32, num_updates=28060, lr=7.26737e-06, gnorm=3.797, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58835
2022-05-09 13:09:45 - progress_bar.py[line:272] - INFO: epoch 002:  10400 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.383, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=211.3, ups=0.55, wpb=385.3, bsz=32, num_updates=28070, lr=7.26616e-06, gnorm=3.296, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58853
2022-05-09 13:10:03 - progress_bar.py[line:272] - INFO: epoch 002:  10410 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=384.4, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.856, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.1, ups=0.55, wpb=384.4, bsz=32, num_updates=28080, lr=7.26496e-06, gnorm=3.734, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58871
2022-05-09 13:10:18 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 13:10:23 - progress_bar.py[line:272] - INFO: epoch 002:  10421 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=385.2, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885544, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.237, expert1_balance_bottom=19.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=195.1, ups=0.51, wpb=385.2, bsz=32, num_updates=28090, lr=7.26376e-06, gnorm=3.865, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58891
2022-05-09 13:10:42 - progress_bar.py[line:272] - INFO: epoch 002:  10431 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=378.5, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.313, expert1_balance_bottom=19.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=206.7, ups=0.55, wpb=378.5, bsz=32, num_updates=28100, lr=7.26256e-06, gnorm=3.555, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58910
2022-05-09 13:11:00 - progress_bar.py[line:272] - INFO: epoch 002:  10441 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887192, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.618, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=207, ups=0.55, wpb=379.5, bsz=32, num_updates=28110, lr=7.26136e-06, gnorm=3.519, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58928
2022-05-09 13:11:18 - progress_bar.py[line:272] - INFO: epoch 002:  10451 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=385.5, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886797, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.552, expert1_balance_bottom=19.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.8, ups=0.55, wpb=385.5, bsz=32, num_updates=28120, lr=7.26016e-06, gnorm=3.899, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58946
2022-05-09 13:11:36 - progress_bar.py[line:272] - INFO: epoch 002:  10461 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879752, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.719, expert1_balance_bottom=19.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.6, ups=0.55, wpb=381.2, bsz=32, num_updates=28130, lr=7.25896e-06, gnorm=3.426, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58964
2022-05-09 13:11:54 - progress_bar.py[line:272] - INFO: epoch 002:  10471 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=370.5, nsentences=32, sample_size=294.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89017, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.227, expert1_balance_bottom=19.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=203.3, ups=0.55, wpb=370.5, bsz=32, num_updates=28140, lr=7.25775e-06, gnorm=3.587, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=58982
2022-05-09 13:12:13 - progress_bar.py[line:272] - INFO: epoch 002:  10481 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=390, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.504, expert1_balance_bottom=19.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.8, ups=0.55, wpb=390, bsz=32, num_updates=28150, lr=7.25655e-06, gnorm=4.089, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59001
2022-05-09 13:12:31 - progress_bar.py[line:272] - INFO: epoch 002:  10491 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=387.9, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886136, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.229, expert1_balance_bottom=19.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=209.9, ups=0.54, wpb=387.9, bsz=32, num_updates=28160, lr=7.25535e-06, gnorm=3.806, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59019
2022-05-09 13:12:49 - progress_bar.py[line:272] - INFO: epoch 002:  10501 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.702, ntokens=374.3, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894357, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=34.004, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=209.4, ups=0.56, wpb=374.3, bsz=32, num_updates=28170, lr=7.25415e-06, gnorm=4.111, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59037
2022-05-09 13:13:07 - progress_bar.py[line:272] - INFO: epoch 002:  10511 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884373, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.198, expert1_balance_bottom=19.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=211.2, ups=0.55, wpb=381.9, bsz=32, num_updates=28180, lr=7.25295e-06, gnorm=3.912, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59055
2022-05-09 13:13:25 - progress_bar.py[line:272] - INFO: epoch 002:  10521 / 17711 loss=3.062, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=386.9, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880112, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.062, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.138, expert1_balance_bottom=19.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.2, ups=0.55, wpb=386.9, bsz=32, num_updates=28190, lr=7.25175e-06, gnorm=3.592, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59073
2022-05-09 13:13:43 - progress_bar.py[line:272] - INFO: epoch 002:  10531 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=382, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880525, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.386, expert1_balance_bottom=19.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209, ups=0.55, wpb=382, bsz=32, num_updates=28200, lr=7.25055e-06, gnorm=3.617, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59092
2022-05-09 13:14:02 - progress_bar.py[line:272] - INFO: epoch 002:  10541 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=378.9, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886588, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.014, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=206.8, ups=0.55, wpb=378.9, bsz=32, num_updates=28210, lr=7.24935e-06, gnorm=3.703, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59110
2022-05-09 13:14:20 - progress_bar.py[line:272] - INFO: epoch 002:  10551 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=379.3, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.935, expert1_balance_bottom=19.554, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=207.8, ups=0.55, wpb=379.3, bsz=32, num_updates=28220, lr=7.24814e-06, gnorm=3.305, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59128
2022-05-09 13:14:38 - progress_bar.py[line:272] - INFO: epoch 002:  10561 / 17711 loss=3.108, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879641, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.108, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.429, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=211.3, ups=0.55, wpb=383.3, bsz=32, num_updates=28230, lr=7.24694e-06, gnorm=3.856, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59146
2022-05-09 13:14:56 - progress_bar.py[line:272] - INFO: epoch 002:  10571 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=375.7, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896427, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.357, expert1_balance_bottom=19.723, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=205.8, ups=0.55, wpb=375.7, bsz=32, num_updates=28240, lr=7.24574e-06, gnorm=3.522, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59164
2022-05-09 13:15:15 - progress_bar.py[line:272] - INFO: epoch 002:  10581 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=376.7, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88501, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.847, expert1_balance_bottom=19.599, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=205.6, ups=0.55, wpb=376.7, bsz=32, num_updates=28250, lr=7.24454e-06, gnorm=3.344, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59183
2022-05-09 13:15:33 - progress_bar.py[line:272] - INFO: epoch 002:  10591 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=381.1, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87658, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.487, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=206.8, ups=0.54, wpb=381.1, bsz=32, num_updates=28260, lr=7.24334e-06, gnorm=3.321, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59201
2022-05-09 13:15:51 - progress_bar.py[line:272] - INFO: epoch 002:  10601 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=382.4, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.407, expert1_balance_bottom=19.859, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=209.5, ups=0.55, wpb=382.4, bsz=32, num_updates=28270, lr=7.24214e-06, gnorm=3.199, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59219
2022-05-09 13:16:10 - progress_bar.py[line:272] - INFO: epoch 002:  10611 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=377.3, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.086, expert1_balance_bottom=19.385, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=203.4, ups=0.54, wpb=377.3, bsz=32, num_updates=28280, lr=7.24094e-06, gnorm=3.147, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59238
2022-05-09 13:16:28 - progress_bar.py[line:272] - INFO: epoch 002:  10621 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=391.7, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.646, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.9, ups=0.55, wpb=391.7, bsz=32, num_updates=28290, lr=7.23973e-06, gnorm=4.005, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59256
2022-05-09 13:16:46 - progress_bar.py[line:272] - INFO: epoch 002:  10631 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=387.6, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.791, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.5, ups=0.56, wpb=387.6, bsz=32, num_updates=28300, lr=7.23853e-06, gnorm=3.447, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59274
2022-05-09 13:17:04 - progress_bar.py[line:272] - INFO: epoch 002:  10641 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=390.5, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887676, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.918, expert1_balance_bottom=19.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.1, ups=0.55, wpb=390.5, bsz=32, num_updates=28310, lr=7.23733e-06, gnorm=3.035, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59292
2022-05-09 13:17:23 - progress_bar.py[line:272] - INFO: epoch 002:  10651 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=385.1, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.724, expert1_balance_bottom=19.768, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=211, ups=0.55, wpb=385.1, bsz=32, num_updates=28320, lr=7.23613e-06, gnorm=3.318, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59311
2022-05-09 13:17:41 - progress_bar.py[line:272] - INFO: epoch 002:  10661 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=384.2, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868715, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=35.38, expert1_balance_bottom=18.974, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=211.1, ups=0.55, wpb=384.2, bsz=32, num_updates=28330, lr=7.23493e-06, gnorm=3.57, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59329
2022-05-09 13:17:59 - progress_bar.py[line:272] - INFO: epoch 002:  10671 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=378.4, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877097, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.737, expert1_balance_bottom=19.245, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=207.1, ups=0.55, wpb=378.4, bsz=32, num_updates=28340, lr=7.23373e-06, gnorm=3.388, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59347
2022-05-09 13:18:17 - progress_bar.py[line:272] - INFO: epoch 002:  10681 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=379.4, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88528, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.418, expert1_balance_bottom=19.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=209.7, ups=0.55, wpb=379.4, bsz=32, num_updates=28350, lr=7.23253e-06, gnorm=3.594, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59365
2022-05-09 13:18:35 - progress_bar.py[line:272] - INFO: epoch 002:  10691 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.679, expert1_balance_bottom=19.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.7, ups=0.55, wpb=384.8, bsz=32, num_updates=28360, lr=7.23133e-06, gnorm=3.758, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59383
2022-05-09 13:18:54 - progress_bar.py[line:272] - INFO: epoch 002:  10701 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.427, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=210.8, ups=0.54, wpb=387.2, bsz=32, num_updates=28370, lr=7.23012e-06, gnorm=3.565, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59402
2022-05-09 13:19:12 - progress_bar.py[line:272] - INFO: epoch 002:  10711 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890847, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.055, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=210.6, ups=0.55, wpb=381.7, bsz=32, num_updates=28380, lr=7.22892e-06, gnorm=3.116, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59420
2022-05-09 13:19:30 - progress_bar.py[line:272] - INFO: epoch 002:  10721 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=377.5, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.265, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=206, ups=0.55, wpb=377.5, bsz=32, num_updates=28390, lr=7.22772e-06, gnorm=3.985, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59438
2022-05-09 13:19:48 - progress_bar.py[line:272] - INFO: epoch 002:  10731 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=383.5, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.727, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.6, ups=0.55, wpb=383.5, bsz=32, num_updates=28400, lr=7.22652e-06, gnorm=3.411, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59456
2022-05-09 13:20:06 - progress_bar.py[line:272] - INFO: epoch 002:  10741 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.235, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=208.7, ups=0.55, wpb=379.6, bsz=32, num_updates=28410, lr=7.22532e-06, gnorm=3.618, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59474
2022-05-09 13:20:25 - progress_bar.py[line:272] - INFO: epoch 002:  10751 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.334, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=205, ups=0.54, wpb=378, bsz=32, num_updates=28420, lr=7.22412e-06, gnorm=3.07, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59493
2022-05-09 13:20:43 - progress_bar.py[line:272] - INFO: epoch 002:  10761 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885586, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.213, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=207.7, ups=0.54, wpb=383.2, bsz=32, num_updates=28430, lr=7.22292e-06, gnorm=3.271, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59511
2022-05-09 13:21:01 - progress_bar.py[line:272] - INFO: epoch 002:  10771 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=387.2, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.523, expert1_balance_bottom=19.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=212.9, ups=0.55, wpb=387.2, bsz=32, num_updates=28440, lr=7.22171e-06, gnorm=3.397, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59530
2022-05-09 13:21:20 - progress_bar.py[line:272] - INFO: epoch 002:  10781 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=384, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884031, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.777, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212, ups=0.55, wpb=384, bsz=32, num_updates=28450, lr=7.22051e-06, gnorm=3.644, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59548
2022-05-09 13:21:38 - progress_bar.py[line:272] - INFO: epoch 002:  10791 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=383.6, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880302, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.527, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.9, ups=0.56, wpb=383.6, bsz=32, num_updates=28460, lr=7.21931e-06, gnorm=4.139, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59566
2022-05-09 13:21:56 - progress_bar.py[line:272] - INFO: epoch 002:  10801 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889957, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.25, expert1_balance_bottom=19.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.4, ups=0.55, wpb=381, bsz=32, num_updates=28470, lr=7.21811e-06, gnorm=3.341, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59584
2022-05-09 13:22:01 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 13:22:15 - progress_bar.py[line:272] - INFO: epoch 002:  10812 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.168, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=191.9, ups=0.51, wpb=378.6, bsz=32, num_updates=28480, lr=7.21691e-06, gnorm=3.505, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59604
2022-05-09 13:22:34 - progress_bar.py[line:272] - INFO: epoch 002:  10822 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=392.1, nsentences=32, sample_size=312.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871478, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=35.669, expert1_balance_bottom=18.935, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.1, ups=0.55, wpb=392.1, bsz=32, num_updates=28490, lr=7.21571e-06, gnorm=3.523, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59622
2022-05-09 13:22:52 - progress_bar.py[line:272] - INFO: epoch 002:  10832 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=381.1, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.367, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=208, ups=0.55, wpb=381.1, bsz=32, num_updates=28500, lr=7.21451e-06, gnorm=3.671, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59640
2022-05-09 13:23:10 - progress_bar.py[line:272] - INFO: epoch 002:  10842 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.8, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=211.4, ups=0.55, wpb=381.5, bsz=32, num_updates=28510, lr=7.21331e-06, gnorm=3.302, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59658
2022-05-09 13:23:28 - progress_bar.py[line:272] - INFO: epoch 002:  10852 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=386.2, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885034, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.63, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=212.9, ups=0.55, wpb=386.2, bsz=32, num_updates=28520, lr=7.2121e-06, gnorm=3.238, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59676
2022-05-09 13:23:46 - progress_bar.py[line:272] - INFO: epoch 002:  10862 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=388.2, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.805, expert1_balance_bottom=19.256, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.5, ups=0.56, wpb=388.2, bsz=32, num_updates=28530, lr=7.2109e-06, gnorm=3.257, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59694
2022-05-09 13:24:04 - progress_bar.py[line:272] - INFO: epoch 002:  10872 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.589, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210, ups=0.55, wpb=378.6, bsz=32, num_updates=28540, lr=7.2097e-06, gnorm=3.639, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59712
2022-05-09 13:24:22 - progress_bar.py[line:272] - INFO: epoch 002:  10882 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=387.1, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88344, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.719, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.1, ups=0.56, wpb=387.1, bsz=32, num_updates=28550, lr=7.2085e-06, gnorm=3.257, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59730
2022-05-09 13:24:40 - progress_bar.py[line:272] - INFO: epoch 002:  10892 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=386.9, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876768, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.781, expert1_balance_bottom=19.479, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.1, ups=0.54, wpb=386.9, bsz=32, num_updates=28560, lr=7.2073e-06, gnorm=3.582, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59748
2022-05-09 13:24:59 - progress_bar.py[line:272] - INFO: epoch 002:  10902 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=388.6, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=35.028, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.7, ups=0.55, wpb=388.6, bsz=32, num_updates=28570, lr=7.2061e-06, gnorm=3.137, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59767
2022-05-09 13:25:17 - progress_bar.py[line:272] - INFO: epoch 002:  10912 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=385.9, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877964, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.897, expert1_balance_bottom=19.146, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.4, ups=0.55, wpb=385.9, bsz=32, num_updates=28580, lr=7.2049e-06, gnorm=3.16, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59785
2022-05-09 13:25:35 - progress_bar.py[line:272] - INFO: epoch 002:  10922 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.178, expert1_balance_bottom=19.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=211.3, ups=0.55, wpb=381.5, bsz=32, num_updates=28590, lr=7.2037e-06, gnorm=3.862, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59803
2022-05-09 13:25:53 - progress_bar.py[line:272] - INFO: epoch 002:  10932 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=376.5, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.767, expert1_balance_bottom=19.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.5, ups=0.56, wpb=376.5, bsz=32, num_updates=28600, lr=7.20249e-06, gnorm=2.883, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59821
2022-05-09 13:26:11 - progress_bar.py[line:272] - INFO: epoch 002:  10942 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=385.5, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.42, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=211.1, ups=0.55, wpb=385.5, bsz=32, num_updates=28610, lr=7.20129e-06, gnorm=3.258, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59839
2022-05-09 13:26:29 - progress_bar.py[line:272] - INFO: epoch 002:  10952 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=386.8, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.817, expert1_balance_bottom=19.8, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=216.3, ups=0.56, wpb=386.8, bsz=32, num_updates=28620, lr=7.20009e-06, gnorm=3.295, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59857
2022-05-09 13:26:47 - progress_bar.py[line:272] - INFO: epoch 002:  10962 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=35.264, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=206.9, ups=0.55, wpb=379.1, bsz=32, num_updates=28630, lr=7.19889e-06, gnorm=3.405, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59875
2022-05-09 13:27:05 - progress_bar.py[line:272] - INFO: epoch 002:  10972 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882589, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.567, expert1_balance_bottom=19.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=212.9, ups=0.55, wpb=386.3, bsz=32, num_updates=28640, lr=7.19769e-06, gnorm=3.397, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59893
2022-05-09 13:27:23 - progress_bar.py[line:272] - INFO: epoch 002:  10982 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=384.8, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879787, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.665, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=214, ups=0.56, wpb=384.8, bsz=32, num_updates=28650, lr=7.19649e-06, gnorm=3.434, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59911
2022-05-09 13:27:42 - progress_bar.py[line:272] - INFO: epoch 002:  10992 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=384.9, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=35.147, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=210.4, ups=0.55, wpb=384.9, bsz=32, num_updates=28660, lr=7.19529e-06, gnorm=3.822, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59930
2022-05-09 13:27:59 - progress_bar.py[line:272] - INFO: epoch 002:  11002 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8901, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.375, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=211.9, ups=0.56, wpb=378.5, bsz=32, num_updates=28670, lr=7.19408e-06, gnorm=3.666, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59948
2022-05-09 13:28:18 - progress_bar.py[line:272] - INFO: epoch 002:  11012 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=377.5, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885107, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.674, expert1_balance_bottom=19.404, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=208, ups=0.55, wpb=377.5, bsz=32, num_updates=28680, lr=7.19288e-06, gnorm=3.375, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59966
2022-05-09 13:28:36 - progress_bar.py[line:272] - INFO: epoch 002:  11022 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=382.1, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.42, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=209.7, ups=0.55, wpb=382.1, bsz=32, num_updates=28690, lr=7.19168e-06, gnorm=3.464, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=59984
2022-05-09 13:28:54 - progress_bar.py[line:272] - INFO: epoch 002:  11032 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=376.7, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.946, expert1_balance_bottom=19.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=204.8, ups=0.54, wpb=376.7, bsz=32, num_updates=28700, lr=7.19048e-06, gnorm=3.232, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60002
2022-05-09 13:29:12 - progress_bar.py[line:272] - INFO: epoch 002:  11042 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.496, expert1_balance_bottom=19.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=209.5, ups=0.55, wpb=382.3, bsz=32, num_updates=28710, lr=7.18928e-06, gnorm=3.56, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60021
2022-05-09 13:29:30 - progress_bar.py[line:272] - INFO: epoch 002:  11052 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=376.6, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89241, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.931, expert1_balance_bottom=19.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213, ups=0.57, wpb=376.6, bsz=32, num_updates=28720, lr=7.18808e-06, gnorm=3.614, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60038
2022-05-09 13:29:48 - progress_bar.py[line:272] - INFO: epoch 002:  11062 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=385.5, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.775, expert1_balance_bottom=19.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.3, ups=0.56, wpb=385.5, bsz=32, num_updates=28730, lr=7.18688e-06, gnorm=3.233, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60056
2022-05-09 13:30:06 - progress_bar.py[line:272] - INFO: epoch 002:  11072 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=386.2, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879305, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.802, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211, ups=0.55, wpb=386.2, bsz=32, num_updates=28740, lr=7.18568e-06, gnorm=3.008, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60075
2022-05-09 13:30:25 - progress_bar.py[line:272] - INFO: epoch 002:  11082 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=381, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.178, expert1_balance_bottom=19.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=211.2, ups=0.55, wpb=381, bsz=32, num_updates=28750, lr=7.18447e-06, gnorm=3.131, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60093
2022-05-09 13:30:42 - progress_bar.py[line:272] - INFO: epoch 002:  11092 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.479, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.1, ups=0.56, wpb=381.5, bsz=32, num_updates=28760, lr=7.18327e-06, gnorm=3.099, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60110
2022-05-09 13:31:01 - progress_bar.py[line:272] - INFO: epoch 002:  11102 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882381, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.599, expert1_balance_bottom=19.48, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=211.7, ups=0.55, wpb=384.9, bsz=32, num_updates=28770, lr=7.18207e-06, gnorm=3.519, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60129
2022-05-09 13:31:19 - progress_bar.py[line:272] - INFO: epoch 002:  11112 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=377.6, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888646, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=34.399, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=206.3, ups=0.55, wpb=377.6, bsz=32, num_updates=28780, lr=7.18087e-06, gnorm=3.374, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60147
2022-05-09 13:31:37 - progress_bar.py[line:272] - INFO: epoch 002:  11122 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=384.8, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875904, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.81, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.3, ups=0.55, wpb=384.8, bsz=32, num_updates=28790, lr=7.17967e-06, gnorm=3.64, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60165
2022-05-09 13:31:55 - progress_bar.py[line:272] - INFO: epoch 002:  11132 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=384.6, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894353, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.128, expert1_balance_bottom=19.559, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214.5, ups=0.56, wpb=384.6, bsz=32, num_updates=28800, lr=7.17847e-06, gnorm=4.336, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60183
2022-05-09 13:32:13 - progress_bar.py[line:272] - INFO: epoch 002:  11142 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886388, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.639, expert1_balance_bottom=19.237, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.9, ups=0.57, wpb=381.5, bsz=32, num_updates=28810, lr=7.17727e-06, gnorm=3.553, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60201
2022-05-09 13:32:30 - progress_bar.py[line:272] - INFO: epoch 002:  11152 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.871, expert1_balance_bottom=19.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214.6, ups=0.56, wpb=383.2, bsz=32, num_updates=28820, lr=7.17606e-06, gnorm=3.383, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60219
2022-05-09 13:32:48 - progress_bar.py[line:272] - INFO: epoch 002:  11162 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891419, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.082, expert1_balance_bottom=19.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.7, ups=0.56, wpb=380.4, bsz=32, num_updates=28830, lr=7.17486e-06, gnorm=3.633, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60236
2022-05-09 13:33:06 - progress_bar.py[line:272] - INFO: epoch 002:  11172 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=387, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.19, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.4, ups=0.56, wpb=387, bsz=32, num_updates=28840, lr=7.17366e-06, gnorm=3.71, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60254
2022-05-09 13:33:24 - progress_bar.py[line:272] - INFO: epoch 002:  11182 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=377.7, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=34.042, expert1_balance_bottom=19.42, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214, ups=0.57, wpb=377.7, bsz=32, num_updates=28850, lr=7.17246e-06, gnorm=3.341, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60272
2022-05-09 13:33:41 - progress_bar.py[line:272] - INFO: epoch 002:  11192 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=379.9, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.192, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=213.7, ups=0.56, wpb=379.9, bsz=32, num_updates=28860, lr=7.17126e-06, gnorm=3.632, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60289
2022-05-09 13:33:59 - progress_bar.py[line:272] - INFO: epoch 002:  11202 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=378.9, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869722, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=35.249, expert1_balance_bottom=19.123, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=213.7, ups=0.56, wpb=378.9, bsz=32, num_updates=28870, lr=7.17006e-06, gnorm=3.161, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60307
2022-05-09 13:34:17 - progress_bar.py[line:272] - INFO: epoch 002:  11212 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=393.1, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=35.025, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.2, ups=0.57, wpb=393.1, bsz=32, num_updates=28880, lr=7.16886e-06, gnorm=3.596, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60325
2022-05-09 13:34:34 - progress_bar.py[line:272] - INFO: epoch 002:  11222 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=378.9, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88501, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.372, expert1_balance_bottom=19.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.6, ups=0.56, wpb=378.9, bsz=32, num_updates=28890, lr=7.16766e-06, gnorm=3.741, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60343
2022-05-09 13:34:52 - progress_bar.py[line:272] - INFO: epoch 002:  11232 / 17711 loss=2.924, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=383.9, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880448, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.924, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.554, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=213.7, ups=0.56, wpb=383.9, bsz=32, num_updates=28900, lr=7.16645e-06, gnorm=3.167, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60361
2022-05-09 13:35:10 - progress_bar.py[line:272] - INFO: epoch 002:  11242 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=378.1, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880224, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.669, expert1_balance_bottom=19.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.4, ups=0.58, wpb=378.1, bsz=32, num_updates=28910, lr=7.16525e-06, gnorm=3.868, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60378
2022-05-09 13:35:27 - progress_bar.py[line:272] - INFO: epoch 002:  11252 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=376.5, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895776, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.663, expert1_balance_bottom=19.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=215.9, ups=0.57, wpb=376.5, bsz=32, num_updates=28920, lr=7.16405e-06, gnorm=3.498, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60395
2022-05-09 13:35:45 - progress_bar.py[line:272] - INFO: epoch 002:  11262 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=386, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.838, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.4, ups=0.57, wpb=386, bsz=32, num_updates=28930, lr=7.16285e-06, gnorm=3.638, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60413
2022-05-09 13:36:02 - progress_bar.py[line:272] - INFO: epoch 002:  11272 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.797, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=220.3, ups=0.58, wpb=380.6, bsz=32, num_updates=28940, lr=7.16165e-06, gnorm=3.596, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60430
2022-05-09 13:36:19 - progress_bar.py[line:272] - INFO: epoch 002:  11282 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=391.6, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.593, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.3, ups=0.57, wpb=391.6, bsz=32, num_updates=28950, lr=7.16045e-06, gnorm=3.275, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60447
2022-05-09 13:36:37 - progress_bar.py[line:272] - INFO: epoch 002:  11292 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=35.056, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.8, ups=0.56, wpb=382.6, bsz=32, num_updates=28960, lr=7.15925e-06, gnorm=3.339, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60465
2022-05-09 13:36:55 - progress_bar.py[line:272] - INFO: epoch 002:  11302 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=377, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.589, expert1_balance_bottom=19.748, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=214.2, ups=0.57, wpb=377, bsz=32, num_updates=28970, lr=7.15805e-06, gnorm=4.019, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60483
2022-05-09 13:37:13 - progress_bar.py[line:272] - INFO: epoch 002:  11312 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=385.2, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880843, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.727, expert1_balance_bottom=19.283, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.1, ups=0.55, wpb=385.2, bsz=32, num_updates=28980, lr=7.15684e-06, gnorm=3.487, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60501
2022-05-09 13:37:31 - progress_bar.py[line:272] - INFO: epoch 002:  11322 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.379, expert1_balance_bottom=19.197, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213, ups=0.55, wpb=386.3, bsz=32, num_updates=28990, lr=7.15564e-06, gnorm=3.66, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60519
2022-05-09 13:37:49 - progress_bar.py[line:272] - INFO: epoch 002:  11332 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=387.5, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.198, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.4, ups=0.57, wpb=387.5, bsz=32, num_updates=29000, lr=7.15444e-06, gnorm=3.763, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60537
2022-05-09 13:38:07 - progress_bar.py[line:272] - INFO: epoch 002:  11342 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=378.2, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877264, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.605, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=209.2, ups=0.55, wpb=378.2, bsz=32, num_updates=29010, lr=7.15324e-06, gnorm=3.798, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60555
2022-05-09 13:38:25 - progress_bar.py[line:272] - INFO: epoch 002:  11352 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=375.3, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884963, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.363, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=209.3, ups=0.56, wpb=375.3, bsz=32, num_updates=29020, lr=7.15204e-06, gnorm=3.004, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60573
2022-05-09 13:38:43 - progress_bar.py[line:272] - INFO: epoch 002:  11362 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=378.2, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893615, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.846, expert1_balance_bottom=19.664, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=210.1, ups=0.56, wpb=378.2, bsz=32, num_updates=29030, lr=7.15084e-06, gnorm=3.327, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60591
2022-05-09 13:39:00 - progress_bar.py[line:272] - INFO: epoch 002:  11372 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=380.3, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.951, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=219.3, ups=0.58, wpb=380.3, bsz=32, num_updates=29040, lr=7.14964e-06, gnorm=4.145, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60608
2022-05-09 13:39:18 - progress_bar.py[line:272] - INFO: epoch 002:  11382 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.549, expert1_balance_bottom=19.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=214.7, ups=0.56, wpb=386, bsz=32, num_updates=29050, lr=7.14843e-06, gnorm=3.097, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60626
2022-05-09 13:39:36 - progress_bar.py[line:272] - INFO: epoch 002:  11392 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=379.9, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.409, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.9, ups=0.56, wpb=379.9, bsz=32, num_updates=29060, lr=7.14723e-06, gnorm=3.114, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60644
2022-05-09 13:39:54 - progress_bar.py[line:272] - INFO: epoch 002:  11402 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=387.7, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.027, expert1_balance_bottom=19.657, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217, ups=0.56, wpb=387.7, bsz=32, num_updates=29070, lr=7.14603e-06, gnorm=3.502, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60662
2022-05-09 13:40:12 - progress_bar.py[line:272] - INFO: epoch 002:  11412 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=387, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.54, expert1_balance_bottom=19.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=214.9, ups=0.56, wpb=387, bsz=32, num_updates=29080, lr=7.14483e-06, gnorm=3.371, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60680
2022-05-09 13:40:29 - progress_bar.py[line:272] - INFO: epoch 002:  11422 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.459, expert1_balance_bottom=19.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=217.4, ups=0.56, wpb=386.3, bsz=32, num_updates=29090, lr=7.14363e-06, gnorm=3.604, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60697
2022-05-09 13:40:47 - progress_bar.py[line:272] - INFO: epoch 002:  11432 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.622, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.8, ups=0.57, wpb=382.3, bsz=32, num_updates=29100, lr=7.14243e-06, gnorm=3.493, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60715
2022-05-09 13:41:04 - progress_bar.py[line:272] - INFO: epoch 002:  11442 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=392.9, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.469, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.1, ups=0.57, wpb=392.9, bsz=32, num_updates=29110, lr=7.14123e-06, gnorm=3.505, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60732
2022-05-09 13:41:22 - progress_bar.py[line:272] - INFO: epoch 002:  11452 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=383.9, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880398, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.648, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=218.2, ups=0.57, wpb=383.9, bsz=32, num_updates=29120, lr=7.14003e-06, gnorm=4.91, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60750
2022-05-09 13:41:39 - progress_bar.py[line:272] - INFO: epoch 002:  11462 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.538, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220, ups=0.57, wpb=383.2, bsz=32, num_updates=29130, lr=7.13882e-06, gnorm=3.556, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60767
2022-05-09 13:41:57 - progress_bar.py[line:272] - INFO: epoch 002:  11472 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=397.9, nsentences=32, sample_size=316.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=35.04, expert1_balance_bottom=19.155, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.8, ups=0.57, wpb=397.9, bsz=32, num_updates=29140, lr=7.13762e-06, gnorm=3.499, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60785
2022-05-09 13:42:15 - progress_bar.py[line:272] - INFO: epoch 002:  11482 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=391, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882427, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.64, expert1_balance_bottom=19.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=220.5, ups=0.56, wpb=391, bsz=32, num_updates=29150, lr=7.13642e-06, gnorm=3.476, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60803
2022-05-09 13:42:32 - progress_bar.py[line:272] - INFO: epoch 002:  11492 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=391.8, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.245, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.6, ups=0.57, wpb=391.8, bsz=32, num_updates=29160, lr=7.13522e-06, gnorm=3.085, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60820
2022-05-09 13:42:50 - progress_bar.py[line:272] - INFO: epoch 002:  11502 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.396, expert1_balance_bottom=19.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.3, ups=0.56, wpb=388.2, bsz=32, num_updates=29170, lr=7.13402e-06, gnorm=4.1, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60838
2022-05-09 13:43:08 - progress_bar.py[line:272] - INFO: epoch 002:  11512 / 17711 loss=3.097, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=393.1, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872771, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.097, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.732, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=216.1, ups=0.55, wpb=393.1, bsz=32, num_updates=29180, lr=7.13282e-06, gnorm=3.789, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60856
2022-05-09 13:43:26 - progress_bar.py[line:272] - INFO: epoch 002:  11522 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=381.9, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887734, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.139, expert1_balance_bottom=19.646, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=211.3, ups=0.55, wpb=381.9, bsz=32, num_updates=29190, lr=7.13162e-06, gnorm=3.572, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60874
2022-05-09 13:43:45 - progress_bar.py[line:272] - INFO: epoch 002:  11532 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=382.5, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.661, expert1_balance_bottom=19.62, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.2, ups=0.55, wpb=382.5, bsz=32, num_updates=29200, lr=7.13041e-06, gnorm=5.073, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60893
2022-05-09 13:44:03 - progress_bar.py[line:272] - INFO: epoch 002:  11542 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=380.7, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868799, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=35.597, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=212.9, ups=0.56, wpb=380.7, bsz=32, num_updates=29210, lr=7.12921e-06, gnorm=3.906, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60911
2022-05-09 13:44:20 - progress_bar.py[line:272] - INFO: epoch 002:  11552 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=387.6, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878175, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.761, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.3, ups=0.56, wpb=387.6, bsz=32, num_updates=29220, lr=7.12801e-06, gnorm=3.422, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60928
2022-05-09 13:44:38 - progress_bar.py[line:272] - INFO: epoch 002:  11562 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875557, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=35.204, expert1_balance_bottom=19.035, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.1, ups=0.56, wpb=385.6, bsz=32, num_updates=29230, lr=7.12681e-06, gnorm=3.846, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60946
2022-05-09 13:44:56 - progress_bar.py[line:272] - INFO: epoch 002:  11572 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.5, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215, ups=0.56, wpb=385.7, bsz=32, num_updates=29240, lr=7.12561e-06, gnorm=3.379, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60964
2022-05-09 13:45:14 - progress_bar.py[line:272] - INFO: epoch 002:  11582 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.409, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.4, ups=0.57, wpb=386.5, bsz=32, num_updates=29250, lr=7.12441e-06, gnorm=4.392, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=60982
2022-05-09 13:45:32 - progress_bar.py[line:272] - INFO: epoch 002:  11592 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=375.1, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88746, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.471, expert1_balance_bottom=19.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.3, ups=0.56, wpb=375.1, bsz=32, num_updates=29260, lr=7.12321e-06, gnorm=3.748, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61000
2022-05-09 13:45:49 - progress_bar.py[line:272] - INFO: epoch 002:  11602 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=382.8, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.327, expert1_balance_bottom=19.213, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.1, ups=0.57, wpb=382.8, bsz=32, num_updates=29270, lr=7.12201e-06, gnorm=4.064, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61017
2022-05-09 13:46:07 - progress_bar.py[line:272] - INFO: epoch 002:  11612 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.756, expert1_balance_bottom=19.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=213.5, ups=0.56, wpb=381.3, bsz=32, num_updates=29280, lr=7.1208e-06, gnorm=3.513, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61035
2022-05-09 13:46:25 - progress_bar.py[line:272] - INFO: epoch 002:  11622 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=375.6, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895403, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.676, expert1_balance_bottom=19.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.4, ups=0.56, wpb=375.6, bsz=32, num_updates=29290, lr=7.1196e-06, gnorm=3.981, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61053
2022-05-09 13:46:43 - progress_bar.py[line:272] - INFO: epoch 002:  11632 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=390.5, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885739, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.924, expert1_balance_bottom=19.677, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220.6, ups=0.56, wpb=390.5, bsz=32, num_updates=29300, lr=7.1184e-06, gnorm=4.262, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61071
2022-05-09 13:47:00 - progress_bar.py[line:272] - INFO: epoch 002:  11642 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=382.1, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882079, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.818, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.5, ups=0.57, wpb=382.1, bsz=32, num_updates=29310, lr=7.1172e-06, gnorm=4.157, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61088
2022-05-09 13:47:18 - progress_bar.py[line:272] - INFO: epoch 002:  11652 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=387.3, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.972, expert1_balance_bottom=19.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.2, ups=0.57, wpb=387.3, bsz=32, num_updates=29320, lr=7.116e-06, gnorm=3.65, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61106
2022-05-09 13:47:35 - progress_bar.py[line:272] - INFO: epoch 002:  11662 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880859, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.863, expert1_balance_bottom=19.1, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.8, ups=0.57, wpb=382.8, bsz=32, num_updates=29330, lr=7.1148e-06, gnorm=3.584, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61124
2022-05-09 13:47:53 - progress_bar.py[line:272] - INFO: epoch 002:  11672 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=378.6, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.694, expert1_balance_bottom=19.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=214.2, ups=0.57, wpb=378.6, bsz=32, num_updates=29340, lr=7.1136e-06, gnorm=3.384, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61141
2022-05-09 13:47:58 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 13:48:13 - progress_bar.py[line:272] - INFO: epoch 002:  11683 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=376.4, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.442, expert1_balance_bottom=19.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=190.6, ups=0.51, wpb=376.4, bsz=32, num_updates=29350, lr=7.1124e-06, gnorm=3.821, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61161
2022-05-09 13:48:31 - progress_bar.py[line:272] - INFO: epoch 002:  11693 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=384.7, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.129, expert1_balance_top=33.804, expert1_balance_bottom=19.586, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.8, ups=0.56, wpb=384.7, bsz=32, num_updates=29360, lr=7.11119e-06, gnorm=4.021, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61179
2022-05-09 13:48:49 - progress_bar.py[line:272] - INFO: epoch 002:  11703 / 17711 loss=3.11, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=376.5, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.907362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.11, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.134, expert1_balance_top=32.897, expert1_balance_bottom=19.855, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=207.5, ups=0.55, wpb=376.5, bsz=32, num_updates=29370, lr=7.10999e-06, gnorm=3.476, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61197
2022-05-09 13:49:07 - progress_bar.py[line:272] - INFO: epoch 002:  11713 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=379.1, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.059, expert1_balance_bottom=19.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=210.2, ups=0.55, wpb=379.1, bsz=32, num_updates=29380, lr=7.10879e-06, gnorm=3.46, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61215
2022-05-09 13:49:25 - progress_bar.py[line:272] - INFO: epoch 002:  11723 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=375.4, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890571, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.818, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=207.6, ups=0.55, wpb=375.4, bsz=32, num_updates=29390, lr=7.10759e-06, gnorm=3.203, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61233
2022-05-09 13:49:43 - progress_bar.py[line:272] - INFO: epoch 002:  11733 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885251, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.319, expert1_balance_bottom=19.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.1, ups=0.55, wpb=385, bsz=32, num_updates=29400, lr=7.10639e-06, gnorm=4.315, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61251
2022-05-09 13:50:01 - progress_bar.py[line:272] - INFO: epoch 002:  11743 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885772, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.048, expert1_balance_bottom=19.511, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210.2, ups=0.55, wpb=382.4, bsz=32, num_updates=29410, lr=7.10519e-06, gnorm=3.142, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61269
2022-05-09 13:50:19 - progress_bar.py[line:272] - INFO: epoch 002:  11753 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=386.7, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884331, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.159, expert1_balance_bottom=19.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.4, ups=0.56, wpb=386.7, bsz=32, num_updates=29420, lr=7.10399e-06, gnorm=3.606, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61287
2022-05-09 13:50:37 - progress_bar.py[line:272] - INFO: epoch 002:  11763 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=378.8, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878672, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.55, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.9, ups=0.57, wpb=378.8, bsz=32, num_updates=29430, lr=7.10278e-06, gnorm=3.197, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61305
2022-05-09 13:50:54 - progress_bar.py[line:272] - INFO: epoch 002:  11773 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=379.5, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.403, expert1_balance_bottom=19.287, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214.9, ups=0.57, wpb=379.5, bsz=32, num_updates=29440, lr=7.10158e-06, gnorm=3.447, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61323
2022-05-09 13:51:12 - progress_bar.py[line:272] - INFO: epoch 002:  11783 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886661, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.173, expert1_balance_bottom=19.292, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.3, ups=0.57, wpb=381.4, bsz=32, num_updates=29450, lr=7.10038e-06, gnorm=4.213, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61340
2022-05-09 13:51:30 - progress_bar.py[line:272] - INFO: epoch 002:  11793 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884724, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.213, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.1, ups=0.57, wpb=384.7, bsz=32, num_updates=29460, lr=7.09918e-06, gnorm=3.347, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61358
2022-05-09 13:51:47 - progress_bar.py[line:272] - INFO: epoch 002:  11803 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88689, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.306, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.7, ups=0.58, wpb=378.6, bsz=32, num_updates=29470, lr=7.09798e-06, gnorm=3.989, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61375
2022-05-09 13:52:05 - progress_bar.py[line:272] - INFO: epoch 002:  11813 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891648, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.855, expert1_balance_bottom=19.499, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.5, ups=0.57, wpb=383.6, bsz=32, num_updates=29480, lr=7.09678e-06, gnorm=3.969, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61393
2022-05-09 13:52:22 - progress_bar.py[line:272] - INFO: epoch 002:  11823 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=387.6, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891045, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.62, expert1_balance_bottom=19.563, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=218, ups=0.56, wpb=387.6, bsz=32, num_updates=29490, lr=7.09558e-06, gnorm=3.741, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61410
2022-05-09 13:52:40 - progress_bar.py[line:272] - INFO: epoch 002:  11833 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=378.6, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.83, expert1_balance_bottom=19.621, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=210.7, ups=0.56, wpb=378.6, bsz=32, num_updates=29500, lr=7.09438e-06, gnorm=4.331, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61428
2022-05-09 13:52:58 - progress_bar.py[line:272] - INFO: epoch 002:  11843 / 17711 loss=3.143, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884907, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.143, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.247, expert1_balance_bottom=19.418, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=213.7, ups=0.56, wpb=383.4, bsz=32, num_updates=29510, lr=7.09317e-06, gnorm=3.712, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61446
2022-05-09 13:53:16 - progress_bar.py[line:272] - INFO: epoch 002:  11853 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=386.1, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=35.905, expert1_balance_bottom=18.82, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=219.1, ups=0.57, wpb=386.1, bsz=32, num_updates=29520, lr=7.09197e-06, gnorm=3.586, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61464
2022-05-09 13:53:34 - progress_bar.py[line:272] - INFO: epoch 002:  11863 / 17711 loss=3.065, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=382.4, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.065, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.651, expert1_balance_bottom=19.113, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211, ups=0.55, wpb=382.4, bsz=32, num_updates=29530, lr=7.09077e-06, gnorm=3.772, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61482
2022-05-09 13:53:52 - progress_bar.py[line:272] - INFO: epoch 002:  11873 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.076, expert1_balance_bottom=19.522, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.9, ups=0.57, wpb=384, bsz=32, num_updates=29540, lr=7.08957e-06, gnorm=3.003, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61500
2022-05-09 13:54:10 - progress_bar.py[line:272] - INFO: epoch 002:  11883 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=387.3, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.503, expert1_balance_bottom=19.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=214.9, ups=0.55, wpb=387.3, bsz=32, num_updates=29550, lr=7.08837e-06, gnorm=3.503, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61518
2022-05-09 13:54:28 - progress_bar.py[line:272] - INFO: epoch 002:  11893 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=388.3, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873524, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.526, expert1_balance_bottom=19.338, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.4, ups=0.56, wpb=388.3, bsz=32, num_updates=29560, lr=7.08717e-06, gnorm=3.741, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61536
2022-05-09 13:54:45 - progress_bar.py[line:272] - INFO: epoch 002:  11903 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.156, expert1_balance_bottom=19.413, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214, ups=0.56, wpb=383.6, bsz=32, num_updates=29570, lr=7.08597e-06, gnorm=3.941, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61554
2022-05-09 13:55:03 - progress_bar.py[line:272] - INFO: epoch 002:  11913 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=380.3, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.212, expert1_balance_bottom=19.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.6, ups=0.56, wpb=380.3, bsz=32, num_updates=29580, lr=7.08476e-06, gnorm=4.565, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61571
2022-05-09 13:55:21 - progress_bar.py[line:272] - INFO: epoch 002:  11923 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=386.6, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879786, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.421, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.3, ups=0.56, wpb=386.6, bsz=32, num_updates=29590, lr=7.08356e-06, gnorm=3.514, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61589
2022-05-09 13:55:40 - progress_bar.py[line:272] - INFO: epoch 002:  11933 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=377.8, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880906, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.4, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=207.4, ups=0.55, wpb=377.8, bsz=32, num_updates=29600, lr=7.08236e-06, gnorm=3.214, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61608
2022-05-09 13:55:58 - progress_bar.py[line:272] - INFO: epoch 002:  11943 / 17711 loss=3.107, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=389.8, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.107, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.994, expert1_balance_bottom=19.398, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.7, ups=0.55, wpb=389.8, bsz=32, num_updates=29610, lr=7.08116e-06, gnorm=3.833, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61626
2022-05-09 13:56:16 - progress_bar.py[line:272] - INFO: epoch 002:  11953 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=381, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882748, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.663, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=210.7, ups=0.55, wpb=381, bsz=32, num_updates=29620, lr=7.07996e-06, gnorm=4.112, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61644
2022-05-09 13:56:34 - progress_bar.py[line:272] - INFO: epoch 002:  11963 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.933, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=210.9, ups=0.55, wpb=381.1, bsz=32, num_updates=29630, lr=7.07876e-06, gnorm=3.713, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61662
2022-05-09 13:56:52 - progress_bar.py[line:272] - INFO: epoch 002:  11973 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=376.5, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879092, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.403, expert1_balance_bottom=19.341, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=207, ups=0.55, wpb=376.5, bsz=32, num_updates=29640, lr=7.07756e-06, gnorm=4.213, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61680
2022-05-09 13:57:10 - progress_bar.py[line:272] - INFO: epoch 002:  11983 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901029, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.231, expert1_balance_bottom=19.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214, ups=0.56, wpb=379.5, bsz=32, num_updates=29650, lr=7.07636e-06, gnorm=3.593, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61698
2022-05-09 13:57:28 - progress_bar.py[line:272] - INFO: epoch 002:  11993 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=379.5, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.471, expert1_balance_bottom=19.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=210, ups=0.55, wpb=379.5, bsz=32, num_updates=29660, lr=7.07515e-06, gnorm=3.811, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61716
2022-05-09 13:57:46 - progress_bar.py[line:272] - INFO: epoch 002:  12003 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=383.9, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.301, expert1_balance_bottom=19.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=215.1, ups=0.56, wpb=383.9, bsz=32, num_updates=29670, lr=7.07395e-06, gnorm=4.01, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61734
2022-05-09 13:58:03 - progress_bar.py[line:272] - INFO: epoch 002:  12013 / 17711 loss=3.118, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=383.5, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.118, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.37, expert1_balance_bottom=19.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=218.7, ups=0.57, wpb=383.5, bsz=32, num_updates=29680, lr=7.07275e-06, gnorm=4.425, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61751
2022-05-09 13:58:21 - progress_bar.py[line:272] - INFO: epoch 002:  12023 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.149, expert1_balance_bottom=19.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=212, ups=0.56, wpb=378.2, bsz=32, num_updates=29690, lr=7.07155e-06, gnorm=2.911, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61769
2022-05-09 13:58:38 - progress_bar.py[line:272] - INFO: epoch 002:  12033 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=372.4, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884578, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.517, expert1_balance_bottom=19.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214.8, ups=0.58, wpb=372.4, bsz=32, num_updates=29700, lr=7.07035e-06, gnorm=4.128, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61786
2022-05-09 13:58:56 - progress_bar.py[line:272] - INFO: epoch 002:  12043 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=374, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899357, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.13, expert1_balance_top=33.609, expert1_balance_bottom=19.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.5, ups=0.57, wpb=374, bsz=32, num_updates=29710, lr=7.06915e-06, gnorm=3.726, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61804
2022-05-09 13:59:13 - progress_bar.py[line:272] - INFO: epoch 002:  12053 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.956, expert1_balance_bottom=19.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.2, ups=0.57, wpb=382.3, bsz=32, num_updates=29720, lr=7.06795e-06, gnorm=3.192, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61821
2022-05-09 13:59:31 - progress_bar.py[line:272] - INFO: epoch 002:  12063 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=383.6, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.833, expert1_balance_bottom=19.548, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.5, ups=0.57, wpb=383.6, bsz=32, num_updates=29730, lr=7.06675e-06, gnorm=3.429, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61839
2022-05-09 13:59:49 - progress_bar.py[line:272] - INFO: epoch 002:  12073 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=385.3, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874688, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.786, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=220.1, ups=0.57, wpb=385.3, bsz=32, num_updates=29740, lr=7.06554e-06, gnorm=3.985, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61857
2022-05-09 14:00:06 - progress_bar.py[line:272] - INFO: epoch 002:  12083 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=377.4, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.66, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=214.3, ups=0.57, wpb=377.4, bsz=32, num_updates=29750, lr=7.06434e-06, gnorm=3.558, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61874
2022-05-09 14:00:24 - progress_bar.py[line:272] - INFO: epoch 002:  12093 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=382.4, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887244, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.938, expert1_balance_bottom=19.599, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.8, ups=0.57, wpb=382.4, bsz=32, num_updates=29760, lr=7.06314e-06, gnorm=3.805, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61892
2022-05-09 14:00:41 - progress_bar.py[line:272] - INFO: epoch 002:  12103 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878585, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.614, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.2, ups=0.57, wpb=382.8, bsz=32, num_updates=29770, lr=7.06194e-06, gnorm=3.249, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61909
2022-05-09 14:00:59 - progress_bar.py[line:272] - INFO: epoch 002:  12113 / 17711 loss=3.111, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=387.6, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882435, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.111, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.19, expert1_balance_bottom=19.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218.7, ups=0.56, wpb=387.6, bsz=32, num_updates=29780, lr=7.06074e-06, gnorm=3.971, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61927
2022-05-09 14:01:17 - progress_bar.py[line:272] - INFO: epoch 002:  12123 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88696, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.784, expert1_balance_bottom=19.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.4, ups=0.57, wpb=386.6, bsz=32, num_updates=29790, lr=7.05954e-06, gnorm=3.615, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61945
2022-05-09 14:01:34 - progress_bar.py[line:272] - INFO: epoch 002:  12133 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=366.5, nsentences=32, sample_size=291.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=34.139, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.2, ups=0.58, wpb=366.5, bsz=32, num_updates=29800, lr=7.05834e-06, gnorm=3.765, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61962
2022-05-09 14:01:51 - progress_bar.py[line:272] - INFO: epoch 002:  12143 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=387.7, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=33.871, expert1_balance_bottom=19.625, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.3, ups=0.57, wpb=387.7, bsz=32, num_updates=29810, lr=7.05713e-06, gnorm=3.463, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61979
2022-05-09 14:02:09 - progress_bar.py[line:272] - INFO: epoch 002:  12153 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=390.9, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871552, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=35.054, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=222, ups=0.57, wpb=390.9, bsz=32, num_updates=29820, lr=7.05593e-06, gnorm=4.034, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=61997
2022-05-09 14:02:27 - progress_bar.py[line:272] - INFO: epoch 002:  12163 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=381.1, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.222, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=215.8, ups=0.57, wpb=381.1, bsz=32, num_updates=29830, lr=7.05473e-06, gnorm=3.259, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62015
2022-05-09 14:02:44 - progress_bar.py[line:272] - INFO: epoch 002:  12173 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.299, expert1_balance_bottom=19.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.5, ups=0.57, wpb=383.1, bsz=32, num_updates=29840, lr=7.05353e-06, gnorm=3.511, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62032
2022-05-09 14:03:02 - progress_bar.py[line:272] - INFO: epoch 002:  12183 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=382.3, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881105, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.717, expert1_balance_bottom=19.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=217.8, ups=0.57, wpb=382.3, bsz=32, num_updates=29850, lr=7.05233e-06, gnorm=3.301, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62050
2022-05-09 14:03:19 - progress_bar.py[line:272] - INFO: epoch 002:  12193 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=375.1, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.747, expert1_balance_bottom=19.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.6, ups=0.57, wpb=375.1, bsz=32, num_updates=29860, lr=7.05113e-06, gnorm=3.272, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62067
2022-05-09 14:03:36 - progress_bar.py[line:272] - INFO: epoch 002:  12203 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=379.3, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887037, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.608, expert1_balance_bottom=19.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.5, ups=0.59, wpb=379.3, bsz=32, num_updates=29870, lr=7.04993e-06, gnorm=3.664, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62084
2022-05-09 14:03:54 - progress_bar.py[line:272] - INFO: epoch 002:  12213 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=385.9, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879914, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.608, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220, ups=0.57, wpb=385.9, bsz=32, num_updates=29880, lr=7.04873e-06, gnorm=3.834, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62102
2022-05-09 14:04:11 - progress_bar.py[line:272] - INFO: epoch 002:  12223 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=376, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893544, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.796, expert1_balance_bottom=19.465, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.3, ups=0.57, wpb=376, bsz=32, num_updates=29890, lr=7.04752e-06, gnorm=3.095, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62119
2022-05-09 14:04:29 - progress_bar.py[line:272] - INFO: epoch 002:  12233 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=389.1, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.105, expert1_balance_bottom=19.559, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=220.1, ups=0.57, wpb=389.1, bsz=32, num_updates=29900, lr=7.04632e-06, gnorm=3.565, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62137
2022-05-09 14:04:46 - progress_bar.py[line:272] - INFO: epoch 002:  12243 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=389.4, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.873, expert1_balance_bottom=19.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.1, ups=0.57, wpb=389.4, bsz=32, num_updates=29910, lr=7.04512e-06, gnorm=3.626, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62154
2022-05-09 14:05:04 - progress_bar.py[line:272] - INFO: epoch 002:  12253 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=390.3, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870129, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.926, expert1_balance_bottom=19.124, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.8, ups=0.57, wpb=390.3, bsz=32, num_updates=29920, lr=7.04392e-06, gnorm=3.568, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62172
2022-05-09 14:05:22 - progress_bar.py[line:272] - INFO: epoch 002:  12263 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.555, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=218.3, ups=0.57, wpb=386.3, bsz=32, num_updates=29930, lr=7.04272e-06, gnorm=3.748, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62190
2022-05-09 14:05:39 - progress_bar.py[line:272] - INFO: epoch 002:  12273 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=383.3, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885422, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.401, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=218.6, ups=0.57, wpb=383.3, bsz=32, num_updates=29940, lr=7.04152e-06, gnorm=3.053, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62207
2022-05-09 14:05:57 - progress_bar.py[line:272] - INFO: epoch 002:  12283 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885352, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.436, expert1_balance_bottom=19.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.7, ups=0.57, wpb=385.7, bsz=32, num_updates=29950, lr=7.04032e-06, gnorm=4.081, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62225
2022-05-09 14:06:14 - progress_bar.py[line:272] - INFO: epoch 002:  12293 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=380, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.41, expert1_balance_bottom=19.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.3, ups=0.57, wpb=380, bsz=32, num_updates=29960, lr=7.03911e-06, gnorm=3.918, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62242
2022-05-09 14:06:32 - progress_bar.py[line:272] - INFO: epoch 002:  12303 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=391.2, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877124, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.809, expert1_balance_bottom=19.287, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.5, ups=0.57, wpb=391.2, bsz=32, num_updates=29970, lr=7.03791e-06, gnorm=4.423, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62260
2022-05-09 14:06:50 - progress_bar.py[line:272] - INFO: epoch 002:  12313 / 17711 loss=3.059, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.059, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.147, expert1_balance_bottom=19.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221, ups=0.57, wpb=387, bsz=32, num_updates=29980, lr=7.03671e-06, gnorm=3.511, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62278
2022-05-09 14:07:07 - progress_bar.py[line:272] - INFO: epoch 002:  12323 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=387.3, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.283, expert1_balance_bottom=19.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220.5, ups=0.57, wpb=387.3, bsz=32, num_updates=29990, lr=7.03551e-06, gnorm=4.016, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62295
2022-05-09 14:07:25 - progress_bar.py[line:272] - INFO: epoch 002:  12333 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=376.9, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888465, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.286, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=212.9, ups=0.56, wpb=376.9, bsz=32, num_updates=30000, lr=7.03431e-06, gnorm=3.607, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62313
2022-05-09 14:07:25 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 14:07:25 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 14:07:25 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 14:14:40 - train.py[line:517] - INFO: valid_step finished
2022-05-09 14:14:40 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 9.915 | loss_v1 0 | loss_v2 0 | nll_loss 8.247 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.996351 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 9.915 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.18 | expert1_balance_top 39.406 | expert1_balance_bottom 15.338 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 303.87 | cider 1.196 | wps 691.9 | wpb 481.7 | bsz 8 | num_updates 30000 | best_cider 1.198
2022-05-09 14:14:40 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 30000 updates
2022-05-09 14:14:40 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_30000-rank-0.pt
2022-05-09 14:14:40 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_30000-rank-0.pt
2022-05-09 14:14:49 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_30000-rank-0.pt
2022-05-09 14:14:49 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_30000-shared.pt
2022-05-09 14:14:57 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_30000-shared.pt
2022-05-09 14:15:10 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_30000-rank-0.pt (epoch 2 @ 30000 updates, score 1.196) (writing took 29.809053477831185 seconds)
2022-05-09 14:15:28 - progress_bar.py[line:272] - INFO: epoch 002:  12343 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=383.6, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.507, expert1_balance_bottom=19.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=7.9, ups=0.02, wpb=383.6, bsz=32, num_updates=30010, lr=7.03311e-06, gnorm=3.744, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62796
2022-05-09 14:15:45 - progress_bar.py[line:272] - INFO: epoch 002:  12353 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893179, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.857, expert1_balance_bottom=19.622, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=217.5, ups=0.57, wpb=379.6, bsz=32, num_updates=30020, lr=7.03191e-06, gnorm=3.518, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62813
2022-05-09 14:16:03 - progress_bar.py[line:272] - INFO: epoch 002:  12363 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=379.8, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893665, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.737, expert1_balance_bottom=19.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=218.9, ups=0.58, wpb=379.8, bsz=32, num_updates=30030, lr=7.03071e-06, gnorm=3.238, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62831
2022-05-09 14:16:20 - progress_bar.py[line:272] - INFO: epoch 002:  12373 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890658, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.289, expert1_balance_bottom=19.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.5, ups=0.58, wpb=378.6, bsz=32, num_updates=30040, lr=7.0295e-06, gnorm=4.302, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62848
2022-05-09 14:16:37 - progress_bar.py[line:272] - INFO: epoch 002:  12383 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=384.8, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881571, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.601, expert1_balance_bottom=19.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=220.9, ups=0.57, wpb=384.8, bsz=32, num_updates=30050, lr=7.0283e-06, gnorm=3.2, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62865
2022-05-09 14:16:55 - progress_bar.py[line:272] - INFO: epoch 002:  12393 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=388.2, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.754, expert1_balance_bottom=19.26, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.3, ups=0.58, wpb=388.2, bsz=32, num_updates=30060, lr=7.0271e-06, gnorm=4.368, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62883
2022-05-09 14:17:12 - progress_bar.py[line:272] - INFO: epoch 002:  12403 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=382.5, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888478, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.093, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.6, ups=0.59, wpb=382.5, bsz=32, num_updates=30070, lr=7.0259e-06, gnorm=3.622, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62900
2022-05-09 14:17:29 - progress_bar.py[line:272] - INFO: epoch 002:  12413 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=387.6, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=35.098, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=226.3, ups=0.58, wpb=387.6, bsz=32, num_updates=30080, lr=7.0247e-06, gnorm=3.709, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62917
2022-05-09 14:17:46 - progress_bar.py[line:272] - INFO: epoch 002:  12423 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.478, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223, ups=0.59, wpb=381.1, bsz=32, num_updates=30090, lr=7.0235e-06, gnorm=4.281, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62934
2022-05-09 14:18:03 - progress_bar.py[line:272] - INFO: epoch 002:  12433 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=380.7, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886033, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.12, expert1_balance_bottom=19.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.3, ups=0.58, wpb=380.7, bsz=32, num_updates=30100, lr=7.0223e-06, gnorm=3.527, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62951
2022-05-09 14:18:20 - progress_bar.py[line:272] - INFO: epoch 002:  12443 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=372.5, nsentences=32, sample_size=296.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895369, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.893, expert1_balance_bottom=19.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.4, ups=0.59, wpb=372.5, bsz=32, num_updates=30110, lr=7.0211e-06, gnorm=4.11, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62968
2022-05-09 14:18:38 - progress_bar.py[line:272] - INFO: epoch 002:  12453 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882586, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.589, expert1_balance_bottom=19.284, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221, ups=0.57, wpb=384.7, bsz=32, num_updates=30120, lr=7.01989e-06, gnorm=3.695, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=62986
2022-05-09 14:18:55 - progress_bar.py[line:272] - INFO: epoch 002:  12463 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.625, expert1_balance_bottom=19.582, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=223.9, ups=0.58, wpb=385, bsz=32, num_updates=30130, lr=7.01869e-06, gnorm=3.65, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63003
2022-05-09 14:19:12 - progress_bar.py[line:272] - INFO: epoch 002:  12473 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=391, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873075, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=35.448, expert1_balance_bottom=19.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=230.9, ups=0.59, wpb=391, bsz=32, num_updates=30140, lr=7.01749e-06, gnorm=3.845, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63020
2022-05-09 14:19:29 - progress_bar.py[line:272] - INFO: epoch 002:  12483 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=379.4, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.767, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221.4, ups=0.58, wpb=379.4, bsz=32, num_updates=30150, lr=7.01629e-06, gnorm=3.897, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63037
2022-05-09 14:19:46 - progress_bar.py[line:272] - INFO: epoch 002:  12493 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=35.163, expert1_balance_bottom=19.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=220.2, ups=0.57, wpb=384.2, bsz=32, num_updates=30160, lr=7.01509e-06, gnorm=4.412, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63054
2022-05-09 14:20:04 - progress_bar.py[line:272] - INFO: epoch 002:  12503 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=381.3, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888742, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=34.176, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=217.1, ups=0.57, wpb=381.3, bsz=32, num_updates=30170, lr=7.01389e-06, gnorm=3.395, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63072
2022-05-09 14:20:21 - progress_bar.py[line:272] - INFO: epoch 002:  12513 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=370.5, nsentences=32, sample_size=294.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.781, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=213.9, ups=0.58, wpb=370.5, bsz=32, num_updates=30180, lr=7.01269e-06, gnorm=3.841, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63089
2022-05-09 14:20:38 - progress_bar.py[line:272] - INFO: epoch 002:  12523 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.54, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=226.6, ups=0.59, wpb=384.1, bsz=32, num_updates=30190, lr=7.01148e-06, gnorm=4.003, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63106
2022-05-09 14:20:56 - progress_bar.py[line:272] - INFO: epoch 002:  12533 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=390.8, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.745, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223.8, ups=0.57, wpb=390.8, bsz=32, num_updates=30200, lr=7.01028e-06, gnorm=3.759, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63124
2022-05-09 14:21:13 - progress_bar.py[line:272] - INFO: epoch 002:  12543 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.849, expert1_balance_bottom=19.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.5, ups=0.59, wpb=385, bsz=32, num_updates=30210, lr=7.00908e-06, gnorm=3.699, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63141
2022-05-09 14:21:30 - progress_bar.py[line:272] - INFO: epoch 002:  12553 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=395.6, nsentences=32, sample_size=314.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881571, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.034, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=226.7, ups=0.57, wpb=395.6, bsz=32, num_updates=30220, lr=7.00788e-06, gnorm=4.075, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63158
2022-05-09 14:21:47 - progress_bar.py[line:272] - INFO: epoch 002:  12563 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.405, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.9, ups=0.58, wpb=386.8, bsz=32, num_updates=30230, lr=7.00668e-06, gnorm=3.485, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63175
2022-05-09 14:22:05 - progress_bar.py[line:272] - INFO: epoch 002:  12573 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=390.8, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.74, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=227, ups=0.58, wpb=390.8, bsz=32, num_updates=30240, lr=7.00548e-06, gnorm=3.391, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63193
2022-05-09 14:22:22 - progress_bar.py[line:272] - INFO: epoch 002:  12583 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=378.1, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888483, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.051, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.9, ups=0.57, wpb=378.1, bsz=32, num_updates=30250, lr=7.00428e-06, gnorm=3.76, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63210
2022-05-09 14:22:39 - progress_bar.py[line:272] - INFO: epoch 002:  12593 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.541, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.8, ups=0.58, wpb=383, bsz=32, num_updates=30260, lr=7.00308e-06, gnorm=3.551, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63227
2022-05-09 14:22:56 - progress_bar.py[line:272] - INFO: epoch 002:  12603 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89015, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.21, expert1_balance_bottom=19.397, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.5, ups=0.59, wpb=383.7, bsz=32, num_updates=30270, lr=7.00187e-06, gnorm=3.554, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63244
2022-05-09 14:23:14 - progress_bar.py[line:272] - INFO: epoch 002:  12613 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894268, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.923, expert1_balance_bottom=19.534, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=220.2, ups=0.58, wpb=380.1, bsz=32, num_updates=30280, lr=7.00067e-06, gnorm=3.66, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63262
2022-05-09 14:23:31 - progress_bar.py[line:272] - INFO: epoch 002:  12623 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883761, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.648, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221, ups=0.58, wpb=382.5, bsz=32, num_updates=30290, lr=6.99947e-06, gnorm=3.455, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63279
2022-05-09 14:23:48 - progress_bar.py[line:272] - INFO: epoch 002:  12633 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888507, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.167, expert1_balance_bottom=19.542, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220, ups=0.58, wpb=377.5, bsz=32, num_updates=30300, lr=6.99827e-06, gnorm=3.85, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63296
2022-05-09 14:24:05 - progress_bar.py[line:272] - INFO: epoch 002:  12643 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=387.9, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864143, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=35.691, expert1_balance_bottom=18.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=224.9, ups=0.58, wpb=387.9, bsz=32, num_updates=30310, lr=6.99707e-06, gnorm=3.863, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63313
2022-05-09 14:24:23 - progress_bar.py[line:272] - INFO: epoch 002:  12653 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=369.5, nsentences=32, sample_size=294.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.103, expert1_balance_bottom=19.616, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=215.1, ups=0.58, wpb=369.5, bsz=32, num_updates=30320, lr=6.99587e-06, gnorm=3.668, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63331
2022-05-09 14:24:40 - progress_bar.py[line:272] - INFO: epoch 002:  12663 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=374.7, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881461, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.757, expert1_balance_bottom=19.253, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.1, ups=0.58, wpb=374.7, bsz=32, num_updates=30330, lr=6.99467e-06, gnorm=3.572, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63348
2022-05-09 14:24:57 - progress_bar.py[line:272] - INFO: epoch 002:  12673 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.915, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=224.5, ups=0.58, wpb=386.8, bsz=32, num_updates=30340, lr=6.99346e-06, gnorm=3.51, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63365
2022-05-09 14:25:14 - progress_bar.py[line:272] - INFO: epoch 002:  12683 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=379, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=33.78, expert1_balance_bottom=19.537, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220.6, ups=0.58, wpb=379, bsz=32, num_updates=30350, lr=6.99226e-06, gnorm=3.574, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63382
2022-05-09 14:25:32 - progress_bar.py[line:272] - INFO: epoch 002:  12693 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=374.5, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892645, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.187, expert1_balance_bottom=19.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=215, ups=0.57, wpb=374.5, bsz=32, num_updates=30360, lr=6.99106e-06, gnorm=3.2, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63400
2022-05-09 14:25:49 - progress_bar.py[line:272] - INFO: epoch 002:  12703 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883557, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.646, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220.2, ups=0.58, wpb=378.1, bsz=32, num_updates=30370, lr=6.98986e-06, gnorm=4.389, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63417
2022-05-09 14:26:06 - progress_bar.py[line:272] - INFO: epoch 002:  12713 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=377.5, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893315, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.009, expert1_balance_bottom=19.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.6, ups=0.58, wpb=377.5, bsz=32, num_updates=30380, lr=6.98866e-06, gnorm=3.713, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63434
2022-05-09 14:26:23 - progress_bar.py[line:272] - INFO: epoch 002:  12723 / 17711 loss=3.124, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899882, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.124, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=33.487, expert1_balance_bottom=19.57, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=221.7, ups=0.58, wpb=381.8, bsz=32, num_updates=30390, lr=6.98746e-06, gnorm=4.442, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63451
2022-05-09 14:26:40 - progress_bar.py[line:272] - INFO: epoch 002:  12733 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=391.1, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86578, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=35.731, expert1_balance_bottom=18.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=230.3, ups=0.59, wpb=391.1, bsz=32, num_updates=30400, lr=6.98626e-06, gnorm=4.051, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63468
2022-05-09 14:26:57 - progress_bar.py[line:272] - INFO: epoch 002:  12743 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=387.7, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879402, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.72, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=225.8, ups=0.58, wpb=387.7, bsz=32, num_updates=30410, lr=6.98506e-06, gnorm=3.725, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63485
2022-05-09 14:27:14 - progress_bar.py[line:272] - INFO: epoch 002:  12753 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=376.3, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894791, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.382, expert1_balance_bottom=19.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=218.4, ups=0.58, wpb=376.3, bsz=32, num_updates=30420, lr=6.98385e-06, gnorm=3.515, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63503
2022-05-09 14:27:32 - progress_bar.py[line:272] - INFO: epoch 002:  12763 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=35.452, expert1_balance_bottom=19.019, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.7, ups=0.57, wpb=385.7, bsz=32, num_updates=30430, lr=6.98265e-06, gnorm=3.727, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63520
2022-05-09 14:27:49 - progress_bar.py[line:272] - INFO: epoch 002:  12773 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=387.2, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.501, expert1_balance_bottom=19.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.9, ups=0.58, wpb=387.2, bsz=32, num_updates=30440, lr=6.98145e-06, gnorm=3.655, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63537
2022-05-09 14:28:06 - progress_bar.py[line:272] - INFO: epoch 002:  12783 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=392.6, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872385, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=35.097, expert1_balance_bottom=19.145, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=233.3, ups=0.59, wpb=392.6, bsz=32, num_updates=30450, lr=6.98025e-06, gnorm=3.966, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63554
2022-05-09 14:28:23 - progress_bar.py[line:272] - INFO: epoch 002:  12793 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=379.6, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.369, expert1_balance_bottom=19.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=219, ups=0.58, wpb=379.6, bsz=32, num_updates=30460, lr=6.97905e-06, gnorm=3.878, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63571
2022-05-09 14:28:41 - progress_bar.py[line:272] - INFO: epoch 002:  12803 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=379.4, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883238, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.547, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.6, ups=0.58, wpb=379.4, bsz=32, num_updates=30470, lr=6.97785e-06, gnorm=3.458, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63589
2022-05-09 14:28:58 - progress_bar.py[line:272] - INFO: epoch 002:  12813 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=388.9, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880433, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.846, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=228.2, ups=0.59, wpb=388.9, bsz=32, num_updates=30480, lr=6.97665e-06, gnorm=3.7, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63606
2022-05-09 14:29:15 - progress_bar.py[line:272] - INFO: epoch 002:  12823 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=387.9, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887583, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.568, expert1_balance_bottom=19.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.7, ups=0.58, wpb=387.9, bsz=32, num_updates=30490, lr=6.97545e-06, gnorm=4.042, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63623
2022-05-09 14:29:32 - progress_bar.py[line:272] - INFO: epoch 002:  12833 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888962, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.579, expert1_balance_bottom=19.34, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223.9, ups=0.58, wpb=386.1, bsz=32, num_updates=30500, lr=6.97424e-06, gnorm=3.889, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63640
2022-05-09 14:29:49 - progress_bar.py[line:272] - INFO: epoch 002:  12843 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.966, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=227.6, ups=0.59, wpb=382.5, bsz=32, num_updates=30510, lr=6.97304e-06, gnorm=3.796, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63657
2022-05-09 14:30:06 - progress_bar.py[line:272] - INFO: epoch 002:  12853 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.952, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=220.5, ups=0.57, wpb=385.3, bsz=32, num_updates=30520, lr=6.97184e-06, gnorm=3.814, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63674
2022-05-09 14:30:24 - progress_bar.py[line:272] - INFO: epoch 002:  12863 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.128, expert1_balance_top=33.503, expert1_balance_bottom=19.635, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.6, ups=0.58, wpb=379.2, bsz=32, num_updates=30530, lr=6.97064e-06, gnorm=4.013, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63692
2022-05-09 14:30:41 - progress_bar.py[line:272] - INFO: epoch 002:  12873 / 17711 loss=3.071, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=391.8, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.071, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.551, expert1_balance_bottom=19.23, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=226.4, ups=0.58, wpb=391.8, bsz=32, num_updates=30540, lr=6.96944e-06, gnorm=3.595, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63709
2022-05-09 14:30:58 - progress_bar.py[line:272] - INFO: epoch 002:  12883 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=386.7, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.695, expert1_balance_bottom=19.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223, ups=0.58, wpb=386.7, bsz=32, num_updates=30550, lr=6.96824e-06, gnorm=4.299, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63726
2022-05-09 14:31:15 - progress_bar.py[line:272] - INFO: epoch 002:  12893 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.679, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.5, ups=0.58, wpb=382.5, bsz=32, num_updates=30560, lr=6.96704e-06, gnorm=4.31, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63744
2022-05-09 14:31:33 - progress_bar.py[line:272] - INFO: epoch 002:  12903 / 17711 loss=3.075, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=380.1, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886649, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.075, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.859, expert1_balance_bottom=19.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=223.1, ups=0.59, wpb=380.1, bsz=32, num_updates=30570, lr=6.96583e-06, gnorm=3.605, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63761
2022-05-09 14:31:50 - progress_bar.py[line:272] - INFO: epoch 002:  12913 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.268, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=222.8, ups=0.59, wpb=378.6, bsz=32, num_updates=30580, lr=6.96463e-06, gnorm=4.027, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63778
2022-05-09 14:32:07 - progress_bar.py[line:272] - INFO: epoch 002:  12923 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=391.2, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.994, expert1_balance_bottom=19.189, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=229.3, ups=0.59, wpb=391.2, bsz=32, num_updates=30590, lr=6.96343e-06, gnorm=3.637, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63795
2022-05-09 14:32:24 - progress_bar.py[line:272] - INFO: epoch 002:  12933 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=374.5, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.953, expert1_balance_bottom=19.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.2, ups=0.58, wpb=374.5, bsz=32, num_updates=30600, lr=6.96223e-06, gnorm=3.492, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63812
2022-05-09 14:32:41 - progress_bar.py[line:272] - INFO: epoch 002:  12943 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=383.7, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.242, expert1_balance_bottom=19.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217, ups=0.57, wpb=383.7, bsz=32, num_updates=30610, lr=6.96103e-06, gnorm=3.442, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63829
2022-05-09 14:32:59 - progress_bar.py[line:272] - INFO: epoch 002:  12953 / 17711 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.185, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.871, expert1_balance_bottom=19.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.97, wps=216.6, ups=0.57, wpb=380.6, bsz=32, num_updates=30620, lr=6.95983e-06, gnorm=4.017, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63847
2022-05-09 14:33:16 - progress_bar.py[line:272] - INFO: epoch 002:  12963 / 17711 loss=3.093, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=391.8, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879663, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.093, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.662, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=228.5, ups=0.58, wpb=391.8, bsz=32, num_updates=30630, lr=6.95863e-06, gnorm=3.213, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63864
2022-05-09 14:33:33 - progress_bar.py[line:272] - INFO: epoch 002:  12973 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=388.4, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870998, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=35.414, expert1_balance_bottom=19.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=227, ups=0.58, wpb=388.4, bsz=32, num_updates=30640, lr=6.95743e-06, gnorm=3.974, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63881
2022-05-09 14:33:51 - progress_bar.py[line:272] - INFO: epoch 002:  12983 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=384.6, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.266, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.3, ups=0.58, wpb=384.6, bsz=32, num_updates=30650, lr=6.95622e-06, gnorm=3.839, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63899
2022-05-09 14:34:08 - progress_bar.py[line:272] - INFO: epoch 002:  12993 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879749, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.777, expert1_balance_bottom=19.464, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=217.4, ups=0.57, wpb=381.4, bsz=32, num_updates=30660, lr=6.95502e-06, gnorm=4.049, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63916
2022-05-09 14:34:26 - progress_bar.py[line:272] - INFO: epoch 002:  13003 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=390.4, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.581, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=223.3, ups=0.57, wpb=390.4, bsz=32, num_updates=30670, lr=6.95382e-06, gnorm=3.428, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63934
2022-05-09 14:34:44 - progress_bar.py[line:272] - INFO: epoch 002:  13013 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=387.9, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=35.178, expert1_balance_bottom=19.159, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.9, ups=0.56, wpb=387.9, bsz=32, num_updates=30680, lr=6.95262e-06, gnorm=4.588, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63952
2022-05-09 14:35:01 - progress_bar.py[line:272] - INFO: epoch 002:  13023 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888988, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.358, expert1_balance_bottom=19.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217, ups=0.57, wpb=378.7, bsz=32, num_updates=30690, lr=6.95142e-06, gnorm=3.703, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63969
2022-05-09 14:35:19 - progress_bar.py[line:272] - INFO: epoch 002:  13033 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=33.784, expert1_balance_bottom=19.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=217, ups=0.57, wpb=380.5, bsz=32, num_updates=30700, lr=6.95022e-06, gnorm=4.17, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=63987
2022-05-09 14:35:36 - progress_bar.py[line:272] - INFO: epoch 002:  13043 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=381.5, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877491, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=35.131, expert1_balance_bottom=19.112, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=220.3, ups=0.58, wpb=381.5, bsz=32, num_updates=30710, lr=6.94902e-06, gnorm=3.347, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64004
2022-05-09 14:35:53 - progress_bar.py[line:272] - INFO: epoch 002:  13053 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901863, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.662, expert1_balance_bottom=19.461, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=221.8, ups=0.58, wpb=385, bsz=32, num_updates=30720, lr=6.94781e-06, gnorm=3.358, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64021
2022-05-09 14:36:05 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 14:36:12 - progress_bar.py[line:272] - INFO: epoch 002:  13064 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876604, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=35.111, expert1_balance_bottom=19.063, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=201.1, ups=0.52, wpb=383.1, bsz=32, num_updates=30730, lr=6.94661e-06, gnorm=3.763, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64040
2022-05-09 14:36:29 - progress_bar.py[line:272] - INFO: epoch 002:  13074 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=381.7, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.162, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.6, ups=0.59, wpb=381.7, bsz=32, num_updates=30740, lr=6.94541e-06, gnorm=3.624, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64057
2022-05-09 14:36:47 - progress_bar.py[line:272] - INFO: epoch 002:  13084 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=379.1, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89223, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=34.048, expert1_balance_bottom=19.333, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.1, ups=0.57, wpb=379.1, bsz=32, num_updates=30750, lr=6.94421e-06, gnorm=4.304, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64075
2022-05-09 14:37:05 - progress_bar.py[line:272] - INFO: epoch 002:  13094 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=375, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884759, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.436, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.8, ups=0.56, wpb=375, bsz=32, num_updates=30760, lr=6.94301e-06, gnorm=4.051, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64093
2022-05-09 14:37:22 - progress_bar.py[line:272] - INFO: epoch 002:  13104 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=381.8, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.046, expert1_balance_bottom=19.48, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.4, ups=0.58, wpb=381.8, bsz=32, num_updates=30770, lr=6.94181e-06, gnorm=3.515, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64110
2022-05-09 14:37:39 - progress_bar.py[line:272] - INFO: epoch 002:  13114 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.794, expert1_balance_bottom=19.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.2, ups=0.59, wpb=379.6, bsz=32, num_updates=30780, lr=6.94061e-06, gnorm=3.328, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64127
2022-05-09 14:37:56 - progress_bar.py[line:272] - INFO: epoch 002:  13124 / 17711 loss=3.098, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=387.5, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.098, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.405, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=228.1, ups=0.59, wpb=387.5, bsz=32, num_updates=30790, lr=6.93941e-06, gnorm=3.884, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64144
2022-05-09 14:38:13 - progress_bar.py[line:272] - INFO: epoch 002:  13134 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=384.4, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890841, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.927, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223.8, ups=0.58, wpb=384.4, bsz=32, num_updates=30800, lr=6.9382e-06, gnorm=3.69, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64161
2022-05-09 14:38:30 - progress_bar.py[line:272] - INFO: epoch 002:  13144 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=386.7, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.793, expert1_balance_bottom=19.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.2, ups=0.58, wpb=386.7, bsz=32, num_updates=30810, lr=6.937e-06, gnorm=3.283, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64178
2022-05-09 14:38:48 - progress_bar.py[line:272] - INFO: epoch 002:  13154 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=382.8, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886678, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.416, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.8, ups=0.58, wpb=382.8, bsz=32, num_updates=30820, lr=6.9358e-06, gnorm=3.329, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64196
2022-05-09 14:39:05 - progress_bar.py[line:272] - INFO: epoch 002:  13164 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883529, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.274, expert1_balance_bottom=19.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221.4, ups=0.58, wpb=382.2, bsz=32, num_updates=30830, lr=6.9346e-06, gnorm=3.347, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64213
2022-05-09 14:39:22 - progress_bar.py[line:272] - INFO: epoch 002:  13174 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=400.6, nsentences=32, sample_size=318.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890819, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.968, expert1_balance_bottom=19.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=233.6, ups=0.58, wpb=400.6, bsz=32, num_updates=30840, lr=6.9334e-06, gnorm=3.45, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64230
2022-05-09 14:39:39 - progress_bar.py[line:272] - INFO: epoch 002:  13184 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.125, expert1_balance_top=33.993, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220.8, ups=0.58, wpb=381.1, bsz=32, num_updates=30850, lr=6.9322e-06, gnorm=3.616, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64247
2022-05-09 14:39:57 - progress_bar.py[line:272] - INFO: epoch 002:  13194 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=379.5, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.54, expert1_balance_bottom=19.497, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.7, ups=0.58, wpb=379.5, bsz=32, num_updates=30860, lr=6.931e-06, gnorm=3.668, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64265
2022-05-09 14:40:14 - progress_bar.py[line:272] - INFO: epoch 002:  13204 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87878, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.839, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.1, ups=0.58, wpb=381, bsz=32, num_updates=30870, lr=6.9298e-06, gnorm=3.198, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64282
2022-05-09 14:40:31 - progress_bar.py[line:272] - INFO: epoch 002:  13214 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=379.6, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879658, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.791, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219.4, ups=0.58, wpb=379.6, bsz=32, num_updates=30880, lr=6.92859e-06, gnorm=3.21, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64299
2022-05-09 14:40:48 - progress_bar.py[line:272] - INFO: epoch 002:  13224 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867569, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=35.409, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=217.2, ups=0.58, wpb=377.5, bsz=32, num_updates=30890, lr=6.92739e-06, gnorm=3.98, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64316
2022-05-09 14:41:06 - progress_bar.py[line:272] - INFO: epoch 002:  13234 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.816, expert1_balance_bottom=19.193, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.1, ups=0.58, wpb=383.2, bsz=32, num_updates=30900, lr=6.92619e-06, gnorm=3.491, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64334
2022-05-09 14:41:23 - progress_bar.py[line:272] - INFO: epoch 002:  13244 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883387, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.819, expert1_balance_bottom=19.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=224.9, ups=0.58, wpb=385.7, bsz=32, num_updates=30910, lr=6.92499e-06, gnorm=3.428, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64351
2022-05-09 14:41:40 - progress_bar.py[line:272] - INFO: epoch 002:  13254 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=378.3, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888034, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.296, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.8, ups=0.57, wpb=378.3, bsz=32, num_updates=30920, lr=6.92379e-06, gnorm=3.789, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64368
2022-05-09 14:41:58 - progress_bar.py[line:272] - INFO: epoch 002:  13264 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=378.1, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894986, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=33.327, expert1_balance_bottom=19.654, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=217.3, ups=0.57, wpb=378.1, bsz=32, num_updates=30930, lr=6.92259e-06, gnorm=3.167, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64386
2022-05-09 14:42:15 - progress_bar.py[line:272] - INFO: epoch 002:  13274 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=373.2, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898797, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.463, expert1_balance_bottom=19.721, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.3, ups=0.57, wpb=373.2, bsz=32, num_updates=30940, lr=6.92139e-06, gnorm=4.18, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64403
2022-05-09 14:42:32 - progress_bar.py[line:272] - INFO: epoch 002:  13284 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=384.6, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.284, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221.7, ups=0.58, wpb=384.6, bsz=32, num_updates=30950, lr=6.92018e-06, gnorm=3.171, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64420
2022-05-09 14:42:50 - progress_bar.py[line:272] - INFO: epoch 002:  13294 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886454, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.569, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=222.5, ups=0.58, wpb=380.5, bsz=32, num_updates=30960, lr=6.91898e-06, gnorm=4.307, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64438
2022-05-09 14:43:07 - progress_bar.py[line:272] - INFO: epoch 002:  13304 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=389.8, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=35.251, expert1_balance_bottom=19.126, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=226.7, ups=0.58, wpb=389.8, bsz=32, num_updates=30970, lr=6.91778e-06, gnorm=3.549, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64455
2022-05-09 14:43:24 - progress_bar.py[line:272] - INFO: epoch 002:  13314 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883114, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.223, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.7, ups=0.58, wpb=383.6, bsz=32, num_updates=30980, lr=6.91658e-06, gnorm=3.358, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64472
2022-05-09 14:43:41 - progress_bar.py[line:272] - INFO: epoch 002:  13324 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=373.1, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902946, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.731, expert1_balance_bottom=19.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=216.7, ups=0.58, wpb=373.1, bsz=32, num_updates=30990, lr=6.91538e-06, gnorm=4.1, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64489
2022-05-09 14:43:58 - progress_bar.py[line:272] - INFO: epoch 002:  13334 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=383.6, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888577, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.862, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=227.4, ups=0.59, wpb=383.6, bsz=32, num_updates=31000, lr=6.91418e-06, gnorm=3.933, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64506
2022-05-09 14:44:15 - progress_bar.py[line:272] - INFO: epoch 002:  13344 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=388.4, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896286, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=33.321, expert1_balance_bottom=19.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=231.2, ups=0.6, wpb=388.4, bsz=32, num_updates=31010, lr=6.91298e-06, gnorm=3.406, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64523
2022-05-09 14:44:32 - progress_bar.py[line:272] - INFO: epoch 002:  13354 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=388, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883442, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.615, expert1_balance_bottom=19.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=225.2, ups=0.58, wpb=388, bsz=32, num_updates=31020, lr=6.91178e-06, gnorm=3.937, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64540
2022-05-09 14:44:49 - progress_bar.py[line:272] - INFO: epoch 002:  13364 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=387.3, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.23, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=227.4, ups=0.59, wpb=387.3, bsz=32, num_updates=31030, lr=6.91057e-06, gnorm=3.659, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64557
2022-05-09 14:45:06 - progress_bar.py[line:272] - INFO: epoch 002:  13374 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88706, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.458, expert1_balance_bottom=19.338, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=223.5, ups=0.58, wpb=384.7, bsz=32, num_updates=31040, lr=6.90937e-06, gnorm=3.516, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64574
2022-05-09 14:45:24 - progress_bar.py[line:272] - INFO: epoch 002:  13384 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884586, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.652, expert1_balance_bottom=19.291, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.4, ups=0.58, wpb=380.9, bsz=32, num_updates=31050, lr=6.90817e-06, gnorm=3.795, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64592
2022-05-09 14:45:41 - progress_bar.py[line:272] - INFO: epoch 002:  13394 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881138, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.388, expert1_balance_bottom=19.42, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.4, ups=0.59, wpb=378, bsz=32, num_updates=31060, lr=6.90697e-06, gnorm=3.928, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64609
2022-05-09 14:45:58 - progress_bar.py[line:272] - INFO: epoch 002:  13404 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.148, expert1_balance_bottom=19.464, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.6, ups=0.58, wpb=379.6, bsz=32, num_updates=31070, lr=6.90577e-06, gnorm=3.664, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64626
2022-05-09 14:46:15 - progress_bar.py[line:272] - INFO: epoch 002:  13414 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=388.6, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889008, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.883, expert1_balance_bottom=19.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.1, ups=0.58, wpb=388.6, bsz=32, num_updates=31080, lr=6.90457e-06, gnorm=3.375, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64643
2022-05-09 14:46:33 - progress_bar.py[line:272] - INFO: epoch 002:  13424 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=381.7, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.464, expert1_balance_bottom=19.329, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.3, ups=0.56, wpb=381.7, bsz=32, num_updates=31090, lr=6.90337e-06, gnorm=4.039, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64661
2022-05-09 14:46:50 - progress_bar.py[line:272] - INFO: epoch 002:  13434 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=388.9, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.206, expert1_balance_bottom=19.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223.5, ups=0.57, wpb=388.9, bsz=32, num_updates=31100, lr=6.90216e-06, gnorm=3.949, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64678
2022-05-09 14:47:08 - progress_bar.py[line:272] - INFO: epoch 002:  13444 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=376, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.644, expert1_balance_bottom=19.747, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.6, ups=0.58, wpb=376, bsz=32, num_updates=31110, lr=6.90096e-06, gnorm=3.429, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64696
2022-05-09 14:47:25 - progress_bar.py[line:272] - INFO: epoch 002:  13454 / 17711 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891686, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.121, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.751, expert1_balance_bottom=19.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=227.2, ups=0.59, wpb=384.7, bsz=32, num_updates=31120, lr=6.89976e-06, gnorm=4.348, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64713
2022-05-09 14:47:42 - progress_bar.py[line:272] - INFO: epoch 002:  13464 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891302, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.708, expert1_balance_bottom=19.735, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223.4, ups=0.59, wpb=380.4, bsz=32, num_updates=31130, lr=6.89856e-06, gnorm=3.376, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64730
2022-05-09 14:47:59 - progress_bar.py[line:272] - INFO: epoch 002:  13474 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=385.2, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.047, expert1_balance_bottom=19.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=225.9, ups=0.59, wpb=385.2, bsz=32, num_updates=31140, lr=6.89736e-06, gnorm=3.742, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64747
2022-05-09 14:48:16 - progress_bar.py[line:272] - INFO: epoch 002:  13484 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=387.3, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.276, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=221.4, ups=0.57, wpb=387.3, bsz=32, num_updates=31150, lr=6.89616e-06, gnorm=4.143, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64764
2022-05-09 14:48:34 - progress_bar.py[line:272] - INFO: epoch 002:  13494 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88843, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=33.927, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=218.2, ups=0.57, wpb=381.1, bsz=32, num_updates=31160, lr=6.89496e-06, gnorm=3.34, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64782
2022-05-09 14:48:51 - progress_bar.py[line:272] - INFO: epoch 002:  13504 / 17711 loss=3.07, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.07, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=33.594, expert1_balance_bottom=19.597, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215.6, ups=0.56, wpb=383.4, bsz=32, num_updates=31170, lr=6.89376e-06, gnorm=3.675, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64799
2022-05-09 14:49:09 - progress_bar.py[line:272] - INFO: epoch 002:  13514 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=377.7, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.249, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.3, ups=0.56, wpb=377.7, bsz=32, num_updates=31180, lr=6.89255e-06, gnorm=3.234, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64817
2022-05-09 14:49:27 - progress_bar.py[line:272] - INFO: epoch 002:  13524 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877988, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.695, expert1_balance_bottom=19.455, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.2, ups=0.56, wpb=381.6, bsz=32, num_updates=31190, lr=6.89135e-06, gnorm=2.827, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64835
2022-05-09 14:49:45 - progress_bar.py[line:272] - INFO: epoch 002:  13534 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=388.4, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876186, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=35.431, expert1_balance_bottom=19.228, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.5, ups=0.57, wpb=388.4, bsz=32, num_updates=31200, lr=6.89015e-06, gnorm=3.197, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64853
2022-05-09 14:50:02 - progress_bar.py[line:272] - INFO: epoch 002:  13544 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886243, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.421, expert1_balance_bottom=19.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.7, ups=0.58, wpb=383.4, bsz=32, num_updates=31210, lr=6.88895e-06, gnorm=3.408, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64870
2022-05-09 14:50:19 - progress_bar.py[line:272] - INFO: epoch 002:  13554 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=386.6, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889173, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.162, expert1_balance_bottom=19.409, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=225.5, ups=0.58, wpb=386.6, bsz=32, num_updates=31220, lr=6.88775e-06, gnorm=3.18, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64887
2022-05-09 14:50:36 - progress_bar.py[line:272] - INFO: epoch 002:  13564 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895909, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.157, expert1_balance_bottom=19.493, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.1, ups=0.58, wpb=382.3, bsz=32, num_updates=31230, lr=6.88655e-06, gnorm=4.058, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64904
2022-05-09 14:50:53 - progress_bar.py[line:272] - INFO: epoch 002:  13574 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=389.9, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.763, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.9, ups=0.58, wpb=389.9, bsz=32, num_updates=31240, lr=6.88535e-06, gnorm=3.47, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64922
2022-05-09 14:51:11 - progress_bar.py[line:272] - INFO: epoch 002:  13584 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=384.1, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884156, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.972, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.4, ups=0.57, wpb=384.1, bsz=32, num_updates=31250, lr=6.88415e-06, gnorm=3.418, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64939
2022-05-09 14:51:29 - progress_bar.py[line:272] - INFO: epoch 002:  13594 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=377.6, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.162, expert1_balance_bottom=19.497, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.9, ups=0.57, wpb=377.6, bsz=32, num_updates=31260, lr=6.88294e-06, gnorm=3.394, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64957
2022-05-09 14:51:46 - progress_bar.py[line:272] - INFO: epoch 002:  13604 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=382.1, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887151, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.998, expert1_balance_bottom=19.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.9, ups=0.57, wpb=382.1, bsz=32, num_updates=31270, lr=6.88174e-06, gnorm=3.354, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64974
2022-05-09 14:52:03 - progress_bar.py[line:272] - INFO: epoch 002:  13614 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=389.2, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.966, expert1_balance_bottom=19.224, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=229.1, ups=0.59, wpb=389.2, bsz=32, num_updates=31280, lr=6.88054e-06, gnorm=3.886, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=64991
2022-05-09 14:52:20 - progress_bar.py[line:272] - INFO: epoch 002:  13624 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=388.8, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.485, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=228.3, ups=0.59, wpb=388.8, bsz=32, num_updates=31290, lr=6.87934e-06, gnorm=3.493, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65008
2022-05-09 14:52:37 - progress_bar.py[line:272] - INFO: epoch 002:  13634 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=391.2, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880965, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=35.033, expert1_balance_bottom=19.191, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=229.2, ups=0.59, wpb=391.2, bsz=32, num_updates=31300, lr=6.87814e-06, gnorm=3.648, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65025
2022-05-09 14:52:54 - progress_bar.py[line:272] - INFO: epoch 002:  13644 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=35.365, expert1_balance_bottom=19.035, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=225.7, ups=0.58, wpb=386.4, bsz=32, num_updates=31310, lr=6.87694e-06, gnorm=3.82, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65042
2022-05-09 14:53:12 - progress_bar.py[line:272] - INFO: epoch 002:  13654 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=387.7, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871431, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=35.488, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=222.6, ups=0.57, wpb=387.7, bsz=32, num_updates=31320, lr=6.87574e-06, gnorm=4.208, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65060
2022-05-09 14:53:29 - progress_bar.py[line:272] - INFO: epoch 002:  13664 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887866, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.257, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.6, ups=0.58, wpb=383, bsz=32, num_updates=31330, lr=6.87453e-06, gnorm=4.076, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65077
2022-05-09 14:53:46 - progress_bar.py[line:272] - INFO: epoch 002:  13674 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=389.8, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.322, expert1_balance_bottom=19.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=226.7, ups=0.58, wpb=389.8, bsz=32, num_updates=31340, lr=6.87333e-06, gnorm=3.414, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65094
2022-05-09 14:54:04 - progress_bar.py[line:272] - INFO: epoch 002:  13684 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=387.5, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=35.273, expert1_balance_bottom=19.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.8, ups=0.57, wpb=387.5, bsz=32, num_updates=31350, lr=6.87213e-06, gnorm=3.832, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65112
2022-05-09 14:54:22 - progress_bar.py[line:272] - INFO: epoch 002:  13694 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=384.6, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=35.088, expert1_balance_bottom=19.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220, ups=0.57, wpb=384.6, bsz=32, num_updates=31360, lr=6.87093e-06, gnorm=3.479, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65130
2022-05-09 14:54:39 - progress_bar.py[line:272] - INFO: epoch 002:  13704 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.488, expert1_balance_bottom=19.23, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217.3, ups=0.58, wpb=377.2, bsz=32, num_updates=31370, lr=6.86973e-06, gnorm=3.352, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65147
2022-05-09 14:54:56 - progress_bar.py[line:272] - INFO: epoch 002:  13714 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=383.8, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891143, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.027, expert1_balance_bottom=19.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.2, ups=0.58, wpb=383.8, bsz=32, num_updates=31380, lr=6.86853e-06, gnorm=3.383, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65164
2022-05-09 14:55:13 - progress_bar.py[line:272] - INFO: epoch 002:  13724 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.435, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.5, ups=0.58, wpb=380.8, bsz=32, num_updates=31390, lr=6.86733e-06, gnorm=3.765, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65181
2022-05-09 14:55:31 - progress_bar.py[line:272] - INFO: epoch 002:  13734 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=382.8, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888871, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.804, expert1_balance_bottom=19.641, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221.4, ups=0.58, wpb=382.8, bsz=32, num_updates=31400, lr=6.86613e-06, gnorm=3.895, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65199
2022-05-09 14:55:48 - progress_bar.py[line:272] - INFO: epoch 002:  13744 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87702, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.996, expert1_balance_bottom=19.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223.8, ups=0.58, wpb=384.7, bsz=32, num_updates=31410, lr=6.86492e-06, gnorm=4.209, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65216
2022-05-09 14:56:05 - progress_bar.py[line:272] - INFO: epoch 002:  13754 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=380.2, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.862, expert1_balance_bottom=19.059, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=224.3, ups=0.59, wpb=380.2, bsz=32, num_updates=31420, lr=6.86372e-06, gnorm=3.697, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65233
2022-05-09 14:56:22 - progress_bar.py[line:272] - INFO: epoch 002:  13764 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=386.1, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.017, expert1_balance_bottom=19.472, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.2, ups=0.58, wpb=386.1, bsz=32, num_updates=31430, lr=6.86252e-06, gnorm=3.5, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65250
2022-05-09 14:56:39 - progress_bar.py[line:272] - INFO: epoch 002:  13774 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88366, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.427, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=222.9, ups=0.58, wpb=381.6, bsz=32, num_updates=31440, lr=6.86132e-06, gnorm=4.014, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65267
2022-05-09 14:56:56 - progress_bar.py[line:272] - INFO: epoch 002:  13784 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=385.7, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.957, expert1_balance_bottom=19.073, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=225.6, ups=0.59, wpb=385.7, bsz=32, num_updates=31450, lr=6.86012e-06, gnorm=3.83, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65284
2022-05-09 14:57:14 - progress_bar.py[line:272] - INFO: epoch 002:  13794 / 17711 loss=3.103, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.103, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.979, expert1_balance_bottom=19.171, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=218, ups=0.57, wpb=381.2, bsz=32, num_updates=31460, lr=6.85892e-06, gnorm=4.082, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65302
2022-05-09 14:57:31 - progress_bar.py[line:272] - INFO: epoch 002:  13804 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=370.7, nsentences=32, sample_size=294.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.772, expert1_balance_bottom=19.541, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=215.8, ups=0.58, wpb=370.7, bsz=32, num_updates=31470, lr=6.85772e-06, gnorm=4.187, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65319
2022-05-09 14:57:48 - progress_bar.py[line:272] - INFO: epoch 002:  13814 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=380, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.695, expert1_balance_bottom=19.551, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.1, ups=0.58, wpb=380, bsz=32, num_updates=31480, lr=6.85651e-06, gnorm=3.684, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65336
2022-05-09 14:58:05 - progress_bar.py[line:272] - INFO: epoch 002:  13824 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=373.9, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.394, expert1_balance_bottom=19.366, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.9, ups=0.57, wpb=373.9, bsz=32, num_updates=31490, lr=6.85531e-06, gnorm=3.518, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65354
2022-05-09 14:58:23 - progress_bar.py[line:272] - INFO: epoch 002:  13834 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=388.2, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.404, expert1_balance_bottom=19.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=227.8, ups=0.59, wpb=388.2, bsz=32, num_updates=31500, lr=6.85411e-06, gnorm=3.764, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65371
2022-05-09 14:58:40 - progress_bar.py[line:272] - INFO: epoch 002:  13844 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888975, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.219, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=225.7, ups=0.58, wpb=387.2, bsz=32, num_updates=31510, lr=6.85291e-06, gnorm=4.186, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65388
2022-05-09 14:58:41 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 14:58:59 - progress_bar.py[line:272] - INFO: epoch 002:  13855 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=389.9, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.611, expert1_balance_bottom=19.191, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=207, ups=0.53, wpb=389.9, bsz=32, num_updates=31520, lr=6.85171e-06, gnorm=3.824, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65407
2022-05-09 14:59:16 - progress_bar.py[line:272] - INFO: epoch 002:  13865 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.446, expert1_balance_bottom=19.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=222.7, ups=0.58, wpb=382.4, bsz=32, num_updates=31530, lr=6.85051e-06, gnorm=3.144, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65424
2022-05-09 14:59:33 - progress_bar.py[line:272] - INFO: epoch 002:  13875 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.717, ntokens=376.5, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.549, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=219.7, ups=0.58, wpb=376.5, bsz=32, num_updates=31540, lr=6.84931e-06, gnorm=3.37, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65441
2022-05-09 14:59:50 - progress_bar.py[line:272] - INFO: epoch 002:  13885 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.64, expert1_balance_bottom=19.102, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.6, ups=0.58, wpb=383.2, bsz=32, num_updates=31550, lr=6.84811e-06, gnorm=3.756, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65458
2022-05-09 15:00:07 - progress_bar.py[line:272] - INFO: epoch 002:  13895 / 17711 loss=2.936, loss_v1=0, loss_v2=0, nll_loss=0.704, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.936, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.59, expert1_balance_bottom=19.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=227.5, ups=0.59, wpb=383.6, bsz=32, num_updates=31560, lr=6.8469e-06, gnorm=3.365, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65475
2022-05-09 15:00:24 - progress_bar.py[line:272] - INFO: epoch 002:  13905 / 17711 loss=3.069, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=383.1, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884971, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.069, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.068, expert1_balance_bottom=19.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220, ups=0.57, wpb=383.1, bsz=32, num_updates=31570, lr=6.8457e-06, gnorm=3.398, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65492
2022-05-09 15:00:41 - progress_bar.py[line:272] - INFO: epoch 002:  13915 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=374.5, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890871, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.95, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.1, ups=0.58, wpb=374.5, bsz=32, num_updates=31580, lr=6.8445e-06, gnorm=3.685, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65510
2022-05-09 15:00:59 - progress_bar.py[line:272] - INFO: epoch 002:  13925 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=381.2, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896915, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.908, expert1_balance_bottom=19.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.4, ups=0.59, wpb=381.2, bsz=32, num_updates=31590, lr=6.8433e-06, gnorm=3.482, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65527
2022-05-09 15:01:16 - progress_bar.py[line:272] - INFO: epoch 002:  13935 / 17711 loss=3.085, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=382.7, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.085, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.745, expert1_balance_bottom=19.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.5, ups=0.58, wpb=382.7, bsz=32, num_updates=31600, lr=6.8421e-06, gnorm=3.378, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65544
2022-05-09 15:01:33 - progress_bar.py[line:272] - INFO: epoch 002:  13945 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=379.9, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885459, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.299, expert1_balance_bottom=19.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.3, ups=0.59, wpb=379.9, bsz=32, num_updates=31610, lr=6.8409e-06, gnorm=3.157, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65561
2022-05-09 15:01:50 - progress_bar.py[line:272] - INFO: epoch 002:  13955 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.907, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.3, ups=0.59, wpb=381.6, bsz=32, num_updates=31620, lr=6.8397e-06, gnorm=3.864, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65578
2022-05-09 15:02:07 - progress_bar.py[line:272] - INFO: epoch 002:  13965 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=386.2, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.75, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=226.9, ups=0.59, wpb=386.2, bsz=32, num_updates=31630, lr=6.83849e-06, gnorm=3.34, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65595
2022-05-09 15:02:24 - progress_bar.py[line:272] - INFO: epoch 002:  13975 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=384.1, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89145, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.352, expert1_balance_bottom=19.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=225.5, ups=0.59, wpb=384.1, bsz=32, num_updates=31640, lr=6.83729e-06, gnorm=3.636, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65612
2022-05-09 15:02:41 - progress_bar.py[line:272] - INFO: epoch 002:  13985 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=387.1, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=35.093, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=226.4, ups=0.58, wpb=387.1, bsz=32, num_updates=31650, lr=6.83609e-06, gnorm=3.423, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65629
2022-05-09 15:02:58 - progress_bar.py[line:272] - INFO: epoch 002:  13995 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=379.9, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890272, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.296, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.2, ups=0.58, wpb=379.9, bsz=32, num_updates=31660, lr=6.83489e-06, gnorm=3.048, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65646
2022-05-09 15:03:15 - progress_bar.py[line:272] - INFO: epoch 002:  14005 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.937, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=225, ups=0.58, wpb=386.3, bsz=32, num_updates=31670, lr=6.83369e-06, gnorm=2.984, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65663
2022-05-09 15:03:32 - progress_bar.py[line:272] - INFO: epoch 002:  14015 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888197, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.241, expert1_balance_bottom=19.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.3, ups=0.58, wpb=384.4, bsz=32, num_updates=31680, lr=6.83249e-06, gnorm=3.151, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65680
2022-05-09 15:03:49 - progress_bar.py[line:272] - INFO: epoch 002:  14025 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887817, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.714, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223.9, ups=0.58, wpb=383.7, bsz=32, num_updates=31690, lr=6.83129e-06, gnorm=3.344, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65697
2022-05-09 15:04:07 - progress_bar.py[line:272] - INFO: epoch 002:  14035 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885644, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.666, expert1_balance_bottom=19.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=223.2, ups=0.58, wpb=383.8, bsz=32, num_updates=31700, lr=6.83009e-06, gnorm=3.318, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65715
2022-05-09 15:04:24 - progress_bar.py[line:272] - INFO: epoch 002:  14045 / 17711 loss=3.1, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.1, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.53, expert1_balance_bottom=19.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.2, ups=0.58, wpb=382.6, bsz=32, num_updates=31710, lr=6.82888e-06, gnorm=3.474, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65732
2022-05-09 15:04:41 - progress_bar.py[line:272] - INFO: epoch 002:  14055 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=391.2, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87614, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=35.248, expert1_balance_bottom=19.086, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=227.7, ups=0.58, wpb=391.2, bsz=32, num_updates=31720, lr=6.82768e-06, gnorm=4.04, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65749
2022-05-09 15:04:58 - progress_bar.py[line:272] - INFO: epoch 002:  14065 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=381.1, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891475, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.833, expert1_balance_bottom=19.673, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.7, ups=0.58, wpb=381.1, bsz=32, num_updates=31730, lr=6.82648e-06, gnorm=3.72, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65766
2022-05-09 15:05:15 - progress_bar.py[line:272] - INFO: epoch 002:  14075 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=398.2, nsentences=32, sample_size=316.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882359, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.17, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=233.4, ups=0.59, wpb=398.2, bsz=32, num_updates=31740, lr=6.82528e-06, gnorm=3.124, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65783
2022-05-09 15:05:33 - progress_bar.py[line:272] - INFO: epoch 002:  14085 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=387.4, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=35.428, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.3, ups=0.57, wpb=387.4, bsz=32, num_updates=31750, lr=6.82408e-06, gnorm=3.905, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65801
2022-05-09 15:05:50 - progress_bar.py[line:272] - INFO: epoch 002:  14095 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=388.3, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=33.502, expert1_balance_bottom=19.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=226.2, ups=0.58, wpb=388.3, bsz=32, num_updates=31760, lr=6.82288e-06, gnorm=3.618, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65818
2022-05-09 15:06:07 - progress_bar.py[line:272] - INFO: epoch 002:  14105 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.456, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.1, ups=0.57, wpb=381, bsz=32, num_updates=31770, lr=6.82168e-06, gnorm=3.305, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65835
2022-05-09 15:06:25 - progress_bar.py[line:272] - INFO: epoch 002:  14115 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=386.6, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.342, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220.7, ups=0.57, wpb=386.6, bsz=32, num_updates=31780, lr=6.82048e-06, gnorm=3.637, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65853
2022-05-09 15:06:42 - progress_bar.py[line:272] - INFO: epoch 002:  14125 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.593, expert1_balance_bottom=19.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.8, ups=0.58, wpb=383.9, bsz=32, num_updates=31790, lr=6.81927e-06, gnorm=3.443, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65870
2022-05-09 15:06:59 - progress_bar.py[line:272] - INFO: epoch 002:  14135 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=382.5, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887399, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.171, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.3, ups=0.59, wpb=382.5, bsz=32, num_updates=31800, lr=6.81807e-06, gnorm=4.355, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65887
2022-05-09 15:07:16 - progress_bar.py[line:272] - INFO: epoch 002:  14145 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=372.4, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891995, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.797, expert1_balance_bottom=19.567, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.5, ups=0.59, wpb=372.4, bsz=32, num_updates=31810, lr=6.81687e-06, gnorm=3.54, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65904
2022-05-09 15:07:33 - progress_bar.py[line:272] - INFO: epoch 002:  14155 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=374.1, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893298, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=34.135, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=216.8, ups=0.58, wpb=374.1, bsz=32, num_updates=31820, lr=6.81567e-06, gnorm=3.368, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65921
2022-05-09 15:07:50 - progress_bar.py[line:272] - INFO: epoch 002:  14165 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=373.3, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.198, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.5, ups=0.59, wpb=373.3, bsz=32, num_updates=31830, lr=6.81447e-06, gnorm=3.445, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65938
reach the end of datafile, start a new reader
2022-05-09 15:08:07 - progress_bar.py[line:272] - INFO: epoch 002:  14175 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=374.8, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.682, expert1_balance_bottom=19.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=218.6, ups=0.58, wpb=374.8, bsz=32, num_updates=31840, lr=6.81327e-06, gnorm=3.452, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65955
2022-05-09 15:08:25 - progress_bar.py[line:272] - INFO: epoch 002:  14185 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.676, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221.3, ups=0.58, wpb=384.4, bsz=32, num_updates=31850, lr=6.81207e-06, gnorm=3.336, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65973
2022-05-09 15:08:42 - progress_bar.py[line:272] - INFO: epoch 002:  14195 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=373.9, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890911, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=34.008, expert1_balance_bottom=19.493, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=213.3, ups=0.57, wpb=373.9, bsz=32, num_updates=31860, lr=6.81086e-06, gnorm=3.38, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=65990
2022-05-09 15:09:00 - progress_bar.py[line:272] - INFO: epoch 002:  14205 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=372.9, nsentences=32, sample_size=296.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.978, expert1_balance_bottom=19.583, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=215.9, ups=0.58, wpb=372.9, bsz=32, num_updates=31870, lr=6.80966e-06, gnorm=3.25, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66008
2022-05-09 15:09:17 - progress_bar.py[line:272] - INFO: epoch 002:  14215 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.72, ntokens=388.3, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.739, expert1_balance_bottom=19.341, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=227.6, ups=0.59, wpb=388.3, bsz=32, num_updates=31880, lr=6.80846e-06, gnorm=3.566, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66025
2022-05-09 15:09:34 - progress_bar.py[line:272] - INFO: epoch 002:  14225 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=392.4, nsentences=32, sample_size=312.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.065, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.1, ups=0.57, wpb=392.4, bsz=32, num_updates=31890, lr=6.80726e-06, gnorm=3.427, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66042
2022-05-09 15:09:51 - progress_bar.py[line:272] - INFO: epoch 002:  14235 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=377.1, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883663, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.627, expert1_balance_bottom=19.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220, ups=0.58, wpb=377.1, bsz=32, num_updates=31900, lr=6.80606e-06, gnorm=3.105, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66060
2022-05-09 15:10:09 - progress_bar.py[line:272] - INFO: epoch 002:  14245 / 17711 loss=2.926, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=377.6, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.926, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.56, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=218.3, ups=0.58, wpb=377.6, bsz=32, num_updates=31910, lr=6.80486e-06, gnorm=3.67, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66077
2022-05-09 15:10:26 - progress_bar.py[line:272] - INFO: epoch 002:  14255 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=385.7, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.371, expert1_balance_bottom=19.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=224, ups=0.58, wpb=385.7, bsz=32, num_updates=31920, lr=6.80366e-06, gnorm=3.324, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66094
2022-05-09 15:10:43 - progress_bar.py[line:272] - INFO: epoch 002:  14265 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=389.5, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892526, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.397, expert1_balance_bottom=19.687, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.4, ups=0.57, wpb=389.5, bsz=32, num_updates=31930, lr=6.80246e-06, gnorm=3.352, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66111
2022-05-09 15:11:01 - progress_bar.py[line:272] - INFO: epoch 002:  14275 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=394, nsentences=32, sample_size=313.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870971, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=35.165, expert1_balance_bottom=19.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.5, ups=0.58, wpb=394, bsz=32, num_updates=31940, lr=6.80125e-06, gnorm=3.423, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66129
2022-05-09 15:11:18 - progress_bar.py[line:272] - INFO: epoch 002:  14285 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=379.5, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=35.013, expert1_balance_bottom=19.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.7, ups=0.58, wpb=379.5, bsz=32, num_updates=31950, lr=6.80005e-06, gnorm=3.652, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66146
2022-05-09 15:11:35 - progress_bar.py[line:272] - INFO: epoch 002:  14295 / 17711 loss=2.928, loss_v1=0, loss_v2=0, nll_loss=0.695, ntokens=375.9, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89125, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.928, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=34.082, expert1_balance_bottom=19.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=220, ups=0.59, wpb=375.9, bsz=32, num_updates=31960, lr=6.79885e-06, gnorm=2.959, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66163
2022-05-09 15:11:52 - progress_bar.py[line:272] - INFO: epoch 002:  14305 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=379.2, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=33.996, expert1_balance_bottom=19.567, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.4, ups=0.59, wpb=379.2, bsz=32, num_updates=31970, lr=6.79765e-06, gnorm=3.373, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66180
2022-05-09 15:12:09 - progress_bar.py[line:272] - INFO: epoch 002:  14315 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884438, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.298, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.6, ups=0.58, wpb=381.1, bsz=32, num_updates=31980, lr=6.79645e-06, gnorm=3.528, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66197
2022-05-09 15:12:26 - progress_bar.py[line:272] - INFO: epoch 002:  14325 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=379.3, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880782, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=35.049, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=222, ups=0.59, wpb=379.3, bsz=32, num_updates=31990, lr=6.79525e-06, gnorm=3.348, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66214
2022-05-09 15:12:43 - progress_bar.py[line:272] - INFO: epoch 002:  14335 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884433, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.608, expert1_balance_bottom=19.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=222.8, ups=0.58, wpb=381, bsz=32, num_updates=32000, lr=6.79405e-06, gnorm=3.888, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66232
2022-05-09 15:12:43 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 15:12:44 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 15:12:44 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 15:19:52 - train.py[line:517] - INFO: valid_step finished
2022-05-09 15:19:52 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 10.071 | loss_v1 0 | loss_v2 0 | nll_loss 8.408 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.00069 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.071 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.176 | expert1_balance_top 40.098 | expert1_balance_bottom 15.253 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 339.68 | cider 1.199 | wps 703.4 | wpb 481.7 | bsz 8 | num_updates 32000 | best_cider 1.199
2022-05-09 15:20:09 - progress_bar.py[line:272] - INFO: epoch 002:  14345 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=375.2, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892598, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.941, expert1_balance_bottom=19.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=8.4, ups=0.02, wpb=375.2, bsz=32, num_updates=32010, lr=6.79284e-06, gnorm=3.134, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66677
2022-05-09 15:20:26 - progress_bar.py[line:272] - INFO: epoch 002:  14355 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884255, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.436, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=229.2, ups=0.6, wpb=383.8, bsz=32, num_updates=32020, lr=6.79164e-06, gnorm=3.52, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66694
2022-05-09 15:20:43 - progress_bar.py[line:272] - INFO: epoch 002:  14365 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893372, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.851, expert1_balance_bottom=19.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=226.3, ups=0.59, wpb=384.1, bsz=32, num_updates=32030, lr=6.79044e-06, gnorm=3.254, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66711
2022-05-09 15:21:00 - progress_bar.py[line:272] - INFO: epoch 002:  14375 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=378.3, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=33.537, expert1_balance_bottom=19.712, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=224.7, ups=0.59, wpb=378.3, bsz=32, num_updates=32040, lr=6.78924e-06, gnorm=3.521, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66728
2022-05-09 15:21:16 - progress_bar.py[line:272] - INFO: epoch 002:  14385 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871488, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.896, expert1_balance_bottom=19.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=225.6, ups=0.59, wpb=380.5, bsz=32, num_updates=32050, lr=6.78804e-06, gnorm=3.51, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66744
2022-05-09 15:21:34 - progress_bar.py[line:272] - INFO: epoch 002:  14395 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=381.1, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890636, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.542, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=223.3, ups=0.59, wpb=381.1, bsz=32, num_updates=32060, lr=6.78684e-06, gnorm=3.177, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66762
2022-05-09 15:21:51 - progress_bar.py[line:272] - INFO: epoch 002:  14405 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=368.8, nsentences=32, sample_size=293.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.089, expert1_balance_bottom=19.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.6, ups=0.58, wpb=368.8, bsz=32, num_updates=32070, lr=6.78564e-06, gnorm=3.728, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66779
2022-05-09 15:22:08 - progress_bar.py[line:272] - INFO: epoch 002:  14415 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87158, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.605, expert1_balance_bottom=19.433, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=227.1, ups=0.59, wpb=384.4, bsz=32, num_updates=32080, lr=6.78444e-06, gnorm=3.54, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66796
2022-05-09 15:22:25 - progress_bar.py[line:272] - INFO: epoch 002:  14425 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=389.7, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=33.508, expert1_balance_bottom=19.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=227.5, ups=0.58, wpb=389.7, bsz=32, num_updates=32090, lr=6.78323e-06, gnorm=3.687, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66813
2022-05-09 15:22:42 - progress_bar.py[line:272] - INFO: epoch 002:  14435 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880046, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.367, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.4, ups=0.59, wpb=383, bsz=32, num_updates=32100, lr=6.78203e-06, gnorm=3.949, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66830
2022-05-09 15:22:44 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 15:23:01 - progress_bar.py[line:272] - INFO: epoch 002:  14446 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.132, expert1_balance_bottom=19.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=200.2, ups=0.53, wpb=377.4, bsz=32, num_updates=32110, lr=6.78083e-06, gnorm=2.679, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66849
2022-05-09 15:23:18 - progress_bar.py[line:272] - INFO: epoch 002:  14456 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.925, expert1_balance_bottom=19.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=229.6, ups=0.6, wpb=385.5, bsz=32, num_updates=32120, lr=6.77963e-06, gnorm=3.315, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66866
2022-05-09 15:23:34 - progress_bar.py[line:272] - INFO: epoch 002:  14466 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=380.1, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885432, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.692, expert1_balance_bottom=19.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=224.1, ups=0.59, wpb=380.1, bsz=32, num_updates=32130, lr=6.77843e-06, gnorm=3.305, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66883
2022-05-09 15:23:51 - progress_bar.py[line:272] - INFO: epoch 002:  14476 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885558, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.15, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=224.9, ups=0.59, wpb=381.1, bsz=32, num_updates=32140, lr=6.77723e-06, gnorm=2.964, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66899
2022-05-09 15:24:08 - progress_bar.py[line:272] - INFO: epoch 002:  14486 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.868, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=230.5, ups=0.6, wpb=385.7, bsz=32, num_updates=32150, lr=6.77603e-06, gnorm=3.163, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66916
2022-05-09 15:24:25 - progress_bar.py[line:272] - INFO: epoch 002:  14496 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=377, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88983, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.749, expert1_balance_bottom=19.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=225.5, ups=0.6, wpb=377, bsz=32, num_updates=32160, lr=6.77483e-06, gnorm=3.519, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66933
2022-05-09 15:24:42 - progress_bar.py[line:272] - INFO: epoch 002:  14506 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881356, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.354, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=228.2, ups=0.59, wpb=383.7, bsz=32, num_updates=32170, lr=6.77362e-06, gnorm=3.268, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66950
2022-05-09 15:24:59 - progress_bar.py[line:272] - INFO: epoch 002:  14516 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=385.2, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.99, expert1_balance_bottom=19.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=224, ups=0.58, wpb=385.2, bsz=32, num_updates=32180, lr=6.77242e-06, gnorm=3.326, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66967
2022-05-09 15:25:16 - progress_bar.py[line:272] - INFO: epoch 002:  14526 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.124, expert1_balance_top=32.76, expert1_balance_bottom=19.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=219.8, ups=0.58, wpb=381.1, bsz=32, num_updates=32190, lr=6.77122e-06, gnorm=3.227, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=66984
2022-05-09 15:25:33 - progress_bar.py[line:272] - INFO: epoch 002:  14536 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883976, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.384, expert1_balance_bottom=19.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=223.3, ups=0.58, wpb=384.1, bsz=32, num_updates=32200, lr=6.77002e-06, gnorm=3.396, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67001
2022-05-09 15:25:51 - progress_bar.py[line:272] - INFO: epoch 002:  14546 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.907167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.403, expert1_balance_bottom=19.792, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=220.6, ups=0.58, wpb=380.5, bsz=32, num_updates=32210, lr=6.76882e-06, gnorm=3, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67019
2022-05-09 15:26:08 - progress_bar.py[line:272] - INFO: epoch 002:  14556 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=390.9, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888523, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.509, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=227.8, ups=0.58, wpb=390.9, bsz=32, num_updates=32220, lr=6.76762e-06, gnorm=3.296, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67036
2022-05-09 15:26:25 - progress_bar.py[line:272] - INFO: epoch 002:  14566 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=389.8, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.655, expert1_balance_bottom=19.088, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223.7, ups=0.57, wpb=389.8, bsz=32, num_updates=32230, lr=6.76642e-06, gnorm=3.277, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67053
2022-05-09 15:26:42 - progress_bar.py[line:272] - INFO: epoch 002:  14576 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881498, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.961, expert1_balance_bottom=19.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223.5, ups=0.58, wpb=382.8, bsz=32, num_updates=32240, lr=6.76521e-06, gnorm=3.42, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67070
2022-05-09 15:27:00 - progress_bar.py[line:272] - INFO: epoch 002:  14586 / 17711 loss=3.083, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=376.7, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88794, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.083, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.212, expert1_balance_bottom=19.557, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=212.9, ups=0.57, wpb=376.7, bsz=32, num_updates=32250, lr=6.76401e-06, gnorm=3.349, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67088
2022-05-09 15:27:17 - progress_bar.py[line:272] - INFO: epoch 002:  14596 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.774, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=225.5, ups=0.59, wpb=383, bsz=32, num_updates=32260, lr=6.76281e-06, gnorm=3.171, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67105
2022-05-09 15:27:34 - progress_bar.py[line:272] - INFO: epoch 002:  14606 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=378.2, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893629, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.974, expert1_balance_bottom=19.622, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.8, ups=0.58, wpb=378.2, bsz=32, num_updates=32270, lr=6.76161e-06, gnorm=3.718, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67122
2022-05-09 15:27:51 - progress_bar.py[line:272] - INFO: epoch 002:  14616 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881551, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.498, expert1_balance_bottom=19.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221, ups=0.58, wpb=379.1, bsz=32, num_updates=32280, lr=6.76041e-06, gnorm=3.536, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67140
2022-05-09 15:28:09 - progress_bar.py[line:272] - INFO: epoch 002:  14626 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=381.2, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.645, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.8, ups=0.58, wpb=381.2, bsz=32, num_updates=32290, lr=6.75921e-06, gnorm=3.186, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67157
2022-05-09 15:28:26 - progress_bar.py[line:272] - INFO: epoch 002:  14636 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=377.7, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884594, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.257, expert1_balance_bottom=19.415, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.6, ups=0.58, wpb=377.7, bsz=32, num_updates=32300, lr=6.75801e-06, gnorm=3.548, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67174
2022-05-09 15:28:43 - progress_bar.py[line:272] - INFO: epoch 002:  14646 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=379.4, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894254, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.08, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=222, ups=0.59, wpb=379.4, bsz=32, num_updates=32310, lr=6.75681e-06, gnorm=3.641, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67191
2022-05-09 15:29:00 - progress_bar.py[line:272] - INFO: epoch 002:  14656 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=389.1, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885478, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.375, expert1_balance_bottom=19.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222, ups=0.57, wpb=389.1, bsz=32, num_updates=32320, lr=6.7556e-06, gnorm=3.225, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67208
2022-05-09 15:29:17 - progress_bar.py[line:272] - INFO: epoch 002:  14666 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889545, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.483, expert1_balance_bottom=19.366, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.1, ups=0.58, wpb=381.7, bsz=32, num_updates=32330, lr=6.7544e-06, gnorm=4.263, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67226
2022-05-09 15:29:35 - progress_bar.py[line:272] - INFO: epoch 002:  14676 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892213, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.948, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.2, ups=0.58, wpb=380.8, bsz=32, num_updates=32340, lr=6.7532e-06, gnorm=3.245, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67243
2022-05-09 15:29:52 - progress_bar.py[line:272] - INFO: epoch 002:  14686 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=389.2, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.287, expert1_balance_bottom=19.458, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=225.7, ups=0.58, wpb=389.2, bsz=32, num_updates=32350, lr=6.752e-06, gnorm=3.561, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67260
2022-05-09 15:30:09 - progress_bar.py[line:272] - INFO: epoch 002:  14696 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=387.4, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.376, expert1_balance_bottom=19.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=222.7, ups=0.57, wpb=387.4, bsz=32, num_updates=32360, lr=6.7508e-06, gnorm=3.763, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67277
2022-05-09 15:30:26 - progress_bar.py[line:272] - INFO: epoch 002:  14706 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=376.3, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889964, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.191, expert1_balance_bottom=19.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=222, ups=0.59, wpb=376.3, bsz=32, num_updates=32370, lr=6.7496e-06, gnorm=3.059, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67294
2022-05-09 15:30:44 - progress_bar.py[line:272] - INFO: epoch 002:  14716 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=386.2, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888806, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.415, expert1_balance_bottom=19.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=225.2, ups=0.58, wpb=386.2, bsz=32, num_updates=32380, lr=6.7484e-06, gnorm=3.31, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67312
2022-05-09 15:31:01 - progress_bar.py[line:272] - INFO: epoch 002:  14726 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=388, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881665, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.497, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=226.3, ups=0.58, wpb=388, bsz=32, num_updates=32390, lr=6.74719e-06, gnorm=3.424, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67329
2022-05-09 15:31:18 - progress_bar.py[line:272] - INFO: epoch 002:  14736 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=388.5, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.28, expert1_balance_bottom=19.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.2, ups=0.58, wpb=388.5, bsz=32, num_updates=32400, lr=6.74599e-06, gnorm=3.685, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67346
2022-05-09 15:31:35 - progress_bar.py[line:272] - INFO: epoch 002:  14746 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=389.2, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873326, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=35.254, expert1_balance_bottom=19.134, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.6, ups=0.58, wpb=389.2, bsz=32, num_updates=32410, lr=6.74479e-06, gnorm=4.007, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67363
2022-05-09 15:31:53 - progress_bar.py[line:272] - INFO: epoch 002:  14756 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=387.5, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870402, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.317, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.8, ups=0.58, wpb=387.5, bsz=32, num_updates=32420, lr=6.74359e-06, gnorm=3.63, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67381
2022-05-09 15:32:10 - progress_bar.py[line:272] - INFO: epoch 002:  14766 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=386.5, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868412, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.426, expert1_balance_bottom=19.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=220.3, ups=0.57, wpb=386.5, bsz=32, num_updates=32430, lr=6.74239e-06, gnorm=3.893, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67398
2022-05-09 15:32:27 - progress_bar.py[line:272] - INFO: epoch 002:  14776 / 17711 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=382.1, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891226, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.951, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.848, expert1_balance_bottom=19.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=222, ups=0.58, wpb=382.1, bsz=32, num_updates=32440, lr=6.74119e-06, gnorm=3.144, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67415
2022-05-09 15:32:45 - progress_bar.py[line:272] - INFO: epoch 002:  14786 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=385.7, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889309, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.962, expert1_balance_bottom=19.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.5, ups=0.57, wpb=385.7, bsz=32, num_updates=32450, lr=6.73999e-06, gnorm=4.032, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67433
2022-05-09 15:33:02 - progress_bar.py[line:272] - INFO: epoch 002:  14796 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=374.5, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880867, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.932, expert1_balance_bottom=19.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.9, ups=0.57, wpb=374.5, bsz=32, num_updates=32460, lr=6.73879e-06, gnorm=3.229, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67450
2022-05-09 15:33:19 - progress_bar.py[line:272] - INFO: epoch 002:  14806 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=389.5, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=35.072, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=228.1, ups=0.59, wpb=389.5, bsz=32, num_updates=32470, lr=6.73758e-06, gnorm=3.456, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67467
2022-05-09 15:33:36 - progress_bar.py[line:272] - INFO: epoch 002:  14816 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=384, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889911, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.491, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.9, ups=0.59, wpb=384, bsz=32, num_updates=32480, lr=6.73638e-06, gnorm=3.676, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67485
2022-05-09 15:33:54 - progress_bar.py[line:272] - INFO: epoch 002:  14826 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=391.7, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881872, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.241, expert1_balance_bottom=19.578, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=226.1, ups=0.58, wpb=391.7, bsz=32, num_updates=32490, lr=6.73518e-06, gnorm=3.769, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67502
2022-05-09 15:34:11 - progress_bar.py[line:272] - INFO: epoch 002:  14836 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=385.3, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89267, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=33.983, expert1_balance_bottom=19.493, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=221.9, ups=0.58, wpb=385.3, bsz=32, num_updates=32500, lr=6.73398e-06, gnorm=3.416, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67519
2022-05-09 15:34:28 - progress_bar.py[line:272] - INFO: epoch 002:  14846 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=383.5, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883128, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.64, expert1_balance_bottom=19.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222, ups=0.58, wpb=383.5, bsz=32, num_updates=32510, lr=6.73278e-06, gnorm=3.328, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67537
2022-05-09 15:34:46 - progress_bar.py[line:272] - INFO: epoch 002:  14856 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885051, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.426, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=224.5, ups=0.58, wpb=385.4, bsz=32, num_updates=32520, lr=6.73158e-06, gnorm=3.247, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67554
2022-05-09 15:35:03 - progress_bar.py[line:272] - INFO: epoch 002:  14866 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=383.7, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.441, expert1_balance_bottom=19.404, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=225.2, ups=0.59, wpb=383.7, bsz=32, num_updates=32530, lr=6.73038e-06, gnorm=3.392, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67571
2022-05-09 15:35:19 - progress_bar.py[line:272] - INFO: epoch 002:  14876 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=382.1, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889076, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.278, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=228.3, ups=0.6, wpb=382.1, bsz=32, num_updates=32540, lr=6.72918e-06, gnorm=3.256, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67587
2022-05-09 15:35:37 - progress_bar.py[line:272] - INFO: epoch 002:  14886 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=390.1, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86698, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.557, expert1_balance_bottom=18.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=227.8, ups=0.58, wpb=390.1, bsz=32, num_updates=32550, lr=6.72797e-06, gnorm=3.741, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67605
2022-05-09 15:35:54 - progress_bar.py[line:272] - INFO: epoch 002:  14896 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=386.5, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.599, expert1_balance_bottom=19.459, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=222.8, ups=0.58, wpb=386.5, bsz=32, num_updates=32560, lr=6.72677e-06, gnorm=4.196, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67622
2022-05-09 15:36:11 - progress_bar.py[line:272] - INFO: epoch 002:  14906 / 17711 loss=3.077, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=373.3, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.077, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.052, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.5, ups=0.57, wpb=373.3, bsz=32, num_updates=32570, lr=6.72557e-06, gnorm=4.136, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67639
2022-05-09 15:36:29 - progress_bar.py[line:272] - INFO: epoch 002:  14916 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=375.6, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895948, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.641, expert1_balance_bottom=19.666, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=216.4, ups=0.58, wpb=375.6, bsz=32, num_updates=32580, lr=6.72437e-06, gnorm=3.342, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67657
2022-05-09 15:36:46 - progress_bar.py[line:272] - INFO: epoch 002:  14926 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=373.7, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=33.884, expert1_balance_bottom=19.596, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.6, ups=0.59, wpb=373.7, bsz=32, num_updates=32590, lr=6.72317e-06, gnorm=3.457, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67674
2022-05-09 15:37:03 - progress_bar.py[line:272] - INFO: epoch 002:  14936 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=383.2, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879663, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.701, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.8, ups=0.58, wpb=383.2, bsz=32, num_updates=32600, lr=6.72197e-06, gnorm=3.599, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67691
2022-05-09 15:37:20 - progress_bar.py[line:272] - INFO: epoch 002:  14946 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=393.4, nsentences=32, sample_size=313.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876894, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.792, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=226.6, ups=0.58, wpb=393.4, bsz=32, num_updates=32610, lr=6.72077e-06, gnorm=3.149, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67708
2022-05-09 15:37:38 - progress_bar.py[line:272] - INFO: epoch 002:  14956 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=385.8, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888991, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.292, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=222.5, ups=0.58, wpb=385.8, bsz=32, num_updates=32620, lr=6.71956e-06, gnorm=3.202, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67726
2022-05-09 15:37:55 - progress_bar.py[line:272] - INFO: epoch 002:  14966 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=383.7, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=35.435, expert1_balance_bottom=19.131, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.1, ups=0.58, wpb=383.7, bsz=32, num_updates=32630, lr=6.71836e-06, gnorm=3.363, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67743
2022-05-09 15:38:12 - progress_bar.py[line:272] - INFO: epoch 002:  14976 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.349, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.7, ups=0.57, wpb=377.1, bsz=32, num_updates=32640, lr=6.71716e-06, gnorm=3.994, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67760
2022-05-09 15:38:30 - progress_bar.py[line:272] - INFO: epoch 002:  14986 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=372.7, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904919, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.126, expert1_balance_top=33.398, expert1_balance_bottom=19.683, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=211.4, ups=0.57, wpb=372.7, bsz=32, num_updates=32650, lr=6.71596e-06, gnorm=3.246, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67778
2022-05-09 15:38:48 - progress_bar.py[line:272] - INFO: epoch 002:  14996 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888065, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.933, expert1_balance_bottom=19.618, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=214.1, ups=0.57, wpb=377.8, bsz=32, num_updates=32660, lr=6.71476e-06, gnorm=3.608, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67796
2022-05-09 15:39:05 - progress_bar.py[line:272] - INFO: epoch 002:  15006 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889656, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.225, expert1_balance_bottom=19.464, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.9, ups=0.57, wpb=382.8, bsz=32, num_updates=32670, lr=6.71356e-06, gnorm=3.562, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67813
2022-05-09 15:39:22 - progress_bar.py[line:272] - INFO: epoch 002:  15016 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=387.6, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.94, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=223.1, ups=0.58, wpb=387.6, bsz=32, num_updates=32680, lr=6.71236e-06, gnorm=3.361, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67830
2022-05-09 15:39:40 - progress_bar.py[line:272] - INFO: epoch 002:  15026 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=381.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880722, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.667, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=217.4, ups=0.57, wpb=381.8, bsz=32, num_updates=32690, lr=6.71116e-06, gnorm=3.076, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67848
2022-05-09 15:39:57 - progress_bar.py[line:272] - INFO: epoch 002:  15036 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884306, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.413, expert1_balance_bottom=19.291, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.1, ups=0.58, wpb=378.5, bsz=32, num_updates=32700, lr=6.70995e-06, gnorm=3.233, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67865
2022-05-09 15:40:15 - progress_bar.py[line:272] - INFO: epoch 002:  15046 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.883, expert1_balance_bottom=19.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=222.2, ups=0.58, wpb=383.4, bsz=32, num_updates=32710, lr=6.70875e-06, gnorm=3.139, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67883
2022-05-09 15:40:32 - progress_bar.py[line:272] - INFO: epoch 002:  15056 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.8, expert1_balance_bottom=19.26, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.6, ups=0.57, wpb=385, bsz=32, num_updates=32720, lr=6.70755e-06, gnorm=3.078, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67900
2022-05-09 15:40:50 - progress_bar.py[line:272] - INFO: epoch 002:  15066 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886519, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.491, expert1_balance_bottom=19.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.4, ups=0.57, wpb=380.4, bsz=32, num_updates=32730, lr=6.70635e-06, gnorm=3.657, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67918
2022-05-09 15:40:55 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 15:41:09 - progress_bar.py[line:272] - INFO: epoch 002:  15077 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=35.317, expert1_balance_bottom=19.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=200.4, ups=0.52, wpb=382.4, bsz=32, num_updates=32740, lr=6.70515e-06, gnorm=3.759, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67937
2022-05-09 15:41:27 - progress_bar.py[line:272] - INFO: epoch 002:  15087 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=390.6, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.788, expert1_balance_bottom=19.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.8, ups=0.56, wpb=390.6, bsz=32, num_updates=32750, lr=6.70395e-06, gnorm=3.416, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67955
2022-05-09 15:41:44 - progress_bar.py[line:272] - INFO: epoch 002:  15097 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=391.1, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884067, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.057, expert1_balance_bottom=19.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=226.6, ups=0.58, wpb=391.1, bsz=32, num_updates=32760, lr=6.70275e-06, gnorm=3.861, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67972
2022-05-09 15:42:01 - progress_bar.py[line:272] - INFO: epoch 002:  15107 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=384.7, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881542, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.866, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=218.8, ups=0.57, wpb=384.7, bsz=32, num_updates=32770, lr=6.70154e-06, gnorm=3.311, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=67989
2022-05-09 15:42:19 - progress_bar.py[line:272] - INFO: epoch 002:  15117 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.013, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=217.7, ups=0.57, wpb=381, bsz=32, num_updates=32780, lr=6.70034e-06, gnorm=3.641, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68007
2022-05-09 15:42:36 - progress_bar.py[line:272] - INFO: epoch 002:  15127 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=376.3, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887022, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.335, expert1_balance_bottom=19.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=217.5, ups=0.58, wpb=376.3, bsz=32, num_updates=32790, lr=6.69914e-06, gnorm=3.027, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68024
2022-05-09 15:42:53 - progress_bar.py[line:272] - INFO: epoch 002:  15137 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=376.5, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888978, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.98, expert1_balance_bottom=19.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.4, ups=0.59, wpb=376.5, bsz=32, num_updates=32800, lr=6.69794e-06, gnorm=3.399, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68041
2022-05-09 15:43:10 - progress_bar.py[line:272] - INFO: epoch 002:  15147 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=378.4, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=33.69, expert1_balance_bottom=19.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=221.1, ups=0.58, wpb=378.4, bsz=32, num_updates=32810, lr=6.69674e-06, gnorm=3.466, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68058
2022-05-09 15:43:27 - progress_bar.py[line:272] - INFO: epoch 002:  15157 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=393.7, nsentences=32, sample_size=313.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879494, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.648, expert1_balance_bottom=19.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=229.9, ups=0.58, wpb=393.7, bsz=32, num_updates=32820, lr=6.69554e-06, gnorm=3.695, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68075
2022-05-09 15:43:45 - progress_bar.py[line:272] - INFO: epoch 002:  15167 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=391.4, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888228, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.172, expert1_balance_bottom=19.614, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=228.2, ups=0.58, wpb=391.4, bsz=32, num_updates=32830, lr=6.69434e-06, gnorm=3.499, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68093
2022-05-09 15:44:02 - progress_bar.py[line:272] - INFO: epoch 002:  15177 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=379.7, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890775, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.421, expert1_balance_bottom=19.392, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=220.2, ups=0.58, wpb=379.7, bsz=32, num_updates=32840, lr=6.69314e-06, gnorm=3.385, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68110
2022-05-09 15:44:19 - progress_bar.py[line:272] - INFO: epoch 002:  15187 / 17711 loss=2.948, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=390.5, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889562, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.948, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.307, expert1_balance_bottom=19.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=225.2, ups=0.58, wpb=390.5, bsz=32, num_updates=32850, lr=6.69193e-06, gnorm=3.089, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68127
2022-05-09 15:44:37 - progress_bar.py[line:272] - INFO: epoch 002:  15197 / 17711 loss=2.929, loss_v1=0, loss_v2=0, nll_loss=0.696, ntokens=384.6, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895053, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.929, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.594, expert1_balance_bottom=19.775, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=218.6, ups=0.57, wpb=384.6, bsz=32, num_updates=32860, lr=6.69073e-06, gnorm=3.087, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68145
2022-05-09 15:44:54 - progress_bar.py[line:272] - INFO: epoch 002:  15207 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882332, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.488, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.2, ups=0.58, wpb=380.6, bsz=32, num_updates=32870, lr=6.68953e-06, gnorm=3.607, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68162
2022-05-09 15:45:11 - progress_bar.py[line:272] - INFO: epoch 002:  15217 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=369.8, nsentences=32, sample_size=294.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.122, expert1_balance_top=33.889, expert1_balance_bottom=19.556, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.4, ups=0.59, wpb=369.8, bsz=32, num_updates=32880, lr=6.68833e-06, gnorm=4.684, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68179
2022-05-09 15:45:28 - progress_bar.py[line:272] - INFO: epoch 002:  15227 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=371.1, nsentences=32, sample_size=295.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.775, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=215.1, ups=0.58, wpb=371.1, bsz=32, num_updates=32890, lr=6.68713e-06, gnorm=3.083, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68196
2022-05-09 15:45:45 - progress_bar.py[line:272] - INFO: epoch 002:  15237 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=378.7, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.123, expert1_balance_top=33.482, expert1_balance_bottom=19.531, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.1, ups=0.58, wpb=378.7, bsz=32, num_updates=32900, lr=6.68593e-06, gnorm=3.884, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68213
2022-05-09 15:46:03 - progress_bar.py[line:272] - INFO: epoch 002:  15247 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=33.981, expert1_balance_bottom=19.563, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=223.5, ups=0.58, wpb=384.3, bsz=32, num_updates=32910, lr=6.68473e-06, gnorm=3.238, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68231
2022-05-09 15:46:20 - progress_bar.py[line:272] - INFO: epoch 002:  15257 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=384.4, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.613, expert1_balance_bottom=19.751, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.8, ups=0.58, wpb=384.4, bsz=32, num_updates=32920, lr=6.68353e-06, gnorm=3.572, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68248
2022-05-09 15:46:37 - progress_bar.py[line:272] - INFO: epoch 002:  15267 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=387.2, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872608, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.923, expert1_balance_bottom=19.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=226.9, ups=0.59, wpb=387.2, bsz=32, num_updates=32930, lr=6.68232e-06, gnorm=3.717, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68265
2022-05-09 15:46:54 - progress_bar.py[line:272] - INFO: epoch 002:  15277 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=390.4, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.927, expert1_balance_bottom=19.063, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=224.5, ups=0.57, wpb=390.4, bsz=32, num_updates=32940, lr=6.68112e-06, gnorm=3.813, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68282
2022-05-09 15:47:11 - progress_bar.py[line:272] - INFO: epoch 002:  15287 / 17711 loss=2.931, loss_v1=0, loss_v2=0, nll_loss=0.703, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890151, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.931, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=34.588, expert1_balance_bottom=19.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=222.5, ups=0.58, wpb=383.2, bsz=32, num_updates=32950, lr=6.67992e-06, gnorm=3.483, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68299
2022-05-09 15:47:29 - progress_bar.py[line:272] - INFO: epoch 002:  15297 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=377.4, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.718, expert1_balance_bottom=19.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.4, ups=0.58, wpb=377.4, bsz=32, num_updates=32960, lr=6.67872e-06, gnorm=3.184, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68317
2022-05-09 15:47:46 - progress_bar.py[line:272] - INFO: epoch 002:  15307 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885766, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.992, expert1_balance_bottom=19.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=224.6, ups=0.58, wpb=384.2, bsz=32, num_updates=32970, lr=6.67752e-06, gnorm=3.972, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68334
2022-05-09 15:48:03 - progress_bar.py[line:272] - INFO: epoch 002:  15317 / 17711 loss=2.937, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=387.7, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.937, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.772, expert1_balance_bottom=19.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=224.3, ups=0.58, wpb=387.7, bsz=32, num_updates=32980, lr=6.67632e-06, gnorm=3.275, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68351
2022-05-09 15:48:20 - progress_bar.py[line:272] - INFO: epoch 002:  15327 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=386.2, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868724, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.317, expert1_balance_bottom=19.032, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=223.4, ups=0.58, wpb=386.2, bsz=32, num_updates=32990, lr=6.67512e-06, gnorm=3.836, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68368
2022-05-09 15:48:38 - progress_bar.py[line:272] - INFO: epoch 002:  15337 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=391.2, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.775, expert1_balance_bottom=19.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=225.6, ups=0.58, wpb=391.2, bsz=32, num_updates=33000, lr=6.67391e-06, gnorm=3.601, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68386
2022-05-09 15:48:55 - progress_bar.py[line:272] - INFO: epoch 002:  15347 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.982, expert1_balance_bottom=19.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=225.6, ups=0.59, wpb=383.4, bsz=32, num_updates=33010, lr=6.67271e-06, gnorm=3.323, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68403
2022-05-09 15:49:12 - progress_bar.py[line:272] - INFO: epoch 002:  15357 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.423, expert1_balance_bottom=19.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223.9, ups=0.59, wpb=382.4, bsz=32, num_updates=33020, lr=6.67151e-06, gnorm=3.54, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68420
2022-05-09 15:49:29 - progress_bar.py[line:272] - INFO: epoch 002:  15367 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=391.6, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.029, expert1_balance_bottom=19.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=226.7, ups=0.58, wpb=391.6, bsz=32, num_updates=33030, lr=6.67031e-06, gnorm=3.792, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68437
2022-05-09 15:49:46 - progress_bar.py[line:272] - INFO: epoch 002:  15377 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=386.7, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878475, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.88, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=224.8, ups=0.58, wpb=386.7, bsz=32, num_updates=33040, lr=6.66911e-06, gnorm=3.374, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68454
2022-05-09 15:50:03 - progress_bar.py[line:272] - INFO: epoch 002:  15387 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876675, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.028, expert1_balance_bottom=19.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.5, ups=0.58, wpb=377.1, bsz=32, num_updates=33050, lr=6.66791e-06, gnorm=3.284, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68471
2022-05-09 15:50:21 - progress_bar.py[line:272] - INFO: epoch 002:  15397 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=376.1, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88822, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=33.929, expert1_balance_bottom=19.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=215.3, ups=0.57, wpb=376.1, bsz=32, num_updates=33060, lr=6.66671e-06, gnorm=3.492, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68489
2022-05-09 15:50:38 - progress_bar.py[line:272] - INFO: epoch 002:  15407 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=385.1, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.44, expert1_balance_bottom=19.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.2, ups=0.57, wpb=385.1, bsz=32, num_updates=33070, lr=6.66551e-06, gnorm=3.051, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68506
2022-05-09 15:50:56 - progress_bar.py[line:272] - INFO: epoch 002:  15417 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=382.6, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885392, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.772, expert1_balance_bottom=19.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=217.3, ups=0.57, wpb=382.6, bsz=32, num_updates=33080, lr=6.6643e-06, gnorm=3.243, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68524
2022-05-09 15:51:13 - progress_bar.py[line:272] - INFO: epoch 002:  15427 / 17711 loss=3.087, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.087, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.257, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=221, ups=0.58, wpb=381.2, bsz=32, num_updates=33090, lr=6.6631e-06, gnorm=3.609, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68541
2022-05-09 15:51:31 - progress_bar.py[line:272] - INFO: epoch 002:  15437 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=385.1, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.606, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.6, ups=0.58, wpb=385.1, bsz=32, num_updates=33100, lr=6.6619e-06, gnorm=3.699, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68559
2022-05-09 15:51:48 - progress_bar.py[line:272] - INFO: epoch 002:  15447 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=384.3, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889129, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.198, expert1_balance_bottom=19.351, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=224, ups=0.58, wpb=384.3, bsz=32, num_updates=33110, lr=6.6607e-06, gnorm=3.178, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68576
2022-05-09 15:52:05 - progress_bar.py[line:272] - INFO: epoch 002:  15457 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=385, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.931, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.5, ups=0.58, wpb=385, bsz=32, num_updates=33120, lr=6.6595e-06, gnorm=3.655, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68593
2022-05-09 15:52:22 - progress_bar.py[line:272] - INFO: epoch 002:  15467 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=388.7, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89346, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=33.754, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=226.7, ups=0.58, wpb=388.7, bsz=32, num_updates=33130, lr=6.6583e-06, gnorm=3.717, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68610
2022-05-09 15:52:39 - progress_bar.py[line:272] - INFO: epoch 002:  15477 / 17711 loss=2.935, loss_v1=0, loss_v2=0, nll_loss=0.717, ntokens=380.1, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.935, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.864, expert1_balance_bottom=19.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=225.4, ups=0.59, wpb=380.1, bsz=32, num_updates=33140, lr=6.6571e-06, gnorm=3.3, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68627
2022-05-09 15:52:56 - progress_bar.py[line:272] - INFO: epoch 002:  15487 / 17711 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=381.2, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.951, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=35.041, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=220.7, ups=0.58, wpb=381.2, bsz=32, num_updates=33150, lr=6.65589e-06, gnorm=3.78, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68645
2022-05-09 15:53:14 - progress_bar.py[line:272] - INFO: epoch 002:  15497 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=382.1, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.609, expert1_balance_bottom=19.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.7, ups=0.57, wpb=382.1, bsz=32, num_updates=33160, lr=6.65469e-06, gnorm=3.262, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68662
2022-05-09 15:53:31 - progress_bar.py[line:272] - INFO: epoch 002:  15507 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=383.1, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.527, expert1_balance_bottom=19.291, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222, ups=0.58, wpb=383.1, bsz=32, num_updates=33170, lr=6.65349e-06, gnorm=3.103, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68679
2022-05-09 15:53:48 - progress_bar.py[line:272] - INFO: epoch 002:  15517 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=391.9, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864484, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.766, expert1_balance_bottom=18.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=228.2, ups=0.58, wpb=391.9, bsz=32, num_updates=33180, lr=6.65229e-06, gnorm=3.567, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68696
2022-05-09 15:54:05 - progress_bar.py[line:272] - INFO: epoch 002:  15527 / 17711 loss=3.074, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=388, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.074, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.964, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=228.7, ups=0.59, wpb=388, bsz=32, num_updates=33190, lr=6.65109e-06, gnorm=3.944, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68713
2022-05-09 15:54:22 - progress_bar.py[line:272] - INFO: epoch 002:  15537 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=383.8, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.771, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=227.5, ups=0.59, wpb=383.8, bsz=32, num_updates=33200, lr=6.64989e-06, gnorm=3.108, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68730
2022-05-09 15:54:39 - progress_bar.py[line:272] - INFO: epoch 002:  15547 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=35.041, expert1_balance_bottom=19.237, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223.9, ups=0.58, wpb=384.7, bsz=32, num_updates=33210, lr=6.64869e-06, gnorm=3.284, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68747
2022-05-09 15:54:57 - progress_bar.py[line:272] - INFO: epoch 002:  15557 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=388.6, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87225, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.229, expert1_balance_bottom=19.24, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=226, ups=0.58, wpb=388.6, bsz=32, num_updates=33220, lr=6.64749e-06, gnorm=3.209, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68765
2022-05-09 15:55:14 - progress_bar.py[line:272] - INFO: epoch 002:  15567 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=376.8, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890499, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.549, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.9, ups=0.57, wpb=376.8, bsz=32, num_updates=33230, lr=6.64628e-06, gnorm=3.119, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68782
2022-05-09 15:55:32 - progress_bar.py[line:272] - INFO: epoch 002:  15577 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=380.3, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895037, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.875, expert1_balance_bottom=19.75, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=217.4, ups=0.57, wpb=380.3, bsz=32, num_updates=33240, lr=6.64508e-06, gnorm=3.964, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68800
2022-05-09 15:55:49 - progress_bar.py[line:272] - INFO: epoch 002:  15587 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.84, expert1_balance_bottom=19.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=220.5, ups=0.57, wpb=384.7, bsz=32, num_updates=33250, lr=6.64388e-06, gnorm=3.209, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68817
2022-05-09 15:56:07 - progress_bar.py[line:272] - INFO: epoch 002:  15597 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890252, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.826, expert1_balance_bottom=19.145, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.7, ups=0.56, wpb=385.5, bsz=32, num_updates=33260, lr=6.64268e-06, gnorm=3.632, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68835
2022-05-09 15:56:24 - progress_bar.py[line:272] - INFO: epoch 002:  15607 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=386.4, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885539, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.538, expert1_balance_bottom=19.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=222.7, ups=0.58, wpb=386.4, bsz=32, num_updates=33270, lr=6.64148e-06, gnorm=3.394, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68852
2022-05-09 15:56:41 - progress_bar.py[line:272] - INFO: epoch 002:  15617 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=376, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.196, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.3, ups=0.58, wpb=376, bsz=32, num_updates=33280, lr=6.64028e-06, gnorm=3.471, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68869
2022-05-09 15:56:59 - progress_bar.py[line:272] - INFO: epoch 002:  15627 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=391.5, nsentences=32, sample_size=311.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.686, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=226, ups=0.58, wpb=391.5, bsz=32, num_updates=33290, lr=6.63908e-06, gnorm=3.934, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68887
2022-05-09 15:57:16 - progress_bar.py[line:272] - INFO: epoch 002:  15637 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=375.7, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.54, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=218.2, ups=0.58, wpb=375.7, bsz=32, num_updates=33300, lr=6.63788e-06, gnorm=4.224, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68904
2022-05-09 15:57:33 - progress_bar.py[line:272] - INFO: epoch 002:  15647 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=378, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.389, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=216.8, ups=0.57, wpb=378, bsz=32, num_updates=33310, lr=6.63667e-06, gnorm=3.082, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68921
2022-05-09 15:57:51 - progress_bar.py[line:272] - INFO: epoch 002:  15657 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882058, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.892, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=221.4, ups=0.58, wpb=383.2, bsz=32, num_updates=33320, lr=6.63547e-06, gnorm=3.075, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68939
2022-05-09 15:58:08 - progress_bar.py[line:272] - INFO: epoch 002:  15667 / 17711 loss=2.932, loss_v1=0, loss_v2=0, nll_loss=0.707, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.932, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.686, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=222.9, ups=0.58, wpb=381.2, bsz=32, num_updates=33330, lr=6.63427e-06, gnorm=2.963, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68956
2022-05-09 15:58:26 - progress_bar.py[line:272] - INFO: epoch 002:  15677 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864418, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=36.502, expert1_balance_bottom=18.763, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.4, ups=0.56, wpb=383.3, bsz=32, num_updates=33340, lr=6.63307e-06, gnorm=3.613, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68974
2022-05-09 15:58:44 - progress_bar.py[line:272] - INFO: epoch 002:  15687 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=386.9, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.871, expert1_balance_bottom=19.013, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.4, ups=0.56, wpb=386.9, bsz=32, num_updates=33350, lr=6.63187e-06, gnorm=3.767, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=68992
2022-05-09 15:59:01 - progress_bar.py[line:272] - INFO: epoch 002:  15697 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=390.7, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.79, expert1_balance_bottom=19.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.5, ups=0.57, wpb=390.7, bsz=32, num_updates=33360, lr=6.63067e-06, gnorm=3.607, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69009
2022-05-09 15:59:19 - progress_bar.py[line:272] - INFO: epoch 002:  15707 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=33.661, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=216.1, ups=0.57, wpb=382.3, bsz=32, num_updates=33370, lr=6.62947e-06, gnorm=3.269, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69027
2022-05-09 15:59:36 - progress_bar.py[line:272] - INFO: epoch 002:  15717 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=380.3, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870127, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.504, expert1_balance_bottom=19.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.3, ups=0.57, wpb=380.3, bsz=32, num_updates=33380, lr=6.62826e-06, gnorm=3.123, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69044
2022-05-09 15:59:54 - progress_bar.py[line:272] - INFO: epoch 002:  15727 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881589, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.72, expert1_balance_bottom=19.383, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.9, ups=0.57, wpb=379.7, bsz=32, num_updates=33390, lr=6.62706e-06, gnorm=3.589, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69062
2022-05-09 16:00:11 - progress_bar.py[line:272] - INFO: epoch 002:  15737 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=380.8, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.605, expert1_balance_bottom=19.415, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=219.5, ups=0.58, wpb=380.8, bsz=32, num_updates=33400, lr=6.62586e-06, gnorm=3.189, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69079
2022-05-09 16:00:28 - progress_bar.py[line:272] - INFO: epoch 002:  15747 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=393.7, nsentences=32, sample_size=313.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.874, expert1_balance_bottom=18.905, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=228.1, ups=0.58, wpb=393.7, bsz=32, num_updates=33410, lr=6.62466e-06, gnorm=3.474, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69096
2022-05-09 16:00:46 - progress_bar.py[line:272] - INFO: epoch 002:  15757 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.599, expert1_balance_bottom=19.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.1, ups=0.57, wpb=381.4, bsz=32, num_updates=33420, lr=6.62346e-06, gnorm=3.497, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69114
2022-05-09 16:01:03 - progress_bar.py[line:272] - INFO: epoch 002:  15767 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=378.2, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874571, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=35.185, expert1_balance_bottom=19.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=217.5, ups=0.57, wpb=378.2, bsz=32, num_updates=33430, lr=6.62226e-06, gnorm=3.852, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69131
2022-05-09 16:01:20 - progress_bar.py[line:272] - INFO: epoch 002:  15777 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890608, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.926, expert1_balance_bottom=19.464, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=220.5, ups=0.58, wpb=379.9, bsz=32, num_updates=33440, lr=6.62106e-06, gnorm=3.326, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69148
2022-05-09 16:01:38 - progress_bar.py[line:272] - INFO: epoch 002:  15787 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=387.7, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.387, expert1_balance_bottom=19.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.3, ups=0.57, wpb=387.7, bsz=32, num_updates=33450, lr=6.61986e-06, gnorm=3.95, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69166
2022-05-09 16:01:55 - progress_bar.py[line:272] - INFO: epoch 002:  15797 / 17711 loss=2.908, loss_v1=0, loss_v2=0, nll_loss=0.699, ntokens=381.1, nsentences=31.5, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873632, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.908, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=35.732, expert1_balance_bottom=18.977, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=214.2, ups=0.56, wpb=381.1, bsz=31.5, num_updates=33460, lr=6.61865e-06, gnorm=3.299, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69184
2022-05-09 16:02:13 - progress_bar.py[line:272] - INFO: epoch 002:  15807 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889097, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=34.205, expert1_balance_bottom=19.374, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.7, ups=0.57, wpb=383.1, bsz=32, num_updates=33470, lr=6.61745e-06, gnorm=3.068, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69201
2022-05-09 16:02:30 - progress_bar.py[line:272] - INFO: epoch 002:  15817 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=376.4, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876119, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.186, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.2, ups=0.58, wpb=376.4, bsz=32, num_updates=33480, lr=6.61625e-06, gnorm=3.326, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69218
2022-05-09 16:02:48 - progress_bar.py[line:272] - INFO: epoch 002:  15827 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878571, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=35.127, expert1_balance_bottom=19.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.7, ups=0.57, wpb=380, bsz=32, num_updates=33490, lr=6.61505e-06, gnorm=3.338, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69236
2022-05-09 16:03:05 - progress_bar.py[line:272] - INFO: epoch 002:  15837 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=386.5, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880543, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.964, expert1_balance_bottom=18.976, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.2, ups=0.58, wpb=386.5, bsz=32, num_updates=33500, lr=6.61385e-06, gnorm=3.378, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69253
2022-05-09 16:03:22 - progress_bar.py[line:272] - INFO: epoch 002:  15847 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.45, expert1_balance_bottom=19.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=221.6, ups=0.58, wpb=382.7, bsz=32, num_updates=33510, lr=6.61265e-06, gnorm=3.539, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69270
2022-05-09 16:03:39 - progress_bar.py[line:272] - INFO: epoch 002:  15857 / 17711 loss=2.922, loss_v1=0, loss_v2=0, nll_loss=0.71, ntokens=388.9, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.922, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.956, expert1_balance_bottom=19.152, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=226.4, ups=0.58, wpb=388.9, bsz=32, num_updates=33520, lr=6.61145e-06, gnorm=3.161, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69287
2022-05-09 16:03:57 - progress_bar.py[line:272] - INFO: epoch 002:  15867 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=384.3, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.572, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.2, ups=0.57, wpb=384.3, bsz=32, num_updates=33530, lr=6.61024e-06, gnorm=3.12, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69305
2022-05-09 16:04:14 - progress_bar.py[line:272] - INFO: epoch 002:  15877 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89088, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.357, expert1_balance_bottom=19.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=220.7, ups=0.58, wpb=383.4, bsz=32, num_updates=33540, lr=6.60904e-06, gnorm=3.166, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69322
2022-05-09 16:04:32 - progress_bar.py[line:272] - INFO: epoch 002:  15887 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=383.5, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893665, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.768, expert1_balance_bottom=19.548, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=218.4, ups=0.57, wpb=383.5, bsz=32, num_updates=33550, lr=6.60784e-06, gnorm=3.357, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69340
2022-05-09 16:04:49 - progress_bar.py[line:272] - INFO: epoch 002:  15897 / 17711 loss=2.936, loss_v1=0, loss_v2=0, nll_loss=0.706, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892469, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.936, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.923, expert1_balance_bottom=19.479, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=223.7, ups=0.58, wpb=385.2, bsz=32, num_updates=33560, lr=6.60664e-06, gnorm=3.603, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69357
2022-05-09 16:05:06 - progress_bar.py[line:272] - INFO: epoch 002:  15907 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88995, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=33.665, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.4, ups=0.58, wpb=380.9, bsz=32, num_updates=33570, lr=6.60544e-06, gnorm=3.638, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69374
2022-05-09 16:05:23 - progress_bar.py[line:272] - INFO: epoch 002:  15917 / 17711 loss=2.939, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878877, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.939, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.995, expert1_balance_bottom=19.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=223.9, ups=0.58, wpb=382.7, bsz=32, num_updates=33580, lr=6.60424e-06, gnorm=3.147, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69391
2022-05-09 16:05:41 - progress_bar.py[line:272] - INFO: epoch 002:  15927 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=35.123, expert1_balance_bottom=19.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.8, ups=0.57, wpb=387.9, bsz=32, num_updates=33590, lr=6.60304e-06, gnorm=3.32, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69409
2022-05-09 16:05:58 - progress_bar.py[line:272] - INFO: epoch 002:  15937 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=379.2, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891776, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.43, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=220.1, ups=0.58, wpb=379.2, bsz=32, num_updates=33600, lr=6.60184e-06, gnorm=3.107, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69426
2022-05-09 16:06:16 - progress_bar.py[line:272] - INFO: epoch 002:  15947 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=370.9, nsentences=32, sample_size=295.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897069, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=33.874, expert1_balance_bottom=19.551, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=210.8, ups=0.57, wpb=370.9, bsz=32, num_updates=33610, lr=6.60063e-06, gnorm=3.169, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69444
2022-05-09 16:06:34 - progress_bar.py[line:272] - INFO: epoch 002:  15957 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.153, expert1_balance_bottom=19.446, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=216.1, ups=0.57, wpb=381.7, bsz=32, num_updates=33620, lr=6.59943e-06, gnorm=3.144, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69462
2022-05-09 16:06:51 - progress_bar.py[line:272] - INFO: epoch 002:  15967 / 17711 loss=2.903, loss_v1=0, loss_v2=0, nll_loss=0.673, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.903, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.108, expert1_balance_bottom=19.528, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=214.6, ups=0.57, wpb=379.6, bsz=32, num_updates=33630, lr=6.59823e-06, gnorm=3.128, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69479
2022-05-09 16:07:09 - progress_bar.py[line:272] - INFO: epoch 002:  15977 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.713, ntokens=387.7, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.591, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=223.5, ups=0.58, wpb=387.7, bsz=32, num_updates=33640, lr=6.59703e-06, gnorm=3.022, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69497
2022-05-09 16:07:26 - progress_bar.py[line:272] - INFO: epoch 002:  15987 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=384.6, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881519, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.92, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=223.7, ups=0.58, wpb=384.6, bsz=32, num_updates=33650, lr=6.59583e-06, gnorm=3.133, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69514
2022-05-09 16:07:43 - progress_bar.py[line:272] - INFO: epoch 002:  15997 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=385.2, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879882, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.949, expert1_balance_bottom=19.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=226.7, ups=0.59, wpb=385.2, bsz=32, num_updates=33660, lr=6.59463e-06, gnorm=3.312, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69531
2022-05-09 16:08:00 - progress_bar.py[line:272] - INFO: epoch 002:  16007 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=381.4, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.193, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.8, ups=0.58, wpb=381.4, bsz=32, num_updates=33670, lr=6.59343e-06, gnorm=3.463, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69548
2022-05-09 16:08:18 - progress_bar.py[line:272] - INFO: epoch 002:  16017 / 17711 loss=2.922, loss_v1=0, loss_v2=0, nll_loss=0.7, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883116, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.922, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.837, expert1_balance_bottom=19.226, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=214.7, ups=0.56, wpb=380.7, bsz=32, num_updates=33680, lr=6.59223e-06, gnorm=3.024, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69566
2022-05-09 16:08:35 - progress_bar.py[line:272] - INFO: epoch 002:  16027 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=385.9, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89041, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.375, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=224.6, ups=0.58, wpb=385.9, bsz=32, num_updates=33690, lr=6.59102e-06, gnorm=3.444, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69583
2022-05-09 16:08:52 - progress_bar.py[line:272] - INFO: epoch 002:  16037 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893307, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.945, expert1_balance_bottom=19.486, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217, ups=0.56, wpb=384.3, bsz=32, num_updates=33700, lr=6.58982e-06, gnorm=3.891, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69601
2022-05-09 16:09:10 - progress_bar.py[line:272] - INFO: epoch 002:  16047 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=35.015, expert1_balance_bottom=19.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=216.1, ups=0.57, wpb=382.2, bsz=32, num_updates=33710, lr=6.58862e-06, gnorm=3.436, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69618
2022-05-09 16:09:28 - progress_bar.py[line:272] - INFO: epoch 002:  16057 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.025, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=218.7, ups=0.57, wpb=386, bsz=32, num_updates=33720, lr=6.58742e-06, gnorm=3.259, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69636
2022-05-09 16:09:46 - progress_bar.py[line:272] - INFO: epoch 002:  16067 / 17711 loss=2.914, loss_v1=0, loss_v2=0, nll_loss=0.682, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.914, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.96, expert1_balance_bottom=19.616, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=218.4, ups=0.56, wpb=386.6, bsz=32, num_updates=33730, lr=6.58622e-06, gnorm=3.078, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69654
2022-05-09 16:10:03 - progress_bar.py[line:272] - INFO: epoch 002:  16077 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=393.1, nsentences=32, sample_size=312.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.726, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=223.4, ups=0.57, wpb=393.1, bsz=32, num_updates=33740, lr=6.58502e-06, gnorm=3.517, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69671
2022-05-09 16:10:21 - progress_bar.py[line:272] - INFO: epoch 002:  16087 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=372.2, nsentences=32, sample_size=296, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892365, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.702, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=211, ups=0.57, wpb=372.2, bsz=32, num_updates=33750, lr=6.58382e-06, gnorm=3.07, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69689
2022-05-09 16:10:38 - progress_bar.py[line:272] - INFO: epoch 002:  16097 / 17711 loss=2.923, loss_v1=0, loss_v2=0, nll_loss=0.701, ntokens=385.9, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.923, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.917, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=222.9, ups=0.58, wpb=385.9, bsz=32, num_updates=33760, lr=6.58261e-06, gnorm=3.372, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69706
2022-05-09 16:10:55 - progress_bar.py[line:272] - INFO: epoch 002:  16107 / 17711 loss=2.92, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=373.7, nsentences=32, sample_size=297.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.92, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.703, expert1_balance_bottom=19.34, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=217, ups=0.58, wpb=373.7, bsz=32, num_updates=33770, lr=6.58141e-06, gnorm=3.12, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69723
2022-05-09 16:11:13 - progress_bar.py[line:272] - INFO: epoch 002:  16117 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897838, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.618, expert1_balance_bottom=19.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=216.8, ups=0.57, wpb=378.8, bsz=32, num_updates=33780, lr=6.58021e-06, gnorm=3.146, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69741
2022-05-09 16:11:30 - progress_bar.py[line:272] - INFO: epoch 002:  16127 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893995, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.908, expert1_balance_bottom=19.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.9, ups=0.58, wpb=381.1, bsz=32, num_updates=33790, lr=6.57901e-06, gnorm=4.118, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69758
2022-05-09 16:11:47 - progress_bar.py[line:272] - INFO: epoch 002:  16137 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=377.4, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89212, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.653, expert1_balance_bottom=19.52, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=217.2, ups=0.58, wpb=377.4, bsz=32, num_updates=33800, lr=6.57781e-06, gnorm=3.467, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69776
2022-05-09 16:12:05 - progress_bar.py[line:272] - INFO: epoch 002:  16147 / 17711 loss=2.943, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=381.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.943, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.68, expert1_balance_bottom=19.238, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=222.5, ups=0.58, wpb=381.8, bsz=32, num_updates=33810, lr=6.57661e-06, gnorm=3.141, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69793
2022-05-09 16:12:22 - progress_bar.py[line:272] - INFO: epoch 002:  16157 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890552, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.82, expert1_balance_bottom=19.618, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.2, ups=0.58, wpb=381.2, bsz=32, num_updates=33820, lr=6.57541e-06, gnorm=3.513, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69810
2022-05-09 16:12:39 - progress_bar.py[line:272] - INFO: epoch 002:  16167 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=379.8, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897449, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.198, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=217.5, ups=0.57, wpb=379.8, bsz=32, num_updates=33830, lr=6.57421e-06, gnorm=3.639, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69827
2022-05-09 16:12:57 - progress_bar.py[line:272] - INFO: epoch 002:  16177 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=393.5, nsentences=32, sample_size=313.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.542, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=227.5, ups=0.58, wpb=393.5, bsz=32, num_updates=33840, lr=6.573e-06, gnorm=3.428, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69845
2022-05-09 16:13:14 - progress_bar.py[line:272] - INFO: epoch 002:  16187 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=384.6, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=35.064, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.6, ups=0.57, wpb=384.6, bsz=32, num_updates=33850, lr=6.5718e-06, gnorm=3.356, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69862
2022-05-09 16:13:32 - progress_bar.py[line:272] - INFO: epoch 002:  16197 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=376.5, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=33.916, expert1_balance_bottom=19.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=213.7, ups=0.57, wpb=376.5, bsz=32, num_updates=33860, lr=6.5706e-06, gnorm=3.24, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69880
2022-05-09 16:13:50 - progress_bar.py[line:272] - INFO: epoch 002:  16207 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=377.6, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891255, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.256, expert1_balance_bottom=19.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=208.9, ups=0.55, wpb=377.6, bsz=32, num_updates=33870, lr=6.5694e-06, gnorm=3.454, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69898
2022-05-09 16:14:07 - progress_bar.py[line:272] - INFO: epoch 002:  16217 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885892, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.398, expert1_balance_bottom=19.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.3, ups=0.58, wpb=380.6, bsz=32, num_updates=33880, lr=6.5682e-06, gnorm=3.373, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69915
2022-05-09 16:14:25 - progress_bar.py[line:272] - INFO: epoch 002:  16227 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=384.2, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=34.204, expert1_balance_bottom=19.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.3, ups=0.57, wpb=384.2, bsz=32, num_updates=33890, lr=6.567e-06, gnorm=3.443, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69933
2022-05-09 16:14:42 - progress_bar.py[line:272] - INFO: epoch 002:  16237 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=387, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890026, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.183, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.5, ups=0.57, wpb=387, bsz=32, num_updates=33900, lr=6.5658e-06, gnorm=2.952, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69950
2022-05-09 16:15:00 - progress_bar.py[line:272] - INFO: epoch 002:  16247 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.539, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.5, ups=0.57, wpb=383.9, bsz=32, num_updates=33910, lr=6.56459e-06, gnorm=3.151, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69968
2022-05-09 16:15:17 - progress_bar.py[line:272] - INFO: epoch 002:  16257 / 17711 loss=2.943, loss_v1=0, loss_v2=0, nll_loss=0.71, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895783, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.943, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=33.869, expert1_balance_bottom=19.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=223.6, ups=0.58, wpb=386.8, bsz=32, num_updates=33920, lr=6.56339e-06, gnorm=2.872, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=69985
2022-05-09 16:15:34 - progress_bar.py[line:272] - INFO: epoch 002:  16267 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=393, nsentences=32, sample_size=312.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881531, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.357, expert1_balance_bottom=19.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=230.1, ups=0.59, wpb=393, bsz=32, num_updates=33930, lr=6.56219e-06, gnorm=4.116, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70002
2022-05-09 16:15:51 - progress_bar.py[line:272] - INFO: epoch 002:  16277 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=382.9, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878304, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.695, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=223.8, ups=0.58, wpb=382.9, bsz=32, num_updates=33940, lr=6.56099e-06, gnorm=3.138, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70019
2022-05-09 16:16:09 - progress_bar.py[line:272] - INFO: epoch 002:  16287 / 17711 loss=2.932, loss_v1=0, loss_v2=0, nll_loss=0.711, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.932, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.469, expert1_balance_bottom=19.446, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=216.2, ups=0.57, wpb=380.6, bsz=32, num_updates=33950, lr=6.55979e-06, gnorm=2.887, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70037
2022-05-09 16:16:26 - progress_bar.py[line:272] - INFO: epoch 002:  16297 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=382.4, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.917, expert1_balance_bottom=19.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=219.3, ups=0.57, wpb=382.4, bsz=32, num_updates=33960, lr=6.55859e-06, gnorm=3.225, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70054
2022-05-09 16:16:44 - progress_bar.py[line:272] - INFO: epoch 002:  16307 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=390.6, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.631, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.7, ups=0.57, wpb=390.6, bsz=32, num_updates=33970, lr=6.55739e-06, gnorm=3.208, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70072
2022-05-09 16:17:01 - progress_bar.py[line:272] - INFO: epoch 002:  16317 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=380.5, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.836, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216.9, ups=0.57, wpb=380.5, bsz=32, num_updates=33980, lr=6.55619e-06, gnorm=3.635, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70089
2022-05-09 16:17:19 - progress_bar.py[line:272] - INFO: epoch 002:  16327 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=378.5, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.825, expert1_balance_bottom=19.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=210, ups=0.55, wpb=378.5, bsz=32, num_updates=33990, lr=6.55498e-06, gnorm=3.69, loss_scale=256, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70107
2022-05-09 16:17:21 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-09 16:17:39 - progress_bar.py[line:272] - INFO: epoch 002:  16338 / 17711 loss=2.926, loss_v1=0, loss_v2=0, nll_loss=0.689, ntokens=376.4, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896677, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.926, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.975, expert1_balance_bottom=19.292, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=194.5, ups=0.52, wpb=376.4, bsz=32, num_updates=34000, lr=6.55378e-06, gnorm=3.041, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70127
2022-05-09 16:17:39 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 16:17:39 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 16:17:39 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 16:24:53 - train.py[line:517] - INFO: valid_step finished
2022-05-09 16:24:53 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 10.116 | loss_v1 0 | loss_v2 0 | nll_loss 8.449 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.00456 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.116 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.173 | expert1_balance_top 40.663 | expert1_balance_bottom 15.06 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 349.35 | cider 1.196 | wps 694.6 | wpb 481.7 | bsz 8 | num_updates 34000 | best_cider 1.198
2022-05-09 16:25:10 - progress_bar.py[line:272] - INFO: epoch 002:  16348 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=379.9, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889411, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.195, expert1_balance_bottom=19.397, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=8.4, ups=0.02, wpb=379.9, bsz=32, num_updates=34010, lr=6.55258e-06, gnorm=3.272, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70578
2022-05-09 16:25:28 - progress_bar.py[line:272] - INFO: epoch 002:  16358 / 17711 loss=2.929, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=382.3, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887063, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.929, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.811, expert1_balance_bottom=19.582, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=215.7, ups=0.56, wpb=382.3, bsz=32, num_updates=34020, lr=6.55138e-06, gnorm=2.745, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70596
2022-05-09 16:25:46 - progress_bar.py[line:272] - INFO: epoch 002:  16368 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.414, expert1_balance_bottom=19.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=222, ups=0.57, wpb=388.3, bsz=32, num_updates=34030, lr=6.55018e-06, gnorm=3.329, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70614
2022-05-09 16:26:03 - progress_bar.py[line:272] - INFO: epoch 002:  16378 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900498, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.209, expert1_balance_bottom=19.623, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=222, ups=0.58, wpb=379.5, bsz=32, num_updates=34040, lr=6.54898e-06, gnorm=3.564, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70631
2022-05-09 16:26:20 - progress_bar.py[line:272] - INFO: epoch 002:  16388 / 17711 loss=2.924, loss_v1=0, loss_v2=0, nll_loss=0.69, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.924, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=33.972, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=221.2, ups=0.58, wpb=384.1, bsz=32, num_updates=34050, lr=6.54778e-06, gnorm=2.92, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70648
2022-05-09 16:26:37 - progress_bar.py[line:272] - INFO: epoch 002:  16398 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884111, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.136, expert1_balance_bottom=19.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=223.6, ups=0.58, wpb=386.5, bsz=32, num_updates=34060, lr=6.54658e-06, gnorm=3.23, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70665
2022-05-09 16:26:55 - progress_bar.py[line:272] - INFO: epoch 002:  16408 / 17711 loss=2.894, loss_v1=0, loss_v2=0, nll_loss=0.675, ntokens=384.3, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.894, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.642, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=220.2, ups=0.57, wpb=384.3, bsz=32, num_updates=34070, lr=6.54537e-06, gnorm=3.005, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70683
2022-05-09 16:27:12 - progress_bar.py[line:272] - INFO: epoch 002:  16418 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879761, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.909, expert1_balance_bottom=19.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=217.7, ups=0.58, wpb=378.1, bsz=32, num_updates=34080, lr=6.54417e-06, gnorm=3.824, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70700
2022-05-09 16:27:30 - progress_bar.py[line:272] - INFO: epoch 002:  16428 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=385.2, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89236, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.92, expert1_balance_bottom=19.385, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=217.8, ups=0.57, wpb=385.2, bsz=32, num_updates=34090, lr=6.54297e-06, gnorm=4.513, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70718
2022-05-09 16:27:48 - progress_bar.py[line:272] - INFO: epoch 002:  16438 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.76, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=213, ups=0.56, wpb=378.5, bsz=32, num_updates=34100, lr=6.54177e-06, gnorm=3.214, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70736
2022-05-09 16:28:05 - progress_bar.py[line:272] - INFO: epoch 002:  16448 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=382.9, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879388, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.751, expert1_balance_bottom=19.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=215.5, ups=0.56, wpb=382.9, bsz=32, num_updates=34110, lr=6.54057e-06, gnorm=3.188, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70753
2022-05-09 16:28:23 - progress_bar.py[line:272] - INFO: epoch 002:  16458 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.965, expert1_balance_bottom=19.528, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=216.9, ups=0.56, wpb=384.4, bsz=32, num_updates=34120, lr=6.53937e-06, gnorm=3.44, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70771
2022-05-09 16:28:40 - progress_bar.py[line:272] - INFO: epoch 002:  16468 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=381.3, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.355, expert1_balance_bottom=19.366, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.8, ups=0.58, wpb=381.3, bsz=32, num_updates=34130, lr=6.53817e-06, gnorm=3.509, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70788
2022-05-09 16:28:58 - progress_bar.py[line:272] - INFO: epoch 002:  16478 / 17711 loss=2.944, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=381.4, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887273, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.911, expert1_balance_bottom=19.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=215.5, ups=0.57, wpb=381.4, bsz=32, num_updates=34140, lr=6.53696e-06, gnorm=3.271, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70806
2022-05-09 16:29:15 - progress_bar.py[line:272] - INFO: epoch 002:  16488 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=392, nsentences=32, sample_size=312, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872269, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.965, expert1_balance_bottom=19.239, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=222.8, ups=0.57, wpb=392, bsz=32, num_updates=34150, lr=6.53576e-06, gnorm=3.273, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70824
2022-05-09 16:29:33 - progress_bar.py[line:272] - INFO: epoch 002:  16498 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8804, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.131, expert1_balance_bottom=19.63, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=218.3, ups=0.56, wpb=386.8, bsz=32, num_updates=34160, lr=6.53456e-06, gnorm=3.452, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70841
2022-05-09 16:29:52 - progress_bar.py[line:272] - INFO: epoch 002:  16508 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.56, expert1_balance_bottom=19.758, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=206.9, ups=0.54, wpb=379.9, bsz=32, num_updates=34170, lr=6.53336e-06, gnorm=3.685, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70860
2022-05-09 16:30:09 - progress_bar.py[line:272] - INFO: epoch 002:  16518 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=395.4, nsentences=32, sample_size=314.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.439, expert1_balance_bottom=19.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=228.9, ups=0.58, wpb=395.4, bsz=32, num_updates=34180, lr=6.53216e-06, gnorm=3.257, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70877
2022-05-09 16:30:26 - progress_bar.py[line:272] - INFO: epoch 002:  16528 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=387.2, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869775, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.545, expert1_balance_bottom=19.002, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=226.4, ups=0.58, wpb=387.2, bsz=32, num_updates=34190, lr=6.53096e-06, gnorm=3.85, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70894
2022-05-09 16:30:43 - progress_bar.py[line:272] - INFO: epoch 002:  16538 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=376.8, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88939, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.102, expert1_balance_bottom=19.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=220.8, ups=0.59, wpb=376.8, bsz=32, num_updates=34200, lr=6.52976e-06, gnorm=3.451, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70911
2022-05-09 16:31:00 - progress_bar.py[line:272] - INFO: epoch 002:  16548 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.712, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=223.7, ups=0.58, wpb=382.9, bsz=32, num_updates=34210, lr=6.52856e-06, gnorm=3.449, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70928
2022-05-09 16:31:17 - progress_bar.py[line:272] - INFO: epoch 002:  16558 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=388.5, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882579, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.67, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=226.5, ups=0.58, wpb=388.5, bsz=32, num_updates=34220, lr=6.52735e-06, gnorm=3.507, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70945
2022-05-09 16:31:35 - progress_bar.py[line:272] - INFO: epoch 002:  16568 / 17711 loss=2.92, loss_v1=0, loss_v2=0, nll_loss=0.705, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880635, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.92, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.889, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=219.1, ups=0.57, wpb=383.2, bsz=32, num_updates=34230, lr=6.52615e-06, gnorm=3.502, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70963
2022-05-09 16:31:52 - progress_bar.py[line:272] - INFO: epoch 002:  16578 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=384.5, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894626, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.854, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=224.6, ups=0.58, wpb=384.5, bsz=32, num_updates=34240, lr=6.52495e-06, gnorm=4.025, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70980
2022-05-09 16:32:09 - progress_bar.py[line:272] - INFO: epoch 002:  16588 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=383.3, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.167, expert1_balance_bottom=19.456, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.7, ups=0.58, wpb=383.3, bsz=32, num_updates=34250, lr=6.52375e-06, gnorm=4.18, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=70997
2022-05-09 16:32:26 - progress_bar.py[line:272] - INFO: epoch 002:  16598 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=373.6, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.013, expert1_balance_bottom=19.709, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=215.6, ups=0.58, wpb=373.6, bsz=32, num_updates=34260, lr=6.52255e-06, gnorm=3.072, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71015
2022-05-09 16:32:44 - progress_bar.py[line:272] - INFO: epoch 002:  16608 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.716, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.583, expert1_balance_bottom=19.576, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=220.2, ups=0.58, wpb=378.8, bsz=32, num_updates=34270, lr=6.52135e-06, gnorm=3.205, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71032
2022-05-09 16:33:01 - progress_bar.py[line:272] - INFO: epoch 002:  16618 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=389.5, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.9, expert1_balance_bottom=19.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=220.3, ups=0.57, wpb=389.5, bsz=32, num_updates=34280, lr=6.52015e-06, gnorm=3.659, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71049
2022-05-09 16:33:19 - progress_bar.py[line:272] - INFO: epoch 002:  16628 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.383, expert1_balance_bottom=19.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=219.8, ups=0.57, wpb=384.1, bsz=32, num_updates=34290, lr=6.51894e-06, gnorm=3.565, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71067
2022-05-09 16:33:36 - progress_bar.py[line:272] - INFO: epoch 002:  16638 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898478, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.773, expert1_balance_bottom=19.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=220.3, ups=0.58, wpb=381.8, bsz=32, num_updates=34300, lr=6.51774e-06, gnorm=3.568, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71084
2022-05-09 16:33:54 - progress_bar.py[line:272] - INFO: epoch 002:  16648 / 17711 loss=2.942, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887324, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.942, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.72, expert1_balance_bottom=19.26, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=220.6, ups=0.57, wpb=385, bsz=32, num_updates=34310, lr=6.51654e-06, gnorm=3.446, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71102
2022-05-09 16:34:11 - progress_bar.py[line:272] - INFO: epoch 002:  16658 / 17711 loss=2.944, loss_v1=0, loss_v2=0, nll_loss=0.72, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886637, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.225, expert1_balance_bottom=19.499, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=214.9, ups=0.56, wpb=380.9, bsz=32, num_updates=34320, lr=6.51534e-06, gnorm=3.292, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71119
2022-05-09 16:34:29 - progress_bar.py[line:272] - INFO: epoch 002:  16668 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=378.8, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.329, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=216.5, ups=0.57, wpb=378.8, bsz=32, num_updates=34330, lr=6.51414e-06, gnorm=4.092, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71137
2022-05-09 16:34:46 - progress_bar.py[line:272] - INFO: epoch 002:  16678 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.441, expert1_balance_bottom=18.957, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.7, ups=0.58, wpb=384.4, bsz=32, num_updates=34340, lr=6.51294e-06, gnorm=4.11, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71154
2022-05-09 16:35:03 - progress_bar.py[line:272] - INFO: epoch 002:  16688 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=375.9, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881252, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.663, expert1_balance_bottom=19.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219, ups=0.58, wpb=375.9, bsz=32, num_updates=34350, lr=6.51174e-06, gnorm=3.652, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71171
2022-05-09 16:35:20 - progress_bar.py[line:272] - INFO: epoch 002:  16698 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884747, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.443, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.7, ups=0.58, wpb=384.1, bsz=32, num_updates=34360, lr=6.51054e-06, gnorm=3.649, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71188
2022-05-09 16:35:38 - progress_bar.py[line:272] - INFO: epoch 002:  16708 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=382.2, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883045, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.618, expert1_balance_bottom=19.16, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.3, ups=0.58, wpb=382.2, bsz=32, num_updates=34370, lr=6.50933e-06, gnorm=3.749, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71206
2022-05-09 16:35:55 - progress_bar.py[line:272] - INFO: epoch 002:  16718 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=390.7, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.956, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=226.5, ups=0.58, wpb=390.7, bsz=32, num_updates=34380, lr=6.50813e-06, gnorm=3.38, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71223
2022-05-09 16:36:12 - progress_bar.py[line:272] - INFO: epoch 002:  16728 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=374.4, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=34.31, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=218.3, ups=0.58, wpb=374.4, bsz=32, num_updates=34390, lr=6.50693e-06, gnorm=3.518, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71240
2022-05-09 16:36:29 - progress_bar.py[line:272] - INFO: epoch 002:  16738 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=378.2, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875871, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=35.538, expert1_balance_bottom=19.094, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=218, ups=0.58, wpb=378.2, bsz=32, num_updates=34400, lr=6.50573e-06, gnorm=2.898, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71257
2022-05-09 16:36:47 - progress_bar.py[line:272] - INFO: epoch 002:  16748 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=376.7, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887204, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.484, expert1_balance_bottom=19.404, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.7, ups=0.59, wpb=376.7, bsz=32, num_updates=34410, lr=6.50453e-06, gnorm=3.53, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71275
2022-05-09 16:37:04 - progress_bar.py[line:272] - INFO: epoch 002:  16758 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.699, ntokens=374.2, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905662, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.12, expert1_balance_top=33.189, expert1_balance_bottom=19.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=212.4, ups=0.57, wpb=374.2, bsz=32, num_updates=34420, lr=6.50333e-06, gnorm=3.092, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71292
2022-05-09 16:37:22 - progress_bar.py[line:272] - INFO: epoch 002:  16768 / 17711 loss=2.922, loss_v1=0, loss_v2=0, nll_loss=0.72, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.922, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.742, expert1_balance_bottom=19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=220.1, ups=0.57, wpb=385.4, bsz=32, num_updates=34430, lr=6.50213e-06, gnorm=3.048, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71310
2022-05-09 16:37:39 - progress_bar.py[line:272] - INFO: epoch 002:  16778 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.513, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.3, ups=0.58, wpb=380.9, bsz=32, num_updates=34440, lr=6.50093e-06, gnorm=3.512, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71327
2022-05-09 16:37:56 - progress_bar.py[line:272] - INFO: epoch 002:  16788 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.733, expert1_balance_bottom=19.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=222, ups=0.58, wpb=379.6, bsz=32, num_updates=34450, lr=6.49972e-06, gnorm=3.655, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71344
2022-05-09 16:38:14 - progress_bar.py[line:272] - INFO: epoch 002:  16798 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=383.2, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88836, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.131, expert1_balance_bottom=19.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.1, ups=0.57, wpb=383.2, bsz=32, num_updates=34460, lr=6.49852e-06, gnorm=3.426, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71362
2022-05-09 16:38:31 - progress_bar.py[line:272] - INFO: epoch 002:  16808 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.116, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=219.7, ups=0.58, wpb=377.5, bsz=32, num_updates=34470, lr=6.49732e-06, gnorm=3.051, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71379
2022-05-09 16:38:48 - progress_bar.py[line:272] - INFO: epoch 002:  16818 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=385, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884931, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.36, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=221.1, ups=0.57, wpb=385, bsz=32, num_updates=34480, lr=6.49612e-06, gnorm=3.58, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71396
2022-05-09 16:39:06 - progress_bar.py[line:272] - INFO: epoch 002:  16828 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890028, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.296, expert1_balance_bottom=19.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=215.8, ups=0.57, wpb=379.5, bsz=32, num_updates=34490, lr=6.49492e-06, gnorm=3.185, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71414
2022-05-09 16:39:23 - progress_bar.py[line:272] - INFO: epoch 002:  16838 / 17711 loss=2.919, loss_v1=0, loss_v2=0, nll_loss=0.706, ntokens=375.6, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.919, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=35.529, expert1_balance_bottom=19.026, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=214.3, ups=0.57, wpb=375.6, bsz=32, num_updates=34500, lr=6.49372e-06, gnorm=3.527, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71431
2022-05-09 16:39:41 - progress_bar.py[line:272] - INFO: epoch 002:  16848 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=391.4, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879186, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.684, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=225.9, ups=0.58, wpb=391.4, bsz=32, num_updates=34510, lr=6.49252e-06, gnorm=3.131, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71449
2022-05-09 16:39:58 - progress_bar.py[line:272] - INFO: epoch 002:  16858 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=382.3, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877903, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.869, expert1_balance_bottom=19.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.5, ups=0.58, wpb=382.3, bsz=32, num_updates=34520, lr=6.49131e-06, gnorm=3.916, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71466
2022-05-09 16:40:16 - progress_bar.py[line:272] - INFO: epoch 002:  16868 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=377.3, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=34.257, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.4, ups=0.57, wpb=377.3, bsz=32, num_updates=34530, lr=6.49011e-06, gnorm=3.444, loss_scale=256, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71484
2022-05-09 16:40:23 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 128.0
2022-05-09 16:40:35 - progress_bar.py[line:272] - INFO: epoch 002:  16879 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=369.7, nsentences=32, sample_size=294.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.91482, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.127, expert1_balance_top=32.574, expert1_balance_bottom=19.889, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=188.8, ups=0.51, wpb=369.7, bsz=32, num_updates=34540, lr=6.48891e-06, gnorm=3.076, loss_scale=128, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71503
2022-05-09 16:40:53 - progress_bar.py[line:272] - INFO: epoch 002:  16889 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=384.4, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879898, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.371, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.9, ups=0.57, wpb=384.4, bsz=32, num_updates=34550, lr=6.48771e-06, gnorm=3.537, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71521
2022-05-09 16:41:10 - progress_bar.py[line:272] - INFO: epoch 002:  16899 / 17711 loss=2.936, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876707, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.936, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.692, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=221.6, ups=0.58, wpb=384.4, bsz=32, num_updates=34560, lr=6.48651e-06, gnorm=3.148, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71538
2022-05-09 16:41:27 - progress_bar.py[line:272] - INFO: epoch 002:  16909 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=388.8, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.858759, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=35.827, expert1_balance_bottom=18.917, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=223, ups=0.57, wpb=388.8, bsz=32, num_updates=34570, lr=6.48531e-06, gnorm=3.975, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71556
2022-05-09 16:41:45 - progress_bar.py[line:272] - INFO: epoch 002:  16919 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.172, expert1_balance_bottom=19.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=217.9, ups=0.57, wpb=380.9, bsz=32, num_updates=34580, lr=6.48411e-06, gnorm=3.863, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71573
2022-05-09 16:42:02 - progress_bar.py[line:272] - INFO: epoch 002:  16929 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=376.9, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901595, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.121, expert1_balance_top=33.298, expert1_balance_bottom=19.694, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=215, ups=0.57, wpb=376.9, bsz=32, num_updates=34590, lr=6.48291e-06, gnorm=3.333, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71591
2022-05-09 16:42:20 - progress_bar.py[line:272] - INFO: epoch 002:  16939 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883245, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.463, expert1_balance_bottom=19.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.3, ups=0.56, wpb=382.7, bsz=32, num_updates=34600, lr=6.4817e-06, gnorm=3.819, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71608
2022-05-09 16:42:38 - progress_bar.py[line:272] - INFO: epoch 002:  16949 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=386.1, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878077, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.214, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.5, ups=0.57, wpb=386.1, bsz=32, num_updates=34610, lr=6.4805e-06, gnorm=4.44, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71626
2022-05-09 16:42:55 - progress_bar.py[line:272] - INFO: epoch 002:  16959 / 17711 loss=2.948, loss_v1=0, loss_v2=0, nll_loss=0.712, ntokens=381.5, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.948, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.124, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=217.8, ups=0.57, wpb=381.5, bsz=32, num_updates=34620, lr=6.4793e-06, gnorm=5.365, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71644
2022-05-09 16:43:13 - progress_bar.py[line:272] - INFO: epoch 002:  16969 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.217, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=220.5, ups=0.58, wpb=380.7, bsz=32, num_updates=34630, lr=6.4781e-06, gnorm=3.787, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71661
2022-05-09 16:43:30 - progress_bar.py[line:272] - INFO: epoch 002:  16979 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.289, expert1_balance_bottom=19.417, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223.6, ups=0.58, wpb=383.8, bsz=32, num_updates=34640, lr=6.4769e-06, gnorm=3.665, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71678
2022-05-09 16:43:47 - progress_bar.py[line:272] - INFO: epoch 002:  16989 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=378.4, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892935, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.478, expert1_balance_bottom=19.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.2, ups=0.57, wpb=378.4, bsz=32, num_updates=34650, lr=6.4757e-06, gnorm=4.761, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71696
2022-05-09 16:44:05 - progress_bar.py[line:272] - INFO: epoch 002:  16999 / 17711 loss=2.889, loss_v1=0, loss_v2=0, nll_loss=0.662, ntokens=377.3, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885186, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.889, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.834, expert1_balance_bottom=19.021, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.58, wps=213.4, ups=0.57, wpb=377.3, bsz=32, num_updates=34660, lr=6.4745e-06, gnorm=2.965, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71713
2022-05-09 16:44:23 - progress_bar.py[line:272] - INFO: epoch 002:  17009 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=374.3, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892862, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.253, expert1_balance_bottom=19.362, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213, ups=0.57, wpb=374.3, bsz=32, num_updates=34670, lr=6.47329e-06, gnorm=3.368, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71731
2022-05-09 16:44:40 - progress_bar.py[line:272] - INFO: epoch 002:  17019 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.384, expert1_balance_bottom=19.287, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=217.9, ups=0.57, wpb=382.8, bsz=32, num_updates=34680, lr=6.47209e-06, gnorm=3.494, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71748
2022-05-09 16:44:58 - progress_bar.py[line:272] - INFO: epoch 002:  17029 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.841, expert1_balance_bottom=19.341, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=221, ups=0.58, wpb=383.6, bsz=32, num_updates=34690, lr=6.47089e-06, gnorm=3.147, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71766
2022-05-09 16:45:15 - progress_bar.py[line:272] - INFO: epoch 002:  17039 / 17711 loss=2.94, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880099, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.94, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.35, expert1_balance_bottom=19.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=217.3, ups=0.57, wpb=383.7, bsz=32, num_updates=34700, lr=6.46969e-06, gnorm=3.475, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71783
2022-05-09 16:45:33 - progress_bar.py[line:272] - INFO: epoch 002:  17049 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885192, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.643, expert1_balance_bottom=19.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=212.8, ups=0.56, wpb=380.2, bsz=32, num_updates=34710, lr=6.46849e-06, gnorm=3.182, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71801
2022-05-09 16:45:51 - progress_bar.py[line:272] - INFO: epoch 002:  17059 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=369.5, nsentences=32, sample_size=294, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=33.989, expert1_balance_bottom=19.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=201.8, ups=0.55, wpb=369.5, bsz=32, num_updates=34720, lr=6.46729e-06, gnorm=3.296, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71820
2022-05-09 16:46:09 - progress_bar.py[line:272] - INFO: epoch 002:  17069 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=376.4, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883587, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.722, expert1_balance_bottom=19.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.1, ups=0.58, wpb=376.4, bsz=32, num_updates=34730, lr=6.46609e-06, gnorm=3.367, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71837
2022-05-09 16:46:26 - progress_bar.py[line:272] - INFO: epoch 002:  17079 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=379.9, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.865582, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=35.424, expert1_balance_bottom=19.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.2, ups=0.58, wpb=379.9, bsz=32, num_updates=34740, lr=6.46489e-06, gnorm=3.379, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71854
2022-05-09 16:46:44 - progress_bar.py[line:272] - INFO: epoch 002:  17089 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881321, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.464, expert1_balance_bottom=19.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=218.3, ups=0.57, wpb=382.8, bsz=32, num_updates=34750, lr=6.46368e-06, gnorm=3.368, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71872
2022-05-09 16:47:01 - progress_bar.py[line:272] - INFO: epoch 002:  17099 / 17711 loss=2.908, loss_v1=0, loss_v2=0, nll_loss=0.674, ntokens=388.7, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.908, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=33.937, expert1_balance_bottom=19.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=227.5, ups=0.59, wpb=388.7, bsz=32, num_updates=34760, lr=6.46248e-06, gnorm=2.955, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71889
2022-05-09 16:47:18 - progress_bar.py[line:272] - INFO: epoch 002:  17109 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=385.1, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893687, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=33.266, expert1_balance_bottom=19.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=223, ups=0.58, wpb=385.1, bsz=32, num_updates=34770, lr=6.46128e-06, gnorm=4.201, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71906
2022-05-09 16:47:35 - progress_bar.py[line:272] - INFO: epoch 002:  17119 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=387.9, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887867, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.266, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=227.4, ups=0.59, wpb=387.9, bsz=32, num_updates=34780, lr=6.46008e-06, gnorm=3.519, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71923
2022-05-09 16:47:52 - progress_bar.py[line:272] - INFO: epoch 002:  17129 / 17711 loss=2.943, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=380.1, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886494, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.943, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.059, expert1_balance_bottom=19.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=221.1, ups=0.58, wpb=380.1, bsz=32, num_updates=34790, lr=6.45888e-06, gnorm=3.932, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71940
2022-05-09 16:48:09 - progress_bar.py[line:272] - INFO: epoch 002:  17139 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=378.7, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.135, expert1_balance_bottom=19.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=220.1, ups=0.58, wpb=378.7, bsz=32, num_updates=34800, lr=6.45768e-06, gnorm=3.787, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71957
2022-05-09 16:48:27 - progress_bar.py[line:272] - INFO: epoch 002:  17149 / 17711 loss=2.939, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877269, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.939, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.009, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=223.4, ups=0.58, wpb=383.8, bsz=32, num_updates=34810, lr=6.45648e-06, gnorm=3.86, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71975
2022-05-09 16:48:44 - progress_bar.py[line:272] - INFO: epoch 002:  17159 / 17711 loss=2.925, loss_v1=0, loss_v2=0, nll_loss=0.689, ntokens=381.7, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.925, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.781, expert1_balance_bottom=19.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=222.2, ups=0.58, wpb=381.7, bsz=32, num_updates=34820, lr=6.45527e-06, gnorm=3.629, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=71992
2022-05-09 16:49:01 - progress_bar.py[line:272] - INFO: epoch 002:  17169 / 17711 loss=2.927, loss_v1=0, loss_v2=0, nll_loss=0.692, ntokens=375.6, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899033, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.927, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.118, expert1_balance_top=33.916, expert1_balance_bottom=19.351, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=217.3, ups=0.58, wpb=375.6, bsz=32, num_updates=34830, lr=6.45407e-06, gnorm=3.68, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72009
2022-05-09 16:49:18 - progress_bar.py[line:272] - INFO: epoch 002:  17179 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=380.3, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889899, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.11, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=220.8, ups=0.58, wpb=380.3, bsz=32, num_updates=34840, lr=6.45287e-06, gnorm=3.521, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72026
2022-05-09 16:49:35 - progress_bar.py[line:272] - INFO: epoch 002:  17189 / 17711 loss=2.93, loss_v1=0, loss_v2=0, nll_loss=0.692, ntokens=391.9, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895432, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.93, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=33.883, expert1_balance_bottom=19.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=229.9, ups=0.59, wpb=391.9, bsz=32, num_updates=34850, lr=6.45167e-06, gnorm=3.229, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72043
2022-05-09 16:49:52 - progress_bar.py[line:272] - INFO: epoch 002:  17199 / 17711 loss=2.923, loss_v1=0, loss_v2=0, nll_loss=0.703, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879462, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.923, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.151, expert1_balance_bottom=19.097, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=223.9, ups=0.59, wpb=382.2, bsz=32, num_updates=34860, lr=6.45047e-06, gnorm=3.474, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72060
2022-05-09 16:50:10 - progress_bar.py[line:272] - INFO: epoch 002:  17209 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.354, expert1_balance_bottom=19.374, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=221.4, ups=0.58, wpb=381.7, bsz=32, num_updates=34870, lr=6.44927e-06, gnorm=3.597, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72078
2022-05-09 16:50:27 - progress_bar.py[line:272] - INFO: epoch 002:  17219 / 17711 loss=2.898, loss_v1=0, loss_v2=0, nll_loss=0.675, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.898, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.571, expert1_balance_bottom=19.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=223.8, ups=0.59, wpb=381.7, bsz=32, num_updates=34880, lr=6.44807e-06, gnorm=3.397, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72095
2022-05-09 16:50:44 - progress_bar.py[line:272] - INFO: epoch 002:  17229 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=385.5, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884254, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.697, expert1_balance_bottom=19.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=223.6, ups=0.58, wpb=385.5, bsz=32, num_updates=34890, lr=6.44687e-06, gnorm=3.696, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72112
2022-05-09 16:51:01 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 16:51:03 - progress_bar.py[line:272] - INFO: epoch 002:  17240 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=383.8, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88069, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.696, expert1_balance_bottom=19.193, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=201.3, ups=0.52, wpb=383.8, bsz=32, num_updates=34900, lr=6.44566e-06, gnorm=4.486, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72131
2022-05-09 16:51:20 - progress_bar.py[line:272] - INFO: epoch 002:  17250 / 17711 loss=2.94, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885291, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.94, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.126, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=223, ups=0.58, wpb=386, bsz=32, num_updates=34910, lr=6.44446e-06, gnorm=3.041, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72148
2022-05-09 16:51:38 - progress_bar.py[line:272] - INFO: epoch 002:  17260 / 17711 loss=2.891, loss_v1=0, loss_v2=0, nll_loss=0.653, ntokens=377, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.891, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.901, expert1_balance_bottom=19.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.57, wps=212.2, ups=0.56, wpb=377, bsz=32, num_updates=34920, lr=6.44326e-06, gnorm=3.24, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72166
2022-05-09 16:51:55 - progress_bar.py[line:272] - INFO: epoch 002:  17270 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=376.4, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885781, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.494, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.1, ups=0.58, wpb=376.4, bsz=32, num_updates=34930, lr=6.44206e-06, gnorm=3.385, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72183
2022-05-09 16:52:12 - progress_bar.py[line:272] - INFO: epoch 002:  17280 / 17711 loss=2.891, loss_v1=0, loss_v2=0, nll_loss=0.656, ntokens=377, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.891, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.107, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.58, wps=219.1, ups=0.58, wpb=377, bsz=32, num_updates=34940, lr=6.44086e-06, gnorm=3.233, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72200
2022-05-09 16:52:30 - progress_bar.py[line:272] - INFO: epoch 002:  17290 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=384, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.014, expert1_balance_bottom=19.383, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=221.3, ups=0.58, wpb=384, bsz=32, num_updates=34950, lr=6.43966e-06, gnorm=3.223, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72218
2022-05-09 16:52:47 - progress_bar.py[line:272] - INFO: epoch 002:  17300 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=387.6, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884847, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.226, expert1_balance_bottom=19.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221.3, ups=0.57, wpb=387.6, bsz=32, num_updates=34960, lr=6.43846e-06, gnorm=3.609, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72235
2022-05-09 16:53:05 - progress_bar.py[line:272] - INFO: epoch 002:  17310 / 17711 loss=2.935, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=380.2, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.935, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.476, expert1_balance_bottom=19.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=219.9, ups=0.58, wpb=380.2, bsz=32, num_updates=34970, lr=6.43726e-06, gnorm=4.017, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72253
2022-05-09 16:53:22 - progress_bar.py[line:272] - INFO: epoch 002:  17320 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.324, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.5, ups=0.58, wpb=379.5, bsz=32, num_updates=34980, lr=6.43605e-06, gnorm=3.667, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72270
2022-05-09 16:53:39 - progress_bar.py[line:272] - INFO: epoch 002:  17330 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=378.1, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890064, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.118, expert1_balance_bottom=19.395, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216.1, ups=0.57, wpb=378.1, bsz=32, num_updates=34990, lr=6.43485e-06, gnorm=4.042, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72287
2022-05-09 16:53:57 - progress_bar.py[line:272] - INFO: epoch 002:  17340 / 17711 loss=2.928, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.928, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.648, expert1_balance_bottom=19.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=221.2, ups=0.58, wpb=384.3, bsz=32, num_updates=35000, lr=6.43365e-06, gnorm=3.242, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72305
2022-05-09 16:53:57 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 16:53:57 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 16:53:57 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 17:01:04 - train.py[line:517] - INFO: valid_step finished
2022-05-09 17:01:04 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 10.139 | loss_v1 0 | loss_v2 0 | nll_loss 8.472 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.00346 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.139 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.171 | expert1_balance_top 40.196 | expert1_balance_bottom 15.165 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 354.97 | cider 1.203 | wps 705.4 | wpb 481.7 | bsz 8 | num_updates 35000 | best_cider 1.203
2022-05-09 17:01:04 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 35000 updates
2022-05-09 17:01:04 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_35000-rank-0.pt
2022-05-09 17:01:04 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_35000-rank-0.pt
2022-05-09 17:01:11 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_35000-rank-0.pt
2022-05-09 17:01:11 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_35000-shared.pt
2022-05-09 17:01:19 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_35000-shared.pt
2022-05-09 17:01:52 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_2_35000-rank-0.pt (epoch 2 @ 35000 updates, score 1.203) (writing took 47.93017379939556 seconds)
2022-05-09 17:02:09 - progress_bar.py[line:272] - INFO: epoch 002:  17350 / 17711 loss=2.902, loss_v1=0, loss_v2=0, nll_loss=0.676, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885766, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.902, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.115, expert1_balance_bottom=19.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=7.8, ups=0.02, wpb=384.5, bsz=32, num_updates=35010, lr=6.43245e-06, gnorm=3.44, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72797
2022-05-09 17:02:27 - progress_bar.py[line:272] - INFO: epoch 002:  17360 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=381.4, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883113, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.718, expert1_balance_bottom=19.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=220.5, ups=0.58, wpb=381.4, bsz=32, num_updates=35020, lr=6.43125e-06, gnorm=4.06, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72815
2022-05-09 17:02:44 - progress_bar.py[line:272] - INFO: epoch 002:  17370 / 17711 loss=2.933, loss_v1=0, loss_v2=0, nll_loss=0.713, ntokens=386.4, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880532, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.933, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.492, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=221, ups=0.57, wpb=386.4, bsz=32, num_updates=35030, lr=6.43005e-06, gnorm=3.796, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72832
2022-05-09 17:03:01 - progress_bar.py[line:272] - INFO: epoch 002:  17380 / 17711 loss=2.877, loss_v1=0, loss_v2=0, nll_loss=0.648, ntokens=377.3, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8873, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.877, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.447, expert1_balance_bottom=19.244, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.57, wps=218.2, ups=0.58, wpb=377.3, bsz=32, num_updates=35040, lr=6.42885e-06, gnorm=3.217, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72850
2022-05-09 17:03:19 - progress_bar.py[line:272] - INFO: epoch 002:  17390 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87791, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.701, expert1_balance_bottom=19.161, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=218.8, ups=0.57, wpb=384.3, bsz=32, num_updates=35050, lr=6.42764e-06, gnorm=3.623, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72867
2022-05-09 17:03:36 - progress_bar.py[line:272] - INFO: epoch 002:  17400 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=389.9, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.106, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=227.5, ups=0.58, wpb=389.9, bsz=32, num_updates=35060, lr=6.42644e-06, gnorm=3.659, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72884
2022-05-09 17:03:53 - progress_bar.py[line:272] - INFO: epoch 002:  17410 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.93, expert1_balance_bottom=19.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.3, ups=0.58, wpb=382.2, bsz=32, num_updates=35070, lr=6.42524e-06, gnorm=3.362, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72901
2022-05-09 17:04:11 - progress_bar.py[line:272] - INFO: epoch 002:  17420 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.709, ntokens=383, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890764, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.256, expert1_balance_bottom=19.409, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=222.4, ups=0.58, wpb=383, bsz=32, num_updates=35080, lr=6.42404e-06, gnorm=3.556, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72919
2022-05-09 17:04:29 - progress_bar.py[line:272] - INFO: epoch 002:  17430 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=381.8, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.691, expert1_balance_bottom=19.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=210.9, ups=0.55, wpb=381.8, bsz=32, num_updates=35090, lr=6.42284e-06, gnorm=3.311, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72937
2022-05-09 17:04:46 - progress_bar.py[line:272] - INFO: epoch 002:  17440 / 17711 loss=2.944, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=393.3, nsentences=32, sample_size=313.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.061, expert1_balance_bottom=19.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=223.5, ups=0.57, wpb=393.3, bsz=32, num_updates=35100, lr=6.42164e-06, gnorm=3.339, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72954
2022-05-09 17:05:03 - progress_bar.py[line:272] - INFO: epoch 002:  17450 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888187, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.009, expert1_balance_bottom=19.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=224.8, ups=0.59, wpb=380.8, bsz=32, num_updates=35110, lr=6.42044e-06, gnorm=3.623, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72971
2022-05-09 17:05:20 - progress_bar.py[line:272] - INFO: epoch 002:  17460 / 17711 loss=2.944, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879624, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.422, expert1_balance_bottom=19.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=226.5, ups=0.59, wpb=385.7, bsz=32, num_updates=35120, lr=6.41924e-06, gnorm=3.446, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=72988
2022-05-09 17:05:37 - progress_bar.py[line:272] - INFO: epoch 002:  17470 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=378.2, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.863, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=221, ups=0.58, wpb=378.2, bsz=32, num_updates=35130, lr=6.41803e-06, gnorm=3.487, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73005
2022-05-09 17:05:55 - progress_bar.py[line:272] - INFO: epoch 002:  17480 / 17711 loss=2.931, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=382, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.931, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=33.961, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=220.7, ups=0.58, wpb=382, bsz=32, num_updates=35140, lr=6.41683e-06, gnorm=3.464, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73023
2022-05-09 17:06:03 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 17:06:14 - progress_bar.py[line:272] - INFO: epoch 002:  17491 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=387.5, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895293, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.303, expert1_balance_bottom=19.627, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=204.6, ups=0.53, wpb=387.5, bsz=32, num_updates=35150, lr=6.41563e-06, gnorm=3.983, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73042
2022-05-09 17:06:31 - progress_bar.py[line:272] - INFO: epoch 002:  17501 / 17711 loss=2.921, loss_v1=0, loss_v2=0, nll_loss=0.691, ntokens=373.2, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889374, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.921, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.291, expert1_balance_bottom=19.217, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=218, ups=0.58, wpb=373.2, bsz=32, num_updates=35160, lr=6.41443e-06, gnorm=3.612, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73059
2022-05-09 17:06:48 - progress_bar.py[line:272] - INFO: epoch 002:  17511 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=378.7, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885853, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.121, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=214.5, ups=0.57, wpb=378.7, bsz=32, num_updates=35170, lr=6.41323e-06, gnorm=3.092, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73076
2022-05-09 17:07:06 - progress_bar.py[line:272] - INFO: epoch 002:  17521 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875163, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.746, expert1_balance_bottom=19.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=214.8, ups=0.56, wpb=384.3, bsz=32, num_updates=35180, lr=6.41203e-06, gnorm=3.641, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73094
2022-05-09 17:07:24 - progress_bar.py[line:272] - INFO: epoch 002:  17531 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877626, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.93, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=209.5, ups=0.55, wpb=380.9, bsz=32, num_updates=35190, lr=6.41083e-06, gnorm=3.637, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73113
2022-05-09 17:07:42 - progress_bar.py[line:272] - INFO: epoch 002:  17541 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.066, expert1_balance_bottom=19.415, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=214.6, ups=0.57, wpb=378.4, bsz=32, num_updates=35200, lr=6.40962e-06, gnorm=3.204, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73130
2022-05-09 17:08:00 - progress_bar.py[line:272] - INFO: epoch 002:  17551 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=376.1, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894138, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.906, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=215.3, ups=0.57, wpb=376.1, bsz=32, num_updates=35210, lr=6.40842e-06, gnorm=3.693, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73148
2022-05-09 17:08:17 - progress_bar.py[line:272] - INFO: epoch 002:  17561 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.918, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.6, ups=0.57, wpb=386.4, bsz=32, num_updates=35220, lr=6.40722e-06, gnorm=3.438, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73165
2022-05-09 17:08:34 - progress_bar.py[line:272] - INFO: epoch 002:  17571 / 17711 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872994, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.951, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.263, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.9, ups=0.58, wpb=383.6, bsz=32, num_updates=35230, lr=6.40602e-06, gnorm=3.599, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73183
2022-05-09 17:08:52 - progress_bar.py[line:272] - INFO: epoch 002:  17581 / 17711 loss=2.901, loss_v1=0, loss_v2=0, nll_loss=0.686, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878655, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.901, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.318, expert1_balance_bottom=19.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=217.4, ups=0.56, wpb=386, bsz=32, num_updates=35240, lr=6.40482e-06, gnorm=3.39, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73200
2022-05-09 17:09:09 - progress_bar.py[line:272] - INFO: epoch 002:  17591 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=387.6, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.624, expert1_balance_bottom=19.231, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=225.2, ups=0.58, wpb=387.6, bsz=32, num_updates=35250, lr=6.40362e-06, gnorm=3.54, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73217
2022-05-09 17:09:27 - progress_bar.py[line:272] - INFO: epoch 002:  17601 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=382.4, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878935, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.552, expert1_balance_bottom=19.55, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=220.6, ups=0.58, wpb=382.4, bsz=32, num_updates=35260, lr=6.40242e-06, gnorm=3.237, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73235
2022-05-09 17:09:44 - progress_bar.py[line:272] - INFO: epoch 002:  17611 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=390.3, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885075, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.299, expert1_balance_bottom=19.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=230, ups=0.59, wpb=390.3, bsz=32, num_updates=35270, lr=6.40122e-06, gnorm=3.933, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73252
2022-05-09 17:10:01 - progress_bar.py[line:272] - INFO: epoch 002:  17621 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.72, ntokens=392.1, nsentences=32, sample_size=312.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.071, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=227.1, ups=0.58, wpb=392.1, bsz=32, num_updates=35280, lr=6.40001e-06, gnorm=3.569, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73269
2022-05-09 17:10:18 - progress_bar.py[line:272] - INFO: epoch 002:  17631 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=382.8, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.072, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=224.1, ups=0.59, wpb=382.8, bsz=32, num_updates=35290, lr=6.39881e-06, gnorm=3.48, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73286
2022-05-09 17:10:35 - progress_bar.py[line:272] - INFO: epoch 002:  17641 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.036, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=220.6, ups=0.58, wpb=381.5, bsz=32, num_updates=35300, lr=6.39761e-06, gnorm=3.258, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73303
2022-05-09 17:10:52 - progress_bar.py[line:272] - INFO: epoch 002:  17651 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=378.8, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887478, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.305, expert1_balance_bottom=19.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=224.2, ups=0.59, wpb=378.8, bsz=32, num_updates=35310, lr=6.39641e-06, gnorm=3.637, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73320
2022-05-09 17:11:09 - progress_bar.py[line:272] - INFO: epoch 002:  17661 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=370.7, nsentences=32, sample_size=294.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899145, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.448, expert1_balance_bottom=19.61, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=216.2, ups=0.58, wpb=370.7, bsz=32, num_updates=35320, lr=6.39521e-06, gnorm=3.272, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73337
2022-05-09 17:11:27 - progress_bar.py[line:272] - INFO: epoch 002:  17671 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=393.2, nsentences=32, sample_size=313.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886383, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.185, expert1_balance_bottom=19.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=224.9, ups=0.57, wpb=393.2, bsz=32, num_updates=35330, lr=6.39401e-06, gnorm=3.183, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73355
2022-05-09 17:11:44 - progress_bar.py[line:272] - INFO: epoch 002:  17681 / 17711 loss=2.939, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=378.5, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893017, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.939, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.133, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=218.7, ups=0.58, wpb=378.5, bsz=32, num_updates=35340, lr=6.39281e-06, gnorm=3.382, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73372
2022-05-09 17:12:01 - progress_bar.py[line:272] - INFO: epoch 002:  17691 / 17711 loss=2.932, loss_v1=0, loss_v2=0, nll_loss=0.705, ntokens=369.6, nsentences=32, sample_size=294.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890501, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.932, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.965, expert1_balance_bottom=19.23, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=216.3, ups=0.59, wpb=369.6, bsz=32, num_updates=35350, lr=6.39161e-06, gnorm=3.081, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73389
2022-05-09 17:12:19 - progress_bar.py[line:272] - INFO: epoch 002:  17701 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.196, expert1_balance_bottom=19.472, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=220.8, ups=0.58, wpb=383.7, bsz=32, num_updates=35360, lr=6.3904e-06, gnorm=3.206, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73407
2022-05-09 17:12:36 - progress_bar.py[line:272] - INFO: epoch 002:  17711 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.331, expert1_balance_bottom=19.398, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=220.7, ups=0.57, wpb=384.1, bsz=32, num_updates=35370, lr=6.3892e-06, gnorm=3.624, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73424
2022-05-09 17:12:36 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 17:12:36 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 17:12:36 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 17:19:38 - train.py[line:517] - INFO: valid_step finished
2022-05-09 17:19:38 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 10.114 | loss_v1 0 | loss_v2 0 | nll_loss 8.451 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.00317 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.114 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.171 | expert1_balance_top 40.15 | expert1_balance_bottom 15.108 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 349.98 | cider 1.189 | wps 715.1 | wpb 481.7 | bsz 8 | num_updates 35370 | best_cider 1.203
2022-05-09 17:19:38 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 2 @ 35370 updates
2022-05-09 17:19:38 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-rank-0.pt
2022-05-09 17:19:38 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-rank-0.pt
2022-05-09 17:19:48 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-rank-0.pt
2022-05-09 17:19:48 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-shared.pt
2022-05-09 17:19:59 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-shared.pt
2022-05-09 17:19:59 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_last-rank-0.pt (epoch 2 @ 35370 updates, score 1.189) (writing took 21.593875001184642 seconds)
2022-05-09 17:19:59 - train.py[line:342] - INFO: end of epoch 2 (average epoch stats below)
2022-05-09 17:19:59 - progress_bar.py[line:282] - INFO: epoch 002 | loss 3.012 | loss_v1 0 | loss_v2 0 | nll_loss 0.798 | ntokens 382.739 | nsentences 32 | sample_size 304.596 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 0.885214 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 3.012 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.127 | expert1_balance_top 34.076 | expert1_balance_bottom 19.386 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 1.74 | wps 183.5 | ups 0.48 | wpb 382.7 | bsz 32 | num_updates 35370 | lr 6.3892e-06 | gnorm 3.516 | loss_scale 32 | train_wall 29439 | cuda_gb_allocated 14.1 | cuda_gb_reserved 15 | cuda_gb_free 9.6 | wall 73867
2022-05-09 17:19:59 - trainer.py[line:743] - INFO: loading train data for epoch 3
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 row count 566747 total row count 566747
slice_id 0 seek offset 0
2022-05-09 17:20:24 - trainer.py[line:807] - INFO: begin training epoch 3
2022-05-09 17:20:24 - train.py[line:315] - INFO: Start iterating over samples
2022-05-09 17:20:42 - progress_bar.py[line:272] - INFO: epoch 003:     10 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880109, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.878, expert1_balance_bottom=19.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=7.9, ups=0.02, wpb=383.7, bsz=32, num_updates=35380, lr=6.388e-06, gnorm=3.257, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73910
2022-05-09 17:20:59 - progress_bar.py[line:272] - INFO: epoch 003:     20 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.428, expert1_balance_bottom=19.52, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=223.4, ups=0.58, wpb=381.9, bsz=32, num_updates=35390, lr=6.3868e-06, gnorm=3.573, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73927
2022-05-09 17:21:16 - progress_bar.py[line:272] - INFO: epoch 003:     30 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=379.6, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.635, expert1_balance_bottom=19.237, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.7, ups=0.58, wpb=379.6, bsz=32, num_updates=35400, lr=6.3856e-06, gnorm=3.689, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73944
2022-05-09 17:21:34 - progress_bar.py[line:272] - INFO: epoch 003:     40 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=377.9, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.923, expert1_balance_bottom=19.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=217.2, ups=0.57, wpb=377.9, bsz=32, num_updates=35410, lr=6.3844e-06, gnorm=3.526, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73962
2022-05-09 17:21:51 - progress_bar.py[line:272] - INFO: epoch 003:     50 / 17711 loss=2.892, loss_v1=0, loss_v2=0, nll_loss=0.654, ntokens=383, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.892, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.379, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.57, wps=223.3, ups=0.58, wpb=383, bsz=32, num_updates=35420, lr=6.3832e-06, gnorm=3.43, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73979
2022-05-09 17:22:08 - progress_bar.py[line:272] - INFO: epoch 003:     60 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=35.299, expert1_balance_bottom=19.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.6, ups=0.58, wpb=385.8, bsz=32, num_updates=35430, lr=6.38199e-06, gnorm=3.664, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=73996
2022-05-09 17:22:25 - progress_bar.py[line:272] - INFO: epoch 003:     70 / 17711 loss=2.941, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=376.4, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.941, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.576, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=222.4, ups=0.59, wpb=376.4, bsz=32, num_updates=35440, lr=6.38079e-06, gnorm=3.413, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74013
2022-05-09 17:22:42 - progress_bar.py[line:272] - INFO: epoch 003:     80 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=376.8, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.273, expert1_balance_bottom=19.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=217.1, ups=0.58, wpb=376.8, bsz=32, num_updates=35450, lr=6.37959e-06, gnorm=2.997, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74030
2022-05-09 17:23:00 - progress_bar.py[line:272] - INFO: epoch 003:     90 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=390.5, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883212, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.523, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=227.9, ups=0.58, wpb=390.5, bsz=32, num_updates=35460, lr=6.37839e-06, gnorm=3.19, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74048
2022-05-09 17:23:17 - progress_bar.py[line:272] - INFO: epoch 003:    100 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=392.4, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.573, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=229.4, ups=0.58, wpb=392.4, bsz=32, num_updates=35470, lr=6.37719e-06, gnorm=3.467, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74065
2022-05-09 17:23:34 - progress_bar.py[line:272] - INFO: epoch 003:    110 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=389, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889233, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.037, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=225, ups=0.58, wpb=389, bsz=32, num_updates=35480, lr=6.37599e-06, gnorm=3.304, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74082
2022-05-09 17:23:51 - progress_bar.py[line:272] - INFO: epoch 003:    120 / 17711 loss=2.924, loss_v1=0, loss_v2=0, nll_loss=0.709, ntokens=378.8, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88012, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.924, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.001, expert1_balance_bottom=19.186, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=218, ups=0.58, wpb=378.8, bsz=32, num_updates=35490, lr=6.37479e-06, gnorm=3.113, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74099
2022-05-09 17:24:09 - progress_bar.py[line:272] - INFO: epoch 003:    130 / 17711 loss=2.933, loss_v1=0, loss_v2=0, nll_loss=0.703, ntokens=379.7, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893729, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.933, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.049, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=220, ups=0.58, wpb=379.7, bsz=32, num_updates=35500, lr=6.37359e-06, gnorm=3.411, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74117
2022-05-09 17:24:26 - progress_bar.py[line:272] - INFO: epoch 003:    140 / 17711 loss=2.919, loss_v1=0, loss_v2=0, nll_loss=0.691, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.919, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.874, expert1_balance_bottom=19.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=222.6, ups=0.59, wpb=379.5, bsz=32, num_updates=35510, lr=6.37238e-06, gnorm=3.273, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74134
2022-05-09 17:24:43 - progress_bar.py[line:272] - INFO: epoch 003:    150 / 17711 loss=2.903, loss_v1=0, loss_v2=0, nll_loss=0.671, ntokens=379.2, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889092, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.903, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.337, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=217.4, ups=0.57, wpb=379.2, bsz=32, num_updates=35520, lr=6.37118e-06, gnorm=3.769, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74151
2022-05-09 17:25:00 - progress_bar.py[line:272] - INFO: epoch 003:    160 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.447, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.8, ups=0.58, wpb=381.5, bsz=32, num_updates=35530, lr=6.36998e-06, gnorm=3.35, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74168
2022-05-09 17:25:18 - progress_bar.py[line:272] - INFO: epoch 003:    170 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=386.3, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890181, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.829, expert1_balance_bottom=19.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=223.6, ups=0.58, wpb=386.3, bsz=32, num_updates=35540, lr=6.36878e-06, gnorm=3.865, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74186
2022-05-09 17:25:35 - progress_bar.py[line:272] - INFO: epoch 003:    180 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885405, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.453, expert1_balance_bottom=19.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=218, ups=0.58, wpb=377.5, bsz=32, num_updates=35550, lr=6.36758e-06, gnorm=3.287, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74203
2022-05-09 17:25:52 - progress_bar.py[line:272] - INFO: epoch 003:    190 / 17711 loss=2.878, loss_v1=0, loss_v2=0, nll_loss=0.65, ntokens=385.6, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883062, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.878, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.187, expert1_balance_bottom=19.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.57, wps=223, ups=0.58, wpb=385.6, bsz=32, num_updates=35560, lr=6.36638e-06, gnorm=3.191, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74220
2022-05-09 17:26:10 - progress_bar.py[line:272] - INFO: epoch 003:    200 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=382.7, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.805, expert1_balance_bottom=19.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=218.5, ups=0.57, wpb=382.7, bsz=32, num_updates=35570, lr=6.36518e-06, gnorm=2.905, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74238
2022-05-09 17:26:28 - progress_bar.py[line:272] - INFO: epoch 003:    210 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881212, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.52, expert1_balance_bottom=19.236, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=213.3, ups=0.56, wpb=381.6, bsz=32, num_updates=35580, lr=6.36397e-06, gnorm=3.346, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74256
2022-05-09 17:26:45 - progress_bar.py[line:272] - INFO: epoch 003:    220 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=375.7, nsentences=32, sample_size=298.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.911, expert1_balance_bottom=19.582, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.3, ups=0.58, wpb=375.7, bsz=32, num_updates=35590, lr=6.36277e-06, gnorm=3.191, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74273
2022-05-09 17:27:02 - progress_bar.py[line:272] - INFO: epoch 003:    230 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=377.6, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884541, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.29, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=222.2, ups=0.59, wpb=377.6, bsz=32, num_updates=35600, lr=6.36157e-06, gnorm=3.427, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74290
2022-05-09 17:27:19 - progress_bar.py[line:272] - INFO: epoch 003:    240 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873043, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.004, expert1_balance_bottom=19.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220, ups=0.58, wpb=380.5, bsz=32, num_updates=35610, lr=6.36037e-06, gnorm=3.813, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74307
2022-05-09 17:27:37 - progress_bar.py[line:272] - INFO: epoch 003:    250 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=387.4, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873806, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.003, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.8, ups=0.57, wpb=387.4, bsz=32, num_updates=35620, lr=6.35917e-06, gnorm=3.339, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74325
2022-05-09 17:27:54 - progress_bar.py[line:272] - INFO: epoch 003:    260 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=385.8, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.045, expert1_balance_bottom=19.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=224, ups=0.58, wpb=385.8, bsz=32, num_updates=35630, lr=6.35797e-06, gnorm=3.775, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74342
2022-05-09 17:28:11 - progress_bar.py[line:272] - INFO: epoch 003:    270 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873036, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=35.476, expert1_balance_bottom=19.172, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223.2, ups=0.58, wpb=384.1, bsz=32, num_updates=35640, lr=6.35677e-06, gnorm=3.676, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74359
2022-05-09 17:28:29 - progress_bar.py[line:272] - INFO: epoch 003:    280 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.72, ntokens=381.7, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900079, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=33.889, expert1_balance_bottom=19.413, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=214.2, ups=0.56, wpb=381.7, bsz=32, num_updates=35650, lr=6.35557e-06, gnorm=3.327, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74377
2022-05-09 17:28:46 - progress_bar.py[line:272] - INFO: epoch 003:    290 / 17711 loss=2.923, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=379.3, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888595, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.923, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.852, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=217.8, ups=0.57, wpb=379.3, bsz=32, num_updates=35660, lr=6.35436e-06, gnorm=2.95, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74394
2022-05-09 17:29:03 - progress_bar.py[line:272] - INFO: epoch 003:    300 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=375.4, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=34.241, expert1_balance_bottom=19.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=219, ups=0.58, wpb=375.4, bsz=32, num_updates=35670, lr=6.35316e-06, gnorm=2.922, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74412
2022-05-09 17:29:21 - progress_bar.py[line:272] - INFO: epoch 003:    310 / 17711 loss=2.913, loss_v1=0, loss_v2=0, nll_loss=0.693, ntokens=385.6, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882654, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.913, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.441, expert1_balance_bottom=19.184, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=222.1, ups=0.58, wpb=385.6, bsz=32, num_updates=35680, lr=6.35196e-06, gnorm=3.124, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74429
2022-05-09 17:29:39 - progress_bar.py[line:272] - INFO: epoch 003:    320 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=383.4, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879572, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.648, expert1_balance_bottom=19.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.8, ups=0.57, wpb=383.4, bsz=32, num_updates=35690, lr=6.35076e-06, gnorm=3.812, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74447
2022-05-09 17:29:56 - progress_bar.py[line:272] - INFO: epoch 003:    330 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=385.4, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886454, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.691, expert1_balance_bottom=19.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=220.8, ups=0.57, wpb=385.4, bsz=32, num_updates=35700, lr=6.34956e-06, gnorm=4.065, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74464
2022-05-09 17:30:13 - progress_bar.py[line:272] - INFO: epoch 003:    340 / 17711 loss=2.911, loss_v1=0, loss_v2=0, nll_loss=0.679, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895944, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.911, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=33.637, expert1_balance_bottom=19.685, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=221.6, ups=0.58, wpb=380.4, bsz=32, num_updates=35710, lr=6.34836e-06, gnorm=3.631, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74481
2022-05-09 17:30:31 - progress_bar.py[line:272] - INFO: epoch 003:    350 / 17711 loss=2.909, loss_v1=0, loss_v2=0, nll_loss=0.671, ntokens=380.7, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898356, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.909, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.631, expert1_balance_bottom=19.733, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=216.9, ups=0.57, wpb=380.7, bsz=32, num_updates=35720, lr=6.34716e-06, gnorm=3.024, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74499
2022-05-09 17:30:48 - progress_bar.py[line:272] - INFO: epoch 003:    360 / 17711 loss=2.913, loss_v1=0, loss_v2=0, nll_loss=0.674, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900957, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.913, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.119, expert1_balance_top=33.353, expert1_balance_bottom=19.665, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=220.9, ups=0.58, wpb=382, bsz=32, num_updates=35730, lr=6.34596e-06, gnorm=2.945, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74516
2022-05-09 17:31:05 - progress_bar.py[line:272] - INFO: epoch 003:    370 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.43, expert1_balance_bottom=19.506, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=226.7, ups=0.58, wpb=388, bsz=32, num_updates=35740, lr=6.34475e-06, gnorm=3.283, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74533
2022-05-09 17:31:22 - progress_bar.py[line:272] - INFO: epoch 003:    380 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=391.1, nsentences=32, sample_size=311.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.892, expert1_balance_bottom=19.603, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=225, ups=0.58, wpb=391.1, bsz=32, num_updates=35750, lr=6.34355e-06, gnorm=3.592, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74551
2022-05-09 17:31:40 - progress_bar.py[line:272] - INFO: epoch 003:    390 / 17711 loss=2.936, loss_v1=0, loss_v2=0, nll_loss=0.717, ntokens=389.6, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879776, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.936, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.797, expert1_balance_bottom=19.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=221.8, ups=0.57, wpb=389.6, bsz=32, num_updates=35760, lr=6.34235e-06, gnorm=3.108, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74568
2022-05-09 17:31:57 - progress_bar.py[line:272] - INFO: epoch 003:    400 / 17711 loss=2.941, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=387.5, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.941, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=35.078, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=227.8, ups=0.59, wpb=387.5, bsz=32, num_updates=35770, lr=6.34115e-06, gnorm=3.37, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74585
2022-05-09 17:32:14 - progress_bar.py[line:272] - INFO: epoch 003:    410 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=384.5, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.863, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.2, ups=0.58, wpb=384.5, bsz=32, num_updates=35780, lr=6.33995e-06, gnorm=3.655, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74602
2022-05-09 17:32:31 - progress_bar.py[line:272] - INFO: epoch 003:    420 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=376.8, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882563, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.695, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=223.5, ups=0.59, wpb=376.8, bsz=32, num_updates=35790, lr=6.33875e-06, gnorm=3.323, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74619
2022-05-09 17:32:48 - progress_bar.py[line:272] - INFO: epoch 003:    430 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.589, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=222.7, ups=0.58, wpb=384.2, bsz=32, num_updates=35800, lr=6.33755e-06, gnorm=3.825, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74636
2022-05-09 17:33:06 - progress_bar.py[line:272] - INFO: epoch 003:    440 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=378.1, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.275, expert1_balance_bottom=19.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.5, ups=0.58, wpb=378.1, bsz=32, num_updates=35810, lr=6.33634e-06, gnorm=3.541, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74654
2022-05-09 17:33:23 - progress_bar.py[line:272] - INFO: epoch 003:    450 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=378, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.708, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=218.4, ups=0.58, wpb=378, bsz=32, num_updates=35820, lr=6.33514e-06, gnorm=3.827, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74671
2022-05-09 17:33:41 - progress_bar.py[line:272] - INFO: epoch 003:    460 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=378.6, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884841, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.877, expert1_balance_bottom=19.172, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=215.7, ups=0.57, wpb=378.6, bsz=32, num_updates=35830, lr=6.33394e-06, gnorm=3.455, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74689
2022-05-09 17:33:58 - progress_bar.py[line:272] - INFO: epoch 003:    470 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.715, ntokens=381.5, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=33.511, expert1_balance_bottom=19.681, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=218.4, ups=0.57, wpb=381.5, bsz=32, num_updates=35840, lr=6.33274e-06, gnorm=2.943, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74706
2022-05-09 17:34:15 - progress_bar.py[line:272] - INFO: epoch 003:    480 / 17711 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=373, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.951, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.214, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=218, ups=0.58, wpb=373, bsz=32, num_updates=35850, lr=6.33154e-06, gnorm=3.407, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74723
2022-05-09 17:34:32 - progress_bar.py[line:272] - INFO: epoch 003:    490 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=384.8, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893326, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.197, expert1_balance_bottom=19.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=225.5, ups=0.59, wpb=384.8, bsz=32, num_updates=35860, lr=6.33034e-06, gnorm=3.17, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74740
2022-05-09 17:34:49 - progress_bar.py[line:272] - INFO: epoch 003:    500 / 17711 loss=2.911, loss_v1=0, loss_v2=0, nll_loss=0.682, ntokens=385.8, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889021, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.911, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.342, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=226.5, ups=0.59, wpb=385.8, bsz=32, num_updates=35870, lr=6.32914e-06, gnorm=3.365, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74757
2022-05-09 17:35:06 - progress_bar.py[line:272] - INFO: epoch 003:    510 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887342, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.353, expert1_balance_bottom=19.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=222, ups=0.58, wpb=382, bsz=32, num_updates=35880, lr=6.32794e-06, gnorm=3.359, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74775
2022-05-09 17:35:24 - progress_bar.py[line:272] - INFO: epoch 003:    520 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=386.3, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889128, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.314, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=225.4, ups=0.58, wpb=386.3, bsz=32, num_updates=35890, lr=6.32673e-06, gnorm=3.672, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74792
2022-05-09 17:35:41 - progress_bar.py[line:272] - INFO: epoch 003:    530 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=385.5, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881619, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.648, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=228.3, ups=0.59, wpb=385.5, bsz=32, num_updates=35900, lr=6.32553e-06, gnorm=3.365, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74809
2022-05-09 17:35:58 - progress_bar.py[line:272] - INFO: epoch 003:    540 / 17711 loss=2.898, loss_v1=0, loss_v2=0, nll_loss=0.677, ntokens=374.7, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.898, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.988, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=214.6, ups=0.57, wpb=374.7, bsz=32, num_updates=35910, lr=6.32433e-06, gnorm=3.218, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74826
2022-05-09 17:36:15 - progress_bar.py[line:272] - INFO: epoch 003:    550 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=385.2, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890476, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=33.858, expert1_balance_bottom=19.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=220.3, ups=0.57, wpb=385.2, bsz=32, num_updates=35920, lr=6.32313e-06, gnorm=3.288, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74843
2022-05-09 17:36:33 - progress_bar.py[line:272] - INFO: epoch 003:    560 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=388.1, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884437, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.306, expert1_balance_bottom=19.409, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=222.8, ups=0.57, wpb=388.1, bsz=32, num_updates=35930, lr=6.32193e-06, gnorm=3.623, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74861
2022-05-09 17:36:50 - progress_bar.py[line:272] - INFO: epoch 003:    570 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=388.3, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879197, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.239, expert1_balance_bottom=19.083, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.5, ups=0.57, wpb=388.3, bsz=32, num_updates=35940, lr=6.32073e-06, gnorm=3.244, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74878
2022-05-09 17:37:08 - progress_bar.py[line:272] - INFO: epoch 003:    580 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=387.7, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888859, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.405, expert1_balance_bottom=19.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.7, ups=0.57, wpb=387.7, bsz=32, num_updates=35950, lr=6.31953e-06, gnorm=3.371, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74896
2022-05-09 17:37:25 - progress_bar.py[line:272] - INFO: epoch 003:    590 / 17711 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=384.3, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869042, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.212, expert1_balance_bottom=19.165, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=221.7, ups=0.58, wpb=384.3, bsz=32, num_updates=35960, lr=6.31832e-06, gnorm=3.752, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74913
2022-05-09 17:37:43 - progress_bar.py[line:272] - INFO: epoch 003:    600 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881434, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.766, expert1_balance_bottom=19.173, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=219, ups=0.57, wpb=381.7, bsz=32, num_updates=35970, lr=6.31712e-06, gnorm=3.31, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74931
2022-05-09 17:38:00 - progress_bar.py[line:272] - INFO: epoch 003:    610 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=379.5, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.096, expert1_balance_bottom=19.614, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.1, ups=0.57, wpb=379.5, bsz=32, num_updates=35980, lr=6.31592e-06, gnorm=3.151, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74948
2022-05-09 17:38:18 - progress_bar.py[line:272] - INFO: epoch 003:    620 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=383.7, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=33.989, expert1_balance_bottom=19.433, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=220.8, ups=0.58, wpb=383.7, bsz=32, num_updates=35990, lr=6.31472e-06, gnorm=4.04, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74966
2022-05-09 17:38:35 - progress_bar.py[line:272] - INFO: epoch 003:    630 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=378.6, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884738, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.312, expert1_balance_bottom=19.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.6, ups=0.58, wpb=378.6, bsz=32, num_updates=36000, lr=6.31352e-06, gnorm=3.26, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=74983
2022-05-09 17:38:35 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 17:38:35 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 17:38:35 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 17:45:43 - train.py[line:517] - INFO: valid_step finished
2022-05-09 17:45:43 - progress_bar.py[line:282] - INFO: epoch 003 | valid on 'valid' subset | loss 10.161 | loss_v1 0 | loss_v2 0 | nll_loss 8.497 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.00584 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.161 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.17 | expert1_balance_top 40.399 | expert1_balance_bottom 15.192 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 361.32 | cider 1.191 | wps 703.7 | wpb 481.7 | bsz 8 | num_updates 36000 | best_cider 1.203
2022-05-09 17:46:00 - progress_bar.py[line:272] - INFO: epoch 003:    640 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=380.2, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.488, expert1_balance_bottom=19.05, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=8.5, ups=0.02, wpb=380.2, bsz=32, num_updates=36010, lr=6.31232e-06, gnorm=3.466, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75428
2022-05-09 17:46:17 - progress_bar.py[line:272] - INFO: epoch 003:    650 / 17711 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892117, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.951, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.538, expert1_balance_bottom=19.338, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=225.2, ups=0.59, wpb=382.8, bsz=32, num_updates=36020, lr=6.31112e-06, gnorm=3.065, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75445
2022-05-09 17:46:35 - progress_bar.py[line:272] - INFO: epoch 003:    660 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=389.7, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881626, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.732, expert1_balance_bottom=19.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=226.8, ups=0.58, wpb=389.7, bsz=32, num_updates=36030, lr=6.30992e-06, gnorm=3.194, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75463
2022-05-09 17:46:52 - progress_bar.py[line:272] - INFO: epoch 003:    670 / 17711 loss=2.904, loss_v1=0, loss_v2=0, nll_loss=0.671, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.904, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.834, expert1_balance_bottom=19.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=222.1, ups=0.58, wpb=384.7, bsz=32, num_updates=36040, lr=6.30871e-06, gnorm=3.202, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75480
2022-05-09 17:47:09 - progress_bar.py[line:272] - INFO: epoch 003:    680 / 17711 loss=2.91, loss_v1=0, loss_v2=0, nll_loss=0.695, ntokens=391.8, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.91, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=35.339, expert1_balance_bottom=19.103, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=226.1, ups=0.58, wpb=391.8, bsz=32, num_updates=36050, lr=6.30751e-06, gnorm=2.992, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75497
2022-05-09 17:47:27 - progress_bar.py[line:272] - INFO: epoch 003:    690 / 17711 loss=2.928, loss_v1=0, loss_v2=0, nll_loss=0.715, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874729, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.928, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.437, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=220.5, ups=0.57, wpb=384.1, bsz=32, num_updates=36060, lr=6.30631e-06, gnorm=3.853, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75515
2022-05-09 17:47:44 - progress_bar.py[line:272] - INFO: epoch 003:    700 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884141, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.827, expert1_balance_bottom=19.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=224.8, ups=0.58, wpb=385.3, bsz=32, num_updates=36070, lr=6.30511e-06, gnorm=3.158, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75532
2022-05-09 17:48:01 - progress_bar.py[line:272] - INFO: epoch 003:    710 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=387.7, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881717, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.772, expert1_balance_bottom=19.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=223.7, ups=0.58, wpb=387.7, bsz=32, num_updates=36080, lr=6.30391e-06, gnorm=3.494, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75549
2022-05-09 17:48:18 - progress_bar.py[line:272] - INFO: epoch 003:    720 / 17711 loss=2.919, loss_v1=0, loss_v2=0, nll_loss=0.693, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891663, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.919, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.168, expert1_balance_bottom=19.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=223.5, ups=0.59, wpb=381, bsz=32, num_updates=36090, lr=6.30271e-06, gnorm=5.151, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75566
2022-05-09 17:48:36 - progress_bar.py[line:272] - INFO: epoch 003:    730 / 17711 loss=3.058, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=385.5, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877667, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.561, expert1_balance_bottom=19.285, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218, ups=0.57, wpb=385.5, bsz=32, num_updates=36100, lr=6.30151e-06, gnorm=3.35, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75584
2022-05-09 17:48:53 - progress_bar.py[line:272] - INFO: epoch 003:    740 / 17711 loss=2.919, loss_v1=0, loss_v2=0, nll_loss=0.678, ntokens=376.4, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896506, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.919, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.282, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=219.2, ups=0.58, wpb=376.4, bsz=32, num_updates=36110, lr=6.30031e-06, gnorm=3.236, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75601
2022-05-09 17:49:10 - progress_bar.py[line:272] - INFO: epoch 003:    750 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=380.9, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87236, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=35.347, expert1_balance_bottom=19.085, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=221.7, ups=0.58, wpb=380.9, bsz=32, num_updates=36120, lr=6.2991e-06, gnorm=4.141, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75618
2022-05-09 17:49:27 - progress_bar.py[line:272] - INFO: epoch 003:    760 / 17711 loss=2.921, loss_v1=0, loss_v2=0, nll_loss=0.684, ntokens=376.7, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900167, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.921, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=33.959, expert1_balance_bottom=19.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=219.2, ups=0.58, wpb=376.7, bsz=32, num_updates=36130, lr=6.2979e-06, gnorm=3.84, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75635
2022-05-09 17:49:45 - progress_bar.py[line:272] - INFO: epoch 003:    770 / 17711 loss=2.937, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=383, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.937, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.122, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=214.7, ups=0.56, wpb=383, bsz=32, num_updates=36140, lr=6.2967e-06, gnorm=3.248, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75653
2022-05-09 17:50:03 - progress_bar.py[line:272] - INFO: epoch 003:    780 / 17711 loss=2.906, loss_v1=0, loss_v2=0, nll_loss=0.693, ntokens=397.3, nsentences=32, sample_size=316.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877362, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.906, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.974, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=226.4, ups=0.57, wpb=397.3, bsz=32, num_updates=36150, lr=6.2955e-06, gnorm=3.957, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75671
2022-05-09 17:50:21 - progress_bar.py[line:272] - INFO: epoch 003:    790 / 17711 loss=2.927, loss_v1=0, loss_v2=0, nll_loss=0.701, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886616, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.927, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.46, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=217.5, ups=0.56, wpb=386.6, bsz=32, num_updates=36160, lr=6.2943e-06, gnorm=3.604, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75689
2022-05-09 17:50:38 - progress_bar.py[line:272] - INFO: epoch 003:    800 / 17711 loss=2.943, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882843, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.943, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.948, expert1_balance_bottom=19.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=218.2, ups=0.57, wpb=381.8, bsz=32, num_updates=36170, lr=6.2931e-06, gnorm=3.573, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75706
2022-05-09 17:50:57 - progress_bar.py[line:272] - INFO: epoch 003:    810 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893312, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.029, expert1_balance_bottom=19.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=205.7, ups=0.54, wpb=381.3, bsz=32, num_updates=36180, lr=6.2919e-06, gnorm=3.288, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75725
2022-05-09 17:51:14 - progress_bar.py[line:272] - INFO: epoch 003:    820 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=377.4, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894315, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.215, expert1_balance_bottom=19.474, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=212.7, ups=0.56, wpb=377.4, bsz=32, num_updates=36190, lr=6.29069e-06, gnorm=3.846, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75742
2022-05-09 17:51:33 - progress_bar.py[line:272] - INFO: epoch 003:    830 / 17711 loss=2.921, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885165, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.921, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.785, expert1_balance_bottom=19.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=209, ups=0.55, wpb=380.5, bsz=32, num_updates=36200, lr=6.28949e-06, gnorm=3.118, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75761
2022-05-09 17:51:51 - progress_bar.py[line:272] - INFO: epoch 003:    840 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888854, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.855, expert1_balance_bottom=19.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=209.2, ups=0.55, wpb=381.1, bsz=32, num_updates=36210, lr=6.28829e-06, gnorm=3.54, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75779
2022-05-09 17:52:08 - progress_bar.py[line:272] - INFO: epoch 003:    850 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=387, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880927, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.635, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.6, ups=0.57, wpb=387, bsz=32, num_updates=36220, lr=6.28709e-06, gnorm=3.241, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75796
2022-05-09 17:52:26 - progress_bar.py[line:272] - INFO: epoch 003:    860 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=376, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.125, expert1_balance_bottom=19.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=208.7, ups=0.56, wpb=376, bsz=32, num_updates=36230, lr=6.28589e-06, gnorm=3.242, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75814
2022-05-09 17:52:44 - progress_bar.py[line:272] - INFO: epoch 003:    870 / 17711 loss=2.91, loss_v1=0, loss_v2=0, nll_loss=0.687, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886489, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.91, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.798, expert1_balance_bottom=19.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=214.3, ups=0.56, wpb=380.1, bsz=32, num_updates=36240, lr=6.28469e-06, gnorm=3.273, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75832
2022-05-09 17:53:02 - progress_bar.py[line:272] - INFO: epoch 003:    880 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=383.7, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.125, expert1_balance_bottom=19.476, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=217.1, ups=0.57, wpb=383.7, bsz=32, num_updates=36250, lr=6.28349e-06, gnorm=3.313, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75850
2022-05-09 17:53:19 - progress_bar.py[line:272] - INFO: epoch 003:    890 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=378.9, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.067, expert1_balance_bottom=19.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=214.9, ups=0.57, wpb=378.9, bsz=32, num_updates=36260, lr=6.28229e-06, gnorm=3.184, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75867
2022-05-09 17:53:33 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 17:53:38 - progress_bar.py[line:272] - INFO: epoch 003:    901 / 17711 loss=2.932, loss_v1=0, loss_v2=0, nll_loss=0.701, ntokens=375.9, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891788, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.932, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.648, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=196.8, ups=0.52, wpb=375.9, bsz=32, num_updates=36270, lr=6.28108e-06, gnorm=3.52, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75886
2022-05-09 17:53:56 - progress_bar.py[line:272] - INFO: epoch 003:    911 / 17711 loss=2.914, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=388.8, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.914, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.609, expert1_balance_bottom=19.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=224.9, ups=0.58, wpb=388.8, bsz=32, num_updates=36280, lr=6.27988e-06, gnorm=3.265, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75904
2022-05-09 17:54:13 - progress_bar.py[line:272] - INFO: epoch 003:    921 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=390.3, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881093, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.999, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=222.4, ups=0.57, wpb=390.3, bsz=32, num_updates=36290, lr=6.27868e-06, gnorm=3.199, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75921
2022-05-09 17:54:31 - progress_bar.py[line:272] - INFO: epoch 003:    931 / 17711 loss=2.899, loss_v1=0, loss_v2=0, nll_loss=0.682, ntokens=381.3, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878419, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.899, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=35.137, expert1_balance_bottom=19.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=221.2, ups=0.58, wpb=381.3, bsz=32, num_updates=36300, lr=6.27748e-06, gnorm=3.084, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75939
2022-05-09 17:54:48 - progress_bar.py[line:272] - INFO: epoch 003:    941 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=383.1, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891634, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.482, expert1_balance_bottom=19.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=217.4, ups=0.57, wpb=383.1, bsz=32, num_updates=36310, lr=6.27628e-06, gnorm=3.649, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75956
2022-05-09 17:55:06 - progress_bar.py[line:272] - INFO: epoch 003:    951 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888166, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.472, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=219.3, ups=0.57, wpb=387.9, bsz=32, num_updates=36320, lr=6.27508e-06, gnorm=3.176, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75974
2022-05-09 17:55:23 - progress_bar.py[line:272] - INFO: epoch 003:    961 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=377.1, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.527, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220, ups=0.58, wpb=377.1, bsz=32, num_updates=36330, lr=6.27388e-06, gnorm=3.583, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=75991
2022-05-09 17:55:40 - progress_bar.py[line:272] - INFO: epoch 003:    971 / 17711 loss=2.933, loss_v1=0, loss_v2=0, nll_loss=0.703, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88973, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.933, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.284, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=223.2, ups=0.58, wpb=381.7, bsz=32, num_updates=36340, lr=6.27267e-06, gnorm=3.296, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76008
2022-05-09 17:55:58 - progress_bar.py[line:272] - INFO: epoch 003:    981 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882092, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.34, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=217.6, ups=0.57, wpb=379.2, bsz=32, num_updates=36350, lr=6.27147e-06, gnorm=3.411, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76026
2022-05-09 17:56:15 - progress_bar.py[line:272] - INFO: epoch 003:    991 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=398.2, nsentences=32, sample_size=317, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873187, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.834, expert1_balance_bottom=19.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=230.8, ups=0.58, wpb=398.2, bsz=32, num_updates=36360, lr=6.27027e-06, gnorm=3.3, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76043
2022-05-09 17:56:32 - progress_bar.py[line:272] - INFO: epoch 003:   1001 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.354, expert1_balance_bottom=19.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=224.2, ups=0.58, wpb=388, bsz=32, num_updates=36370, lr=6.26907e-06, gnorm=3.023, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76060
2022-05-09 17:56:50 - progress_bar.py[line:272] - INFO: epoch 003:   1011 / 17711 loss=2.908, loss_v1=0, loss_v2=0, nll_loss=0.681, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.908, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.573, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=216.9, ups=0.57, wpb=383.8, bsz=32, num_updates=36380, lr=6.26787e-06, gnorm=3.577, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76078
2022-05-09 17:57:07 - progress_bar.py[line:272] - INFO: epoch 003:   1021 / 17711 loss=2.911, loss_v1=0, loss_v2=0, nll_loss=0.686, ntokens=388.5, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.911, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.247, expert1_balance_bottom=19.531, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=221.8, ups=0.57, wpb=388.5, bsz=32, num_updates=36390, lr=6.26667e-06, gnorm=3.415, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76095
2022-05-09 17:57:24 - progress_bar.py[line:272] - INFO: epoch 003:   1031 / 17711 loss=2.877, loss_v1=0, loss_v2=0, nll_loss=0.652, ntokens=385.6, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881066, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.877, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.669, expert1_balance_bottom=19.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.57, wps=225.8, ups=0.59, wpb=385.6, bsz=32, num_updates=36400, lr=6.26547e-06, gnorm=3.509, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76112
2022-05-09 17:57:41 - progress_bar.py[line:272] - INFO: epoch 003:   1041 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=376.1, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.278, expert1_balance_bottom=19.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.2, ups=0.59, wpb=376.1, bsz=32, num_updates=36410, lr=6.26427e-06, gnorm=3.566, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76129
2022-05-09 17:57:59 - progress_bar.py[line:272] - INFO: epoch 003:   1051 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=372.6, nsentences=32, sample_size=296.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888498, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.557, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=213.5, ups=0.57, wpb=372.6, bsz=32, num_updates=36420, lr=6.26306e-06, gnorm=3.625, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76147
2022-05-09 17:58:16 - progress_bar.py[line:272] - INFO: epoch 003:   1061 / 17711 loss=2.9, loss_v1=0, loss_v2=0, nll_loss=0.683, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.9, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=35.067, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=220.2, ups=0.58, wpb=376.7, bsz=32, num_updates=36430, lr=6.26186e-06, gnorm=3.362, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76164
2022-05-09 17:58:33 - progress_bar.py[line:272] - INFO: epoch 003:   1071 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=378.9, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899808, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.843, expert1_balance_bottom=19.365, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=220, ups=0.58, wpb=378.9, bsz=32, num_updates=36440, lr=6.26066e-06, gnorm=3.656, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76181
2022-05-09 17:58:50 - progress_bar.py[line:272] - INFO: epoch 003:   1081 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=379.7, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.825, expert1_balance_bottom=19.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=221.6, ups=0.58, wpb=379.7, bsz=32, num_updates=36450, lr=6.25946e-06, gnorm=3.397, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76198
2022-05-09 17:59:08 - progress_bar.py[line:272] - INFO: epoch 003:   1091 / 17711 loss=2.944, loss_v1=0, loss_v2=0, nll_loss=0.715, ntokens=383.8, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891695, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.2, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=222.6, ups=0.58, wpb=383.8, bsz=32, num_updates=36460, lr=6.25826e-06, gnorm=3.53, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76216
2022-05-09 17:59:25 - progress_bar.py[line:272] - INFO: epoch 003:   1101 / 17711 loss=2.937, loss_v1=0, loss_v2=0, nll_loss=0.72, ntokens=382, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88066, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.937, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=35.113, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=223.5, ups=0.59, wpb=382, bsz=32, num_updates=36470, lr=6.25706e-06, gnorm=3.996, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76233
2022-05-09 17:59:42 - progress_bar.py[line:272] - INFO: epoch 003:   1111 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=384.3, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880369, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=35.107, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=227, ups=0.59, wpb=384.3, bsz=32, num_updates=36480, lr=6.25586e-06, gnorm=3.401, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76250
2022-05-09 17:59:59 - progress_bar.py[line:272] - INFO: epoch 003:   1121 / 17711 loss=2.914, loss_v1=0, loss_v2=0, nll_loss=0.687, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882467, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.914, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.995, expert1_balance_bottom=19.217, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=224.2, ups=0.59, wpb=380.5, bsz=32, num_updates=36490, lr=6.25466e-06, gnorm=3.349, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76267
2022-05-09 18:00:15 - progress_bar.py[line:272] - INFO: epoch 003:   1131 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=378.6, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899214, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.502, expert1_balance_bottom=19.699, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=224.5, ups=0.59, wpb=378.6, bsz=32, num_updates=36500, lr=6.25345e-06, gnorm=3.789, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76283
2022-05-09 18:00:32 - progress_bar.py[line:272] - INFO: epoch 003:   1141 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=392, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.781, expert1_balance_bottom=19.558, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=233.7, ups=0.6, wpb=392, bsz=32, num_updates=36510, lr=6.25225e-06, gnorm=3.373, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76300
2022-05-09 18:00:49 - progress_bar.py[line:272] - INFO: epoch 003:   1151 / 17711 loss=2.92, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=383.5, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.92, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.47, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=227.7, ups=0.59, wpb=383.5, bsz=32, num_updates=36520, lr=6.25105e-06, gnorm=3.3, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76317
2022-05-09 18:01:06 - progress_bar.py[line:272] - INFO: epoch 003:   1161 / 17711 loss=2.897, loss_v1=0, loss_v2=0, nll_loss=0.692, ntokens=394.5, nsentences=32, sample_size=313.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866123, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.897, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=35.412, expert1_balance_bottom=19.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=231.7, ups=0.59, wpb=394.5, bsz=32, num_updates=36530, lr=6.24985e-06, gnorm=3.112, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76334
2022-05-09 18:01:16 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 18:01:25 - progress_bar.py[line:272] - INFO: epoch 003:   1172 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88665, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.443, expert1_balance_bottom=19.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=206.3, ups=0.54, wpb=383.8, bsz=32, num_updates=36540, lr=6.24865e-06, gnorm=3.203, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76353
2022-05-09 18:01:42 - progress_bar.py[line:272] - INFO: epoch 003:   1182 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=387.6, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88087, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.681, expert1_balance_bottom=19.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=226.6, ups=0.58, wpb=387.6, bsz=32, num_updates=36550, lr=6.24745e-06, gnorm=3.319, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76370
2022-05-09 18:01:59 - progress_bar.py[line:272] - INFO: epoch 003:   1192 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=387.6, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.146, expert1_balance_bottom=19.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=228.3, ups=0.59, wpb=387.6, bsz=32, num_updates=36560, lr=6.24625e-06, gnorm=3.73, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76387
2022-05-09 18:02:16 - progress_bar.py[line:272] - INFO: epoch 003:   1202 / 17711 loss=2.921, loss_v1=0, loss_v2=0, nll_loss=0.702, ntokens=387.1, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.921, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.508, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=222.6, ups=0.58, wpb=387.1, bsz=32, num_updates=36570, lr=6.24504e-06, gnorm=3.319, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76404
2022-05-09 18:02:33 - progress_bar.py[line:272] - INFO: epoch 003:   1212 / 17711 loss=2.944, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.732, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=224.7, ups=0.59, wpb=381.5, bsz=32, num_updates=36580, lr=6.24384e-06, gnorm=3.552, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76421
2022-05-09 18:02:50 - progress_bar.py[line:272] - INFO: epoch 003:   1222 / 17711 loss=2.917, loss_v1=0, loss_v2=0, nll_loss=0.704, ntokens=384.5, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875173, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.917, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.984, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=226.8, ups=0.59, wpb=384.5, bsz=32, num_updates=36590, lr=6.24264e-06, gnorm=3.315, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76438
2022-05-09 18:03:07 - progress_bar.py[line:272] - INFO: epoch 003:   1232 / 17711 loss=2.927, loss_v1=0, loss_v2=0, nll_loss=0.682, ntokens=371.1, nsentences=32, sample_size=295, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904141, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.927, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=32.777, expert1_balance_bottom=19.808, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=219.8, ups=0.59, wpb=371.1, bsz=32, num_updates=36600, lr=6.24144e-06, gnorm=3.435, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76455
2022-05-09 18:03:24 - progress_bar.py[line:272] - INFO: epoch 003:   1242 / 17711 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.534, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.5, ups=0.58, wpb=382.8, bsz=32, num_updates=36610, lr=6.24024e-06, gnorm=3.474, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76472
2022-05-09 18:03:41 - progress_bar.py[line:272] - INFO: epoch 003:   1252 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=383.5, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886783, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.505, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=222.2, ups=0.58, wpb=383.5, bsz=32, num_updates=36620, lr=6.23904e-06, gnorm=3.478, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76489
2022-05-09 18:03:58 - progress_bar.py[line:272] - INFO: epoch 003:   1262 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880959, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.381, expert1_balance_bottom=19.464, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=224.4, ups=0.59, wpb=382.6, bsz=32, num_updates=36630, lr=6.23784e-06, gnorm=3.214, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76506
2022-05-09 18:04:15 - progress_bar.py[line:272] - INFO: epoch 003:   1272 / 17711 loss=2.895, loss_v1=0, loss_v2=0, nll_loss=0.669, ntokens=400.4, nsentences=32, sample_size=318.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.895, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.951, expert1_balance_bottom=19.541, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=237.2, ups=0.59, wpb=400.4, bsz=32, num_updates=36640, lr=6.23664e-06, gnorm=3.183, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76523
2022-05-09 18:04:32 - progress_bar.py[line:272] - INFO: epoch 003:   1282 / 17711 loss=2.931, loss_v1=0, loss_v2=0, nll_loss=0.709, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884945, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.931, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.521, expert1_balance_bottom=19.351, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=221.7, ups=0.59, wpb=378.6, bsz=32, num_updates=36650, lr=6.23543e-06, gnorm=3.387, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76540
2022-05-09 18:04:49 - progress_bar.py[line:272] - INFO: epoch 003:   1292 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889649, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=34.105, expert1_balance_bottom=19.572, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=225.2, ups=0.59, wpb=383.2, bsz=32, num_updates=36660, lr=6.23423e-06, gnorm=3.374, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76557
2022-05-09 18:05:06 - progress_bar.py[line:272] - INFO: epoch 003:   1302 / 17711 loss=2.904, loss_v1=0, loss_v2=0, nll_loss=0.674, ntokens=382.6, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888589, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.904, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.163, expert1_balance_bottom=19.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=225.7, ups=0.59, wpb=382.6, bsz=32, num_updates=36670, lr=6.23303e-06, gnorm=3.81, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76574
2022-05-09 18:05:23 - progress_bar.py[line:272] - INFO: epoch 003:   1312 / 17711 loss=2.923, loss_v1=0, loss_v2=0, nll_loss=0.691, ntokens=376.3, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894512, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.923, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.017, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=221.2, ups=0.59, wpb=376.3, bsz=32, num_updates=36680, lr=6.23183e-06, gnorm=3.08, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76591
2022-05-09 18:05:40 - progress_bar.py[line:272] - INFO: epoch 003:   1322 / 17711 loss=2.923, loss_v1=0, loss_v2=0, nll_loss=0.703, ntokens=382.7, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87912, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.923, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.827, expert1_balance_bottom=19.168, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=222.9, ups=0.58, wpb=382.7, bsz=32, num_updates=36690, lr=6.23063e-06, gnorm=3.293, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76609
2022-05-09 18:05:58 - progress_bar.py[line:272] - INFO: epoch 003:   1332 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894719, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=33.516, expert1_balance_bottom=19.567, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=224.7, ups=0.58, wpb=386.3, bsz=32, num_updates=36700, lr=6.22943e-06, gnorm=3.244, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76626
2022-05-09 18:06:15 - progress_bar.py[line:272] - INFO: epoch 003:   1342 / 17711 loss=2.923, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.923, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.186, expert1_balance_bottom=19.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=219.8, ups=0.57, wpb=382.9, bsz=32, num_updates=36710, lr=6.22823e-06, gnorm=3.35, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76643
2022-05-09 18:06:32 - progress_bar.py[line:272] - INFO: epoch 003:   1352 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=385.6, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.45, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.7, ups=0.58, wpb=385.6, bsz=32, num_updates=36720, lr=6.22702e-06, gnorm=3.519, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76660
2022-05-09 18:06:49 - progress_bar.py[line:272] - INFO: epoch 003:   1362 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892471, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=33.877, expert1_balance_bottom=19.614, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=224.4, ups=0.59, wpb=383.4, bsz=32, num_updates=36730, lr=6.22582e-06, gnorm=4.063, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76677
2022-05-09 18:07:06 - progress_bar.py[line:272] - INFO: epoch 003:   1372 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=385.8, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879954, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.459, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=227.1, ups=0.59, wpb=385.8, bsz=32, num_updates=36740, lr=6.22462e-06, gnorm=3.264, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76694
2022-05-09 18:07:24 - progress_bar.py[line:272] - INFO: epoch 003:   1382 / 17711 loss=2.913, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=382, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.913, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.798, expert1_balance_bottom=19.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=222.2, ups=0.58, wpb=382, bsz=32, num_updates=36750, lr=6.22342e-06, gnorm=3.579, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76712
2022-05-09 18:07:41 - progress_bar.py[line:272] - INFO: epoch 003:   1392 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=387.9, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881508, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.495, expert1_balance_bottom=19.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=226.9, ups=0.58, wpb=387.9, bsz=32, num_updates=36760, lr=6.22222e-06, gnorm=3.079, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76729
2022-05-09 18:07:58 - progress_bar.py[line:272] - INFO: epoch 003:   1402 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=375.6, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89549, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.954, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.8, ups=0.59, wpb=375.6, bsz=32, num_updates=36770, lr=6.22102e-06, gnorm=3.778, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76746
2022-05-09 18:08:15 - progress_bar.py[line:272] - INFO: epoch 003:   1412 / 17711 loss=2.922, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=382.8, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887511, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.922, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.52, expert1_balance_bottom=19.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=224, ups=0.59, wpb=382.8, bsz=32, num_updates=36780, lr=6.21982e-06, gnorm=3.09, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76763
2022-05-09 18:08:32 - progress_bar.py[line:272] - INFO: epoch 003:   1422 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=386.4, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887363, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.567, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=225, ups=0.58, wpb=386.4, bsz=32, num_updates=36790, lr=6.21862e-06, gnorm=3.321, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76780
2022-05-09 18:08:50 - progress_bar.py[line:272] - INFO: epoch 003:   1432 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=386.6, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=34.27, expert1_balance_bottom=19.143, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218, ups=0.56, wpb=386.6, bsz=32, num_updates=36800, lr=6.21741e-06, gnorm=3.354, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76798
2022-05-09 18:09:07 - progress_bar.py[line:272] - INFO: epoch 003:   1442 / 17711 loss=2.899, loss_v1=0, loss_v2=0, nll_loss=0.66, ntokens=384.6, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.899, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.461, expert1_balance_bottom=19.775, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.58, wps=222.5, ups=0.58, wpb=384.6, bsz=32, num_updates=36810, lr=6.21621e-06, gnorm=3.217, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76815
2022-05-09 18:09:24 - progress_bar.py[line:272] - INFO: epoch 003:   1452 / 17711 loss=2.919, loss_v1=0, loss_v2=0, nll_loss=0.697, ntokens=383.2, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886179, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.919, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.5, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=221.2, ups=0.58, wpb=383.2, bsz=32, num_updates=36820, lr=6.21501e-06, gnorm=3.507, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76832
2022-05-09 18:09:42 - progress_bar.py[line:272] - INFO: epoch 003:   1462 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=388.8, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870973, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.033, expert1_balance_bottom=19.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.8, ups=0.57, wpb=388.8, bsz=32, num_updates=36830, lr=6.21381e-06, gnorm=3.748, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76850
2022-05-09 18:09:59 - progress_bar.py[line:272] - INFO: epoch 003:   1472 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=380.5, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879783, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.335, expert1_balance_bottom=19.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.4, ups=0.58, wpb=380.5, bsz=32, num_updates=36840, lr=6.21261e-06, gnorm=3.885, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76867
2022-05-09 18:10:16 - progress_bar.py[line:272] - INFO: epoch 003:   1482 / 17711 loss=2.898, loss_v1=0, loss_v2=0, nll_loss=0.674, ntokens=385.1, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885579, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.898, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.045, expert1_balance_bottom=19.44, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=226, ups=0.59, wpb=385.1, bsz=32, num_updates=36850, lr=6.21141e-06, gnorm=2.703, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76884
2022-05-09 18:10:33 - progress_bar.py[line:272] - INFO: epoch 003:   1492 / 17711 loss=2.914, loss_v1=0, loss_v2=0, nll_loss=0.697, ntokens=375.9, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882611, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.914, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.659, expert1_balance_bottom=19.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=217.5, ups=0.58, wpb=375.9, bsz=32, num_updates=36860, lr=6.21021e-06, gnorm=3.528, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76902
2022-05-09 18:10:51 - progress_bar.py[line:272] - INFO: epoch 003:   1502 / 17711 loss=2.892, loss_v1=0, loss_v2=0, nll_loss=0.651, ntokens=380.7, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899044, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.892, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.667, expert1_balance_bottom=19.786, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.57, wps=221.1, ups=0.58, wpb=380.7, bsz=32, num_updates=36870, lr=6.20901e-06, gnorm=2.872, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76919
2022-05-09 18:11:08 - progress_bar.py[line:272] - INFO: epoch 003:   1512 / 17711 loss=2.921, loss_v1=0, loss_v2=0, nll_loss=0.701, ntokens=383.5, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.921, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.171, expert1_balance_bottom=19.063, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=221.4, ups=0.58, wpb=383.5, bsz=32, num_updates=36880, lr=6.2078e-06, gnorm=4.284, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76936
2022-05-09 18:11:25 - progress_bar.py[line:272] - INFO: epoch 003:   1522 / 17711 loss=2.941, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=385.1, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.941, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.338, expert1_balance_bottom=19.452, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=223.1, ups=0.58, wpb=385.1, bsz=32, num_updates=36890, lr=6.2066e-06, gnorm=3.367, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76953
2022-05-09 18:11:42 - progress_bar.py[line:272] - INFO: epoch 003:   1532 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=386.2, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.272, expert1_balance_bottom=19.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=226.5, ups=0.59, wpb=386.2, bsz=32, num_updates=36900, lr=6.2054e-06, gnorm=3.325, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76970
2022-05-09 18:12:00 - progress_bar.py[line:272] - INFO: epoch 003:   1542 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880458, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.006, expert1_balance_bottom=19.181, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=220.9, ups=0.58, wpb=381.6, bsz=32, num_updates=36910, lr=6.2042e-06, gnorm=3.31, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=76988
2022-05-09 18:12:17 - progress_bar.py[line:272] - INFO: epoch 003:   1552 / 17711 loss=2.932, loss_v1=0, loss_v2=0, nll_loss=0.706, ntokens=376.8, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.932, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.871, expert1_balance_bottom=19.665, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=218.5, ups=0.58, wpb=376.8, bsz=32, num_updates=36920, lr=6.203e-06, gnorm=3.406, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77005
2022-05-09 18:12:34 - progress_bar.py[line:272] - INFO: epoch 003:   1562 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=389.4, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.163, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=225.1, ups=0.58, wpb=389.4, bsz=32, num_updates=36930, lr=6.2018e-06, gnorm=3.44, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77022
2022-05-09 18:12:52 - progress_bar.py[line:272] - INFO: epoch 003:   1572 / 17711 loss=2.943, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=377.2, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.943, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.157, expert1_balance_bottom=19.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=213, ups=0.56, wpb=377.2, bsz=32, num_updates=36940, lr=6.2006e-06, gnorm=3.447, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77040
2022-05-09 18:13:09 - progress_bar.py[line:272] - INFO: epoch 003:   1582 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=387.3, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877318, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.791, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=225.7, ups=0.58, wpb=387.3, bsz=32, num_updates=36950, lr=6.19939e-06, gnorm=3.756, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77057
2022-05-09 18:13:26 - progress_bar.py[line:272] - INFO: epoch 003:   1592 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=380.3, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.208, expert1_balance_bottom=19.433, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223, ups=0.59, wpb=380.3, bsz=32, num_updates=36960, lr=6.19819e-06, gnorm=3.75, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77074
2022-05-09 18:13:43 - progress_bar.py[line:272] - INFO: epoch 003:   1602 / 17711 loss=2.899, loss_v1=0, loss_v2=0, nll_loss=0.676, ntokens=387.2, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882402, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.899, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.919, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=227.8, ups=0.59, wpb=387.2, bsz=32, num_updates=36970, lr=6.19699e-06, gnorm=3.2, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77091
2022-05-09 18:14:00 - progress_bar.py[line:272] - INFO: epoch 003:   1612 / 17711 loss=2.917, loss_v1=0, loss_v2=0, nll_loss=0.677, ntokens=377.8, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.917, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=33.377, expert1_balance_bottom=19.649, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=217.1, ups=0.57, wpb=377.8, bsz=32, num_updates=36980, lr=6.19579e-06, gnorm=3.211, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77108
2022-05-09 18:14:18 - progress_bar.py[line:272] - INFO: epoch 003:   1622 / 17711 loss=2.915, loss_v1=0, loss_v2=0, nll_loss=0.692, ntokens=387.6, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882619, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.915, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.841, expert1_balance_bottom=19.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=225.7, ups=0.58, wpb=387.6, bsz=32, num_updates=36990, lr=6.19459e-06, gnorm=3.36, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77126
2022-05-09 18:14:35 - progress_bar.py[line:272] - INFO: epoch 003:   1632 / 17711 loss=2.921, loss_v1=0, loss_v2=0, nll_loss=0.705, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877736, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.921, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.209, expert1_balance_bottom=19.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=218.7, ups=0.58, wpb=380.4, bsz=32, num_updates=37000, lr=6.19339e-06, gnorm=3.66, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77143
2022-05-09 18:14:52 - progress_bar.py[line:272] - INFO: epoch 003:   1642 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.021, expert1_balance_bottom=19.162, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.5, ups=0.58, wpb=377.9, bsz=32, num_updates=37010, lr=6.19219e-06, gnorm=3.243, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77160
2022-05-09 18:15:10 - progress_bar.py[line:272] - INFO: epoch 003:   1652 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=378.9, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.986, expert1_balance_bottom=19.57, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=219, ups=0.58, wpb=378.9, bsz=32, num_updates=37020, lr=6.19099e-06, gnorm=3.765, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77178
2022-05-09 18:15:27 - progress_bar.py[line:272] - INFO: epoch 003:   1662 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=386.2, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.86734, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.679, expert1_balance_bottom=18.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=227.1, ups=0.59, wpb=386.2, bsz=32, num_updates=37030, lr=6.18978e-06, gnorm=3.673, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77195
2022-05-09 18:15:44 - progress_bar.py[line:272] - INFO: epoch 003:   1672 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88267, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.663, expert1_balance_bottom=19.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=223, ups=0.58, wpb=384.1, bsz=32, num_updates=37040, lr=6.18858e-06, gnorm=3.467, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77212
2022-05-09 18:16:01 - progress_bar.py[line:272] - INFO: epoch 003:   1682 / 17711 loss=2.866, loss_v1=0, loss_v2=0, nll_loss=0.633, ntokens=383.1, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887477, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.866, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.386, expert1_balance_bottom=19.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.55, wps=225.5, ups=0.59, wpb=383.1, bsz=32, num_updates=37050, lr=6.18738e-06, gnorm=4.084, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77229
2022-05-09 18:16:18 - progress_bar.py[line:272] - INFO: epoch 003:   1692 / 17711 loss=2.896, loss_v1=0, loss_v2=0, nll_loss=0.671, ntokens=389.8, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.896, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.464, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=227, ups=0.58, wpb=389.8, bsz=32, num_updates=37060, lr=6.18618e-06, gnorm=3.608, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77246
2022-05-09 18:16:28 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 18:16:37 - progress_bar.py[line:272] - INFO: epoch 003:   1703 / 17711 loss=2.941, loss_v1=0, loss_v2=0, nll_loss=0.716, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.941, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.379, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=203.9, ups=0.53, wpb=382.7, bsz=32, num_updates=37070, lr=6.18498e-06, gnorm=3.748, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77265
2022-05-09 18:16:54 - progress_bar.py[line:272] - INFO: epoch 003:   1713 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887993, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.602, expert1_balance_bottom=19.172, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=223.5, ups=0.59, wpb=380.8, bsz=32, num_updates=37080, lr=6.18378e-06, gnorm=3.491, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77282
2022-05-09 18:17:11 - progress_bar.py[line:272] - INFO: epoch 003:   1723 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.709, ntokens=386.2, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.415, expert1_balance_bottom=19.343, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=227.1, ups=0.59, wpb=386.2, bsz=32, num_updates=37090, lr=6.18258e-06, gnorm=3.338, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77299
2022-05-09 18:17:28 - progress_bar.py[line:272] - INFO: epoch 003:   1733 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=389.8, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.05, expert1_balance_bottom=19.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=225.7, ups=0.58, wpb=389.8, bsz=32, num_updates=37100, lr=6.18137e-06, gnorm=3.889, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77316
2022-05-09 18:17:45 - progress_bar.py[line:272] - INFO: epoch 003:   1743 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=380.3, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885763, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.454, expert1_balance_bottom=19.3, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.7, ups=0.58, wpb=380.3, bsz=32, num_updates=37110, lr=6.18017e-06, gnorm=3.665, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77333
2022-05-09 18:18:02 - progress_bar.py[line:272] - INFO: epoch 003:   1753 / 17711 loss=2.921, loss_v1=0, loss_v2=0, nll_loss=0.704, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.921, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.075, expert1_balance_bottom=19.009, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=227.7, ups=0.59, wpb=385.7, bsz=32, num_updates=37120, lr=6.17897e-06, gnorm=4.094, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77350
2022-05-09 18:18:19 - progress_bar.py[line:272] - INFO: epoch 003:   1763 / 17711 loss=2.924, loss_v1=0, loss_v2=0, nll_loss=0.702, ntokens=384.6, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884442, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.924, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.724, expert1_balance_bottom=19.144, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=224.2, ups=0.58, wpb=384.6, bsz=32, num_updates=37130, lr=6.17777e-06, gnorm=3.379, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77368
2022-05-09 18:18:37 - progress_bar.py[line:272] - INFO: epoch 003:   1773 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=374, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88923, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.471, expert1_balance_bottom=19.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=213.5, ups=0.57, wpb=374, bsz=32, num_updates=37140, lr=6.17657e-06, gnorm=3.596, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77385
2022-05-09 18:18:54 - progress_bar.py[line:272] - INFO: epoch 003:   1783 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.117, expert1_balance_top=33.388, expert1_balance_bottom=19.616, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=226.2, ups=0.59, wpb=381.9, bsz=32, num_updates=37150, lr=6.17537e-06, gnorm=3.734, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77402
2022-05-09 18:19:11 - progress_bar.py[line:272] - INFO: epoch 003:   1793 / 17711 loss=2.929, loss_v1=0, loss_v2=0, nll_loss=0.706, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884489, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.929, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.55, expert1_balance_bottom=19.318, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=219.7, ups=0.58, wpb=378.8, bsz=32, num_updates=37160, lr=6.17417e-06, gnorm=3.945, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77419
2022-05-09 18:19:28 - progress_bar.py[line:272] - INFO: epoch 003:   1803 / 17711 loss=2.903, loss_v1=0, loss_v2=0, nll_loss=0.676, ntokens=389.2, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.903, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.288, expert1_balance_bottom=19.513, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=225, ups=0.58, wpb=389.2, bsz=32, num_updates=37170, lr=6.17297e-06, gnorm=3.232, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77436
2022-05-09 18:19:46 - progress_bar.py[line:272] - INFO: epoch 003:   1813 / 17711 loss=2.943, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=383.1, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888476, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.943, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.534, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=217.7, ups=0.57, wpb=383.1, bsz=32, num_updates=37180, lr=6.17176e-06, gnorm=3.52, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77454
2022-05-09 18:20:03 - progress_bar.py[line:272] - INFO: epoch 003:   1823 / 17711 loss=2.93, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=390.1, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87139, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.93, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.182, expert1_balance_bottom=19.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=227.8, ups=0.58, wpb=390.1, bsz=32, num_updates=37190, lr=6.17056e-06, gnorm=3.504, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77471
2022-05-09 18:20:21 - progress_bar.py[line:272] - INFO: epoch 003:   1833 / 17711 loss=2.898, loss_v1=0, loss_v2=0, nll_loss=0.663, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89234, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.898, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.178, expert1_balance_bottom=19.497, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.58, wps=218.6, ups=0.57, wpb=380.4, bsz=32, num_updates=37200, lr=6.16936e-06, gnorm=3.195, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77489
2022-05-09 18:20:38 - progress_bar.py[line:272] - INFO: epoch 003:   1843 / 17711 loss=2.941, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=382.8, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.941, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.115, expert1_balance_bottom=19.095, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=220.5, ups=0.58, wpb=382.8, bsz=32, num_updates=37210, lr=6.16816e-06, gnorm=3.368, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77506
2022-05-09 18:20:56 - progress_bar.py[line:272] - INFO: epoch 003:   1853 / 17711 loss=2.908, loss_v1=0, loss_v2=0, nll_loss=0.683, ntokens=384.6, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884609, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.908, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.423, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=218.5, ups=0.57, wpb=384.6, bsz=32, num_updates=37220, lr=6.16696e-06, gnorm=3.219, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77524
2022-05-09 18:21:13 - progress_bar.py[line:272] - INFO: epoch 003:   1863 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=388.6, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88196, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.74, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.2, ups=0.58, wpb=388.6, bsz=32, num_updates=37230, lr=6.16576e-06, gnorm=3.351, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77541
2022-05-09 18:21:30 - progress_bar.py[line:272] - INFO: epoch 003:   1873 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.705, ntokens=376.7, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895489, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.929, expert1_balance_bottom=19.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=223.1, ups=0.59, wpb=376.7, bsz=32, num_updates=37240, lr=6.16456e-06, gnorm=3.337, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77558
2022-05-09 18:21:47 - progress_bar.py[line:272] - INFO: epoch 003:   1883 / 17711 loss=2.917, loss_v1=0, loss_v2=0, nll_loss=0.69, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886612, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.917, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.707, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=215.8, ups=0.57, wpb=381.2, bsz=32, num_updates=37250, lr=6.16336e-06, gnorm=3.582, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77575
2022-05-09 18:22:05 - progress_bar.py[line:272] - INFO: epoch 003:   1893 / 17711 loss=2.906, loss_v1=0, loss_v2=0, nll_loss=0.687, ntokens=386.7, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878011, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.906, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.953, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=222, ups=0.57, wpb=386.7, bsz=32, num_updates=37260, lr=6.16215e-06, gnorm=3.226, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77593
2022-05-09 18:22:23 - progress_bar.py[line:272] - INFO: epoch 003:   1903 / 17711 loss=2.919, loss_v1=0, loss_v2=0, nll_loss=0.695, ntokens=391.8, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.919, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=35.082, expert1_balance_bottom=19.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=220.5, ups=0.56, wpb=391.8, bsz=32, num_updates=37270, lr=6.16095e-06, gnorm=3.577, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77611
2022-05-09 18:22:40 - progress_bar.py[line:272] - INFO: epoch 003:   1913 / 17711 loss=2.912, loss_v1=0, loss_v2=0, nll_loss=0.7, ntokens=387.3, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864564, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.912, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=36.018, expert1_balance_bottom=18.952, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=227, ups=0.59, wpb=387.3, bsz=32, num_updates=37280, lr=6.15975e-06, gnorm=3.169, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77628
2022-05-09 18:22:57 - progress_bar.py[line:272] - INFO: epoch 003:   1923 / 17711 loss=2.9, loss_v1=0, loss_v2=0, nll_loss=0.672, ntokens=377.2, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.9, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.689, expert1_balance_bottom=19.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=219.7, ups=0.58, wpb=377.2, bsz=32, num_updates=37290, lr=6.15855e-06, gnorm=4.106, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77645
2022-05-09 18:23:14 - progress_bar.py[line:272] - INFO: epoch 003:   1933 / 17711 loss=2.918, loss_v1=0, loss_v2=0, nll_loss=0.696, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.918, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.058, expert1_balance_bottom=19.216, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=220.5, ups=0.57, wpb=385.7, bsz=32, num_updates=37300, lr=6.15735e-06, gnorm=3.326, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77662
2022-05-09 18:23:31 - progress_bar.py[line:272] - INFO: epoch 003:   1943 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.701, ntokens=372.4, nsentences=32, sample_size=296.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.211, expert1_balance_bottom=19.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=216.7, ups=0.58, wpb=372.4, bsz=32, num_updates=37310, lr=6.15615e-06, gnorm=3.068, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77680
2022-05-09 18:23:49 - progress_bar.py[line:272] - INFO: epoch 003:   1953 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881373, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.755, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=225.5, ups=0.58, wpb=387.2, bsz=32, num_updates=37320, lr=6.15495e-06, gnorm=3.258, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77697
2022-05-09 18:24:06 - progress_bar.py[line:272] - INFO: epoch 003:   1963 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=374.1, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893547, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.738, expert1_balance_bottom=19.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.6, ups=0.59, wpb=374.1, bsz=32, num_updates=37330, lr=6.15374e-06, gnorm=3.325, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77714
2022-05-09 18:24:23 - progress_bar.py[line:272] - INFO: epoch 003:   1973 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=379.9, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89376, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.096, expert1_balance_bottom=19.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=221.1, ups=0.58, wpb=379.9, bsz=32, num_updates=37340, lr=6.15254e-06, gnorm=3.576, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77731
2022-05-09 18:24:40 - progress_bar.py[line:272] - INFO: epoch 003:   1983 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.715, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884735, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.175, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=222.3, ups=0.58, wpb=381, bsz=32, num_updates=37350, lr=6.15134e-06, gnorm=3.139, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77748
2022-05-09 18:24:57 - progress_bar.py[line:272] - INFO: epoch 003:   1993 / 17711 loss=2.914, loss_v1=0, loss_v2=0, nll_loss=0.679, ntokens=384.7, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.914, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.606, expert1_balance_bottom=19.703, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=224, ups=0.58, wpb=384.7, bsz=32, num_updates=37360, lr=6.15014e-06, gnorm=3.324, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77765
2022-05-09 18:25:15 - progress_bar.py[line:272] - INFO: epoch 003:   2003 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=388.8, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.46, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=222.4, ups=0.57, wpb=388.8, bsz=32, num_updates=37370, lr=6.14894e-06, gnorm=4.334, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77783
2022-05-09 18:25:32 - progress_bar.py[line:272] - INFO: epoch 003:   2013 / 17711 loss=2.924, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=392.6, nsentences=32, sample_size=312.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87536, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.924, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.333, expert1_balance_bottom=19.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=225.5, ups=0.57, wpb=392.6, bsz=32, num_updates=37380, lr=6.14774e-06, gnorm=3.733, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77800
2022-05-09 18:25:49 - progress_bar.py[line:272] - INFO: epoch 003:   2023 / 17711 loss=2.913, loss_v1=0, loss_v2=0, nll_loss=0.686, ntokens=377.6, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889138, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.913, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.307, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=220.9, ups=0.59, wpb=377.6, bsz=32, num_updates=37390, lr=6.14654e-06, gnorm=3.257, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77817
2022-05-09 18:26:06 - progress_bar.py[line:272] - INFO: epoch 003:   2033 / 17711 loss=2.929, loss_v1=0, loss_v2=0, nll_loss=0.701, ntokens=377.2, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.929, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.321, expert1_balance_bottom=19.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=218.4, ups=0.58, wpb=377.2, bsz=32, num_updates=37400, lr=6.14534e-06, gnorm=2.975, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77834
2022-05-09 18:26:24 - progress_bar.py[line:272] - INFO: epoch 003:   2043 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883101, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.626, expert1_balance_bottom=19.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=220.4, ups=0.57, wpb=384.8, bsz=32, num_updates=37410, lr=6.14413e-06, gnorm=3.791, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77852
2022-05-09 18:26:41 - progress_bar.py[line:272] - INFO: epoch 003:   2053 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89029, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.963, expert1_balance_bottom=19.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.3, ups=0.58, wpb=383.9, bsz=32, num_updates=37420, lr=6.14293e-06, gnorm=3.496, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77869
2022-05-09 18:26:58 - progress_bar.py[line:272] - INFO: epoch 003:   2063 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=390.6, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883598, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=35.104, expert1_balance_bottom=19.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=227, ups=0.58, wpb=390.6, bsz=32, num_updates=37430, lr=6.14173e-06, gnorm=3.307, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77886
2022-05-09 18:27:15 - progress_bar.py[line:272] - INFO: epoch 003:   2073 / 17711 loss=2.902, loss_v1=0, loss_v2=0, nll_loss=0.666, ntokens=382.3, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894085, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.902, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.975, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=225.2, ups=0.59, wpb=382.3, bsz=32, num_updates=37440, lr=6.14053e-06, gnorm=3.392, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77903
2022-05-09 18:27:33 - progress_bar.py[line:272] - INFO: epoch 003:   2083 / 17711 loss=2.944, loss_v1=0, loss_v2=0, nll_loss=0.716, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892053, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.398, expert1_balance_bottom=19.511, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=218.2, ups=0.58, wpb=378.8, bsz=32, num_updates=37450, lr=6.13933e-06, gnorm=3.859, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77921
2022-05-09 18:27:50 - progress_bar.py[line:272] - INFO: epoch 003:   2093 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=394.2, nsentences=32, sample_size=313.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877187, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.567, expert1_balance_bottom=19.416, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=227.4, ups=0.58, wpb=394.2, bsz=32, num_updates=37460, lr=6.13813e-06, gnorm=3.253, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77938
2022-05-09 18:28:08 - progress_bar.py[line:272] - INFO: epoch 003:   2103 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=390, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888922, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.971, expert1_balance_bottom=19.629, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.5, ups=0.57, wpb=390, bsz=32, num_updates=37470, lr=6.13693e-06, gnorm=4.139, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77956
2022-05-09 18:28:25 - progress_bar.py[line:272] - INFO: epoch 003:   2113 / 17711 loss=2.89, loss_v1=0, loss_v2=0, nll_loss=0.672, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875758, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.89, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.707, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=222.5, ups=0.58, wpb=382.4, bsz=32, num_updates=37480, lr=6.13572e-06, gnorm=3.033, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77973
2022-05-09 18:28:42 - progress_bar.py[line:272] - INFO: epoch 003:   2123 / 17711 loss=2.941, loss_v1=0, loss_v2=0, nll_loss=0.705, ntokens=377.6, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.941, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.151, expert1_balance_bottom=19.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=217.9, ups=0.58, wpb=377.6, bsz=32, num_updates=37490, lr=6.13452e-06, gnorm=3.737, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=77990
2022-05-09 18:28:59 - progress_bar.py[line:272] - INFO: epoch 003:   2133 / 17711 loss=2.889, loss_v1=0, loss_v2=0, nll_loss=0.659, ntokens=387.5, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886238, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.889, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.957, expert1_balance_bottom=19.116, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.58, wps=222.5, ups=0.57, wpb=387.5, bsz=32, num_updates=37500, lr=6.13332e-06, gnorm=3.421, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78007
2022-05-09 18:29:17 - progress_bar.py[line:272] - INFO: epoch 003:   2143 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=383, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8908, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.065, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=221.1, ups=0.58, wpb=383, bsz=32, num_updates=37510, lr=6.13212e-06, gnorm=3.422, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78025
2022-05-09 18:29:34 - progress_bar.py[line:272] - INFO: epoch 003:   2153 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=384.5, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88435, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.878, expert1_balance_bottom=19.283, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=224.5, ups=0.58, wpb=384.5, bsz=32, num_updates=37520, lr=6.13092e-06, gnorm=3.741, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78042
2022-05-09 18:29:51 - progress_bar.py[line:272] - INFO: epoch 003:   2163 / 17711 loss=2.933, loss_v1=0, loss_v2=0, nll_loss=0.696, ntokens=369.8, nsentences=32, sample_size=294.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901603, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.933, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=33.52, expert1_balance_bottom=19.64, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=215.4, ups=0.58, wpb=369.8, bsz=32, num_updates=37530, lr=6.12972e-06, gnorm=3.356, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78059
2022-05-09 18:30:08 - progress_bar.py[line:272] - INFO: epoch 003:   2173 / 17711 loss=2.909, loss_v1=0, loss_v2=0, nll_loss=0.678, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.909, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.549, expert1_balance_bottom=19.146, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=219.5, ups=0.58, wpb=379.3, bsz=32, num_updates=37540, lr=6.12852e-06, gnorm=3.058, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78076
2022-05-09 18:30:26 - progress_bar.py[line:272] - INFO: epoch 003:   2183 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=378.3, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.623, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=217.6, ups=0.58, wpb=378.3, bsz=32, num_updates=37550, lr=6.12732e-06, gnorm=3.118, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78094
2022-05-09 18:30:43 - progress_bar.py[line:272] - INFO: epoch 003:   2193 / 17711 loss=2.907, loss_v1=0, loss_v2=0, nll_loss=0.688, ntokens=387.3, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.907, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=35.023, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=220.7, ups=0.57, wpb=387.3, bsz=32, num_updates=37560, lr=6.12611e-06, gnorm=3.268, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78111
2022-05-09 18:31:01 - progress_bar.py[line:272] - INFO: epoch 003:   2203 / 17711 loss=2.922, loss_v1=0, loss_v2=0, nll_loss=0.686, ntokens=385, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893945, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.922, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.69, expert1_balance_bottom=19.618, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=221.3, ups=0.57, wpb=385, bsz=32, num_updates=37570, lr=6.12491e-06, gnorm=3.456, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78129
2022-05-09 18:31:18 - progress_bar.py[line:272] - INFO: epoch 003:   2213 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=381, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901609, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.519, expert1_balance_bottom=19.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.8, ups=0.57, wpb=381, bsz=32, num_updates=37580, lr=6.12371e-06, gnorm=4.076, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78146
2022-05-09 18:31:35 - progress_bar.py[line:272] - INFO: epoch 003:   2223 / 17711 loss=2.915, loss_v1=0, loss_v2=0, nll_loss=0.68, ntokens=377.4, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.915, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.314, expert1_balance_bottom=19.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=216.6, ups=0.57, wpb=377.4, bsz=32, num_updates=37590, lr=6.12251e-06, gnorm=2.988, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78164
2022-05-09 18:31:53 - progress_bar.py[line:272] - INFO: epoch 003:   2233 / 17711 loss=2.873, loss_v1=0, loss_v2=0, nll_loss=0.648, ntokens=392.9, nsentences=32, sample_size=312.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.873, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.602, expert1_balance_bottom=19.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.57, wps=227.2, ups=0.58, wpb=392.9, bsz=32, num_updates=37600, lr=6.12131e-06, gnorm=3.323, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78181
2022-05-09 18:32:10 - progress_bar.py[line:272] - INFO: epoch 003:   2243 / 17711 loss=2.894, loss_v1=0, loss_v2=0, nll_loss=0.672, ntokens=380.6, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882301, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.894, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.88, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=216.7, ups=0.57, wpb=380.6, bsz=32, num_updates=37610, lr=6.12011e-06, gnorm=3.113, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78198
2022-05-09 18:32:28 - progress_bar.py[line:272] - INFO: epoch 003:   2253 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=377.5, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887463, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.312, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=212.4, ups=0.56, wpb=377.5, bsz=32, num_updates=37620, lr=6.11891e-06, gnorm=3.73, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78216
2022-05-09 18:32:46 - progress_bar.py[line:272] - INFO: epoch 003:   2263 / 17711 loss=2.933, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=378.6, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.933, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.074, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=213.2, ups=0.56, wpb=378.6, bsz=32, num_updates=37630, lr=6.11771e-06, gnorm=3.698, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78234
2022-05-09 18:33:03 - progress_bar.py[line:272] - INFO: epoch 003:   2273 / 17711 loss=2.937, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.937, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=35.142, expert1_balance_bottom=19.14, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.9, ups=0.58, wpb=381.7, bsz=32, num_updates=37640, lr=6.1165e-06, gnorm=3.855, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78251
2022-05-09 18:33:20 - progress_bar.py[line:272] - INFO: epoch 003:   2283 / 17711 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=380.2, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.951, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.724, expert1_balance_bottom=19.142, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=220.7, ups=0.58, wpb=380.2, bsz=32, num_updates=37650, lr=6.1153e-06, gnorm=3.546, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78269
2022-05-09 18:33:37 - progress_bar.py[line:272] - INFO: epoch 003:   2293 / 17711 loss=2.931, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=387.3, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891615, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.931, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.932, expert1_balance_bottom=19.499, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=228.5, ups=0.59, wpb=387.3, bsz=32, num_updates=37660, lr=6.1141e-06, gnorm=3.31, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78285
2022-05-09 18:33:55 - progress_bar.py[line:272] - INFO: epoch 003:   2303 / 17711 loss=2.906, loss_v1=0, loss_v2=0, nll_loss=0.689, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.906, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=35.002, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=220.9, ups=0.58, wpb=381.6, bsz=32, num_updates=37670, lr=6.1129e-06, gnorm=3.939, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78303
2022-05-09 18:34:12 - progress_bar.py[line:272] - INFO: epoch 003:   2313 / 17711 loss=2.875, loss_v1=0, loss_v2=0, nll_loss=0.651, ntokens=391.1, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.875, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.917, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.57, wps=227.8, ups=0.58, wpb=391.1, bsz=32, num_updates=37680, lr=6.1117e-06, gnorm=3.379, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78320
2022-05-09 18:34:29 - progress_bar.py[line:272] - INFO: epoch 003:   2323 / 17711 loss=2.942, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=385.4, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.942, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.21, expert1_balance_bottom=19.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.5, ups=0.58, wpb=385.4, bsz=32, num_updates=37690, lr=6.1105e-06, gnorm=3.41, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78337
2022-05-09 18:34:46 - progress_bar.py[line:272] - INFO: epoch 003:   2333 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=389, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.481, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=228, ups=0.59, wpb=389, bsz=32, num_updates=37700, lr=6.1093e-06, gnorm=4.466, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78354
2022-05-09 18:35:04 - progress_bar.py[line:272] - INFO: epoch 003:   2343 / 17711 loss=2.903, loss_v1=0, loss_v2=0, nll_loss=0.676, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88762, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.903, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.584, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=220, ups=0.57, wpb=382.8, bsz=32, num_updates=37710, lr=6.10809e-06, gnorm=3.241, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78372
2022-05-09 18:35:21 - progress_bar.py[line:272] - INFO: epoch 003:   2353 / 17711 loss=2.928, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=398.2, nsentences=32, sample_size=316.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.860069, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.928, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=36.201, expert1_balance_bottom=18.8, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=227.3, ups=0.57, wpb=398.2, bsz=32, num_updates=37720, lr=6.10689e-06, gnorm=3.448, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78389
2022-05-09 18:35:39 - progress_bar.py[line:272] - INFO: epoch 003:   2363 / 17711 loss=2.915, loss_v1=0, loss_v2=0, nll_loss=0.691, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.915, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.152, expert1_balance_bottom=19.399, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=221.2, ups=0.57, wpb=385.5, bsz=32, num_updates=37730, lr=6.10569e-06, gnorm=3.799, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78407
2022-05-09 18:35:56 - progress_bar.py[line:272] - INFO: epoch 003:   2373 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.71, ntokens=374.3, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.925, expert1_balance_bottom=19.644, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=214.3, ups=0.57, wpb=374.3, bsz=32, num_updates=37740, lr=6.10449e-06, gnorm=3.374, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78424
2022-05-09 18:36:14 - progress_bar.py[line:272] - INFO: epoch 003:   2383 / 17711 loss=2.9, loss_v1=0, loss_v2=0, nll_loss=0.672, ntokens=377.6, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888698, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.9, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.53, expert1_balance_bottom=19.29, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=215.5, ups=0.57, wpb=377.6, bsz=32, num_updates=37750, lr=6.10329e-06, gnorm=3.816, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78442
2022-05-09 18:36:31 - progress_bar.py[line:272] - INFO: epoch 003:   2393 / 17711 loss=2.91, loss_v1=0, loss_v2=0, nll_loss=0.69, ntokens=389.8, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880727, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.91, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.82, expert1_balance_bottom=19.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=221.5, ups=0.57, wpb=389.8, bsz=32, num_updates=37760, lr=6.10209e-06, gnorm=3.391, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78459
2022-05-09 18:36:49 - progress_bar.py[line:272] - INFO: epoch 003:   2403 / 17711 loss=2.881, loss_v1=0, loss_v2=0, nll_loss=0.658, ntokens=386.7, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881211, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.881, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=35.28, expert1_balance_bottom=19.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.58, wps=221, ups=0.57, wpb=386.7, bsz=32, num_updates=37770, lr=6.10089e-06, gnorm=3.179, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78477
2022-05-09 18:37:06 - progress_bar.py[line:272] - INFO: epoch 003:   2413 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=384, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.415, expert1_balance_bottom=19.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216.4, ups=0.56, wpb=384, bsz=32, num_updates=37780, lr=6.09969e-06, gnorm=3.46, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78494
2022-05-09 18:37:24 - progress_bar.py[line:272] - INFO: epoch 003:   2423 / 17711 loss=2.937, loss_v1=0, loss_v2=0, nll_loss=0.713, ntokens=376.4, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887807, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.937, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.358, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=215.9, ups=0.57, wpb=376.4, bsz=32, num_updates=37790, lr=6.09848e-06, gnorm=3.924, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78512
2022-05-09 18:37:41 - progress_bar.py[line:272] - INFO: epoch 003:   2433 / 17711 loss=2.933, loss_v1=0, loss_v2=0, nll_loss=0.699, ntokens=377.1, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895049, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.933, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.851, expert1_balance_bottom=19.708, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=218.8, ups=0.58, wpb=377.1, bsz=32, num_updates=37800, lr=6.09728e-06, gnorm=3.264, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78529
2022-05-09 18:37:58 - progress_bar.py[line:272] - INFO: epoch 003:   2443 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890602, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.132, expert1_balance_bottom=19.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=222.9, ups=0.58, wpb=381.8, bsz=32, num_updates=37810, lr=6.09608e-06, gnorm=3.641, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78546
2022-05-09 18:38:15 - progress_bar.py[line:272] - INFO: epoch 003:   2453 / 17711 loss=2.89, loss_v1=0, loss_v2=0, nll_loss=0.661, ntokens=383.4, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878707, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.89, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.8, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.58, wps=222.3, ups=0.58, wpb=383.4, bsz=32, num_updates=37820, lr=6.09488e-06, gnorm=3.531, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78564
2022-05-09 18:38:33 - progress_bar.py[line:272] - INFO: epoch 003:   2463 / 17711 loss=2.901, loss_v1=0, loss_v2=0, nll_loss=0.667, ntokens=382.7, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.901, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.985, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=216.7, ups=0.57, wpb=382.7, bsz=32, num_updates=37830, lr=6.09368e-06, gnorm=3.255, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78581
2022-05-09 18:38:50 - progress_bar.py[line:272] - INFO: epoch 003:   2473 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=379.8, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89723, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.809, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=218.8, ups=0.58, wpb=379.8, bsz=32, num_updates=37840, lr=6.09248e-06, gnorm=3.454, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78599
2022-05-09 18:39:08 - progress_bar.py[line:272] - INFO: epoch 003:   2483 / 17711 loss=2.898, loss_v1=0, loss_v2=0, nll_loss=0.677, ntokens=388.6, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883316, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.898, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.856, expert1_balance_bottom=19.161, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=221.8, ups=0.57, wpb=388.6, bsz=32, num_updates=37850, lr=6.09128e-06, gnorm=2.858, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78616
2022-05-09 18:39:26 - progress_bar.py[line:272] - INFO: epoch 003:   2493 / 17711 loss=2.931, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885331, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.931, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.845, expert1_balance_bottom=19.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=211, ups=0.55, wpb=380.8, bsz=32, num_updates=37860, lr=6.09007e-06, gnorm=3.916, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78634
2022-05-09 18:39:43 - progress_bar.py[line:272] - INFO: epoch 003:   2503 / 17711 loss=2.93, loss_v1=0, loss_v2=0, nll_loss=0.712, ntokens=383.7, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879563, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.93, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.925, expert1_balance_bottom=19.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=221.8, ups=0.58, wpb=383.7, bsz=32, num_updates=37870, lr=6.08887e-06, gnorm=3.766, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78651
2022-05-09 18:40:00 - progress_bar.py[line:272] - INFO: epoch 003:   2513 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=377, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=35.145, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.7, ups=0.59, wpb=377, bsz=32, num_updates=37880, lr=6.08767e-06, gnorm=3.676, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78668
2022-05-09 18:40:18 - progress_bar.py[line:272] - INFO: epoch 003:   2523 / 17711 loss=2.939, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.939, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.752, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=221.3, ups=0.57, wpb=385.4, bsz=32, num_updates=37890, lr=6.08647e-06, gnorm=3.495, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78686
2022-05-09 18:40:36 - progress_bar.py[line:272] - INFO: epoch 003:   2533 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=386.9, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.15, expert1_balance_bottom=19.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.1, ups=0.56, wpb=386.9, bsz=32, num_updates=37900, lr=6.08527e-06, gnorm=3.778, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78704
2022-05-09 18:40:54 - progress_bar.py[line:272] - INFO: epoch 003:   2543 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=376.8, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893402, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.851, expert1_balance_bottom=19.6, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=211.4, ups=0.56, wpb=376.8, bsz=32, num_updates=37910, lr=6.08407e-06, gnorm=3.311, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78722
2022-05-09 18:41:11 - progress_bar.py[line:272] - INFO: epoch 003:   2553 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=384.8, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895483, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.737, expert1_balance_bottom=19.419, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=221.8, ups=0.58, wpb=384.8, bsz=32, num_updates=37920, lr=6.08287e-06, gnorm=3.198, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78739
2022-05-09 18:41:28 - progress_bar.py[line:272] - INFO: epoch 003:   2563 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885807, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.821, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=218.3, ups=0.58, wpb=377.2, bsz=32, num_updates=37930, lr=6.08167e-06, gnorm=3.415, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78756
2022-05-09 18:41:46 - progress_bar.py[line:272] - INFO: epoch 003:   2573 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=377.5, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.845, expert1_balance_bottom=19.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216, ups=0.57, wpb=377.5, bsz=32, num_updates=37940, lr=6.08046e-06, gnorm=3.549, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78774
2022-05-09 18:42:03 - progress_bar.py[line:272] - INFO: epoch 003:   2583 / 17711 loss=2.926, loss_v1=0, loss_v2=0, nll_loss=0.681, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.900591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.926, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=33.749, expert1_balance_bottom=19.591, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=219.2, ups=0.58, wpb=379.9, bsz=32, num_updates=37950, lr=6.07926e-06, gnorm=3.254, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78791
2022-05-09 18:42:20 - progress_bar.py[line:272] - INFO: epoch 003:   2593 / 17711 loss=2.899, loss_v1=0, loss_v2=0, nll_loss=0.661, ntokens=375.6, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8935, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.899, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.149, expert1_balance_bottom=19.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.58, wps=218.5, ups=0.58, wpb=375.6, bsz=32, num_updates=37960, lr=6.07806e-06, gnorm=2.85, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78808
2022-05-09 18:42:38 - progress_bar.py[line:272] - INFO: epoch 003:   2603 / 17711 loss=2.943, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872874, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.943, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=35.41, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.4, ups=0.58, wpb=379.2, bsz=32, num_updates=37970, lr=6.07686e-06, gnorm=3.441, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78826
2022-05-09 18:42:55 - progress_bar.py[line:272] - INFO: epoch 003:   2613 / 17711 loss=2.93, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.93, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.042, expert1_balance_bottom=19.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=224.6, ups=0.58, wpb=385.6, bsz=32, num_updates=37980, lr=6.07566e-06, gnorm=3.425, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78843
2022-05-09 18:43:12 - progress_bar.py[line:272] - INFO: epoch 003:   2623 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897217, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=34.072, expert1_balance_bottom=19.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=218.8, ups=0.58, wpb=379.2, bsz=32, num_updates=37990, lr=6.07446e-06, gnorm=3.908, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78860
2022-05-09 18:43:29 - progress_bar.py[line:272] - INFO: epoch 003:   2633 / 17711 loss=2.922, loss_v1=0, loss_v2=0, nll_loss=0.703, ntokens=369.5, nsentences=31.5, sample_size=293.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880069, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.922, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=35.511, expert1_balance_bottom=19.022, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=212.7, ups=0.58, wpb=369.5, bsz=31.5, num_updates=38000, lr=6.07326e-06, gnorm=4.34, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=78878
2022-05-09 18:43:29 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 18:43:30 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 18:43:30 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 18:50:40 - train.py[line:517] - INFO: valid_step finished
2022-05-09 18:50:40 - progress_bar.py[line:282] - INFO: epoch 003 | valid on 'valid' subset | loss 10.303 | loss_v1 0 | loss_v2 0 | nll_loss 8.649 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.00469 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.303 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.166 | expert1_balance_top 40.582 | expert1_balance_bottom 15.05 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 401.52 | cider 1.195 | wps 700 | wpb 481.7 | bsz 8 | num_updates 38000 | best_cider 1.203
2022-05-09 18:50:57 - progress_bar.py[line:272] - INFO: epoch 003:   2643 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=386.1, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.4, expert1_balance_bottom=19.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=8.6, ups=0.02, wpb=386.1, bsz=32, num_updates=38010, lr=6.07205e-06, gnorm=4.212, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79325
2022-05-09 18:51:15 - progress_bar.py[line:272] - INFO: epoch 003:   2653 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=392.5, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.985, expert1_balance_bottom=19.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=225.1, ups=0.57, wpb=392.5, bsz=32, num_updates=38020, lr=6.07085e-06, gnorm=4.199, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79343
2022-05-09 18:51:32 - progress_bar.py[line:272] - INFO: epoch 003:   2663 / 17711 loss=2.942, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888152, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.942, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.549, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=222.8, ups=0.59, wpb=380.1, bsz=32, num_updates=38030, lr=6.06965e-06, gnorm=3.711, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79360
2022-05-09 18:51:49 - progress_bar.py[line:272] - INFO: epoch 003:   2673 / 17711 loss=2.939, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=379.1, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.939, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.09, expert1_balance_bottom=19.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=218.8, ups=0.58, wpb=379.1, bsz=32, num_updates=38040, lr=6.06845e-06, gnorm=3.911, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79377
2022-05-09 18:52:06 - progress_bar.py[line:272] - INFO: epoch 003:   2683 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=388.7, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=35.081, expert1_balance_bottom=19.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=227.4, ups=0.59, wpb=388.7, bsz=32, num_updates=38050, lr=6.06725e-06, gnorm=3.944, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79394
2022-05-09 18:52:23 - progress_bar.py[line:272] - INFO: epoch 003:   2693 / 17711 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=379.6, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88278, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.424, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=221.2, ups=0.58, wpb=379.6, bsz=32, num_updates=38060, lr=6.06605e-06, gnorm=4.424, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79411
2022-05-09 18:52:40 - progress_bar.py[line:272] - INFO: epoch 003:   2703 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=380.3, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895275, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.996, expert1_balance_bottom=19.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.4, ups=0.58, wpb=380.3, bsz=32, num_updates=38070, lr=6.06485e-06, gnorm=3.736, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79429
2022-05-09 18:52:58 - progress_bar.py[line:272] - INFO: epoch 003:   2713 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=376, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892077, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.188, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=217.6, ups=0.58, wpb=376, bsz=32, num_updates=38080, lr=6.06365e-06, gnorm=3.863, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79446
2022-05-09 18:53:15 - progress_bar.py[line:272] - INFO: epoch 003:   2723 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=381.5, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892499, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.076, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=219.3, ups=0.57, wpb=381.5, bsz=32, num_updates=38090, lr=6.06244e-06, gnorm=3.905, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79463
2022-05-09 18:53:32 - progress_bar.py[line:272] - INFO: epoch 003:   2733 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=389.1, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87088, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.479, expert1_balance_bottom=19.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=227.5, ups=0.58, wpb=389.1, bsz=32, num_updates=38100, lr=6.06124e-06, gnorm=3.584, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79480
2022-05-09 18:53:49 - progress_bar.py[line:272] - INFO: epoch 003:   2743 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=387.2, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=35.475, expert1_balance_bottom=19.029, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=225.3, ups=0.58, wpb=387.2, bsz=32, num_updates=38110, lr=6.06004e-06, gnorm=4.275, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79498
2022-05-09 18:54:07 - progress_bar.py[line:272] - INFO: epoch 003:   2753 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=386.4, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875702, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.97, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=226.2, ups=0.59, wpb=386.4, bsz=32, num_updates=38120, lr=6.05884e-06, gnorm=3.829, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79515
2022-05-09 18:54:24 - progress_bar.py[line:272] - INFO: epoch 003:   2763 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899013, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.692, expert1_balance_bottom=19.625, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=221.8, ups=0.58, wpb=382.8, bsz=32, num_updates=38130, lr=6.05764e-06, gnorm=4.351, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79532
2022-05-09 18:54:41 - progress_bar.py[line:272] - INFO: epoch 003:   2773 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891697, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.167, expert1_balance_bottom=19.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=222.1, ups=0.58, wpb=381, bsz=32, num_updates=38140, lr=6.05644e-06, gnorm=3.993, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79549
2022-05-09 18:54:58 - progress_bar.py[line:272] - INFO: epoch 003:   2783 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880482, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.991, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=223, ups=0.58, wpb=383.1, bsz=32, num_updates=38150, lr=6.05524e-06, gnorm=4.211, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79566
2022-05-09 18:55:07 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 18:55:17 - progress_bar.py[line:272] - INFO: epoch 003:   2794 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=35.272, expert1_balance_bottom=18.961, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=205.1, ups=0.54, wpb=382.3, bsz=32, num_updates=38160, lr=6.05404e-06, gnorm=4.421, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79585
2022-05-09 18:55:34 - progress_bar.py[line:272] - INFO: epoch 003:   2804 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.998, expert1_balance_bottom=19.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.4, ups=0.58, wpb=380.9, bsz=32, num_updates=38170, lr=6.05283e-06, gnorm=4.108, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79602
2022-05-09 18:55:51 - progress_bar.py[line:272] - INFO: epoch 003:   2814 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=383.5, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.275, expert1_balance_bottom=19.584, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=221.1, ups=0.58, wpb=383.5, bsz=32, num_updates=38180, lr=6.05163e-06, gnorm=4.06, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79620
2022-05-09 18:56:09 - progress_bar.py[line:272] - INFO: epoch 003:   2824 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=379.7, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.289, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.8, ups=0.59, wpb=379.7, bsz=32, num_updates=38190, lr=6.05043e-06, gnorm=5.046, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79637
2022-05-09 18:56:26 - progress_bar.py[line:272] - INFO: epoch 003:   2834 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882524, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.509, expert1_balance_bottom=19.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=219.1, ups=0.58, wpb=378.6, bsz=32, num_updates=38200, lr=6.04923e-06, gnorm=3.76, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79654
2022-05-09 18:56:43 - progress_bar.py[line:272] - INFO: epoch 003:   2844 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886439, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.721, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=222.4, ups=0.58, wpb=381.6, bsz=32, num_updates=38210, lr=6.04803e-06, gnorm=4.206, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79671
2022-05-09 18:57:00 - progress_bar.py[line:272] - INFO: epoch 003:   2854 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=379.1, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.715, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221.6, ups=0.58, wpb=379.1, bsz=32, num_updates=38220, lr=6.04683e-06, gnorm=4.346, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79688
2022-05-09 18:57:17 - progress_bar.py[line:272] - INFO: epoch 003:   2864 / 17711 loss=2.914, loss_v1=0, loss_v2=0, nll_loss=0.7, ntokens=386.3, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878519, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.914, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.122, expert1_balance_bottom=19.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=225, ups=0.58, wpb=386.3, bsz=32, num_updates=38230, lr=6.04563e-06, gnorm=3.195, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79705
2022-05-09 18:57:35 - progress_bar.py[line:272] - INFO: epoch 003:   2874 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=387.9, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.85, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.7, ups=0.58, wpb=387.9, bsz=32, num_updates=38240, lr=6.04442e-06, gnorm=3.542, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79723
2022-05-09 18:57:52 - progress_bar.py[line:272] - INFO: epoch 003:   2884 / 17711 loss=2.948, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=374.5, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.948, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.695, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.3, ups=0.59, wpb=374.5, bsz=32, num_updates=38250, lr=6.04322e-06, gnorm=3.164, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79740
2022-05-09 18:58:09 - progress_bar.py[line:272] - INFO: epoch 003:   2894 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=376.6, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.149, expert1_balance_bottom=19.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=211.2, ups=0.56, wpb=376.6, bsz=32, num_updates=38260, lr=6.04202e-06, gnorm=3.968, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79757
2022-05-09 18:58:27 - progress_bar.py[line:272] - INFO: epoch 003:   2904 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=380, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884548, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.32, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=217.9, ups=0.57, wpb=380, bsz=32, num_updates=38270, lr=6.04082e-06, gnorm=4.119, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79775
2022-05-09 18:58:40 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 18:58:46 - progress_bar.py[line:272] - INFO: epoch 003:   2915 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=377.2, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878338, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.587, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=200.6, ups=0.53, wpb=377.2, bsz=32, num_updates=38280, lr=6.03962e-06, gnorm=3.838, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79794
2022-05-09 18:59:03 - progress_bar.py[line:272] - INFO: epoch 003:   2925 / 17711 loss=2.942, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=388.6, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871099, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.942, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=35.477, expert1_balance_bottom=18.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=224.6, ups=0.58, wpb=388.6, bsz=32, num_updates=38290, lr=6.03842e-06, gnorm=3.697, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79811
2022-05-09 18:59:21 - progress_bar.py[line:272] - INFO: epoch 003:   2935 / 17711 loss=2.901, loss_v1=0, loss_v2=0, nll_loss=0.683, ntokens=390.8, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881499, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.901, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.897, expert1_balance_bottom=19.267, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=222.7, ups=0.57, wpb=390.8, bsz=32, num_updates=38300, lr=6.03722e-06, gnorm=4.044, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79829
2022-05-09 18:59:38 - progress_bar.py[line:272] - INFO: epoch 003:   2945 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=379.2, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890864, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.102, expert1_balance_bottom=19.617, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.5, ups=0.57, wpb=379.2, bsz=32, num_updates=38310, lr=6.03602e-06, gnorm=3.949, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79846
2022-05-09 18:59:55 - progress_bar.py[line:272] - INFO: epoch 003:   2955 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=377.3, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893311, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.104, expert1_balance_bottom=19.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=217.1, ups=0.58, wpb=377.3, bsz=32, num_updates=38320, lr=6.03481e-06, gnorm=3.772, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79863
2022-05-09 19:00:13 - progress_bar.py[line:272] - INFO: epoch 003:   2965 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889777, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.054, expert1_balance_bottom=19.66, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=216.8, ups=0.57, wpb=379.5, bsz=32, num_updates=38330, lr=6.03361e-06, gnorm=3.344, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79881
2022-05-09 19:00:30 - progress_bar.py[line:272] - INFO: epoch 003:   2975 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=383, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876931, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.173, expert1_balance_bottom=19.034, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=225.8, ups=0.59, wpb=383, bsz=32, num_updates=38340, lr=6.03241e-06, gnorm=3.562, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79898
2022-05-09 19:00:47 - progress_bar.py[line:272] - INFO: epoch 003:   2985 / 17711 loss=2.91, loss_v1=0, loss_v2=0, nll_loss=0.684, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888993, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.91, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.323, expert1_balance_bottom=19.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=221.4, ups=0.58, wpb=378.6, bsz=32, num_updates=38350, lr=6.03121e-06, gnorm=3.349, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79915
2022-05-09 19:01:04 - progress_bar.py[line:272] - INFO: epoch 003:   2995 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88926, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.328, expert1_balance_bottom=19.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.7, ups=0.57, wpb=380.8, bsz=32, num_updates=38360, lr=6.03001e-06, gnorm=4.664, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79932
2022-05-09 19:01:22 - progress_bar.py[line:272] - INFO: epoch 003:   3005 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=380, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905866, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.115, expert1_balance_top=33.119, expert1_balance_bottom=19.893, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=220.7, ups=0.58, wpb=380, bsz=32, num_updates=38370, lr=6.02881e-06, gnorm=3.82, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79950
2022-05-09 19:01:39 - progress_bar.py[line:272] - INFO: epoch 003:   3015 / 17711 loss=2.908, loss_v1=0, loss_v2=0, nll_loss=0.683, ntokens=378, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889004, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.908, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.392, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=221, ups=0.58, wpb=378, bsz=32, num_updates=38380, lr=6.02761e-06, gnorm=3.666, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79967
2022-05-09 19:01:56 - progress_bar.py[line:272] - INFO: epoch 003:   3025 / 17711 loss=2.915, loss_v1=0, loss_v2=0, nll_loss=0.696, ntokens=385.9, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879168, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.915, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.876, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=224.4, ups=0.58, wpb=385.9, bsz=32, num_updates=38390, lr=6.0264e-06, gnorm=3.729, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=79984
2022-05-09 19:02:13 - progress_bar.py[line:272] - INFO: epoch 003:   3035 / 17711 loss=2.919, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=389.3, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872929, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.919, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.449, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=224.8, ups=0.58, wpb=389.3, bsz=32, num_updates=38400, lr=6.0252e-06, gnorm=3.438, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80001
2022-05-09 19:02:30 - progress_bar.py[line:272] - INFO: epoch 003:   3045 / 17711 loss=2.915, loss_v1=0, loss_v2=0, nll_loss=0.688, ntokens=381.2, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887852, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.915, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.135, expert1_balance_bottom=19.637, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=220.9, ups=0.58, wpb=381.2, bsz=32, num_updates=38410, lr=6.024e-06, gnorm=3.928, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80019
2022-05-09 19:02:47 - progress_bar.py[line:272] - INFO: epoch 003:   3055 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=389.2, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89025, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.418, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=229.6, ups=0.59, wpb=389.2, bsz=32, num_updates=38420, lr=6.0228e-06, gnorm=3.759, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80035
2022-05-09 19:03:04 - progress_bar.py[line:272] - INFO: epoch 003:   3065 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=381.6, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879373, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.455, expert1_balance_bottom=19.434, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.9, ups=0.59, wpb=381.6, bsz=32, num_updates=38430, lr=6.0216e-06, gnorm=3.55, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80052
2022-05-09 19:03:22 - progress_bar.py[line:272] - INFO: epoch 003:   3075 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=376.7, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874177, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.628, expert1_balance_bottom=19.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=220.1, ups=0.58, wpb=376.7, bsz=32, num_updates=38440, lr=6.0204e-06, gnorm=4.017, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80070
2022-05-09 19:03:39 - progress_bar.py[line:272] - INFO: epoch 003:   3085 / 17711 loss=2.932, loss_v1=0, loss_v2=0, nll_loss=0.717, ntokens=381.7, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.932, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.498, expert1_balance_bottom=19.446, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=222.3, ups=0.58, wpb=381.7, bsz=32, num_updates=38450, lr=6.0192e-06, gnorm=3.587, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80087
2022-05-09 19:03:56 - progress_bar.py[line:272] - INFO: epoch 003:   3095 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=375, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.903403, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.116, expert1_balance_top=33.447, expert1_balance_bottom=19.591, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=214.9, ups=0.57, wpb=375, bsz=32, num_updates=38460, lr=6.018e-06, gnorm=3.934, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80104
2022-05-09 19:04:13 - progress_bar.py[line:272] - INFO: epoch 003:   3105 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=382.9, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874403, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=35.173, expert1_balance_bottom=19.142, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223, ups=0.58, wpb=382.9, bsz=32, num_updates=38470, lr=6.01679e-06, gnorm=3.857, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80121
2022-05-09 19:04:30 - progress_bar.py[line:272] - INFO: epoch 003:   3115 / 17711 loss=2.906, loss_v1=0, loss_v2=0, nll_loss=0.671, ntokens=379.5, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898268, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.906, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.984, expert1_balance_bottom=19.394, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=221.5, ups=0.58, wpb=379.5, bsz=32, num_updates=38480, lr=6.01559e-06, gnorm=3.805, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80138
2022-05-09 19:04:48 - progress_bar.py[line:272] - INFO: epoch 003:   3125 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=382.8, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893252, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.778, expert1_balance_bottom=19.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.9, ups=0.58, wpb=382.8, bsz=32, num_updates=38490, lr=6.01439e-06, gnorm=4.054, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80156
2022-05-09 19:05:05 - progress_bar.py[line:272] - INFO: epoch 003:   3135 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=375.7, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882622, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.493, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.9, ups=0.59, wpb=375.7, bsz=32, num_updates=38500, lr=6.01319e-06, gnorm=3.93, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80173
2022-05-09 19:05:22 - progress_bar.py[line:272] - INFO: epoch 003:   3145 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=381.5, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=35.139, expert1_balance_bottom=19.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=222.6, ups=0.58, wpb=381.5, bsz=32, num_updates=38510, lr=6.01199e-06, gnorm=4.06, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80190
2022-05-09 19:05:39 - progress_bar.py[line:272] - INFO: epoch 003:   3155 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=377.9, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886848, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.111, expert1_balance_bottom=19.392, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.5, ups=0.58, wpb=377.9, bsz=32, num_updates=38520, lr=6.01079e-06, gnorm=4.149, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80207
2022-05-09 19:05:56 - progress_bar.py[line:272] - INFO: epoch 003:   3165 / 17711 loss=2.931, loss_v1=0, loss_v2=0, nll_loss=0.709, ntokens=379.3, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891685, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.931, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.882, expert1_balance_bottom=19.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=222.7, ups=0.59, wpb=379.3, bsz=32, num_updates=38530, lr=6.00959e-06, gnorm=5.582, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80224
2022-05-09 19:06:14 - progress_bar.py[line:272] - INFO: epoch 003:   3175 / 17711 loss=2.875, loss_v1=0, loss_v2=0, nll_loss=0.671, ntokens=386.8, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870613, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.875, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.725, expert1_balance_bottom=18.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=224.5, ups=0.58, wpb=386.8, bsz=32, num_updates=38540, lr=6.00839e-06, gnorm=3.361, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80242
2022-05-09 19:06:31 - progress_bar.py[line:272] - INFO: epoch 003:   3185 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882758, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.686, expert1_balance_bottom=19.459, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.3, ups=0.58, wpb=382.5, bsz=32, num_updates=38550, lr=6.00718e-06, gnorm=4.073, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80259
2022-05-09 19:06:48 - progress_bar.py[line:272] - INFO: epoch 003:   3195 / 17711 loss=2.918, loss_v1=0, loss_v2=0, nll_loss=0.697, ntokens=387.2, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881633, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.918, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.592, expert1_balance_bottom=19.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=218.7, ups=0.56, wpb=387.2, bsz=32, num_updates=38560, lr=6.00598e-06, gnorm=3.769, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80277
2022-05-09 19:07:06 - progress_bar.py[line:272] - INFO: epoch 003:   3205 / 17711 loss=2.929, loss_v1=0, loss_v2=0, nll_loss=0.704, ntokens=383.2, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.929, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.315, expert1_balance_bottom=19.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=219.8, ups=0.57, wpb=383.2, bsz=32, num_updates=38570, lr=6.00478e-06, gnorm=3.704, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80294
2022-05-09 19:07:23 - progress_bar.py[line:272] - INFO: epoch 003:   3215 / 17711 loss=2.948, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=386.1, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87784, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.948, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.875, expert1_balance_bottom=19.147, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=220, ups=0.57, wpb=386.1, bsz=32, num_updates=38580, lr=6.00358e-06, gnorm=3.655, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80311
2022-05-09 19:07:41 - progress_bar.py[line:272] - INFO: epoch 003:   3225 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=385.7, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.26, expert1_balance_bottom=19.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.5, ups=0.58, wpb=385.7, bsz=32, num_updates=38590, lr=6.00238e-06, gnorm=4.401, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80329
2022-05-09 19:07:58 - progress_bar.py[line:272] - INFO: epoch 003:   3235 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=388.2, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879183, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.639, expert1_balance_bottom=19.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=226.9, ups=0.58, wpb=388.2, bsz=32, num_updates=38600, lr=6.00118e-06, gnorm=4.028, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80346
2022-05-09 19:08:15 - progress_bar.py[line:272] - INFO: epoch 003:   3245 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902271, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.113, expert1_balance_top=33.364, expert1_balance_bottom=19.723, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.8, ups=0.58, wpb=383.2, bsz=32, num_updates=38610, lr=5.99998e-06, gnorm=3.429, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80363
2022-05-09 19:08:32 - progress_bar.py[line:272] - INFO: epoch 003:   3255 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=380.7, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.528, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.6, ups=0.58, wpb=380.7, bsz=32, num_updates=38620, lr=5.99877e-06, gnorm=3.974, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80380
2022-05-09 19:08:50 - progress_bar.py[line:272] - INFO: epoch 003:   3265 / 17711 loss=2.918, loss_v1=0, loss_v2=0, nll_loss=0.697, ntokens=387.2, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.918, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.634, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=225.6, ups=0.58, wpb=387.2, bsz=32, num_updates=38630, lr=5.99757e-06, gnorm=3.162, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80398
2022-05-09 19:09:07 - progress_bar.py[line:272] - INFO: epoch 003:   3275 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=395.5, nsentences=32, sample_size=314.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88885, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.352, expert1_balance_bottom=19.517, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=229.5, ups=0.58, wpb=395.5, bsz=32, num_updates=38640, lr=5.99637e-06, gnorm=3.833, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80415
2022-05-09 19:09:24 - progress_bar.py[line:272] - INFO: epoch 003:   3285 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=386.5, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894425, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=34.251, expert1_balance_bottom=19.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=224.3, ups=0.58, wpb=386.5, bsz=32, num_updates=38650, lr=5.99517e-06, gnorm=3.444, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80432
2022-05-09 19:09:41 - progress_bar.py[line:272] - INFO: epoch 003:   3295 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=379.8, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.517, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=223.8, ups=0.59, wpb=379.8, bsz=32, num_updates=38660, lr=5.99397e-06, gnorm=3.596, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80449
2022-05-09 19:09:58 - progress_bar.py[line:272] - INFO: epoch 003:   3305 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=34.304, expert1_balance_bottom=19.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=217.3, ups=0.57, wpb=380.6, bsz=32, num_updates=38670, lr=5.99277e-06, gnorm=4.377, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80467
2022-05-09 19:10:16 - progress_bar.py[line:272] - INFO: epoch 003:   3315 / 17711 loss=2.92, loss_v1=0, loss_v2=0, nll_loss=0.679, ntokens=382.7, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901468, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.92, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.659, expert1_balance_bottom=19.636, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=221.7, ups=0.58, wpb=382.7, bsz=32, num_updates=38680, lr=5.99157e-06, gnorm=4.069, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80484
2022-05-09 19:10:33 - progress_bar.py[line:272] - INFO: epoch 003:   3325 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=380.9, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884499, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.425, expert1_balance_bottom=19.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=222.1, ups=0.58, wpb=380.9, bsz=32, num_updates=38690, lr=5.99037e-06, gnorm=3.944, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80501
2022-05-09 19:10:50 - progress_bar.py[line:272] - INFO: epoch 003:   3335 / 17711 loss=2.939, loss_v1=0, loss_v2=0, nll_loss=0.715, ntokens=376.8, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892206, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.939, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.761, expert1_balance_bottom=19.609, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=216.4, ups=0.57, wpb=376.8, bsz=32, num_updates=38700, lr=5.98916e-06, gnorm=3.709, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80518
2022-05-09 19:11:08 - progress_bar.py[line:272] - INFO: epoch 003:   3345 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882406, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.857, expert1_balance_bottom=19.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=221.1, ups=0.58, wpb=380.8, bsz=32, num_updates=38710, lr=5.98796e-06, gnorm=3.485, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80536
2022-05-09 19:11:25 - progress_bar.py[line:272] - INFO: epoch 003:   3355 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=374.7, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.649, expert1_balance_bottom=19.646, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.8, ups=0.59, wpb=374.7, bsz=32, num_updates=38720, lr=5.98676e-06, gnorm=3.717, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80553
2022-05-09 19:11:42 - progress_bar.py[line:272] - INFO: epoch 003:   3365 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=378.3, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893265, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.737, expert1_balance_bottom=19.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=221, ups=0.58, wpb=378.3, bsz=32, num_updates=38730, lr=5.98556e-06, gnorm=4.117, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80570
2022-05-09 19:11:59 - progress_bar.py[line:272] - INFO: epoch 003:   3375 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=387.7, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889414, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.66, expert1_balance_bottom=19.699, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=222, ups=0.57, wpb=387.7, bsz=32, num_updates=38740, lr=5.98436e-06, gnorm=3.291, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80587
2022-05-09 19:12:17 - progress_bar.py[line:272] - INFO: epoch 003:   3385 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=381.5, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883405, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.6, expert1_balance_bottom=19.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.1, ups=0.56, wpb=381.5, bsz=32, num_updates=38750, lr=5.98316e-06, gnorm=3.872, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80605
2022-05-09 19:12:34 - progress_bar.py[line:272] - INFO: epoch 003:   3395 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=383.8, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.961, expert1_balance_bottom=19.354, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220, ups=0.57, wpb=383.8, bsz=32, num_updates=38760, lr=5.98196e-06, gnorm=3.845, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80622
2022-05-09 19:12:52 - progress_bar.py[line:272] - INFO: epoch 003:   3405 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=381.6, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877044, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.918, expert1_balance_bottom=19.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=216.9, ups=0.57, wpb=381.6, bsz=32, num_updates=38770, lr=5.98075e-06, gnorm=4.091, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80640
2022-05-09 19:13:10 - progress_bar.py[line:272] - INFO: epoch 003:   3415 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=386.7, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87442, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.716, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218, ups=0.56, wpb=386.7, bsz=32, num_updates=38780, lr=5.97955e-06, gnorm=4.022, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80658
2022-05-09 19:13:27 - progress_bar.py[line:272] - INFO: epoch 003:   3425 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885402, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.357, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.7, ups=0.57, wpb=382.4, bsz=32, num_updates=38790, lr=5.97835e-06, gnorm=3.754, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80675
2022-05-09 19:13:44 - progress_bar.py[line:272] - INFO: epoch 003:   3435 / 17711 loss=2.915, loss_v1=0, loss_v2=0, nll_loss=0.695, ntokens=385.1, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.915, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.114, expert1_balance_bottom=19.596, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=224.4, ups=0.58, wpb=385.1, bsz=32, num_updates=38800, lr=5.97715e-06, gnorm=3.178, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80692
2022-05-09 19:14:01 - progress_bar.py[line:272] - INFO: epoch 003:   3445 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892771, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.061, expert1_balance_bottom=19.313, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=224.6, ups=0.58, wpb=385, bsz=32, num_updates=38810, lr=5.97595e-06, gnorm=3.754, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80709
2022-05-09 19:14:19 - progress_bar.py[line:272] - INFO: epoch 003:   3455 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=389.9, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.95, expert1_balance_bottom=19.223, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=226.7, ups=0.58, wpb=389.9, bsz=32, num_updates=38820, lr=5.97475e-06, gnorm=3.734, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80727
2022-05-09 19:14:36 - progress_bar.py[line:272] - INFO: epoch 003:   3465 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=385.9, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881442, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.961, expert1_balance_bottom=19.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.1, ups=0.58, wpb=385.9, bsz=32, num_updates=38830, lr=5.97355e-06, gnorm=4.228, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80744
2022-05-09 19:14:54 - progress_bar.py[line:272] - INFO: epoch 003:   3475 / 17711 loss=2.939, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=376.6, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.939, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.956, expert1_balance_bottom=19.254, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=208.3, ups=0.55, wpb=376.6, bsz=32, num_updates=38840, lr=5.97235e-06, gnorm=3.721, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80762
2022-05-09 19:15:12 - progress_bar.py[line:272] - INFO: epoch 003:   3485 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=372.7, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.733, expert1_balance_bottom=19.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=212.8, ups=0.57, wpb=372.7, bsz=32, num_updates=38850, lr=5.97114e-06, gnorm=3.974, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80780
2022-05-09 19:15:29 - progress_bar.py[line:272] - INFO: epoch 003:   3495 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=381.3, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887992, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.166, expert1_balance_bottom=19.452, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220, ups=0.58, wpb=381.3, bsz=32, num_updates=38860, lr=5.96994e-06, gnorm=3.426, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80797
2022-05-09 19:15:46 - progress_bar.py[line:272] - INFO: epoch 003:   3505 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=389.8, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877023, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.712, expert1_balance_bottom=19.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=226, ups=0.58, wpb=389.8, bsz=32, num_updates=38870, lr=5.96874e-06, gnorm=4.368, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80814
2022-05-09 19:16:04 - progress_bar.py[line:272] - INFO: epoch 003:   3515 / 17711 loss=2.911, loss_v1=0, loss_v2=0, nll_loss=0.693, ntokens=373.1, nsentences=32, sample_size=296.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885576, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.911, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.786, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=214.8, ups=0.58, wpb=373.1, bsz=32, num_updates=38880, lr=5.96754e-06, gnorm=3.654, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80832
2022-05-09 19:16:21 - progress_bar.py[line:272] - INFO: epoch 003:   3525 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=376.4, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887202, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.496, expert1_balance_bottom=19.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=219.3, ups=0.58, wpb=376.4, bsz=32, num_updates=38890, lr=5.96634e-06, gnorm=3.403, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80849
2022-05-09 19:16:38 - progress_bar.py[line:272] - INFO: epoch 003:   3535 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=381.4, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899704, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.648, expert1_balance_bottom=19.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=217.2, ups=0.57, wpb=381.4, bsz=32, num_updates=38900, lr=5.96514e-06, gnorm=3.913, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80866
2022-05-09 19:16:45 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 19:16:57 - progress_bar.py[line:272] - INFO: epoch 003:   3546 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883345, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.403, expert1_balance_bottom=19.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=206.9, ups=0.54, wpb=386.4, bsz=32, num_updates=38910, lr=5.96394e-06, gnorm=4.188, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80885
2022-05-09 19:17:14 - progress_bar.py[line:272] - INFO: epoch 003:   3556 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=385.1, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.759, expert1_balance_bottom=19.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.2, ups=0.58, wpb=385.1, bsz=32, num_updates=38920, lr=5.96274e-06, gnorm=5.283, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80902
2022-05-09 19:17:31 - progress_bar.py[line:272] - INFO: epoch 003:   3566 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884576, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.55, expert1_balance_bottom=19.444, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=224.1, ups=0.58, wpb=384.2, bsz=32, num_updates=38930, lr=5.96153e-06, gnorm=5.72, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80919
2022-05-09 19:17:49 - progress_bar.py[line:272] - INFO: epoch 003:   3576 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=35.107, expert1_balance_bottom=19.122, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=226.1, ups=0.58, wpb=388.3, bsz=32, num_updates=38940, lr=5.96033e-06, gnorm=4.044, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80937
2022-05-09 19:18:06 - progress_bar.py[line:272] - INFO: epoch 003:   3586 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=387.8, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.79, expert1_balance_bottom=19.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=218.9, ups=0.56, wpb=387.8, bsz=32, num_updates=38950, lr=5.95913e-06, gnorm=4.14, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80954
2022-05-09 19:18:24 - progress_bar.py[line:272] - INFO: epoch 003:   3596 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=380.9, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898675, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.91, expert1_balance_bottom=19.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=217.8, ups=0.57, wpb=380.9, bsz=32, num_updates=38960, lr=5.95793e-06, gnorm=4.917, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80972
2022-05-09 19:18:41 - progress_bar.py[line:272] - INFO: epoch 003:   3606 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=381.5, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.598, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.2, ups=0.57, wpb=381.5, bsz=32, num_updates=38970, lr=5.95673e-06, gnorm=4.732, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=80989
2022-05-09 19:18:59 - progress_bar.py[line:272] - INFO: epoch 003:   3616 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899669, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.755, expert1_balance_bottom=19.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214.7, ups=0.57, wpb=379.2, bsz=32, num_updates=38980, lr=5.95553e-06, gnorm=3.681, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81007
2022-05-09 19:19:16 - progress_bar.py[line:272] - INFO: epoch 003:   3626 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=381.3, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882096, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=35.246, expert1_balance_bottom=19.046, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.7, ups=0.58, wpb=381.3, bsz=32, num_updates=38990, lr=5.95433e-06, gnorm=3.579, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81024
2022-05-09 19:19:33 - progress_bar.py[line:272] - INFO: epoch 003:   3636 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=385, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887775, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.297, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.8, ups=0.59, wpb=385, bsz=32, num_updates=39000, lr=5.95312e-06, gnorm=3.851, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81041
2022-05-09 19:19:51 - progress_bar.py[line:272] - INFO: epoch 003:   3646 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.675, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223.5, ups=0.58, wpb=388.3, bsz=32, num_updates=39010, lr=5.95192e-06, gnorm=4.047, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81059
2022-05-09 19:20:08 - progress_bar.py[line:272] - INFO: epoch 003:   3656 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=379.1, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883916, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=35.197, expert1_balance_bottom=19.203, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.4, ups=0.58, wpb=379.1, bsz=32, num_updates=39020, lr=5.95072e-06, gnorm=3.758, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81076
2022-05-09 19:20:25 - progress_bar.py[line:272] - INFO: epoch 003:   3666 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=390.8, nsentences=32, sample_size=311.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884832, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.774, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=227.7, ups=0.58, wpb=390.8, bsz=32, num_updates=39030, lr=5.94952e-06, gnorm=3.987, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81093
2022-05-09 19:20:42 - progress_bar.py[line:272] - INFO: epoch 003:   3676 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=379, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899108, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.789, expert1_balance_bottom=19.542, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.5, ups=0.57, wpb=379, bsz=32, num_updates=39040, lr=5.94832e-06, gnorm=4.061, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81111
2022-05-09 19:21:00 - progress_bar.py[line:272] - INFO: epoch 003:   3686 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876021, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=35.081, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=222.9, ups=0.58, wpb=383.8, bsz=32, num_updates=39050, lr=5.94712e-06, gnorm=3.835, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81128
2022-05-09 19:21:17 - progress_bar.py[line:272] - INFO: epoch 003:   3696 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.422, expert1_balance_bottom=19.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.9, ups=0.58, wpb=382.2, bsz=32, num_updates=39060, lr=5.94592e-06, gnorm=4.29, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81145
2022-05-09 19:21:34 - progress_bar.py[line:272] - INFO: epoch 003:   3706 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=382.2, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893193, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.974, expert1_balance_bottom=19.687, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=224.9, ups=0.59, wpb=382.2, bsz=32, num_updates=39070, lr=5.94472e-06, gnorm=4.393, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81162
2022-05-09 19:21:51 - progress_bar.py[line:272] - INFO: epoch 003:   3716 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=386, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87956, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.639, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=225.5, ups=0.58, wpb=386, bsz=32, num_updates=39080, lr=5.94351e-06, gnorm=4.976, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81179
2022-05-09 19:22:08 - progress_bar.py[line:272] - INFO: epoch 003:   3726 / 17711 loss=3.081, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=386.7, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883258, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.081, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.399, expert1_balance_bottom=19.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=228.5, ups=0.59, wpb=386.7, bsz=32, num_updates=39090, lr=5.94231e-06, gnorm=5.129, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81196
2022-05-09 19:22:25 - progress_bar.py[line:272] - INFO: epoch 003:   3736 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=381.6, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884187, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.142, expert1_balance_bottom=19.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223.4, ups=0.59, wpb=381.6, bsz=32, num_updates=39100, lr=5.94111e-06, gnorm=4.084, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81213
2022-05-09 19:22:43 - progress_bar.py[line:272] - INFO: epoch 003:   3746 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=380.9, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891957, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.882, expert1_balance_bottom=19.554, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219, ups=0.57, wpb=380.9, bsz=32, num_updates=39110, lr=5.93991e-06, gnorm=3.49, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81231
2022-05-09 19:23:00 - progress_bar.py[line:272] - INFO: epoch 003:   3756 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=390.2, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890827, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.75, expert1_balance_bottom=19.586, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223.8, ups=0.57, wpb=390.2, bsz=32, num_updates=39120, lr=5.93871e-06, gnorm=3.634, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81248
2022-05-09 19:23:17 - progress_bar.py[line:272] - INFO: epoch 003:   3766 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=389.9, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.762, expert1_balance_bottom=19.691, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=225.7, ups=0.58, wpb=389.9, bsz=32, num_updates=39130, lr=5.93751e-06, gnorm=4.174, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81265
2022-05-09 19:23:34 - progress_bar.py[line:272] - INFO: epoch 003:   3776 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=387.7, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872497, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.924, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.3, ups=0.58, wpb=387.7, bsz=32, num_updates=39140, lr=5.93631e-06, gnorm=4.037, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81283
2022-05-09 19:23:52 - progress_bar.py[line:272] - INFO: epoch 003:   3786 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=382, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885943, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.968, expert1_balance_bottom=19.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.2, ups=0.57, wpb=382, bsz=32, num_updates=39150, lr=5.9351e-06, gnorm=3.831, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81300
2022-05-09 19:24:09 - progress_bar.py[line:272] - INFO: epoch 003:   3796 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.984, expert1_balance_bottom=19.705, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.7, ups=0.58, wpb=384.3, bsz=32, num_updates=39160, lr=5.9339e-06, gnorm=3.724, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81317
2022-05-09 19:24:27 - progress_bar.py[line:272] - INFO: epoch 003:   3806 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=375.6, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874281, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=35.157, expert1_balance_bottom=19.186, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.5, ups=0.58, wpb=375.6, bsz=32, num_updates=39170, lr=5.9327e-06, gnorm=4.325, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81335
2022-05-09 19:24:44 - progress_bar.py[line:272] - INFO: epoch 003:   3816 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=386.5, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878533, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=35.165, expert1_balance_bottom=19.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=223.9, ups=0.58, wpb=386.5, bsz=32, num_updates=39180, lr=5.9315e-06, gnorm=4.093, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81352
2022-05-09 19:25:01 - progress_bar.py[line:272] - INFO: epoch 003:   3826 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=381.7, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.262, expert1_balance_bottom=19.012, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.1, ups=0.57, wpb=381.7, bsz=32, num_updates=39190, lr=5.9303e-06, gnorm=4.414, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81369
2022-05-09 19:25:19 - progress_bar.py[line:272] - INFO: epoch 003:   3836 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=390, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884028, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.925, expert1_balance_bottom=19.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=225.4, ups=0.58, wpb=390, bsz=32, num_updates=39200, lr=5.9291e-06, gnorm=3.521, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81387
2022-05-09 19:25:36 - progress_bar.py[line:272] - INFO: epoch 003:   3846 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=390.7, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881546, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.508, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=227.2, ups=0.58, wpb=390.7, bsz=32, num_updates=39210, lr=5.9279e-06, gnorm=4.497, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81404
2022-05-09 19:25:55 - progress_bar.py[line:272] - INFO: epoch 003:   3856 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=380.2, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880438, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.459, expert1_balance_bottom=19.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=197.2, ups=0.52, wpb=380.2, bsz=32, num_updates=39220, lr=5.9267e-06, gnorm=3.697, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81423
2022-05-09 19:26:12 - progress_bar.py[line:272] - INFO: epoch 003:   3866 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=390.2, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.626, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=227.5, ups=0.58, wpb=390.2, bsz=32, num_updates=39230, lr=5.92549e-06, gnorm=3.599, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81440
2022-05-09 19:26:30 - progress_bar.py[line:272] - INFO: epoch 003:   3876 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=385.8, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887715, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.197, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=224.7, ups=0.58, wpb=385.8, bsz=32, num_updates=39240, lr=5.92429e-06, gnorm=4.757, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81458
2022-05-09 19:26:49 - progress_bar.py[line:272] - INFO: epoch 003:   3886 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=376.8, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894642, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.802, expert1_balance_bottom=19.528, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=197.4, ups=0.52, wpb=376.8, bsz=32, num_updates=39250, lr=5.92309e-06, gnorm=4.391, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81477
2022-05-09 19:27:06 - progress_bar.py[line:272] - INFO: epoch 003:   3896 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=381.2, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889843, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.988, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=222.1, ups=0.58, wpb=381.2, bsz=32, num_updates=39260, lr=5.92189e-06, gnorm=3.847, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81494
2022-05-09 19:27:23 - progress_bar.py[line:272] - INFO: epoch 003:   3906 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=382.8, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.022, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.1, ups=0.57, wpb=382.8, bsz=32, num_updates=39270, lr=5.92069e-06, gnorm=3.922, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81511
2022-05-09 19:27:41 - progress_bar.py[line:272] - INFO: epoch 003:   3916 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88561, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.448, expert1_balance_bottom=19.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.5, ups=0.57, wpb=383.9, bsz=32, num_updates=39280, lr=5.91949e-06, gnorm=4.985, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81529
2022-05-09 19:27:59 - progress_bar.py[line:272] - INFO: epoch 003:   3926 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=378.4, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884427, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.233, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=210.4, ups=0.56, wpb=378.4, bsz=32, num_updates=39290, lr=5.91829e-06, gnorm=4.634, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81547
2022-05-09 19:28:16 - progress_bar.py[line:272] - INFO: epoch 003:   3936 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888242, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.215, expert1_balance_bottom=19.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223.7, ups=0.58, wpb=384.1, bsz=32, num_updates=39300, lr=5.91709e-06, gnorm=4.124, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81564
2022-05-09 19:28:33 - progress_bar.py[line:272] - INFO: epoch 003:   3946 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=380.6, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897517, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.977, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=218.5, ups=0.57, wpb=380.6, bsz=32, num_updates=39310, lr=5.91588e-06, gnorm=3.486, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81581
2022-05-09 19:28:50 - progress_bar.py[line:272] - INFO: epoch 003:   3956 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=382.3, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884169, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.691, expert1_balance_bottom=19.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=226, ups=0.59, wpb=382.3, bsz=32, num_updates=39320, lr=5.91468e-06, gnorm=4.059, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81598
2022-05-09 19:29:08 - progress_bar.py[line:272] - INFO: epoch 003:   3966 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880423, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.827, expert1_balance_bottom=19.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219.9, ups=0.58, wpb=381, bsz=32, num_updates=39330, lr=5.91348e-06, gnorm=3.779, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81616
2022-05-09 19:29:25 - progress_bar.py[line:272] - INFO: epoch 003:   3976 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.704, expert1_balance_bottom=19.549, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.3, ups=0.58, wpb=379.6, bsz=32, num_updates=39340, lr=5.91228e-06, gnorm=3.963, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81633
2022-05-09 19:29:42 - progress_bar.py[line:272] - INFO: epoch 003:   3986 / 17711 loss=3.072, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=391.5, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880875, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.072, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.668, expert1_balance_bottom=19.139, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=229.4, ups=0.59, wpb=391.5, bsz=32, num_updates=39350, lr=5.91108e-06, gnorm=3.864, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81650
2022-05-09 19:29:59 - progress_bar.py[line:272] - INFO: epoch 003:   3996 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=380.4, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88894, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.694, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=223.2, ups=0.59, wpb=380.4, bsz=32, num_updates=39360, lr=5.90988e-06, gnorm=3.472, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81667
2022-05-09 19:30:16 - progress_bar.py[line:272] - INFO: epoch 003:   4006 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.551, expert1_balance_bottom=19.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.5, ups=0.57, wpb=385.5, bsz=32, num_updates=39370, lr=5.90868e-06, gnorm=4.134, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81685
2022-05-09 19:30:34 - progress_bar.py[line:272] - INFO: epoch 003:   4016 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=385.6, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896649, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.601, expert1_balance_bottom=19.558, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=225.9, ups=0.59, wpb=385.6, bsz=32, num_updates=39380, lr=5.90747e-06, gnorm=3.48, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81702
2022-05-09 19:30:51 - progress_bar.py[line:272] - INFO: epoch 003:   4026 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.765, expert1_balance_bottom=19.365, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.7, ups=0.58, wpb=377.4, bsz=32, num_updates=39390, lr=5.90627e-06, gnorm=3.609, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81719
2022-05-09 19:31:08 - progress_bar.py[line:272] - INFO: epoch 003:   4036 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=384.7, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883945, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.648, expert1_balance_bottom=19.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.4, ups=0.57, wpb=384.7, bsz=32, num_updates=39400, lr=5.90507e-06, gnorm=3.676, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81736
2022-05-09 19:31:26 - progress_bar.py[line:272] - INFO: epoch 003:   4046 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=383.3, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884847, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.265, expert1_balance_bottom=19.569, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.7, ups=0.58, wpb=383.3, bsz=32, num_updates=39410, lr=5.90387e-06, gnorm=3.583, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81754
2022-05-09 19:31:43 - progress_bar.py[line:272] - INFO: epoch 003:   4056 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=373.5, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895746, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.938, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220, ups=0.59, wpb=373.5, bsz=32, num_updates=39420, lr=5.90267e-06, gnorm=3.815, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81771
2022-05-09 19:32:00 - progress_bar.py[line:272] - INFO: epoch 003:   4066 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=398.3, nsentences=32, sample_size=317.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.14, expert1_balance_bottom=19.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=226.6, ups=0.57, wpb=398.3, bsz=32, num_updates=39430, lr=5.90147e-06, gnorm=3.68, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81788
2022-05-09 19:32:17 - progress_bar.py[line:272] - INFO: epoch 003:   4076 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=391.3, nsentences=32, sample_size=311, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891637, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.426, expert1_balance_bottom=19.457, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=227.9, ups=0.58, wpb=391.3, bsz=32, num_updates=39440, lr=5.90027e-06, gnorm=3.748, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81805
2022-05-09 19:32:35 - progress_bar.py[line:272] - INFO: epoch 003:   4086 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=386.2, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887526, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.7, expert1_balance_bottom=19.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.7, ups=0.57, wpb=386.2, bsz=32, num_updates=39450, lr=5.89907e-06, gnorm=4.618, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81823
2022-05-09 19:32:52 - progress_bar.py[line:272] - INFO: epoch 003:   4096 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=377.4, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876923, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=35.128, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.3, ups=0.57, wpb=377.4, bsz=32, num_updates=39460, lr=5.89786e-06, gnorm=4.315, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81840
2022-05-09 19:33:10 - progress_bar.py[line:272] - INFO: epoch 003:   4106 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=392.2, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881516, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.54, expert1_balance_bottom=19.539, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=228.5, ups=0.58, wpb=392.2, bsz=32, num_updates=39470, lr=5.89666e-06, gnorm=4.951, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81858
2022-05-09 19:33:27 - progress_bar.py[line:272] - INFO: epoch 003:   4116 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=383.5, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.793, expert1_balance_bottom=19.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224, ups=0.58, wpb=383.5, bsz=32, num_updates=39480, lr=5.89546e-06, gnorm=4.24, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81875
2022-05-09 19:33:44 - progress_bar.py[line:272] - INFO: epoch 003:   4126 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=387.5, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885004, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.422, expert1_balance_bottom=19.537, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223.2, ups=0.58, wpb=387.5, bsz=32, num_updates=39490, lr=5.89426e-06, gnorm=4.067, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81892
2022-05-09 19:34:01 - progress_bar.py[line:272] - INFO: epoch 003:   4136 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=376.4, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892905, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.931, expert1_balance_bottom=19.7, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.9, ups=0.58, wpb=376.4, bsz=32, num_updates=39500, lr=5.89306e-06, gnorm=3.947, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81909
2022-05-09 19:34:19 - progress_bar.py[line:272] - INFO: epoch 003:   4146 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=391.2, nsentences=32, sample_size=311.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88619, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.529, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=224.5, ups=0.57, wpb=391.2, bsz=32, num_updates=39510, lr=5.89186e-06, gnorm=5.274, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81927
2022-05-09 19:34:36 - progress_bar.py[line:272] - INFO: epoch 003:   4156 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=384.6, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=35.182, expert1_balance_bottom=19.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.7, ups=0.58, wpb=384.6, bsz=32, num_updates=39520, lr=5.89066e-06, gnorm=3.699, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81944
2022-05-09 19:34:54 - progress_bar.py[line:272] - INFO: epoch 003:   4166 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875835, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=35.312, expert1_balance_bottom=19.2, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216, ups=0.57, wpb=378.7, bsz=32, num_updates=39530, lr=5.88945e-06, gnorm=3.719, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81962
2022-05-09 19:35:13 - progress_bar.py[line:272] - INFO: epoch 003:   4176 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=381.5, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.749, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=199.5, ups=0.52, wpb=381.5, bsz=32, num_updates=39540, lr=5.88825e-06, gnorm=4.564, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=81981
2022-05-09 19:35:32 - progress_bar.py[line:272] - INFO: epoch 003:   4186 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=380.9, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881188, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.811, expert1_balance_bottom=19.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=199.2, ups=0.52, wpb=380.9, bsz=32, num_updates=39550, lr=5.88705e-06, gnorm=5.038, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82000
2022-05-09 19:35:50 - progress_bar.py[line:272] - INFO: epoch 003:   4196 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=392.7, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=35.649, expert1_balance_bottom=19.049, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.8, ups=0.56, wpb=392.7, bsz=32, num_updates=39560, lr=5.88585e-06, gnorm=3.894, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82018
2022-05-09 19:36:10 - progress_bar.py[line:272] - INFO: epoch 003:   4206 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=379.1, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.977, expert1_balance_bottom=19.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=191, ups=0.5, wpb=379.1, bsz=32, num_updates=39570, lr=5.88465e-06, gnorm=3.83, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82038
2022-05-09 19:36:32 - progress_bar.py[line:272] - INFO: epoch 003:   4216 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881544, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.557, expert1_balance_bottom=19.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=174.6, ups=0.45, wpb=385.6, bsz=32, num_updates=39580, lr=5.88345e-06, gnorm=3.61, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82060
2022-05-09 19:36:49 - progress_bar.py[line:272] - INFO: epoch 003:   4226 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=386, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881639, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.791, expert1_balance_bottom=19.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221, ups=0.57, wpb=386, bsz=32, num_updates=39590, lr=5.88225e-06, gnorm=3.952, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82077
2022-05-09 19:37:06 - progress_bar.py[line:272] - INFO: epoch 003:   4236 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=382.5, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896506, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.828, expert1_balance_bottom=19.52, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.5, ups=0.58, wpb=382.5, bsz=32, num_updates=39600, lr=5.88105e-06, gnorm=3.601, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82095
2022-05-09 19:37:24 - progress_bar.py[line:272] - INFO: epoch 003:   4246 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=385.1, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891032, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.41, expert1_balance_bottom=19.456, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.2, ups=0.58, wpb=385.1, bsz=32, num_updates=39610, lr=5.87984e-06, gnorm=3.756, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82112
2022-05-09 19:37:41 - progress_bar.py[line:272] - INFO: epoch 003:   4256 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=380.2, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873774, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.375, expert1_balance_bottom=19.225, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221, ups=0.58, wpb=380.2, bsz=32, num_updates=39620, lr=5.87864e-06, gnorm=4.358, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82129
2022-05-09 19:37:58 - progress_bar.py[line:272] - INFO: epoch 003:   4266 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=384.5, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=35.237, expert1_balance_bottom=19.259, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.5, ups=0.58, wpb=384.5, bsz=32, num_updates=39630, lr=5.87744e-06, gnorm=3.996, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82146
2022-05-09 19:38:15 - progress_bar.py[line:272] - INFO: epoch 003:   4276 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=376.6, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882491, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.667, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.9, ups=0.58, wpb=376.6, bsz=32, num_updates=39640, lr=5.87624e-06, gnorm=3.749, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82163
2022-05-09 19:38:33 - progress_bar.py[line:272] - INFO: epoch 003:   4286 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=384.5, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881267, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.897, expert1_balance_bottom=19.232, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.1, ups=0.57, wpb=384.5, bsz=32, num_updates=39650, lr=5.87504e-06, gnorm=3.606, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82181
2022-05-09 19:38:50 - progress_bar.py[line:272] - INFO: epoch 003:   4296 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=392.3, nsentences=32, sample_size=312.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87925, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.89, expert1_balance_bottom=19.357, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=227, ups=0.58, wpb=392.3, bsz=32, num_updates=39660, lr=5.87384e-06, gnorm=3.953, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82198
2022-05-09 19:39:07 - progress_bar.py[line:272] - INFO: epoch 003:   4306 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=389.8, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874054, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.513, expert1_balance_bottom=19.256, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=226.4, ups=0.58, wpb=389.8, bsz=32, num_updates=39670, lr=5.87264e-06, gnorm=3.839, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82215
2022-05-09 19:39:25 - progress_bar.py[line:272] - INFO: epoch 003:   4316 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88769, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.588, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.1, ups=0.57, wpb=388, bsz=32, num_updates=39680, lr=5.87144e-06, gnorm=4.14, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82233
2022-05-09 19:39:42 - progress_bar.py[line:272] - INFO: epoch 003:   4326 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=390.1, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.944, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=224.9, ups=0.58, wpb=390.1, bsz=32, num_updates=39690, lr=5.87023e-06, gnorm=4.303, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82250
2022-05-09 19:40:00 - progress_bar.py[line:272] - INFO: epoch 003:   4336 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=380.3, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885046, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.367, expert1_balance_bottom=19.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=216, ups=0.57, wpb=380.3, bsz=32, num_updates=39700, lr=5.86903e-06, gnorm=3.843, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82268
2022-05-09 19:40:17 - progress_bar.py[line:272] - INFO: epoch 003:   4346 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886803, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.373, expert1_balance_bottom=19.248, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=217.9, ups=0.58, wpb=377.1, bsz=32, num_updates=39710, lr=5.86783e-06, gnorm=3.433, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82285
2022-05-09 19:40:34 - progress_bar.py[line:272] - INFO: epoch 003:   4356 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=387.8, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.689, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.7, ups=0.58, wpb=387.8, bsz=32, num_updates=39720, lr=5.86663e-06, gnorm=4.771, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82302
2022-05-09 19:40:51 - progress_bar.py[line:272] - INFO: epoch 003:   4366 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=375.6, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883052, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.884, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.4, ups=0.58, wpb=375.6, bsz=32, num_updates=39730, lr=5.86543e-06, gnorm=4.522, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82319
2022-05-09 19:41:09 - progress_bar.py[line:272] - INFO: epoch 003:   4376 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=384.6, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884801, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.565, expert1_balance_bottom=19.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=218.5, ups=0.57, wpb=384.6, bsz=32, num_updates=39740, lr=5.86423e-06, gnorm=3.71, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82337
2022-05-09 19:41:26 - progress_bar.py[line:272] - INFO: epoch 003:   4386 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=386.7, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883505, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.508, expert1_balance_bottom=19.475, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=226.9, ups=0.59, wpb=386.7, bsz=32, num_updates=39750, lr=5.86303e-06, gnorm=3.93, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82354
2022-05-09 19:41:43 - progress_bar.py[line:272] - INFO: epoch 003:   4396 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=379.8, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884632, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.703, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.7, ups=0.58, wpb=379.8, bsz=32, num_updates=39760, lr=5.86182e-06, gnorm=3.341, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82372
2022-05-09 19:42:01 - progress_bar.py[line:272] - INFO: epoch 003:   4406 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.437, expert1_balance_bottom=19.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.7, ups=0.58, wpb=380.9, bsz=32, num_updates=39770, lr=5.86062e-06, gnorm=4.348, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82389
2022-05-09 19:42:18 - progress_bar.py[line:272] - INFO: epoch 003:   4416 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=378.7, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8846, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.578, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220, ups=0.58, wpb=378.7, bsz=32, num_updates=39780, lr=5.85942e-06, gnorm=4.266, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82406
2022-05-09 19:42:35 - progress_bar.py[line:272] - INFO: epoch 003:   4426 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=387.3, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878012, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.997, expert1_balance_bottom=19.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.4, ups=0.58, wpb=387.3, bsz=32, num_updates=39790, lr=5.85822e-06, gnorm=3.922, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82423
2022-05-09 19:42:53 - progress_bar.py[line:272] - INFO: epoch 003:   4436 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=378.1, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882251, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.423, expert1_balance_bottom=19.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=214.2, ups=0.57, wpb=378.1, bsz=32, num_updates=39800, lr=5.85702e-06, gnorm=3.901, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82441
2022-05-09 19:43:10 - progress_bar.py[line:272] - INFO: epoch 003:   4446 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=377.3, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892237, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.892, expert1_balance_bottom=19.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=215, ups=0.57, wpb=377.3, bsz=32, num_updates=39810, lr=5.85582e-06, gnorm=4.474, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82458
2022-05-09 19:43:28 - progress_bar.py[line:272] - INFO: epoch 003:   4456 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893111, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.9, expert1_balance_bottom=19.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=218.8, ups=0.57, wpb=380.9, bsz=32, num_updates=39820, lr=5.85462e-06, gnorm=3.344, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82476
2022-05-09 19:43:45 - progress_bar.py[line:272] - INFO: epoch 003:   4466 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=375.2, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.711, expert1_balance_bottom=19.676, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215, ups=0.57, wpb=375.2, bsz=32, num_updates=39830, lr=5.85342e-06, gnorm=4.146, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82493
2022-05-09 19:44:02 - progress_bar.py[line:272] - INFO: epoch 003:   4476 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=375, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.624, expert1_balance_bottom=19.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.8, ups=0.58, wpb=375, bsz=32, num_updates=39840, lr=5.85221e-06, gnorm=4.069, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82510
2022-05-09 19:44:20 - progress_bar.py[line:272] - INFO: epoch 003:   4486 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=382.8, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880718, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.841, expert1_balance_bottom=19.287, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=221.8, ups=0.58, wpb=382.8, bsz=32, num_updates=39850, lr=5.85101e-06, gnorm=3.83, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82528
2022-05-09 19:44:37 - progress_bar.py[line:272] - INFO: epoch 003:   4496 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=387.6, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887474, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.868, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=226.4, ups=0.58, wpb=387.6, bsz=32, num_updates=39860, lr=5.84981e-06, gnorm=4.214, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82545
2022-05-09 19:44:54 - progress_bar.py[line:272] - INFO: epoch 003:   4506 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=381.8, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881943, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.834, expert1_balance_bottom=19.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.1, ups=0.58, wpb=381.8, bsz=32, num_updates=39870, lr=5.84861e-06, gnorm=3.647, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82562
2022-05-09 19:45:11 - progress_bar.py[line:272] - INFO: epoch 003:   4516 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=374.8, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878456, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=35.241, expert1_balance_bottom=19.035, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=220.4, ups=0.59, wpb=374.8, bsz=32, num_updates=39880, lr=5.84741e-06, gnorm=4.22, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82579
2022-05-09 19:45:28 - progress_bar.py[line:272] - INFO: epoch 003:   4526 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=390.9, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874874, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.929, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=225.9, ups=0.58, wpb=390.9, bsz=32, num_updates=39890, lr=5.84621e-06, gnorm=3.603, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82596
2022-05-09 19:45:46 - progress_bar.py[line:272] - INFO: epoch 003:   4536 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=386.9, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891297, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.155, expert1_balance_bottom=19.548, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=224.7, ups=0.58, wpb=386.9, bsz=32, num_updates=39900, lr=5.84501e-06, gnorm=3.512, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82614
2022-05-09 19:46:03 - progress_bar.py[line:272] - INFO: epoch 003:   4546 / 17711 loss=3.088, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=376.1, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897966, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.088, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.561, expert1_balance_bottom=19.573, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.2, ups=0.59, wpb=376.1, bsz=32, num_updates=39910, lr=5.8438e-06, gnorm=3.834, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82631
2022-05-09 19:46:20 - progress_bar.py[line:272] - INFO: epoch 003:   4556 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=384.7, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.846, expert1_balance_bottom=19.651, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.1, ups=0.57, wpb=384.7, bsz=32, num_updates=39920, lr=5.8426e-06, gnorm=3.579, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82648
2022-05-09 19:46:37 - progress_bar.py[line:272] - INFO: epoch 003:   4566 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=374.8, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.393, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=218.2, ups=0.58, wpb=374.8, bsz=32, num_updates=39930, lr=5.8414e-06, gnorm=3.557, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82665
2022-05-09 19:46:55 - progress_bar.py[line:272] - INFO: epoch 003:   4576 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=382.2, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888074, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.024, expert1_balance_bottom=19.465, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=221, ups=0.58, wpb=382.2, bsz=32, num_updates=39940, lr=5.8402e-06, gnorm=3.194, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82683
2022-05-09 19:47:12 - progress_bar.py[line:272] - INFO: epoch 003:   4586 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887493, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.993, expert1_balance_bottom=19.577, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=217.9, ups=0.57, wpb=379.7, bsz=32, num_updates=39950, lr=5.839e-06, gnorm=3.862, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82700
2022-05-09 19:47:30 - progress_bar.py[line:272] - INFO: epoch 003:   4596 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=378.8, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.02, expert1_balance_bottom=19.602, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.4, ups=0.57, wpb=378.8, bsz=32, num_updates=39960, lr=5.8378e-06, gnorm=3.323, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82718
2022-05-09 19:47:47 - progress_bar.py[line:272] - INFO: epoch 003:   4606 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=380.6, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889855, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.206, expert1_balance_bottom=19.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.9, ups=0.59, wpb=380.6, bsz=32, num_updates=39970, lr=5.8366e-06, gnorm=3.819, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82735
2022-05-09 19:48:04 - progress_bar.py[line:272] - INFO: epoch 003:   4616 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=376.4, nsentences=32, sample_size=299.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=35.257, expert1_balance_bottom=19.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=220.7, ups=0.59, wpb=376.4, bsz=32, num_updates=39980, lr=5.8354e-06, gnorm=3.644, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82752
2022-05-09 19:48:21 - progress_bar.py[line:272] - INFO: epoch 003:   4626 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=372.5, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.422, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.8, ups=0.59, wpb=372.5, bsz=32, num_updates=39990, lr=5.83419e-06, gnorm=3.392, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82769
2022-05-09 19:48:38 - progress_bar.py[line:272] - INFO: epoch 003:   4636 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=377.3, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884321, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.672, expert1_balance_bottom=19.155, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219, ups=0.58, wpb=377.3, bsz=32, num_updates=40000, lr=5.83299e-06, gnorm=5.047, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=82786
2022-05-09 19:48:38 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 19:48:38 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 19:48:38 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 19:55:48 - train.py[line:517] - INFO: valid_step finished
2022-05-09 19:55:48 - progress_bar.py[line:282] - INFO: epoch 003 | valid on 'valid' subset | loss 10.07 | loss_v1 0 | loss_v2 0 | nll_loss 8.402 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.00899 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.07 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.164 | expert1_balance_top 40.739 | expert1_balance_bottom 15.05 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 338.34 | cider 1.201 | wps 701.2 | wpb 481.7 | bsz 8 | num_updates 40000 | best_cider 1.203
2022-05-09 19:55:48 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 3 @ 40000 updates
2022-05-09 19:55:48 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_40000-rank-0.pt
2022-05-09 19:55:48 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_40000-rank-0.pt
2022-05-09 19:55:56 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_40000-rank-0.pt
2022-05-09 19:55:56 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_40000-shared.pt
2022-05-09 19:56:04 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_40000-shared.pt
2022-05-09 19:56:15 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_40000-rank-0.pt (epoch 3 @ 40000 updates, score 1.201) (writing took 27.12147774361074 seconds)
2022-05-09 19:56:32 - progress_bar.py[line:272] - INFO: epoch 003:   4646 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=385.9, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.778, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=8.1, ups=0.02, wpb=385.9, bsz=32, num_updates=40010, lr=5.83179e-06, gnorm=3.875, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83260
2022-05-09 19:56:50 - progress_bar.py[line:272] - INFO: epoch 003:   4656 / 17711 loss=3.08, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=388.4, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876128, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.08, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.36, expert1_balance_bottom=19.097, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=224.2, ups=0.58, wpb=388.4, bsz=32, num_updates=40020, lr=5.83059e-06, gnorm=4.126, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83278
2022-05-09 19:57:07 - progress_bar.py[line:272] - INFO: epoch 003:   4666 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=392, nsentences=32, sample_size=311.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879862, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.98, expert1_balance_bottom=19.245, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=227.8, ups=0.58, wpb=392, bsz=32, num_updates=40030, lr=5.82939e-06, gnorm=3.461, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83295
2022-05-09 19:57:24 - progress_bar.py[line:272] - INFO: epoch 003:   4676 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=386.7, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894282, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.807, expert1_balance_bottom=19.59, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.2, ups=0.58, wpb=386.7, bsz=32, num_updates=40040, lr=5.82819e-06, gnorm=4.212, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83312
2022-05-09 19:57:41 - progress_bar.py[line:272] - INFO: epoch 003:   4686 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=384.6, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886494, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.37, expert1_balance_bottom=19.26, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=225, ups=0.58, wpb=384.6, bsz=32, num_updates=40050, lr=5.82699e-06, gnorm=4.239, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83329
2022-05-09 19:57:58 - progress_bar.py[line:272] - INFO: epoch 003:   4696 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=382.4, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881928, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.749, expert1_balance_bottom=19.237, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.2, ups=0.58, wpb=382.4, bsz=32, num_updates=40060, lr=5.82579e-06, gnorm=4.644, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83347
2022-05-09 19:58:16 - progress_bar.py[line:272] - INFO: epoch 003:   4706 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=378.3, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.458, expert1_balance_bottom=19.3, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.4, ups=0.58, wpb=378.3, bsz=32, num_updates=40070, lr=5.82458e-06, gnorm=3.708, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83364
2022-05-09 19:58:33 - progress_bar.py[line:272] - INFO: epoch 003:   4716 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=378.9, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884728, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.381, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=222.7, ups=0.59, wpb=378.9, bsz=32, num_updates=40080, lr=5.82338e-06, gnorm=3.682, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83381
2022-05-09 19:58:50 - progress_bar.py[line:272] - INFO: epoch 003:   4726 / 17711 loss=2.906, loss_v1=0, loss_v2=0, nll_loss=0.681, ntokens=381.4, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.906, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.299, expert1_balance_bottom=19.399, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.6, wps=217.8, ups=0.57, wpb=381.4, bsz=32, num_updates=40090, lr=5.82218e-06, gnorm=3.141, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83398
2022-05-09 19:59:08 - progress_bar.py[line:272] - INFO: epoch 003:   4736 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=376.2, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888462, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.47, expert1_balance_bottom=19.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.6, ups=0.57, wpb=376.2, bsz=32, num_updates=40100, lr=5.82098e-06, gnorm=3.621, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83416
2022-05-09 19:59:25 - progress_bar.py[line:272] - INFO: epoch 003:   4746 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=386.4, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874292, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.727, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=222.6, ups=0.58, wpb=386.4, bsz=32, num_updates=40110, lr=5.81978e-06, gnorm=3.95, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83433
2022-05-09 19:59:42 - progress_bar.py[line:272] - INFO: epoch 003:   4756 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=374.9, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896178, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.658, expert1_balance_bottom=19.541, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220.4, ups=0.59, wpb=374.9, bsz=32, num_updates=40120, lr=5.81858e-06, gnorm=3.783, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83450
2022-05-09 19:59:59 - progress_bar.py[line:272] - INFO: epoch 003:   4766 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=378.1, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889508, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.616, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=220.3, ups=0.58, wpb=378.1, bsz=32, num_updates=40130, lr=5.81738e-06, gnorm=3.888, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83467
2022-05-09 20:00:17 - progress_bar.py[line:272] - INFO: epoch 003:   4776 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.965, expert1_balance_bottom=19.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.4, ups=0.57, wpb=381.9, bsz=32, num_updates=40140, lr=5.81617e-06, gnorm=3.846, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83485
2022-05-09 20:00:34 - progress_bar.py[line:272] - INFO: epoch 003:   4786 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=384, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.913, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223, ups=0.58, wpb=384, bsz=32, num_updates=40150, lr=5.81497e-06, gnorm=4.153, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83502
2022-05-09 20:00:51 - progress_bar.py[line:272] - INFO: epoch 003:   4796 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=377, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885605, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.404, expert1_balance_bottom=19.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=217.7, ups=0.58, wpb=377, bsz=32, num_updates=40160, lr=5.81377e-06, gnorm=3.663, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83519
2022-05-09 20:01:09 - progress_bar.py[line:272] - INFO: epoch 003:   4806 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=382.2, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889175, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.239, expert1_balance_bottom=19.55, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=222.4, ups=0.58, wpb=382.2, bsz=32, num_updates=40170, lr=5.81257e-06, gnorm=3.478, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83537
2022-05-09 20:01:26 - progress_bar.py[line:272] - INFO: epoch 003:   4816 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=378.9, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892932, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.129, expert1_balance_bottom=19.46, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.8, ups=0.57, wpb=378.9, bsz=32, num_updates=40180, lr=5.81137e-06, gnorm=4.198, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83554
2022-05-09 20:01:43 - progress_bar.py[line:272] - INFO: epoch 003:   4826 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=381.5, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885705, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.11, expert1_balance_bottom=19.556, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=219.7, ups=0.58, wpb=381.5, bsz=32, num_updates=40190, lr=5.81017e-06, gnorm=3.649, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83571
2022-05-09 20:02:01 - progress_bar.py[line:272] - INFO: epoch 003:   4836 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890789, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.057, expert1_balance_bottom=19.644, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.1, ups=0.58, wpb=385.7, bsz=32, num_updates=40200, lr=5.80897e-06, gnorm=3.854, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83589
2022-05-09 20:02:18 - progress_bar.py[line:272] - INFO: epoch 003:   4846 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=385.5, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.864513, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.586, expert1_balance_bottom=19.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.5, ups=0.57, wpb=385.5, bsz=32, num_updates=40210, lr=5.80777e-06, gnorm=3.476, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83606
2022-05-09 20:02:36 - progress_bar.py[line:272] - INFO: epoch 003:   4856 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887647, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.018, expert1_balance_bottom=19.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.5, ups=0.57, wpb=379.2, bsz=32, num_updates=40220, lr=5.80656e-06, gnorm=3.369, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83624
2022-05-09 20:02:53 - progress_bar.py[line:272] - INFO: epoch 003:   4866 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=393.3, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88987, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.95, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225, ups=0.57, wpb=393.3, bsz=32, num_updates=40230, lr=5.80536e-06, gnorm=3.494, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83641
2022-05-09 20:03:11 - progress_bar.py[line:272] - INFO: epoch 003:   4876 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=378.9, nsentences=32, sample_size=301.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878719, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.694, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.8, ups=0.57, wpb=378.9, bsz=32, num_updates=40240, lr=5.80416e-06, gnorm=3.421, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83659
2022-05-09 20:03:29 - progress_bar.py[line:272] - INFO: epoch 003:   4886 / 17711 loss=3.067, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.067, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.148, expert1_balance_bottom=19.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=216, ups=0.57, wpb=381.9, bsz=32, num_updates=40250, lr=5.80296e-06, gnorm=3.896, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83677
2022-05-09 20:03:46 - progress_bar.py[line:272] - INFO: epoch 003:   4896 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=386.5, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884921, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.65, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=218.5, ups=0.57, wpb=386.5, bsz=32, num_updates=40260, lr=5.80176e-06, gnorm=4.155, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83694
2022-05-09 20:04:04 - progress_bar.py[line:272] - INFO: epoch 003:   4906 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=376.4, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886617, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.979, expert1_balance_bottom=19.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.9, ups=0.58, wpb=376.4, bsz=32, num_updates=40270, lr=5.80056e-06, gnorm=3.63, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83712
2022-05-09 20:04:21 - progress_bar.py[line:272] - INFO: epoch 003:   4916 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=382.5, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.345, expert1_balance_bottom=19.544, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=218.9, ups=0.57, wpb=382.5, bsz=32, num_updates=40280, lr=5.79936e-06, gnorm=3.575, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83729
2022-05-09 20:04:39 - progress_bar.py[line:272] - INFO: epoch 003:   4926 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=378.3, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883336, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.317, expert1_balance_bottom=19.57, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=212.9, ups=0.56, wpb=378.3, bsz=32, num_updates=40290, lr=5.79815e-06, gnorm=3.571, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83747
2022-05-09 20:04:56 - progress_bar.py[line:272] - INFO: epoch 003:   4936 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383.2, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875878, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.968, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221, ups=0.58, wpb=383.2, bsz=32, num_updates=40300, lr=5.79695e-06, gnorm=3.879, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83764
2022-05-09 20:05:13 - progress_bar.py[line:272] - INFO: epoch 003:   4946 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=386.8, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889552, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.349, expert1_balance_bottom=19.541, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=225.2, ups=0.58, wpb=386.8, bsz=32, num_updates=40310, lr=5.79575e-06, gnorm=3.689, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83781
2022-05-09 20:05:30 - progress_bar.py[line:272] - INFO: epoch 003:   4956 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=382.2, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896246, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.731, expert1_balance_bottom=19.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=224.2, ups=0.59, wpb=382.2, bsz=32, num_updates=40320, lr=5.79455e-06, gnorm=3.455, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83798
2022-05-09 20:05:48 - progress_bar.py[line:272] - INFO: epoch 003:   4966 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=382.3, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.392, expert1_balance_bottom=19.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=222.4, ups=0.58, wpb=382.3, bsz=32, num_updates=40330, lr=5.79335e-06, gnorm=3.262, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83816
2022-05-09 20:06:05 - progress_bar.py[line:272] - INFO: epoch 003:   4976 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=390, nsentences=32, sample_size=310.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885009, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.357, expert1_balance_bottom=19.397, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=225.9, ups=0.58, wpb=390, bsz=32, num_updates=40340, lr=5.79215e-06, gnorm=3.133, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83833
2022-05-09 20:06:22 - progress_bar.py[line:272] - INFO: epoch 003:   4986 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=369.8, nsentences=32, sample_size=294.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.001, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=216.7, ups=0.59, wpb=369.8, bsz=32, num_updates=40350, lr=5.79095e-06, gnorm=4.823, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83850
2022-05-09 20:06:39 - progress_bar.py[line:272] - INFO: epoch 003:   4996 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=377.4, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892319, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.765, expert1_balance_bottom=19.69, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.2, ups=0.58, wpb=377.4, bsz=32, num_updates=40360, lr=5.78975e-06, gnorm=3.764, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83867
2022-05-09 20:06:57 - progress_bar.py[line:272] - INFO: epoch 003:   5006 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=377.7, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884708, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.306, expert1_balance_bottom=19.438, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.1, ups=0.58, wpb=377.7, bsz=32, num_updates=40370, lr=5.78854e-06, gnorm=3.731, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83885
2022-05-09 20:07:11 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 20:07:16 - progress_bar.py[line:272] - INFO: epoch 003:   5017 / 17711 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=376.2, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.379, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=193.4, ups=0.51, wpb=376.2, bsz=32, num_updates=40380, lr=5.78734e-06, gnorm=3.2, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83904
2022-05-09 20:07:33 - progress_bar.py[line:272] - INFO: epoch 003:   5027 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=380.6, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881624, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.688, expert1_balance_bottom=19.333, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.3, ups=0.58, wpb=380.6, bsz=32, num_updates=40390, lr=5.78614e-06, gnorm=3.799, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83921
2022-05-09 20:07:51 - progress_bar.py[line:272] - INFO: epoch 003:   5037 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882237, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.476, expert1_balance_bottom=19.42, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221.4, ups=0.58, wpb=384.2, bsz=32, num_updates=40400, lr=5.78494e-06, gnorm=3.992, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83939
2022-05-09 20:08:08 - progress_bar.py[line:272] - INFO: epoch 003:   5047 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=381.1, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889749, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.257, expert1_balance_bottom=19.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.8, ups=0.58, wpb=381.1, bsz=32, num_updates=40410, lr=5.78374e-06, gnorm=3.825, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83956
2022-05-09 20:08:25 - progress_bar.py[line:272] - INFO: epoch 003:   5057 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=379, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.455, expert1_balance_bottom=19.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=222.3, ups=0.59, wpb=379, bsz=32, num_updates=40420, lr=5.78254e-06, gnorm=3.276, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83973
2022-05-09 20:08:42 - progress_bar.py[line:272] - INFO: epoch 003:   5067 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=380.7, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.924, expert1_balance_bottom=19.212, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.8, ups=0.59, wpb=380.7, bsz=32, num_updates=40430, lr=5.78134e-06, gnorm=3.766, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=83990
2022-05-09 20:08:59 - progress_bar.py[line:272] - INFO: epoch 003:   5077 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=382.4, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881816, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.513, expert1_balance_bottom=19.486, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.9, ups=0.58, wpb=382.4, bsz=32, num_updates=40440, lr=5.78014e-06, gnorm=3.974, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84007
2022-05-09 20:09:16 - progress_bar.py[line:272] - INFO: epoch 003:   5087 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=383.6, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886196, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.045, expert1_balance_bottom=19.541, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222, ups=0.58, wpb=383.6, bsz=32, num_updates=40450, lr=5.77893e-06, gnorm=3.626, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84025
2022-05-09 20:09:34 - progress_bar.py[line:272] - INFO: epoch 003:   5097 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.684, expert1_balance_bottom=19.614, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.3, ups=0.58, wpb=379.9, bsz=32, num_updates=40460, lr=5.77773e-06, gnorm=3.712, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84042
2022-05-09 20:09:51 - progress_bar.py[line:272] - INFO: epoch 003:   5107 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=375, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892662, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.426, expert1_balance_bottom=19.822, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.7, ups=0.59, wpb=375, bsz=32, num_updates=40470, lr=5.77653e-06, gnorm=3.569, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84059
2022-05-09 20:10:08 - progress_bar.py[line:272] - INFO: epoch 003:   5117 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=385.8, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875839, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.917, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.3, ups=0.58, wpb=385.8, bsz=32, num_updates=40480, lr=5.77533e-06, gnorm=3.809, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84076
2022-05-09 20:10:25 - progress_bar.py[line:272] - INFO: epoch 003:   5127 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=390.2, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889326, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.845, expert1_balance_bottom=19.615, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=226.9, ups=0.58, wpb=390.2, bsz=32, num_updates=40490, lr=5.77413e-06, gnorm=3.533, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84093
2022-05-09 20:10:43 - progress_bar.py[line:272] - INFO: epoch 003:   5137 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=388.3, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888121, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.113, expert1_balance_bottom=19.61, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=223.5, ups=0.58, wpb=388.3, bsz=32, num_updates=40500, lr=5.77293e-06, gnorm=3.414, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84111
2022-05-09 20:11:00 - progress_bar.py[line:272] - INFO: epoch 003:   5147 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=393.5, nsentences=32, sample_size=313.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87845, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.726, expert1_balance_bottom=19.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=227.6, ups=0.58, wpb=393.5, bsz=32, num_updates=40510, lr=5.77173e-06, gnorm=3.288, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84128
2022-05-09 20:11:17 - progress_bar.py[line:272] - INFO: epoch 003:   5157 / 17711 loss=2.892, loss_v1=0, loss_v2=0, nll_loss=0.684, ntokens=388.5, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.892, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.561, expert1_balance_bottom=19.546, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.61, wps=229, ups=0.59, wpb=388.5, bsz=32, num_updates=40520, lr=5.77052e-06, gnorm=3.219, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84145
2022-05-09 20:11:34 - progress_bar.py[line:272] - INFO: epoch 003:   5167 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=379.3, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886585, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.371, expert1_balance_bottom=19.533, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=217.8, ups=0.57, wpb=379.3, bsz=32, num_updates=40530, lr=5.76932e-06, gnorm=3.397, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84162
2022-05-09 20:11:52 - progress_bar.py[line:272] - INFO: epoch 003:   5177 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8887, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.245, expert1_balance_bottom=19.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.9, ups=0.58, wpb=384.9, bsz=32, num_updates=40540, lr=5.76812e-06, gnorm=3.415, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84180
2022-05-09 20:12:09 - progress_bar.py[line:272] - INFO: epoch 003:   5187 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=376.9, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887237, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.416, expert1_balance_bottom=19.362, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217.3, ups=0.58, wpb=376.9, bsz=32, num_updates=40550, lr=5.76692e-06, gnorm=3.853, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84197
2022-05-09 20:12:27 - progress_bar.py[line:272] - INFO: epoch 003:   5197 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=387.9, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882883, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.668, expert1_balance_bottom=19.156, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=218.4, ups=0.56, wpb=387.9, bsz=32, num_updates=40560, lr=5.76572e-06, gnorm=3.475, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84215
2022-05-09 20:12:44 - progress_bar.py[line:272] - INFO: epoch 003:   5207 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=388.6, nsentences=32, sample_size=309.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.614, expert1_balance_bottom=19.415, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=225.2, ups=0.58, wpb=388.6, bsz=32, num_updates=40570, lr=5.76452e-06, gnorm=4.158, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84232
2022-05-09 20:13:01 - progress_bar.py[line:272] - INFO: epoch 003:   5217 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887102, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.507, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=223.6, ups=0.58, wpb=384.5, bsz=32, num_updates=40580, lr=5.76332e-06, gnorm=3.696, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84249
2022-05-09 20:13:18 - progress_bar.py[line:272] - INFO: epoch 003:   5227 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=380.2, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.101, expert1_balance_bottom=19.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=220.7, ups=0.58, wpb=380.2, bsz=32, num_updates=40590, lr=5.76212e-06, gnorm=3.675, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84266
2022-05-09 20:13:36 - progress_bar.py[line:272] - INFO: epoch 003:   5237 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885084, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.348, expert1_balance_bottom=19.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.8, ups=0.58, wpb=384.5, bsz=32, num_updates=40600, lr=5.76091e-06, gnorm=3.908, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84284
2022-05-09 20:13:53 - progress_bar.py[line:272] - INFO: epoch 003:   5247 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=377.7, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.108, expert1_balance_bottom=19.377, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217.9, ups=0.58, wpb=377.7, bsz=32, num_updates=40610, lr=5.75971e-06, gnorm=3.775, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84301
2022-05-09 20:14:10 - progress_bar.py[line:272] - INFO: epoch 003:   5257 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=384.8, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884394, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.911, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223.5, ups=0.58, wpb=384.8, bsz=32, num_updates=40620, lr=5.75851e-06, gnorm=3.793, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84318
2022-05-09 20:14:28 - progress_bar.py[line:272] - INFO: epoch 003:   5267 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=372.2, nsentences=32, sample_size=296.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884814, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.303, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.3, ups=0.58, wpb=372.2, bsz=32, num_updates=40630, lr=5.75731e-06, gnorm=3.564, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84336
2022-05-09 20:14:45 - progress_bar.py[line:272] - INFO: epoch 003:   5277 / 17711 loss=3.084, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.084, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.107, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=223.5, ups=0.58, wpb=383.8, bsz=32, num_updates=40640, lr=5.75611e-06, gnorm=4.202, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84353
2022-05-09 20:15:02 - progress_bar.py[line:272] - INFO: epoch 003:   5287 / 17711 loss=3.119, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=386.7, nsentences=32, sample_size=307.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878156, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.119, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.568, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=219.5, ups=0.57, wpb=386.7, bsz=32, num_updates=40650, lr=5.75491e-06, gnorm=3.947, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84370
2022-05-09 20:15:20 - progress_bar.py[line:272] - INFO: epoch 003:   5297 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=385.5, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.445, expert1_balance_bottom=19.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=223.3, ups=0.58, wpb=385.5, bsz=32, num_updates=40660, lr=5.75371e-06, gnorm=3.562, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84388
2022-05-09 20:15:37 - progress_bar.py[line:272] - INFO: epoch 003:   5307 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=388.1, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883672, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.608, expert1_balance_bottom=19.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=222.4, ups=0.57, wpb=388.1, bsz=32, num_updates=40670, lr=5.7525e-06, gnorm=3.625, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84405
2022-05-09 20:15:54 - progress_bar.py[line:272] - INFO: epoch 003:   5317 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=382.4, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89358, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.2, expert1_balance_bottom=19.476, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223.1, ups=0.58, wpb=382.4, bsz=32, num_updates=40680, lr=5.7513e-06, gnorm=4.267, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84422
2022-05-09 20:16:12 - progress_bar.py[line:272] - INFO: epoch 003:   5327 / 17711 loss=3.078, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=383.4, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.078, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.513, expert1_balance_bottom=19.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=220, ups=0.57, wpb=383.4, bsz=32, num_updates=40690, lr=5.7501e-06, gnorm=3.969, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84440
2022-05-09 20:16:29 - progress_bar.py[line:272] - INFO: epoch 003:   5337 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=388.3, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891729, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.27, expert1_balance_bottom=19.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=226.2, ups=0.58, wpb=388.3, bsz=32, num_updates=40700, lr=5.7489e-06, gnorm=3.339, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84457
2022-05-09 20:16:46 - progress_bar.py[line:272] - INFO: epoch 003:   5347 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=378.1, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.825, expert1_balance_bottom=19.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222, ups=0.59, wpb=378.1, bsz=32, num_updates=40710, lr=5.7477e-06, gnorm=3.211, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84474
2022-05-09 20:17:03 - progress_bar.py[line:272] - INFO: epoch 003:   5357 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=370.1, nsentences=32, sample_size=294.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.694, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.4, ups=0.59, wpb=370.1, bsz=32, num_updates=40720, lr=5.7465e-06, gnorm=3.775, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84491
2022-05-09 20:17:20 - progress_bar.py[line:272] - INFO: epoch 003:   5367 / 17711 loss=2.929, loss_v1=0, loss_v2=0, nll_loss=0.704, ntokens=392, nsentences=32, sample_size=312.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887283, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.929, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.763, expert1_balance_bottom=19.239, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=228.3, ups=0.58, wpb=392, bsz=32, num_updates=40730, lr=5.7453e-06, gnorm=3.318, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84508
2022-05-09 20:17:37 - progress_bar.py[line:272] - INFO: epoch 003:   5377 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878355, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=35.293, expert1_balance_bottom=19.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.8, ups=0.59, wpb=384.2, bsz=32, num_updates=40740, lr=5.7441e-06, gnorm=5.633, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84525
2022-05-09 20:17:55 - progress_bar.py[line:272] - INFO: epoch 003:   5387 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=380.4, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89403, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.927, expert1_balance_bottom=19.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=218.2, ups=0.57, wpb=380.4, bsz=32, num_updates=40750, lr=5.74289e-06, gnorm=3.364, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84543
2022-05-09 20:18:12 - progress_bar.py[line:272] - INFO: epoch 003:   5397 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=388.8, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881865, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=35.077, expert1_balance_bottom=19.189, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.5, ups=0.57, wpb=388.8, bsz=32, num_updates=40760, lr=5.74169e-06, gnorm=3.997, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84560
2022-05-09 20:18:30 - progress_bar.py[line:272] - INFO: epoch 003:   5407 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=387.7, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884138, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=35.031, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.9, ups=0.57, wpb=387.7, bsz=32, num_updates=40770, lr=5.74049e-06, gnorm=3.734, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84578
2022-05-09 20:18:47 - progress_bar.py[line:272] - INFO: epoch 003:   5417 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=376.4, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893211, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.536, expert1_balance_bottom=19.385, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=218.3, ups=0.58, wpb=376.4, bsz=32, num_updates=40780, lr=5.73929e-06, gnorm=4.23, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84595
2022-05-09 20:19:04 - progress_bar.py[line:272] - INFO: epoch 003:   5427 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=379.8, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.781, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216.3, ups=0.57, wpb=379.8, bsz=32, num_updates=40790, lr=5.73809e-06, gnorm=3.003, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84613
2022-05-09 20:19:22 - progress_bar.py[line:272] - INFO: epoch 003:   5437 / 17711 loss=2.923, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=381.8, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.923, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.655, expert1_balance_bottom=19.284, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=218.1, ups=0.57, wpb=381.8, bsz=32, num_updates=40800, lr=5.73689e-06, gnorm=3.313, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84630
2022-05-09 20:19:40 - progress_bar.py[line:272] - INFO: epoch 003:   5447 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=393, nsentences=32, sample_size=312.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876712, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=35.496, expert1_balance_bottom=19.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.6, ups=0.56, wpb=393, bsz=32, num_updates=40810, lr=5.73569e-06, gnorm=3.661, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84648
2022-05-09 20:19:57 - progress_bar.py[line:272] - INFO: epoch 003:   5457 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=387.2, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889828, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.444, expert1_balance_bottom=19.536, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220.9, ups=0.57, wpb=387.2, bsz=32, num_updates=40820, lr=5.73448e-06, gnorm=3.359, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84665
2022-05-09 20:20:15 - progress_bar.py[line:272] - INFO: epoch 003:   5467 / 17711 loss=3.057, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=384.8, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880407, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.057, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.527, expert1_balance_bottom=19.618, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218.9, ups=0.57, wpb=384.8, bsz=32, num_updates=40830, lr=5.73328e-06, gnorm=3.781, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84683
2022-05-09 20:20:32 - progress_bar.py[line:272] - INFO: epoch 003:   5477 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=382.2, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883565, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.248, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=228, ups=0.6, wpb=382.2, bsz=32, num_updates=40840, lr=5.73208e-06, gnorm=3.812, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84700
2022-05-09 20:20:49 - progress_bar.py[line:272] - INFO: epoch 003:   5487 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=385.7, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888996, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.731, expert1_balance_bottom=19.338, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=225.2, ups=0.58, wpb=385.7, bsz=32, num_updates=40850, lr=5.73088e-06, gnorm=4.139, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84717
2022-05-09 20:21:06 - progress_bar.py[line:272] - INFO: epoch 003:   5497 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=380, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.835, expert1_balance_bottom=19.253, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=216.9, ups=0.57, wpb=380, bsz=32, num_updates=40860, lr=5.72968e-06, gnorm=3.505, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84734
2022-05-09 20:21:23 - progress_bar.py[line:272] - INFO: epoch 003:   5507 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=388.5, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885102, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.748, expert1_balance_bottom=19.308, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=226.1, ups=0.58, wpb=388.5, bsz=32, num_updates=40870, lr=5.72848e-06, gnorm=3.54, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84751
2022-05-09 20:21:41 - progress_bar.py[line:272] - INFO: epoch 003:   5517 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=388.6, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884666, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.708, expert1_balance_bottom=19.213, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.6, ups=0.56, wpb=388.6, bsz=32, num_updates=40880, lr=5.72728e-06, gnorm=4.058, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84769
2022-05-09 20:21:58 - progress_bar.py[line:272] - INFO: epoch 003:   5527 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878574, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.839, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=224.7, ups=0.59, wpb=384, bsz=32, num_updates=40890, lr=5.72608e-06, gnorm=3.846, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84786
2022-05-09 20:22:16 - progress_bar.py[line:272] - INFO: epoch 003:   5537 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=386.7, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884253, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.772, expert1_balance_bottom=19.217, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.7, ups=0.56, wpb=386.7, bsz=32, num_updates=40900, lr=5.72487e-06, gnorm=3.173, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84804
2022-05-09 20:22:20 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 20:22:35 - progress_bar.py[line:272] - INFO: epoch 003:   5548 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=384.1, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888685, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.075, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=201.1, ups=0.52, wpb=384.1, bsz=32, num_updates=40910, lr=5.72367e-06, gnorm=3.499, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84823
2022-05-09 20:22:53 - progress_bar.py[line:272] - INFO: epoch 003:   5558 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=386.3, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890105, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.275, expert1_balance_bottom=19.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=222, ups=0.57, wpb=386.3, bsz=32, num_updates=40920, lr=5.72247e-06, gnorm=3.586, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84841
2022-05-09 20:23:10 - progress_bar.py[line:272] - INFO: epoch 003:   5568 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=377.5, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895758, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.628, expert1_balance_bottom=19.576, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=217.6, ups=0.58, wpb=377.5, bsz=32, num_updates=40930, lr=5.72127e-06, gnorm=3.519, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84858
2022-05-09 20:23:27 - progress_bar.py[line:272] - INFO: epoch 003:   5578 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=379.4, nsentences=32, sample_size=302, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892544, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.211, expert1_balance_bottom=19.504, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.9, ups=0.57, wpb=379.4, bsz=32, num_updates=40940, lr=5.72007e-06, gnorm=3.876, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84875
2022-05-09 20:23:45 - progress_bar.py[line:272] - INFO: epoch 003:   5588 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=376.7, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88891, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.22, expert1_balance_bottom=19.51, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.2, ups=0.58, wpb=376.7, bsz=32, num_updates=40950, lr=5.71887e-06, gnorm=3.468, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84893
2022-05-09 20:24:03 - progress_bar.py[line:272] - INFO: epoch 003:   5598 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=379.7, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897391, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.959, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=207.7, ups=0.55, wpb=379.7, bsz=32, num_updates=40960, lr=5.71767e-06, gnorm=3.71, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84911
2022-05-09 20:24:21 - progress_bar.py[line:272] - INFO: epoch 003:   5608 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=381.5, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888651, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.202, expert1_balance_bottom=19.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.3, ups=0.56, wpb=381.5, bsz=32, num_updates=40970, lr=5.71647e-06, gnorm=3.604, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84929
2022-05-09 20:24:38 - progress_bar.py[line:272] - INFO: epoch 003:   5618 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=383, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878984, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.485, expert1_balance_bottom=19.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.3, ups=0.58, wpb=383, bsz=32, num_updates=40980, lr=5.71526e-06, gnorm=3.522, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84946
2022-05-09 20:24:55 - progress_bar.py[line:272] - INFO: epoch 003:   5628 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=386, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=35.07, expert1_balance_bottom=19.227, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=224.9, ups=0.58, wpb=386, bsz=32, num_updates=40990, lr=5.71406e-06, gnorm=3.704, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84963
2022-05-09 20:25:12 - progress_bar.py[line:272] - INFO: epoch 003:   5638 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=394.1, nsentences=32, sample_size=313.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879454, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.86, expert1_balance_bottom=19.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=228.3, ups=0.58, wpb=394.1, bsz=32, num_updates=41000, lr=5.71286e-06, gnorm=3.736, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84980
2022-05-09 20:25:30 - progress_bar.py[line:272] - INFO: epoch 003:   5648 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=385.4, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887251, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.357, expert1_balance_bottom=19.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220.1, ups=0.57, wpb=385.4, bsz=32, num_updates=41010, lr=5.71166e-06, gnorm=4.127, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=84998
2022-05-09 20:25:48 - progress_bar.py[line:272] - INFO: epoch 003:   5658 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=382.2, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880871, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.848, expert1_balance_bottom=19.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=215.2, ups=0.56, wpb=382.2, bsz=32, num_updates=41020, lr=5.71046e-06, gnorm=3.517, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85016
2022-05-09 20:26:05 - progress_bar.py[line:272] - INFO: epoch 003:   5668 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.889, expert1_balance_bottom=19.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.8, ups=0.58, wpb=381.5, bsz=32, num_updates=41030, lr=5.70926e-06, gnorm=3.867, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85033
2022-05-09 20:26:23 - progress_bar.py[line:272] - INFO: epoch 003:   5678 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=390.1, nsentences=32, sample_size=310.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889645, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.556, expert1_balance_bottom=19.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.9, ups=0.56, wpb=390.1, bsz=32, num_updates=41040, lr=5.70806e-06, gnorm=3.541, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85051
2022-05-09 20:26:40 - progress_bar.py[line:272] - INFO: epoch 003:   5688 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=379.9, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.825, expert1_balance_bottom=19.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.1, ups=0.58, wpb=379.9, bsz=32, num_updates=41050, lr=5.70685e-06, gnorm=4.072, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85068
2022-05-09 20:26:57 - progress_bar.py[line:272] - INFO: epoch 003:   5698 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=375.8, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884986, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.948, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=218.1, ups=0.58, wpb=375.8, bsz=32, num_updates=41060, lr=5.70565e-06, gnorm=3.208, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85085
2022-05-09 20:27:15 - progress_bar.py[line:272] - INFO: epoch 003:   5708 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=377.2, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887544, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.511, expert1_balance_bottom=19.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.4, ups=0.57, wpb=377.2, bsz=32, num_updates=41070, lr=5.70445e-06, gnorm=3.498, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85103
2022-05-09 20:27:32 - progress_bar.py[line:272] - INFO: epoch 003:   5718 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=378.5, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88107, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.087, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.2, ups=0.58, wpb=378.5, bsz=32, num_updates=41080, lr=5.70325e-06, gnorm=3.434, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85120
2022-05-09 20:27:49 - progress_bar.py[line:272] - INFO: epoch 003:   5728 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=385.4, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882821, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.713, expert1_balance_bottom=19.3, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=220, ups=0.57, wpb=385.4, bsz=32, num_updates=41090, lr=5.70205e-06, gnorm=3.594, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85138
2022-05-09 20:28:07 - progress_bar.py[line:272] - INFO: epoch 003:   5738 / 17711 loss=2.936, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=384.9, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886532, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.936, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=35.128, expert1_balance_bottom=19.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=223.4, ups=0.58, wpb=384.9, bsz=32, num_updates=41100, lr=5.70085e-06, gnorm=3.611, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85155
2022-05-09 20:28:24 - progress_bar.py[line:272] - INFO: epoch 003:   5748 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=382.6, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.871895, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.661, expert1_balance_bottom=18.976, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=217.9, ups=0.57, wpb=382.6, bsz=32, num_updates=41110, lr=5.69965e-06, gnorm=3.431, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85172
2022-05-09 20:28:42 - progress_bar.py[line:272] - INFO: epoch 003:   5758 / 17711 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=381.9, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893001, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.951, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.206, expert1_balance_bottom=19.537, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=220.7, ups=0.58, wpb=381.9, bsz=32, num_updates=41120, lr=5.69845e-06, gnorm=3.541, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85190
2022-05-09 20:28:59 - progress_bar.py[line:272] - INFO: epoch 003:   5768 / 17711 loss=2.905, loss_v1=0, loss_v2=0, nll_loss=0.672, ntokens=378, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897404, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.905, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.596, expert1_balance_bottom=19.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.59, wps=213, ups=0.56, wpb=378, bsz=32, num_updates=41130, lr=5.69724e-06, gnorm=3.785, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85207
2022-05-09 20:29:17 - progress_bar.py[line:272] - INFO: epoch 003:   5778 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=373.3, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893767, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.075, expert1_balance_bottom=19.59, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212.4, ups=0.57, wpb=373.3, bsz=32, num_updates=41140, lr=5.69604e-06, gnorm=3.838, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85225
2022-05-09 20:29:34 - progress_bar.py[line:272] - INFO: epoch 003:   5788 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=388.4, nsentences=32, sample_size=309.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.989, expert1_balance_bottom=19.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=226, ups=0.58, wpb=388.4, bsz=32, num_updates=41150, lr=5.69484e-06, gnorm=3.782, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85242
2022-05-09 20:29:51 - progress_bar.py[line:272] - INFO: epoch 003:   5798 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=386.2, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879529, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.762, expert1_balance_bottom=19.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.9, ups=0.58, wpb=386.2, bsz=32, num_updates=41160, lr=5.69364e-06, gnorm=3.79, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85259
2022-05-09 20:30:08 - progress_bar.py[line:272] - INFO: epoch 003:   5808 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=377.3, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887955, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.495, expert1_balance_bottom=19.433, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.7, ups=0.59, wpb=377.3, bsz=32, num_updates=41170, lr=5.69244e-06, gnorm=4.569, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85276
2022-05-09 20:30:26 - progress_bar.py[line:272] - INFO: epoch 003:   5818 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893783, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.087, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.1, ups=0.58, wpb=378.4, bsz=32, num_updates=41180, lr=5.69124e-06, gnorm=3.858, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85294
2022-05-09 20:30:43 - progress_bar.py[line:272] - INFO: epoch 003:   5828 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=374.1, nsentences=32, sample_size=298, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.904276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.131, expert1_balance_bottom=19.655, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.4, ups=0.59, wpb=374.1, bsz=32, num_updates=41190, lr=5.69004e-06, gnorm=3.526, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85311
2022-05-09 20:31:00 - progress_bar.py[line:272] - INFO: epoch 003:   5838 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=35.072, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=228.5, ups=0.59, wpb=386.3, bsz=32, num_updates=41200, lr=5.68883e-06, gnorm=3.924, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85328
2022-05-09 20:31:16 - progress_bar.py[line:272] - INFO: epoch 003:   5848 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=390.1, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884911, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.34, expert1_balance_bottom=19.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=232.5, ups=0.6, wpb=390.1, bsz=32, num_updates=41210, lr=5.68763e-06, gnorm=3.397, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85344
2022-05-09 20:31:33 - progress_bar.py[line:272] - INFO: epoch 003:   5858 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=379, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.378, expert1_balance_bottom=19.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223.9, ups=0.59, wpb=379, bsz=32, num_updates=41220, lr=5.68643e-06, gnorm=3.844, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85361
2022-05-09 20:31:50 - progress_bar.py[line:272] - INFO: epoch 003:   5868 / 17711 loss=2.948, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=379.8, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878654, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.948, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.106, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=224.6, ups=0.59, wpb=379.8, bsz=32, num_updates=41230, lr=5.68523e-06, gnorm=3.448, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85378
2022-05-09 20:32:07 - progress_bar.py[line:272] - INFO: epoch 003:   5878 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882849, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.63, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=224.5, ups=0.59, wpb=382.4, bsz=32, num_updates=41240, lr=5.68403e-06, gnorm=3.923, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85395
2022-05-09 20:32:24 - progress_bar.py[line:272] - INFO: epoch 003:   5888 / 17711 loss=2.936, loss_v1=0, loss_v2=0, nll_loss=0.711, ntokens=379.6, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.936, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.148, expert1_balance_bottom=19.63, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=223.5, ups=0.59, wpb=379.6, bsz=32, num_updates=41250, lr=5.68283e-06, gnorm=3.287, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85412
2022-05-09 20:32:41 - progress_bar.py[line:272] - INFO: epoch 003:   5898 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=380.2, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.201, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.7, ups=0.59, wpb=380.2, bsz=32, num_updates=41260, lr=5.68163e-06, gnorm=3.626, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85429
2022-05-09 20:32:58 - progress_bar.py[line:272] - INFO: epoch 003:   5908 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=381, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87629, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.01, expert1_balance_bottom=19.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=224.8, ups=0.59, wpb=381, bsz=32, num_updates=41270, lr=5.68043e-06, gnorm=3.651, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85446
2022-05-09 20:33:16 - progress_bar.py[line:272] - INFO: epoch 003:   5918 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878436, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.396, expert1_balance_bottom=19.11, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=222.7, ups=0.58, wpb=386.3, bsz=32, num_updates=41280, lr=5.67922e-06, gnorm=3.615, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85464
2022-05-09 20:33:33 - progress_bar.py[line:272] - INFO: epoch 003:   5928 / 17711 loss=3.044, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=385.3, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887155, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.044, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.68, expert1_balance_bottom=19.19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=222.3, ups=0.58, wpb=385.3, bsz=32, num_updates=41290, lr=5.67802e-06, gnorm=3.699, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85481
2022-05-09 20:33:50 - progress_bar.py[line:272] - INFO: epoch 003:   5938 / 17711 loss=3.05, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=378.8, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.05, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.954, expert1_balance_bottom=19.66, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=223.5, ups=0.59, wpb=378.8, bsz=32, num_updates=41300, lr=5.67682e-06, gnorm=5.006, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85498
2022-05-09 20:34:07 - progress_bar.py[line:272] - INFO: epoch 003:   5948 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=381.7, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.588, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221.2, ups=0.58, wpb=381.7, bsz=32, num_updates=41310, lr=5.67562e-06, gnorm=3.702, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85515
2022-05-09 20:34:24 - progress_bar.py[line:272] - INFO: epoch 003:   5958 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=388, nsentences=32, sample_size=308.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880347, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.463, expert1_balance_bottom=19.575, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=228.7, ups=0.59, wpb=388, bsz=32, num_updates=41320, lr=5.67442e-06, gnorm=3.453, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85532
2022-05-09 20:34:41 - progress_bar.py[line:272] - INFO: epoch 003:   5968 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=382, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889903, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.133, expert1_balance_bottom=19.469, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=223.8, ups=0.59, wpb=382, bsz=32, num_updates=41330, lr=5.67322e-06, gnorm=3.325, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85549
2022-05-09 20:34:58 - progress_bar.py[line:272] - INFO: epoch 003:   5978 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=385.5, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887738, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.325, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=226.3, ups=0.59, wpb=385.5, bsz=32, num_updates=41340, lr=5.67202e-06, gnorm=3.291, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85566
2022-05-09 20:35:15 - progress_bar.py[line:272] - INFO: epoch 003:   5988 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=388.5, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885682, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.516, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=229.9, ups=0.59, wpb=388.5, bsz=32, num_updates=41350, lr=5.67082e-06, gnorm=3.003, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85583
2022-05-09 20:35:32 - progress_bar.py[line:272] - INFO: epoch 003:   5998 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=381.6, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881933, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.707, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=224.1, ups=0.59, wpb=381.6, bsz=32, num_updates=41360, lr=5.66961e-06, gnorm=3.399, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85600
2022-05-09 20:35:49 - progress_bar.py[line:272] - INFO: epoch 003:   6008 / 17711 loss=2.932, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.932, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.747, expert1_balance_bottom=19.333, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=221.3, ups=0.58, wpb=382.8, bsz=32, num_updates=41370, lr=5.66841e-06, gnorm=3.135, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85618
2022-05-09 20:36:07 - progress_bar.py[line:272] - INFO: epoch 003:   6018 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889813, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.252, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=224.7, ups=0.58, wpb=384.3, bsz=32, num_updates=41380, lr=5.66721e-06, gnorm=3.068, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85635
2022-05-09 20:36:24 - progress_bar.py[line:272] - INFO: epoch 003:   6028 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880155, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.905, expert1_balance_bottom=19.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=225.5, ups=0.59, wpb=382.6, bsz=32, num_updates=41390, lr=5.66601e-06, gnorm=4.377, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85652
2022-05-09 20:36:41 - progress_bar.py[line:272] - INFO: epoch 003:   6038 / 17711 loss=3.023, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=383.9, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881212, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.023, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.575, expert1_balance_bottom=19.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.5, ups=0.58, wpb=383.9, bsz=32, num_updates=41400, lr=5.66481e-06, gnorm=3.645, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85669
2022-05-09 20:36:56 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 20:37:00 - progress_bar.py[line:272] - INFO: epoch 003:   6049 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=386.8, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890384, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.058, expert1_balance_bottom=19.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=204.8, ups=0.53, wpb=386.8, bsz=32, num_updates=41410, lr=5.66361e-06, gnorm=3.362, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85688
2022-05-09 20:37:17 - progress_bar.py[line:272] - INFO: epoch 003:   6059 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=387.9, nsentences=32, sample_size=308.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.198, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=221.3, ups=0.57, wpb=387.9, bsz=32, num_updates=41420, lr=5.66241e-06, gnorm=3.405, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85705
2022-05-09 20:37:35 - progress_bar.py[line:272] - INFO: epoch 003:   6069 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=385, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880368, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.512, expert1_balance_bottom=19.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.1, ups=0.58, wpb=385, bsz=32, num_updates=41430, lr=5.6612e-06, gnorm=3.187, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85723
2022-05-09 20:37:52 - progress_bar.py[line:272] - INFO: epoch 003:   6079 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=386.5, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887263, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.351, expert1_balance_bottom=19.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=225.4, ups=0.58, wpb=386.5, bsz=32, num_updates=41440, lr=5.66e-06, gnorm=3.449, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85740
2022-05-09 20:38:09 - progress_bar.py[line:272] - INFO: epoch 003:   6089 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=385.2, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874517, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.213, expert1_balance_bottom=19.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.8, ups=0.57, wpb=385.2, bsz=32, num_updates=41450, lr=5.6588e-06, gnorm=4.027, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85757
2022-05-09 20:38:27 - progress_bar.py[line:272] - INFO: epoch 003:   6099 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=377.5, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884199, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.791, expert1_balance_bottom=19.219, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=215.2, ups=0.57, wpb=377.5, bsz=32, num_updates=41460, lr=5.6576e-06, gnorm=3.259, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85775
2022-05-09 20:38:44 - progress_bar.py[line:272] - INFO: epoch 003:   6109 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=375.9, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89707, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.482, expert1_balance_bottom=19.778, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=218.4, ups=0.58, wpb=375.9, bsz=32, num_updates=41470, lr=5.6564e-06, gnorm=3.478, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85792
2022-05-09 20:39:01 - progress_bar.py[line:272] - INFO: epoch 003:   6119 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=376.2, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.395, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.3, ups=0.58, wpb=376.2, bsz=32, num_updates=41480, lr=5.6552e-06, gnorm=3.926, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85809
2022-05-09 20:39:18 - progress_bar.py[line:272] - INFO: epoch 003:   6129 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=374.2, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889953, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.201, expert1_balance_bottom=19.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220, ups=0.59, wpb=374.2, bsz=32, num_updates=41490, lr=5.654e-06, gnorm=4.555, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85826
2022-05-09 20:39:35 - progress_bar.py[line:272] - INFO: epoch 003:   6139 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=382.8, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.861, expert1_balance_bottom=19.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.1, ups=0.58, wpb=382.8, bsz=32, num_updates=41500, lr=5.6528e-06, gnorm=4.131, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85844
2022-05-09 20:39:52 - progress_bar.py[line:272] - INFO: epoch 003:   6149 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=375.8, nsentences=32, sample_size=299.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890107, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.13, expert1_balance_bottom=19.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.1, ups=0.59, wpb=375.8, bsz=32, num_updates=41510, lr=5.65159e-06, gnorm=3.326, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85861
2022-05-09 20:40:10 - progress_bar.py[line:272] - INFO: epoch 003:   6159 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891585, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.766, expert1_balance_bottom=19.62, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.1, ups=0.59, wpb=377.2, bsz=32, num_updates=41520, lr=5.65039e-06, gnorm=3.642, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85878
2022-05-09 20:40:27 - progress_bar.py[line:272] - INFO: epoch 003:   6169 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=376.9, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898356, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.692, expert1_balance_bottom=19.665, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.1, ups=0.58, wpb=376.9, bsz=32, num_updates=41530, lr=5.64919e-06, gnorm=4.942, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85895
2022-05-09 20:40:44 - progress_bar.py[line:272] - INFO: epoch 003:   6179 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=389.9, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.058, expert1_balance_bottom=19.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=228.6, ups=0.59, wpb=389.9, bsz=32, num_updates=41540, lr=5.64799e-06, gnorm=3.646, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85912
2022-05-09 20:41:01 - progress_bar.py[line:272] - INFO: epoch 003:   6189 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=381.2, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873852, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.994, expert1_balance_bottom=19.221, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=227, ups=0.6, wpb=381.2, bsz=32, num_updates=41550, lr=5.64679e-06, gnorm=3.956, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85929
2022-05-09 20:41:18 - progress_bar.py[line:272] - INFO: epoch 003:   6199 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.707, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=224.1, ups=0.59, wpb=380.6, bsz=32, num_updates=41560, lr=5.64559e-06, gnorm=3.017, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85946
2022-05-09 20:41:35 - progress_bar.py[line:272] - INFO: epoch 003:   6209 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=383, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879261, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=35.009, expert1_balance_bottom=19.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.2, ups=0.57, wpb=383, bsz=32, num_updates=41570, lr=5.64439e-06, gnorm=3.744, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85963
2022-05-09 20:41:53 - progress_bar.py[line:272] - INFO: epoch 003:   6219 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=387.7, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882795, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.966, expert1_balance_bottom=19.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223.3, ups=0.58, wpb=387.7, bsz=32, num_updates=41580, lr=5.64318e-06, gnorm=5.573, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85981
2022-05-09 20:42:09 - progress_bar.py[line:272] - INFO: epoch 003:   6229 / 17711 loss=2.949, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=379, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896991, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.949, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=34.062, expert1_balance_bottom=19.597, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=223.2, ups=0.59, wpb=379, bsz=32, num_updates=41590, lr=5.64198e-06, gnorm=3.433, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=85998
2022-05-09 20:42:27 - progress_bar.py[line:272] - INFO: epoch 003:   6239 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884974, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.939, expert1_balance_bottom=19.333, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=223.6, ups=0.58, wpb=384.2, bsz=32, num_updates=41600, lr=5.64078e-06, gnorm=3.542, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86015
2022-05-09 20:42:44 - progress_bar.py[line:272] - INFO: epoch 003:   6249 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=378.5, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893382, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.423, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=223.9, ups=0.59, wpb=378.5, bsz=32, num_updates=41610, lr=5.63958e-06, gnorm=3.555, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86032
2022-05-09 20:43:01 - progress_bar.py[line:272] - INFO: epoch 003:   6259 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=378.1, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90034, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.11, expert1_balance_top=33.613, expert1_balance_bottom=19.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.4, ups=0.59, wpb=378.1, bsz=32, num_updates=41620, lr=5.63838e-06, gnorm=4.341, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86049
2022-05-09 20:43:18 - progress_bar.py[line:272] - INFO: epoch 003:   6269 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=382, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888753, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.392, expert1_balance_bottom=19.417, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.7, ups=0.58, wpb=382, bsz=32, num_updates=41630, lr=5.63718e-06, gnorm=3.782, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86066
2022-05-09 20:43:35 - progress_bar.py[line:272] - INFO: epoch 003:   6279 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=388, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877934, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.803, expert1_balance_bottom=19.191, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=223.7, ups=0.58, wpb=388, bsz=32, num_updates=41640, lr=5.63598e-06, gnorm=4.854, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86083
2022-05-09 20:43:53 - progress_bar.py[line:272] - INFO: epoch 003:   6289 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=377, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884288, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.601, expert1_balance_bottom=19.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.3, ups=0.58, wpb=377, bsz=32, num_updates=41650, lr=5.63478e-06, gnorm=3.742, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86101
2022-05-09 20:44:10 - progress_bar.py[line:272] - INFO: epoch 003:   6299 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=376.1, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.428, expert1_balance_bottom=19.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218, ups=0.58, wpb=376.1, bsz=32, num_updates=41660, lr=5.63357e-06, gnorm=4.214, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86118
2022-05-09 20:44:27 - progress_bar.py[line:272] - INFO: epoch 003:   6309 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=387.9, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875019, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.215, expert1_balance_bottom=19.108, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=221.1, ups=0.57, wpb=387.9, bsz=32, num_updates=41670, lr=5.63237e-06, gnorm=5.08, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86135
2022-05-09 20:44:45 - progress_bar.py[line:272] - INFO: epoch 003:   6319 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=385.9, nsentences=32, sample_size=307.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.257, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=218.2, ups=0.57, wpb=385.9, bsz=32, num_updates=41680, lr=5.63117e-06, gnorm=3.443, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86153
2022-05-09 20:45:02 - progress_bar.py[line:272] - INFO: epoch 003:   6329 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=383, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897324, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.929, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.9, ups=0.58, wpb=383, bsz=32, num_updates=41690, lr=5.62997e-06, gnorm=3.609, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86170
2022-05-09 20:45:19 - progress_bar.py[line:272] - INFO: epoch 003:   6339 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=370.2, nsentences=32, sample_size=294.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888658, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.56, expert1_balance_bottom=19.46, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=218.9, ups=0.59, wpb=370.2, bsz=32, num_updates=41700, lr=5.62877e-06, gnorm=3.073, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86187
2022-05-09 20:45:36 - progress_bar.py[line:272] - INFO: epoch 003:   6349 / 17711 loss=2.958, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=388.7, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878683, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.958, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.315, expert1_balance_bottom=18.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=228.3, ups=0.59, wpb=388.7, bsz=32, num_updates=41710, lr=5.62757e-06, gnorm=3.609, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86204
2022-05-09 20:45:54 - progress_bar.py[line:272] - INFO: epoch 003:   6359 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=387.7, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.685, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.7, ups=0.57, wpb=387.7, bsz=32, num_updates=41720, lr=5.62637e-06, gnorm=3.788, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86222
2022-05-09 20:46:11 - progress_bar.py[line:272] - INFO: epoch 003:   6369 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=384.1, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878838, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.746, expert1_balance_bottom=19.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=223.3, ups=0.58, wpb=384.1, bsz=32, num_updates=41730, lr=5.62517e-06, gnorm=3.37, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86239
2022-05-09 20:46:28 - progress_bar.py[line:272] - INFO: epoch 003:   6379 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=383.5, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.457, expert1_balance_bottom=19.679, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=221.1, ups=0.58, wpb=383.5, bsz=32, num_updates=41740, lr=5.62396e-06, gnorm=3.925, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86256
2022-05-09 20:46:45 - progress_bar.py[line:272] - INFO: epoch 003:   6389 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=370.6, nsentences=32, sample_size=295, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.905231, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.112, expert1_balance_top=33.104, expert1_balance_bottom=19.806, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=217.5, ups=0.59, wpb=370.6, bsz=32, num_updates=41750, lr=5.62276e-06, gnorm=3.343, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86273
2022-05-09 20:47:03 - progress_bar.py[line:272] - INFO: epoch 003:   6399 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=384.1, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875996, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.08, expert1_balance_bottom=19.231, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221.6, ups=0.58, wpb=384.1, bsz=32, num_updates=41760, lr=5.62156e-06, gnorm=3.452, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86291
2022-05-09 20:47:20 - progress_bar.py[line:272] - INFO: epoch 003:   6409 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=382.9, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882821, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.283, expert1_balance_bottom=19.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.6, ups=0.58, wpb=382.9, bsz=32, num_updates=41770, lr=5.62036e-06, gnorm=3.178, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86308
2022-05-09 20:47:37 - progress_bar.py[line:272] - INFO: epoch 003:   6419 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=387.1, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891819, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.787, expert1_balance_bottom=19.713, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=227.1, ups=0.59, wpb=387.1, bsz=32, num_updates=41780, lr=5.61916e-06, gnorm=3.144, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86325
2022-05-09 20:47:55 - progress_bar.py[line:272] - INFO: epoch 003:   6429 / 17711 loss=2.92, loss_v1=0, loss_v2=0, nll_loss=0.7, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888191, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.92, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.857, expert1_balance_bottom=19.693, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.62, wps=215.1, ups=0.56, wpb=381.9, bsz=32, num_updates=41790, lr=5.61796e-06, gnorm=3.737, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86343
2022-05-09 20:48:12 - progress_bar.py[line:272] - INFO: epoch 003:   6439 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=381.1, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885748, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.216, expert1_balance_bottom=19.476, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=223.9, ups=0.59, wpb=381.1, bsz=32, num_updates=41800, lr=5.61676e-06, gnorm=4.117, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86360
2022-05-09 20:48:29 - progress_bar.py[line:272] - INFO: epoch 003:   6449 / 17711 loss=3.089, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=384.9, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881172, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.089, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.159, expert1_balance_bottom=19.633, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=226.3, ups=0.59, wpb=384.9, bsz=32, num_updates=41810, lr=5.61555e-06, gnorm=3.824, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86377
2022-05-09 20:48:46 - progress_bar.py[line:272] - INFO: epoch 003:   6459 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=387.6, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879411, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.447, expert1_balance_bottom=19.383, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=227.9, ups=0.59, wpb=387.6, bsz=32, num_updates=41820, lr=5.61435e-06, gnorm=3.67, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86394
2022-05-09 20:49:03 - progress_bar.py[line:272] - INFO: epoch 003:   6469 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88017, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.582, expert1_balance_bottom=19.312, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=219.4, ups=0.58, wpb=381.1, bsz=32, num_updates=41830, lr=5.61315e-06, gnorm=5.239, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86411
2022-05-09 20:49:20 - progress_bar.py[line:272] - INFO: epoch 003:   6479 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=381.8, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.021, expert1_balance_bottom=19.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=220.6, ups=0.58, wpb=381.8, bsz=32, num_updates=41840, lr=5.61195e-06, gnorm=3.294, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86429
2022-05-09 20:49:38 - progress_bar.py[line:272] - INFO: epoch 003:   6489 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=383.7, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891061, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.006, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=223.8, ups=0.58, wpb=383.7, bsz=32, num_updates=41850, lr=5.61075e-06, gnorm=3.566, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86446
2022-05-09 20:49:55 - progress_bar.py[line:272] - INFO: epoch 003:   6499 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=379.5, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87989, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.409, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224.2, ups=0.59, wpb=379.5, bsz=32, num_updates=41860, lr=5.60955e-06, gnorm=3.898, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86463
2022-05-09 20:50:12 - progress_bar.py[line:272] - INFO: epoch 003:   6509 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.03, expert1_balance_bottom=19.452, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=217.5, ups=0.58, wpb=376.7, bsz=32, num_updates=41870, lr=5.60835e-06, gnorm=4.096, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86480
2022-05-09 20:50:29 - progress_bar.py[line:272] - INFO: epoch 003:   6519 / 17711 loss=3.038, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=385.5, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890566, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.038, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.796, expert1_balance_bottom=19.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.1, ups=0.57, wpb=385.5, bsz=32, num_updates=41880, lr=5.60715e-06, gnorm=3.519, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86497
2022-05-09 20:50:46 - progress_bar.py[line:272] - INFO: epoch 003:   6529 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=377, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.262, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221.9, ups=0.59, wpb=377, bsz=32, num_updates=41890, lr=5.60594e-06, gnorm=4.251, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86514
2022-05-09 20:51:04 - progress_bar.py[line:272] - INFO: epoch 003:   6539 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=387, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884077, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.137, expert1_balance_bottom=19.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223.4, ups=0.58, wpb=387, bsz=32, num_updates=41900, lr=5.60474e-06, gnorm=4.132, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86532
2022-05-09 20:51:21 - progress_bar.py[line:272] - INFO: epoch 003:   6549 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=387.6, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89374, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.91, expert1_balance_bottom=19.399, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=224.1, ups=0.58, wpb=387.6, bsz=32, num_updates=41910, lr=5.60354e-06, gnorm=3.866, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86549
2022-05-09 20:51:38 - progress_bar.py[line:272] - INFO: epoch 003:   6559 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=367.5, nsentences=32, sample_size=292.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.111, expert1_balance_top=33.28, expert1_balance_bottom=19.621, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.6, ups=0.59, wpb=367.5, bsz=32, num_updates=41920, lr=5.60234e-06, gnorm=3.915, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86566
2022-05-09 20:51:55 - progress_bar.py[line:272] - INFO: epoch 003:   6569 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=387.2, nsentences=32, sample_size=308.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881106, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.544, expert1_balance_bottom=19.276, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=227.2, ups=0.59, wpb=387.2, bsz=32, num_updates=41930, lr=5.60114e-06, gnorm=3.081, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86583
2022-05-09 20:52:12 - progress_bar.py[line:272] - INFO: epoch 003:   6579 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=370.7, nsentences=32, sample_size=294.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89341, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=34.083, expert1_balance_bottom=19.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=212.5, ups=0.57, wpb=370.7, bsz=32, num_updates=41940, lr=5.59994e-06, gnorm=3.378, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86601
2022-05-09 20:52:30 - progress_bar.py[line:272] - INFO: epoch 003:   6589 / 17711 loss=3.092, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=382.5, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886761, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.092, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.816, expert1_balance_bottom=19.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=214.5, ups=0.56, wpb=382.5, bsz=32, num_updates=41950, lr=5.59874e-06, gnorm=4.346, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86618
2022-05-09 20:52:48 - progress_bar.py[line:272] - INFO: epoch 003:   6599 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=382.9, nsentences=32, sample_size=304.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888112, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.208, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=218.1, ups=0.57, wpb=382.9, bsz=32, num_updates=41960, lr=5.59753e-06, gnorm=3.943, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86636
2022-05-09 20:53:05 - progress_bar.py[line:272] - INFO: epoch 003:   6609 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=390, nsentences=32, sample_size=310.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883593, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.653, expert1_balance_bottom=19.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=222.5, ups=0.57, wpb=390, bsz=32, num_updates=41970, lr=5.59633e-06, gnorm=3.171, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86653
2022-05-09 20:53:23 - progress_bar.py[line:272] - INFO: epoch 003:   6619 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=389.3, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885402, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.175, expert1_balance_bottom=19.542, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.4, ups=0.57, wpb=389.3, bsz=32, num_updates=41980, lr=5.59513e-06, gnorm=3.648, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86671
2022-05-09 20:53:40 - progress_bar.py[line:272] - INFO: epoch 003:   6629 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=385.5, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88607, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.542, expert1_balance_bottom=19.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.8, ups=0.58, wpb=385.5, bsz=32, num_updates=41990, lr=5.59393e-06, gnorm=3.811, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86688
2022-05-09 20:53:57 - progress_bar.py[line:272] - INFO: epoch 003:   6639 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=374, nsentences=32, sample_size=297.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897222, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.086, expert1_balance_bottom=19.343, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.6, ups=0.58, wpb=374, bsz=32, num_updates=42000, lr=5.59273e-06, gnorm=3.489, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=86705
2022-05-09 20:53:57 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 20:53:58 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 20:53:58 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 21:01:10 - train.py[line:517] - INFO: valid_step finished
2022-05-09 21:01:10 - progress_bar.py[line:282] - INFO: epoch 003 | valid on 'valid' subset | loss 10.138 | loss_v1 0 | loss_v2 0 | nll_loss 8.477 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.00543 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.138 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.163 | expert1_balance_top 40.604 | expert1_balance_bottom 15.033 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 356.32 | cider 1.196 | wps 697 | wpb 481.7 | bsz 8 | num_updates 42000 | best_cider 1.203
2022-05-09 21:01:27 - progress_bar.py[line:272] - INFO: epoch 003:   6649 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881772, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.646, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=8.5, ups=0.02, wpb=380.5, bsz=32, num_updates=42010, lr=5.59153e-06, gnorm=4.32, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87155
2022-05-09 21:01:44 - progress_bar.py[line:272] - INFO: epoch 003:   6659 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=376.8, nsentences=32, sample_size=299.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892146, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.157, expert1_balance_bottom=19.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.6, ups=0.57, wpb=376.8, bsz=32, num_updates=42020, lr=5.59033e-06, gnorm=3.678, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87172
2022-05-09 21:02:02 - progress_bar.py[line:272] - INFO: epoch 003:   6669 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=377.3, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.8886, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.377, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=217.5, ups=0.58, wpb=377.3, bsz=32, num_updates=42030, lr=5.58913e-06, gnorm=3.252, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87190
2022-05-09 21:02:19 - progress_bar.py[line:272] - INFO: epoch 003:   6679 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=377.1, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874007, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.495, expert1_balance_bottom=19.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218, ups=0.58, wpb=377.1, bsz=32, num_updates=42040, lr=5.58792e-06, gnorm=5.22, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87207
2022-05-09 21:02:36 - progress_bar.py[line:272] - INFO: epoch 003:   6689 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=385.6, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879302, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.742, expert1_balance_bottom=19.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=221.1, ups=0.57, wpb=385.6, bsz=32, num_updates=42050, lr=5.58672e-06, gnorm=3.523, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87225
2022-05-09 21:02:54 - progress_bar.py[line:272] - INFO: epoch 003:   6699 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886624, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.609, expert1_balance_bottom=19.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.6, ups=0.57, wpb=384.4, bsz=32, num_updates=42060, lr=5.58552e-06, gnorm=3.416, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87242
2022-05-09 21:03:11 - progress_bar.py[line:272] - INFO: epoch 003:   6709 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=379, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886757, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.191, expert1_balance_bottom=19.534, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221.1, ups=0.58, wpb=379, bsz=32, num_updates=42070, lr=5.58432e-06, gnorm=3.527, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87259
2022-05-09 21:03:28 - progress_bar.py[line:272] - INFO: epoch 003:   6719 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=381.9, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891586, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.769, expert1_balance_bottom=19.684, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=225.5, ups=0.59, wpb=381.9, bsz=32, num_updates=42080, lr=5.58312e-06, gnorm=3.63, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87276
2022-05-09 21:03:45 - progress_bar.py[line:272] - INFO: epoch 003:   6729 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=393, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883018, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.259, expert1_balance_bottom=19.502, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=225, ups=0.57, wpb=393, bsz=32, num_updates=42090, lr=5.58192e-06, gnorm=3.805, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87293
2022-05-09 21:04:03 - progress_bar.py[line:272] - INFO: epoch 003:   6739 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=394.3, nsentences=32, sample_size=313.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.255, expert1_balance_bottom=19.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=226.6, ups=0.57, wpb=394.3, bsz=32, num_updates=42100, lr=5.58072e-06, gnorm=4.169, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87311
2022-05-09 21:04:20 - progress_bar.py[line:272] - INFO: epoch 003:   6749 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=381.5, nsentences=32, sample_size=303.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90016, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.109, expert1_balance_top=33.571, expert1_balance_bottom=19.662, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=222.7, ups=0.58, wpb=381.5, bsz=32, num_updates=42110, lr=5.57952e-06, gnorm=4.67, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87328
2022-05-09 21:04:37 - progress_bar.py[line:272] - INFO: epoch 003:   6759 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=381.9, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=35.26, expert1_balance_bottom=19.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=222.4, ups=0.58, wpb=381.9, bsz=32, num_updates=42120, lr=5.57831e-06, gnorm=3.593, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87345
2022-05-09 21:04:54 - progress_bar.py[line:272] - INFO: epoch 003:   6769 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=374.7, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875872, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.189, expert1_balance_bottom=19.188, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.5, ups=0.58, wpb=374.7, bsz=32, num_updates=42130, lr=5.57711e-06, gnorm=4.401, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87362
2022-05-09 21:05:12 - progress_bar.py[line:272] - INFO: epoch 003:   6779 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=381.8, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88859, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.146, expert1_balance_bottom=19.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220.6, ups=0.58, wpb=381.8, bsz=32, num_updates=42140, lr=5.57591e-06, gnorm=3.685, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87380
2022-05-09 21:05:29 - progress_bar.py[line:272] - INFO: epoch 003:   6789 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=387.9, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884038, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.711, expert1_balance_bottom=19.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=227.5, ups=0.59, wpb=387.9, bsz=32, num_updates=42150, lr=5.57471e-06, gnorm=3.821, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87397
2022-05-09 21:05:45 - progress_bar.py[line:272] - INFO: epoch 003:   6799 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=387.1, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883969, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=35.05, expert1_balance_bottom=19.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=230.2, ups=0.59, wpb=387.1, bsz=32, num_updates=42160, lr=5.57351e-06, gnorm=4.384, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87414
2022-05-09 21:06:03 - progress_bar.py[line:272] - INFO: epoch 003:   6809 / 17711 loss=3.054, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=387, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882598, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.054, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.834, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.7, ups=0.58, wpb=387, bsz=32, num_updates=42170, lr=5.57231e-06, gnorm=3.518, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87431
2022-05-09 21:06:20 - progress_bar.py[line:272] - INFO: epoch 003:   6819 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=378.8, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884495, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.67, expert1_balance_bottom=19.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.1, ups=0.58, wpb=378.8, bsz=32, num_updates=42180, lr=5.57111e-06, gnorm=3.907, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87448
2022-05-09 21:06:37 - progress_bar.py[line:272] - INFO: epoch 003:   6829 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=388.1, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890041, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.424, expert1_balance_bottom=19.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=221.9, ups=0.57, wpb=388.1, bsz=32, num_updates=42190, lr=5.5699e-06, gnorm=3.841, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87466
2022-05-09 21:06:55 - progress_bar.py[line:272] - INFO: epoch 003:   6839 / 17711 loss=3.032, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=383.8, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=35.342, expert1_balance_bottom=19.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=214, ups=0.56, wpb=383.8, bsz=32, num_updates=42200, lr=5.5687e-06, gnorm=3.922, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87483
2022-05-09 21:07:13 - progress_bar.py[line:272] - INFO: epoch 003:   6849 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=378.5, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894161, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.391, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220, ups=0.58, wpb=378.5, bsz=32, num_updates=42210, lr=5.5675e-06, gnorm=3.589, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87501
2022-05-09 21:07:30 - progress_bar.py[line:272] - INFO: epoch 003:   6859 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=382.7, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889618, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=34.324, expert1_balance_bottom=19.645, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=223.3, ups=0.58, wpb=382.7, bsz=32, num_updates=42220, lr=5.5663e-06, gnorm=3.443, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87518
2022-05-09 21:07:47 - progress_bar.py[line:272] - INFO: epoch 003:   6869 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=380.6, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889693, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.353, expert1_balance_bottom=19.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=222.2, ups=0.58, wpb=380.6, bsz=32, num_updates=42230, lr=5.5651e-06, gnorm=3.395, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87535
2022-05-09 21:08:04 - progress_bar.py[line:272] - INFO: epoch 003:   6879 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=373.6, nsentences=32, sample_size=297, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88809, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.507, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.1, ups=0.59, wpb=373.6, bsz=32, num_updates=42240, lr=5.5639e-06, gnorm=3.548, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87552
2022-05-09 21:08:21 - progress_bar.py[line:272] - INFO: epoch 003:   6889 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=372.5, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.910171, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.114, expert1_balance_top=33.034, expert1_balance_bottom=20.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.1, ups=0.59, wpb=372.5, bsz=32, num_updates=42250, lr=5.5627e-06, gnorm=3.782, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87569
2022-05-09 21:08:38 - progress_bar.py[line:272] - INFO: epoch 003:   6899 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=381.3, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.758, expert1_balance_bottom=19.168, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.6, ups=0.58, wpb=381.3, bsz=32, num_updates=42260, lr=5.5615e-06, gnorm=3.491, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87586
2022-05-09 21:08:55 - progress_bar.py[line:272] - INFO: epoch 003:   6909 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=376.4, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=34.015, expert1_balance_bottom=19.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.5, ups=0.59, wpb=376.4, bsz=32, num_updates=42270, lr=5.56029e-06, gnorm=3.788, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87603
2022-05-09 21:09:12 - progress_bar.py[line:272] - INFO: epoch 003:   6919 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.809, ntokens=375, nsentences=32, sample_size=298.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891027, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.871, expert1_balance_bottom=19.612, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=217.6, ups=0.58, wpb=375, bsz=32, num_updates=42280, lr=5.55909e-06, gnorm=3.699, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87620
2022-05-09 21:09:29 - progress_bar.py[line:272] - INFO: epoch 003:   6929 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=387.1, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885119, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.183, expert1_balance_bottom=19.582, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=227.2, ups=0.59, wpb=387.1, bsz=32, num_updates=42290, lr=5.55789e-06, gnorm=3.685, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87637
2022-05-09 21:09:47 - progress_bar.py[line:272] - INFO: epoch 003:   6939 / 17711 loss=2.939, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884447, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.939, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.37, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=224.3, ups=0.58, wpb=386.8, bsz=32, num_updates=42300, lr=5.55669e-06, gnorm=3.413, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87655
2022-05-09 21:10:04 - progress_bar.py[line:272] - INFO: epoch 003:   6949 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=383.1, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889295, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.33, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.6, ups=0.57, wpb=383.1, bsz=32, num_updates=42310, lr=5.55549e-06, gnorm=3.684, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87672
2022-05-09 21:10:21 - progress_bar.py[line:272] - INFO: epoch 003:   6959 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=376.7, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893485, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.798, expert1_balance_bottom=19.559, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.3, ups=0.58, wpb=376.7, bsz=32, num_updates=42320, lr=5.55429e-06, gnorm=3.915, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87689
2022-05-09 21:10:38 - progress_bar.py[line:272] - INFO: epoch 003:   6969 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=383.6, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879451, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.593, expert1_balance_bottom=19.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=223.3, ups=0.58, wpb=383.6, bsz=32, num_updates=42330, lr=5.55309e-06, gnorm=3.463, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87707
2022-05-09 21:10:55 - progress_bar.py[line:272] - INFO: epoch 003:   6979 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897361, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.561, expert1_balance_bottom=19.59, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=223.1, ups=0.59, wpb=378.5, bsz=32, num_updates=42340, lr=5.55188e-06, gnorm=3.609, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87723
2022-05-09 21:11:12 - progress_bar.py[line:272] - INFO: epoch 003:   6989 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=381.9, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882226, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.173, expert1_balance_bottom=19.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=224, ups=0.59, wpb=381.9, bsz=32, num_updates=42350, lr=5.55068e-06, gnorm=4.275, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87741
2022-05-09 21:11:30 - progress_bar.py[line:272] - INFO: epoch 003:   6999 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=386, nsentences=32, sample_size=307.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.727, expert1_balance_bottom=19.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.2, ups=0.58, wpb=386, bsz=32, num_updates=42360, lr=5.54948e-06, gnorm=3.879, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87758
2022-05-09 21:11:47 - progress_bar.py[line:272] - INFO: epoch 003:   7009 / 17711 loss=3.06, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=378.8, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881744, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.614, expert1_balance_bottom=19.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=222.1, ups=0.59, wpb=378.8, bsz=32, num_updates=42370, lr=5.54828e-06, gnorm=4.001, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87775
2022-05-09 21:12:04 - progress_bar.py[line:272] - INFO: epoch 003:   7019 / 17711 loss=2.941, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=377.4, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889334, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.941, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.155, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=219.6, ups=0.58, wpb=377.4, bsz=32, num_updates=42380, lr=5.54708e-06, gnorm=3.72, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87792
2022-05-09 21:12:21 - progress_bar.py[line:272] - INFO: epoch 003:   7029 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876455, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.24, expert1_balance_bottom=18.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.8, ups=0.58, wpb=381, bsz=32, num_updates=42390, lr=5.54588e-06, gnorm=3.674, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87809
2022-05-09 21:12:38 - progress_bar.py[line:272] - INFO: epoch 003:   7039 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=374.6, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.256, expert1_balance_bottom=19.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=220.6, ups=0.59, wpb=374.6, bsz=32, num_updates=42400, lr=5.54468e-06, gnorm=3.467, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87826
2022-05-09 21:12:56 - progress_bar.py[line:272] - INFO: epoch 003:   7049 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=384, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.067, expert1_balance_bottom=19.492, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=222.6, ups=0.58, wpb=384, bsz=32, num_updates=42410, lr=5.54348e-06, gnorm=3.818, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87844
2022-05-09 21:13:13 - progress_bar.py[line:272] - INFO: epoch 003:   7059 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888098, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.343, expert1_balance_bottom=19.319, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.4, ups=0.57, wpb=380.5, bsz=32, num_updates=42420, lr=5.54227e-06, gnorm=3.67, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87861
2022-05-09 21:13:31 - progress_bar.py[line:272] - INFO: epoch 003:   7069 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=389.9, nsentences=32, sample_size=310.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874264, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=34.964, expert1_balance_bottom=19.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=223.6, ups=0.57, wpb=389.9, bsz=32, num_updates=42430, lr=5.54107e-06, gnorm=4.388, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87879
2022-05-09 21:13:48 - progress_bar.py[line:272] - INFO: epoch 003:   7079 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=384.2, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.108, expert1_balance_top=33.02, expert1_balance_bottom=19.796, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=221.9, ups=0.58, wpb=384.2, bsz=32, num_updates=42440, lr=5.53987e-06, gnorm=3.736, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87896
2022-05-09 21:14:05 - progress_bar.py[line:272] - INFO: epoch 003:   7089 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=387.7, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=35.672, expert1_balance_bottom=18.917, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.4, ups=0.57, wpb=387.7, bsz=32, num_updates=42450, lr=5.53867e-06, gnorm=3.909, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87913
2022-05-09 21:14:23 - progress_bar.py[line:272] - INFO: epoch 003:   7099 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=384.3, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888628, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.073, expert1_balance_bottom=19.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213.4, ups=0.56, wpb=384.3, bsz=32, num_updates=42460, lr=5.53747e-06, gnorm=3.324, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87931
2022-05-09 21:14:41 - progress_bar.py[line:272] - INFO: epoch 003:   7109 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=391.3, nsentences=32, sample_size=311.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878217, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=34.809, expert1_balance_bottom=19.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.7, ups=0.56, wpb=391.3, bsz=32, num_updates=42470, lr=5.53627e-06, gnorm=3.432, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87949
2022-05-09 21:14:59 - progress_bar.py[line:272] - INFO: epoch 003:   7119 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=397, nsentences=32, sample_size=316.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877867, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.856, expert1_balance_bottom=19.338, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=225.6, ups=0.57, wpb=397, bsz=32, num_updates=42480, lr=5.53507e-06, gnorm=3.47, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87967
2022-05-09 21:15:16 - progress_bar.py[line:272] - INFO: epoch 003:   7129 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=388.6, nsentences=32, sample_size=309.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889255, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=33.775, expert1_balance_bottom=19.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223.3, ups=0.57, wpb=388.6, bsz=32, num_updates=42490, lr=5.53387e-06, gnorm=3.799, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=87984
2022-05-09 21:15:34 - progress_bar.py[line:272] - INFO: epoch 003:   7139 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=388.2, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.691, expert1_balance_bottom=19.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.1, ups=0.57, wpb=388.2, bsz=32, num_updates=42500, lr=5.53266e-06, gnorm=3.237, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88002
2022-05-09 21:15:51 - progress_bar.py[line:272] - INFO: epoch 003:   7149 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.551, expert1_balance_bottom=19.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.1, ups=0.57, wpb=380.8, bsz=32, num_updates=42510, lr=5.53146e-06, gnorm=3.206, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88019
2022-05-09 21:16:09 - progress_bar.py[line:272] - INFO: epoch 003:   7159 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=380.8, nsentences=32, sample_size=303, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87521, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=35.198, expert1_balance_bottom=19.202, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220.5, ups=0.58, wpb=380.8, bsz=32, num_updates=42520, lr=5.53026e-06, gnorm=3.647, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88037
2022-05-09 21:16:26 - progress_bar.py[line:272] - INFO: epoch 003:   7169 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882262, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=35.087, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=219.9, ups=0.57, wpb=382.4, bsz=32, num_updates=42530, lr=5.52906e-06, gnorm=3.271, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88054
2022-05-09 21:16:44 - progress_bar.py[line:272] - INFO: epoch 003:   7179 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=382.2, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=34.906, expert1_balance_bottom=19.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217.1, ups=0.57, wpb=382.2, bsz=32, num_updates=42540, lr=5.52786e-06, gnorm=3.24, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88072
2022-05-09 21:17:01 - progress_bar.py[line:272] - INFO: epoch 003:   7189 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=380.1, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878379, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.985, expert1_balance_bottom=19.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=217.8, ups=0.57, wpb=380.1, bsz=32, num_updates=42550, lr=5.52666e-06, gnorm=3.807, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88089
2022-05-09 21:17:19 - progress_bar.py[line:272] - INFO: epoch 003:   7199 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=380.7, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883267, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.713, expert1_balance_bottom=19.284, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=216.9, ups=0.57, wpb=380.7, bsz=32, num_updates=42560, lr=5.52546e-06, gnorm=3.978, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88107
2022-05-09 21:17:36 - progress_bar.py[line:272] - INFO: epoch 003:   7209 / 17711 loss=3.016, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=374.8, nsentences=32, sample_size=298.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89339, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.016, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.569, expert1_balance_bottom=19.753, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=215.8, ups=0.58, wpb=374.8, bsz=32, num_updates=42570, lr=5.52425e-06, gnorm=3.523, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88124
2022-05-09 21:17:54 - progress_bar.py[line:272] - INFO: epoch 003:   7219 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=384, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.612, expert1_balance_bottom=19.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.2, ups=0.57, wpb=384, bsz=32, num_updates=42580, lr=5.52305e-06, gnorm=3.518, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88142
2022-05-09 21:18:11 - progress_bar.py[line:272] - INFO: epoch 003:   7229 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=382.4, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.069, expert1_balance_bottom=19.105, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.5, ups=0.58, wpb=382.4, bsz=32, num_updates=42590, lr=5.52185e-06, gnorm=4.014, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88159
2022-05-09 21:18:28 - progress_bar.py[line:272] - INFO: epoch 003:   7239 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=376.1, nsentences=32, sample_size=299.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895956, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.914, expert1_balance_bottom=19.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=217.5, ups=0.58, wpb=376.1, bsz=32, num_updates=42600, lr=5.52065e-06, gnorm=3.36, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88176
2022-05-09 21:18:46 - progress_bar.py[line:272] - INFO: epoch 003:   7249 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=379.4, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884725, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.663, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=218.7, ups=0.58, wpb=379.4, bsz=32, num_updates=42610, lr=5.51945e-06, gnorm=4.208, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88194
2022-05-09 21:19:03 - progress_bar.py[line:272] - INFO: epoch 003:   7259 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882351, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.673, expert1_balance_bottom=19.274, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.8, ups=0.59, wpb=382.6, bsz=32, num_updates=42620, lr=5.51825e-06, gnorm=4.015, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88211
2022-05-09 21:19:20 - progress_bar.py[line:272] - INFO: epoch 003:   7269 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=378.2, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895691, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.586, expert1_balance_bottom=19.742, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=220.3, ups=0.58, wpb=378.2, bsz=32, num_updates=42630, lr=5.51705e-06, gnorm=3.658, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88228
2022-05-09 21:19:38 - progress_bar.py[line:272] - INFO: epoch 003:   7279 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=378.5, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892256, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=33.936, expert1_balance_bottom=19.626, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=212.5, ups=0.56, wpb=378.5, bsz=32, num_updates=42640, lr=5.51585e-06, gnorm=3.919, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88246
2022-05-09 21:19:55 - progress_bar.py[line:272] - INFO: epoch 003:   7289 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=378.7, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883383, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.641, expert1_balance_bottom=19.279, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.3, ups=0.58, wpb=378.7, bsz=32, num_updates=42650, lr=5.51464e-06, gnorm=3.708, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88263
2022-05-09 21:20:12 - progress_bar.py[line:272] - INFO: epoch 003:   7299 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=386.8, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889433, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.17, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=224.4, ups=0.58, wpb=386.8, bsz=32, num_updates=42660, lr=5.51344e-06, gnorm=3.408, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88280
2022-05-09 21:20:30 - progress_bar.py[line:272] - INFO: epoch 003:   7309 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=377.1, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884114, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.717, expert1_balance_bottom=19.166, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214.2, ups=0.57, wpb=377.1, bsz=32, num_updates=42670, lr=5.51224e-06, gnorm=3.12, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88298
2022-05-09 21:20:47 - progress_bar.py[line:272] - INFO: epoch 003:   7319 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879176, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=35.335, expert1_balance_bottom=19.094, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.8, ups=0.58, wpb=380.5, bsz=32, num_updates=42680, lr=5.51104e-06, gnorm=3.495, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88315
2022-05-09 21:21:04 - progress_bar.py[line:272] - INFO: epoch 003:   7329 / 17711 loss=2.974, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=375.5, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89131, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.974, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.31, expert1_balance_bottom=19.538, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.2, ups=0.59, wpb=375.5, bsz=32, num_updates=42690, lr=5.50984e-06, gnorm=3.67, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88332
2022-05-09 21:21:21 - progress_bar.py[line:272] - INFO: epoch 003:   7339 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=382.1, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884248, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.566, expert1_balance_bottom=19.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=223.8, ups=0.59, wpb=382.1, bsz=32, num_updates=42700, lr=5.50864e-06, gnorm=3.682, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88349
2022-05-09 21:21:39 - progress_bar.py[line:272] - INFO: epoch 003:   7349 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=384.6, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.824, expert1_balance_bottom=19.181, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=219.7, ups=0.57, wpb=384.6, bsz=32, num_updates=42710, lr=5.50744e-06, gnorm=3.509, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88367
2022-05-09 21:21:56 - progress_bar.py[line:272] - INFO: epoch 003:   7359 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=380.5, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888149, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.433, expert1_balance_bottom=19.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.5, ups=0.57, wpb=380.5, bsz=32, num_updates=42720, lr=5.50623e-06, gnorm=3.628, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88384
2022-05-09 21:22:13 - progress_bar.py[line:272] - INFO: epoch 003:   7369 / 17711 loss=3.073, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=378.6, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895508, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.073, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.529, expert1_balance_bottom=19.738, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=219.4, ups=0.58, wpb=378.6, bsz=32, num_updates=42730, lr=5.50503e-06, gnorm=3.468, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88402
2022-05-09 21:22:31 - progress_bar.py[line:272] - INFO: epoch 003:   7379 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=387.9, nsentences=32, sample_size=308.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88649, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.071, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222.9, ups=0.57, wpb=387.9, bsz=32, num_updates=42740, lr=5.50383e-06, gnorm=3.257, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88419
2022-05-09 21:22:48 - progress_bar.py[line:272] - INFO: epoch 003:   7389 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=387.2, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888826, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.093, expert1_balance_bottom=19.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224, ups=0.58, wpb=387.2, bsz=32, num_updates=42750, lr=5.50263e-06, gnorm=3.342, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88436
2022-05-09 21:23:05 - progress_bar.py[line:272] - INFO: epoch 003:   7399 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=378.5, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87751, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.696, expert1_balance_bottom=19.308, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=221.1, ups=0.58, wpb=378.5, bsz=32, num_updates=42760, lr=5.50143e-06, gnorm=3.482, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88453
2022-05-09 21:23:22 - progress_bar.py[line:272] - INFO: epoch 003:   7409 / 17711 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=373.6, nsentences=32, sample_size=297.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887441, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=33.811, expert1_balance_bottom=19.599, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=217.4, ups=0.58, wpb=373.6, bsz=32, num_updates=42770, lr=5.50023e-06, gnorm=3.504, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88471
2022-05-09 21:23:40 - progress_bar.py[line:272] - INFO: epoch 003:   7419 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875257, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.517, expert1_balance_bottom=19.377, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=221.5, ups=0.58, wpb=382.4, bsz=32, num_updates=42780, lr=5.49903e-06, gnorm=3.433, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88488
2022-05-09 21:23:57 - progress_bar.py[line:272] - INFO: epoch 003:   7429 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=382.4, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887606, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.264, expert1_balance_bottom=19.455, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=220.6, ups=0.58, wpb=382.4, bsz=32, num_updates=42790, lr=5.49783e-06, gnorm=3.558, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88505
2022-05-09 21:24:14 - progress_bar.py[line:272] - INFO: epoch 003:   7439 / 17711 loss=3.028, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=383.2, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.028, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.901, expert1_balance_bottom=19.578, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=221.4, ups=0.58, wpb=383.2, bsz=32, num_updates=42800, lr=5.49662e-06, gnorm=3.596, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88522
2022-05-09 21:24:32 - progress_bar.py[line:272] - INFO: epoch 003:   7449 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=389.1, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87985, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.644, expert1_balance_bottom=19.355, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221, ups=0.57, wpb=389.1, bsz=32, num_updates=42810, lr=5.49542e-06, gnorm=3.796, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88540
2022-05-09 21:24:49 - progress_bar.py[line:272] - INFO: epoch 003:   7459 / 17711 loss=3.102, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=387.6, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877783, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.102, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.562, expert1_balance_bottom=19.39, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=222.2, ups=0.57, wpb=387.6, bsz=32, num_updates=42820, lr=5.49422e-06, gnorm=3.561, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88557
2022-05-09 21:25:07 - progress_bar.py[line:272] - INFO: epoch 003:   7469 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=383.2, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885122, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.569, expert1_balance_bottom=19.32, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=220.8, ups=0.58, wpb=383.2, bsz=32, num_updates=42830, lr=5.49302e-06, gnorm=3.09, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88575
2022-05-09 21:25:24 - progress_bar.py[line:272] - INFO: epoch 003:   7479 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=383.6, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89581, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.384, expert1_balance_bottom=19.808, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=224.4, ups=0.59, wpb=383.6, bsz=32, num_updates=42840, lr=5.49182e-06, gnorm=3.986, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88592
2022-05-09 21:25:41 - progress_bar.py[line:272] - INFO: epoch 003:   7489 / 17711 loss=2.927, loss_v1=0, loss_v2=0, nll_loss=0.716, ntokens=382, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879104, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.927, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.076, expert1_balance_bottom=19.307, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=222.8, ups=0.58, wpb=382, bsz=32, num_updates=42850, lr=5.49062e-06, gnorm=3.467, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88609
2022-05-09 21:25:58 - progress_bar.py[line:272] - INFO: epoch 003:   7499 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=380.8, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=34.667, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.6, ups=0.58, wpb=380.8, bsz=32, num_updates=42860, lr=5.48942e-06, gnorm=3.564, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88626
2022-05-09 21:26:16 - progress_bar.py[line:272] - INFO: epoch 003:   7509 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=380.6, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892414, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.694, expert1_balance_bottom=19.591, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219.2, ups=0.58, wpb=380.6, bsz=32, num_updates=42870, lr=5.48822e-06, gnorm=3.465, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88644
2022-05-09 21:26:33 - progress_bar.py[line:272] - INFO: epoch 003:   7519 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=380.5, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879555, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.764, expert1_balance_bottom=19.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.2, ups=0.58, wpb=380.5, bsz=32, num_updates=42880, lr=5.48701e-06, gnorm=3.468, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88661
2022-05-09 21:26:50 - progress_bar.py[line:272] - INFO: epoch 003:   7529 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=375.3, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893192, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.75, expert1_balance_bottom=19.632, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.9, ups=0.58, wpb=375.3, bsz=32, num_updates=42890, lr=5.48581e-06, gnorm=3.273, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88678
2022-05-09 21:27:08 - progress_bar.py[line:272] - INFO: epoch 003:   7539 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=374.3, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892829, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=33.902, expert1_balance_bottom=19.461, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=209.2, ups=0.56, wpb=374.3, bsz=32, num_updates=42900, lr=5.48461e-06, gnorm=3.419, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88696
2022-05-09 21:27:21 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 21:27:28 - progress_bar.py[line:272] - INFO: epoch 003:   7550 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=378.5, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888263, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.477, expert1_balance_bottom=19.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=196.3, ups=0.52, wpb=378.5, bsz=32, num_updates=42910, lr=5.48341e-06, gnorm=3.879, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88716
2022-05-09 21:27:45 - progress_bar.py[line:272] - INFO: epoch 003:   7560 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=385.9, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.804, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219, ups=0.57, wpb=385.9, bsz=32, num_updates=42920, lr=5.48221e-06, gnorm=3.529, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88733
2022-05-09 21:28:03 - progress_bar.py[line:272] - INFO: epoch 003:   7570 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=384.9, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891221, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.017, expert1_balance_bottom=19.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=218.8, ups=0.57, wpb=384.9, bsz=32, num_updates=42930, lr=5.48101e-06, gnorm=3.046, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88751
2022-05-09 21:28:21 - progress_bar.py[line:272] - INFO: epoch 003:   7580 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=382.3, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.254, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=213.3, ups=0.56, wpb=382.3, bsz=32, num_updates=42940, lr=5.47981e-06, gnorm=3.812, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88769
2022-05-09 21:28:38 - progress_bar.py[line:272] - INFO: epoch 003:   7590 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883046, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.549, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220, ups=0.58, wpb=380.5, bsz=32, num_updates=42950, lr=5.4786e-06, gnorm=3.647, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88786
2022-05-09 21:28:55 - progress_bar.py[line:272] - INFO: epoch 003:   7600 / 17711 loss=3.076, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=376.8, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885067, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.076, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.298, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=220.4, ups=0.59, wpb=376.8, bsz=32, num_updates=42960, lr=5.4774e-06, gnorm=3.752, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88803
2022-05-09 21:29:13 - progress_bar.py[line:272] - INFO: epoch 003:   7610 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=381, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879979, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=35.2, expert1_balance_bottom=19.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.4, ups=0.56, wpb=381, bsz=32, num_updates=42970, lr=5.4762e-06, gnorm=3.436, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88821
2022-05-09 21:29:30 - progress_bar.py[line:272] - INFO: epoch 003:   7620 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=379.3, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89057, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.156, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.4, ups=0.57, wpb=379.3, bsz=32, num_updates=42980, lr=5.475e-06, gnorm=3.393, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88839
2022-05-09 21:29:48 - progress_bar.py[line:272] - INFO: epoch 003:   7630 / 17711 loss=3.014, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=375.6, nsentences=32, sample_size=298.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89276, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=34.089, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211, ups=0.56, wpb=375.6, bsz=32, num_updates=42990, lr=5.4738e-06, gnorm=3.471, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88856
2022-05-09 21:30:06 - progress_bar.py[line:272] - INFO: epoch 003:   7640 / 17711 loss=2.944, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=387.6, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.944, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.909, expert1_balance_bottom=19.351, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.1, ups=0.57, wpb=387.6, bsz=32, num_updates=43000, lr=5.4726e-06, gnorm=3.559, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88874
2022-05-09 21:30:23 - progress_bar.py[line:272] - INFO: epoch 003:   7650 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=384.3, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876241, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.232, expert1_balance_bottom=19.175, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.6, ups=0.58, wpb=384.3, bsz=32, num_updates=43010, lr=5.4714e-06, gnorm=3.249, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88891
2022-05-09 21:30:41 - progress_bar.py[line:272] - INFO: epoch 003:   7660 / 17711 loss=3.049, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=380.3, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88005, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.049, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.671, expert1_balance_bottom=19.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.1, ups=0.58, wpb=380.3, bsz=32, num_updates=43020, lr=5.4702e-06, gnorm=4.231, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88909
2022-05-09 21:30:58 - progress_bar.py[line:272] - INFO: epoch 003:   7670 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=379.3, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885857, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.3, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=217.3, ups=0.57, wpb=379.3, bsz=32, num_updates=43030, lr=5.46899e-06, gnorm=3.332, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88926
2022-05-09 21:31:16 - progress_bar.py[line:272] - INFO: epoch 003:   7680 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=383.8, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87732, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=35.152, expert1_balance_bottom=19.234, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.5, ups=0.56, wpb=383.8, bsz=32, num_updates=43040, lr=5.46779e-06, gnorm=3.65, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88944
2022-05-09 21:31:33 - progress_bar.py[line:272] - INFO: epoch 003:   7690 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=382, nsentences=32, sample_size=304, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882838, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.663, expert1_balance_bottom=19.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=218.6, ups=0.57, wpb=382, bsz=32, num_updates=43050, lr=5.46659e-06, gnorm=3.835, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88961
2022-05-09 21:31:51 - progress_bar.py[line:272] - INFO: epoch 003:   7700 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=377.9, nsentences=32, sample_size=300.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886604, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.547, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.4, ups=0.58, wpb=377.9, bsz=32, num_updates=43060, lr=5.46539e-06, gnorm=3.739, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88979
2022-05-09 21:32:08 - progress_bar.py[line:272] - INFO: epoch 003:   7710 / 17711 loss=3.053, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=382.7, nsentences=32, sample_size=304.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878812, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.053, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.067, expert1_balance_bottom=19.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=220.5, ups=0.58, wpb=382.7, bsz=32, num_updates=43070, lr=5.46419e-06, gnorm=3.871, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=88996
2022-05-09 21:32:25 - progress_bar.py[line:272] - INFO: epoch 003:   7720 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=376, nsentences=32, sample_size=299, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892443, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=34.432, expert1_balance_bottom=19.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=218.7, ups=0.58, wpb=376, bsz=32, num_updates=43080, lr=5.46299e-06, gnorm=4.114, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89013
2022-05-09 21:32:43 - progress_bar.py[line:272] - INFO: epoch 003:   7730 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=373.1, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879701, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.726, expert1_balance_bottom=19.416, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.4, ups=0.57, wpb=373.1, bsz=32, num_updates=43090, lr=5.46179e-06, gnorm=3.329, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89031
2022-05-09 21:33:00 - progress_bar.py[line:272] - INFO: epoch 003:   7740 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=386.4, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875287, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.424, expert1_balance_bottom=19.048, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=216.6, ups=0.56, wpb=386.4, bsz=32, num_updates=43100, lr=5.46058e-06, gnorm=3.457, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89048
2022-05-09 21:33:18 - progress_bar.py[line:272] - INFO: epoch 003:   7750 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=385.5, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87068, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=35.258, expert1_balance_bottom=19.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.6, ups=0.57, wpb=385.5, bsz=32, num_updates=43110, lr=5.45938e-06, gnorm=3.543, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89066
2022-05-09 21:33:35 - progress_bar.py[line:272] - INFO: epoch 003:   7760 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=380, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872761, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.084, expert1_balance_bottom=19.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.1, ups=0.57, wpb=380, bsz=32, num_updates=43120, lr=5.45818e-06, gnorm=4.099, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89083
2022-05-09 21:33:53 - progress_bar.py[line:272] - INFO: epoch 003:   7770 / 17711 loss=3.03, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=384.1, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.03, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.646, expert1_balance_bottom=19.514, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=222.9, ups=0.58, wpb=384.1, bsz=32, num_updates=43130, lr=5.45698e-06, gnorm=3.309, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89101
2022-05-09 21:34:10 - progress_bar.py[line:272] - INFO: epoch 003:   7780 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=380.9, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879381, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.753, expert1_balance_bottom=19.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.3, ups=0.58, wpb=380.9, bsz=32, num_updates=43140, lr=5.45578e-06, gnorm=3.601, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89118
2022-05-09 21:34:27 - progress_bar.py[line:272] - INFO: epoch 003:   7790 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=381.2, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.948, expert1_balance_bottom=19.558, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.2, ups=0.57, wpb=381.2, bsz=32, num_updates=43150, lr=5.45458e-06, gnorm=3.186, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89136
2022-05-09 21:34:45 - progress_bar.py[line:272] - INFO: epoch 003:   7800 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=380.8, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892591, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.005, expert1_balance_bottom=19.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=217.3, ups=0.57, wpb=380.8, bsz=32, num_updates=43160, lr=5.45338e-06, gnorm=3.645, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89153
2022-05-09 21:35:02 - progress_bar.py[line:272] - INFO: epoch 003:   7810 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=390.7, nsentences=32, sample_size=310.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891822, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.978, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=225, ups=0.58, wpb=390.7, bsz=32, num_updates=43170, lr=5.45218e-06, gnorm=3.493, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89170
2022-05-09 21:35:20 - progress_bar.py[line:272] - INFO: epoch 003:   7820 / 17711 loss=2.922, loss_v1=0, loss_v2=0, nll_loss=0.707, ntokens=397.5, nsentences=32, sample_size=316.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876913, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.922, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.865, expert1_balance_bottom=19.367, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.63, wps=230.9, ups=0.58, wpb=397.5, bsz=32, num_updates=43180, lr=5.45097e-06, gnorm=3.139, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89188
2022-05-09 21:35:37 - progress_bar.py[line:272] - INFO: epoch 003:   7830 / 17711 loss=3.011, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=390.4, nsentences=32, sample_size=310.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886791, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.011, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.177, expert1_balance_bottom=19.439, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=224.4, ups=0.57, wpb=390.4, bsz=32, num_updates=43190, lr=5.44977e-06, gnorm=3.769, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89205
2022-05-09 21:35:54 - progress_bar.py[line:272] - INFO: epoch 003:   7840 / 17711 loss=3.066, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=380.9, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878921, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.066, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=34.972, expert1_balance_bottom=19.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=219.6, ups=0.58, wpb=380.9, bsz=32, num_updates=43200, lr=5.44857e-06, gnorm=3.96, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89222
2022-05-09 21:36:12 - progress_bar.py[line:272] - INFO: epoch 003:   7850 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=389.2, nsentences=32, sample_size=310, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876366, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.102, expert1_balance_bottom=19.188, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220.1, ups=0.57, wpb=389.2, bsz=32, num_updates=43210, lr=5.44737e-06, gnorm=3.812, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89240
2022-05-09 21:36:29 - progress_bar.py[line:272] - INFO: epoch 003:   7860 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=394.8, nsentences=32, sample_size=313.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87156, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=35.325, expert1_balance_bottom=19.122, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=228.3, ups=0.58, wpb=394.8, bsz=32, num_updates=43220, lr=5.44617e-06, gnorm=3.495, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89257
2022-05-09 21:36:47 - progress_bar.py[line:272] - INFO: epoch 003:   7870 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.714, expert1_balance_bottom=19.413, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221.5, ups=0.58, wpb=381.7, bsz=32, num_updates=43230, lr=5.44497e-06, gnorm=3.832, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89275
2022-05-09 21:37:04 - progress_bar.py[line:272] - INFO: epoch 003:   7880 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=373.6, nsentences=32, sample_size=297.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894332, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.003, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=213, ups=0.57, wpb=373.6, bsz=32, num_updates=43240, lr=5.44377e-06, gnorm=3.424, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89292
2022-05-09 21:37:22 - progress_bar.py[line:272] - INFO: epoch 003:   7890 / 17711 loss=3.12, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=378.6, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878486, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.12, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=34.793, expert1_balance_bottom=19.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=215.4, ups=0.57, wpb=378.6, bsz=32, num_updates=43250, lr=5.44257e-06, gnorm=4.39, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89310
2022-05-09 21:37:39 - progress_bar.py[line:272] - INFO: epoch 003:   7900 / 17711 loss=3.001, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=377, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893296, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.081, expert1_balance_bottom=19.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220.9, ups=0.59, wpb=377, bsz=32, num_updates=43260, lr=5.44136e-06, gnorm=3.574, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89327
2022-05-09 21:37:56 - progress_bar.py[line:272] - INFO: epoch 003:   7910 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=392.3, nsentences=32, sample_size=312.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884194, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.617, expert1_balance_bottom=19.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=225.4, ups=0.57, wpb=392.3, bsz=32, num_updates=43270, lr=5.44016e-06, gnorm=3.148, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89344
2022-05-09 21:38:13 - progress_bar.py[line:272] - INFO: epoch 003:   7920 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898856, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.693, expert1_balance_bottom=19.646, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223, ups=0.59, wpb=380, bsz=32, num_updates=43280, lr=5.43896e-06, gnorm=3.395, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89361
2022-05-09 21:38:31 - progress_bar.py[line:272] - INFO: epoch 003:   7930 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=390.1, nsentences=32, sample_size=310.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886671, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.176, expert1_balance_bottom=19.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=220.8, ups=0.57, wpb=390.1, bsz=32, num_updates=43290, lr=5.43776e-06, gnorm=3.663, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89379
2022-05-09 21:38:49 - progress_bar.py[line:272] - INFO: epoch 003:   7940 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=379.8, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888869, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.163, expert1_balance_bottom=19.592, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=213.8, ups=0.56, wpb=379.8, bsz=32, num_updates=43300, lr=5.43656e-06, gnorm=3.165, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89397
2022-05-09 21:39:06 - progress_bar.py[line:272] - INFO: epoch 003:   7950 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=384.9, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879902, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=35.025, expert1_balance_bottom=19.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.8, ups=0.57, wpb=384.9, bsz=32, num_updates=43310, lr=5.43536e-06, gnorm=3.434, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89414
2022-05-09 21:39:24 - progress_bar.py[line:272] - INFO: epoch 003:   7960 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=378, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879556, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.074, expert1_balance_bottom=19.361, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=214.9, ups=0.57, wpb=378, bsz=32, num_updates=43320, lr=5.43416e-06, gnorm=3.225, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89432
2022-05-09 21:39:41 - progress_bar.py[line:272] - INFO: epoch 003:   7970 / 17711 loss=3.043, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=385.9, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874575, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.043, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=35.187, expert1_balance_bottom=19.264, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.2, ups=0.56, wpb=385.9, bsz=32, num_updates=43330, lr=5.43295e-06, gnorm=3.861, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89450
2022-05-09 21:39:59 - progress_bar.py[line:272] - INFO: epoch 003:   7980 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=387.7, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879131, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.994, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=225.6, ups=0.58, wpb=387.7, bsz=32, num_updates=43340, lr=5.43175e-06, gnorm=3.221, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89467
2022-05-09 21:40:16 - progress_bar.py[line:272] - INFO: epoch 003:   7990 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878866, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.793, expert1_balance_bottom=19.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=221, ups=0.58, wpb=380.8, bsz=32, num_updates=43350, lr=5.43055e-06, gnorm=3.443, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89484
2022-05-09 21:40:33 - progress_bar.py[line:272] - INFO: epoch 003:   8000 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=391.6, nsentences=32, sample_size=311.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=34.598, expert1_balance_bottom=19.298, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=227.3, ups=0.58, wpb=391.6, bsz=32, num_updates=43360, lr=5.42935e-06, gnorm=3.459, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89501
2022-05-09 21:40:50 - progress_bar.py[line:272] - INFO: epoch 003:   8010 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=383.6, nsentences=32, sample_size=305, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870415, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.091, expert1_balance_top=35.193, expert1_balance_bottom=19.183, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.2, ups=0.58, wpb=383.6, bsz=32, num_updates=43370, lr=5.42815e-06, gnorm=3.615, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89518
2022-05-09 21:41:08 - progress_bar.py[line:272] - INFO: epoch 003:   8020 / 17711 loss=2.978, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=380.4, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880401, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.978, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.641, expert1_balance_bottom=19.476, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=219.9, ups=0.58, wpb=380.4, bsz=32, num_updates=43380, lr=5.42695e-06, gnorm=3.372, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89536
2022-05-09 21:41:25 - progress_bar.py[line:272] - INFO: epoch 003:   8030 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=386.5, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874621, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=35.357, expert1_balance_bottom=19.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=226.2, ups=0.59, wpb=386.5, bsz=32, num_updates=43390, lr=5.42575e-06, gnorm=3.89, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89553
2022-05-09 21:41:42 - progress_bar.py[line:272] - INFO: epoch 003:   8040 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=379.1, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891159, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.307, expert1_balance_bottom=19.399, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.9, ups=0.58, wpb=379.1, bsz=32, num_updates=43400, lr=5.42455e-06, gnorm=3.872, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89570
2022-05-09 21:42:00 - progress_bar.py[line:272] - INFO: epoch 003:   8050 / 17711 loss=3.051, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=387, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.870587, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.051, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.091, expert1_balance_top=35.173, expert1_balance_bottom=19.003, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=222.9, ups=0.58, wpb=387, bsz=32, num_updates=43410, lr=5.42334e-06, gnorm=3.608, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89588
2022-05-09 21:42:17 - progress_bar.py[line:272] - INFO: epoch 003:   8060 / 17711 loss=3.086, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=384.3, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885893, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.086, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.527, expert1_balance_bottom=19.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=222.3, ups=0.58, wpb=384.3, bsz=32, num_updates=43420, lr=5.42214e-06, gnorm=3.695, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89605
2022-05-09 21:42:34 - progress_bar.py[line:272] - INFO: epoch 003:   8070 / 17711 loss=2.942, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=390.8, nsentences=32, sample_size=311.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874923, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.942, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=35.287, expert1_balance_bottom=19.217, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=226.5, ups=0.58, wpb=390.8, bsz=32, num_updates=43430, lr=5.42094e-06, gnorm=3.218, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89622
2022-05-09 21:42:51 - progress_bar.py[line:272] - INFO: epoch 003:   8080 / 17711 loss=2.97, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=378.4, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889134, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.97, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.438, expert1_balance_bottom=19.454, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=217.2, ups=0.57, wpb=378.4, bsz=32, num_updates=43440, lr=5.41974e-06, gnorm=3.371, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89640
2022-05-09 21:43:09 - progress_bar.py[line:272] - INFO: epoch 003:   8090 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=378.6, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883815, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.563, expert1_balance_bottom=19.369, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.6, ups=0.58, wpb=378.6, bsz=32, num_updates=43450, lr=5.41854e-06, gnorm=3.805, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89657
2022-05-09 21:43:26 - progress_bar.py[line:272] - INFO: epoch 003:   8100 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=386.1, nsentences=32, sample_size=307.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879189, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=34.983, expert1_balance_bottom=19.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=220.6, ups=0.57, wpb=386.1, bsz=32, num_updates=43460, lr=5.41734e-06, gnorm=3.63, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89674
2022-05-09 21:43:44 - progress_bar.py[line:272] - INFO: epoch 003:   8110 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=382.6, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894128, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.278, expert1_balance_bottom=19.425, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=219.5, ups=0.57, wpb=382.6, bsz=32, num_updates=43470, lr=5.41614e-06, gnorm=3.409, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89692
2022-05-09 21:44:02 - progress_bar.py[line:272] - INFO: epoch 003:   8120 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=379.4, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887068, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.76, expert1_balance_bottom=19.179, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=211.3, ups=0.56, wpb=379.4, bsz=32, num_updates=43480, lr=5.41493e-06, gnorm=3.138, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89710
2022-05-09 21:44:19 - progress_bar.py[line:272] - INFO: epoch 003:   8130 / 17711 loss=2.936, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=382.4, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875259, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.936, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.106, expert1_balance_bottom=19.287, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=219.6, ups=0.57, wpb=382.4, bsz=32, num_updates=43490, lr=5.41373e-06, gnorm=3.765, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89727
2022-05-09 21:44:37 - progress_bar.py[line:272] - INFO: epoch 003:   8140 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=383.4, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882184, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.684, expert1_balance_bottom=19.251, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=214.4, ups=0.56, wpb=383.4, bsz=32, num_updates=43500, lr=5.41253e-06, gnorm=3.33, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89745
2022-05-09 21:44:54 - progress_bar.py[line:272] - INFO: epoch 003:   8150 / 17711 loss=3.012, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=381.6, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.058, expert1_balance_bottom=19.411, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217.7, ups=0.57, wpb=381.6, bsz=32, num_updates=43510, lr=5.41133e-06, gnorm=3.916, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89762
2022-05-09 21:45:12 - progress_bar.py[line:272] - INFO: epoch 003:   8160 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=376, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902759, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.17, expert1_balance_bottom=19.838, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=216.9, ups=0.58, wpb=376, bsz=32, num_updates=43520, lr=5.41013e-06, gnorm=3.156, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89780
2022-05-09 21:45:29 - progress_bar.py[line:272] - INFO: epoch 003:   8170 / 17711 loss=2.945, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=384.2, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885409, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.945, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.744, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=218, ups=0.57, wpb=384.2, bsz=32, num_updates=43530, lr=5.40893e-06, gnorm=3.412, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89797
2022-05-09 21:45:47 - progress_bar.py[line:272] - INFO: epoch 003:   8180 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=379.2, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.897518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.768, expert1_balance_bottom=19.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.4, ups=0.57, wpb=379.2, bsz=32, num_updates=43540, lr=5.40773e-06, gnorm=3.584, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89815
2022-05-09 21:46:05 - progress_bar.py[line:272] - INFO: epoch 003:   8190 / 17711 loss=3.045, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=374.2, nsentences=32, sample_size=297.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89446, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.045, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.867, expert1_balance_bottom=19.579, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=205.6, ups=0.55, wpb=374.2, bsz=32, num_updates=43550, lr=5.40653e-06, gnorm=3.436, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89833
2022-05-09 21:46:22 - progress_bar.py[line:272] - INFO: epoch 003:   8200 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=382.7, nsentences=32, sample_size=304.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880694, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.562, expert1_balance_bottom=19.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=219.4, ups=0.57, wpb=382.7, bsz=32, num_updates=43560, lr=5.40532e-06, gnorm=3.454, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89851
2022-05-09 21:46:40 - progress_bar.py[line:272] - INFO: epoch 003:   8210 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=381, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889535, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.347, expert1_balance_bottom=19.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.7, ups=0.58, wpb=381, bsz=32, num_updates=43570, lr=5.40412e-06, gnorm=3.46, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89868
2022-05-09 21:46:58 - progress_bar.py[line:272] - INFO: epoch 003:   8220 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=379.4, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895939, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.817, expert1_balance_bottom=19.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=213.4, ups=0.56, wpb=379.4, bsz=32, num_updates=43580, lr=5.40292e-06, gnorm=3.324, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89886
2022-05-09 21:47:15 - progress_bar.py[line:272] - INFO: epoch 003:   8230 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883475, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.649, expert1_balance_bottom=19.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=217.8, ups=0.56, wpb=385.9, bsz=32, num_updates=43590, lr=5.40172e-06, gnorm=4.033, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89903
2022-05-09 21:47:33 - progress_bar.py[line:272] - INFO: epoch 003:   8240 / 17711 loss=2.966, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878014, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.966, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.884, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=221.8, ups=0.57, wpb=386.8, bsz=32, num_updates=43600, lr=5.40052e-06, gnorm=3.327, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89921
2022-05-09 21:47:50 - progress_bar.py[line:272] - INFO: epoch 003:   8250 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=384.5, nsentences=32, sample_size=306, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886523, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.343, expert1_balance_bottom=19.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=221.1, ups=0.57, wpb=384.5, bsz=32, num_updates=43610, lr=5.39932e-06, gnorm=3.395, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89938
2022-05-09 21:48:08 - progress_bar.py[line:272] - INFO: epoch 003:   8260 / 17711 loss=2.937, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=390.6, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.937, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.234, expert1_balance_bottom=19.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=221.3, ups=0.57, wpb=390.6, bsz=32, num_updates=43620, lr=5.39812e-06, gnorm=3.445, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89956
2022-05-09 21:48:25 - progress_bar.py[line:272] - INFO: epoch 003:   8270 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.322, expert1_balance_bottom=19.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.5, ups=0.57, wpb=382.5, bsz=32, num_updates=43630, lr=5.39692e-06, gnorm=3.993, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89973
2022-05-09 21:48:43 - progress_bar.py[line:272] - INFO: epoch 003:   8280 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=388.2, nsentences=32, sample_size=309, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877056, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.4, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=225.3, ups=0.58, wpb=388.2, bsz=32, num_updates=43640, lr=5.39571e-06, gnorm=3.849, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=89991
2022-05-09 21:49:00 - progress_bar.py[line:272] - INFO: epoch 003:   8290 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=387.7, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886643, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.414, expert1_balance_bottom=19.466, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=221.4, ups=0.57, wpb=387.7, bsz=32, num_updates=43650, lr=5.39451e-06, gnorm=3.747, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90008
2022-05-09 21:49:18 - progress_bar.py[line:272] - INFO: epoch 003:   8300 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893614, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.036, expert1_balance_bottom=19.445, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=214.2, ups=0.56, wpb=381.1, bsz=32, num_updates=43660, lr=5.39331e-06, gnorm=3.265, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90026
2022-05-09 21:49:35 - progress_bar.py[line:272] - INFO: epoch 003:   8310 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=375.8, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888773, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.176, expert1_balance_bottom=19.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.4, ups=0.58, wpb=375.8, bsz=32, num_updates=43670, lr=5.39211e-06, gnorm=3.692, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90043
2022-05-09 21:49:52 - progress_bar.py[line:272] - INFO: epoch 003:   8320 / 17711 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=381.1, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899527, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.956, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.593, expert1_balance_bottom=19.674, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=220.5, ups=0.58, wpb=381.1, bsz=32, num_updates=43680, lr=5.39091e-06, gnorm=3.508, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90060
2022-05-09 21:50:10 - progress_bar.py[line:272] - INFO: epoch 003:   8330 / 17711 loss=3.004, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=377.6, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881853, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.613, expert1_balance_bottom=19.245, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=218.8, ups=0.58, wpb=377.6, bsz=32, num_updates=43690, lr=5.38971e-06, gnorm=3.328, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90078
2022-05-09 21:50:27 - progress_bar.py[line:272] - INFO: epoch 003:   8340 / 17711 loss=2.942, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=389.3, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880842, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.942, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.61, expert1_balance_bottom=19.465, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=227, ups=0.58, wpb=389.3, bsz=32, num_updates=43700, lr=5.38851e-06, gnorm=2.701, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90095
2022-05-09 21:50:45 - progress_bar.py[line:272] - INFO: epoch 003:   8350 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=379.9, nsentences=32, sample_size=302.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882538, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.728, expert1_balance_bottom=19.25, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=207.5, ups=0.55, wpb=379.9, bsz=32, num_updates=43710, lr=5.3873e-06, gnorm=4.374, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90113
2022-05-09 21:51:04 - progress_bar.py[line:272] - INFO: epoch 003:   8360 / 17711 loss=3.041, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=380.1, nsentences=32, sample_size=302.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88657, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.041, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.717, expert1_balance_bottom=19.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=205.1, ups=0.54, wpb=380.1, bsz=32, num_updates=43720, lr=5.3861e-06, gnorm=3.725, loss_scale=128, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90132
2022-05-09 21:51:21 - progress_bar.py[line:272] - INFO: epoch 003:   8370 / 17711 loss=2.94, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=377.5, nsentences=32, sample_size=300.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880844, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.94, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=35.266, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=210.5, ups=0.56, wpb=377.5, bsz=32, num_updates=43730, lr=5.3849e-06, gnorm=3.12, loss_scale=128, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90150
2022-05-09 21:51:29 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-09 21:51:41 - progress_bar.py[line:272] - INFO: epoch 003:   8381 / 17711 loss=3.008, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=387.1, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879367, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.635, expert1_balance_bottom=19.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=201.4, ups=0.52, wpb=387.1, bsz=32, num_updates=43740, lr=5.3837e-06, gnorm=3.648, loss_scale=64, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90169
2022-05-09 21:51:58 - progress_bar.py[line:272] - INFO: epoch 003:   8391 / 17711 loss=2.959, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=384.8, nsentences=32, sample_size=306.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879086, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.959, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.814, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=225.4, ups=0.59, wpb=384.8, bsz=32, num_updates=43750, lr=5.3825e-06, gnorm=3.802, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90186
2022-05-09 21:52:15 - progress_bar.py[line:272] - INFO: epoch 003:   8401 / 17711 loss=2.967, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=380.3, nsentences=32, sample_size=302.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884949, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.967, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.523, expert1_balance_bottom=19.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=221.3, ups=0.58, wpb=380.3, bsz=32, num_updates=43760, lr=5.3813e-06, gnorm=3.21, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90203
2022-05-09 21:52:32 - progress_bar.py[line:272] - INFO: epoch 003:   8411 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=384.4, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875503, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.672, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=222.5, ups=0.58, wpb=384.4, bsz=32, num_updates=43770, lr=5.3801e-06, gnorm=3.576, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90220
2022-05-09 21:52:50 - progress_bar.py[line:272] - INFO: epoch 003:   8421 / 17711 loss=2.991, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=384.1, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876294, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.991, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=34.795, expert1_balance_bottom=19.33, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=218.6, ups=0.57, wpb=384.1, bsz=32, num_updates=43780, lr=5.3789e-06, gnorm=3.355, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90238
2022-05-09 21:53:07 - progress_bar.py[line:272] - INFO: epoch 003:   8431 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=380.2, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88999, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.8, expert1_balance_bottom=19.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216, ups=0.57, wpb=380.2, bsz=32, num_updates=43790, lr=5.37769e-06, gnorm=3.756, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90255
2022-05-09 21:53:25 - progress_bar.py[line:272] - INFO: epoch 003:   8441 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=380.1, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.173, expert1_balance_bottom=19.549, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=219.4, ups=0.58, wpb=380.1, bsz=32, num_updates=43800, lr=5.37649e-06, gnorm=2.929, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90273
2022-05-09 21:53:42 - progress_bar.py[line:272] - INFO: epoch 003:   8451 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=378.9, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88796, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.062, expert1_balance_bottom=19.459, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218, ups=0.58, wpb=378.9, bsz=32, num_updates=43810, lr=5.37529e-06, gnorm=3.279, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90290
2022-05-09 21:54:00 - progress_bar.py[line:272] - INFO: epoch 003:   8461 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888173, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.091, expert1_balance_bottom=19.55, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.4, ups=0.57, wpb=376.7, bsz=32, num_updates=43820, lr=5.37409e-06, gnorm=3.702, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90308
2022-05-09 21:54:17 - progress_bar.py[line:272] - INFO: epoch 003:   8471 / 17711 loss=3.082, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=386.5, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878584, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.082, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.378, expert1_balance_bottom=19.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=220, ups=0.57, wpb=386.5, bsz=32, num_updates=43830, lr=5.37289e-06, gnorm=3.706, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90325
2022-05-09 21:54:35 - progress_bar.py[line:272] - INFO: epoch 003:   8481 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893389, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.799, expert1_balance_bottom=19.679, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.3, ups=0.57, wpb=385.4, bsz=32, num_updates=43840, lr=5.37169e-06, gnorm=3.163, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90343
2022-05-09 21:54:52 - progress_bar.py[line:272] - INFO: epoch 003:   8491 / 17711 loss=2.977, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=386.6, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879848, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.977, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.672, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=222.8, ups=0.58, wpb=386.6, bsz=32, num_updates=43850, lr=5.37049e-06, gnorm=3.504, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90360
2022-05-09 21:55:09 - progress_bar.py[line:272] - INFO: epoch 003:   8501 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=387.7, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876889, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.548, expert1_balance_bottom=19.453, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=225, ups=0.58, wpb=387.7, bsz=32, num_updates=43860, lr=5.36928e-06, gnorm=4.246, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90377
2022-05-09 21:55:27 - progress_bar.py[line:272] - INFO: epoch 003:   8511 / 17711 loss=2.981, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=388.9, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.981, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=35.056, expert1_balance_bottom=19.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=223.2, ups=0.57, wpb=388.9, bsz=32, num_updates=43870, lr=5.36808e-06, gnorm=4.052, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90395
2022-05-09 21:55:30 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 21:55:46 - progress_bar.py[line:272] - INFO: epoch 003:   8522 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=386.1, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890026, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=33.975, expert1_balance_bottom=19.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=200.2, ups=0.52, wpb=386.1, bsz=32, num_updates=43880, lr=5.36688e-06, gnorm=3.674, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90414
2022-05-09 21:56:04 - progress_bar.py[line:272] - INFO: epoch 003:   8532 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=375.4, nsentences=32, sample_size=298.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=33.71, expert1_balance_bottom=19.67, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=206.8, ups=0.55, wpb=375.4, bsz=32, num_updates=43890, lr=5.36568e-06, gnorm=3.368, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90432
2022-05-09 21:56:21 - progress_bar.py[line:272] - INFO: epoch 003:   8542 / 17711 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=380.5, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888198, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.222, expert1_balance_bottom=19.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=220.1, ups=0.58, wpb=380.5, bsz=32, num_updates=43900, lr=5.36448e-06, gnorm=3.644, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90449
2022-05-09 21:56:39 - progress_bar.py[line:272] - INFO: epoch 003:   8552 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=395.2, nsentences=32, sample_size=314.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884943, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.411, expert1_balance_bottom=19.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=224.3, ups=0.57, wpb=395.2, bsz=32, num_updates=43910, lr=5.36328e-06, gnorm=3.563, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90467
2022-05-09 21:56:56 - progress_bar.py[line:272] - INFO: epoch 003:   8562 / 17711 loss=2.986, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=386.1, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878824, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.986, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.087, expert1_balance_bottom=19.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=224.7, ups=0.58, wpb=386.1, bsz=32, num_updates=43920, lr=5.36208e-06, gnorm=4.596, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90484
2022-05-09 21:57:14 - progress_bar.py[line:272] - INFO: epoch 003:   8572 / 17711 loss=3.036, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=386.3, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878457, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.718, expert1_balance_bottom=19.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=222, ups=0.57, wpb=386.3, bsz=32, num_updates=43930, lr=5.36088e-06, gnorm=4.638, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90502
2022-05-09 21:57:31 - progress_bar.py[line:272] - INFO: epoch 003:   8582 / 17711 loss=3.029, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876642, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.029, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.077, expert1_balance_bottom=19.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=223.3, ups=0.58, wpb=385.6, bsz=32, num_updates=43940, lr=5.35967e-06, gnorm=3.474, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90519
2022-05-09 21:57:49 - progress_bar.py[line:272] - INFO: epoch 003:   8592 / 17711 loss=3.033, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=381.5, nsentences=32, sample_size=304.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893653, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.033, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.439, expert1_balance_bottom=19.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=212.2, ups=0.56, wpb=381.5, bsz=32, num_updates=43950, lr=5.35847e-06, gnorm=3.95, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90537
2022-05-09 21:58:06 - progress_bar.py[line:272] - INFO: epoch 003:   8602 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=388.4, nsentences=32, sample_size=309.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880735, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.512, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=222.2, ups=0.57, wpb=388.4, bsz=32, num_updates=43960, lr=5.35727e-06, gnorm=3.722, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90554
2022-05-09 21:58:24 - progress_bar.py[line:272] - INFO: epoch 003:   8612 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=381.4, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889921, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.96, expert1_balance_bottom=19.644, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.1, ups=0.57, wpb=381.4, bsz=32, num_updates=43970, lr=5.35607e-06, gnorm=3.312, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90572
2022-05-09 21:58:41 - progress_bar.py[line:272] - INFO: epoch 003:   8622 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=374.6, nsentences=32, sample_size=298.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88522, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.764, expert1_balance_bottom=19.282, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=218.1, ups=0.58, wpb=374.6, bsz=32, num_updates=43980, lr=5.35487e-06, gnorm=3.691, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90589
2022-05-09 21:58:59 - progress_bar.py[line:272] - INFO: epoch 003:   8632 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=387.3, nsentences=32, sample_size=308.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88851, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.57, expert1_balance_bottom=19.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=220.9, ups=0.57, wpb=387.3, bsz=32, num_updates=43990, lr=5.35367e-06, gnorm=4.159, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90607
2022-05-09 21:59:16 - progress_bar.py[line:272] - INFO: epoch 003:   8642 / 17711 loss=3.034, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=386.5, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88396, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.034, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.609, expert1_balance_bottom=19.498, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.9, ups=0.57, wpb=386.5, bsz=32, num_updates=44000, lr=5.35247e-06, gnorm=3.977, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=90624
2022-05-09 21:59:16 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 21:59:16 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 21:59:16 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 22:06:28 - train.py[line:517] - INFO: valid_step finished
2022-05-09 22:06:28 - progress_bar.py[line:282] - INFO: epoch 003 | valid on 'valid' subset | loss 10.151 | loss_v1 0 | loss_v2 0 | nll_loss 8.495 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.0092 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.151 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.16 | expert1_balance_top 40.717 | expert1_balance_bottom 15.068 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 360.69 | cider 1.21 | wps 698.2 | wpb 481.7 | bsz 8 | num_updates 44000 | best_cider 1.21
2022-05-09 22:06:46 - progress_bar.py[line:272] - INFO: epoch 003:   8652 / 17711 loss=2.983, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=386.4, nsentences=32, sample_size=307.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.983, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.074, expert1_balance_bottom=19.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=8.6, ups=0.02, wpb=386.4, bsz=32, num_updates=44010, lr=5.35126e-06, gnorm=3.521, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91074
2022-05-09 22:07:03 - progress_bar.py[line:272] - INFO: epoch 003:   8662 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=390.6, nsentences=32, sample_size=310.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886945, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.095, expert1_balance_bottom=19.659, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=224.4, ups=0.57, wpb=390.6, bsz=32, num_updates=44020, lr=5.35006e-06, gnorm=3.821, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91091
2022-05-09 22:07:21 - progress_bar.py[line:272] - INFO: epoch 003:   8672 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=385.7, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.875216, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=35.219, expert1_balance_bottom=19.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=218.8, ups=0.57, wpb=385.7, bsz=32, num_updates=44030, lr=5.34886e-06, gnorm=4.269, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91109
2022-05-09 22:07:38 - progress_bar.py[line:272] - INFO: epoch 003:   8682 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=380.3, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894907, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.213, expert1_balance_bottom=19.547, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.9, ups=0.57, wpb=380.3, bsz=32, num_updates=44040, lr=5.34766e-06, gnorm=4.225, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91126
2022-05-09 22:07:56 - progress_bar.py[line:272] - INFO: epoch 003:   8692 / 17711 loss=3.022, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=380.9, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880755, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.022, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=35.147, expert1_balance_bottom=19.164, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.8, ups=0.58, wpb=380.9, bsz=32, num_updates=44050, lr=5.34646e-06, gnorm=3.399, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91144
2022-05-09 22:08:13 - progress_bar.py[line:272] - INFO: epoch 003:   8702 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=384.8, nsentences=32, sample_size=306.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885201, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.596, expert1_balance_bottom=19.395, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=218.1, ups=0.57, wpb=384.8, bsz=32, num_updates=44060, lr=5.34526e-06, gnorm=3.669, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91161
2022-05-09 22:08:31 - progress_bar.py[line:272] - INFO: epoch 003:   8712 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=376.7, nsentences=32, sample_size=299.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873986, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=35.586, expert1_balance_bottom=19.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=217, ups=0.58, wpb=376.7, bsz=32, num_updates=44070, lr=5.34406e-06, gnorm=3.427, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91179
2022-05-09 22:08:48 - progress_bar.py[line:272] - INFO: epoch 003:   8722 / 17711 loss=2.971, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=383.4, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.971, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.486, expert1_balance_bottom=19.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=215.9, ups=0.56, wpb=383.4, bsz=32, num_updates=44080, lr=5.34286e-06, gnorm=3.759, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91196
2022-05-09 22:09:06 - progress_bar.py[line:272] - INFO: epoch 003:   8732 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889279, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.172, expert1_balance_bottom=19.57, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.4, ups=0.57, wpb=378.6, bsz=32, num_updates=44090, lr=5.34165e-06, gnorm=4.056, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91214
2022-05-09 22:09:23 - progress_bar.py[line:272] - INFO: epoch 003:   8742 / 17711 loss=2.934, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=389, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877337, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.934, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=34.882, expert1_balance_bottom=19.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=221.8, ups=0.57, wpb=389, bsz=32, num_updates=44100, lr=5.34045e-06, gnorm=3.421, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91231
2022-05-09 22:09:41 - progress_bar.py[line:272] - INFO: epoch 003:   8752 / 17711 loss=2.999, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=379.2, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.901825, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.106, expert1_balance_top=33.212, expert1_balance_bottom=19.723, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.7, ups=0.57, wpb=379.2, bsz=32, num_updates=44110, lr=5.33925e-06, gnorm=3.555, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91249
2022-05-09 22:09:58 - progress_bar.py[line:272] - INFO: epoch 003:   8762 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=372.9, nsentences=32, sample_size=296.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891895, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.294, expert1_balance_bottom=19.527, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=216.5, ups=0.58, wpb=372.9, bsz=32, num_updates=44120, lr=5.33805e-06, gnorm=3.663, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91266
2022-05-09 22:10:15 - progress_bar.py[line:272] - INFO: epoch 003:   8772 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=377.4, nsentences=32, sample_size=300.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893084, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.29, expert1_balance_bottom=19.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.6, ups=0.58, wpb=377.4, bsz=32, num_updates=44130, lr=5.33685e-06, gnorm=3.861, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91283
2022-05-09 22:10:32 - progress_bar.py[line:272] - INFO: epoch 003:   8782 / 17711 loss=3.027, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=385.5, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881823, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=35.003, expert1_balance_bottom=19.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=225.7, ups=0.59, wpb=385.5, bsz=32, num_updates=44140, lr=5.33565e-06, gnorm=3.903, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91300
2022-05-09 22:10:50 - progress_bar.py[line:272] - INFO: epoch 003:   8792 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=380.2, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883072, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.091, expert1_balance_bottom=19.206, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.4, ups=0.58, wpb=380.2, bsz=32, num_updates=44150, lr=5.33445e-06, gnorm=3.522, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91318
2022-05-09 22:11:07 - progress_bar.py[line:272] - INFO: epoch 003:   8802 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=376.2, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.893, expert1_balance_bottom=19.28, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=214.9, ups=0.57, wpb=376.2, bsz=32, num_updates=44160, lr=5.33325e-06, gnorm=3.86, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91335
2022-05-09 22:11:25 - progress_bar.py[line:272] - INFO: epoch 003:   8812 / 17711 loss=3.068, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894924, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.068, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=33.987, expert1_balance_bottom=19.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=215.8, ups=0.57, wpb=376.7, bsz=32, num_updates=44170, lr=5.33204e-06, gnorm=3.976, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91353
2022-05-09 22:11:42 - progress_bar.py[line:272] - INFO: epoch 003:   8822 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=385.6, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889833, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.356, expert1_balance_bottom=19.523, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=227, ups=0.59, wpb=385.6, bsz=32, num_updates=44180, lr=5.33084e-06, gnorm=3.775, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91370
2022-05-09 22:11:59 - progress_bar.py[line:272] - INFO: epoch 003:   8832 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=377.7, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896578, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.104, expert1_balance_bottom=19.332, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.6, ups=0.58, wpb=377.7, bsz=32, num_updates=44190, lr=5.32964e-06, gnorm=3.486, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91387
2022-05-09 22:12:16 - progress_bar.py[line:272] - INFO: epoch 003:   8842 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=380.9, nsentences=32, sample_size=303.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=34.643, expert1_balance_bottom=19.591, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.2, ups=0.58, wpb=380.9, bsz=32, num_updates=44200, lr=5.32844e-06, gnorm=3.558, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91404
2022-05-09 22:12:34 - progress_bar.py[line:272] - INFO: epoch 003:   8852 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=379.3, nsentences=32, sample_size=301.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893243, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.471, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=215.8, ups=0.57, wpb=379.3, bsz=32, num_updates=44210, lr=5.32724e-06, gnorm=3.863, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91422
2022-05-09 22:12:51 - progress_bar.py[line:272] - INFO: epoch 003:   8862 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=381.6, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892399, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.107, expert1_balance_bottom=19.602, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=221.7, ups=0.58, wpb=381.6, bsz=32, num_updates=44220, lr=5.32604e-06, gnorm=3.211, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91439
2022-05-09 22:13:08 - progress_bar.py[line:272] - INFO: epoch 003:   8872 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=380.1, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889136, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.119, expert1_balance_bottom=19.582, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.5, ups=0.57, wpb=380.1, bsz=32, num_updates=44230, lr=5.32484e-06, gnorm=4.128, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91456
2022-05-09 22:13:26 - progress_bar.py[line:272] - INFO: epoch 003:   8882 / 17711 loss=2.997, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=387.2, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886769, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.997, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.38, expert1_balance_bottom=19.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=220, ups=0.57, wpb=387.2, bsz=32, num_updates=44240, lr=5.32363e-06, gnorm=3.144, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91474
2022-05-09 22:13:44 - progress_bar.py[line:272] - INFO: epoch 003:   8892 / 17711 loss=3.002, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=376.7, nsentences=32, sample_size=299.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878058, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=35.094, expert1_balance_bottom=19.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.7, ups=0.57, wpb=376.7, bsz=32, num_updates=44250, lr=5.32243e-06, gnorm=3.327, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91492
2022-05-09 22:14:01 - progress_bar.py[line:272] - INFO: epoch 003:   8902 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=372.9, nsentences=32, sample_size=296.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87619, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=35.267, expert1_balance_bottom=19.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=210.3, ups=0.56, wpb=372.9, bsz=32, num_updates=44260, lr=5.32123e-06, gnorm=3.699, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91509
2022-05-09 22:14:19 - progress_bar.py[line:272] - INFO: epoch 003:   8912 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=377.2, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889043, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.247, expert1_balance_bottom=19.513, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=211.4, ups=0.56, wpb=377.2, bsz=32, num_updates=44270, lr=5.32003e-06, gnorm=3.561, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91527
2022-05-09 22:14:36 - progress_bar.py[line:272] - INFO: epoch 003:   8922 / 17711 loss=3.01, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=383.7, nsentences=32, sample_size=305.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.880284, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.01, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.451, expert1_balance_bottom=19.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=221.3, ups=0.58, wpb=383.7, bsz=32, num_updates=44280, lr=5.31883e-06, gnorm=3.932, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91544
2022-05-09 22:14:54 - progress_bar.py[line:272] - INFO: epoch 003:   8932 / 17711 loss=2.998, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=386.8, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890795, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.998, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.018, expert1_balance_bottom=19.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=217.2, ups=0.56, wpb=386.8, bsz=32, num_updates=44290, lr=5.31763e-06, gnorm=3.694, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91562
2022-05-09 22:15:12 - progress_bar.py[line:272] - INFO: epoch 003:   8942 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=383.1, nsentences=32, sample_size=304.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.868995, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=35.297, expert1_balance_bottom=19.275, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.2, ups=0.57, wpb=383.1, bsz=32, num_updates=44300, lr=5.31643e-06, gnorm=3.7, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91580
2022-05-09 22:15:30 - progress_bar.py[line:272] - INFO: epoch 003:   8952 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=379.8, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=34.867, expert1_balance_bottom=19.353, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.3, ups=0.57, wpb=379.8, bsz=32, num_updates=44310, lr=5.31523e-06, gnorm=3.735, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91598
2022-05-09 22:15:47 - progress_bar.py[line:272] - INFO: epoch 003:   8962 / 17711 loss=3.079, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=374.6, nsentences=32, sample_size=298.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894142, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.079, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=33.86, expert1_balance_bottom=19.602, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=209, ups=0.56, wpb=374.6, bsz=32, num_updates=44320, lr=5.31402e-06, gnorm=3.999, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91615
2022-05-09 22:16:05 - progress_bar.py[line:272] - INFO: epoch 003:   8972 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=383, nsentences=32, sample_size=304.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884896, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.731, expert1_balance_bottom=19.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=216.5, ups=0.57, wpb=383, bsz=32, num_updates=44330, lr=5.31282e-06, gnorm=3.398, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91633
2022-05-09 22:16:23 - progress_bar.py[line:272] - INFO: epoch 003:   8982 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=373.9, nsentences=32, sample_size=297.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893917, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.222, expert1_balance_bottom=19.48, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=212.4, ups=0.57, wpb=373.9, bsz=32, num_updates=44340, lr=5.31162e-06, gnorm=3.457, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91651
2022-05-09 22:16:40 - progress_bar.py[line:272] - INFO: epoch 003:   8992 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=380.8, nsentences=32, sample_size=303.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89313, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.983, expert1_balance_bottom=19.637, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=216.7, ups=0.57, wpb=380.8, bsz=32, num_updates=44350, lr=5.31042e-06, gnorm=3.79, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91668
2022-05-09 22:16:58 - progress_bar.py[line:272] - INFO: epoch 003:   9002 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=378.6, nsentences=32, sample_size=301.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.922, expert1_balance_bottom=19.461, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.6, ups=0.57, wpb=378.6, bsz=32, num_updates=44360, lr=5.30922e-06, gnorm=3.342, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91686
2022-05-09 22:17:15 - progress_bar.py[line:272] - INFO: epoch 003:   9012 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=386.9, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=35.492, expert1_balance_bottom=19.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=217.7, ups=0.56, wpb=386.9, bsz=32, num_updates=44370, lr=5.30802e-06, gnorm=3.481, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91704
2022-05-09 22:17:33 - progress_bar.py[line:272] - INFO: epoch 003:   9022 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=379.6, nsentences=32, sample_size=301.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895714, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.815, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=220.6, ups=0.58, wpb=379.6, bsz=32, num_updates=44380, lr=5.30682e-06, gnorm=3.646, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91721
2022-05-09 22:17:50 - progress_bar.py[line:272] - INFO: epoch 003:   9032 / 17711 loss=2.942, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=386.8, nsentences=32, sample_size=307.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.872798, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.942, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.091, expert1_balance_top=35.091, expert1_balance_bottom=19.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=221.7, ups=0.57, wpb=386.8, bsz=32, num_updates=44390, lr=5.30561e-06, gnorm=3.047, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91738
2022-05-09 22:18:08 - progress_bar.py[line:272] - INFO: epoch 003:   9042 / 17711 loss=2.985, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=383.6, nsentences=32, sample_size=305.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881769, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.985, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.643, expert1_balance_bottom=19.373, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.3, ups=0.55, wpb=383.6, bsz=32, num_updates=44400, lr=5.30441e-06, gnorm=3.005, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91756
2022-05-09 22:18:26 - progress_bar.py[line:272] - INFO: epoch 003:   9052 / 17711 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=385.6, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.89537, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=33.568, expert1_balance_bottom=19.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=214.9, ups=0.56, wpb=385.6, bsz=32, num_updates=44410, lr=5.30321e-06, gnorm=3.236, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91774
2022-05-09 22:18:44 - progress_bar.py[line:272] - INFO: epoch 003:   9062 / 17711 loss=2.982, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=384.7, nsentences=32, sample_size=306.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88148, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.982, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.814, expert1_balance_bottom=19.315, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.3, ups=0.57, wpb=384.7, bsz=32, num_updates=44420, lr=5.30201e-06, gnorm=3.557, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91792
2022-05-09 22:19:02 - progress_bar.py[line:272] - INFO: epoch 003:   9072 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=390.7, nsentences=32, sample_size=311.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889227, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.01, expert1_balance_bottom=19.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214.3, ups=0.55, wpb=390.7, bsz=32, num_updates=44430, lr=5.30081e-06, gnorm=3.77, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91810
2022-05-09 22:19:20 - progress_bar.py[line:272] - INFO: epoch 003:   9082 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=388.7, nsentences=32, sample_size=309.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887626, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.009, expert1_balance_bottom=19.597, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=214.2, ups=0.55, wpb=388.7, bsz=32, num_updates=44440, lr=5.29961e-06, gnorm=3.729, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91828
2022-05-09 22:19:38 - progress_bar.py[line:272] - INFO: epoch 003:   9092 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=385.3, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888445, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.289, expert1_balance_bottom=19.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=216.2, ups=0.56, wpb=385.3, bsz=32, num_updates=44450, lr=5.29841e-06, gnorm=3.56, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91846
2022-05-09 22:19:56 - progress_bar.py[line:272] - INFO: epoch 003:   9102 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=384.4, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891214, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.94, expert1_balance_bottom=19.413, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=216.6, ups=0.56, wpb=384.4, bsz=32, num_updates=44460, lr=5.29721e-06, gnorm=3.384, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91864
2022-05-09 22:20:14 - progress_bar.py[line:272] - INFO: epoch 003:   9112 / 17711 loss=3.055, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=385.5, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893951, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.055, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=33.91, expert1_balance_bottom=19.605, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=215.2, ups=0.56, wpb=385.5, bsz=32, num_updates=44470, lr=5.296e-06, gnorm=3.96, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91882
2022-05-09 22:20:31 - progress_bar.py[line:272] - INFO: epoch 003:   9122 / 17711 loss=2.926, loss_v1=0, loss_v2=0, nll_loss=0.717, ntokens=378.7, nsentences=32, sample_size=301.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882193, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.926, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.865, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=215.4, ups=0.57, wpb=378.7, bsz=32, num_updates=44480, lr=5.2948e-06, gnorm=3.015, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91899
2022-05-09 22:20:49 - progress_bar.py[line:272] - INFO: epoch 003:   9132 / 17711 loss=3.105, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.105, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.988, expert1_balance_bottom=19.372, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=217.5, ups=0.57, wpb=383.6, bsz=32, num_updates=44490, lr=5.2936e-06, gnorm=4.394, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91917
2022-05-09 22:21:06 - progress_bar.py[line:272] - INFO: epoch 003:   9142 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=383.6, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885431, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.424, expert1_balance_bottom=19.37, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=219.4, ups=0.57, wpb=383.6, bsz=32, num_updates=44500, lr=5.2924e-06, gnorm=3.583, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91934
2022-05-09 22:21:24 - progress_bar.py[line:272] - INFO: epoch 003:   9152 / 17711 loss=2.952, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=376.1, nsentences=32, sample_size=299.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884699, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.952, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.813, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=210, ups=0.56, wpb=376.1, bsz=32, num_updates=44510, lr=5.2912e-06, gnorm=3.455, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91952
2022-05-09 22:21:42 - progress_bar.py[line:272] - INFO: epoch 003:   9162 / 17711 loss=2.963, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=381.5, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886588, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.963, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.148, expert1_balance_bottom=19.477, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=216.7, ups=0.57, wpb=381.5, bsz=32, num_updates=44520, lr=5.29e-06, gnorm=3.987, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91970
2022-05-09 22:22:00 - progress_bar.py[line:272] - INFO: epoch 003:   9172 / 17711 loss=2.968, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=383.9, nsentences=32, sample_size=305.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886079, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.968, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.603, expert1_balance_bottom=19.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=216.5, ups=0.56, wpb=383.9, bsz=32, num_updates=44530, lr=5.2888e-06, gnorm=3.562, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=91988
2022-05-09 22:22:17 - progress_bar.py[line:272] - INFO: epoch 003:   9182 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=387.6, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888195, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.246, expert1_balance_bottom=19.283, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=220.9, ups=0.57, wpb=387.6, bsz=32, num_updates=44540, lr=5.2876e-06, gnorm=3.044, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92005
2022-05-09 22:22:35 - progress_bar.py[line:272] - INFO: epoch 003:   9192 / 17711 loss=3.006, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=382.5, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879972, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=34.404, expert1_balance_bottom=19.417, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=212.5, ups=0.56, wpb=382.5, bsz=32, num_updates=44550, lr=5.28639e-06, gnorm=4.243, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92023
2022-05-09 22:22:52 - progress_bar.py[line:272] - INFO: epoch 003:   9202 / 17711 loss=2.947, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=387.8, nsentences=32, sample_size=308.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882958, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.947, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.715, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.66, wps=224.1, ups=0.58, wpb=387.8, bsz=32, num_updates=44560, lr=5.28519e-06, gnorm=3.951, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92040
2022-05-09 22:23:10 - progress_bar.py[line:272] - INFO: epoch 003:   9212 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=387.7, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879089, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=34.694, expert1_balance_bottom=19.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=217.6, ups=0.56, wpb=387.7, bsz=32, num_updates=44570, lr=5.28399e-06, gnorm=3.286, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92058
2022-05-09 22:23:28 - progress_bar.py[line:272] - INFO: epoch 003:   9222 / 17711 loss=3.047, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=376.6, nsentences=32, sample_size=300, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893185, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.047, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.565, expert1_balance_bottom=19.772, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=213, ups=0.57, wpb=376.6, bsz=32, num_updates=44580, lr=5.28279e-06, gnorm=3.123, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92076
2022-05-09 22:23:45 - progress_bar.py[line:272] - INFO: epoch 003:   9232 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=373.8, nsentences=32, sample_size=297.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.896918, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.719, expert1_balance_bottom=19.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=213.3, ups=0.57, wpb=373.8, bsz=32, num_updates=44590, lr=5.28159e-06, gnorm=3.944, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92093
2022-05-09 22:24:03 - progress_bar.py[line:272] - INFO: epoch 003:   9242 / 17711 loss=3.024, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=382.9, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.866066, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.024, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.088, expert1_balance_top=35.422, expert1_balance_bottom=19.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=214, ups=0.56, wpb=382.9, bsz=32, num_updates=44600, lr=5.28039e-06, gnorm=3.477, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92111
2022-05-09 22:24:21 - progress_bar.py[line:272] - INFO: epoch 003:   9252 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=388.7, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.876147, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.089, expert1_balance_top=35.201, expert1_balance_bottom=19.284, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=216.1, ups=0.56, wpb=388.7, bsz=32, num_updates=44610, lr=5.27919e-06, gnorm=3.565, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92129
2022-05-09 22:24:39 - progress_bar.py[line:272] - INFO: epoch 003:   9262 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=392.2, nsentences=32, sample_size=312.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874157, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.091, expert1_balance_top=35.242, expert1_balance_bottom=19.097, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=224.5, ups=0.57, wpb=392.2, bsz=32, num_updates=44620, lr=5.27798e-06, gnorm=3.376, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92147
2022-05-09 22:24:57 - progress_bar.py[line:272] - INFO: epoch 003:   9272 / 17711 loss=2.946, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=367.8, nsentences=32, sample_size=292.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879207, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.946, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.091, expert1_balance_top=35.451, expert1_balance_bottom=19.077, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=205.5, ups=0.56, wpb=367.8, bsz=32, num_updates=44630, lr=5.27678e-06, gnorm=2.993, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92165
2022-05-09 22:25:14 - progress_bar.py[line:272] - INFO: epoch 003:   9282 / 17711 loss=2.965, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879952, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.965, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=34.885, expert1_balance_bottom=19.593, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=215.3, ups=0.56, wpb=382.6, bsz=32, num_updates=44640, lr=5.27558e-06, gnorm=3.41, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92183
2022-05-09 22:25:32 - progress_bar.py[line:272] - INFO: epoch 003:   9292 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=380.4, nsentences=32, sample_size=302.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890737, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.077, expert1_balance_bottom=19.467, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218.1, ups=0.57, wpb=380.4, bsz=32, num_updates=44650, lr=5.27438e-06, gnorm=4.546, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92200
2022-05-09 22:25:50 - progress_bar.py[line:272] - INFO: epoch 003:   9302 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=384.5, nsentences=32, sample_size=305.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893939, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.133, expert1_balance_bottom=19.49, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=216.1, ups=0.56, wpb=384.5, bsz=32, num_updates=44660, lr=5.27318e-06, gnorm=3.453, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92218
2022-05-09 22:26:07 - progress_bar.py[line:272] - INFO: epoch 003:   9312 / 17711 loss=3.003, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=383.2, nsentences=32, sample_size=304.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884198, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.388, expert1_balance_bottom=19.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=219.4, ups=0.57, wpb=383.2, bsz=32, num_updates=44670, lr=5.27198e-06, gnorm=3.229, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92235
2022-05-09 22:26:25 - progress_bar.py[line:272] - INFO: epoch 003:   9322 / 17711 loss=3.039, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=389.2, nsentences=32, sample_size=309.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884759, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.039, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.864, expert1_balance_bottom=19.217, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=219.5, ups=0.56, wpb=389.2, bsz=32, num_updates=44680, lr=5.27078e-06, gnorm=3.642, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92253
2022-05-09 22:26:43 - progress_bar.py[line:272] - INFO: epoch 003:   9332 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=377.2, nsentences=32, sample_size=300.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894674, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.393, expert1_balance_bottom=19.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=210.9, ups=0.56, wpb=377.2, bsz=32, num_updates=44690, lr=5.26958e-06, gnorm=3.324, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92271
2022-05-09 22:27:01 - progress_bar.py[line:272] - INFO: epoch 003:   9342 / 17711 loss=3.042, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=385.4, nsentences=32, sample_size=306.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890937, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.042, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=33.913, expert1_balance_bottom=19.605, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.4, ups=0.56, wpb=385.4, bsz=32, num_updates=44700, lr=5.26837e-06, gnorm=3.513, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92289
2022-05-09 22:27:18 - progress_bar.py[line:272] - INFO: epoch 003:   9352 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=384.9, nsentences=32, sample_size=306.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886126, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.837, expert1_balance_bottom=19.199, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=217.4, ups=0.56, wpb=384.9, bsz=32, num_updates=44710, lr=5.26717e-06, gnorm=4.118, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92306
2022-05-09 22:27:36 - progress_bar.py[line:272] - INFO: epoch 003:   9362 / 17711 loss=2.95, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=387.5, nsentences=32, sample_size=308.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.867559, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.95, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.088, expert1_balance_top=35.828, expert1_balance_bottom=19.067, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=224.4, ups=0.58, wpb=387.5, bsz=32, num_updates=44720, lr=5.26597e-06, gnorm=3.757, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92324
2022-05-09 22:27:53 - progress_bar.py[line:272] - INFO: epoch 003:   9372 / 17711 loss=3.046, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=377.6, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890274, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.488, expert1_balance_bottom=19.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=216.1, ups=0.57, wpb=377.6, bsz=32, num_updates=44730, lr=5.26477e-06, gnorm=4.12, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92341
2022-05-09 22:28:11 - progress_bar.py[line:272] - INFO: epoch 003:   9382 / 17711 loss=2.954, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=393, nsentences=32, sample_size=313, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881469, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.954, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.093, expert1_balance_top=34.935, expert1_balance_bottom=19.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=223.3, ups=0.57, wpb=393, bsz=32, num_updates=44740, lr=5.26357e-06, gnorm=4.075, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92359
2022-05-09 22:28:29 - progress_bar.py[line:272] - INFO: epoch 003:   9392 / 17711 loss=2.989, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=371.4, nsentences=32, sample_size=295.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898051, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.989, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.939, expert1_balance_bottom=19.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=206.3, ups=0.56, wpb=371.4, bsz=32, num_updates=44750, lr=5.26237e-06, gnorm=3.377, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92377
2022-05-09 22:28:46 - progress_bar.py[line:272] - INFO: epoch 003:   9402 / 17711 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=385.2, nsentences=32, sample_size=306.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891424, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.969, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=33.934, expert1_balance_bottom=19.556, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=216.4, ups=0.56, wpb=385.2, bsz=32, num_updates=44760, lr=5.26117e-06, gnorm=3.111, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92394
2022-05-09 22:29:05 - progress_bar.py[line:272] - INFO: epoch 003:   9412 / 17711 loss=3.005, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=382, nsentences=32, sample_size=303.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.891335, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.79, expert1_balance_bottom=19.496, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=210.5, ups=0.55, wpb=382, bsz=32, num_updates=44770, lr=5.25996e-06, gnorm=3.756, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92413
2022-05-09 22:29:22 - progress_bar.py[line:272] - INFO: epoch 003:   9422 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=384.3, nsentences=32, sample_size=305.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883754, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.645, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=218.9, ups=0.57, wpb=384.3, bsz=32, num_updates=44780, lr=5.25876e-06, gnorm=3.826, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92430
2022-05-09 22:29:40 - progress_bar.py[line:272] - INFO: epoch 003:   9432 / 17711 loss=2.993, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=387.2, nsentences=32, sample_size=308.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886805, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.993, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.087, expert1_balance_bottom=19.557, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=218.5, ups=0.56, wpb=387.2, bsz=32, num_updates=44790, lr=5.25756e-06, gnorm=3.817, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92448
2022-05-09 22:29:43 - trainer.py[line:1047] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-09 22:29:59 - progress_bar.py[line:272] - INFO: epoch 003:   9443 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=385.4, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889502, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.021, expert1_balance_bottom=19.557, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=198.9, ups=0.52, wpb=385.4, bsz=32, num_updates=44800, lr=5.25636e-06, gnorm=3.678, loss_scale=32, train_wall=18, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92467
2022-05-09 22:30:17 - progress_bar.py[line:272] - INFO: epoch 003:   9453 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=382, nsentences=32, sample_size=304.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88247, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.484, expert1_balance_bottom=19.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=219.4, ups=0.57, wpb=382, bsz=32, num_updates=44810, lr=5.25516e-06, gnorm=3.402, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92485
2022-05-09 22:30:34 - progress_bar.py[line:272] - INFO: epoch 003:   9463 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=386, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890428, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.443, expert1_balance_bottom=19.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=218.6, ups=0.57, wpb=386, bsz=32, num_updates=44820, lr=5.25396e-06, gnorm=3.421, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92502
2022-05-09 22:30:52 - progress_bar.py[line:272] - INFO: epoch 003:   9473 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=379.6, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889452, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.058, expert1_balance_bottom=19.526, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=209.7, ups=0.55, wpb=379.6, bsz=32, num_updates=44830, lr=5.25276e-06, gnorm=3.475, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92520
2022-05-09 22:31:10 - progress_bar.py[line:272] - INFO: epoch 003:   9483 / 17711 loss=3.009, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=383.9, nsentences=32, sample_size=305.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887967, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.397, expert1_balance_bottom=19.503, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=214.2, ups=0.56, wpb=383.9, bsz=32, num_updates=44840, lr=5.25156e-06, gnorm=3.896, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92538
2022-05-09 22:31:28 - progress_bar.py[line:272] - INFO: epoch 003:   9493 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=380, nsentences=32, sample_size=302.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.264, expert1_balance_bottom=19.607, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=218.5, ups=0.57, wpb=380, bsz=32, num_updates=44850, lr=5.25035e-06, gnorm=3.597, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92556
2022-05-09 22:31:45 - progress_bar.py[line:272] - INFO: epoch 003:   9503 / 17711 loss=2.994, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=385, nsentences=32, sample_size=306.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884797, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.994, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=33.844, expert1_balance_bottom=19.573, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=217.7, ups=0.57, wpb=385, bsz=32, num_updates=44860, lr=5.24915e-06, gnorm=3.512, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92573
2022-05-09 22:32:03 - progress_bar.py[line:272] - INFO: epoch 003:   9513 / 17711 loss=2.955, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=386.8, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87523, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.955, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=35.328, expert1_balance_bottom=19.19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=223, ups=0.58, wpb=386.8, bsz=32, num_updates=44870, lr=5.24795e-06, gnorm=3.44, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92591
2022-05-09 22:32:20 - progress_bar.py[line:272] - INFO: epoch 003:   9523 / 17711 loss=2.99, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=378.3, nsentences=32, sample_size=301, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894416, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.99, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=33.984, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=217, ups=0.57, wpb=378.3, bsz=32, num_updates=44880, lr=5.24675e-06, gnorm=3.441, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92608
2022-05-09 22:32:38 - progress_bar.py[line:272] - INFO: epoch 003:   9533 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=383.9, nsentences=32, sample_size=305.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.87802, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=34.882, expert1_balance_bottom=19.522, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=211.8, ups=0.55, wpb=383.9, bsz=32, num_updates=44890, lr=5.24555e-06, gnorm=3.444, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92626
2022-05-09 22:32:56 - progress_bar.py[line:272] - INFO: epoch 003:   9543 / 17711 loss=3.063, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=381.5, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878285, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.84, expert1_balance_bottom=19.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213, ups=0.56, wpb=381.5, bsz=32, num_updates=44900, lr=5.24435e-06, gnorm=4.267, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92644
2022-05-09 22:33:14 - progress_bar.py[line:272] - INFO: epoch 003:   9553 / 17711 loss=2.976, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=385.8, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88348, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.976, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.854, expert1_balance_bottom=19.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=221.3, ups=0.57, wpb=385.8, bsz=32, num_updates=44910, lr=5.24315e-06, gnorm=3.532, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92662
2022-05-09 22:33:32 - progress_bar.py[line:272] - INFO: epoch 003:   9563 / 17711 loss=2.973, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=377.3, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.895778, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.973, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.123, expert1_balance_bottom=19.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=205.8, ups=0.55, wpb=377.3, bsz=32, num_updates=44920, lr=5.24195e-06, gnorm=4.279, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92680
2022-05-09 22:33:50 - progress_bar.py[line:272] - INFO: epoch 003:   9573 / 17711 loss=2.979, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=390.2, nsentences=32, sample_size=310.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.883487, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.979, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.604, expert1_balance_bottom=19.596, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.1, ups=0.56, wpb=390.2, bsz=32, num_updates=44930, lr=5.24074e-06, gnorm=3.332, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92698
2022-05-09 22:34:08 - progress_bar.py[line:272] - INFO: epoch 003:   9583 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=382.6, nsentences=32, sample_size=304.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888375, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.045, expert1_balance_bottom=19.617, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=212, ups=0.55, wpb=382.6, bsz=32, num_updates=44940, lr=5.23954e-06, gnorm=4.107, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92716
2022-05-09 22:34:26 - progress_bar.py[line:272] - INFO: epoch 003:   9593 / 17711 loss=3.021, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=386.6, nsentences=32, sample_size=308.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882627, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.727, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=217.8, ups=0.56, wpb=386.6, bsz=32, num_updates=44950, lr=5.23834e-06, gnorm=3.618, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92734
2022-05-09 22:34:44 - progress_bar.py[line:272] - INFO: epoch 003:   9603 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=388.8, nsentences=32, sample_size=309.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873689, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.091, expert1_balance_top=35.441, expert1_balance_bottom=19.148, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=215.5, ups=0.55, wpb=388.8, bsz=32, num_updates=44960, lr=5.23714e-06, gnorm=4.12, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92752
2022-05-09 22:35:01 - progress_bar.py[line:272] - INFO: epoch 003:   9613 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=377.1, nsentences=32, sample_size=300.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889596, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.285, expert1_balance_bottom=19.479, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=212.5, ups=0.56, wpb=377.1, bsz=32, num_updates=44970, lr=5.23594e-06, gnorm=3.344, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92769
2022-05-09 22:35:19 - progress_bar.py[line:272] - INFO: epoch 003:   9623 / 17711 loss=3.013, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=379.6, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.902679, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.105, expert1_balance_top=33.532, expert1_balance_bottom=19.678, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.2, ups=0.57, wpb=379.6, bsz=32, num_updates=44980, lr=5.23474e-06, gnorm=3.83, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92787
2022-05-09 22:35:37 - progress_bar.py[line:272] - INFO: epoch 003:   9633 / 17711 loss=3.007, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=371.8, nsentences=32, sample_size=295.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890858, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.379, expert1_balance_bottom=19.339, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=207.8, ups=0.56, wpb=371.8, bsz=32, num_updates=44990, lr=5.23354e-06, gnorm=3.621, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92805
2022-05-09 22:35:54 - progress_bar.py[line:272] - INFO: epoch 003:   9643 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=394.3, nsentences=32, sample_size=313.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887762, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.198, expert1_balance_bottom=19.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=227.5, ups=0.58, wpb=394.3, bsz=32, num_updates=45000, lr=5.23233e-06, gnorm=3.66, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=92822
2022-05-09 22:35:54 - train.py[line:470] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-09 22:35:54 - train.py[line:480] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-09 22:35:54 - train.py[line:508] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-09 22:43:11 - train.py[line:517] - INFO: valid_step finished
2022-05-09 22:43:11 - progress_bar.py[line:282] - INFO: epoch 003 | valid on 'valid' subset | loss 10.142 | loss_v1 0 | loss_v2 0 | nll_loss 8.481 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | sample_size_v1 0 | sample_size_v2 0 | moe_gate_loss_v1 0 | moe_gate_loss_v2 0 | moe_gate_loss 1.00028 | inner_loss_v1 0 | inner_loss_v2 0 | inner_loss 10.142 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.16 | expert1_balance_top 39.788 | expert1_balance_bottom 15.005 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 357.36 | cider 1.207 | wps 690.5 | wpb 481.7 | bsz 8 | num_updates 45000 | best_cider 1.207
2022-05-09 22:43:11 - checkpoint_utils.py[line:67] - INFO: Preparing to save checkpoint for epoch 3 @ 45000 updates
2022-05-09 22:43:11 - trainer.py[line:509] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_45000-rank-0.pt
2022-05-09 22:43:11 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_45000-rank-0.pt
2022-05-09 22:43:19 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_45000-rank-0.pt
2022-05-09 22:43:19 - trainer.py[line:513] - INFO: Saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_45000-shared.pt
2022-05-09 22:43:28 - trainer.py[line:527] - INFO: Finished saving checkpoint to ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_45000-shared.pt
2022-05-09 22:44:00 - checkpoint_utils.py[line:156] - INFO: Saved checkpoint ./moe_stage1_checkpoints/5_0.06_2500/checkpoint_3_45000-rank-0.pt (epoch 3 @ 45000 updates, score 1.207) (writing took 49.284183031879365 seconds)
2022-05-09 22:44:18 - progress_bar.py[line:272] - INFO: epoch 003:   9653 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=378.3, nsentences=32, sample_size=300.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889713, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=33.87, expert1_balance_bottom=19.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=7.5, ups=0.02, wpb=378.3, bsz=32, num_updates=45010, lr=5.23113e-06, gnorm=3.68, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93327
2022-05-09 22:44:38 - progress_bar.py[line:272] - INFO: epoch 003:   9663 / 17711 loss=3.017, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=381.2, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889243, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.017, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.165, expert1_balance_bottom=19.535, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=193, ups=0.51, wpb=381.2, bsz=32, num_updates=45020, lr=5.22993e-06, gnorm=3.435, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93346
2022-05-09 22:44:56 - progress_bar.py[line:272] - INFO: epoch 003:   9673 / 17711 loss=2.961, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=381.5, nsentences=32, sample_size=303.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889255, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.961, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.306, expert1_balance_bottom=19.501, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=215, ups=0.56, wpb=381.5, bsz=32, num_updates=45030, lr=5.22873e-06, gnorm=4.223, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93364
2022-05-09 22:45:14 - progress_bar.py[line:272] - INFO: epoch 003:   9683 / 17711 loss=3.019, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=378.9, nsentences=32, sample_size=301.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.889131, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.019, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.225, expert1_balance_bottom=19.589, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.3, ups=0.57, wpb=378.9, bsz=32, num_updates=45040, lr=5.22753e-06, gnorm=3.592, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93382
2022-05-09 22:45:31 - progress_bar.py[line:272] - INFO: epoch 003:   9693 / 17711 loss=3, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=384.1, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888868, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.159, expert1_balance_bottom=19.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=216.2, ups=0.56, wpb=384.1, bsz=32, num_updates=45050, lr=5.22633e-06, gnorm=3.754, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93399
2022-05-09 22:45:50 - progress_bar.py[line:272] - INFO: epoch 003:   9703 / 17711 loss=2.975, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=385.9, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882148, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.975, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=34.96, expert1_balance_bottom=19.371, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=211, ups=0.55, wpb=385.9, bsz=32, num_updates=45060, lr=5.22513e-06, gnorm=3.605, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93418
2022-05-09 22:46:10 - progress_bar.py[line:272] - INFO: epoch 003:   9713 / 17711 loss=2.953, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=389.4, nsentences=32, sample_size=309.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.874277, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.953, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=35.461, expert1_balance_bottom=19.265, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=190.1, ups=0.49, wpb=389.4, bsz=32, num_updates=45070, lr=5.22393e-06, gnorm=3.281, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93438
2022-05-09 22:46:29 - progress_bar.py[line:272] - INFO: epoch 003:   9723 / 17711 loss=2.992, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=384.4, nsentences=32, sample_size=305.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.884208, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.992, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.413, expert1_balance_bottom=19.458, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=208.2, ups=0.54, wpb=384.4, bsz=32, num_updates=45080, lr=5.22272e-06, gnorm=3.781, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93457
2022-05-09 22:46:50 - progress_bar.py[line:272] - INFO: epoch 003:   9733 / 17711 loss=3.064, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=385.6, nsentences=32, sample_size=307, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892659, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.064, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.112, expert1_balance_bottom=19.519, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=180.5, ups=0.47, wpb=385.6, bsz=32, num_updates=45090, lr=5.22152e-06, gnorm=4.341, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93478
2022-05-09 22:47:08 - progress_bar.py[line:272] - INFO: epoch 003:   9743 / 17711 loss=2.984, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=372.9, nsentences=32, sample_size=296.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882364, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.984, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=35.022, expert1_balance_bottom=19.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=208.8, ups=0.56, wpb=372.9, bsz=32, num_updates=45100, lr=5.22032e-06, gnorm=3.656, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93496
2022-05-09 22:47:26 - progress_bar.py[line:272] - INFO: epoch 003:   9753 / 17711 loss=3.02, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=388.7, nsentences=32, sample_size=309.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887266, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.307, expert1_balance_bottom=19.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=219, ups=0.56, wpb=388.7, bsz=32, num_updates=45110, lr=5.21912e-06, gnorm=3.546, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93514
2022-05-09 22:47:43 - progress_bar.py[line:272] - INFO: epoch 003:   9763 / 17711 loss=2.96, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=385.9, nsentences=32, sample_size=307.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.885479, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.96, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.097, expert1_balance_top=34.579, expert1_balance_bottom=19.547, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=216.8, ups=0.56, wpb=385.9, bsz=32, num_updates=45120, lr=5.21792e-06, gnorm=3.469, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93531
2022-05-09 22:48:03 - progress_bar.py[line:272] - INFO: epoch 003:   9773 / 17711 loss=3.048, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=379.2, nsentences=32, sample_size=301.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.882592, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.048, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.554, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=193, ups=0.51, wpb=379.2, bsz=32, num_updates=45130, lr=5.21672e-06, gnorm=4.12, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93551
2022-05-09 22:48:21 - progress_bar.py[line:272] - INFO: epoch 003:   9783 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=387.1, nsentences=32, sample_size=308, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888302, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.099, expert1_balance_top=34.332, expert1_balance_bottom=19.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=218, ups=0.56, wpb=387.1, bsz=32, num_updates=45140, lr=5.21552e-06, gnorm=3.967, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93569
2022-05-09 22:48:39 - progress_bar.py[line:272] - INFO: epoch 003:   9793 / 17711 loss=3.015, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=394, nsentences=32, sample_size=313.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.873518, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.015, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=35.254, expert1_balance_bottom=19.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=219.2, ups=0.56, wpb=394, bsz=32, num_updates=45150, lr=5.21431e-06, gnorm=3.296, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93587
2022-05-09 22:48:56 - progress_bar.py[line:272] - INFO: epoch 003:   9803 / 17711 loss=3.04, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=378.1, nsentences=32, sample_size=301.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.04, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.104, expert1_balance_top=33.557, expert1_balance_bottom=19.688, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=214.4, ups=0.57, wpb=378.1, bsz=32, num_updates=45160, lr=5.21311e-06, gnorm=3.636, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93604
2022-05-09 22:49:14 - progress_bar.py[line:272] - INFO: epoch 003:   9813 / 17711 loss=3.026, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=374.9, nsentences=32, sample_size=298.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.887303, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.026, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.564, expert1_balance_bottom=19.57, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=215.2, ups=0.57, wpb=374.9, bsz=32, num_updates=45170, lr=5.21191e-06, gnorm=3.535, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93622
2022-05-09 22:49:31 - progress_bar.py[line:272] - INFO: epoch 003:   9823 / 17711 loss=2.938, loss_v1=0, loss_v2=0, nll_loss=0.71, ntokens=380.1, nsentences=32, sample_size=302.3, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.898703, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.938, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.57, expert1_balance_bottom=19.616, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=218.3, ups=0.57, wpb=380.1, bsz=32, num_updates=45180, lr=5.21071e-06, gnorm=3.554, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93639
2022-05-09 22:49:49 - progress_bar.py[line:272] - INFO: epoch 003:   9833 / 17711 loss=3.035, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=383.2, nsentences=32, sample_size=305.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879359, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.035, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.095, expert1_balance_top=34.976, expert1_balance_bottom=19.239, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=212, ups=0.55, wpb=383.2, bsz=32, num_updates=45190, lr=5.20951e-06, gnorm=3.983, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93657
2022-05-09 22:50:09 - progress_bar.py[line:272] - INFO: epoch 003:   9843 / 17711 loss=3.037, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=373.4, nsentences=32, sample_size=297.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881692, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.037, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.886, expert1_balance_bottom=19.112, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=187.5, ups=0.5, wpb=373.4, bsz=32, num_updates=45200, lr=5.20831e-06, gnorm=3.406, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93677
2022-05-09 22:50:27 - progress_bar.py[line:272] - INFO: epoch 003:   9853 / 17711 loss=3.056, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=377.6, nsentences=32, sample_size=300.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888323, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.245, expert1_balance_bottom=19.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=212.9, ups=0.56, wpb=377.6, bsz=32, num_updates=45210, lr=5.20711e-06, gnorm=3.988, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93695
2022-05-09 22:50:44 - progress_bar.py[line:272] - INFO: epoch 003:   9863 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.803, ntokens=377.9, nsentences=32, sample_size=300.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.894002, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.764, expert1_balance_bottom=19.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=215.3, ups=0.57, wpb=377.9, bsz=32, num_updates=45220, lr=5.20591e-06, gnorm=3.494, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93713
2022-05-09 22:51:02 - progress_bar.py[line:272] - INFO: epoch 003:   9873 / 17711 loss=2.962, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=376.3, nsentences=32, sample_size=299.6, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892982, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.962, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=33.794, expert1_balance_bottom=19.447, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=211.9, ups=0.56, wpb=376.3, bsz=32, num_updates=45230, lr=5.2047e-06, gnorm=3.761, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93730
2022-05-09 22:51:20 - progress_bar.py[line:272] - INFO: epoch 003:   9883 / 17711 loss=2.995, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=385.6, nsentences=32, sample_size=306.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.877897, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.995, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.697, expert1_balance_bottom=19.316, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=215.8, ups=0.56, wpb=385.6, bsz=32, num_updates=45240, lr=5.2035e-06, gnorm=4.103, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93748
2022-05-09 22:51:41 - progress_bar.py[line:272] - INFO: epoch 003:   9893 / 17711 loss=2.987, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=381.7, nsentences=32, sample_size=303.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88884, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.987, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.196, expert1_balance_bottom=19.493, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.71, wps=184.3, ups=0.48, wpb=381.7, bsz=32, num_updates=45250, lr=5.2023e-06, gnorm=3.902, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93769
2022-05-09 22:51:59 - progress_bar.py[line:272] - INFO: epoch 003:   9903 / 17711 loss=2.996, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=379.4, nsentences=32, sample_size=302.1, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.899308, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.996, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.98, expert1_balance_bottom=19.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=210.8, ups=0.56, wpb=379.4, bsz=32, num_updates=45260, lr=5.2011e-06, gnorm=4.072, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93787
2022-05-09 22:52:16 - progress_bar.py[line:272] - INFO: epoch 003:   9913 / 17711 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=385.9, nsentences=32, sample_size=306.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.888792, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.98, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=34.076, expert1_balance_bottom=19.625, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=219.2, ups=0.57, wpb=385.9, bsz=32, num_updates=45270, lr=5.1999e-06, gnorm=3.688, loss_scale=32, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93804
2022-05-09 22:52:34 - progress_bar.py[line:272] - INFO: epoch 003:   9923 / 17711 loss=3.061, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=380.7, nsentences=32, sample_size=302.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.881239, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.061, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.981, expert1_balance_bottom=19.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=211.5, ups=0.56, wpb=380.7, bsz=32, num_updates=45280, lr=5.1987e-06, gnorm=3.654, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93822
2022-05-09 22:52:52 - progress_bar.py[line:272] - INFO: epoch 003:   9933 / 17711 loss=3.09, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=392.7, nsentences=32, sample_size=312.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.88466, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.09, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.098, expert1_balance_top=34.599, expert1_balance_bottom=19.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=221.2, ups=0.56, wpb=392.7, bsz=32, num_updates=45290, lr=5.1975e-06, gnorm=3.526, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93840
2022-05-09 22:53:10 - progress_bar.py[line:272] - INFO: epoch 003:   9943 / 17711 loss=2.964, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=381.2, nsentences=32, sample_size=303.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886492, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.964, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=34.425, expert1_balance_bottom=19.598, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.68, wps=215.8, ups=0.57, wpb=381.2, bsz=32, num_updates=45300, lr=5.1963e-06, gnorm=3.237, loss_scale=32, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93858
2022-05-09 22:53:28 - progress_bar.py[line:272] - INFO: epoch 003:   9953 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=374.1, nsentences=32, sample_size=297.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.892426, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.101, expert1_balance_top=34.086, expert1_balance_bottom=19.487, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.69, wps=207.2, ups=0.55, wpb=374.1, bsz=32, num_updates=45310, lr=5.19509e-06, gnorm=4.19, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93876
2022-05-09 22:53:46 - progress_bar.py[line:272] - INFO: epoch 003:   9963 / 17711 loss=3.052, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=376.5, nsentences=32, sample_size=299.5, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.893726, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.103, expert1_balance_top=33.985, expert1_balance_bottom=19.492, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=207.9, ups=0.55, wpb=376.5, bsz=32, num_updates=45320, lr=5.19389e-06, gnorm=3.568, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93894
2022-05-09 22:54:04 - progress_bar.py[line:272] - INFO: epoch 003:   9973 / 17711 loss=3.031, loss_v1=0, loss_v2=0, nll_loss=0.802, ntokens=375.8, nsentences=32, sample_size=298.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.90373, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.031, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.107, expert1_balance_top=33.152, expert1_balance_bottom=19.877, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=213.8, ups=0.57, wpb=375.8, bsz=32, num_updates=45330, lr=5.19269e-06, gnorm=4.268, loss_scale=64, train_wall=16, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93912
2022-05-09 22:54:22 - progress_bar.py[line:272] - INFO: epoch 003:   9983 / 17711 loss=2.988, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=381.1, nsentences=32, sample_size=303.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.869601, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.988, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.09, expert1_balance_top=35.801, expert1_balance_bottom=19.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=211.6, ups=0.56, wpb=381.1, bsz=32, num_updates=45340, lr=5.19149e-06, gnorm=3.583, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93930
2022-05-09 22:54:40 - progress_bar.py[line:272] - INFO: epoch 003:   9993 / 17711 loss=3.025, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=380.5, nsentences=32, sample_size=302.8, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878726, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.025, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.094, expert1_balance_top=35.002, expert1_balance_bottom=19.238, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.1, ups=0.55, wpb=380.5, bsz=32, num_updates=45350, lr=5.19029e-06, gnorm=3.412, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93948
2022-05-09 22:54:58 - progress_bar.py[line:272] - INFO: epoch 003:  10003 / 17711 loss=2.957, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=378.6, nsentences=32, sample_size=301.4, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.890264, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.957, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.102, expert1_balance_top=34.005, expert1_balance_bottom=19.668, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.67, wps=203.2, ups=0.54, wpb=378.6, bsz=32, num_updates=45360, lr=5.18909e-06, gnorm=3.39, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93966
2022-05-09 22:55:17 - progress_bar.py[line:272] - INFO: epoch 003:  10013 / 17711 loss=3.018, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=381.7, nsentences=32, sample_size=303.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.886501, inner_loss_v1=0, inner_loss_v2=0, inner_loss=3.018, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.1, expert1_balance_top=33.916, expert1_balance_bottom=19.718, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=202.7, ups=0.53, wpb=381.7, bsz=32, num_updates=45370, lr=5.18789e-06, gnorm=3.33, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=93985
2022-05-09 22:55:36 - progress_bar.py[line:272] - INFO: epoch 003:  10023 / 17711 loss=2.926, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=386.6, nsentences=32, sample_size=307.9, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.879481, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.926, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.096, expert1_balance_top=34.919, expert1_balance_bottom=19.268, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.64, wps=200.2, ups=0.52, wpb=386.6, bsz=32, num_updates=45380, lr=5.18668e-06, gnorm=3.307, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=94004
2022-05-09 22:55:55 - progress_bar.py[line:272] - INFO: epoch 003:  10033 / 17711 loss=2.972, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=386.1, nsentences=32, sample_size=307.7, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878534, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.972, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=34.808, expert1_balance_bottom=19.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.7, wps=207.7, ups=0.54, wpb=386.1, bsz=32, num_updates=45390, lr=5.18548e-06, gnorm=3.275, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=94023
2022-05-09 22:56:15 - progress_bar.py[line:272] - INFO: epoch 003:  10043 / 17711 loss=2.928, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=377.5, nsentences=32, sample_size=300.2, sample_size_v1=0, sample_size_v2=0, moe_gate_loss_v1=0, moe_gate_loss_v2=0, moe_gate_loss=0.878298, inner_loss_v1=0, inner_loss_v2=0, inner_loss=2.928, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.092, expert1_balance_top=34.746, expert1_balance_bottom=19.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.65, wps=190.6, ups=0.5, wpb=377.5, bsz=32, num_updates=45400, lr=5.18428e-06, gnorm=3.399, loss_scale=64, train_wall=17, cuda_gb_allocated=14.1, cuda_gb_reserved=15, cuda_gb_free=9.6, wall=94043
Traceback (most recent call last):
  File "../../train.py", line 572, in <module>
    cli_main()
  File "../../train.py", line 565, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/workspace/OFA/fairseq/fairseq/distributed/utils.py", line 387, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/workspace/OFA/fairseq/fairseq/distributed/utils.py", line 361, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 209, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/opt/conda/lib/python3.8/contextlib.py", line 75, in inner
    return func(*args, **kwds)
  File "../../train.py", line 316, in train
    for i, samples in enumerate(progress):
  File "/workspace/OFA/fairseq/fairseq/logging/progress_bar.py", line 261, in __iter__
    for i, obj in enumerate(self.iterable, start=self.n):
  File "/workspace/OFA/fairseq/fairseq/data/iterators.py", line 56, in __next__
    x = next(self._itr)
  File "/workspace/OFA/fairseq/fairseq/data/iterators.py", line 509, in _chunk_iterator
    for x in itr:
  File "/workspace/OFA/fairseq/fairseq/data/iterators.py", line 56, in __next__
    x = next(self._itr)
  File "/workspace/OFA/fairseq/fairseq/data/iterators.py", line 637, in __next__
    raise item
  File "/workspace/OFA/fairseq/fairseq/data/iterators.py", line 567, in run
    for item in self._source:
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 557, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/workspace/OFA/data/mm_data/caption_dataset.py", line 117, in __getitem__
    uniq_id, image, caption = self.dataset[index]
  File "/workspace/OFA/data/file_dataset.py", line 106, in __getitem__
    column_l = [dtype(column_l[col_id]) for col_id, dtype in zip(self.selected_col_ids, self.dtypes)]
  File "/workspace/OFA/data/file_dataset.py", line 106, in <listcomp>
    column_l = [dtype(column_l[col_id]) for col_id, dtype in zip(self.selected_col_ids, self.dtypes)]
IndexError: list index out of range
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/opt/conda/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 340, in <module>
    main()
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 326, in main
    sigkill_handler(signal.SIGTERM, None)  # not coming back
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 301, in sigkill_handler
    raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
subprocess.CalledProcessError: Command '['/opt/conda/bin/python3', '-u', '../../train.py', '--local_rank=0', '../../dataset/caption_data/caption_stage1_train.tsv,../../dataset/caption_data/caption_val.tsv', '--selected-cols=0,4,2', '--bpe-dir=../../utils/BPE', '--user-dir=../../ofa_module', '--restore-file=./moe_stage1_checkpoints/2_0.06_2500/checkpoint.best_cider_1.2030.pt', '--reset-optimizer', '--reset-dataloader', '--reset-meters', '--save-dir=./moe_stage1_checkpoints/5_0.06_2500', '--task=caption', '--arch=ofa_moe_base', '--criterion=adjust_label_smoothed_moe_cross_entropy', '--label-smoothing=0.1', '--batch-size=8', '--update-freq=4', '--encoder-normalize-before', '--decoder-normalize-before', '--share-decoder-input-output-embed', '--share-all-embeddings', '--layernorm-embedding', '--patch-layernorm-embedding', '--code-layernorm-embedding', '--resnet-drop-path-rate=0.0', '--encoder-drop-path-rate=0.1', '--decoder-drop-path-rate=0.1', '--dropout=0.1', '--attention-dropout=0.0', '--weight-decay=0.01', '--optimizer=adam', '--adam-betas=(0.9,0.999)', '--adam-eps=1e-08', '--clip-norm=0.0', '--lr-scheduler=polynomial_decay', '--lr=1e-5', '--max-epoch=5', '--warmup-ratio=0.06', '--log-format=simple', '--log-interval=10', '--fixed-validation-seed=7', '--no-epoch-checkpoints', '--keep-best-checkpoints=1', '--save-interval=1', '--validate-interval=1', '--save-interval-updates=5000', '--validate-interval-updates=2000', '--eval-cider', '--eval-cider-cached-tokens=../../dataset/caption_data/cider_cached_tokens/coco-valid-words.p', '--eval-args={"beam":1,"max_len_b":16,"no_repeat_ngram_size":3}', '--best-checkpoint-metric=cider', '--maximize-best-checkpoint-metric', '--max-src-length=80', '--max-tgt-length=20', '--find-unused-parameters', '--freeze-encoder-embedding', '--freeze-decoder-embedding', '--add-type-embedding', '--scale-attn', '--scale-fc', '--scale-heads', '--moe-expert-count=4', '--moe-gating-use-fp32', '--moe-second-expert-policy=all', '--moe-normalize-gate-prob-before-dropping', '--moe-top1-expert', '--moe-normalize-expert-grad=', '--use-moe-pad-mask', '--disable-entangle', '--num-bins=1000', '--patch-image-size=480', '--drop-worst-ratio=0.2', '--drop-worst-after=2500', '--fp16', '--fp16-scale-window=512', '--num-workers=0']' returned non-zero exit status 1.
Killing subprocess 47964
