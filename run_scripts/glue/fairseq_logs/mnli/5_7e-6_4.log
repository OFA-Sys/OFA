2022-04-25 12:05:27 - utils.py[line:255] - INFO: distributed init (rank 0): env://
2022-04-25 12:05:27 - utils.py[line:261] - INFO: Start init
2022-04-25 12:05:27 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2022-04-25 12:05:27 - utils.py[line:271] - INFO: initialized host heming-ng1 as rank 0
single-machine distributed training is initialized.
2022-04-25 12:06:13 - train.py[line:76] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 16, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../ofa_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 16, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 100, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 16, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 5, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [4], 'lr': [7e-06], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './fairseq_checkpoints/mnli/5_7e-6_4', 'restore_file': '../../checkpoints/ofa_base.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1000, 'save_interval_updates': 1000, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': False, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'acc', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='ofa_resmo', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, ans2label_dict='{"maybe": 0, "yes": 1, "no": 2}', arch='ofa_resmo', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric='acc', bf16=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=0.0, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='../../dataset/glue_data/mnli_train.tsv,../../dataset/glue_data/mnli_dev.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=True, decoder_output_dim=768, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=1, distributed_port=-1, distributed_rank=0, distributed_world_size=1, drop_worst_after=0, drop_worst_ratio=0.0, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=16, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=False, freeze_encoder_embedding=False, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.0, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, lr=[7e-06], lr_scheduler='polynomial_decay', max_epoch=5, max_source_positions=1024, max_src_length=512, max_target_positions=1024, max_tgt_length=30, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, moe_gate_loss_combine_method='average', moe_gate_loss_transform='none', moe_gate_loss_wt=1.0, no_cross_attention=False, no_epoch_checkpoints=False, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=1, num_bins=1000, num_shards=1, num_workers=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patch_image_size=480, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, prompt_type='src', quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, resnet_type='resnet101', restore_file='../../checkpoints/ofa_base.pt', sample_patch_num=196, save_dir='./fairseq_checkpoints/mnli/5_7e-6_4', save_interval=1000, save_interval_updates=1000, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', seed=1, selected_cols='0,1,2', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, sync_bn=False, task='mnli', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[4], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../ofa_module', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=100, wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'mnli', 'data': '../../dataset/glue_data/mnli_train.tsv,../../dataset/glue_data/mnli_dev.tsv', 'selected_cols': '0,1,2', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 512, 'max_tgt_length': 30, 'code_dict_size': 8192, 'patch_image_size': 480, 'num_bins': 1000, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'ans2label_dict': '{"maybe": 0, "yes": 1, "no": 2}', 'prompt_type': 'src'}, 'criterion': {'_name': 'adjust_label_smoothed_cross_entropy', 'label_smoothing': 0.0, 'report_accuracy': False, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.0, 'drop_worst_after': 0, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None, 'moe_gate_loss_wt': 1.0, 'moe_gate_loss_combine_method': 'average', 'moe_gate_loss_transform': 'none'}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [7e-06]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [7e-06]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2022-04-25 12:06:14 - ofa_task.py[line:103] - INFO: source dictionary: 59457 types
2022-04-25 12:06:14 - ofa_task.py[line:104] - INFO: target dictionary: 59457 types
2022-04-25 12:06:15 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2022-04-25 12:06:15 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:3 to store for rank: 0
2022-04-25 12:06:15 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:4 to store for rank: 0
2022-04-25 12:06:22 - train.py[line:100] - INFO: OFAModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(59457, 768, padding_idx=1)
    (layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
      (layer2): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (3): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
      (layer3): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (3): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (4): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (5): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (6): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (7): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (8): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (9): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (10): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (11): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (12): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (13): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (14): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (15): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (16): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (17): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (18): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (19): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (20): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (21): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (22): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(59457, 768, padding_idx=1)
    (layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (output_projection): Linear(in_features=768, out_features=59457, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2022-04-25 12:06:22 - train.py[line:101] - INFO: task: MNLITask
2022-04-25 12:06:22 - train.py[line:102] - INFO: model: OFAModel
2022-04-25 12:06:22 - train.py[line:103] - INFO: criterion: AdjustLabelSmoothedCrossEntropyCriterion
2022-04-25 12:06:22 - train.py[line:104] - INFO: num. shared model params: 182,275,400 (num. trained: 182,275,400)
2022-04-25 12:06:22 - train.py[line:111] - INFO: num. expert model params: 226676736 (num. trained: 226676736)
local datafile ../../dataset/glue_data/mnli_dev.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/glue_data/mnli_dev.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/glue_data/mnli_dev.tsv slice_id 0 row count 19647 total row count 19647
2022-04-25 12:06:22 - trainer.py[line:110] - INFO: Debugging
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.output_projection.weight
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.downsample.0.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.downsample.0.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.downsample.0.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv1.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv2.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv3.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.0.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.1.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.2.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.3.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.4.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.5.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.0.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.1.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.2.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.3.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.4.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.layers.5.moe_layer.gate.wg.bias
2022-04-25 12:06:22 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.output_projection.bias
2022-04-25 12:06:22 - utils.py[line:759] - INFO: ***********************CUDA enviroments for all 1 workers***********************
2022-04-25 12:06:22 - utils.py[line:761] - INFO: rank   0: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2022-04-25 12:06:22 - utils.py[line:767] - INFO: ***********************CUDA enviroments for all 1 workers***********************
2022-04-25 12:06:22 - train.py[line:142] - INFO: training on 1 devices (GPUs/TPUs)
2022-04-25 12:06:22 - train.py[line:147] - INFO: max tokens per device = None and max sentences per device = 16
2022-04-25 12:06:22 - trainer.py[line:459] - INFO: Preparing to load checkpoint ../../checkpoints/ofa_base.pt
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
self_attn.c_attn
self_attn.k_proj.weight
self_attn.k_proj.bias
self_attn.v_proj.weight
self_attn.v_proj.bias
self_attn.q_proj.weight
self_attn.q_proj.bias
self_attn.out_proj.weight
self_attn.out_proj.bias
self_attn_layer_norm.weight
self_attn_layer_norm.bias
fc1.weight
fc1.bias
fc2.weight
fc2.bias
attn_ln.weight
attn_ln.bias
ffn_layernorm.weight
ffn_layernorm.bias
moe_layer.gate.wg.weight
moe_layer.experts.0.fc1.weight
moe_layer.experts.0.fc1.bias
moe_layer.experts.0.fc2.weight
moe_layer.experts.0.fc2.bias
moe_layer.experts.1.fc1.weight
moe_layer.experts.1.fc1.bias
moe_layer.experts.1.fc2.weight
moe_layer.experts.1.fc2.bias
moe_layer.experts.2.fc1.weight
moe_layer.experts.2.fc1.bias
moe_layer.experts.2.fc2.weight
moe_layer.experts.2.fc2.bias
moe_layer.experts.3.fc1.weight
moe_layer.experts.3.fc1.bias
moe_layer.experts.3.fc2.weight
moe_layer.experts.3.fc2.bias
final_layer_norm.weight
final_layer_norm.bias
2022-04-25 12:06:27 - adam.py[line:68] - INFO: using FusedAdam
2022-04-25 12:06:27 - trainer.py[line:618] - INFO: Loaded checkpoint ../../checkpoints/ofa_base.pt (epoch 48 @ 0 updates)
2022-04-25 12:06:27 - trainer.py[line:640] - INFO: loading train data for epoch 1
local datafile ../../dataset/glue_data/mnli_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/glue_data/mnli_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/glue_data/mnli_train.tsv slice_id 0 row count 392702 total row count 392702
slice_id 0 seek offset 0
Total steps 30680, warmup steps 1840, warmup_factor 0.0005434782608695652
2022-04-25 12:06:28 - trainer.py[line:704] - INFO: begin training epoch 1
2022-04-25 12:06:28 - train.py[line:295] - INFO: Start iterating over samples
2022-04-25 12:07:06 - progress_bar.py[line:272] - INFO: epoch 001:     10 / 6136 loss=2.861, loss_v1=0, loss_v2=0, nll_loss=1.732, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.32, wps=19.7, ups=0.31, wpb=64, bsz=64, num_updates=10, lr=3.80435e-08, gnorm=16.833, loss_scale=16, train_wall=38, gb_free=7.7, wall=44
2022-04-25 12:07:28 - progress_bar.py[line:272] - INFO: epoch 001:     20 / 6136 loss=2.956, loss_v1=0, loss_v2=0, nll_loss=1.827, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.55, wps=28.5, ups=0.45, wpb=64, bsz=64, num_updates=20, lr=7.6087e-08, gnorm=18.078, loss_scale=16, train_wall=22, gb_free=13, wall=66
2022-04-25 12:07:46 - progress_bar.py[line:272] - INFO: epoch 001:     30 / 6136 loss=2.951, loss_v1=0, loss_v2=0, nll_loss=1.824, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.54, wps=35.5, ups=0.56, wpb=64, bsz=64, num_updates=30, lr=1.1413e-07, gnorm=17.875, loss_scale=16, train_wall=18, gb_free=14.1, wall=84
2022-04-25 12:08:00 - progress_bar.py[line:272] - INFO: epoch 001:     40 / 6136 loss=2.969, loss_v1=0, loss_v2=0, nll_loss=1.841, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.58, wps=47.4, ups=0.74, wpb=64, bsz=64, num_updates=40, lr=1.52174e-07, gnorm=19.605, loss_scale=16, train_wall=13, gb_free=13.6, wall=97
2022-04-25 12:08:11 - progress_bar.py[line:272] - INFO: epoch 001:     50 / 6136 loss=2.805, loss_v1=0, loss_v2=0, nll_loss=1.675, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.19, wps=58.3, ups=0.91, wpb=64, bsz=64, num_updates=50, lr=1.90217e-07, gnorm=16.796, loss_scale=16, train_wall=11, gb_free=13.6, wall=108
2022-04-25 12:08:24 - progress_bar.py[line:272] - INFO: epoch 001:     60 / 6136 loss=2.9, loss_v1=0, loss_v2=0, nll_loss=1.77, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.41, wps=47.3, ups=0.74, wpb=64, bsz=64, num_updates=60, lr=2.28261e-07, gnorm=16.553, loss_scale=16, train_wall=13, gb_free=13.4, wall=122
2022-04-25 12:08:35 - progress_bar.py[line:272] - INFO: epoch 001:     70 / 6136 loss=2.98, loss_v1=0, loss_v2=0, nll_loss=1.853, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.61, wps=59.6, ups=0.93, wpb=64, bsz=64, num_updates=70, lr=2.66304e-07, gnorm=18.826, loss_scale=16, train_wall=11, gb_free=12.3, wall=133
2022-04-25 12:08:48 - progress_bar.py[line:272] - INFO: epoch 001:     80 / 6136 loss=2.805, loss_v1=0, loss_v2=0, nll_loss=1.677, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.2, wps=51.4, ups=0.8, wpb=64, bsz=64, num_updates=80, lr=3.04348e-07, gnorm=16.004, loss_scale=16, train_wall=12, gb_free=13.4, wall=145
2022-04-25 12:08:59 - progress_bar.py[line:272] - INFO: epoch 001:     90 / 6136 loss=2.804, loss_v1=0, loss_v2=0, nll_loss=1.677, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.2, wps=56.4, ups=0.88, wpb=64, bsz=64, num_updates=90, lr=3.42391e-07, gnorm=14.463, loss_scale=16, train_wall=11, gb_free=13.7, wall=157
2022-04-25 12:09:11 - trainer.py[line:1304] - WARNING: OOM: Ran out of memory with exception: CUDA out of memory. Tried to allocate 1.54 GiB (GPU 0; 23.70 GiB total capacity; 20.68 GiB already allocated; 1.16 GiB free; 21.43 GiB reserved in total by PyTorch)
2022-04-25 12:09:11 - trainer.py[line:1307] - WARNING: |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 1            |        cudaMalloc retries: 1         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   19607 MB |   21261 MB |    3143 GB |    3124 GB |
|       from large pool |   19567 MB |   21220 MB |    3084 GB |    3065 GB |
|       from small pool |      39 MB |      52 MB |      59 GB |      59 GB |
|---------------------------------------------------------------------------|
| Active memory         |   19607 MB |   21261 MB |    3143 GB |    3124 GB |
|       from large pool |   19567 MB |   21220 MB |    3084 GB |    3065 GB |
|       from small pool |      39 MB |      52 MB |      59 GB |      59 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   21942 MB |   22060 MB |   28418 MB |    6476 MB |
|       from large pool |   21892 MB |   21974 MB |   28300 MB |    6408 MB |
|       from small pool |      50 MB |      86 MB |     118 MB |      68 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  780954 KB |    1589 MB |    2948 GB |    2947 GB |
|       from large pool |  770075 KB |    1569 MB |    2887 GB |    2886 GB |
|       from small pool |   10878 KB |      29 MB |      60 GB |      60 GB |
|---------------------------------------------------------------------------|
| Allocations           |    2425    |    2461    |    1453 K  |    1451 K  |
|       from large pool |     843    |     857    |     728 K  |     727 K  |
|       from small pool |    1582    |    1604    |     725 K  |     723 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2425    |    2461    |    1453 K  |    1451 K  |
|       from large pool |     843    |     857    |     728 K  |     727 K  |
|       from small pool |    1582    |    1604    |     725 K  |     723 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     173    |     193    |     296    |     123    |
|       from large pool |     148    |     150    |     237    |      89    |
|       from small pool |      25    |      43    |      59    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     214    |     214    |     960 K  |     960 K  |
|       from large pool |     133    |     133    |     554 K  |     554 K  |
|       from small pool |      81    |     127    |     406 K  |     406 K  |
|===========================================================================|

2022-04-25 12:09:11 - trainer.py[line:797] - WARNING: attempting to recover from OOM in forward/backward pass
2022-04-25 12:09:13 - progress_bar.py[line:272] - INFO: epoch 001:    101 / 6136 loss=2.779, loss_v1=0, loss_v2=0, nll_loss=1.652, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=3.14, wps=46.5, ups=0.73, wpb=64, bsz=64, num_updates=100, lr=3.80435e-07, gnorm=13.846, loss_scale=16, train_wall=12, gb_free=13.1, wall=170
2022-04-25 12:09:13 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:14:13 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.546 | loss_v1 0 | loss_v2 0 | nll_loss 1.413 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.66 | acc 0.3379 | wps 65.5 | wpb 16 | bsz 16 | num_updates 100
2022-04-25 12:14:23 - progress_bar.py[line:272] - INFO: epoch 001:    111 / 6136 loss=2.62, loss_v1=0, loss_v2=0, nll_loss=1.495, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.82, wps=2.1, ups=0.03, wpb=64, bsz=64, num_updates=110, lr=4.18478e-07, gnorm=10.156, loss_scale=16, train_wall=10, gb_free=11.9, wall=480
2022-04-25 12:14:33 - progress_bar.py[line:272] - INFO: epoch 001:    121 / 6136 loss=2.628, loss_v1=0, loss_v2=0, nll_loss=1.503, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.83, wps=61.1, ups=0.96, wpb=64, bsz=64, num_updates=120, lr=4.56522e-07, gnorm=9.949, loss_scale=16, train_wall=10, gb_free=13.6, wall=491
2022-04-25 12:14:42 - progress_bar.py[line:272] - INFO: epoch 001:    131 / 6136 loss=2.602, loss_v1=0, loss_v2=0, nll_loss=1.478, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.78, wps=71.8, ups=1.12, wpb=64, bsz=64, num_updates=130, lr=4.94565e-07, gnorm=10.71, loss_scale=16, train_wall=9, gb_free=14, wall=500
2022-04-25 12:14:52 - progress_bar.py[line:272] - INFO: epoch 001:    141 / 6136 loss=2.634, loss_v1=0, loss_v2=0, nll_loss=1.512, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.85, wps=66.3, ups=1.04, wpb=64, bsz=64, num_updates=140, lr=5.32609e-07, gnorm=10.858, loss_scale=16, train_wall=10, gb_free=13.5, wall=509
2022-04-25 12:15:00 - progress_bar.py[line:272] - INFO: epoch 001:    151 / 6136 loss=2.563, loss_v1=0, loss_v2=0, nll_loss=1.44, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.71, wps=73.4, ups=1.15, wpb=64, bsz=64, num_updates=150, lr=5.70652e-07, gnorm=8.556, loss_scale=16, train_wall=9, gb_free=13.7, wall=518
2022-04-25 12:15:09 - progress_bar.py[line:272] - INFO: epoch 001:    161 / 6136 loss=2.513, loss_v1=0, loss_v2=0, nll_loss=1.391, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.62, wps=71.2, ups=1.11, wpb=64, bsz=64, num_updates=160, lr=6.08696e-07, gnorm=7.363, loss_scale=16, train_wall=9, gb_free=13.7, wall=527
2022-04-25 12:15:19 - progress_bar.py[line:272] - INFO: epoch 001:    171 / 6136 loss=2.528, loss_v1=0, loss_v2=0, nll_loss=1.408, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.65, wps=66.3, ups=1.04, wpb=64, bsz=64, num_updates=170, lr=6.46739e-07, gnorm=7.989, loss_scale=16, train_wall=10, gb_free=13.5, wall=537
2022-04-25 12:15:29 - progress_bar.py[line:272] - INFO: epoch 001:    181 / 6136 loss=2.48, loss_v1=0, loss_v2=0, nll_loss=1.363, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.57, wps=65.1, ups=1.02, wpb=64, bsz=64, num_updates=180, lr=6.84783e-07, gnorm=7.044, loss_scale=16, train_wall=10, gb_free=13.8, wall=546
2022-04-25 12:15:40 - progress_bar.py[line:272] - INFO: epoch 001:    191 / 6136 loss=2.499, loss_v1=0, loss_v2=0, nll_loss=1.383, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.61, wps=60.6, ups=0.95, wpb=64, bsz=64, num_updates=190, lr=7.22826e-07, gnorm=6.909, loss_scale=16, train_wall=11, gb_free=8.9, wall=557
2022-04-25 12:15:48 - progress_bar.py[line:272] - INFO: epoch 001:    201 / 6136 loss=2.467, loss_v1=0, loss_v2=0, nll_loss=1.352, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.55, wps=71.9, ups=1.12, wpb=64, bsz=64, num_updates=200, lr=7.6087e-07, gnorm=7.314, loss_scale=16, train_wall=9, gb_free=13.1, wall=566
2022-04-25 12:15:48 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:20:06 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.3387 | wps 76.3 | wpb 16 | bsz 16 | num_updates 200
2022-04-25 12:20:15 - progress_bar.py[line:272] - INFO: epoch 001:    211 / 6136 loss=2.437, loss_v1=0, loss_v2=0, nll_loss=1.324, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.5, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=210, lr=7.98913e-07, gnorm=6.528, loss_scale=16, train_wall=9, gb_free=13.4, wall=833
2022-04-25 12:20:24 - progress_bar.py[line:272] - INFO: epoch 001:    221 / 6136 loss=2.376, loss_v1=0, loss_v2=0, nll_loss=1.264, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.4, wps=73.2, ups=1.14, wpb=64, bsz=64, num_updates=220, lr=8.36957e-07, gnorm=6.831, loss_scale=16, train_wall=9, gb_free=13.5, wall=841
2022-04-25 12:20:33 - progress_bar.py[line:272] - INFO: epoch 001:    231 / 6136 loss=2.454, loss_v1=0, loss_v2=0, nll_loss=1.344, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.54, wps=66.4, ups=1.04, wpb=64, bsz=64, num_updates=230, lr=8.75e-07, gnorm=6.19, loss_scale=16, train_wall=10, gb_free=13.1, wall=851
2022-04-25 12:20:42 - progress_bar.py[line:272] - INFO: epoch 001:    241 / 6136 loss=2.426, loss_v1=0, loss_v2=0, nll_loss=1.317, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.49, wps=72, ups=1.13, wpb=64, bsz=64, num_updates=240, lr=9.13043e-07, gnorm=6.66, loss_scale=16, train_wall=9, gb_free=13.3, wall=860
2022-04-25 12:20:51 - progress_bar.py[line:272] - INFO: epoch 001:    251 / 6136 loss=2.407, loss_v1=0, loss_v2=0, nll_loss=1.3, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.46, wps=71.6, ups=1.12, wpb=64, bsz=64, num_updates=250, lr=9.51087e-07, gnorm=5.775, loss_scale=16, train_wall=9, gb_free=14, wall=869
2022-04-25 12:21:02 - progress_bar.py[line:272] - INFO: epoch 001:    261 / 6136 loss=2.412, loss_v1=0, loss_v2=0, nll_loss=1.307, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.47, wps=62, ups=0.97, wpb=64, bsz=64, num_updates=260, lr=9.8913e-07, gnorm=6.549, loss_scale=16, train_wall=10, gb_free=13.8, wall=879
2022-04-25 12:21:11 - progress_bar.py[line:272] - INFO: epoch 001:    271 / 6136 loss=2.375, loss_v1=0, loss_v2=0, nll_loss=1.272, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.42, wps=66.9, ups=1.04, wpb=64, bsz=64, num_updates=270, lr=1.02717e-06, gnorm=5.742, loss_scale=16, train_wall=10, gb_free=13.2, wall=889
2022-04-25 12:21:21 - progress_bar.py[line:272] - INFO: epoch 001:    281 / 6136 loss=2.429, loss_v1=0, loss_v2=0, nll_loss=1.327, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.51, wps=66.9, ups=1.05, wpb=64, bsz=64, num_updates=280, lr=1.06522e-06, gnorm=7.338, loss_scale=16, train_wall=10, gb_free=13.7, wall=898
2022-04-25 12:21:29 - progress_bar.py[line:272] - INFO: epoch 001:    291 / 6136 loss=2.421, loss_v1=0, loss_v2=0, nll_loss=1.322, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.5, wps=75.1, ups=1.17, wpb=64, bsz=64, num_updates=290, lr=1.10326e-06, gnorm=6.037, loss_scale=16, train_wall=8, gb_free=13.6, wall=907
2022-04-25 12:21:38 - progress_bar.py[line:272] - INFO: epoch 001:    301 / 6136 loss=2.304, loss_v1=0, loss_v2=0, nll_loss=1.206, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.31, wps=73.8, ups=1.15, wpb=64, bsz=64, num_updates=300, lr=1.1413e-06, gnorm=4.987, loss_scale=16, train_wall=9, gb_free=13.2, wall=915
2022-04-25 12:21:38 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:25:49 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.3444 | wps 78.2 | wpb 16 | bsz 16 | num_updates 300
2022-04-25 12:25:58 - progress_bar.py[line:272] - INFO: epoch 001:    311 / 6136 loss=2.317, loss_v1=0, loss_v2=0, nll_loss=1.222, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.33, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=310, lr=1.17935e-06, gnorm=4.796, loss_scale=16, train_wall=9, gb_free=12.9, wall=1176
2022-04-25 12:26:08 - progress_bar.py[line:272] - INFO: epoch 001:    321 / 6136 loss=2.338, loss_v1=0, loss_v2=0, nll_loss=1.244, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.37, wps=66, ups=1.03, wpb=64, bsz=64, num_updates=320, lr=1.21739e-06, gnorm=5.824, loss_scale=16, train_wall=10, gb_free=13.3, wall=1185
2022-04-25 12:26:18 - progress_bar.py[line:272] - INFO: epoch 001:    331 / 6136 loss=2.338, loss_v1=0, loss_v2=0, nll_loss=1.247, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.37, wps=66.4, ups=1.04, wpb=64, bsz=64, num_updates=330, lr=1.25543e-06, gnorm=5.099, loss_scale=16, train_wall=10, gb_free=13.2, wall=1195
2022-04-25 12:26:26 - progress_bar.py[line:272] - INFO: epoch 001:    341 / 6136 loss=2.305, loss_v1=0, loss_v2=0, nll_loss=1.216, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.32, wps=72.3, ups=1.13, wpb=64, bsz=64, num_updates=340, lr=1.29348e-06, gnorm=5.729, loss_scale=16, train_wall=9, gb_free=13.5, wall=1204
2022-04-25 12:26:36 - progress_bar.py[line:272] - INFO: epoch 001:    351 / 6136 loss=2.304, loss_v1=0, loss_v2=0, nll_loss=1.218, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.33, wps=65.9, ups=1.03, wpb=64, bsz=64, num_updates=350, lr=1.33152e-06, gnorm=5.293, loss_scale=16, train_wall=10, gb_free=13.1, wall=1214
2022-04-25 12:26:45 - progress_bar.py[line:272] - INFO: epoch 001:    361 / 6136 loss=2.306, loss_v1=0, loss_v2=0, nll_loss=1.222, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.33, wps=74.4, ups=1.16, wpb=64, bsz=64, num_updates=360, lr=1.36957e-06, gnorm=5.433, loss_scale=16, train_wall=9, gb_free=12.8, wall=1222
2022-04-25 12:26:54 - progress_bar.py[line:272] - INFO: epoch 001:    371 / 6136 loss=2.327, loss_v1=0, loss_v2=0, nll_loss=1.245, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.37, wps=71.9, ups=1.12, wpb=64, bsz=64, num_updates=370, lr=1.40761e-06, gnorm=5.85, loss_scale=16, train_wall=9, gb_free=11.5, wall=1231
2022-04-25 12:27:02 - progress_bar.py[line:272] - INFO: epoch 001:    381 / 6136 loss=2.305, loss_v1=0, loss_v2=0, nll_loss=1.225, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.34, wps=73.7, ups=1.15, wpb=64, bsz=64, num_updates=380, lr=1.44565e-06, gnorm=5.615, loss_scale=16, train_wall=9, gb_free=13.5, wall=1240
2022-04-25 12:27:11 - progress_bar.py[line:272] - INFO: epoch 001:    391 / 6136 loss=2.263, loss_v1=0, loss_v2=0, nll_loss=1.186, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.28, wps=72.3, ups=1.13, wpb=64, bsz=64, num_updates=390, lr=1.4837e-06, gnorm=4.994, loss_scale=16, train_wall=9, gb_free=7.7, wall=1249
2022-04-25 12:27:21 - progress_bar.py[line:272] - INFO: epoch 001:    401 / 6136 loss=2.354, loss_v1=0, loss_v2=0, nll_loss=1.28, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.43, wps=66.7, ups=1.04, wpb=64, bsz=64, num_updates=400, lr=1.52174e-06, gnorm=6.047, loss_scale=16, train_wall=10, gb_free=13.7, wall=1258
2022-04-25 12:27:21 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:31:32 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.346 | wps 78.2 | wpb 16 | bsz 16 | num_updates 400
2022-04-25 12:31:41 - progress_bar.py[line:272] - INFO: epoch 001:    411 / 6136 loss=2.29, loss_v1=0, loss_v2=0, nll_loss=1.217, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.33, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=410, lr=1.55978e-06, gnorm=5.801, loss_scale=16, train_wall=9, gb_free=13.5, wall=1519
2022-04-25 12:31:51 - progress_bar.py[line:272] - INFO: epoch 001:    421 / 6136 loss=2.249, loss_v1=0, loss_v2=0, nll_loss=1.179, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.26, wps=64.6, ups=1.01, wpb=64, bsz=64, num_updates=420, lr=1.59783e-06, gnorm=5.39, loss_scale=16, train_wall=10, gb_free=13.7, wall=1529
2022-04-25 12:32:00 - progress_bar.py[line:272] - INFO: epoch 001:    431 / 6136 loss=2.28, loss_v1=0, loss_v2=0, nll_loss=1.213, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.32, wps=74.5, ups=1.16, wpb=64, bsz=64, num_updates=430, lr=1.63587e-06, gnorm=4.753, loss_scale=16, train_wall=9, gb_free=14.1, wall=1537
2022-04-25 12:32:11 - progress_bar.py[line:272] - INFO: epoch 001:    441 / 6136 loss=2.252, loss_v1=0, loss_v2=0, nll_loss=1.188, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.28, wps=59.6, ups=0.93, wpb=64, bsz=64, num_updates=440, lr=1.67391e-06, gnorm=5.99, loss_scale=16, train_wall=11, gb_free=12.7, wall=1548
2022-04-25 12:32:19 - progress_bar.py[line:272] - INFO: epoch 001:    451 / 6136 loss=2.252, loss_v1=0, loss_v2=0, nll_loss=1.189, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.28, wps=73.1, ups=1.14, wpb=64, bsz=64, num_updates=450, lr=1.71196e-06, gnorm=5.448, loss_scale=16, train_wall=9, gb_free=13.5, wall=1557
2022-04-25 12:32:29 - progress_bar.py[line:272] - INFO: epoch 001:    461 / 6136 loss=2.236, loss_v1=0, loss_v2=0, nll_loss=1.177, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.26, wps=65.3, ups=1.02, wpb=64, bsz=64, num_updates=460, lr=1.75e-06, gnorm=5.589, loss_scale=16, train_wall=10, gb_free=13.2, wall=1567
2022-04-25 12:32:38 - progress_bar.py[line:272] - INFO: epoch 001:    471 / 6136 loss=2.257, loss_v1=0, loss_v2=0, nll_loss=1.2, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.3, wps=75.6, ups=1.18, wpb=64, bsz=64, num_updates=470, lr=1.78804e-06, gnorm=4.143, loss_scale=16, train_wall=8, gb_free=13.7, wall=1575
2022-04-25 12:32:46 - progress_bar.py[line:272] - INFO: epoch 001:    481 / 6136 loss=2.258, loss_v1=0, loss_v2=0, nll_loss=1.202, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.3, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=480, lr=1.82609e-06, gnorm=4.901, loss_scale=16, train_wall=8, gb_free=14, wall=1584
2022-04-25 12:32:55 - progress_bar.py[line:272] - INFO: epoch 001:    491 / 6136 loss=2.227, loss_v1=0, loss_v2=0, nll_loss=1.174, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.26, wps=70.2, ups=1.1, wpb=64, bsz=64, num_updates=490, lr=1.86413e-06, gnorm=4.402, loss_scale=16, train_wall=9, gb_free=13, wall=1593
2022-04-25 12:33:04 - progress_bar.py[line:272] - INFO: epoch 001:    501 / 6136 loss=2.24, loss_v1=0, loss_v2=0, nll_loss=1.19, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.28, wps=70.9, ups=1.11, wpb=64, bsz=64, num_updates=500, lr=1.90217e-06, gnorm=4.869, loss_scale=16, train_wall=9, gb_free=12.8, wall=1602
2022-04-25 12:33:04 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:37:11 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.21 | loss_v1 0 | loss_v2 0 | nll_loss 1.16 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.23 | acc 0.3444 | wps 79.5 | wpb 16 | bsz 16 | num_updates 500
2022-04-25 12:37:20 - progress_bar.py[line:272] - INFO: epoch 001:    511 / 6136 loss=2.266, loss_v1=0, loss_v2=0, nll_loss=1.218, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.33, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=510, lr=1.94022e-06, gnorm=24.36, loss_scale=16, train_wall=8, gb_free=13.3, wall=1858
2022-04-25 12:37:30 - progress_bar.py[line:272] - INFO: epoch 001:    521 / 6136 loss=2.234, loss_v1=0, loss_v2=0, nll_loss=1.188, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.28, wps=62.4, ups=0.98, wpb=64, bsz=64, num_updates=520, lr=1.97826e-06, gnorm=4.117, loss_scale=32, train_wall=10, gb_free=13.4, wall=1868
2022-04-25 12:37:39 - progress_bar.py[line:272] - INFO: epoch 001:    531 / 6136 loss=2.246, loss_v1=0, loss_v2=0, nll_loss=1.202, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.3, wps=72.4, ups=1.13, wpb=64, bsz=64, num_updates=530, lr=2.0163e-06, gnorm=4.998, loss_scale=32, train_wall=9, gb_free=13.1, wall=1877
2022-04-25 12:37:48 - progress_bar.py[line:272] - INFO: epoch 001:    541 / 6136 loss=2.223, loss_v1=0, loss_v2=0, nll_loss=1.182, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.27, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=540, lr=2.05435e-06, gnorm=5.153, loss_scale=32, train_wall=8, gb_free=12, wall=1885
2022-04-25 12:37:56 - progress_bar.py[line:272] - INFO: epoch 001:    551 / 6136 loss=2.246, loss_v1=0, loss_v2=0, nll_loss=1.206, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.31, wps=74.8, ups=1.17, wpb=64, bsz=64, num_updates=550, lr=2.09239e-06, gnorm=3.904, loss_scale=32, train_wall=8, gb_free=13.9, wall=1894
2022-04-25 12:38:05 - progress_bar.py[line:272] - INFO: epoch 001:    561 / 6136 loss=2.184, loss_v1=0, loss_v2=0, nll_loss=1.146, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.21, wps=73.3, ups=1.14, wpb=64, bsz=64, num_updates=560, lr=2.13043e-06, gnorm=4.435, loss_scale=32, train_wall=9, gb_free=13.4, wall=1902
2022-04-25 12:38:14 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-04-25 12:38:15 - progress_bar.py[line:272] - INFO: epoch 001:    572 / 6136 loss=2.202, loss_v1=0, loss_v2=0, nll_loss=1.166, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.24, wps=62.6, ups=0.98, wpb=64, bsz=64, num_updates=570, lr=2.16848e-06, gnorm=4.508, loss_scale=16, train_wall=10, gb_free=10.9, wall=1913
2022-04-25 12:38:25 - progress_bar.py[line:272] - INFO: epoch 001:    582 / 6136 loss=2.251, loss_v1=0, loss_v2=0, nll_loss=1.216, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.32, wps=68.4, ups=1.07, wpb=64, bsz=64, num_updates=580, lr=2.20652e-06, gnorm=4.426, loss_scale=16, train_wall=9, gb_free=12.7, wall=1922
2022-04-25 12:38:34 - progress_bar.py[line:272] - INFO: epoch 001:    592 / 6136 loss=2.212, loss_v1=0, loss_v2=0, nll_loss=1.179, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.26, wps=68, ups=1.06, wpb=64, bsz=64, num_updates=590, lr=2.24457e-06, gnorm=4.401, loss_scale=16, train_wall=9, gb_free=13, wall=1931
2022-04-25 12:38:42 - progress_bar.py[line:272] - INFO: epoch 001:    602 / 6136 loss=2.235, loss_v1=0, loss_v2=0, nll_loss=1.204, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.3, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=600, lr=2.28261e-06, gnorm=5.211, loss_scale=16, train_wall=8, gb_free=11.6, wall=1940
2022-04-25 12:38:42 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:42:58 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.181 | loss_v1 0 | loss_v2 0 | nll_loss 1.15 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.22 | acc 0.3526 | wps 76.8 | wpb 16 | bsz 16 | num_updates 600
2022-04-25 12:43:08 - progress_bar.py[line:272] - INFO: epoch 001:    612 / 6136 loss=2.195, loss_v1=0, loss_v2=0, nll_loss=1.166, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.24, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=610, lr=2.32065e-06, gnorm=4.37, loss_scale=16, train_wall=9, gb_free=13.6, wall=2205
2022-04-25 12:43:16 - progress_bar.py[line:272] - INFO: epoch 001:    622 / 6136 loss=2.21, loss_v1=0, loss_v2=0, nll_loss=1.182, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.27, wps=76.4, ups=1.19, wpb=64, bsz=64, num_updates=620, lr=2.3587e-06, gnorm=3.803, loss_scale=16, train_wall=8, gb_free=14, wall=2214
2022-04-25 12:43:25 - progress_bar.py[line:272] - INFO: epoch 001:    632 / 6136 loss=2.154, loss_v1=0, loss_v2=0, nll_loss=1.127, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=74.6, ups=1.17, wpb=64, bsz=64, num_updates=630, lr=2.39674e-06, gnorm=4.25, loss_scale=16, train_wall=9, gb_free=13, wall=2222
2022-04-25 12:43:33 - progress_bar.py[line:272] - INFO: epoch 001:    642 / 6136 loss=2.162, loss_v1=0, loss_v2=0, nll_loss=1.137, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=640, lr=2.43478e-06, gnorm=3.983, loss_scale=16, train_wall=8, gb_free=13.8, wall=2231
2022-04-25 12:43:41 - progress_bar.py[line:272] - INFO: epoch 001:    652 / 6136 loss=2.183, loss_v1=0, loss_v2=0, nll_loss=1.159, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.23, wps=78.4, ups=1.23, wpb=64, bsz=64, num_updates=650, lr=2.47283e-06, gnorm=4.346, loss_scale=16, train_wall=8, gb_free=13.2, wall=2239
2022-04-25 12:43:50 - progress_bar.py[line:272] - INFO: epoch 001:    662 / 6136 loss=2.211, loss_v1=0, loss_v2=0, nll_loss=1.189, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.28, wps=77, ups=1.2, wpb=64, bsz=64, num_updates=660, lr=2.51087e-06, gnorm=3.835, loss_scale=16, train_wall=8, gb_free=14.1, wall=2247
2022-04-25 12:43:58 - progress_bar.py[line:272] - INFO: epoch 001:    672 / 6136 loss=2.171, loss_v1=0, loss_v2=0, nll_loss=1.151, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.22, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=670, lr=2.54891e-06, gnorm=4.094, loss_scale=16, train_wall=8, gb_free=13.8, wall=2256
2022-04-25 12:44:06 - progress_bar.py[line:272] - INFO: epoch 001:    682 / 6136 loss=2.167, loss_v1=0, loss_v2=0, nll_loss=1.148, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.22, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=680, lr=2.58696e-06, gnorm=4.093, loss_scale=16, train_wall=8, gb_free=12.7, wall=2264
2022-04-25 12:44:15 - progress_bar.py[line:272] - INFO: epoch 001:    692 / 6136 loss=2.183, loss_v1=0, loss_v2=0, nll_loss=1.165, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.24, wps=71.9, ups=1.12, wpb=64, bsz=64, num_updates=690, lr=2.625e-06, gnorm=4.472, loss_scale=16, train_wall=9, gb_free=13.3, wall=2273
2022-04-25 12:44:26 - progress_bar.py[line:272] - INFO: epoch 001:    702 / 6136 loss=2.194, loss_v1=0, loss_v2=0, nll_loss=1.177, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.26, wps=58.8, ups=0.92, wpb=64, bsz=64, num_updates=700, lr=2.66304e-06, gnorm=3.915, loss_scale=16, train_wall=11, gb_free=13.4, wall=2284
2022-04-25 12:44:26 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:48:31 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.172 | loss_v1 0 | loss_v2 0 | nll_loss 1.154 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.23 | acc 0.3434 | wps 80.4 | wpb 16 | bsz 16 | num_updates 700
2022-04-25 12:48:39 - progress_bar.py[line:272] - INFO: epoch 001:    712 / 6136 loss=2.165, loss_v1=0, loss_v2=0, nll_loss=1.149, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.22, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=710, lr=2.70109e-06, gnorm=3.89, loss_scale=16, train_wall=8, gb_free=13.5, wall=2537
2022-04-25 12:48:48 - progress_bar.py[line:272] - INFO: epoch 001:    722 / 6136 loss=2.194, loss_v1=0, loss_v2=0, nll_loss=1.179, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.26, wps=75.1, ups=1.17, wpb=64, bsz=64, num_updates=720, lr=2.73913e-06, gnorm=4.687, loss_scale=16, train_wall=8, gb_free=12.6, wall=2545
2022-04-25 12:48:51 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-04-25 12:48:57 - progress_bar.py[line:272] - INFO: epoch 001:    733 / 6136 loss=2.152, loss_v1=0, loss_v2=0, nll_loss=1.138, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=68.9, ups=1.08, wpb=64, bsz=64, num_updates=730, lr=2.77717e-06, gnorm=3.142, loss_scale=8, train_wall=9, gb_free=14, wall=2555
2022-04-25 12:49:06 - progress_bar.py[line:272] - INFO: epoch 001:    743 / 6136 loss=2.127, loss_v1=0, loss_v2=0, nll_loss=1.114, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=68.5, ups=1.07, wpb=64, bsz=64, num_updates=740, lr=2.81522e-06, gnorm=4.449, loss_scale=8, train_wall=9, gb_free=12, wall=2564
2022-04-25 12:49:15 - progress_bar.py[line:272] - INFO: epoch 001:    753 / 6136 loss=2.141, loss_v1=0, loss_v2=0, nll_loss=1.129, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=74.9, ups=1.17, wpb=64, bsz=64, num_updates=750, lr=2.85326e-06, gnorm=4.258, loss_scale=8, train_wall=8, gb_free=13.4, wall=2572
2022-04-25 12:49:24 - progress_bar.py[line:272] - INFO: epoch 001:    763 / 6136 loss=2.172, loss_v1=0, loss_v2=0, nll_loss=1.161, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.24, wps=69.5, ups=1.09, wpb=64, bsz=64, num_updates=760, lr=2.8913e-06, gnorm=3.935, loss_scale=8, train_wall=9, gb_free=13.5, wall=2582
2022-04-25 12:49:33 - progress_bar.py[line:272] - INFO: epoch 001:    773 / 6136 loss=2.168, loss_v1=0, loss_v2=0, nll_loss=1.158, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.23, wps=70.2, ups=1.1, wpb=64, bsz=64, num_updates=770, lr=2.92935e-06, gnorm=3.774, loss_scale=8, train_wall=9, gb_free=13.9, wall=2591
2022-04-25 12:49:42 - progress_bar.py[line:272] - INFO: epoch 001:    783 / 6136 loss=2.162, loss_v1=0, loss_v2=0, nll_loss=1.153, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.22, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=780, lr=2.96739e-06, gnorm=4.054, loss_scale=8, train_wall=8, gb_free=13.1, wall=2599
2022-04-25 12:49:50 - progress_bar.py[line:272] - INFO: epoch 001:    793 / 6136 loss=2.148, loss_v1=0, loss_v2=0, nll_loss=1.14, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=76.9, ups=1.2, wpb=64, bsz=64, num_updates=790, lr=3.00543e-06, gnorm=3.793, loss_scale=8, train_wall=8, gb_free=13.8, wall=2608
2022-04-25 12:49:59 - progress_bar.py[line:272] - INFO: epoch 001:    803 / 6136 loss=2.134, loss_v1=0, loss_v2=0, nll_loss=1.126, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=74.4, ups=1.16, wpb=64, bsz=64, num_updates=800, lr=3.04348e-06, gnorm=3.96, loss_scale=8, train_wall=9, gb_free=13.3, wall=2616
2022-04-25 12:49:59 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:54:00 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.149 | loss_v1 0 | loss_v2 0 | nll_loss 1.14 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.2 | acc 0.3515 | wps 81.4 | wpb 16 | bsz 16 | num_updates 800
2022-04-25 12:54:09 - progress_bar.py[line:272] - INFO: epoch 001:    813 / 6136 loss=2.143, loss_v1=0, loss_v2=0, nll_loss=1.136, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=810, lr=3.08152e-06, gnorm=3.78, loss_scale=8, train_wall=9, gb_free=13.7, wall=2866
2022-04-25 12:54:17 - progress_bar.py[line:272] - INFO: epoch 001:    823 / 6136 loss=2.136, loss_v1=0, loss_v2=0, nll_loss=1.13, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=76.9, ups=1.2, wpb=64, bsz=64, num_updates=820, lr=3.11957e-06, gnorm=4.45, loss_scale=8, train_wall=8, gb_free=13.8, wall=2875
2022-04-25 12:54:26 - progress_bar.py[line:272] - INFO: epoch 001:    833 / 6136 loss=2.147, loss_v1=0, loss_v2=0, nll_loss=1.141, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=830, lr=3.15761e-06, gnorm=19.899, loss_scale=8, train_wall=8, gb_free=9.4, wall=2883
2022-04-25 12:54:34 - progress_bar.py[line:272] - INFO: epoch 001:    843 / 6136 loss=2.144, loss_v1=0, loss_v2=0, nll_loss=1.138, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=840, lr=3.19565e-06, gnorm=3.927, loss_scale=8, train_wall=8, gb_free=13.7, wall=2892
2022-04-25 12:54:43 - progress_bar.py[line:272] - INFO: epoch 001:    853 / 6136 loss=2.148, loss_v1=0, loss_v2=0, nll_loss=1.143, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.21, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=850, lr=3.2337e-06, gnorm=3.889, loss_scale=8, train_wall=8, gb_free=13.4, wall=2900
2022-04-25 12:54:51 - progress_bar.py[line:272] - INFO: epoch 001:    863 / 6136 loss=2.162, loss_v1=0, loss_v2=0, nll_loss=1.158, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.23, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=860, lr=3.27174e-06, gnorm=4.649, loss_scale=8, train_wall=8, gb_free=13.2, wall=2908
2022-04-25 12:54:59 - progress_bar.py[line:272] - INFO: epoch 001:    873 / 6136 loss=2.116, loss_v1=0, loss_v2=0, nll_loss=1.111, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=75.5, ups=1.18, wpb=64, bsz=64, num_updates=870, lr=3.30978e-06, gnorm=3.536, loss_scale=8, train_wall=8, gb_free=13.6, wall=2917
2022-04-25 12:55:08 - progress_bar.py[line:272] - INFO: epoch 001:    883 / 6136 loss=2.133, loss_v1=0, loss_v2=0, nll_loss=1.129, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=74, ups=1.16, wpb=64, bsz=64, num_updates=880, lr=3.34783e-06, gnorm=3.559, loss_scale=8, train_wall=9, gb_free=13.2, wall=2925
2022-04-25 12:55:17 - progress_bar.py[line:272] - INFO: epoch 001:    893 / 6136 loss=2.157, loss_v1=0, loss_v2=0, nll_loss=1.153, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.22, wps=72.9, ups=1.14, wpb=64, bsz=64, num_updates=890, lr=3.38587e-06, gnorm=3.912, loss_scale=8, train_wall=9, gb_free=13.4, wall=2934
2022-04-25 12:55:20 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4.0
2022-04-25 12:55:27 - progress_bar.py[line:272] - INFO: epoch 001:    904 / 6136 loss=2.126, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=62.6, ups=0.98, wpb=64, bsz=64, num_updates=900, lr=3.42391e-06, gnorm=2.736, loss_scale=4, train_wall=10, gb_free=13.2, wall=2944
2022-04-25 12:55:27 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 12:59:41 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.136 | loss_v1 0 | loss_v2 0 | nll_loss 1.13 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.19 | acc 0.3636 | wps 77.3 | wpb 16 | bsz 16 | num_updates 900
2022-04-25 12:59:51 - progress_bar.py[line:272] - INFO: epoch 001:    914 / 6136 loss=2.144, loss_v1=0, loss_v2=0, nll_loss=1.141, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.21, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=910, lr=3.46196e-06, gnorm=3.358, loss_scale=4, train_wall=10, gb_free=13.8, wall=3208
2022-04-25 13:00:00 - progress_bar.py[line:272] - INFO: epoch 001:    924 / 6136 loss=2.146, loss_v1=0, loss_v2=0, nll_loss=1.143, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.21, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=920, lr=3.5e-06, gnorm=4.013, loss_scale=4, train_wall=9, gb_free=13.5, wall=3217
2022-04-25 13:00:08 - progress_bar.py[line:272] - INFO: epoch 001:    934 / 6136 loss=2.11, loss_v1=0, loss_v2=0, nll_loss=1.108, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.15, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=930, lr=3.53804e-06, gnorm=2.996, loss_scale=4, train_wall=8, gb_free=13.4, wall=3225
2022-04-25 13:00:16 - progress_bar.py[line:272] - INFO: epoch 001:    944 / 6136 loss=2.138, loss_v1=0, loss_v2=0, nll_loss=1.136, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=940, lr=3.57609e-06, gnorm=4.577, loss_scale=4, train_wall=8, gb_free=13.8, wall=3234
2022-04-25 13:00:26 - progress_bar.py[line:272] - INFO: epoch 001:    954 / 6136 loss=2.132, loss_v1=0, loss_v2=0, nll_loss=1.13, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=66.4, ups=1.04, wpb=64, bsz=64, num_updates=950, lr=3.61413e-06, gnorm=3.622, loss_scale=4, train_wall=10, gb_free=13.3, wall=3243
2022-04-25 13:00:34 - progress_bar.py[line:272] - INFO: epoch 001:    964 / 6136 loss=2.148, loss_v1=0, loss_v2=0, nll_loss=1.146, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.21, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=960, lr=3.65217e-06, gnorm=3.62, loss_scale=4, train_wall=8, gb_free=13.5, wall=3252
2022-04-25 13:00:43 - progress_bar.py[line:272] - INFO: epoch 001:    974 / 6136 loss=2.152, loss_v1=0, loss_v2=0, nll_loss=1.15, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.22, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=970, lr=3.69022e-06, gnorm=3.719, loss_scale=4, train_wall=8, gb_free=12.6, wall=3260
2022-04-25 13:00:52 - progress_bar.py[line:272] - INFO: epoch 001:    984 / 6136 loss=2.135, loss_v1=0, loss_v2=0, nll_loss=1.133, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=67.9, ups=1.06, wpb=64, bsz=64, num_updates=980, lr=3.72826e-06, gnorm=3.756, loss_scale=4, train_wall=9, gb_free=13.5, wall=3269
2022-04-25 13:01:01 - progress_bar.py[line:272] - INFO: epoch 001:    994 / 6136 loss=2.125, loss_v1=0, loss_v2=0, nll_loss=1.123, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=69.8, ups=1.09, wpb=64, bsz=64, num_updates=990, lr=3.7663e-06, gnorm=2.797, loss_scale=4, train_wall=9, gb_free=13.3, wall=3279
2022-04-25 13:01:10 - progress_bar.py[line:272] - INFO: epoch 001:   1004 / 6136 loss=2.129, loss_v1=0, loss_v2=0, nll_loss=1.127, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=73.5, ups=1.15, wpb=64, bsz=64, num_updates=1000, lr=3.80435e-06, gnorm=3.327, loss_scale=4, train_wall=9, gb_free=13.5, wall=3287
2022-04-25 13:01:10 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:05:16 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.3621 | wps 79.9 | wpb 16 | bsz 16 | num_updates 1000
2022-04-25 13:05:16 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 1000 updates
2022-04-25 13:05:16 - trainer.py[line:432] - INFO: Saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_1000.pt
2022-04-25 13:05:28 - trainer.py[line:442] - INFO: Finished saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_1000.pt
2022-04-25 13:05:38 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_1000.pt (epoch 1 @ 1000 updates, score 0.3621) (writing took 22.303188766818494 seconds)
2022-04-25 13:05:47 - progress_bar.py[line:272] - INFO: epoch 001:   1014 / 6136 loss=2.114, loss_v1=0, loss_v2=0, nll_loss=1.113, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=2.3, ups=0.04, wpb=64, bsz=64, num_updates=1010, lr=3.84239e-06, gnorm=3.371, loss_scale=4, train_wall=9, gb_free=13.7, wall=3565
2022-04-25 13:05:56 - progress_bar.py[line:272] - INFO: epoch 001:   1024 / 6136 loss=2.125, loss_v1=0, loss_v2=0, nll_loss=1.123, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=1020, lr=3.88043e-06, gnorm=4.078, loss_scale=4, train_wall=9, gb_free=13.9, wall=3573
2022-04-25 13:06:04 - progress_bar.py[line:272] - INFO: epoch 001:   1034 / 6136 loss=2.127, loss_v1=0, loss_v2=0, nll_loss=1.126, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=1030, lr=3.91848e-06, gnorm=3.289, loss_scale=4, train_wall=8, gb_free=13.1, wall=3582
2022-04-25 13:06:12 - progress_bar.py[line:272] - INFO: epoch 001:   1044 / 6136 loss=2.138, loss_v1=0, loss_v2=0, nll_loss=1.137, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=1040, lr=3.95652e-06, gnorm=3.64, loss_scale=4, train_wall=8, gb_free=13.9, wall=3590
2022-04-25 13:06:21 - progress_bar.py[line:272] - INFO: epoch 001:   1054 / 6136 loss=2.145, loss_v1=0, loss_v2=0, nll_loss=1.143, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.21, wps=78.7, ups=1.23, wpb=64, bsz=64, num_updates=1050, lr=3.99457e-06, gnorm=3.781, loss_scale=4, train_wall=8, gb_free=12.8, wall=3598
2022-04-25 13:06:29 - progress_bar.py[line:272] - INFO: epoch 001:   1064 / 6136 loss=2.15, loss_v1=0, loss_v2=0, nll_loss=1.149, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.22, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=1060, lr=4.03261e-06, gnorm=3.102, loss_scale=4, train_wall=8, gb_free=13.3, wall=3606
2022-04-25 13:06:37 - progress_bar.py[line:272] - INFO: epoch 001:   1074 / 6136 loss=2.128, loss_v1=0, loss_v2=0, nll_loss=1.127, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=1070, lr=4.07065e-06, gnorm=2.991, loss_scale=4, train_wall=8, gb_free=13, wall=3615
2022-04-25 13:06:47 - progress_bar.py[line:272] - INFO: epoch 001:   1084 / 6136 loss=2.107, loss_v1=0, loss_v2=0, nll_loss=1.105, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.15, wps=70.1, ups=1.09, wpb=64, bsz=64, num_updates=1080, lr=4.1087e-06, gnorm=3.529, loss_scale=4, train_wall=9, gb_free=13.4, wall=3624
2022-04-25 13:06:56 - progress_bar.py[line:272] - INFO: epoch 001:   1094 / 6136 loss=2.126, loss_v1=0, loss_v2=0, nll_loss=1.125, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=68.3, ups=1.07, wpb=64, bsz=64, num_updates=1090, lr=4.14674e-06, gnorm=3.594, loss_scale=4, train_wall=9, gb_free=13.7, wall=3633
2022-04-25 13:07:04 - progress_bar.py[line:272] - INFO: epoch 001:   1104 / 6136 loss=2.137, loss_v1=0, loss_v2=0, nll_loss=1.135, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=1100, lr=4.18478e-06, gnorm=3.201, loss_scale=4, train_wall=8, gb_free=13.6, wall=3642
2022-04-25 13:07:04 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:11:12 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.115 | loss_v1 0 | loss_v2 0 | nll_loss 1.111 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.16 | acc 0.3617 | wps 79.5 | wpb 16 | bsz 16 | num_updates 1100 | best_acc 0.3621
2022-04-25 13:11:20 - progress_bar.py[line:272] - INFO: epoch 001:   1114 / 6136 loss=2.128, loss_v1=0, loss_v2=0, nll_loss=1.126, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=1110, lr=4.22283e-06, gnorm=3.507, loss_scale=4, train_wall=9, gb_free=13.1, wall=3898
2022-04-25 13:11:29 - progress_bar.py[line:272] - INFO: epoch 001:   1124 / 6136 loss=2.131, loss_v1=0, loss_v2=0, nll_loss=1.13, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=1120, lr=4.26087e-06, gnorm=3.441, loss_scale=4, train_wall=8, gb_free=13.7, wall=3906
2022-04-25 13:11:37 - progress_bar.py[line:272] - INFO: epoch 001:   1134 / 6136 loss=2.135, loss_v1=0, loss_v2=0, nll_loss=1.134, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=1130, lr=4.29891e-06, gnorm=3.143, loss_scale=4, train_wall=8, gb_free=12.5, wall=3915
2022-04-25 13:11:46 - progress_bar.py[line:272] - INFO: epoch 001:   1144 / 6136 loss=2.137, loss_v1=0, loss_v2=0, nll_loss=1.136, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=1140, lr=4.33696e-06, gnorm=2.95, loss_scale=4, train_wall=8, gb_free=13.4, wall=3923
2022-04-25 13:11:54 - progress_bar.py[line:272] - INFO: epoch 001:   1154 / 6136 loss=2.11, loss_v1=0, loss_v2=0, nll_loss=1.109, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=1150, lr=4.375e-06, gnorm=3.308, loss_scale=4, train_wall=8, gb_free=13.8, wall=3932
2022-04-25 13:12:02 - progress_bar.py[line:272] - INFO: epoch 001:   1164 / 6136 loss=2.129, loss_v1=0, loss_v2=0, nll_loss=1.128, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=77, ups=1.2, wpb=64, bsz=64, num_updates=1160, lr=4.41304e-06, gnorm=3.272, loss_scale=4, train_wall=8, gb_free=12.6, wall=3940
2022-04-25 13:12:11 - progress_bar.py[line:272] - INFO: epoch 001:   1174 / 6136 loss=2.139, loss_v1=0, loss_v2=0, nll_loss=1.137, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.2, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=1170, lr=4.45109e-06, gnorm=3.313, loss_scale=4, train_wall=8, gb_free=13.9, wall=3948
2022-04-25 13:12:21 - progress_bar.py[line:272] - INFO: epoch 001:   1184 / 6136 loss=2.134, loss_v1=0, loss_v2=0, nll_loss=1.132, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=65.3, ups=1.02, wpb=64, bsz=64, num_updates=1180, lr=4.48913e-06, gnorm=3.953, loss_scale=4, train_wall=10, gb_free=14.1, wall=3958
2022-04-25 13:12:29 - progress_bar.py[line:272] - INFO: epoch 001:   1194 / 6136 loss=2.118, loss_v1=0, loss_v2=0, nll_loss=1.117, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=1190, lr=4.52717e-06, gnorm=3.338, loss_scale=4, train_wall=8, gb_free=13.5, wall=3967
2022-04-25 13:12:37 - progress_bar.py[line:272] - INFO: epoch 001:   1204 / 6136 loss=2.112, loss_v1=0, loss_v2=0, nll_loss=1.111, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=1200, lr=4.56522e-06, gnorm=3.404, loss_scale=4, train_wall=8, gb_free=11.4, wall=3975
2022-04-25 13:12:37 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:16:40 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.125 | loss_v1 0 | loss_v2 0 | nll_loss 1.122 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.18 | acc 0.3744 | wps 81 | wpb 16 | bsz 16 | num_updates 1200 | best_acc 0.3744
2022-04-25 13:16:49 - progress_bar.py[line:272] - INFO: epoch 001:   1214 / 6136 loss=2.113, loss_v1=0, loss_v2=0, nll_loss=1.112, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=1210, lr=4.60326e-06, gnorm=3.173, loss_scale=4, train_wall=9, gb_free=13.5, wall=4227
2022-04-25 13:16:58 - progress_bar.py[line:272] - INFO: epoch 001:   1224 / 6136 loss=2.123, loss_v1=0, loss_v2=0, nll_loss=1.121, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=1220, lr=4.6413e-06, gnorm=3.583, loss_scale=4, train_wall=9, gb_free=12, wall=4235
2022-04-25 13:17:06 - progress_bar.py[line:272] - INFO: epoch 001:   1234 / 6136 loss=2.107, loss_v1=0, loss_v2=0, nll_loss=1.106, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.15, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=1230, lr=4.67935e-06, gnorm=3.053, loss_scale=4, train_wall=8, gb_free=13.8, wall=4243
2022-04-25 13:17:15 - progress_bar.py[line:272] - INFO: epoch 001:   1244 / 6136 loss=2.131, loss_v1=0, loss_v2=0, nll_loss=1.13, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=69, ups=1.08, wpb=64, bsz=64, num_updates=1240, lr=4.71739e-06, gnorm=3.478, loss_scale=4, train_wall=9, gb_free=13.5, wall=4253
2022-04-25 13:17:24 - progress_bar.py[line:272] - INFO: epoch 001:   1254 / 6136 loss=2.133, loss_v1=0, loss_v2=0, nll_loss=1.131, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.19, wps=75.2, ups=1.17, wpb=64, bsz=64, num_updates=1250, lr=4.75543e-06, gnorm=2.807, loss_scale=4, train_wall=8, gb_free=13.3, wall=4261
2022-04-25 13:17:32 - progress_bar.py[line:272] - INFO: epoch 001:   1264 / 6136 loss=2.117, loss_v1=0, loss_v2=0, nll_loss=1.116, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=74.3, ups=1.16, wpb=64, bsz=64, num_updates=1260, lr=4.79348e-06, gnorm=3.609, loss_scale=4, train_wall=9, gb_free=13.6, wall=4270
2022-04-25 13:17:40 - progress_bar.py[line:272] - INFO: epoch 001:   1274 / 6136 loss=2.114, loss_v1=0, loss_v2=0, nll_loss=1.113, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=1270, lr=4.83152e-06, gnorm=3.278, loss_scale=4, train_wall=8, gb_free=13.5, wall=4278
2022-04-25 13:17:49 - progress_bar.py[line:272] - INFO: epoch 001:   1284 / 6136 loss=2.129, loss_v1=0, loss_v2=0, nll_loss=1.127, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=1280, lr=4.86957e-06, gnorm=3.199, loss_scale=4, train_wall=8, gb_free=11, wall=4286
2022-04-25 13:17:57 - progress_bar.py[line:272] - INFO: epoch 001:   1294 / 6136 loss=2.115, loss_v1=0, loss_v2=0, nll_loss=1.113, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=1290, lr=4.90761e-06, gnorm=2.922, loss_scale=4, train_wall=8, gb_free=13.3, wall=4295
2022-04-25 13:18:06 - progress_bar.py[line:272] - INFO: epoch 001:   1304 / 6136 loss=2.123, loss_v1=0, loss_v2=0, nll_loss=1.121, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=1300, lr=4.94565e-06, gnorm=3.748, loss_scale=4, train_wall=8, gb_free=14, wall=4303
2022-04-25 13:18:06 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:22:13 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.3822 | wps 79.5 | wpb 16 | bsz 16 | num_updates 1300 | best_acc 0.3822
2022-04-25 13:22:22 - progress_bar.py[line:272] - INFO: epoch 001:   1314 / 6136 loss=2.121, loss_v1=0, loss_v2=0, nll_loss=1.12, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=1310, lr=4.9837e-06, gnorm=2.933, loss_scale=4, train_wall=9, gb_free=13.6, wall=4559
2022-04-25 13:22:30 - progress_bar.py[line:272] - INFO: epoch 001:   1324 / 6136 loss=2.097, loss_v1=0, loss_v2=0, nll_loss=1.095, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=1320, lr=5.02174e-06, gnorm=2.725, loss_scale=4, train_wall=8, gb_free=13.7, wall=4568
2022-04-25 13:22:33 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 2.0
2022-04-25 13:22:40 - progress_bar.py[line:272] - INFO: epoch 001:   1335 / 6136 loss=2.117, loss_v1=0, loss_v2=0, nll_loss=1.116, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=62.8, ups=0.98, wpb=64, bsz=64, num_updates=1330, lr=5.05978e-06, gnorm=4.645, loss_scale=2, train_wall=10, gb_free=13.5, wall=4578
2022-04-25 13:22:49 - progress_bar.py[line:272] - INFO: epoch 001:   1345 / 6136 loss=2.102, loss_v1=0, loss_v2=0, nll_loss=1.101, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=76.5, ups=1.2, wpb=64, bsz=64, num_updates=1340, lr=5.09783e-06, gnorm=3.053, loss_scale=2, train_wall=8, gb_free=13.4, wall=4586
2022-04-25 13:22:57 - progress_bar.py[line:272] - INFO: epoch 001:   1355 / 6136 loss=2.104, loss_v1=0, loss_v2=0, nll_loss=1.103, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.15, wps=74.6, ups=1.17, wpb=64, bsz=64, num_updates=1350, lr=5.13587e-06, gnorm=3.062, loss_scale=2, train_wall=9, gb_free=13.8, wall=4595
2022-04-25 13:23:07 - progress_bar.py[line:272] - INFO: epoch 001:   1365 / 6136 loss=2.124, loss_v1=0, loss_v2=0, nll_loss=1.122, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=67.1, ups=1.05, wpb=64, bsz=64, num_updates=1360, lr=5.17391e-06, gnorm=3.552, loss_scale=2, train_wall=9, gb_free=6.4, wall=4604
2022-04-25 13:23:15 - progress_bar.py[line:272] - INFO: epoch 001:   1375 / 6136 loss=2.12, loss_v1=0, loss_v2=0, nll_loss=1.119, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=78.8, ups=1.23, wpb=64, bsz=64, num_updates=1370, lr=5.21196e-06, gnorm=2.719, loss_scale=2, train_wall=8, gb_free=13.5, wall=4612
2022-04-25 13:23:23 - progress_bar.py[line:272] - INFO: epoch 001:   1385 / 6136 loss=2.107, loss_v1=0, loss_v2=0, nll_loss=1.106, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.15, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=1380, lr=5.25e-06, gnorm=3.092, loss_scale=2, train_wall=8, gb_free=14.1, wall=4621
2022-04-25 13:23:31 - progress_bar.py[line:272] - INFO: epoch 001:   1395 / 6136 loss=2.122, loss_v1=0, loss_v2=0, nll_loss=1.121, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=78.1, ups=1.22, wpb=64, bsz=64, num_updates=1390, lr=5.28804e-06, gnorm=3.009, loss_scale=2, train_wall=8, gb_free=12.4, wall=4629
2022-04-25 13:23:40 - progress_bar.py[line:272] - INFO: epoch 001:   1405 / 6136 loss=2.121, loss_v1=0, loss_v2=0, nll_loss=1.12, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=77.3, ups=1.21, wpb=64, bsz=64, num_updates=1400, lr=5.32609e-06, gnorm=2.919, loss_scale=2, train_wall=8, gb_free=13.1, wall=4637
2022-04-25 13:23:40 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:27:50 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.11 | loss_v1 0 | loss_v2 0 | nll_loss 1.107 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.15 | acc 0.3908 | wps 78.7 | wpb 16 | bsz 16 | num_updates 1400 | best_acc 0.3908
2022-04-25 13:27:58 - progress_bar.py[line:272] - INFO: epoch 001:   1415 / 6136 loss=2.119, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=1410, lr=5.36413e-06, gnorm=3.271, loss_scale=2, train_wall=8, gb_free=13.3, wall=4895
2022-04-25 13:28:07 - progress_bar.py[line:272] - INFO: epoch 001:   1425 / 6136 loss=2.085, loss_v1=0, loss_v2=0, nll_loss=1.084, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.12, wps=72, ups=1.12, wpb=64, bsz=64, num_updates=1420, lr=5.40217e-06, gnorm=3.12, loss_scale=2, train_wall=9, gb_free=13.8, wall=4904
2022-04-25 13:28:16 - progress_bar.py[line:272] - INFO: epoch 001:   1435 / 6136 loss=2.094, loss_v1=0, loss_v2=0, nll_loss=1.092, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.13, wps=71.5, ups=1.12, wpb=64, bsz=64, num_updates=1430, lr=5.44022e-06, gnorm=4.102, loss_scale=2, train_wall=9, gb_free=13.7, wall=4913
2022-04-25 13:28:25 - progress_bar.py[line:272] - INFO: epoch 001:   1445 / 6136 loss=2.119, loss_v1=0, loss_v2=0, nll_loss=1.118, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=70.4, ups=1.1, wpb=64, bsz=64, num_updates=1440, lr=5.47826e-06, gnorm=3.517, loss_scale=2, train_wall=9, gb_free=7.6, wall=4922
2022-04-25 13:28:33 - progress_bar.py[line:272] - INFO: epoch 001:   1455 / 6136 loss=2.114, loss_v1=0, loss_v2=0, nll_loss=1.113, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=1450, lr=5.5163e-06, gnorm=3.635, loss_scale=2, train_wall=8, gb_free=12.6, wall=4930
2022-04-25 13:28:41 - progress_bar.py[line:272] - INFO: epoch 001:   1465 / 6136 loss=2.125, loss_v1=0, loss_v2=0, nll_loss=1.124, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=1460, lr=5.55435e-06, gnorm=3.466, loss_scale=2, train_wall=8, gb_free=13.8, wall=4939
2022-04-25 13:28:49 - progress_bar.py[line:272] - INFO: epoch 001:   1475 / 6136 loss=2.125, loss_v1=0, loss_v2=0, nll_loss=1.124, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.18, wps=80.5, ups=1.26, wpb=64, bsz=64, num_updates=1470, lr=5.59239e-06, gnorm=3.621, loss_scale=2, train_wall=8, gb_free=13.8, wall=4947
2022-04-25 13:28:57 - progress_bar.py[line:272] - INFO: epoch 001:   1485 / 6136 loss=2.1, loss_v1=0, loss_v2=0, nll_loss=1.099, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=1480, lr=5.63043e-06, gnorm=2.887, loss_scale=2, train_wall=8, gb_free=14.1, wall=4955
2022-04-25 13:29:05 - progress_bar.py[line:272] - INFO: epoch 001:   1495 / 6136 loss=2.102, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=1490, lr=5.66848e-06, gnorm=3.587, loss_scale=2, train_wall=8, gb_free=13.3, wall=4963
2022-04-25 13:29:15 - progress_bar.py[line:272] - INFO: epoch 001:   1505 / 6136 loss=2.122, loss_v1=0, loss_v2=0, nll_loss=1.12, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=68.6, ups=1.07, wpb=64, bsz=64, num_updates=1500, lr=5.70652e-06, gnorm=2.782, loss_scale=2, train_wall=9, gb_free=13.9, wall=4972
2022-04-25 13:29:15 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:33:22 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.3978 | wps 79.6 | wpb 16 | bsz 16 | num_updates 1500 | best_acc 0.3978
2022-04-25 13:33:32 - progress_bar.py[line:272] - INFO: epoch 001:   1515 / 6136 loss=2.107, loss_v1=0, loss_v2=0, nll_loss=1.106, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.15, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=1510, lr=5.74457e-06, gnorm=3.151, loss_scale=2, train_wall=10, gb_free=10.7, wall=5229
2022-04-25 13:33:40 - progress_bar.py[line:272] - INFO: epoch 001:   1525 / 6136 loss=2.12, loss_v1=0, loss_v2=0, nll_loss=1.119, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=79.3, ups=1.24, wpb=64, bsz=64, num_updates=1520, lr=5.78261e-06, gnorm=3.778, loss_scale=2, train_wall=8, gb_free=13.8, wall=5237
2022-04-25 13:33:49 - progress_bar.py[line:272] - INFO: epoch 001:   1535 / 6136 loss=2.101, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=74.2, ups=1.16, wpb=64, bsz=64, num_updates=1530, lr=5.82065e-06, gnorm=2.654, loss_scale=2, train_wall=9, gb_free=13.8, wall=5246
2022-04-25 13:33:57 - progress_bar.py[line:272] - INFO: epoch 001:   1545 / 6136 loss=2.075, loss_v1=0, loss_v2=0, nll_loss=1.074, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.1, wps=72, ups=1.12, wpb=64, bsz=64, num_updates=1540, lr=5.8587e-06, gnorm=2.508, loss_scale=2, train_wall=9, gb_free=12, wall=5255
2022-04-25 13:34:05 - progress_bar.py[line:272] - INFO: epoch 001:   1555 / 6136 loss=2.099, loss_v1=0, loss_v2=0, nll_loss=1.098, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=79.8, ups=1.25, wpb=64, bsz=64, num_updates=1550, lr=5.89674e-06, gnorm=2.701, loss_scale=2, train_wall=8, gb_free=13.5, wall=5263
2022-04-25 13:34:14 - progress_bar.py[line:272] - INFO: epoch 001:   1565 / 6136 loss=2.112, loss_v1=0, loss_v2=0, nll_loss=1.111, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.16, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=1560, lr=5.93478e-06, gnorm=3.079, loss_scale=2, train_wall=8, gb_free=13.6, wall=5271
2022-04-25 13:34:22 - progress_bar.py[line:272] - INFO: epoch 001:   1575 / 6136 loss=2.098, loss_v1=0, loss_v2=0, nll_loss=1.097, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=78.4, ups=1.23, wpb=64, bsz=64, num_updates=1570, lr=5.97283e-06, gnorm=3.601, loss_scale=2, train_wall=8, gb_free=14, wall=5279
2022-04-25 13:34:30 - progress_bar.py[line:272] - INFO: epoch 001:   1585 / 6136 loss=2.119, loss_v1=0, loss_v2=0, nll_loss=1.117, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.17, wps=77.3, ups=1.21, wpb=64, bsz=64, num_updates=1580, lr=6.01087e-06, gnorm=3.384, loss_scale=2, train_wall=8, gb_free=12, wall=5288
2022-04-25 13:34:39 - progress_bar.py[line:272] - INFO: epoch 001:   1595 / 6136 loss=2.088, loss_v1=0, loss_v2=0, nll_loss=1.087, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.12, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=1590, lr=6.04891e-06, gnorm=3.038, loss_scale=2, train_wall=8, gb_free=13.5, wall=5296
2022-04-25 13:34:47 - progress_bar.py[line:272] - INFO: epoch 001:   1605 / 6136 loss=2.09, loss_v1=0, loss_v2=0, nll_loss=1.089, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.13, wps=78.1, ups=1.22, wpb=64, bsz=64, num_updates=1600, lr=6.08696e-06, gnorm=2.744, loss_scale=2, train_wall=8, gb_free=13.5, wall=5304
2022-04-25 13:34:47 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:38:54 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.4329 | wps 79.5 | wpb 16 | bsz 16 | num_updates 1600 | best_acc 0.4329
2022-04-25 13:39:03 - progress_bar.py[line:272] - INFO: epoch 001:   1615 / 6136 loss=2.088, loss_v1=0, loss_v2=0, nll_loss=1.086, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.12, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=1610, lr=6.125e-06, gnorm=2.88, loss_scale=2, train_wall=9, gb_free=13.9, wall=5561
2022-04-25 13:39:11 - progress_bar.py[line:272] - INFO: epoch 001:   1625 / 6136 loss=2.101, loss_v1=0, loss_v2=0, nll_loss=1.1, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=79.1, ups=1.24, wpb=64, bsz=64, num_updates=1620, lr=6.16304e-06, gnorm=2.624, loss_scale=2, train_wall=8, gb_free=13.7, wall=5569
2022-04-25 13:39:19 - progress_bar.py[line:272] - INFO: epoch 001:   1635 / 6136 loss=2.099, loss_v1=0, loss_v2=0, nll_loss=1.098, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=1630, lr=6.20109e-06, gnorm=2.708, loss_scale=2, train_wall=8, gb_free=13.1, wall=5577
2022-04-25 13:39:29 - progress_bar.py[line:272] - INFO: epoch 001:   1645 / 6136 loss=2.103, loss_v1=0, loss_v2=0, nll_loss=1.101, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=68.9, ups=1.08, wpb=64, bsz=64, num_updates=1640, lr=6.23913e-06, gnorm=3.105, loss_scale=2, train_wall=9, gb_free=12.8, wall=5586
2022-04-25 13:39:37 - progress_bar.py[line:272] - INFO: epoch 001:   1655 / 6136 loss=2.102, loss_v1=0, loss_v2=0, nll_loss=1.101, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=1650, lr=6.27717e-06, gnorm=3.257, loss_scale=2, train_wall=8, gb_free=14, wall=5594
2022-04-25 13:39:45 - progress_bar.py[line:272] - INFO: epoch 001:   1665 / 6136 loss=2.106, loss_v1=0, loss_v2=0, nll_loss=1.105, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.15, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=1660, lr=6.31522e-06, gnorm=2.412, loss_scale=2, train_wall=8, gb_free=13.8, wall=5603
2022-04-25 13:39:54 - progress_bar.py[line:272] - INFO: epoch 001:   1675 / 6136 loss=2.098, loss_v1=0, loss_v2=0, nll_loss=1.097, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.14, wps=76.5, ups=1.2, wpb=64, bsz=64, num_updates=1670, lr=6.35326e-06, gnorm=3.736, loss_scale=2, train_wall=8, gb_free=13.2, wall=5611
2022-04-25 13:40:02 - progress_bar.py[line:272] - INFO: epoch 001:   1685 / 6136 loss=2.09, loss_v1=0, loss_v2=0, nll_loss=1.089, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.13, wps=76.4, ups=1.19, wpb=64, bsz=64, num_updates=1680, lr=6.3913e-06, gnorm=3.327, loss_scale=2, train_wall=8, gb_free=13.6, wall=5620
2022-04-25 13:40:10 - progress_bar.py[line:272] - INFO: epoch 001:   1695 / 6136 loss=2.087, loss_v1=0, loss_v2=0, nll_loss=1.086, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.12, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=1690, lr=6.42935e-06, gnorm=3.016, loss_scale=2, train_wall=8, gb_free=13.9, wall=5628
2022-04-25 13:40:18 - progress_bar.py[line:272] - INFO: epoch 001:   1705 / 6136 loss=2.084, loss_v1=0, loss_v2=0, nll_loss=1.083, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.12, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=1700, lr=6.46739e-06, gnorm=2.228, loss_scale=2, train_wall=8, gb_free=13.2, wall=5636
2022-04-25 13:40:18 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:44:26 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.064 | loss_v1 0 | loss_v2 0 | nll_loss 1.061 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.09 | acc 0.4755 | wps 79.6 | wpb 16 | bsz 16 | num_updates 1700 | best_acc 0.4755
2022-04-25 13:44:35 - progress_bar.py[line:272] - INFO: epoch 001:   1715 / 6136 loss=2.084, loss_v1=0, loss_v2=0, nll_loss=1.082, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.12, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=1710, lr=6.50543e-06, gnorm=3.067, loss_scale=2, train_wall=9, gb_free=14, wall=5892
2022-04-25 13:44:43 - progress_bar.py[line:272] - INFO: epoch 001:   1725 / 6136 loss=2.077, loss_v1=0, loss_v2=0, nll_loss=1.076, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.11, wps=78.4, ups=1.22, wpb=64, bsz=64, num_updates=1720, lr=6.54348e-06, gnorm=2.937, loss_scale=2, train_wall=8, gb_free=14.2, wall=5901
2022-04-25 13:44:52 - progress_bar.py[line:272] - INFO: epoch 001:   1735 / 6136 loss=2.07, loss_v1=0, loss_v2=0, nll_loss=1.068, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.1, wps=67.9, ups=1.06, wpb=64, bsz=64, num_updates=1730, lr=6.58152e-06, gnorm=2.916, loss_scale=2, train_wall=9, gb_free=13, wall=5910
2022-04-25 13:45:01 - progress_bar.py[line:272] - INFO: epoch 001:   1745 / 6136 loss=2.061, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.08, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=1740, lr=6.61957e-06, gnorm=2.984, loss_scale=2, train_wall=8, gb_free=14, wall=5918
2022-04-25 13:45:10 - progress_bar.py[line:272] - INFO: epoch 001:   1755 / 6136 loss=2.072, loss_v1=0, loss_v2=0, nll_loss=1.071, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.1, wps=68.3, ups=1.07, wpb=64, bsz=64, num_updates=1750, lr=6.65761e-06, gnorm=3.484, loss_scale=2, train_wall=9, gb_free=13.1, wall=5928
2022-04-25 13:45:19 - progress_bar.py[line:272] - INFO: epoch 001:   1765 / 6136 loss=2.074, loss_v1=0, loss_v2=0, nll_loss=1.072, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.1, wps=68.2, ups=1.07, wpb=64, bsz=64, num_updates=1760, lr=6.69565e-06, gnorm=2.646, loss_scale=2, train_wall=9, gb_free=14.1, wall=5937
2022-04-25 13:45:28 - progress_bar.py[line:272] - INFO: epoch 001:   1775 / 6136 loss=2.053, loss_v1=0, loss_v2=0, nll_loss=1.052, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.07, wps=78.4, ups=1.22, wpb=64, bsz=64, num_updates=1770, lr=6.7337e-06, gnorm=3.588, loss_scale=2, train_wall=8, gb_free=13.2, wall=5945
2022-04-25 13:45:36 - progress_bar.py[line:272] - INFO: epoch 001:   1785 / 6136 loss=2.068, loss_v1=0, loss_v2=0, nll_loss=1.067, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.1, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=1780, lr=6.77174e-06, gnorm=2.978, loss_scale=2, train_wall=8, gb_free=13.6, wall=5953
2022-04-25 13:45:45 - progress_bar.py[line:272] - INFO: epoch 001:   1795 / 6136 loss=2.056, loss_v1=0, loss_v2=0, nll_loss=1.054, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.08, wps=69.2, ups=1.08, wpb=64, bsz=64, num_updates=1790, lr=6.80978e-06, gnorm=2.777, loss_scale=2, train_wall=9, gb_free=13.6, wall=5963
2022-04-25 13:45:54 - progress_bar.py[line:272] - INFO: epoch 001:   1805 / 6136 loss=2.066, loss_v1=0, loss_v2=0, nll_loss=1.064, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.09, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=1800, lr=6.84783e-06, gnorm=3.668, loss_scale=2, train_wall=8, gb_free=13.9, wall=5971
2022-04-25 13:45:54 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:50:00 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 2.021 | loss_v1 0 | loss_v2 0 | nll_loss 1.018 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 2.03 | acc 0.4898 | wps 79.7 | wpb 16 | bsz 16 | num_updates 1800 | best_acc 0.4898
2022-04-25 13:50:08 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 1.0
2022-04-25 13:50:09 - progress_bar.py[line:272] - INFO: epoch 001:   1816 / 6136 loss=2.051, loss_v1=0, loss_v2=0, nll_loss=1.05, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.07, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=1810, lr=6.88587e-06, gnorm=3.582, loss_scale=1, train_wall=9, gb_free=10.8, wall=6227
2022-04-25 13:50:17 - progress_bar.py[line:272] - INFO: epoch 001:   1826 / 6136 loss=2.038, loss_v1=0, loss_v2=0, nll_loss=1.037, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.05, wps=78.8, ups=1.23, wpb=64, bsz=64, num_updates=1820, lr=6.92391e-06, gnorm=3.333, loss_scale=1, train_wall=8, gb_free=11.3, wall=6235
2022-04-25 13:50:25 - progress_bar.py[line:272] - INFO: epoch 001:   1836 / 6136 loss=2.059, loss_v1=0, loss_v2=0, nll_loss=1.058, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.08, wps=79.6, ups=1.24, wpb=64, bsz=64, num_updates=1830, lr=6.96196e-06, gnorm=3.211, loss_scale=1, train_wall=8, gb_free=13.6, wall=6243
2022-04-25 13:50:33 - progress_bar.py[line:272] - INFO: epoch 001:   1846 / 6136 loss=2.057, loss_v1=0, loss_v2=0, nll_loss=1.056, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.08, wps=79.9, ups=1.25, wpb=64, bsz=64, num_updates=1840, lr=7e-06, gnorm=3.17, loss_scale=1, train_wall=8, gb_free=13, wall=6251
2022-04-25 13:50:41 - progress_bar.py[line:272] - INFO: epoch 001:   1856 / 6136 loss=2.048, loss_v1=0, loss_v2=0, nll_loss=1.047, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.07, wps=78.7, ups=1.23, wpb=64, bsz=64, num_updates=1850, lr=6.99757e-06, gnorm=3.171, loss_scale=1, train_wall=8, gb_free=13.5, wall=6259
2022-04-25 13:50:49 - progress_bar.py[line:272] - INFO: epoch 001:   1866 / 6136 loss=2.046, loss_v1=0, loss_v2=0, nll_loss=1.044, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.06, wps=80.1, ups=1.25, wpb=64, bsz=64, num_updates=1860, lr=6.99515e-06, gnorm=3.302, loss_scale=1, train_wall=8, gb_free=13.7, wall=6267
2022-04-25 13:50:58 - progress_bar.py[line:272] - INFO: epoch 001:   1876 / 6136 loss=2.037, loss_v1=0, loss_v2=0, nll_loss=1.036, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.05, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=1870, lr=6.99272e-06, gnorm=3.755, loss_scale=1, train_wall=8, gb_free=13.4, wall=6275
2022-04-25 13:51:06 - progress_bar.py[line:272] - INFO: epoch 001:   1886 / 6136 loss=2.059, loss_v1=0, loss_v2=0, nll_loss=1.058, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.08, wps=79.1, ups=1.24, wpb=64, bsz=64, num_updates=1880, lr=6.99029e-06, gnorm=3.489, loss_scale=1, train_wall=8, gb_free=13.2, wall=6283
2022-04-25 13:51:14 - progress_bar.py[line:272] - INFO: epoch 001:   1896 / 6136 loss=2.037, loss_v1=0, loss_v2=0, nll_loss=1.036, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.05, wps=81.2, ups=1.27, wpb=64, bsz=64, num_updates=1890, lr=6.98786e-06, gnorm=3.157, loss_scale=1, train_wall=8, gb_free=14, wall=6291
2022-04-25 13:51:22 - progress_bar.py[line:272] - INFO: epoch 001:   1906 / 6136 loss=2.022, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.03, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=1900, lr=6.98544e-06, gnorm=3.634, loss_scale=1, train_wall=8, gb_free=13.4, wall=6300
2022-04-25 13:51:22 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 13:55:28 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.989 | loss_v1 0 | loss_v2 0 | nll_loss 0.986 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.98 | acc 0.5185 | wps 79.9 | wpb 16 | bsz 16 | num_updates 1900 | best_acc 0.5185
2022-04-25 13:55:37 - progress_bar.py[line:272] - INFO: epoch 001:   1916 / 6136 loss=2.048, loss_v1=0, loss_v2=0, nll_loss=1.046, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.07, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=1910, lr=6.98301e-06, gnorm=2.975, loss_scale=1, train_wall=8, gb_free=13.9, wall=6554
2022-04-25 13:55:45 - progress_bar.py[line:272] - INFO: epoch 001:   1926 / 6136 loss=2.011, loss_v1=0, loss_v2=0, nll_loss=1.01, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.01, wps=81.1, ups=1.27, wpb=64, bsz=64, num_updates=1920, lr=6.98058e-06, gnorm=2.975, loss_scale=1, train_wall=8, gb_free=13.6, wall=6562
2022-04-25 13:55:53 - progress_bar.py[line:272] - INFO: epoch 001:   1936 / 6136 loss=2.062, loss_v1=0, loss_v2=0, nll_loss=1.06, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.08, wps=78.1, ups=1.22, wpb=64, bsz=64, num_updates=1930, lr=6.97816e-06, gnorm=3.037, loss_scale=1, train_wall=8, gb_free=14.1, wall=6570
2022-04-25 13:56:01 - progress_bar.py[line:272] - INFO: epoch 001:   1946 / 6136 loss=2.029, loss_v1=0, loss_v2=0, nll_loss=1.028, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.04, wps=81.2, ups=1.27, wpb=64, bsz=64, num_updates=1940, lr=6.97573e-06, gnorm=3.147, loss_scale=1, train_wall=8, gb_free=12.8, wall=6578
2022-04-25 13:56:09 - progress_bar.py[line:272] - INFO: epoch 001:   1956 / 6136 loss=2.015, loss_v1=0, loss_v2=0, nll_loss=1.013, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.02, wps=79.2, ups=1.24, wpb=64, bsz=64, num_updates=1950, lr=6.9733e-06, gnorm=3.388, loss_scale=1, train_wall=8, gb_free=13.5, wall=6586
2022-04-25 13:56:17 - progress_bar.py[line:272] - INFO: epoch 001:   1966 / 6136 loss=2.04, loss_v1=0, loss_v2=0, nll_loss=1.039, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.05, wps=80.4, ups=1.26, wpb=64, bsz=64, num_updates=1960, lr=6.97087e-06, gnorm=2.917, loss_scale=1, train_wall=8, gb_free=13.1, wall=6594
2022-04-25 13:56:25 - progress_bar.py[line:272] - INFO: epoch 001:   1976 / 6136 loss=1.992, loss_v1=0, loss_v2=0, nll_loss=0.99, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.99, wps=79.6, ups=1.24, wpb=64, bsz=64, num_updates=1970, lr=6.96845e-06, gnorm=3.317, loss_scale=1, train_wall=8, gb_free=13, wall=6602
2022-04-25 13:56:33 - progress_bar.py[line:272] - INFO: epoch 001:   1986 / 6136 loss=2.016, loss_v1=0, loss_v2=0, nll_loss=1.015, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.02, wps=78.7, ups=1.23, wpb=64, bsz=64, num_updates=1980, lr=6.96602e-06, gnorm=3.15, loss_scale=1, train_wall=8, gb_free=13.7, wall=6610
2022-04-25 13:56:41 - progress_bar.py[line:272] - INFO: epoch 001:   1996 / 6136 loss=2.038, loss_v1=0, loss_v2=0, nll_loss=1.036, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.05, wps=79.2, ups=1.24, wpb=64, bsz=64, num_updates=1990, lr=6.96359e-06, gnorm=3.762, loss_scale=1, train_wall=8, gb_free=12.1, wall=6618
2022-04-25 13:56:49 - progress_bar.py[line:272] - INFO: epoch 001:   2006 / 6136 loss=2.007, loss_v1=0, loss_v2=0, nll_loss=1.005, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.01, wps=81, ups=1.27, wpb=64, bsz=64, num_updates=2000, lr=6.96117e-06, gnorm=3.868, loss_scale=1, train_wall=8, gb_free=13.8, wall=6626
2022-04-25 13:56:49 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:00:53 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.5369 | wps 80.5 | wpb 16 | bsz 16 | num_updates 2000 | best_acc 0.5369
2022-04-25 14:00:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 2000 updates
2022-04-25 14:00:53 - trainer.py[line:432] - INFO: Saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_2000.pt
2022-04-25 14:01:07 - trainer.py[line:442] - INFO: Finished saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_2000.pt
2022-04-25 14:01:29 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_2000.pt (epoch 1 @ 2000 updates, score 0.5369) (writing took 36.010183569043875 seconds)
2022-04-25 14:01:38 - progress_bar.py[line:272] - INFO: epoch 001:   2016 / 6136 loss=1.989, loss_v1=0, loss_v2=0, nll_loss=0.987, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.98, wps=2.2, ups=0.03, wpb=64, bsz=64, num_updates=2010, lr=6.95874e-06, gnorm=3.501, loss_scale=1, train_wall=8, gb_free=12.7, wall=6916
2022-04-25 14:01:48 - progress_bar.py[line:272] - INFO: epoch 001:   2026 / 6136 loss=1.983, loss_v1=0, loss_v2=0, nll_loss=0.982, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.98, wps=65.8, ups=1.03, wpb=64, bsz=64, num_updates=2020, lr=6.95631e-06, gnorm=3.368, loss_scale=1, train_wall=10, gb_free=13.9, wall=6925
2022-04-25 14:01:56 - progress_bar.py[line:272] - INFO: epoch 001:   2036 / 6136 loss=1.98, loss_v1=0, loss_v2=0, nll_loss=0.978, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.97, wps=75.9, ups=1.19, wpb=64, bsz=64, num_updates=2030, lr=6.95388e-06, gnorm=3.304, loss_scale=1, train_wall=8, gb_free=14.1, wall=6934
2022-04-25 14:02:04 - progress_bar.py[line:272] - INFO: epoch 001:   2046 / 6136 loss=1.997, loss_v1=0, loss_v2=0, nll_loss=0.995, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.99, wps=78.8, ups=1.23, wpb=64, bsz=64, num_updates=2040, lr=6.95146e-06, gnorm=3.676, loss_scale=1, train_wall=8, gb_free=12.1, wall=6942
2022-04-25 14:02:14 - progress_bar.py[line:272] - INFO: epoch 001:   2056 / 6136 loss=2.005, loss_v1=0, loss_v2=0, nll_loss=1.003, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2, wps=63, ups=0.98, wpb=64, bsz=64, num_updates=2050, lr=6.94903e-06, gnorm=3.517, loss_scale=1, train_wall=10, gb_free=14.2, wall=6952
2022-04-25 14:02:23 - progress_bar.py[line:272] - INFO: epoch 001:   2066 / 6136 loss=1.996, loss_v1=0, loss_v2=0, nll_loss=0.994, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.99, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=2060, lr=6.9466e-06, gnorm=4.038, loss_scale=1, train_wall=8, gb_free=12, wall=6960
2022-04-25 14:02:31 - progress_bar.py[line:272] - INFO: epoch 001:   2076 / 6136 loss=1.985, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.98, wps=74.1, ups=1.16, wpb=64, bsz=64, num_updates=2070, lr=6.94417e-06, gnorm=3.159, loss_scale=1, train_wall=9, gb_free=14, wall=6969
2022-04-25 14:02:40 - progress_bar.py[line:272] - INFO: epoch 001:   2086 / 6136 loss=1.985, loss_v1=0, loss_v2=0, nll_loss=0.984, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.98, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=2080, lr=6.94175e-06, gnorm=3.065, loss_scale=1, train_wall=8, gb_free=13.2, wall=6977
2022-04-25 14:02:48 - progress_bar.py[line:272] - INFO: epoch 001:   2096 / 6136 loss=1.955, loss_v1=0, loss_v2=0, nll_loss=0.953, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.94, wps=79.6, ups=1.24, wpb=64, bsz=64, num_updates=2090, lr=6.93932e-06, gnorm=2.822, loss_scale=1, train_wall=8, gb_free=13.7, wall=6985
2022-04-25 14:02:57 - progress_bar.py[line:272] - INFO: epoch 001:   2106 / 6136 loss=2.023, loss_v1=0, loss_v2=0, nll_loss=1.021, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=2.03, wps=71.5, ups=1.12, wpb=64, bsz=64, num_updates=2100, lr=6.93689e-06, gnorm=3.403, loss_scale=1, train_wall=9, gb_free=14, wall=6994
2022-04-25 14:02:57 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:06:59 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.944 | loss_v1 0 | loss_v2 0 | nll_loss 0.941 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.92 | acc 0.5671 | wps 81.1 | wpb 16 | bsz 16 | num_updates 2100 | best_acc 0.5671
2022-04-25 14:07:07 - progress_bar.py[line:272] - INFO: epoch 001:   2116 / 6136 loss=1.971, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.96, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=2110, lr=6.93447e-06, gnorm=3.751, loss_scale=1, train_wall=8, gb_free=12.3, wall=7245
2022-04-25 14:07:15 - progress_bar.py[line:272] - INFO: epoch 001:   2126 / 6136 loss=1.984, loss_v1=0, loss_v2=0, nll_loss=0.983, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.98, wps=80, ups=1.25, wpb=64, bsz=64, num_updates=2120, lr=6.93204e-06, gnorm=3.535, loss_scale=1, train_wall=8, gb_free=13.7, wall=7253
2022-04-25 14:07:24 - progress_bar.py[line:272] - INFO: epoch 001:   2136 / 6136 loss=1.982, loss_v1=0, loss_v2=0, nll_loss=0.981, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.97, wps=69.5, ups=1.09, wpb=64, bsz=64, num_updates=2130, lr=6.92961e-06, gnorm=4.337, loss_scale=1, train_wall=9, gb_free=13.3, wall=7262
2022-04-25 14:07:33 - progress_bar.py[line:272] - INFO: epoch 001:   2146 / 6136 loss=1.969, loss_v1=0, loss_v2=0, nll_loss=0.968, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.96, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=2140, lr=6.92718e-06, gnorm=3.754, loss_scale=1, train_wall=8, gb_free=14.1, wall=7270
2022-04-25 14:07:41 - progress_bar.py[line:272] - INFO: epoch 001:   2156 / 6136 loss=1.987, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.98, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=2150, lr=6.92476e-06, gnorm=3.439, loss_scale=1, train_wall=8, gb_free=13.7, wall=7279
2022-04-25 14:07:49 - progress_bar.py[line:272] - INFO: epoch 001:   2166 / 6136 loss=1.971, loss_v1=0, loss_v2=0, nll_loss=0.969, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.96, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=2160, lr=6.92233e-06, gnorm=3.437, loss_scale=1, train_wall=8, gb_free=13.4, wall=7287
2022-04-25 14:07:58 - progress_bar.py[line:272] - INFO: epoch 001:   2176 / 6136 loss=1.951, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.93, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=2170, lr=6.9199e-06, gnorm=3.748, loss_scale=1, train_wall=8, gb_free=13.6, wall=7295
2022-04-25 14:08:06 - progress_bar.py[line:272] - INFO: epoch 001:   2186 / 6136 loss=1.949, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.93, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=2180, lr=6.91748e-06, gnorm=3.352, loss_scale=1, train_wall=8, gb_free=13.1, wall=7303
2022-04-25 14:08:14 - progress_bar.py[line:272] - INFO: epoch 001:   2196 / 6136 loss=1.966, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.95, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=2190, lr=6.91505e-06, gnorm=3.289, loss_scale=1, train_wall=8, gb_free=13.8, wall=7311
2022-04-25 14:08:22 - progress_bar.py[line:272] - INFO: epoch 001:   2206 / 6136 loss=1.944, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.92, wps=77.4, ups=1.21, wpb=64, bsz=64, num_updates=2200, lr=6.91262e-06, gnorm=3.782, loss_scale=1, train_wall=8, gb_free=13, wall=7320
2022-04-25 14:08:22 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:12:29 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.5744 | wps 79.6 | wpb 16 | bsz 16 | num_updates 2200 | best_acc 0.5744
2022-04-25 14:12:38 - progress_bar.py[line:272] - INFO: epoch 001:   2216 / 6136 loss=1.975, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.96, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=2210, lr=6.91019e-06, gnorm=4.059, loss_scale=1, train_wall=8, gb_free=13.4, wall=7575
2022-04-25 14:12:46 - progress_bar.py[line:272] - INFO: epoch 001:   2226 / 6136 loss=1.992, loss_v1=0, loss_v2=0, nll_loss=0.99, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.99, wps=75.9, ups=1.19, wpb=64, bsz=64, num_updates=2220, lr=6.90777e-06, gnorm=4.963, loss_scale=1, train_wall=8, gb_free=12.9, wall=7584
2022-04-25 14:12:54 - progress_bar.py[line:272] - INFO: epoch 001:   2236 / 6136 loss=1.962, loss_v1=0, loss_v2=0, nll_loss=0.961, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.95, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=2230, lr=6.90534e-06, gnorm=3.216, loss_scale=1, train_wall=8, gb_free=13.8, wall=7592
2022-04-25 14:13:02 - progress_bar.py[line:272] - INFO: epoch 001:   2246 / 6136 loss=1.974, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.96, wps=77, ups=1.2, wpb=64, bsz=64, num_updates=2240, lr=6.90291e-06, gnorm=3.652, loss_scale=1, train_wall=8, gb_free=13.3, wall=7600
2022-04-25 14:13:12 - progress_bar.py[line:272] - INFO: epoch 001:   2256 / 6136 loss=1.979, loss_v1=0, loss_v2=0, nll_loss=0.977, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.97, wps=67.8, ups=1.06, wpb=64, bsz=64, num_updates=2250, lr=6.90049e-06, gnorm=3.897, loss_scale=1, train_wall=9, gb_free=13.4, wall=7609
2022-04-25 14:13:20 - progress_bar.py[line:272] - INFO: epoch 001:   2266 / 6136 loss=1.939, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.91, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=2260, lr=6.89806e-06, gnorm=3.635, loss_scale=1, train_wall=8, gb_free=12.6, wall=7618
2022-04-25 14:13:28 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.5
2022-04-25 14:13:31 - progress_bar.py[line:272] - INFO: epoch 001:   2277 / 6136 loss=1.942, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.92, wps=59.3, ups=0.93, wpb=64, bsz=64, num_updates=2270, lr=6.89563e-06, gnorm=3.459, loss_scale=0.5, train_wall=11, gb_free=13, wall=7629
2022-04-25 14:13:40 - progress_bar.py[line:272] - INFO: epoch 001:   2287 / 6136 loss=1.949, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.93, wps=68.8, ups=1.08, wpb=64, bsz=64, num_updates=2280, lr=6.8932e-06, gnorm=4.008, loss_scale=0.5, train_wall=9, gb_free=13.4, wall=7638
2022-04-25 14:13:48 - progress_bar.py[line:272] - INFO: epoch 001:   2297 / 6136 loss=1.952, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.93, wps=79.8, ups=1.25, wpb=64, bsz=64, num_updates=2290, lr=6.89078e-06, gnorm=4.722, loss_scale=0.5, train_wall=8, gb_free=13.3, wall=7646
2022-04-25 14:13:56 - progress_bar.py[line:272] - INFO: epoch 001:   2307 / 6136 loss=1.934, loss_v1=0, loss_v2=0, nll_loss=0.933, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.91, wps=80.6, ups=1.26, wpb=64, bsz=64, num_updates=2300, lr=6.88835e-06, gnorm=3.522, loss_scale=0.5, train_wall=8, gb_free=13.5, wall=7654
2022-04-25 14:13:56 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:17:50 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.5926 | wps 84.3 | wpb 16 | bsz 16 | num_updates 2300 | best_acc 0.5926
2022-04-25 14:17:58 - progress_bar.py[line:272] - INFO: epoch 001:   2317 / 6136 loss=1.949, loss_v1=0, loss_v2=0, nll_loss=0.947, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.93, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=2310, lr=6.88592e-06, gnorm=3.561, loss_scale=0.5, train_wall=8, gb_free=13.2, wall=7896
2022-04-25 14:18:06 - progress_bar.py[line:272] - INFO: epoch 001:   2327 / 6136 loss=1.936, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.91, wps=77.4, ups=1.21, wpb=64, bsz=64, num_updates=2320, lr=6.8835e-06, gnorm=4.015, loss_scale=0.5, train_wall=8, gb_free=13.4, wall=7904
2022-04-25 14:18:14 - progress_bar.py[line:272] - INFO: epoch 001:   2337 / 6136 loss=1.913, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.88, wps=78.8, ups=1.23, wpb=64, bsz=64, num_updates=2330, lr=6.88107e-06, gnorm=4.052, loss_scale=0.5, train_wall=8, gb_free=13.2, wall=7912
2022-04-25 14:18:23 - progress_bar.py[line:272] - INFO: epoch 001:   2347 / 6136 loss=1.94, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.92, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=2340, lr=6.87864e-06, gnorm=3.887, loss_scale=0.5, train_wall=8, gb_free=12.8, wall=7920
2022-04-25 14:18:31 - progress_bar.py[line:272] - INFO: epoch 001:   2357 / 6136 loss=1.961, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.94, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=2350, lr=6.87621e-06, gnorm=4.059, loss_scale=0.5, train_wall=8, gb_free=13.6, wall=7928
2022-04-25 14:18:39 - progress_bar.py[line:272] - INFO: epoch 001:   2367 / 6136 loss=1.924, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.9, wps=74.1, ups=1.16, wpb=64, bsz=64, num_updates=2360, lr=6.87379e-06, gnorm=3.925, loss_scale=0.5, train_wall=9, gb_free=12.8, wall=7937
2022-04-25 14:18:48 - progress_bar.py[line:272] - INFO: epoch 001:   2377 / 6136 loss=1.911, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.88, wps=75.1, ups=1.17, wpb=64, bsz=64, num_updates=2370, lr=6.87136e-06, gnorm=3.495, loss_scale=0.5, train_wall=8, gb_free=12.4, wall=7945
2022-04-25 14:18:56 - progress_bar.py[line:272] - INFO: epoch 001:   2387 / 6136 loss=1.959, loss_v1=0, loss_v2=0, nll_loss=0.958, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.94, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=2380, lr=6.86893e-06, gnorm=3.38, loss_scale=0.5, train_wall=8, gb_free=12.7, wall=7954
2022-04-25 14:19:04 - progress_bar.py[line:272] - INFO: epoch 001:   2397 / 6136 loss=1.912, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.88, wps=79.9, ups=1.25, wpb=64, bsz=64, num_updates=2390, lr=6.8665e-06, gnorm=3.756, loss_scale=0.5, train_wall=8, gb_free=13.2, wall=7962
2022-04-25 14:19:12 - progress_bar.py[line:272] - INFO: epoch 001:   2407 / 6136 loss=1.964, loss_v1=0, loss_v2=0, nll_loss=0.962, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.95, wps=79.5, ups=1.24, wpb=64, bsz=64, num_updates=2400, lr=6.86408e-06, gnorm=4.425, loss_scale=0.5, train_wall=8, gb_free=11.6, wall=7970
2022-04-25 14:19:12 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:23:02 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.897 | loss_v1 0 | loss_v2 0 | nll_loss 0.895 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.86 | acc 0.5945 | wps 85.6 | wpb 16 | bsz 16 | num_updates 2400 | best_acc 0.5945
2022-04-25 14:23:10 - progress_bar.py[line:272] - INFO: epoch 001:   2417 / 6136 loss=1.953, loss_v1=0, loss_v2=0, nll_loss=0.951, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.93, wps=2.7, ups=0.04, wpb=64, bsz=64, num_updates=2410, lr=6.86165e-06, gnorm=3.696, loss_scale=0.5, train_wall=8, gb_free=14.2, wall=8208
2022-04-25 14:23:18 - progress_bar.py[line:272] - INFO: epoch 001:   2427 / 6136 loss=1.899, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.86, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=2420, lr=6.85922e-06, gnorm=3.869, loss_scale=0.5, train_wall=8, gb_free=13.1, wall=8216
2022-04-25 14:23:27 - progress_bar.py[line:272] - INFO: epoch 001:   2437 / 6136 loss=1.924, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.89, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=2430, lr=6.8568e-06, gnorm=3.44, loss_scale=0.5, train_wall=8, gb_free=13.7, wall=8224
2022-04-25 14:23:35 - progress_bar.py[line:272] - INFO: epoch 001:   2447 / 6136 loss=1.897, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.86, wps=76.9, ups=1.2, wpb=64, bsz=64, num_updates=2440, lr=6.85437e-06, gnorm=3.706, loss_scale=0.5, train_wall=8, gb_free=13.5, wall=8232
2022-04-25 14:23:43 - progress_bar.py[line:272] - INFO: epoch 001:   2457 / 6136 loss=1.932, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.91, wps=79.8, ups=1.25, wpb=64, bsz=64, num_updates=2450, lr=6.85194e-06, gnorm=3.763, loss_scale=0.5, train_wall=8, gb_free=14.1, wall=8240
2022-04-25 14:23:52 - progress_bar.py[line:272] - INFO: epoch 001:   2467 / 6136 loss=1.916, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.89, wps=71.1, ups=1.11, wpb=64, bsz=64, num_updates=2460, lr=6.84951e-06, gnorm=3.394, loss_scale=0.5, train_wall=9, gb_free=6.8, wall=8249
2022-04-25 14:24:00 - progress_bar.py[line:272] - INFO: epoch 001:   2477 / 6136 loss=1.923, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.89, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=2470, lr=6.84709e-06, gnorm=3.672, loss_scale=0.5, train_wall=8, gb_free=13.6, wall=8258
2022-04-25 14:24:08 - progress_bar.py[line:272] - INFO: epoch 001:   2487 / 6136 loss=1.88, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.84, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=2480, lr=6.84466e-06, gnorm=3.166, loss_scale=0.5, train_wall=8, gb_free=13.5, wall=8266
2022-04-25 14:24:17 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.25
2022-04-25 14:24:18 - progress_bar.py[line:272] - INFO: epoch 001:   2498 / 6136 loss=1.892, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.85, wps=64.6, ups=1.01, wpb=64, bsz=64, num_updates=2490, lr=6.84223e-06, gnorm=3.271, loss_scale=0.25, train_wall=10, gb_free=13.7, wall=8276
2022-04-25 14:24:24 - trainer.py[line:1304] - WARNING: OOM: Ran out of memory with exception: CUDA out of memory. Tried to allocate 1.51 GiB (GPU 0; 23.70 GiB total capacity; 19.83 GiB already allocated; 446.56 MiB free; 22.15 GiB reserved in total by PyTorch)
2022-04-25 14:24:24 - trainer.py[line:1307] - WARNING: |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 2            |        cudaMalloc retries: 4         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   18751 MB |   20383 MB |  224093 GB |  224075 GB |
|       from large pool |   18713 MB |   20343 MB |  220472 GB |  220454 GB |
|       from small pool |      38 MB |      40 MB |    3620 GB |    3620 GB |
|---------------------------------------------------------------------------|
| Active memory         |   18751 MB |   20383 MB |  224093 GB |  224075 GB |
|       from large pool |   18713 MB |   20343 MB |  220472 GB |  220454 GB |
|       from small pool |      38 MB |      40 MB |    3620 GB |    3620 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   22678 MB |   22678 MB |   38972 MB |   16294 MB |
|       from large pool |   22626 MB |   22626 MB |   38806 MB |   16180 MB |
|       from small pool |      52 MB |      96 MB |     166 MB |     114 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2376 MB |    2376 MB |  188600 GB |  188598 GB |
|       from large pool |    2362 MB |    2362 MB |  184938 GB |  184936 GB |
|       from small pool |      13 MB |      27 MB |    3662 GB |    3662 GB |
|---------------------------------------------------------------------------|
| Allocations           |    1920    |    1956    |  114112 K  |  114111 K  |
|       from large pool |     666    |     680    |   54346 K  |   54346 K  |
|       from small pool |    1254    |    1414    |   59765 K  |   59764 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1920    |    1956    |  114112 K  |  114111 K  |
|       from large pool |     666    |     680    |   54346 K  |   54346 K  |
|       from small pool |    1254    |    1414    |   59765 K  |   59764 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     156    |     178    |     329    |     173    |
|       from large pool |     130    |     130    |     246    |     116    |
|       from small pool |      26    |      48    |      83    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     148    |     213    |   73456 K  |   73456 K  |
|       from large pool |      86    |      98    |   42344 K  |   42344 K  |
|       from small pool |      62    |     119    |   31112 K  |   31112 K  |
|===========================================================================|

2022-04-25 14:24:24 - trainer.py[line:797] - WARNING: attempting to recover from OOM in forward/backward pass
2022-04-25 14:24:28 - progress_bar.py[line:272] - INFO: epoch 001:   2509 / 6136 loss=1.898, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.86, wps=66.7, ups=1.04, wpb=64, bsz=64, num_updates=2500, lr=6.83981e-06, gnorm=3.762, loss_scale=0.25, train_wall=8, gb_free=13.3, wall=8285
2022-04-25 14:24:28 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:28:23 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.606 | wps 83.6 | wpb 16 | bsz 16 | num_updates 2500 | best_acc 0.606
2022-04-25 14:28:32 - progress_bar.py[line:272] - INFO: epoch 001:   2519 / 6136 loss=1.88, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.84, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=2510, lr=6.83738e-06, gnorm=4.575, loss_scale=0.25, train_wall=9, gb_free=12.9, wall=8529
2022-04-25 14:28:41 - progress_bar.py[line:272] - INFO: epoch 001:   2529 / 6136 loss=1.838, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=2520, lr=6.83495e-06, gnorm=3.71, loss_scale=0.25, train_wall=9, gb_free=13.6, wall=8538
2022-04-25 14:28:49 - progress_bar.py[line:272] - INFO: epoch 001:   2539 / 6136 loss=1.897, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.86, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=2530, lr=6.83252e-06, gnorm=4.609, loss_scale=0.25, train_wall=8, gb_free=12.9, wall=8546
2022-04-25 14:28:58 - progress_bar.py[line:272] - INFO: epoch 001:   2549 / 6136 loss=1.918, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.89, wps=74.4, ups=1.16, wpb=64, bsz=64, num_updates=2540, lr=6.8301e-06, gnorm=4.504, loss_scale=0.25, train_wall=9, gb_free=14, wall=8555
2022-04-25 14:29:07 - progress_bar.py[line:272] - INFO: epoch 001:   2559 / 6136 loss=1.932, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.91, wps=64.9, ups=1.01, wpb=64, bsz=64, num_updates=2550, lr=6.82767e-06, gnorm=3.833, loss_scale=0.25, train_wall=10, gb_free=14.3, wall=8565
2022-04-25 14:29:16 - progress_bar.py[line:272] - INFO: epoch 001:   2569 / 6136 loss=1.879, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.84, wps=74.4, ups=1.16, wpb=64, bsz=64, num_updates=2560, lr=6.82524e-06, gnorm=3.367, loss_scale=0.25, train_wall=9, gb_free=13.8, wall=8574
2022-04-25 14:29:25 - progress_bar.py[line:272] - INFO: epoch 001:   2579 / 6136 loss=1.886, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.85, wps=75.6, ups=1.18, wpb=64, bsz=64, num_updates=2570, lr=6.82282e-06, gnorm=3.687, loss_scale=0.25, train_wall=8, gb_free=13.6, wall=8582
2022-04-25 14:29:33 - progress_bar.py[line:272] - INFO: epoch 001:   2589 / 6136 loss=1.934, loss_v1=0, loss_v2=0, nll_loss=0.932, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.91, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=2580, lr=6.82039e-06, gnorm=3.838, loss_scale=0.25, train_wall=8, gb_free=13.8, wall=8590
2022-04-25 14:29:42 - progress_bar.py[line:272] - INFO: epoch 001:   2599 / 6136 loss=1.864, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.82, wps=70.3, ups=1.1, wpb=64, bsz=64, num_updates=2590, lr=6.81796e-06, gnorm=4.299, loss_scale=0.25, train_wall=9, gb_free=10.4, wall=8599
2022-04-25 14:29:51 - progress_bar.py[line:272] - INFO: epoch 001:   2609 / 6136 loss=1.936, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.91, wps=74.4, ups=1.16, wpb=64, bsz=64, num_updates=2600, lr=6.81553e-06, gnorm=5.108, loss_scale=0.25, train_wall=9, gb_free=12.6, wall=8608
2022-04-25 14:29:51 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:33:55 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6165 | wps 80.4 | wpb 16 | bsz 16 | num_updates 2600 | best_acc 0.6165
2022-04-25 14:34:04 - progress_bar.py[line:272] - INFO: epoch 001:   2619 / 6136 loss=1.908, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.87, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=2610, lr=6.81311e-06, gnorm=4.117, loss_scale=0.25, train_wall=9, gb_free=13.4, wall=8861
2022-04-25 14:34:12 - progress_bar.py[line:272] - INFO: epoch 001:   2629 / 6136 loss=1.885, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.84, wps=73.5, ups=1.15, wpb=64, bsz=64, num_updates=2620, lr=6.81068e-06, gnorm=3.36, loss_scale=0.25, train_wall=9, gb_free=13.7, wall=8870
2022-04-25 14:34:21 - progress_bar.py[line:272] - INFO: epoch 001:   2639 / 6136 loss=1.922, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.89, wps=75.1, ups=1.17, wpb=64, bsz=64, num_updates=2630, lr=6.80825e-06, gnorm=3.889, loss_scale=0.25, train_wall=8, gb_free=9.6, wall=8879
2022-04-25 14:34:29 - progress_bar.py[line:272] - INFO: epoch 001:   2649 / 6136 loss=1.909, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.88, wps=77, ups=1.2, wpb=64, bsz=64, num_updates=2640, lr=6.80583e-06, gnorm=3.393, loss_scale=0.25, train_wall=8, gb_free=13.3, wall=8887
2022-04-25 14:34:38 - progress_bar.py[line:272] - INFO: epoch 001:   2659 / 6136 loss=1.851, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.8, wps=73.6, ups=1.15, wpb=64, bsz=64, num_updates=2650, lr=6.8034e-06, gnorm=3.3, loss_scale=0.25, train_wall=9, gb_free=12.3, wall=8896
2022-04-25 14:34:48 - progress_bar.py[line:272] - INFO: epoch 001:   2669 / 6136 loss=1.904, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.87, wps=63, ups=0.98, wpb=64, bsz=64, num_updates=2660, lr=6.80097e-06, gnorm=3.744, loss_scale=0.25, train_wall=10, gb_free=14.1, wall=8906
2022-04-25 14:34:56 - progress_bar.py[line:272] - INFO: epoch 001:   2679 / 6136 loss=1.881, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.84, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=2670, lr=6.79854e-06, gnorm=3.295, loss_scale=0.25, train_wall=8, gb_free=11.5, wall=8914
2022-04-25 14:35:04 - progress_bar.py[line:272] - INFO: epoch 001:   2689 / 6136 loss=1.875, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.83, wps=79.6, ups=1.24, wpb=64, bsz=64, num_updates=2680, lr=6.79612e-06, gnorm=3.453, loss_scale=0.25, train_wall=8, gb_free=14, wall=8922
2022-04-25 14:35:12 - progress_bar.py[line:272] - INFO: epoch 001:   2699 / 6136 loss=1.852, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.8, wps=79.8, ups=1.25, wpb=64, bsz=64, num_updates=2690, lr=6.79369e-06, gnorm=3.871, loss_scale=0.25, train_wall=8, gb_free=13.6, wall=8930
2022-04-25 14:35:21 - progress_bar.py[line:272] - INFO: epoch 001:   2709 / 6136 loss=1.898, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.86, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=2700, lr=6.79126e-06, gnorm=3.884, loss_scale=0.25, train_wall=8, gb_free=13.6, wall=8938
2022-04-25 14:35:21 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:39:24 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6294 | wps 80.7 | wpb 16 | bsz 16 | num_updates 2700 | best_acc 0.6294
2022-04-25 14:39:33 - progress_bar.py[line:272] - INFO: epoch 001:   2719 / 6136 loss=1.862, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.82, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=2710, lr=6.78883e-06, gnorm=2.922, loss_scale=0.25, train_wall=8, gb_free=13.7, wall=9190
2022-04-25 14:39:41 - progress_bar.py[line:272] - INFO: epoch 001:   2729 / 6136 loss=1.856, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.81, wps=80.5, ups=1.26, wpb=64, bsz=64, num_updates=2720, lr=6.78641e-06, gnorm=3.519, loss_scale=0.25, train_wall=8, gb_free=13.5, wall=9198
2022-04-25 14:39:48 - progress_bar.py[line:272] - INFO: epoch 001:   2739 / 6136 loss=1.894, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.86, wps=80.7, ups=1.26, wpb=64, bsz=64, num_updates=2730, lr=6.78398e-06, gnorm=3.434, loss_scale=0.25, train_wall=8, gb_free=12.7, wall=9206
2022-04-25 14:39:57 - progress_bar.py[line:272] - INFO: epoch 001:   2749 / 6136 loss=1.861, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.81, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=2740, lr=6.78155e-06, gnorm=3.031, loss_scale=0.25, train_wall=8, gb_free=13.3, wall=9214
2022-04-25 14:40:05 - progress_bar.py[line:272] - INFO: epoch 001:   2759 / 6136 loss=1.848, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.8, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=2750, lr=6.77913e-06, gnorm=3.289, loss_scale=0.25, train_wall=8, gb_free=13.5, wall=9222
2022-04-25 14:40:14 - progress_bar.py[line:272] - INFO: epoch 001:   2769 / 6136 loss=1.87, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.83, wps=70.3, ups=1.1, wpb=64, bsz=64, num_updates=2760, lr=6.7767e-06, gnorm=4.012, loss_scale=0.25, train_wall=9, gb_free=13.1, wall=9231
2022-04-25 14:40:22 - progress_bar.py[line:272] - INFO: epoch 001:   2779 / 6136 loss=1.877, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.83, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=2770, lr=6.77427e-06, gnorm=3.661, loss_scale=0.25, train_wall=8, gb_free=9.1, wall=9240
2022-04-25 14:40:30 - progress_bar.py[line:272] - INFO: epoch 001:   2789 / 6136 loss=1.857, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.81, wps=79.4, ups=1.24, wpb=64, bsz=64, num_updates=2780, lr=6.77184e-06, gnorm=3.142, loss_scale=0.25, train_wall=8, gb_free=13.4, wall=9248
2022-04-25 14:40:38 - progress_bar.py[line:272] - INFO: epoch 001:   2799 / 6136 loss=1.886, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.85, wps=79.4, ups=1.24, wpb=64, bsz=64, num_updates=2790, lr=6.76942e-06, gnorm=3.955, loss_scale=0.25, train_wall=8, gb_free=13.5, wall=9256
2022-04-25 14:40:47 - progress_bar.py[line:272] - INFO: epoch 001:   2809 / 6136 loss=1.868, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.82, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=2800, lr=6.76699e-06, gnorm=3.539, loss_scale=0.25, train_wall=8, gb_free=13.7, wall=9264
2022-04-25 14:40:47 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:46 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:44:47 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.825 | loss_v1 0 | loss_v2 0 | nll_loss 0.822 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.77 | acc 0.6344 | wps 81.9 | wpb 16 | bsz 16 | num_updates 2800 | best_acc 0.6344
2022-04-25 14:44:55 - progress_bar.py[line:272] - INFO: epoch 001:   2819 / 6136 loss=1.904, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.87, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=2810, lr=6.76456e-06, gnorm=3.57, loss_scale=0.25, train_wall=8, gb_free=13.1, wall=9512
2022-04-25 14:45:03 - progress_bar.py[line:272] - INFO: epoch 001:   2829 / 6136 loss=1.894, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.86, wps=79.6, ups=1.24, wpb=64, bsz=64, num_updates=2820, lr=6.76214e-06, gnorm=4.115, loss_scale=0.25, train_wall=8, gb_free=13.9, wall=9520
2022-04-25 14:45:11 - progress_bar.py[line:272] - INFO: epoch 001:   2839 / 6136 loss=1.852, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.8, wps=79.9, ups=1.25, wpb=64, bsz=64, num_updates=2830, lr=6.75971e-06, gnorm=3.919, loss_scale=0.25, train_wall=8, gb_free=13.7, wall=9528
2022-04-25 14:45:15 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.125
2022-04-25 14:45:20 - progress_bar.py[line:272] - INFO: epoch 001:   2850 / 6136 loss=1.8, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=65.5, ups=1.02, wpb=64, bsz=64, num_updates=2840, lr=6.75728e-06, gnorm=2.974, loss_scale=0.125, train_wall=10, gb_free=12.9, wall=9538
2022-04-25 14:45:29 - progress_bar.py[line:272] - INFO: epoch 001:   2860 / 6136 loss=1.859, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.81, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=2850, lr=6.75485e-06, gnorm=3.803, loss_scale=0.125, train_wall=8, gb_free=13.7, wall=9546
2022-04-25 14:45:37 - progress_bar.py[line:272] - INFO: epoch 001:   2870 / 6136 loss=1.841, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=2860, lr=6.75243e-06, gnorm=3.322, loss_scale=0.125, train_wall=8, gb_free=13.4, wall=9555
2022-04-25 14:45:45 - progress_bar.py[line:272] - INFO: epoch 001:   2880 / 6136 loss=1.842, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=2870, lr=6.75e-06, gnorm=3.956, loss_scale=0.125, train_wall=8, gb_free=13.8, wall=9563
2022-04-25 14:45:53 - progress_bar.py[line:272] - INFO: epoch 001:   2890 / 6136 loss=1.826, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=2880, lr=6.74757e-06, gnorm=3.417, loss_scale=0.125, train_wall=8, gb_free=12.6, wall=9571
2022-04-25 14:46:01 - progress_bar.py[line:272] - INFO: epoch 001:   2900 / 6136 loss=1.923, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.89, wps=78.8, ups=1.23, wpb=64, bsz=64, num_updates=2890, lr=6.74515e-06, gnorm=3.319, loss_scale=0.125, train_wall=8, gb_free=13.6, wall=9579
2022-04-25 14:46:09 - progress_bar.py[line:272] - INFO: epoch 001:   2910 / 6136 loss=1.837, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.78, wps=79.4, ups=1.24, wpb=64, bsz=64, num_updates=2900, lr=6.74272e-06, gnorm=3.754, loss_scale=0.125, train_wall=8, gb_free=13.2, wall=9587
2022-04-25 14:46:09 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:50:16 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.826 | loss_v1 0 | loss_v2 0 | nll_loss 0.824 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.77 | acc 0.6363 | wps 79.7 | wpb 16 | bsz 16 | num_updates 2900 | best_acc 0.6363
2022-04-25 14:50:27 - progress_bar.py[line:272] - INFO: epoch 001:   2920 / 6136 loss=1.875, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.83, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=2910, lr=6.74029e-06, gnorm=3.963, loss_scale=0.125, train_wall=11, gb_free=9.9, wall=9845
2022-04-25 14:50:36 - progress_bar.py[line:272] - INFO: epoch 001:   2930 / 6136 loss=1.799, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=74.4, ups=1.16, wpb=64, bsz=64, num_updates=2920, lr=6.73786e-06, gnorm=3.755, loss_scale=0.125, train_wall=9, gb_free=13.7, wall=9853
2022-04-25 14:50:44 - progress_bar.py[line:272] - INFO: epoch 001:   2940 / 6136 loss=1.816, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=2930, lr=6.73544e-06, gnorm=3.36, loss_scale=0.125, train_wall=8, gb_free=13.9, wall=9862
2022-04-25 14:50:52 - progress_bar.py[line:272] - INFO: epoch 001:   2950 / 6136 loss=1.903, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.87, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=2940, lr=6.73301e-06, gnorm=3.948, loss_scale=0.125, train_wall=8, gb_free=14.2, wall=9870
2022-04-25 14:51:01 - progress_bar.py[line:272] - INFO: epoch 001:   2960 / 6136 loss=1.85, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.8, wps=69.8, ups=1.09, wpb=64, bsz=64, num_updates=2950, lr=6.73058e-06, gnorm=3.785, loss_scale=0.125, train_wall=9, gb_free=12, wall=9879
2022-04-25 14:51:10 - progress_bar.py[line:272] - INFO: epoch 001:   2970 / 6136 loss=1.871, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.83, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=2960, lr=6.72816e-06, gnorm=3.537, loss_scale=0.125, train_wall=8, gb_free=12.6, wall=9887
2022-04-25 14:51:18 - progress_bar.py[line:272] - INFO: epoch 001:   2980 / 6136 loss=1.783, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=2970, lr=6.72573e-06, gnorm=3.477, loss_scale=0.125, train_wall=8, gb_free=12.5, wall=9896
2022-04-25 14:51:25 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.0625
2022-04-25 14:51:28 - progress_bar.py[line:272] - INFO: epoch 001:   2991 / 6136 loss=1.801, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=69.1, ups=1.08, wpb=64, bsz=64, num_updates=2980, lr=6.7233e-06, gnorm=3.219, loss_scale=0.0625, train_wall=9, gb_free=12.8, wall=9905
2022-04-25 14:51:36 - progress_bar.py[line:272] - INFO: epoch 001:   3001 / 6136 loss=1.848, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.8, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=2990, lr=6.72087e-06, gnorm=2.944, loss_scale=0.0625, train_wall=8, gb_free=13.7, wall=9913
2022-04-25 14:51:44 - progress_bar.py[line:272] - INFO: epoch 001:   3011 / 6136 loss=1.808, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=76.4, ups=1.19, wpb=64, bsz=64, num_updates=3000, lr=6.71845e-06, gnorm=3.429, loss_scale=0.0625, train_wall=8, gb_free=13.1, wall=9922
2022-04-25 14:51:44 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 14:55:59 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6504 | wps 77.2 | wpb 16 | bsz 16 | num_updates 3000 | best_acc 0.6504
2022-04-25 14:55:59 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 3000 updates
2022-04-25 14:55:59 - trainer.py[line:432] - INFO: Saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_3000.pt
2022-04-25 14:56:10 - trainer.py[line:442] - INFO: Finished saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_3000.pt
2022-04-25 14:56:33 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_3000.pt (epoch 1 @ 3000 updates, score 0.6504) (writing took 33.95770281692967 seconds)
2022-04-25 14:56:42 - progress_bar.py[line:272] - INFO: epoch 001:   3021 / 6136 loss=1.861, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.81, wps=2.1, ups=0.03, wpb=64, bsz=64, num_updates=3010, lr=6.71602e-06, gnorm=3.351, loss_scale=0.0625, train_wall=9, gb_free=13.6, wall=10220
2022-04-25 14:56:50 - progress_bar.py[line:272] - INFO: epoch 001:   3031 / 6136 loss=1.843, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=79, ups=1.23, wpb=64, bsz=64, num_updates=3020, lr=6.71359e-06, gnorm=4.316, loss_scale=0.0625, train_wall=8, gb_free=14, wall=10228
2022-04-25 14:56:59 - progress_bar.py[line:272] - INFO: epoch 001:   3041 / 6136 loss=1.855, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.81, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=3030, lr=6.71117e-06, gnorm=4.43, loss_scale=0.0625, train_wall=8, gb_free=13.1, wall=10236
2022-04-25 14:57:07 - progress_bar.py[line:272] - INFO: epoch 001:   3051 / 6136 loss=1.826, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=76.7, ups=1.2, wpb=64, bsz=64, num_updates=3040, lr=6.70874e-06, gnorm=3.646, loss_scale=0.0625, train_wall=8, gb_free=10.6, wall=10245
2022-04-25 14:57:15 - progress_bar.py[line:272] - INFO: epoch 001:   3061 / 6136 loss=1.819, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=3050, lr=6.70631e-06, gnorm=3.468, loss_scale=0.0625, train_wall=8, gb_free=13.3, wall=10253
2022-04-25 14:57:24 - progress_bar.py[line:272] - INFO: epoch 001:   3071 / 6136 loss=1.797, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=3060, lr=6.70388e-06, gnorm=3.394, loss_scale=0.0625, train_wall=8, gb_free=13.4, wall=10261
2022-04-25 14:57:32 - progress_bar.py[line:272] - INFO: epoch 001:   3081 / 6136 loss=1.868, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.82, wps=76, ups=1.19, wpb=64, bsz=64, num_updates=3070, lr=6.70146e-06, gnorm=3.8, loss_scale=0.0625, train_wall=8, gb_free=13.4, wall=10269
2022-04-25 14:57:42 - progress_bar.py[line:272] - INFO: epoch 001:   3091 / 6136 loss=1.845, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=66.5, ups=1.04, wpb=64, bsz=64, num_updates=3080, lr=6.69903e-06, gnorm=3.232, loss_scale=0.0625, train_wall=10, gb_free=13.6, wall=10279
2022-04-25 14:57:50 - progress_bar.py[line:272] - INFO: epoch 001:   3101 / 6136 loss=1.829, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=77, ups=1.2, wpb=64, bsz=64, num_updates=3090, lr=6.6966e-06, gnorm=3.2, loss_scale=0.0625, train_wall=8, gb_free=13.9, wall=10287
2022-04-25 14:57:58 - progress_bar.py[line:272] - INFO: epoch 001:   3111 / 6136 loss=1.885, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.84, wps=75.4, ups=1.18, wpb=64, bsz=64, num_updates=3100, lr=6.69417e-06, gnorm=4.003, loss_scale=0.0625, train_wall=8, gb_free=13.8, wall=10296
2022-04-25 14:57:58 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:02:00 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6429 | wps 81.5 | wpb 16 | bsz 16 | num_updates 3100 | best_acc 0.6504
2022-04-25 15:02:08 - progress_bar.py[line:272] - INFO: epoch 001:   3121 / 6136 loss=1.85, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.8, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=3110, lr=6.69175e-06, gnorm=3.434, loss_scale=0.0625, train_wall=9, gb_free=10.7, wall=10546
2022-04-25 15:02:17 - progress_bar.py[line:272] - INFO: epoch 001:   3131 / 6136 loss=1.841, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=3120, lr=6.68932e-06, gnorm=3.365, loss_scale=0.0625, train_wall=8, gb_free=13.9, wall=10554
2022-04-25 15:02:25 - progress_bar.py[line:272] - INFO: epoch 001:   3141 / 6136 loss=1.825, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=77.3, ups=1.21, wpb=64, bsz=64, num_updates=3130, lr=6.68689e-06, gnorm=3.446, loss_scale=0.0625, train_wall=8, gb_free=13.7, wall=10563
2022-04-25 15:02:36 - progress_bar.py[line:272] - INFO: epoch 001:   3151 / 6136 loss=1.819, loss_v1=0, loss_v2=0, nll_loss=0.817, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=58.2, ups=0.91, wpb=64, bsz=64, num_updates=3140, lr=6.68447e-06, gnorm=3.653, loss_scale=0.0625, train_wall=11, gb_free=12.8, wall=10574
2022-04-25 15:02:45 - progress_bar.py[line:272] - INFO: epoch 001:   3161 / 6136 loss=1.824, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=75.4, ups=1.18, wpb=64, bsz=64, num_updates=3150, lr=6.68204e-06, gnorm=3.686, loss_scale=0.0625, train_wall=8, gb_free=13.6, wall=10582
2022-04-25 15:02:54 - progress_bar.py[line:272] - INFO: epoch 001:   3171 / 6136 loss=1.795, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=68.3, ups=1.07, wpb=64, bsz=64, num_updates=3160, lr=6.67961e-06, gnorm=3.969, loss_scale=0.0625, train_wall=9, gb_free=13.5, wall=10591
2022-04-25 15:03:03 - progress_bar.py[line:272] - INFO: epoch 001:   3181 / 6136 loss=1.839, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=69.3, ups=1.08, wpb=64, bsz=64, num_updates=3170, lr=6.67718e-06, gnorm=3.375, loss_scale=0.0625, train_wall=9, gb_free=13.1, wall=10601
2022-04-25 15:03:12 - progress_bar.py[line:272] - INFO: epoch 001:   3191 / 6136 loss=1.819, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=74.2, ups=1.16, wpb=64, bsz=64, num_updates=3180, lr=6.67476e-06, gnorm=4.178, loss_scale=0.0625, train_wall=9, gb_free=13.1, wall=10609
2022-04-25 15:03:20 - progress_bar.py[line:272] - INFO: epoch 001:   3201 / 6136 loss=1.851, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.8, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=3190, lr=6.67233e-06, gnorm=3.643, loss_scale=0.0625, train_wall=8, gb_free=13.8, wall=10618
2022-04-25 15:03:29 - progress_bar.py[line:272] - INFO: epoch 001:   3211 / 6136 loss=1.895, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.86, wps=70.5, ups=1.1, wpb=64, bsz=64, num_updates=3200, lr=6.6699e-06, gnorm=3.549, loss_scale=0.0625, train_wall=9, gb_free=10.5, wall=10627
2022-04-25 15:03:29 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:07:47 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6534 | wps 76.3 | wpb 16 | bsz 16 | num_updates 3200 | best_acc 0.6534
2022-04-25 15:07:48 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.03125
2022-04-25 15:07:48 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:12:05 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.791 | loss_v1 0 | loss_v2 0 | nll_loss 0.788 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.73 | acc 0.6538 | wps 76.5 | wpb 16 | bsz 16 | num_updates 3200 | best_acc 0.6538
2022-04-25 15:12:14 - progress_bar.py[line:272] - INFO: epoch 001:   3222 / 6136 loss=1.857, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.81, wps=1.2, ups=0.02, wpb=64, bsz=64, num_updates=3210, lr=6.66748e-06, gnorm=3.32, loss_scale=0.0312, train_wall=9, gb_free=14.1, wall=11151
2022-04-25 15:12:22 - progress_bar.py[line:272] - INFO: epoch 001:   3232 / 6136 loss=1.837, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.78, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=3220, lr=6.66505e-06, gnorm=3.022, loss_scale=0.0312, train_wall=8, gb_free=14, wall=11160
2022-04-25 15:12:31 - progress_bar.py[line:272] - INFO: epoch 001:   3242 / 6136 loss=1.883, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.84, wps=72.2, ups=1.13, wpb=64, bsz=64, num_updates=3230, lr=6.66262e-06, gnorm=3.25, loss_scale=0.0312, train_wall=9, gb_free=13.1, wall=11168
2022-04-25 15:12:40 - progress_bar.py[line:272] - INFO: epoch 001:   3252 / 6136 loss=1.821, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=70.2, ups=1.1, wpb=64, bsz=64, num_updates=3240, lr=6.66019e-06, gnorm=3.388, loss_scale=0.0312, train_wall=9, gb_free=14.1, wall=11177
2022-04-25 15:12:48 - progress_bar.py[line:272] - INFO: epoch 001:   3262 / 6136 loss=1.806, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=3250, lr=6.65777e-06, gnorm=3.472, loss_scale=0.0312, train_wall=8, gb_free=13.9, wall=11186
2022-04-25 15:12:58 - progress_bar.py[line:272] - INFO: epoch 001:   3272 / 6136 loss=1.894, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.86, wps=68, ups=1.06, wpb=64, bsz=64, num_updates=3260, lr=6.65534e-06, gnorm=3.905, loss_scale=0.0312, train_wall=9, gb_free=14.2, wall=11195
2022-04-25 15:13:06 - progress_bar.py[line:272] - INFO: epoch 001:   3282 / 6136 loss=1.792, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=74.9, ups=1.17, wpb=64, bsz=64, num_updates=3270, lr=6.65291e-06, gnorm=3.032, loss_scale=0.0312, train_wall=8, gb_free=13.9, wall=11204
2022-04-25 15:13:14 - progress_bar.py[line:272] - INFO: epoch 001:   3292 / 6136 loss=1.824, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=3280, lr=6.65049e-06, gnorm=3.551, loss_scale=0.0312, train_wall=8, gb_free=12.4, wall=11212
2022-04-25 15:13:23 - progress_bar.py[line:272] - INFO: epoch 001:   3302 / 6136 loss=1.776, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=76.7, ups=1.2, wpb=64, bsz=64, num_updates=3290, lr=6.64806e-06, gnorm=3.345, loss_scale=0.0312, train_wall=8, gb_free=13.9, wall=11220
2022-04-25 15:13:31 - progress_bar.py[line:272] - INFO: epoch 001:   3312 / 6136 loss=1.854, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.81, wps=76.7, ups=1.2, wpb=64, bsz=64, num_updates=3300, lr=6.64563e-06, gnorm=3.644, loss_scale=0.0312, train_wall=8, gb_free=14.3, wall=11229
2022-04-25 15:13:31 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:17:47 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6621 | wps 76.8 | wpb 16 | bsz 16 | num_updates 3300 | best_acc 0.6621
2022-04-25 15:17:56 - progress_bar.py[line:272] - INFO: epoch 001:   3322 / 6136 loss=1.823, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=3310, lr=6.6432e-06, gnorm=3.377, loss_scale=0.0312, train_wall=8, gb_free=14.1, wall=11493
2022-04-25 15:18:05 - progress_bar.py[line:272] - INFO: epoch 001:   3332 / 6136 loss=1.815, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=72.1, ups=1.13, wpb=64, bsz=64, num_updates=3320, lr=6.64078e-06, gnorm=3.739, loss_scale=0.0312, train_wall=9, gb_free=9.8, wall=11502
2022-04-25 15:18:13 - progress_bar.py[line:272] - INFO: epoch 001:   3342 / 6136 loss=1.842, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=3330, lr=6.63835e-06, gnorm=5.824, loss_scale=0.0312, train_wall=8, gb_free=13.7, wall=11510
2022-04-25 15:18:21 - progress_bar.py[line:272] - INFO: epoch 001:   3352 / 6136 loss=1.836, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.78, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=3340, lr=6.63592e-06, gnorm=3.446, loss_scale=0.0312, train_wall=8, gb_free=13.9, wall=11519
2022-04-25 15:18:30 - progress_bar.py[line:272] - INFO: epoch 001:   3362 / 6136 loss=1.788, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=75.4, ups=1.18, wpb=64, bsz=64, num_updates=3350, lr=6.6335e-06, gnorm=3.238, loss_scale=0.0312, train_wall=8, gb_free=13.2, wall=11527
2022-04-25 15:18:38 - progress_bar.py[line:272] - INFO: epoch 001:   3372 / 6136 loss=1.829, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=3360, lr=6.63107e-06, gnorm=3.503, loss_scale=0.0312, train_wall=8, gb_free=13.2, wall=11536
2022-04-25 15:18:47 - progress_bar.py[line:272] - INFO: epoch 001:   3382 / 6136 loss=1.806, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=76.7, ups=1.2, wpb=64, bsz=64, num_updates=3370, lr=6.62864e-06, gnorm=3.537, loss_scale=0.0312, train_wall=8, gb_free=12.6, wall=11544
2022-04-25 15:18:55 - progress_bar.py[line:272] - INFO: epoch 001:   3392 / 6136 loss=1.825, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=3380, lr=6.62621e-06, gnorm=3.19, loss_scale=0.0312, train_wall=8, gb_free=13.3, wall=11552
2022-04-25 15:19:03 - progress_bar.py[line:272] - INFO: epoch 001:   3402 / 6136 loss=1.829, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=74.8, ups=1.17, wpb=64, bsz=64, num_updates=3390, lr=6.62379e-06, gnorm=2.944, loss_scale=0.0312, train_wall=9, gb_free=14, wall=11561
2022-04-25 15:19:13 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.015625
2022-04-25 15:19:14 - progress_bar.py[line:272] - INFO: epoch 001:   3413 / 6136 loss=1.815, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=60.6, ups=0.95, wpb=64, bsz=64, num_updates=3400, lr=6.62136e-06, gnorm=2.887, loss_scale=0.0156, train_wall=10, gb_free=10.9, wall=11571
2022-04-25 15:19:14 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:23:31 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.787 | loss_v1 0 | loss_v2 0 | nll_loss 0.784 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.72 | acc 0.6562 | wps 76.6 | wpb 16 | bsz 16 | num_updates 3400 | best_acc 0.6562
2022-04-25 15:23:39 - progress_bar.py[line:272] - INFO: epoch 001:   3423 / 6136 loss=1.793, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=3410, lr=6.61893e-06, gnorm=3.444, loss_scale=0.0156, train_wall=8, gb_free=13.4, wall=11837
2022-04-25 15:23:47 - progress_bar.py[line:272] - INFO: epoch 001:   3433 / 6136 loss=1.838, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=3420, lr=6.6165e-06, gnorm=3.43, loss_scale=0.0156, train_wall=8, gb_free=13.4, wall=11845
2022-04-25 15:23:55 - progress_bar.py[line:272] - INFO: epoch 001:   3443 / 6136 loss=1.841, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=3430, lr=6.61408e-06, gnorm=2.985, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=11853
2022-04-25 15:24:04 - progress_bar.py[line:272] - INFO: epoch 001:   3453 / 6136 loss=1.823, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=3440, lr=6.61165e-06, gnorm=3.576, loss_scale=0.0156, train_wall=8, gb_free=13.8, wall=11861
2022-04-25 15:24:12 - progress_bar.py[line:272] - INFO: epoch 001:   3463 / 6136 loss=1.79, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=73.7, ups=1.15, wpb=64, bsz=64, num_updates=3450, lr=6.60922e-06, gnorm=3.033, loss_scale=0.0156, train_wall=9, gb_free=14, wall=11870
2022-04-25 15:24:21 - progress_bar.py[line:272] - INFO: epoch 001:   3473 / 6136 loss=1.797, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=73.5, ups=1.15, wpb=64, bsz=64, num_updates=3460, lr=6.6068e-06, gnorm=3.6, loss_scale=0.0156, train_wall=9, gb_free=13.7, wall=11878
2022-04-25 15:24:29 - progress_bar.py[line:272] - INFO: epoch 001:   3483 / 6136 loss=1.807, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=76, ups=1.19, wpb=64, bsz=64, num_updates=3470, lr=6.60437e-06, gnorm=3.215, loss_scale=0.0156, train_wall=8, gb_free=12.7, wall=11887
2022-04-25 15:24:38 - progress_bar.py[line:272] - INFO: epoch 001:   3493 / 6136 loss=1.815, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=3480, lr=6.60194e-06, gnorm=3.469, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=11895
2022-04-25 15:24:46 - progress_bar.py[line:272] - INFO: epoch 001:   3503 / 6136 loss=1.821, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=74.2, ups=1.16, wpb=64, bsz=64, num_updates=3490, lr=6.59951e-06, gnorm=3.913, loss_scale=0.0156, train_wall=9, gb_free=14, wall=11904
2022-04-25 15:24:56 - progress_bar.py[line:272] - INFO: epoch 001:   3513 / 6136 loss=1.785, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=68.7, ups=1.07, wpb=64, bsz=64, num_updates=3500, lr=6.59709e-06, gnorm=3.606, loss_scale=0.0156, train_wall=9, gb_free=13.7, wall=11913
2022-04-25 15:24:56 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:28:52 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.766 | loss_v1 0 | loss_v2 0 | nll_loss 0.763 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.7 | acc 0.6662 | wps 83.4 | wpb 16 | bsz 16 | num_updates 3500 | best_acc 0.6662
2022-04-25 15:29:00 - progress_bar.py[line:272] - INFO: epoch 001:   3523 / 6136 loss=1.766, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=3510, lr=6.59466e-06, gnorm=3.775, loss_scale=0.0156, train_wall=8, gb_free=13.3, wall=12157
2022-04-25 15:29:09 - progress_bar.py[line:272] - INFO: epoch 001:   3533 / 6136 loss=1.767, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=72.1, ups=1.13, wpb=64, bsz=64, num_updates=3520, lr=6.59223e-06, gnorm=3.575, loss_scale=0.0156, train_wall=9, gb_free=13.4, wall=12166
2022-04-25 15:29:17 - progress_bar.py[line:272] - INFO: epoch 001:   3543 / 6136 loss=1.841, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=78.4, ups=1.23, wpb=64, bsz=64, num_updates=3530, lr=6.58981e-06, gnorm=3.489, loss_scale=0.0156, train_wall=8, gb_free=13.9, wall=12174
2022-04-25 15:29:25 - progress_bar.py[line:272] - INFO: epoch 001:   3553 / 6136 loss=1.833, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.78, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=3540, lr=6.58738e-06, gnorm=3.696, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=12183
2022-04-25 15:29:34 - progress_bar.py[line:272] - INFO: epoch 001:   3563 / 6136 loss=1.852, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.8, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=3550, lr=6.58495e-06, gnorm=3.118, loss_scale=0.0156, train_wall=8, gb_free=12.7, wall=12191
2022-04-25 15:29:42 - progress_bar.py[line:272] - INFO: epoch 001:   3573 / 6136 loss=1.831, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.78, wps=80.3, ups=1.25, wpb=64, bsz=64, num_updates=3560, lr=6.58252e-06, gnorm=3.448, loss_scale=0.0156, train_wall=8, gb_free=13.9, wall=12199
2022-04-25 15:29:50 - progress_bar.py[line:272] - INFO: epoch 001:   3583 / 6136 loss=1.817, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=75.1, ups=1.17, wpb=64, bsz=64, num_updates=3570, lr=6.5801e-06, gnorm=2.967, loss_scale=0.0156, train_wall=8, gb_free=14, wall=12208
2022-04-25 15:29:59 - progress_bar.py[line:272] - INFO: epoch 001:   3593 / 6136 loss=1.769, loss_v1=0, loss_v2=0, nll_loss=0.767, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=76, ups=1.19, wpb=64, bsz=64, num_updates=3580, lr=6.57767e-06, gnorm=3.499, loss_scale=0.0156, train_wall=8, gb_free=13, wall=12216
2022-04-25 15:30:07 - progress_bar.py[line:272] - INFO: epoch 001:   3603 / 6136 loss=1.806, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=75, ups=1.17, wpb=64, bsz=64, num_updates=3590, lr=6.57524e-06, gnorm=3.334, loss_scale=0.0156, train_wall=8, gb_free=12.8, wall=12225
2022-04-25 15:30:15 - progress_bar.py[line:272] - INFO: epoch 001:   3613 / 6136 loss=1.788, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=79.4, ups=1.24, wpb=64, bsz=64, num_updates=3600, lr=6.57282e-06, gnorm=3.397, loss_scale=0.0156, train_wall=8, gb_free=13.5, wall=12233
2022-04-25 15:30:15 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:34:20 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.771 | loss_v1 0 | loss_v2 0 | nll_loss 0.768 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.7 | acc 0.6647 | wps 80.4 | wpb 16 | bsz 16 | num_updates 3600 | best_acc 0.6647
2022-04-25 15:34:29 - progress_bar.py[line:272] - INFO: epoch 001:   3623 / 6136 loss=1.785, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=3610, lr=6.57039e-06, gnorm=3.242, loss_scale=0.0156, train_wall=9, gb_free=12.7, wall=12486
2022-04-25 15:34:38 - progress_bar.py[line:272] - INFO: epoch 001:   3633 / 6136 loss=1.793, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=73, ups=1.14, wpb=64, bsz=64, num_updates=3620, lr=6.56796e-06, gnorm=104.691, loss_scale=0.0156, train_wall=9, gb_free=13.4, wall=12495
2022-04-25 15:34:46 - progress_bar.py[line:272] - INFO: epoch 001:   3643 / 6136 loss=1.8, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=73.2, ups=1.14, wpb=64, bsz=64, num_updates=3630, lr=6.56553e-06, gnorm=3.303, loss_scale=0.0156, train_wall=9, gb_free=14.1, wall=12504
2022-04-25 15:34:55 - progress_bar.py[line:272] - INFO: epoch 001:   3653 / 6136 loss=1.796, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=70.4, ups=1.1, wpb=64, bsz=64, num_updates=3640, lr=6.56311e-06, gnorm=3.352, loss_scale=0.0156, train_wall=9, gb_free=12.9, wall=12513
2022-04-25 15:35:06 - progress_bar.py[line:272] - INFO: epoch 001:   3663 / 6136 loss=1.803, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=61.4, ups=0.96, wpb=64, bsz=64, num_updates=3650, lr=6.56068e-06, gnorm=3.253, loss_scale=0.0156, train_wall=10, gb_free=14.1, wall=12523
2022-04-25 15:35:14 - progress_bar.py[line:272] - INFO: epoch 001:   3673 / 6136 loss=1.776, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=3660, lr=6.55825e-06, gnorm=3.607, loss_scale=0.0156, train_wall=8, gb_free=13.4, wall=12532
2022-04-25 15:35:23 - progress_bar.py[line:272] - INFO: epoch 001:   3683 / 6136 loss=1.794, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=77, ups=1.2, wpb=64, bsz=64, num_updates=3670, lr=6.55583e-06, gnorm=3.653, loss_scale=0.0156, train_wall=8, gb_free=13.1, wall=12540
2022-04-25 15:35:31 - progress_bar.py[line:272] - INFO: epoch 001:   3693 / 6136 loss=1.868, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.82, wps=77.3, ups=1.21, wpb=64, bsz=64, num_updates=3680, lr=6.5534e-06, gnorm=3.912, loss_scale=0.0156, train_wall=8, gb_free=13, wall=12548
2022-04-25 15:35:39 - progress_bar.py[line:272] - INFO: epoch 001:   3703 / 6136 loss=1.807, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=76.4, ups=1.19, wpb=64, bsz=64, num_updates=3690, lr=6.55097e-06, gnorm=3.4, loss_scale=0.0156, train_wall=8, gb_free=13.4, wall=12557
2022-04-25 15:35:48 - progress_bar.py[line:272] - INFO: epoch 001:   3713 / 6136 loss=1.815, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=73.2, ups=1.14, wpb=64, bsz=64, num_updates=3700, lr=6.54854e-06, gnorm=3.414, loss_scale=0.0156, train_wall=9, gb_free=13.3, wall=12565
2022-04-25 15:35:48 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:39:56 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.767 | loss_v1 0 | loss_v2 0 | nll_loss 0.764 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.7 | acc 0.6701 | wps 79.1 | wpb 16 | bsz 16 | num_updates 3700 | best_acc 0.6701
2022-04-25 15:40:05 - progress_bar.py[line:272] - INFO: epoch 001:   3723 / 6136 loss=1.745, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=3710, lr=6.54612e-06, gnorm=3.145, loss_scale=0.0156, train_wall=8, gb_free=13.6, wall=12822
2022-04-25 15:40:13 - progress_bar.py[line:272] - INFO: epoch 001:   3733 / 6136 loss=1.864, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.82, wps=75.9, ups=1.19, wpb=64, bsz=64, num_updates=3720, lr=6.54369e-06, gnorm=3.29, loss_scale=0.0156, train_wall=8, gb_free=12.5, wall=12831
2022-04-25 15:40:22 - progress_bar.py[line:272] - INFO: epoch 001:   3743 / 6136 loss=1.825, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=74.8, ups=1.17, wpb=64, bsz=64, num_updates=3730, lr=6.54126e-06, gnorm=3.395, loss_scale=0.0156, train_wall=9, gb_free=13.6, wall=12839
2022-04-25 15:40:30 - progress_bar.py[line:272] - INFO: epoch 001:   3753 / 6136 loss=1.78, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=3740, lr=6.53883e-06, gnorm=3.005, loss_scale=0.0156, train_wall=8, gb_free=14.1, wall=12848
2022-04-25 15:40:39 - progress_bar.py[line:272] - INFO: epoch 001:   3763 / 6136 loss=1.807, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=74.5, ups=1.16, wpb=64, bsz=64, num_updates=3750, lr=6.53641e-06, gnorm=3.642, loss_scale=0.0156, train_wall=9, gb_free=13.8, wall=12856
2022-04-25 15:40:47 - progress_bar.py[line:272] - INFO: epoch 001:   3773 / 6136 loss=1.814, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=78.7, ups=1.23, wpb=64, bsz=64, num_updates=3760, lr=6.53398e-06, gnorm=3.411, loss_scale=0.0156, train_wall=8, gb_free=13.1, wall=12864
2022-04-25 15:40:55 - progress_bar.py[line:272] - INFO: epoch 001:   3783 / 6136 loss=1.773, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=3770, lr=6.53155e-06, gnorm=3.263, loss_scale=0.0156, train_wall=8, gb_free=13.9, wall=12873
2022-04-25 15:41:04 - progress_bar.py[line:272] - INFO: epoch 001:   3793 / 6136 loss=1.794, loss_v1=0, loss_v2=0, nll_loss=0.792, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=3780, lr=6.52913e-06, gnorm=3.341, loss_scale=0.0156, train_wall=8, gb_free=12.8, wall=12881
2022-04-25 15:41:12 - progress_bar.py[line:272] - INFO: epoch 001:   3803 / 6136 loss=1.826, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=3790, lr=6.5267e-06, gnorm=4.143, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=12890
2022-04-25 15:41:21 - progress_bar.py[line:272] - INFO: epoch 001:   3813 / 6136 loss=1.831, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.78, wps=72.9, ups=1.14, wpb=64, bsz=64, num_updates=3800, lr=6.52427e-06, gnorm=3.621, loss_scale=0.0156, train_wall=9, gb_free=13.7, wall=12898
2022-04-25 15:41:21 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:45:40 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6676 | wps 75.9 | wpb 16 | bsz 16 | num_updates 3800 | best_acc 0.6676
2022-04-25 15:45:50 - progress_bar.py[line:272] - INFO: epoch 001:   3823 / 6136 loss=1.802, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=3810, lr=6.52184e-06, gnorm=3.328, loss_scale=0.0156, train_wall=10, gb_free=13.3, wall=13167
2022-04-25 15:45:58 - progress_bar.py[line:272] - INFO: epoch 001:   3833 / 6136 loss=1.78, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=76.5, ups=1.2, wpb=64, bsz=64, num_updates=3820, lr=6.51942e-06, gnorm=3.475, loss_scale=0.0156, train_wall=8, gb_free=14.3, wall=13176
2022-04-25 15:46:07 - progress_bar.py[line:272] - INFO: epoch 001:   3843 / 6136 loss=1.799, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=73.7, ups=1.15, wpb=64, bsz=64, num_updates=3830, lr=6.51699e-06, gnorm=3.337, loss_scale=0.0156, train_wall=9, gb_free=14.1, wall=13184
2022-04-25 15:46:15 - progress_bar.py[line:272] - INFO: epoch 001:   3853 / 6136 loss=1.724, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=75.8, ups=1.19, wpb=64, bsz=64, num_updates=3840, lr=6.51456e-06, gnorm=2.97, loss_scale=0.0156, train_wall=8, gb_free=14, wall=13193
2022-04-25 15:46:24 - progress_bar.py[line:272] - INFO: epoch 001:   3863 / 6136 loss=1.781, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=75, ups=1.17, wpb=64, bsz=64, num_updates=3850, lr=6.51214e-06, gnorm=3.174, loss_scale=0.0156, train_wall=8, gb_free=13.4, wall=13201
2022-04-25 15:46:32 - progress_bar.py[line:272] - INFO: epoch 001:   3873 / 6136 loss=1.818, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=3860, lr=6.50971e-06, gnorm=3.204, loss_scale=0.0156, train_wall=8, gb_free=14, wall=13209
2022-04-25 15:46:40 - progress_bar.py[line:272] - INFO: epoch 001:   3883 / 6136 loss=1.813, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=3870, lr=6.50728e-06, gnorm=3.018, loss_scale=0.0156, train_wall=8, gb_free=10.7, wall=13218
2022-04-25 15:46:49 - progress_bar.py[line:272] - INFO: epoch 001:   3893 / 6136 loss=1.781, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=3880, lr=6.50485e-06, gnorm=3.122, loss_scale=0.0156, train_wall=8, gb_free=13.5, wall=13226
2022-04-25 15:46:57 - progress_bar.py[line:272] - INFO: epoch 001:   3903 / 6136 loss=1.807, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=79.9, ups=1.25, wpb=64, bsz=64, num_updates=3890, lr=6.50243e-06, gnorm=3.483, loss_scale=0.0156, train_wall=8, gb_free=12.5, wall=13234
2022-04-25 15:47:06 - progress_bar.py[line:272] - INFO: epoch 001:   3913 / 6136 loss=1.757, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=68.3, ups=1.07, wpb=64, bsz=64, num_updates=3900, lr=6.5e-06, gnorm=3.192, loss_scale=0.0156, train_wall=9, gb_free=13.8, wall=13244
2022-04-25 15:47:06 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:19 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:51:20 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.745 | loss_v1 0 | loss_v2 0 | nll_loss 0.742 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.67 | acc 0.6777 | wps 77.7 | wpb 16 | bsz 16 | num_updates 3900 | best_acc 0.6777
2022-04-25 15:51:28 - progress_bar.py[line:272] - INFO: epoch 001:   3923 / 6136 loss=1.8, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=3910, lr=6.49757e-06, gnorm=3.545, loss_scale=0.0156, train_wall=8, gb_free=13.6, wall=13505
2022-04-25 15:51:36 - progress_bar.py[line:272] - INFO: epoch 001:   3933 / 6136 loss=1.768, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=3920, lr=6.49515e-06, gnorm=3.446, loss_scale=0.0312, train_wall=8, gb_free=13.6, wall=13514
2022-04-25 15:51:44 - progress_bar.py[line:272] - INFO: epoch 001:   3943 / 6136 loss=1.793, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=3930, lr=6.49272e-06, gnorm=3.568, loss_scale=0.0312, train_wall=8, gb_free=13.6, wall=13522
2022-04-25 15:51:53 - progress_bar.py[line:272] - INFO: epoch 001:   3953 / 6136 loss=1.768, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=79, ups=1.23, wpb=64, bsz=64, num_updates=3940, lr=6.49029e-06, gnorm=3.196, loss_scale=0.0312, train_wall=8, gb_free=13.2, wall=13530
2022-04-25 15:52:01 - progress_bar.py[line:272] - INFO: epoch 001:   3963 / 6136 loss=1.791, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=79, ups=1.23, wpb=64, bsz=64, num_updates=3950, lr=6.48786e-06, gnorm=3.055, loss_scale=0.0312, train_wall=8, gb_free=13.7, wall=13538
2022-04-25 15:52:09 - progress_bar.py[line:272] - INFO: epoch 001:   3973 / 6136 loss=1.823, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=80.4, ups=1.26, wpb=64, bsz=64, num_updates=3960, lr=6.48544e-06, gnorm=3.467, loss_scale=0.0312, train_wall=8, gb_free=13.7, wall=13546
2022-04-25 15:52:17 - progress_bar.py[line:272] - INFO: epoch 001:   3983 / 6136 loss=1.809, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=79.1, ups=1.24, wpb=64, bsz=64, num_updates=3970, lr=6.48301e-06, gnorm=3.469, loss_scale=0.0312, train_wall=8, gb_free=13.6, wall=13554
2022-04-25 15:52:25 - progress_bar.py[line:272] - INFO: epoch 001:   3993 / 6136 loss=1.782, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=79.3, ups=1.24, wpb=64, bsz=64, num_updates=3980, lr=6.48058e-06, gnorm=3.414, loss_scale=0.0312, train_wall=8, gb_free=12.7, wall=13562
2022-04-25 15:52:33 - progress_bar.py[line:272] - INFO: epoch 001:   4003 / 6136 loss=1.788, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=79.7, ups=1.25, wpb=64, bsz=64, num_updates=3990, lr=6.47816e-06, gnorm=3.207, loss_scale=0.0312, train_wall=8, gb_free=13.4, wall=13570
2022-04-25 15:52:42 - progress_bar.py[line:272] - INFO: epoch 001:   4013 / 6136 loss=1.814, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=68.4, ups=1.07, wpb=64, bsz=64, num_updates=4000, lr=6.47573e-06, gnorm=3.457, loss_scale=0.0312, train_wall=9, gb_free=13.8, wall=13580
2022-04-25 15:52:42 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 15:56:36 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.751 | loss_v1 0 | loss_v2 0 | nll_loss 0.748 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.68 | acc 0.6756 | wps 84.1 | wpb 16 | bsz 16 | num_updates 4000 | best_acc 0.6756
2022-04-25 15:56:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 4000 updates
2022-04-25 15:56:36 - trainer.py[line:432] - INFO: Saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_4000.pt
2022-04-25 15:56:51 - trainer.py[line:442] - INFO: Finished saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_4000.pt
2022-04-25 15:57:13 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_4000.pt (epoch 1 @ 4000 updates, score 0.6756) (writing took 36.8136675292626 seconds)
2022-04-25 15:57:22 - progress_bar.py[line:272] - INFO: epoch 001:   4023 / 6136 loss=1.783, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=2.3, ups=0.04, wpb=64, bsz=64, num_updates=4010, lr=6.4733e-06, gnorm=3.672, loss_scale=0.0312, train_wall=9, gb_free=10.6, wall=13860
2022-04-25 15:57:31 - progress_bar.py[line:272] - INFO: epoch 001:   4033 / 6136 loss=1.778, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=78.4, ups=1.22, wpb=64, bsz=64, num_updates=4020, lr=6.47087e-06, gnorm=3.466, loss_scale=0.0312, train_wall=8, gb_free=13.9, wall=13868
2022-04-25 15:57:39 - progress_bar.py[line:272] - INFO: epoch 001:   4043 / 6136 loss=1.784, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=78.4, ups=1.23, wpb=64, bsz=64, num_updates=4030, lr=6.46845e-06, gnorm=3.057, loss_scale=0.0312, train_wall=8, gb_free=10.7, wall=13876
2022-04-25 15:57:47 - progress_bar.py[line:272] - INFO: epoch 001:   4053 / 6136 loss=1.775, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=75.2, ups=1.17, wpb=64, bsz=64, num_updates=4040, lr=6.46602e-06, gnorm=3.235, loss_scale=0.0312, train_wall=8, gb_free=12.1, wall=13885
2022-04-25 15:57:56 - progress_bar.py[line:272] - INFO: epoch 001:   4063 / 6136 loss=1.755, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=4050, lr=6.46359e-06, gnorm=3.404, loss_scale=0.0312, train_wall=8, gb_free=14.1, wall=13893
2022-04-25 15:58:04 - progress_bar.py[line:272] - INFO: epoch 001:   4073 / 6136 loss=1.788, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=4060, lr=6.46117e-06, gnorm=3.642, loss_scale=0.0312, train_wall=8, gb_free=13.8, wall=13902
2022-04-25 15:58:12 - progress_bar.py[line:272] - INFO: epoch 001:   4083 / 6136 loss=1.793, loss_v1=0, loss_v2=0, nll_loss=0.791, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=79.5, ups=1.24, wpb=64, bsz=64, num_updates=4070, lr=6.45874e-06, gnorm=3.526, loss_scale=0.0312, train_wall=8, gb_free=13.9, wall=13910
2022-04-25 15:58:20 - progress_bar.py[line:272] - INFO: epoch 001:   4093 / 6136 loss=1.782, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=4080, lr=6.45631e-06, gnorm=3.098, loss_scale=0.0312, train_wall=8, gb_free=13.8, wall=13918
2022-04-25 15:58:29 - progress_bar.py[line:272] - INFO: epoch 001:   4103 / 6136 loss=1.838, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.78, wps=77.4, ups=1.21, wpb=64, bsz=64, num_updates=4090, lr=6.45388e-06, gnorm=3.72, loss_scale=0.0312, train_wall=8, gb_free=13.2, wall=13926
2022-04-25 15:58:37 - progress_bar.py[line:272] - INFO: epoch 001:   4113 / 6136 loss=1.809, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=77.4, ups=1.21, wpb=64, bsz=64, num_updates=4100, lr=6.45146e-06, gnorm=3.418, loss_scale=0.0312, train_wall=8, gb_free=12.3, wall=13934
2022-04-25 15:58:37 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:02:48 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.76 | loss_v1 0 | loss_v2 0 | nll_loss 0.758 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.69 | acc 0.6711 | wps 78.2 | wpb 16 | bsz 16 | num_updates 4100 | best_acc 0.6756
2022-04-25 16:02:57 - progress_bar.py[line:272] - INFO: epoch 001:   4123 / 6136 loss=1.816, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=4110, lr=6.44903e-06, gnorm=3.706, loss_scale=0.0312, train_wall=9, gb_free=14.2, wall=14195
2022-04-25 16:03:06 - progress_bar.py[line:272] - INFO: epoch 001:   4133 / 6136 loss=1.781, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=68.4, ups=1.07, wpb=64, bsz=64, num_updates=4120, lr=6.4466e-06, gnorm=3.214, loss_scale=0.0312, train_wall=9, gb_free=13.3, wall=14204
2022-04-25 16:03:15 - progress_bar.py[line:272] - INFO: epoch 001:   4143 / 6136 loss=1.783, loss_v1=0, loss_v2=0, nll_loss=0.782, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=75.2, ups=1.17, wpb=64, bsz=64, num_updates=4130, lr=6.44417e-06, gnorm=3.135, loss_scale=0.0312, train_wall=8, gb_free=7.6, wall=14213
2022-04-25 16:03:23 - progress_bar.py[line:272] - INFO: epoch 001:   4153 / 6136 loss=1.756, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=4140, lr=6.44175e-06, gnorm=3.495, loss_scale=0.0312, train_wall=8, gb_free=13.6, wall=14221
2022-04-25 16:03:32 - progress_bar.py[line:272] - INFO: epoch 001:   4163 / 6136 loss=1.808, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=4150, lr=6.43932e-06, gnorm=3.506, loss_scale=0.0312, train_wall=8, gb_free=7.5, wall=14229
2022-04-25 16:03:40 - progress_bar.py[line:272] - INFO: epoch 001:   4173 / 6136 loss=1.799, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=77, ups=1.2, wpb=64, bsz=64, num_updates=4160, lr=6.43689e-06, gnorm=47.353, loss_scale=0.0312, train_wall=8, gb_free=13.8, wall=14237
2022-04-25 16:03:49 - progress_bar.py[line:272] - INFO: epoch 001:   4183 / 6136 loss=1.779, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=67.3, ups=1.05, wpb=64, bsz=64, num_updates=4170, lr=6.43447e-06, gnorm=3.229, loss_scale=0.0312, train_wall=9, gb_free=12.9, wall=14247
2022-04-25 16:03:58 - progress_bar.py[line:272] - INFO: epoch 001:   4193 / 6136 loss=1.807, loss_v1=0, loss_v2=0, nll_loss=0.805, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=4180, lr=6.43204e-06, gnorm=3.258, loss_scale=0.0312, train_wall=8, gb_free=13.9, wall=14255
2022-04-25 16:04:06 - progress_bar.py[line:272] - INFO: epoch 001:   4203 / 6136 loss=1.758, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=76, ups=1.19, wpb=64, bsz=64, num_updates=4190, lr=6.42961e-06, gnorm=3.571, loss_scale=0.0312, train_wall=8, gb_free=12.3, wall=14264
2022-04-25 16:04:15 - progress_bar.py[line:272] - INFO: epoch 001:   4213 / 6136 loss=1.823, loss_v1=0, loss_v2=0, nll_loss=0.821, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=67.9, ups=1.06, wpb=64, bsz=64, num_updates=4200, lr=6.42718e-06, gnorm=3.344, loss_scale=0.0312, train_wall=9, gb_free=12.8, wall=14273
2022-04-25 16:04:15 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:08:27 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.743 | loss_v1 0 | loss_v2 0 | nll_loss 0.741 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.67 | acc 0.6834 | wps 78.2 | wpb 16 | bsz 16 | num_updates 4200 | best_acc 0.6834
2022-04-25 16:08:35 - progress_bar.py[line:272] - INFO: epoch 001:   4223 / 6136 loss=1.725, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=4210, lr=6.42476e-06, gnorm=3.248, loss_scale=0.0312, train_wall=8, gb_free=14.1, wall=14533
2022-04-25 16:08:44 - progress_bar.py[line:272] - INFO: epoch 001:   4233 / 6136 loss=1.809, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=4220, lr=6.42233e-06, gnorm=3.678, loss_scale=0.0312, train_wall=8, gb_free=13.6, wall=14541
2022-04-25 16:08:52 - progress_bar.py[line:272] - INFO: epoch 001:   4243 / 6136 loss=1.864, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.82, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=4230, lr=6.4199e-06, gnorm=3.796, loss_scale=0.0312, train_wall=8, gb_free=12.2, wall=14549
2022-04-25 16:09:00 - progress_bar.py[line:272] - INFO: epoch 001:   4253 / 6136 loss=1.797, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=77.1, ups=1.21, wpb=64, bsz=64, num_updates=4240, lr=6.41748e-06, gnorm=3.571, loss_scale=0.0312, train_wall=8, gb_free=13.3, wall=14557
2022-04-25 16:09:08 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.015625
2022-04-25 16:09:10 - progress_bar.py[line:272] - INFO: epoch 001:   4264 / 6136 loss=1.772, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=66.2, ups=1.03, wpb=64, bsz=64, num_updates=4250, lr=6.41505e-06, gnorm=3.295, loss_scale=0.0156, train_wall=10, gb_free=14, wall=14567
2022-04-25 16:09:18 - progress_bar.py[line:272] - INFO: epoch 001:   4274 / 6136 loss=1.761, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=79.8, ups=1.25, wpb=64, bsz=64, num_updates=4260, lr=6.41262e-06, gnorm=2.863, loss_scale=0.0156, train_wall=8, gb_free=14, wall=14575
2022-04-25 16:09:26 - progress_bar.py[line:272] - INFO: epoch 001:   4284 / 6136 loss=1.746, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=76.4, ups=1.19, wpb=64, bsz=64, num_updates=4270, lr=6.41019e-06, gnorm=3.463, loss_scale=0.0156, train_wall=8, gb_free=12, wall=14584
2022-04-25 16:09:34 - progress_bar.py[line:272] - INFO: epoch 001:   4294 / 6136 loss=1.752, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=78.1, ups=1.22, wpb=64, bsz=64, num_updates=4280, lr=6.40777e-06, gnorm=3.142, loss_scale=0.0156, train_wall=8, gb_free=11.9, wall=14592
2022-04-25 16:09:42 - progress_bar.py[line:272] - INFO: epoch 001:   4304 / 6136 loss=1.735, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=4290, lr=6.40534e-06, gnorm=3.041, loss_scale=0.0156, train_wall=8, gb_free=13.6, wall=14600
2022-04-25 16:09:51 - progress_bar.py[line:272] - INFO: epoch 001:   4314 / 6136 loss=1.784, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=75.4, ups=1.18, wpb=64, bsz=64, num_updates=4300, lr=6.40291e-06, gnorm=3.649, loss_scale=0.0156, train_wall=8, gb_free=13.5, wall=14608
2022-04-25 16:09:51 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:14:08 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6841 | wps 76.5 | wpb 16 | bsz 16 | num_updates 4300 | best_acc 0.6841
2022-04-25 16:14:16 - progress_bar.py[line:272] - INFO: epoch 001:   4324 / 6136 loss=1.713, loss_v1=0, loss_v2=0, nll_loss=0.711, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=4310, lr=6.40049e-06, gnorm=3.24, loss_scale=0.0156, train_wall=8, gb_free=13.1, wall=14874
2022-04-25 16:14:25 - progress_bar.py[line:272] - INFO: epoch 001:   4334 / 6136 loss=1.78, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=4320, lr=6.39806e-06, gnorm=3.331, loss_scale=0.0156, train_wall=8, gb_free=11.6, wall=14882
2022-04-25 16:14:33 - progress_bar.py[line:272] - INFO: epoch 001:   4344 / 6136 loss=1.743, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=4330, lr=6.39563e-06, gnorm=3.347, loss_scale=0.0156, train_wall=8, gb_free=12.6, wall=14890
2022-04-25 16:14:41 - progress_bar.py[line:272] - INFO: epoch 001:   4354 / 6136 loss=1.75, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=4340, lr=6.3932e-06, gnorm=3.541, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=14898
2022-04-25 16:14:49 - progress_bar.py[line:272] - INFO: epoch 001:   4364 / 6136 loss=1.809, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=4350, lr=6.39078e-06, gnorm=3.999, loss_scale=0.0156, train_wall=8, gb_free=13.8, wall=14907
2022-04-25 16:14:58 - progress_bar.py[line:272] - INFO: epoch 001:   4374 / 6136 loss=1.723, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=4360, lr=6.38835e-06, gnorm=3.457, loss_scale=0.0156, train_wall=8, gb_free=14.1, wall=14915
2022-04-25 16:15:06 - progress_bar.py[line:272] - INFO: epoch 001:   4384 / 6136 loss=1.822, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=75.4, ups=1.18, wpb=64, bsz=64, num_updates=4370, lr=6.38592e-06, gnorm=3.848, loss_scale=0.0156, train_wall=8, gb_free=13.6, wall=14924
2022-04-25 16:15:14 - progress_bar.py[line:272] - INFO: epoch 001:   4394 / 6136 loss=1.749, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=4380, lr=6.3835e-06, gnorm=3.098, loss_scale=0.0156, train_wall=8, gb_free=13.4, wall=14932
2022-04-25 16:15:24 - progress_bar.py[line:272] - INFO: epoch 001:   4404 / 6136 loss=1.766, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=67.8, ups=1.06, wpb=64, bsz=64, num_updates=4390, lr=6.38107e-06, gnorm=3.101, loss_scale=0.0156, train_wall=9, gb_free=12.4, wall=14941
2022-04-25 16:15:32 - progress_bar.py[line:272] - INFO: epoch 001:   4414 / 6136 loss=1.74, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=4400, lr=6.37864e-06, gnorm=3.122, loss_scale=0.0156, train_wall=8, gb_free=12.9, wall=14950
2022-04-25 16:15:32 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:19:47 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.736 | loss_v1 0 | loss_v2 0 | nll_loss 0.734 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.66 | acc 0.6816 | wps 77.3 | wpb 16 | bsz 16 | num_updates 4400 | best_acc 0.6816
2022-04-25 16:19:55 - progress_bar.py[line:272] - INFO: epoch 001:   4424 / 6136 loss=1.761, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=4410, lr=6.37621e-06, gnorm=3.631, loss_scale=0.0156, train_wall=8, gb_free=13.8, wall=15212
2022-04-25 16:20:03 - progress_bar.py[line:272] - INFO: epoch 001:   4434 / 6136 loss=1.828, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=76.7, ups=1.2, wpb=64, bsz=64, num_updates=4420, lr=6.37379e-06, gnorm=3.893, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=15221
2022-04-25 16:20:12 - progress_bar.py[line:272] - INFO: epoch 001:   4444 / 6136 loss=1.693, loss_v1=0, loss_v2=0, nll_loss=0.691, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.61, wps=74.2, ups=1.16, wpb=64, bsz=64, num_updates=4430, lr=6.37136e-06, gnorm=3.435, loss_scale=0.0156, train_wall=9, gb_free=14.1, wall=15229
2022-04-25 16:20:20 - progress_bar.py[line:272] - INFO: epoch 001:   4454 / 6136 loss=1.79, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=78.4, ups=1.23, wpb=64, bsz=64, num_updates=4440, lr=6.36893e-06, gnorm=3.131, loss_scale=0.0156, train_wall=8, gb_free=13.9, wall=15237
2022-04-25 16:20:28 - progress_bar.py[line:272] - INFO: epoch 001:   4464 / 6136 loss=1.824, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.77, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=4450, lr=6.3665e-06, gnorm=3.015, loss_scale=0.0156, train_wall=8, gb_free=10.8, wall=15246
2022-04-25 16:20:37 - progress_bar.py[line:272] - INFO: epoch 001:   4474 / 6136 loss=1.789, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=74.1, ups=1.16, wpb=64, bsz=64, num_updates=4460, lr=6.36408e-06, gnorm=3.302, loss_scale=0.0156, train_wall=9, gb_free=13.2, wall=15254
2022-04-25 16:20:46 - progress_bar.py[line:272] - INFO: epoch 001:   4484 / 6136 loss=1.772, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=74, ups=1.16, wpb=64, bsz=64, num_updates=4470, lr=6.36165e-06, gnorm=3.409, loss_scale=0.0156, train_wall=9, gb_free=13.2, wall=15263
2022-04-25 16:20:54 - progress_bar.py[line:272] - INFO: epoch 001:   4494 / 6136 loss=1.803, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=4480, lr=6.35922e-06, gnorm=3.225, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=15271
2022-04-25 16:21:02 - progress_bar.py[line:272] - INFO: epoch 001:   4504 / 6136 loss=1.718, loss_v1=0, loss_v2=0, nll_loss=0.716, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=4490, lr=6.3568e-06, gnorm=3.193, loss_scale=0.0156, train_wall=8, gb_free=13.1, wall=15279
2022-04-25 16:21:10 - progress_bar.py[line:272] - INFO: epoch 001:   4514 / 6136 loss=1.8, loss_v1=0, loss_v2=0, nll_loss=0.799, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=74.9, ups=1.17, wpb=64, bsz=64, num_updates=4500, lr=6.35437e-06, gnorm=3.066, loss_scale=0.0156, train_wall=8, gb_free=13.5, wall=15288
2022-04-25 16:21:10 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:25:25 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.731 | loss_v1 0 | loss_v2 0 | nll_loss 0.729 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.66 | acc 0.685 | wps 77.3 | wpb 16 | bsz 16 | num_updates 4500 | best_acc 0.685
2022-04-25 16:25:33 - progress_bar.py[line:272] - INFO: epoch 001:   4524 / 6136 loss=1.733, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=4510, lr=6.35194e-06, gnorm=2.705, loss_scale=0.0156, train_wall=8, gb_free=13.5, wall=15551
2022-04-25 16:25:41 - progress_bar.py[line:272] - INFO: epoch 001:   4534 / 6136 loss=1.748, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=4520, lr=6.34951e-06, gnorm=3.282, loss_scale=0.0156, train_wall=8, gb_free=13.6, wall=15559
2022-04-25 16:25:51 - progress_bar.py[line:272] - INFO: epoch 001:   4544 / 6136 loss=1.752, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=67.7, ups=1.06, wpb=64, bsz=64, num_updates=4530, lr=6.34709e-06, gnorm=3.287, loss_scale=0.0156, train_wall=9, gb_free=11.9, wall=15568
2022-04-25 16:25:59 - progress_bar.py[line:272] - INFO: epoch 001:   4554 / 6136 loss=1.774, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=79.7, ups=1.25, wpb=64, bsz=64, num_updates=4540, lr=6.34466e-06, gnorm=3.478, loss_scale=0.0156, train_wall=8, gb_free=12.1, wall=15576
2022-04-25 16:26:07 - progress_bar.py[line:272] - INFO: epoch 001:   4564 / 6136 loss=1.791, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=4550, lr=6.34223e-06, gnorm=3.495, loss_scale=0.0156, train_wall=8, gb_free=13.1, wall=15585
2022-04-25 16:26:15 - progress_bar.py[line:272] - INFO: epoch 001:   4574 / 6136 loss=1.791, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=4560, lr=6.33981e-06, gnorm=3.25, loss_scale=0.0156, train_wall=8, gb_free=12, wall=15593
2022-04-25 16:26:24 - progress_bar.py[line:272] - INFO: epoch 001:   4584 / 6136 loss=1.733, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=4570, lr=6.33738e-06, gnorm=3.365, loss_scale=0.0156, train_wall=8, gb_free=13.4, wall=15601
2022-04-25 16:26:33 - progress_bar.py[line:272] - INFO: epoch 001:   4594 / 6136 loss=1.787, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=67, ups=1.05, wpb=64, bsz=64, num_updates=4580, lr=6.33495e-06, gnorm=3.424, loss_scale=0.0156, train_wall=10, gb_free=12.8, wall=15611
2022-04-25 16:26:42 - progress_bar.py[line:272] - INFO: epoch 001:   4604 / 6136 loss=1.772, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=75.2, ups=1.17, wpb=64, bsz=64, num_updates=4590, lr=6.33252e-06, gnorm=2.939, loss_scale=0.0156, train_wall=8, gb_free=13.1, wall=15619
2022-04-25 16:26:50 - progress_bar.py[line:272] - INFO: epoch 001:   4614 / 6136 loss=1.735, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=75.6, ups=1.18, wpb=64, bsz=64, num_updates=4600, lr=6.3301e-06, gnorm=3.606, loss_scale=0.0156, train_wall=8, gb_free=14, wall=15628
2022-04-25 16:26:50 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:31:05 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.716 | loss_v1 0 | loss_v2 0 | nll_loss 0.714 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.64 | acc 0.6923 | wps 77.1 | wpb 16 | bsz 16 | num_updates 4600 | best_acc 0.6923
2022-04-25 16:31:13 - progress_bar.py[line:272] - INFO: epoch 001:   4624 / 6136 loss=1.745, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=4610, lr=6.32767e-06, gnorm=3.355, loss_scale=0.0156, train_wall=8, gb_free=12.8, wall=15891
2022-04-25 16:31:22 - progress_bar.py[line:272] - INFO: epoch 001:   4634 / 6136 loss=1.796, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=78.4, ups=1.22, wpb=64, bsz=64, num_updates=4620, lr=6.32524e-06, gnorm=3.465, loss_scale=0.0156, train_wall=8, gb_free=13.9, wall=15899
2022-04-25 16:31:30 - progress_bar.py[line:272] - INFO: epoch 001:   4644 / 6136 loss=1.768, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=4630, lr=6.32282e-06, gnorm=3.342, loss_scale=0.0156, train_wall=8, gb_free=12.9, wall=15907
2022-04-25 16:31:38 - progress_bar.py[line:272] - INFO: epoch 001:   4654 / 6136 loss=1.746, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=76.9, ups=1.2, wpb=64, bsz=64, num_updates=4640, lr=6.32039e-06, gnorm=3.395, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=15916
2022-04-25 16:31:46 - progress_bar.py[line:272] - INFO: epoch 001:   4664 / 6136 loss=1.766, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=4650, lr=6.31796e-06, gnorm=3.603, loss_scale=0.0156, train_wall=8, gb_free=12.8, wall=15924
2022-04-25 16:31:55 - progress_bar.py[line:272] - INFO: epoch 001:   4674 / 6136 loss=1.781, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=4660, lr=6.31553e-06, gnorm=4.106, loss_scale=0.0156, train_wall=8, gb_free=13.1, wall=15932
2022-04-25 16:32:03 - progress_bar.py[line:272] - INFO: epoch 001:   4684 / 6136 loss=1.746, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=77.4, ups=1.21, wpb=64, bsz=64, num_updates=4670, lr=6.31311e-06, gnorm=3.495, loss_scale=0.0156, train_wall=8, gb_free=13.9, wall=15941
2022-04-25 16:32:11 - progress_bar.py[line:272] - INFO: epoch 001:   4694 / 6136 loss=1.795, loss_v1=0, loss_v2=0, nll_loss=0.793, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=4680, lr=6.31068e-06, gnorm=3.299, loss_scale=0.0156, train_wall=8, gb_free=13.5, wall=15949
2022-04-25 16:32:19 - progress_bar.py[line:272] - INFO: epoch 001:   4704 / 6136 loss=1.771, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=77.3, ups=1.21, wpb=64, bsz=64, num_updates=4690, lr=6.30825e-06, gnorm=4.173, loss_scale=0.0156, train_wall=8, gb_free=13.6, wall=15957
2022-04-25 16:32:28 - progress_bar.py[line:272] - INFO: epoch 001:   4714 / 6136 loss=1.735, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=4700, lr=6.30583e-06, gnorm=3.21, loss_scale=0.0156, train_wall=8, gb_free=13.5, wall=15965
2022-04-25 16:32:28 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:36:44 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:44 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:44 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:36:45 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6913 | wps 76.6 | wpb 16 | bsz 16 | num_updates 4700 | best_acc 0.6913
2022-04-25 16:36:53 - progress_bar.py[line:272] - INFO: epoch 001:   4724 / 6136 loss=1.76, loss_v1=0, loss_v2=0, nll_loss=0.759, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=4710, lr=6.3034e-06, gnorm=3.516, loss_scale=0.0156, train_wall=8, gb_free=13.6, wall=16230
2022-04-25 16:37:01 - progress_bar.py[line:272] - INFO: epoch 001:   4734 / 6136 loss=1.747, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=4720, lr=6.30097e-06, gnorm=3.21, loss_scale=0.0156, train_wall=8, gb_free=13.9, wall=16239
2022-04-25 16:37:10 - progress_bar.py[line:272] - INFO: epoch 001:   4744 / 6136 loss=1.797, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=4730, lr=6.29854e-06, gnorm=3.362, loss_scale=0.0156, train_wall=8, gb_free=12.9, wall=16247
2022-04-25 16:37:18 - progress_bar.py[line:272] - INFO: epoch 001:   4754 / 6136 loss=1.782, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=4740, lr=6.29612e-06, gnorm=3.212, loss_scale=0.0156, train_wall=8, gb_free=14, wall=16255
2022-04-25 16:37:26 - progress_bar.py[line:272] - INFO: epoch 001:   4764 / 6136 loss=1.778, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=4750, lr=6.29369e-06, gnorm=3.064, loss_scale=0.0156, train_wall=8, gb_free=13.9, wall=16264
2022-04-25 16:37:35 - progress_bar.py[line:272] - INFO: epoch 001:   4774 / 6136 loss=1.746, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=73.8, ups=1.15, wpb=64, bsz=64, num_updates=4760, lr=6.29126e-06, gnorm=3.193, loss_scale=0.0312, train_wall=9, gb_free=13.6, wall=16272
2022-04-25 16:37:43 - progress_bar.py[line:272] - INFO: epoch 001:   4784 / 6136 loss=1.81, loss_v1=0, loss_v2=0, nll_loss=0.808, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=73.3, ups=1.15, wpb=64, bsz=64, num_updates=4770, lr=6.28883e-06, gnorm=3.429, loss_scale=0.0312, train_wall=9, gb_free=13.5, wall=16281
2022-04-25 16:37:52 - progress_bar.py[line:272] - INFO: epoch 001:   4794 / 6136 loss=1.729, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=74.3, ups=1.16, wpb=64, bsz=64, num_updates=4780, lr=6.28641e-06, gnorm=6.431, loss_scale=0.0312, train_wall=9, gb_free=14.1, wall=16290
2022-04-25 16:38:00 - progress_bar.py[line:272] - INFO: epoch 001:   4804 / 6136 loss=1.788, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=77.3, ups=1.21, wpb=64, bsz=64, num_updates=4790, lr=6.28398e-06, gnorm=3.214, loss_scale=0.0312, train_wall=8, gb_free=13.4, wall=16298
2022-04-25 16:38:09 - progress_bar.py[line:272] - INFO: epoch 001:   4814 / 6136 loss=1.783, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=4800, lr=6.28155e-06, gnorm=3.364, loss_scale=0.0312, train_wall=8, gb_free=13.1, wall=16306
2022-04-25 16:38:09 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:23 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:42:24 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6908 | wps 77.2 | wpb 16 | bsz 16 | num_updates 4800 | best_acc 0.6908
2022-04-25 16:42:32 - progress_bar.py[line:272] - INFO: epoch 001:   4824 / 6136 loss=1.802, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=4810, lr=6.27913e-06, gnorm=3.214, loss_scale=0.0312, train_wall=8, gb_free=13.5, wall=16569
2022-04-25 16:42:41 - progress_bar.py[line:272] - INFO: epoch 001:   4834 / 6136 loss=1.783, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=67.8, ups=1.06, wpb=64, bsz=64, num_updates=4820, lr=6.2767e-06, gnorm=3.605, loss_scale=0.0312, train_wall=9, gb_free=13.7, wall=16579
2022-04-25 16:42:50 - progress_bar.py[line:272] - INFO: epoch 001:   4844 / 6136 loss=1.769, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=4830, lr=6.27427e-06, gnorm=3.092, loss_scale=0.0312, train_wall=8, gb_free=10.8, wall=16587
2022-04-25 16:42:58 - progress_bar.py[line:272] - INFO: epoch 001:   4854 / 6136 loss=1.735, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=4840, lr=6.27184e-06, gnorm=3.419, loss_scale=0.0312, train_wall=8, gb_free=13.7, wall=16595
2022-04-25 16:43:06 - progress_bar.py[line:272] - INFO: epoch 001:   4864 / 6136 loss=1.787, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=4850, lr=6.26942e-06, gnorm=3.354, loss_scale=0.0312, train_wall=8, gb_free=13.3, wall=16604
2022-04-25 16:43:14 - progress_bar.py[line:272] - INFO: epoch 001:   4874 / 6136 loss=1.766, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=79.7, ups=1.25, wpb=64, bsz=64, num_updates=4860, lr=6.26699e-06, gnorm=3.269, loss_scale=0.0312, train_wall=8, gb_free=13.5, wall=16612
2022-04-25 16:43:23 - progress_bar.py[line:272] - INFO: epoch 001:   4884 / 6136 loss=1.756, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=4870, lr=6.26456e-06, gnorm=3.332, loss_scale=0.0312, train_wall=8, gb_free=13.2, wall=16620
2022-04-25 16:43:25 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.015625
2022-04-25 16:43:27 - trainer.py[line:1304] - WARNING: OOM: Ran out of memory with exception: CUDA out of memory. Tried to allocate 1.54 GiB (GPU 0; 23.70 GiB total capacity; 19.30 GiB already allocated; 1.42 GiB free; 21.16 GiB reserved in total by PyTorch)
2022-04-25 16:43:27 - trainer.py[line:1307] - WARNING: |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 3            |        cudaMalloc retries: 7         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   18181 MB |   19759 MB |  450163 GB |  450146 GB |
|       from large pool |   18141 MB |   19720 MB |  442910 GB |  442892 GB |
|       from small pool |      39 MB |      83 MB |    7253 GB |    7253 GB |
|---------------------------------------------------------------------------|
| Active memory         |   18181 MB |   19759 MB |  450163 GB |  450146 GB |
|       from large pool |   18141 MB |   19720 MB |  442910 GB |  442892 GB |
|       from small pool |      39 MB |      83 MB |    7253 GB |    7253 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   21668 MB |   21698 MB |   46288 MB |   24620 MB |
|       from large pool |   21610 MB |   21610 MB |   46070 MB |   24460 MB |
|       from small pool |      58 MB |      96 MB |     218 MB |     160 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1906 MB |    4199 MB |  379707 GB |  379706 GB |
|       from large pool |    1888 MB |    4153 MB |  372371 GB |  372369 GB |
|       from small pool |      18 MB |      47 MB |    7336 GB |    7336 GB |
|---------------------------------------------------------------------------|
| Allocations           |    2439    |    2479    |  229638 K  |  229636 K  |
|       from large pool |     850    |     857    |  109285 K  |  109284 K  |
|       from small pool |    1589    |    1679    |  120353 K  |  120351 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2439    |    2479    |  229638 K  |  229636 K  |
|       from large pool |     850    |     857    |  109285 K  |  109284 K  |
|       from small pool |    1589    |    1679    |  120353 K  |  120351 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     158    |     177    |     361    |     203    |
|       from large pool |     129    |     129    |     252    |     123    |
|       from small pool |      29    |      48    |     109    |      80    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     192    |     237    |  147653 K  |  147653 K  |
|       from large pool |      97    |     116    |   85071 K  |   85071 K  |
|       from small pool |      95    |     129    |   62582 K  |   62582 K  |
|===========================================================================|

2022-04-25 16:43:27 - trainer.py[line:797] - WARNING: attempting to recover from OOM in forward/backward pass
2022-04-25 16:43:35 - progress_bar.py[line:272] - INFO: epoch 001:   4896 / 6136 loss=1.738, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=52.4, ups=0.82, wpb=64, bsz=64, num_updates=4880, lr=6.26214e-06, gnorm=3.187, loss_scale=0.0156, train_wall=11, gb_free=13, wall=16632
2022-04-25 16:43:44 - progress_bar.py[line:272] - INFO: epoch 001:   4906 / 6136 loss=1.742, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=72, ups=1.13, wpb=64, bsz=64, num_updates=4890, lr=6.25971e-06, gnorm=3.129, loss_scale=0.0156, train_wall=9, gb_free=13.3, wall=16641
2022-04-25 16:43:52 - progress_bar.py[line:272] - INFO: epoch 001:   4916 / 6136 loss=1.752, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=74.5, ups=1.16, wpb=64, bsz=64, num_updates=4900, lr=6.25728e-06, gnorm=3.209, loss_scale=0.0156, train_wall=9, gb_free=13.6, wall=16650
2022-04-25 16:43:52 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:48:07 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.715 | loss_v1 0 | loss_v2 0 | nll_loss 0.713 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.64 | acc 0.6936 | wps 77.3 | wpb 16 | bsz 16 | num_updates 4900 | best_acc 0.6936
2022-04-25 16:48:15 - progress_bar.py[line:272] - INFO: epoch 001:   4926 / 6136 loss=1.836, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.78, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=4910, lr=6.25485e-06, gnorm=3.471, loss_scale=0.0156, train_wall=9, gb_free=10.8, wall=16913
2022-04-25 16:48:24 - progress_bar.py[line:272] - INFO: epoch 001:   4936 / 6136 loss=1.77, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=4920, lr=6.25243e-06, gnorm=3.15, loss_scale=0.0156, train_wall=9, gb_free=14.1, wall=16921
2022-04-25 16:48:33 - progress_bar.py[line:272] - INFO: epoch 001:   4946 / 6136 loss=1.725, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=4930, lr=6.25e-06, gnorm=3.343, loss_scale=0.0156, train_wall=9, gb_free=13.9, wall=16930
2022-04-25 16:48:39 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.0078125
2022-04-25 16:48:41 - progress_bar.py[line:272] - INFO: epoch 001:   4957 / 6136 loss=1.815, loss_v1=0, loss_v2=0, nll_loss=0.814, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.76, wps=71.8, ups=1.12, wpb=64, bsz=64, num_updates=4940, lr=6.24757e-06, gnorm=3.71, loss_scale=0.0078, train_wall=9, gb_free=13.1, wall=16939
2022-04-25 16:48:50 - progress_bar.py[line:272] - INFO: epoch 001:   4967 / 6136 loss=1.727, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=4950, lr=6.24515e-06, gnorm=3.63, loss_scale=0.0078, train_wall=8, gb_free=13.9, wall=16947
2022-04-25 16:48:58 - progress_bar.py[line:272] - INFO: epoch 001:   4977 / 6136 loss=1.747, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=79.6, ups=1.24, wpb=64, bsz=64, num_updates=4960, lr=6.24272e-06, gnorm=2.955, loss_scale=0.0078, train_wall=8, gb_free=13.5, wall=16955
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:00 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 14 (expected: 16)
2022-04-25 16:49:06 - progress_bar.py[line:272] - INFO: epoch 001:   4987 / 6136 loss=1.693, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=63.8, nsentences=63.8, sample_size=63.8, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=79.7, ups=1.25, wpb=63.8, bsz=63.8, num_updates=4970, lr=6.24029e-06, gnorm=3.222, loss_scale=0.0078, train_wall=8, gb_free=12.7, wall=16963
2022-04-25 16:49:15 - progress_bar.py[line:272] - INFO: epoch 001:   4997 / 6136 loss=1.749, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=68.8, ups=1.08, wpb=64, bsz=64, num_updates=4980, lr=6.23786e-06, gnorm=3.546, loss_scale=0.0078, train_wall=9, gb_free=13.7, wall=16973
2022-04-25 16:49:24 - progress_bar.py[line:272] - INFO: epoch 001:   5007 / 6136 loss=1.773, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=4990, lr=6.23544e-06, gnorm=3.668, loss_scale=0.0078, train_wall=8, gb_free=13.4, wall=16981
2022-04-25 16:49:32 - progress_bar.py[line:272] - INFO: epoch 001:   5017 / 6136 loss=1.841, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.79, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=5000, lr=6.23301e-06, gnorm=3.481, loss_scale=0.0078, train_wall=8, gb_free=12, wall=16989
2022-04-25 16:49:32 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 16:53:49 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.724 | loss_v1 0 | loss_v2 0 | nll_loss 0.722 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.65 | acc 0.6875 | wps 76.5 | wpb 16 | bsz 16 | num_updates 5000 | best_acc 0.6875
2022-04-25 16:53:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 5000 updates
2022-04-25 16:53:49 - trainer.py[line:432] - INFO: Saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_5000.pt
2022-04-25 16:54:03 - trainer.py[line:442] - INFO: Finished saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_5000.pt
2022-04-25 16:54:25 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_5000.pt (epoch 1 @ 5000 updates, score 0.6875) (writing took 36.38577088620514 seconds)
2022-04-25 16:54:35 - progress_bar.py[line:272] - INFO: epoch 001:   5027 / 6136 loss=1.733, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=2.1, ups=0.03, wpb=64, bsz=64, num_updates=5010, lr=6.23058e-06, gnorm=3.318, loss_scale=0.0078, train_wall=9, gb_free=13.4, wall=17292
2022-04-25 16:54:43 - progress_bar.py[line:272] - INFO: epoch 001:   5037 / 6136 loss=1.739, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=72.3, ups=1.13, wpb=64, bsz=64, num_updates=5020, lr=6.22816e-06, gnorm=3.013, loss_scale=0.0078, train_wall=9, gb_free=13.2, wall=17301
2022-04-25 16:54:52 - progress_bar.py[line:272] - INFO: epoch 001:   5047 / 6136 loss=1.695, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=77.4, ups=1.21, wpb=64, bsz=64, num_updates=5030, lr=6.22573e-06, gnorm=2.669, loss_scale=0.0078, train_wall=8, gb_free=13.6, wall=17309
2022-04-25 16:55:01 - progress_bar.py[line:272] - INFO: epoch 001:   5057 / 6136 loss=1.813, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=65.4, ups=1.02, wpb=64, bsz=64, num_updates=5040, lr=6.2233e-06, gnorm=3.545, loss_scale=0.0078, train_wall=10, gb_free=6.9, wall=17319
2022-04-25 16:55:10 - progress_bar.py[line:272] - INFO: epoch 001:   5067 / 6136 loss=1.733, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=78.8, ups=1.23, wpb=64, bsz=64, num_updates=5050, lr=6.22087e-06, gnorm=3.11, loss_scale=0.0078, train_wall=8, gb_free=13.8, wall=17327
2022-04-25 16:55:18 - progress_bar.py[line:272] - INFO: epoch 001:   5077 / 6136 loss=1.778, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=5060, lr=6.21845e-06, gnorm=3.25, loss_scale=0.0078, train_wall=8, gb_free=13.7, wall=17335
2022-04-25 16:55:26 - progress_bar.py[line:272] - INFO: epoch 001:   5087 / 6136 loss=1.731, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=76, ups=1.19, wpb=64, bsz=64, num_updates=5070, lr=6.21602e-06, gnorm=3.083, loss_scale=0.0078, train_wall=8, gb_free=13.8, wall=17344
2022-04-25 16:55:34 - progress_bar.py[line:272] - INFO: epoch 001:   5097 / 6136 loss=1.787, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=5080, lr=6.21359e-06, gnorm=3.108, loss_scale=0.0078, train_wall=8, gb_free=12.1, wall=17352
2022-04-25 16:55:43 - progress_bar.py[line:272] - INFO: epoch 001:   5107 / 6136 loss=1.739, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=73.9, ups=1.15, wpb=64, bsz=64, num_updates=5090, lr=6.21117e-06, gnorm=3.59, loss_scale=0.0078, train_wall=9, gb_free=12.6, wall=17360
2022-04-25 16:55:52 - progress_bar.py[line:272] - INFO: epoch 001:   5117 / 6136 loss=1.791, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=70, ups=1.09, wpb=64, bsz=64, num_updates=5100, lr=6.20874e-06, gnorm=3.739, loss_scale=0.0078, train_wall=9, gb_free=12.9, wall=17370
2022-04-25 16:55:52 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:00:08 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.6842 | wps 76.7 | wpb 16 | bsz 16 | num_updates 5100 | best_acc 0.6875
2022-04-25 17:00:18 - progress_bar.py[line:272] - INFO: epoch 001:   5127 / 6136 loss=1.8, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=5110, lr=6.20631e-06, gnorm=3.239, loss_scale=0.0078, train_wall=10, gb_free=12.2, wall=17636
2022-04-25 17:00:27 - progress_bar.py[line:272] - INFO: epoch 001:   5137 / 6136 loss=1.712, loss_v1=0, loss_v2=0, nll_loss=0.71, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=73.2, ups=1.14, wpb=64, bsz=64, num_updates=5120, lr=6.20388e-06, gnorm=2.871, loss_scale=0.0078, train_wall=9, gb_free=13.4, wall=17645
2022-04-25 17:00:36 - progress_bar.py[line:272] - INFO: epoch 001:   5147 / 6136 loss=1.737, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=74.2, ups=1.16, wpb=64, bsz=64, num_updates=5130, lr=6.20146e-06, gnorm=3.104, loss_scale=0.0078, train_wall=9, gb_free=13.9, wall=17653
2022-04-25 17:00:44 - progress_bar.py[line:272] - INFO: epoch 001:   5157 / 6136 loss=1.749, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=5140, lr=6.19903e-06, gnorm=3.413, loss_scale=0.0078, train_wall=8, gb_free=12.6, wall=17661
2022-04-25 17:00:52 - progress_bar.py[line:272] - INFO: epoch 001:   5167 / 6136 loss=1.769, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=5150, lr=6.1966e-06, gnorm=3.491, loss_scale=0.0078, train_wall=8, gb_free=12.4, wall=17670
2022-04-25 17:01:01 - progress_bar.py[line:272] - INFO: epoch 001:   5177 / 6136 loss=1.782, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=77.3, ups=1.21, wpb=64, bsz=64, num_updates=5160, lr=6.19417e-06, gnorm=3.678, loss_scale=0.0078, train_wall=8, gb_free=12.7, wall=17678
2022-04-25 17:01:09 - progress_bar.py[line:272] - INFO: epoch 001:   5187 / 6136 loss=1.777, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=5170, lr=6.19175e-06, gnorm=3.175, loss_scale=0.0078, train_wall=9, gb_free=12.9, wall=17687
2022-04-25 17:01:18 - progress_bar.py[line:272] - INFO: epoch 001:   5197 / 6136 loss=1.71, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=69, ups=1.08, wpb=64, bsz=64, num_updates=5180, lr=6.18932e-06, gnorm=3.003, loss_scale=0.0078, train_wall=9, gb_free=13.1, wall=17696
2022-04-25 17:01:27 - progress_bar.py[line:272] - INFO: epoch 001:   5207 / 6136 loss=1.714, loss_v1=0, loss_v2=0, nll_loss=0.712, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=5190, lr=6.18689e-06, gnorm=3.225, loss_scale=0.0078, train_wall=8, gb_free=13.3, wall=17704
2022-04-25 17:01:36 - progress_bar.py[line:272] - INFO: epoch 001:   5217 / 6136 loss=1.734, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=67.7, ups=1.06, wpb=64, bsz=64, num_updates=5200, lr=6.18447e-06, gnorm=3.438, loss_scale=0.0078, train_wall=9, gb_free=14, wall=17714
2022-04-25 17:01:36 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:05:54 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.706 | loss_v1 0 | loss_v2 0 | nll_loss 0.704 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.63 | acc 0.6993 | wps 76.3 | wpb 16 | bsz 16 | num_updates 5200 | best_acc 0.6993
2022-04-25 17:06:02 - progress_bar.py[line:272] - INFO: epoch 001:   5227 / 6136 loss=1.671, loss_v1=0, loss_v2=0, nll_loss=0.67, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.59, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=5210, lr=6.18204e-06, gnorm=3.238, loss_scale=0.0078, train_wall=8, gb_free=13.8, wall=17980
2022-04-25 17:06:10 - progress_bar.py[line:272] - INFO: epoch 001:   5237 / 6136 loss=1.742, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=5220, lr=6.17961e-06, gnorm=3.123, loss_scale=0.0078, train_wall=8, gb_free=13.7, wall=17988
2022-04-25 17:06:19 - progress_bar.py[line:272] - INFO: epoch 001:   5247 / 6136 loss=1.762, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=5230, lr=6.17718e-06, gnorm=3.49, loss_scale=0.0078, train_wall=8, gb_free=13.8, wall=17996
2022-04-25 17:06:27 - progress_bar.py[line:272] - INFO: epoch 001:   5257 / 6136 loss=1.763, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=5240, lr=6.17476e-06, gnorm=3.44, loss_scale=0.0078, train_wall=8, gb_free=13.4, wall=18004
2022-04-25 17:06:35 - progress_bar.py[line:272] - INFO: epoch 001:   5267 / 6136 loss=1.695, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=78.7, ups=1.23, wpb=64, bsz=64, num_updates=5250, lr=6.17233e-06, gnorm=3.239, loss_scale=0.0078, train_wall=8, gb_free=14, wall=18013
2022-04-25 17:06:43 - progress_bar.py[line:272] - INFO: epoch 001:   5277 / 6136 loss=1.74, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=5260, lr=6.1699e-06, gnorm=3.309, loss_scale=0.0078, train_wall=8, gb_free=12.9, wall=18021
2022-04-25 17:06:52 - progress_bar.py[line:272] - INFO: epoch 001:   5287 / 6136 loss=1.789, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=5270, lr=6.16748e-06, gnorm=3.08, loss_scale=0.0078, train_wall=8, gb_free=13.7, wall=18029
2022-04-25 17:07:00 - progress_bar.py[line:272] - INFO: epoch 001:   5297 / 6136 loss=1.757, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=75.6, ups=1.18, wpb=64, bsz=64, num_updates=5280, lr=6.16505e-06, gnorm=3.55, loss_scale=0.0078, train_wall=8, gb_free=13.6, wall=18038
2022-04-25 17:07:09 - progress_bar.py[line:272] - INFO: epoch 001:   5307 / 6136 loss=1.774, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=73, ups=1.14, wpb=64, bsz=64, num_updates=5290, lr=6.16262e-06, gnorm=3.081, loss_scale=0.0078, train_wall=9, gb_free=13.6, wall=18046
2022-04-25 17:07:17 - progress_bar.py[line:272] - INFO: epoch 001:   5317 / 6136 loss=1.788, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=73.7, ups=1.15, wpb=64, bsz=64, num_updates=5300, lr=6.16019e-06, gnorm=3.138, loss_scale=0.0078, train_wall=9, gb_free=7.8, wall=18055
2022-04-25 17:07:17 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:11:34 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7031 | wps 76.8 | wpb 16 | bsz 16 | num_updates 5300 | best_acc 0.7031
2022-04-25 17:11:42 - progress_bar.py[line:272] - INFO: epoch 001:   5327 / 6136 loss=1.729, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=5310, lr=6.15777e-06, gnorm=3.127, loss_scale=0.0078, train_wall=8, gb_free=14, wall=18319
2022-04-25 17:11:51 - progress_bar.py[line:272] - INFO: epoch 001:   5337 / 6136 loss=1.753, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=66.6, ups=1.04, wpb=64, bsz=64, num_updates=5320, lr=6.15534e-06, gnorm=3.51, loss_scale=0.0078, train_wall=10, gb_free=13.9, wall=18329
2022-04-25 17:12:00 - progress_bar.py[line:272] - INFO: epoch 001:   5347 / 6136 loss=1.777, loss_v1=0, loss_v2=0, nll_loss=0.776, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=74.6, ups=1.17, wpb=64, bsz=64, num_updates=5330, lr=6.15291e-06, gnorm=3.086, loss_scale=0.0078, train_wall=9, gb_free=13, wall=18338
2022-04-25 17:12:08 - progress_bar.py[line:272] - INFO: epoch 001:   5357 / 6136 loss=1.741, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=80.4, ups=1.26, wpb=64, bsz=64, num_updates=5340, lr=6.15049e-06, gnorm=3.044, loss_scale=0.0078, train_wall=8, gb_free=14.1, wall=18346
2022-04-25 17:12:17 - progress_bar.py[line:272] - INFO: epoch 001:   5367 / 6136 loss=1.677, loss_v1=0, loss_v2=0, nll_loss=0.675, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=68.2, ups=1.07, wpb=64, bsz=64, num_updates=5350, lr=6.14806e-06, gnorm=2.99, loss_scale=0.0078, train_wall=9, gb_free=13.9, wall=18355
2022-04-25 17:12:27 - progress_bar.py[line:272] - INFO: epoch 001:   5377 / 6136 loss=1.738, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=68.6, ups=1.07, wpb=64, bsz=64, num_updates=5360, lr=6.14563e-06, gnorm=2.893, loss_scale=0.0078, train_wall=9, gb_free=13.4, wall=18364
2022-04-25 17:12:35 - progress_bar.py[line:272] - INFO: epoch 001:   5387 / 6136 loss=1.724, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=5370, lr=6.1432e-06, gnorm=2.889, loss_scale=0.0078, train_wall=8, gb_free=13.9, wall=18372
2022-04-25 17:12:43 - progress_bar.py[line:272] - INFO: epoch 001:   5397 / 6136 loss=1.725, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=76.9, ups=1.2, wpb=64, bsz=64, num_updates=5380, lr=6.14078e-06, gnorm=3.486, loss_scale=0.0078, train_wall=8, gb_free=14, wall=18381
2022-04-25 17:12:52 - progress_bar.py[line:272] - INFO: epoch 001:   5407 / 6136 loss=1.747, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=74.2, ups=1.16, wpb=64, bsz=64, num_updates=5390, lr=6.13835e-06, gnorm=3.135, loss_scale=0.0078, train_wall=9, gb_free=11.8, wall=18389
2022-04-25 17:13:01 - progress_bar.py[line:272] - INFO: epoch 001:   5417 / 6136 loss=1.749, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=73, ups=1.14, wpb=64, bsz=64, num_updates=5400, lr=6.13592e-06, gnorm=3.833, loss_scale=0.0078, train_wall=9, gb_free=13.5, wall=18398
2022-04-25 17:13:01 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:17:17 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.698 | loss_v1 0 | loss_v2 0 | nll_loss 0.696 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.62 | acc 0.7019 | wps 76.7 | wpb 16 | bsz 16 | num_updates 5400 | best_acc 0.7019
2022-04-25 17:17:27 - progress_bar.py[line:272] - INFO: epoch 001:   5427 / 6136 loss=1.788, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=5410, lr=6.1335e-06, gnorm=3.553, loss_scale=0.0078, train_wall=9, gb_free=13.6, wall=18664
2022-04-25 17:17:35 - progress_bar.py[line:272] - INFO: epoch 001:   5437 / 6136 loss=1.758, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=74.3, ups=1.16, wpb=64, bsz=64, num_updates=5420, lr=6.13107e-06, gnorm=3.684, loss_scale=0.0078, train_wall=9, gb_free=13.4, wall=18673
2022-04-25 17:17:43 - progress_bar.py[line:272] - INFO: epoch 001:   5447 / 6136 loss=1.773, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=79.4, ups=1.24, wpb=64, bsz=64, num_updates=5430, lr=6.12864e-06, gnorm=3.147, loss_scale=0.0078, train_wall=8, gb_free=13.7, wall=18681
2022-04-25 17:17:51 - progress_bar.py[line:272] - INFO: epoch 001:   5457 / 6136 loss=1.723, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=5440, lr=6.12621e-06, gnorm=3.335, loss_scale=0.0078, train_wall=8, gb_free=13.4, wall=18689
2022-04-25 17:17:59 - progress_bar.py[line:272] - INFO: epoch 001:   5467 / 6136 loss=1.73, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=80, ups=1.25, wpb=64, bsz=64, num_updates=5450, lr=6.12379e-06, gnorm=3.642, loss_scale=0.0156, train_wall=8, gb_free=12.5, wall=18697
2022-04-25 17:18:07 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.0078125
2022-04-25 17:18:10 - progress_bar.py[line:272] - INFO: epoch 001:   5478 / 6136 loss=1.775, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=60.3, ups=0.94, wpb=64, bsz=64, num_updates=5460, lr=6.12136e-06, gnorm=3.387, loss_scale=0.0078, train_wall=11, gb_free=14.1, wall=18708
2022-04-25 17:18:19 - progress_bar.py[line:272] - INFO: epoch 001:   5488 / 6136 loss=1.747, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=74.9, ups=1.17, wpb=64, bsz=64, num_updates=5470, lr=6.11893e-06, gnorm=3.401, loss_scale=0.0078, train_wall=8, gb_free=12.6, wall=18716
2022-04-25 17:18:27 - progress_bar.py[line:272] - INFO: epoch 001:   5498 / 6136 loss=1.775, loss_v1=0, loss_v2=0, nll_loss=0.774, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=5480, lr=6.1165e-06, gnorm=3.428, loss_scale=0.0078, train_wall=8, gb_free=13.5, wall=18724
2022-04-25 17:18:35 - progress_bar.py[line:272] - INFO: epoch 001:   5508 / 6136 loss=1.779, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=5490, lr=6.11408e-06, gnorm=3.46, loss_scale=0.0078, train_wall=8, gb_free=13.1, wall=18733
2022-04-25 17:18:43 - progress_bar.py[line:272] - INFO: epoch 001:   5518 / 6136 loss=1.726, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=5500, lr=6.11165e-06, gnorm=3.286, loss_scale=0.0078, train_wall=8, gb_free=12.9, wall=18741
2022-04-25 17:18:43 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:22:57 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.701 | loss_v1 0 | loss_v2 0 | nll_loss 0.699 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.62 | acc 0.7019 | wps 77.5 | wpb 16 | bsz 16 | num_updates 5500 | best_acc 0.7019
2022-04-25 17:23:05 - progress_bar.py[line:272] - INFO: epoch 001:   5528 / 6136 loss=1.743, loss_v1=0, loss_v2=0, nll_loss=0.741, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=5510, lr=6.10922e-06, gnorm=3.31, loss_scale=0.0078, train_wall=8, gb_free=11.7, wall=19003
2022-04-25 17:23:15 - progress_bar.py[line:272] - INFO: epoch 001:   5538 / 6136 loss=1.752, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=69.2, ups=1.08, wpb=64, bsz=64, num_updates=5520, lr=6.1068e-06, gnorm=3.254, loss_scale=0.0078, train_wall=9, gb_free=8.8, wall=19012
2022-04-25 17:23:23 - progress_bar.py[line:272] - INFO: epoch 001:   5548 / 6136 loss=1.678, loss_v1=0, loss_v2=0, nll_loss=0.677, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=78.1, ups=1.22, wpb=64, bsz=64, num_updates=5530, lr=6.10437e-06, gnorm=3.559, loss_scale=0.0078, train_wall=8, gb_free=13.9, wall=19020
2022-04-25 17:23:31 - progress_bar.py[line:272] - INFO: epoch 001:   5558 / 6136 loss=1.684, loss_v1=0, loss_v2=0, nll_loss=0.682, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=5540, lr=6.10194e-06, gnorm=3.314, loss_scale=0.0078, train_wall=8, gb_free=13.9, wall=19029
2022-04-25 17:23:39 - progress_bar.py[line:272] - INFO: epoch 001:   5568 / 6136 loss=1.796, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=5550, lr=6.09951e-06, gnorm=3.318, loss_scale=0.0078, train_wall=8, gb_free=13.5, wall=19037
2022-04-25 17:23:48 - progress_bar.py[line:272] - INFO: epoch 001:   5578 / 6136 loss=1.691, loss_v1=0, loss_v2=0, nll_loss=0.689, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.61, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=5560, lr=6.09709e-06, gnorm=3.155, loss_scale=0.0078, train_wall=8, gb_free=12.9, wall=19045
2022-04-25 17:23:56 - progress_bar.py[line:272] - INFO: epoch 001:   5588 / 6136 loss=1.763, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=5570, lr=6.09466e-06, gnorm=3.184, loss_scale=0.0078, train_wall=8, gb_free=13.2, wall=19053
2022-04-25 17:24:05 - progress_bar.py[line:272] - INFO: epoch 001:   5598 / 6136 loss=1.706, loss_v1=0, loss_v2=0, nll_loss=0.705, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=73.3, ups=1.15, wpb=64, bsz=64, num_updates=5580, lr=6.09223e-06, gnorm=3.253, loss_scale=0.0078, train_wall=9, gb_free=13, wall=19062
2022-04-25 17:24:13 - progress_bar.py[line:272] - INFO: epoch 001:   5608 / 6136 loss=1.679, loss_v1=0, loss_v2=0, nll_loss=0.677, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=5590, lr=6.08981e-06, gnorm=3.664, loss_scale=0.0078, train_wall=8, gb_free=13.8, wall=19070
2022-04-25 17:24:22 - progress_bar.py[line:272] - INFO: epoch 001:   5618 / 6136 loss=1.76, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=68.4, ups=1.07, wpb=64, bsz=64, num_updates=5600, lr=6.08738e-06, gnorm=3.318, loss_scale=0.0078, train_wall=9, gb_free=13.1, wall=19080
2022-04-25 17:24:22 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:28:39 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.691 | loss_v1 0 | loss_v2 0 | nll_loss 0.689 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.61 | acc 0.7089 | wps 76.6 | wpb 16 | bsz 16 | num_updates 5600 | best_acc 0.7089
2022-04-25 17:28:47 - progress_bar.py[line:272] - INFO: epoch 001:   5628 / 6136 loss=1.78, loss_v1=0, loss_v2=0, nll_loss=0.778, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=5610, lr=6.08495e-06, gnorm=3.691, loss_scale=0.0078, train_wall=8, gb_free=12.6, wall=19345
2022-04-25 17:28:55 - progress_bar.py[line:272] - INFO: epoch 001:   5638 / 6136 loss=1.731, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=5620, lr=6.08252e-06, gnorm=3.474, loss_scale=0.0078, train_wall=8, gb_free=13.6, wall=19353
2022-04-25 17:29:03 - progress_bar.py[line:272] - INFO: epoch 001:   5648 / 6136 loss=1.76, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=79.6, ups=1.24, wpb=64, bsz=64, num_updates=5630, lr=6.0801e-06, gnorm=2.983, loss_scale=0.0078, train_wall=8, gb_free=13.4, wall=19361
2022-04-25 17:29:12 - progress_bar.py[line:272] - INFO: epoch 001:   5658 / 6136 loss=1.721, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=79, ups=1.23, wpb=64, bsz=64, num_updates=5640, lr=6.07767e-06, gnorm=2.999, loss_scale=0.0078, train_wall=8, gb_free=14, wall=19369
2022-04-25 17:29:20 - progress_bar.py[line:272] - INFO: epoch 001:   5668 / 6136 loss=1.728, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=5650, lr=6.07524e-06, gnorm=3.433, loss_scale=0.0078, train_wall=8, gb_free=14, wall=19377
2022-04-25 17:29:28 - progress_bar.py[line:272] - INFO: epoch 001:   5678 / 6136 loss=1.735, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=5660, lr=6.07282e-06, gnorm=3.518, loss_scale=0.0078, train_wall=8, gb_free=12.9, wall=19386
2022-04-25 17:29:36 - progress_bar.py[line:272] - INFO: epoch 001:   5688 / 6136 loss=1.754, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=5670, lr=6.07039e-06, gnorm=3.504, loss_scale=0.0078, train_wall=8, gb_free=13.7, wall=19394
2022-04-25 17:29:44 - progress_bar.py[line:272] - INFO: epoch 001:   5698 / 6136 loss=1.702, loss_v1=0, loss_v2=0, nll_loss=0.7, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=80.1, ups=1.25, wpb=64, bsz=64, num_updates=5680, lr=6.06796e-06, gnorm=3.243, loss_scale=0.0078, train_wall=8, gb_free=13.7, wall=19402
2022-04-25 17:29:52 - progress_bar.py[line:272] - INFO: epoch 001:   5708 / 6136 loss=1.725, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=5690, lr=6.06553e-06, gnorm=3.163, loss_scale=0.0078, train_wall=8, gb_free=12, wall=19410
2022-04-25 17:30:01 - progress_bar.py[line:272] - INFO: epoch 001:   5718 / 6136 loss=1.725, loss_v1=0, loss_v2=0, nll_loss=0.724, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=5700, lr=6.06311e-06, gnorm=3.605, loss_scale=0.0078, train_wall=8, gb_free=8.2, wall=19418
2022-04-25 17:30:01 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:34:17 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7026 | wps 76.7 | wpb 16 | bsz 16 | num_updates 5700 | best_acc 0.7026
2022-04-25 17:34:25 - progress_bar.py[line:272] - INFO: epoch 001:   5728 / 6136 loss=1.802, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=5710, lr=6.06068e-06, gnorm=3.501, loss_scale=0.0078, train_wall=8, gb_free=13.3, wall=19683
2022-04-25 17:34:34 - progress_bar.py[line:272] - INFO: epoch 001:   5738 / 6136 loss=1.76, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=71.8, ups=1.12, wpb=64, bsz=64, num_updates=5720, lr=6.05825e-06, gnorm=3.581, loss_scale=0.0078, train_wall=9, gb_free=12.5, wall=19692
2022-04-25 17:34:43 - progress_bar.py[line:272] - INFO: epoch 001:   5748 / 6136 loss=1.739, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=75.6, ups=1.18, wpb=64, bsz=64, num_updates=5730, lr=6.05583e-06, gnorm=3.33, loss_scale=0.0078, train_wall=8, gb_free=13.9, wall=19700
2022-04-25 17:34:51 - progress_bar.py[line:272] - INFO: epoch 001:   5758 / 6136 loss=1.727, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=5740, lr=6.0534e-06, gnorm=3.381, loss_scale=0.0078, train_wall=8, gb_free=13.3, wall=19708
2022-04-25 17:34:59 - progress_bar.py[line:272] - INFO: epoch 001:   5768 / 6136 loss=1.747, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=5750, lr=6.05097e-06, gnorm=3.216, loss_scale=0.0078, train_wall=8, gb_free=13.7, wall=19716
2022-04-25 17:35:07 - progress_bar.py[line:272] - INFO: epoch 001:   5778 / 6136 loss=1.731, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=75.9, ups=1.19, wpb=64, bsz=64, num_updates=5760, lr=6.04854e-06, gnorm=3.224, loss_scale=0.0078, train_wall=8, gb_free=12.4, wall=19725
2022-04-25 17:35:16 - progress_bar.py[line:272] - INFO: epoch 001:   5788 / 6136 loss=1.753, loss_v1=0, loss_v2=0, nll_loss=0.751, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=76, ups=1.19, wpb=64, bsz=64, num_updates=5770, lr=6.04612e-06, gnorm=3.097, loss_scale=0.0078, train_wall=8, gb_free=13.1, wall=19733
2022-04-25 17:35:24 - progress_bar.py[line:272] - INFO: epoch 001:   5798 / 6136 loss=1.754, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=78.1, ups=1.22, wpb=64, bsz=64, num_updates=5780, lr=6.04369e-06, gnorm=3.522, loss_scale=0.0078, train_wall=8, gb_free=13.8, wall=19742
2022-04-25 17:35:32 - progress_bar.py[line:272] - INFO: epoch 001:   5808 / 6136 loss=1.684, loss_v1=0, loss_v2=0, nll_loss=0.682, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=5790, lr=6.04126e-06, gnorm=3.083, loss_scale=0.0078, train_wall=8, gb_free=12, wall=19750
2022-04-25 17:35:41 - progress_bar.py[line:272] - INFO: epoch 001:   5818 / 6136 loss=1.749, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=5800, lr=6.03883e-06, gnorm=3.531, loss_scale=0.0078, train_wall=8, gb_free=9.5, wall=19758
2022-04-25 17:35:41 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:39:57 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7066 | wps 76.7 | wpb 16 | bsz 16 | num_updates 5800 | best_acc 0.7066
2022-04-25 17:40:05 - progress_bar.py[line:272] - INFO: epoch 001:   5828 / 6136 loss=1.73, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=5810, lr=6.03641e-06, gnorm=3.398, loss_scale=0.0078, train_wall=8, gb_free=13.6, wall=20023
2022-04-25 17:40:14 - progress_bar.py[line:272] - INFO: epoch 001:   5838 / 6136 loss=1.716, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=76.5, ups=1.2, wpb=64, bsz=64, num_updates=5820, lr=6.03398e-06, gnorm=3.202, loss_scale=0.0078, train_wall=8, gb_free=13.2, wall=20031
2022-04-25 17:40:22 - progress_bar.py[line:272] - INFO: epoch 001:   5848 / 6136 loss=1.759, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=5830, lr=6.03155e-06, gnorm=3.666, loss_scale=0.0078, train_wall=8, gb_free=13.8, wall=20039
2022-04-25 17:40:30 - progress_bar.py[line:272] - INFO: epoch 001:   5858 / 6136 loss=1.751, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=73.9, ups=1.16, wpb=64, bsz=64, num_updates=5840, lr=6.02913e-06, gnorm=3.344, loss_scale=0.0078, train_wall=9, gb_free=13.2, wall=20048
2022-04-25 17:40:39 - progress_bar.py[line:272] - INFO: epoch 001:   5868 / 6136 loss=1.784, loss_v1=0, loss_v2=0, nll_loss=0.783, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=5850, lr=6.0267e-06, gnorm=3.295, loss_scale=0.0078, train_wall=8, gb_free=9.1, wall=20056
2022-04-25 17:40:47 - progress_bar.py[line:272] - INFO: epoch 001:   5878 / 6136 loss=1.806, loss_v1=0, loss_v2=0, nll_loss=0.804, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=79.5, ups=1.24, wpb=64, bsz=64, num_updates=5860, lr=6.02427e-06, gnorm=3.428, loss_scale=0.0078, train_wall=8, gb_free=13.9, wall=20064
2022-04-25 17:40:55 - progress_bar.py[line:272] - INFO: epoch 001:   5888 / 6136 loss=1.709, loss_v1=0, loss_v2=0, nll_loss=0.707, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=5870, lr=6.02184e-06, gnorm=3.394, loss_scale=0.0078, train_wall=9, gb_free=14.1, wall=20073
2022-04-25 17:41:03 - progress_bar.py[line:272] - INFO: epoch 001:   5898 / 6136 loss=1.788, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=5880, lr=6.01942e-06, gnorm=3.253, loss_scale=0.0078, train_wall=8, gb_free=13.2, wall=20081
2022-04-25 17:41:12 - progress_bar.py[line:272] - INFO: epoch 001:   5908 / 6136 loss=1.765, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=5890, lr=6.01699e-06, gnorm=3.529, loss_scale=0.0078, train_wall=8, gb_free=13.6, wall=20089
2022-04-25 17:41:20 - progress_bar.py[line:272] - INFO: epoch 001:   5918 / 6136 loss=1.766, loss_v1=0, loss_v2=0, nll_loss=0.764, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=5900, lr=6.01456e-06, gnorm=3.406, loss_scale=0.0078, train_wall=8, gb_free=14, wall=20097
2022-04-25 17:41:20 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:45:36 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.687 | loss_v1 0 | loss_v2 0 | nll_loss 0.684 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.61 | acc 0.7103 | wps 76.7 | wpb 16 | bsz 16 | num_updates 5900 | best_acc 0.7103
2022-04-25 17:45:44 - progress_bar.py[line:272] - INFO: epoch 001:   5928 / 6136 loss=1.65, loss_v1=0, loss_v2=0, nll_loss=0.649, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.57, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=5910, lr=6.01214e-06, gnorm=3.019, loss_scale=0.0078, train_wall=8, gb_free=12.5, wall=20362
2022-04-25 17:45:52 - progress_bar.py[line:272] - INFO: epoch 001:   5938 / 6136 loss=1.728, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=79.7, ups=1.24, wpb=64, bsz=64, num_updates=5920, lr=6.00971e-06, gnorm=2.905, loss_scale=0.0078, train_wall=8, gb_free=12.7, wall=20370
2022-04-25 17:46:01 - progress_bar.py[line:272] - INFO: epoch 001:   5948 / 6136 loss=1.789, loss_v1=0, loss_v2=0, nll_loss=0.788, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=5930, lr=6.00728e-06, gnorm=3.146, loss_scale=0.0078, train_wall=8, gb_free=13.3, wall=20378
2022-04-25 17:46:09 - progress_bar.py[line:272] - INFO: epoch 001:   5958 / 6136 loss=1.732, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=5940, lr=6.00485e-06, gnorm=2.811, loss_scale=0.0078, train_wall=8, gb_free=13.4, wall=20386
2022-04-25 17:46:18 - progress_bar.py[line:272] - INFO: epoch 001:   5968 / 6136 loss=1.719, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=73.4, ups=1.15, wpb=64, bsz=64, num_updates=5950, lr=6.00243e-06, gnorm=3.154, loss_scale=0.0078, train_wall=9, gb_free=12, wall=20395
2022-04-25 17:46:26 - progress_bar.py[line:272] - INFO: epoch 001:   5978 / 6136 loss=1.666, loss_v1=0, loss_v2=0, nll_loss=0.665, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.59, wps=74.5, ups=1.16, wpb=64, bsz=64, num_updates=5960, lr=6e-06, gnorm=3.33, loss_scale=0.0078, train_wall=9, gb_free=12.1, wall=20404
2022-04-25 17:46:34 - progress_bar.py[line:272] - INFO: epoch 001:   5988 / 6136 loss=1.719, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=5970, lr=5.99757e-06, gnorm=3.251, loss_scale=0.0156, train_wall=8, gb_free=13.6, wall=20412
2022-04-25 17:46:43 - progress_bar.py[line:272] - INFO: epoch 001:   5998 / 6136 loss=1.785, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=5980, lr=5.99515e-06, gnorm=3.406, loss_scale=0.0156, train_wall=8, gb_free=12.6, wall=20420
2022-04-25 17:46:51 - progress_bar.py[line:272] - INFO: epoch 001:   6008 / 6136 loss=1.677, loss_v1=0, loss_v2=0, nll_loss=0.676, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=5990, lr=5.99272e-06, gnorm=3.218, loss_scale=0.0156, train_wall=8, gb_free=13.4, wall=20428
2022-04-25 17:46:59 - progress_bar.py[line:272] - INFO: epoch 001:   6018 / 6136 loss=1.733, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=6000, lr=5.99029e-06, gnorm=4.317, loss_scale=0.0156, train_wall=8, gb_free=12, wall=20437
2022-04-25 17:46:59 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:51:15 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7118 | wps 76.9 | wpb 16 | bsz 16 | num_updates 6000 | best_acc 0.7118
2022-04-25 17:51:15 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 6000 updates
2022-04-25 17:51:15 - trainer.py[line:432] - INFO: Saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_6000.pt
2022-04-25 17:51:28 - trainer.py[line:442] - INFO: Finished saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_6000.pt
2022-04-25 17:51:53 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_1_6000.pt (epoch 1 @ 6000 updates, score 0.7118) (writing took 38.24187313299626 seconds)
2022-04-25 17:52:03 - progress_bar.py[line:272] - INFO: epoch 001:   6028 / 6136 loss=1.808, loss_v1=0, loss_v2=0, nll_loss=0.806, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.75, wps=2.1, ups=0.03, wpb=64, bsz=64, num_updates=6010, lr=5.98786e-06, gnorm=3.338, loss_scale=0.0156, train_wall=9, gb_free=11.6, wall=20741
2022-04-25 17:52:11 - progress_bar.py[line:272] - INFO: epoch 001:   6038 / 6136 loss=1.727, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=6020, lr=5.98544e-06, gnorm=3.01, loss_scale=0.0156, train_wall=8, gb_free=13.6, wall=20749
2022-04-25 17:52:20 - progress_bar.py[line:272] - INFO: epoch 001:   6048 / 6136 loss=1.734, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=74.3, ups=1.16, wpb=64, bsz=64, num_updates=6030, lr=5.98301e-06, gnorm=3.034, loss_scale=0.0156, train_wall=9, gb_free=13.9, wall=20757
2022-04-25 17:52:28 - progress_bar.py[line:272] - INFO: epoch 001:   6058 / 6136 loss=1.739, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=79.7, ups=1.25, wpb=64, bsz=64, num_updates=6040, lr=5.98058e-06, gnorm=3.235, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=20765
2022-04-25 17:52:37 - progress_bar.py[line:272] - INFO: epoch 001:   6068 / 6136 loss=1.709, loss_v1=0, loss_v2=0, nll_loss=0.708, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=73.3, ups=1.15, wpb=64, bsz=64, num_updates=6050, lr=5.97816e-06, gnorm=3.293, loss_scale=0.0156, train_wall=9, gb_free=13.7, wall=20774
2022-04-25 17:52:45 - progress_bar.py[line:272] - INFO: epoch 001:   6078 / 6136 loss=1.787, loss_v1=0, loss_v2=0, nll_loss=0.785, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=78.2, ups=1.22, wpb=64, bsz=64, num_updates=6060, lr=5.97573e-06, gnorm=14.93, loss_scale=0.0156, train_wall=8, gb_free=13.3, wall=20782
2022-04-25 17:52:53 - progress_bar.py[line:272] - INFO: epoch 001:   6088 / 6136 loss=1.747, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=79, ups=1.23, wpb=64, bsz=64, num_updates=6070, lr=5.9733e-06, gnorm=2.984, loss_scale=0.0156, train_wall=8, gb_free=13.1, wall=20790
2022-04-25 17:53:01 - progress_bar.py[line:272] - INFO: epoch 001:   6098 / 6136 loss=1.756, loss_v1=0, loss_v2=0, nll_loss=0.754, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=79, ups=1.23, wpb=64, bsz=64, num_updates=6080, lr=5.97087e-06, gnorm=3.348, loss_scale=0.0156, train_wall=8, gb_free=13.8, wall=20799
2022-04-25 17:53:10 - progress_bar.py[line:272] - INFO: epoch 001:   6108 / 6136 loss=1.691, loss_v1=0, loss_v2=0, nll_loss=0.69, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.61, wps=74.8, ups=1.17, wpb=64, bsz=64, num_updates=6090, lr=5.96845e-06, gnorm=3.148, loss_scale=0.0156, train_wall=9, gb_free=12.7, wall=20807
2022-04-25 17:53:18 - progress_bar.py[line:272] - INFO: epoch 001:   6118 / 6136 loss=1.678, loss_v1=0, loss_v2=0, nll_loss=0.677, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=79, ups=1.23, wpb=64, bsz=64, num_updates=6100, lr=5.96602e-06, gnorm=3.312, loss_scale=0.0156, train_wall=8, gb_free=12.7, wall=20815
2022-04-25 17:53:18 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 17:57:33 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 1.681 | loss_v1 0 | loss_v2 0 | nll_loss 0.679 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.6 | acc 0.7101 | wps 77.1 | wpb 16 | bsz 16 | num_updates 6100 | best_acc 0.7118
2022-04-25 17:57:42 - progress_bar.py[line:272] - INFO: epoch 001:   6128 / 6136 loss=1.721, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=6110, lr=5.96359e-06, gnorm=3.383, loss_scale=0.0156, train_wall=9, gb_free=8.1, wall=21079
2022-04-25 17:57:48 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:01:27 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7029 | wps 89.6 | wpb 16 | bsz 16 | num_updates 6118 | best_acc 0.7118
2022-04-25 18:01:27 - train.py[line:322] - INFO: end of epoch 1 (average epoch stats below)
2022-04-25 18:01:27 - progress_bar.py[line:282] - INFO: epoch 001 | loss 1.939 | loss_v1 0 | loss_v2 0 | nll_loss 0.928 | ntokens 64 | nsentences 64 | sample_size 64 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.9 | wps 18.4 | ups 0.29 | wpb 64 | bsz 64 | num_updates 6118 | lr 5.96165e-06 | gnorm 4.193 | loss_scale 0.0156 | train_wall 5289 | gb_free 13.1 | wall 21305
2022-04-25 18:01:27 - trainer.py[line:640] - INFO: loading train data for epoch 2
local datafile ../../dataset/glue_data/mnli_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/glue_data/mnli_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/glue_data/mnli_train.tsv slice_id 0 row count 392702 total row count 392702
slice_id 0 seek offset 0
2022-04-25 18:01:28 - trainer.py[line:704] - INFO: begin training epoch 2
2022-04-25 18:01:28 - train.py[line:295] - INFO: Start iterating over samples
2022-04-25 18:01:30 - progress_bar.py[line:272] - INFO: epoch 002:      2 / 6136 loss=1.714, loss_v1=0, loss_v2=0, nll_loss=0.713, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=2.8, ups=0.04, wpb=64, bsz=64, num_updates=6120, lr=5.96117e-06, gnorm=3.265, loss_scale=0.0156, train_wall=8, gb_free=13.7, wall=21308
2022-04-25 18:01:39 - progress_bar.py[line:272] - INFO: epoch 002:     12 / 6136 loss=1.72, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=73.5, ups=1.15, wpb=64, bsz=64, num_updates=6130, lr=5.95874e-06, gnorm=3.637, loss_scale=0.0156, train_wall=9, gb_free=13.2, wall=21316
2022-04-25 18:01:45 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.0078125
2022-04-25 18:01:48 - progress_bar.py[line:272] - INFO: epoch 002:     23 / 6136 loss=1.734, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=69.4, ups=1.08, wpb=64, bsz=64, num_updates=6140, lr=5.95631e-06, gnorm=3.158, loss_scale=0.0078, train_wall=9, gb_free=12.4, wall=21326
2022-04-25 18:01:56 - progress_bar.py[line:272] - INFO: epoch 002:     33 / 6136 loss=1.727, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=6150, lr=5.95388e-06, gnorm=3.123, loss_scale=0.0078, train_wall=8, gb_free=13.6, wall=21334
2022-04-25 18:02:05 - progress_bar.py[line:272] - INFO: epoch 002:     43 / 6136 loss=1.775, loss_v1=0, loss_v2=0, nll_loss=0.773, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=6160, lr=5.95146e-06, gnorm=4.044, loss_scale=0.0078, train_wall=8, gb_free=13.7, wall=21342
2022-04-25 18:02:13 - progress_bar.py[line:272] - INFO: epoch 002:     53 / 6136 loss=1.739, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=6170, lr=5.94903e-06, gnorm=3.253, loss_scale=0.0078, train_wall=8, gb_free=13.9, wall=21350
2022-04-25 18:02:21 - progress_bar.py[line:272] - INFO: epoch 002:     63 / 6136 loss=1.737, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=78.7, ups=1.23, wpb=64, bsz=64, num_updates=6180, lr=5.9466e-06, gnorm=3.668, loss_scale=0.0078, train_wall=8, gb_free=13.3, wall=21358
2022-04-25 18:02:29 - progress_bar.py[line:272] - INFO: epoch 002:     73 / 6136 loss=1.728, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=6190, lr=5.94417e-06, gnorm=3.732, loss_scale=0.0078, train_wall=8, gb_free=13.9, wall=21367
2022-04-25 18:02:38 - progress_bar.py[line:272] - INFO: epoch 002:     83 / 6136 loss=1.779, loss_v1=0, loss_v2=0, nll_loss=0.777, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=73.8, ups=1.15, wpb=64, bsz=64, num_updates=6200, lr=5.94175e-06, gnorm=4.204, loss_scale=0.0078, train_wall=9, gb_free=14, wall=21375
2022-04-25 18:02:38 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:52 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:06:53 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.673 | loss_v1 0 | loss_v2 0 | nll_loss 0.671 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.59 | acc 0.7157 | wps 77.3 | wpb 16 | bsz 16 | num_updates 6200 | best_acc 0.7157
2022-04-25 18:07:01 - progress_bar.py[line:272] - INFO: epoch 002:     93 / 6136 loss=1.744, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=6210, lr=5.93932e-06, gnorm=3.589, loss_scale=0.0078, train_wall=8, gb_free=12.6, wall=21638
2022-04-25 18:07:06 - trainer.py[line:1304] - WARNING: OOM: Ran out of memory with exception: CUDA out of memory. Tried to allocate 1.54 GiB (GPU 0; 23.70 GiB total capacity; 19.23 GiB already allocated; 1.46 GiB free; 21.12 GiB reserved in total by PyTorch)
2022-04-25 18:07:06 - trainer.py[line:1307] - WARNING: |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 4            |        cudaMalloc retries: 9         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   18120 MB |   19692 MB |  582363 GB |  582345 GB |
|       from large pool |   18081 MB |   19653 MB |  572978 GB |  572960 GB |
|       from small pool |      39 MB |      52 MB |    9384 GB |    9384 GB |
|---------------------------------------------------------------------------|
| Active memory         |   18120 MB |   19692 MB |  582363 GB |  582345 GB |
|       from large pool |   18081 MB |   19653 MB |  572978 GB |  572960 GB |
|       from small pool |      39 MB |      52 MB |    9384 GB |    9384 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   21626 MB |   23078 MB |   52178 MB |   30552 MB |
|       from large pool |   21572 MB |   22984 MB |   51878 MB |   30306 MB |
|       from small pool |      54 MB |      94 MB |     300 MB |     246 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1933 MB |    1933 MB |  493644 GB |  493642 GB |
|       from large pool |    1918 MB |    1918 MB |  484153 GB |  484151 GB |
|       from small pool |      14 MB |      33 MB |    9491 GB |    9490 GB |
|---------------------------------------------------------------------------|
| Allocations           |    2439    |    2465    |  297752 K  |  297750 K  |
|       from large pool |     850    |     857    |  141645 K  |  141644 K  |
|       from small pool |    1589    |    1608    |  156107 K  |  156105 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2439    |    2465    |  297752 K  |  297750 K  |
|       from large pool |     850    |     857    |  141645 K  |  141644 K  |
|       from small pool |    1589    |    1608    |  156107 K  |  156105 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     143    |     164    |     406    |     263    |
|       from large pool |     116    |     117    |     256    |     140    |
|       from small pool |      27    |      47    |     150    |     123    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     165    |     208    |  189846 K  |  189846 K  |
|       from large pool |      96    |      96    |  108722 K  |  108722 K  |
|       from small pool |      69    |     123    |   81123 K  |   81123 K  |
|===========================================================================|

2022-04-25 18:07:06 - trainer.py[line:797] - WARNING: attempting to recover from OOM in forward/backward pass
2022-04-25 18:07:10 - progress_bar.py[line:272] - INFO: epoch 002:    104 / 6136 loss=1.732, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=72.7, ups=1.14, wpb=64, bsz=64, num_updates=6220, lr=5.93689e-06, gnorm=3.022, loss_scale=0.0078, train_wall=8, gb_free=13.5, wall=21647
2022-04-25 18:07:16 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.00390625
2022-04-25 18:07:19 - progress_bar.py[line:272] - INFO: epoch 002:    115 / 6136 loss=1.715, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=68.4, ups=1.07, wpb=64, bsz=64, num_updates=6230, lr=5.93447e-06, gnorm=3.591, loss_scale=0.0039, train_wall=9, gb_free=13.3, wall=21657
2022-04-25 18:07:28 - progress_bar.py[line:272] - INFO: epoch 002:    125 / 6136 loss=1.74, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=75.5, ups=1.18, wpb=64, bsz=64, num_updates=6240, lr=5.93204e-06, gnorm=3.556, loss_scale=0.0039, train_wall=8, gb_free=13.8, wall=21665
2022-04-25 18:07:36 - progress_bar.py[line:272] - INFO: epoch 002:    135 / 6136 loss=1.763, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=78.1, ups=1.22, wpb=64, bsz=64, num_updates=6250, lr=5.92961e-06, gnorm=3.202, loss_scale=0.0039, train_wall=8, gb_free=13.6, wall=21673
2022-04-25 18:07:44 - progress_bar.py[line:272] - INFO: epoch 002:    145 / 6136 loss=1.748, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=6260, lr=5.92718e-06, gnorm=3.149, loss_scale=0.0039, train_wall=8, gb_free=14.2, wall=21682
2022-04-25 18:07:52 - progress_bar.py[line:272] - INFO: epoch 002:    155 / 6136 loss=1.721, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.3, ups=1.21, wpb=64, bsz=64, num_updates=6270, lr=5.92476e-06, gnorm=3.003, loss_scale=0.0039, train_wall=8, gb_free=13.8, wall=21690
2022-04-25 18:08:01 - progress_bar.py[line:272] - INFO: epoch 002:    165 / 6136 loss=1.77, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=74.1, ups=1.16, wpb=64, bsz=64, num_updates=6280, lr=5.92233e-06, gnorm=3.331, loss_scale=0.0039, train_wall=9, gb_free=13.8, wall=21698
2022-04-25 18:08:09 - progress_bar.py[line:272] - INFO: epoch 002:    175 / 6136 loss=1.738, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=6290, lr=5.9199e-06, gnorm=3.178, loss_scale=0.0039, train_wall=8, gb_free=12.8, wall=21707
2022-04-25 18:08:12 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.001953125
2022-04-25 18:08:18 - progress_bar.py[line:272] - INFO: epoch 002:    186 / 6136 loss=1.742, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=71.6, ups=1.12, wpb=64, bsz=64, num_updates=6300, lr=5.91748e-06, gnorm=2.929, loss_scale=0.002, train_wall=9, gb_free=13.7, wall=21716
2022-04-25 18:08:18 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:12:26 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.686 | loss_v1 0 | loss_v2 0 | nll_loss 0.684 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.61 | acc 0.7082 | wps 79.2 | wpb 16 | bsz 16 | num_updates 6300 | best_acc 0.7118
2022-04-25 18:12:35 - progress_bar.py[line:272] - INFO: epoch 002:    196 / 6136 loss=1.786, loss_v1=0, loss_v2=0, nll_loss=0.784, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=6310, lr=5.91505e-06, gnorm=3.216, loss_scale=0.002, train_wall=8, gb_free=13.9, wall=21972
2022-04-25 18:12:43 - progress_bar.py[line:272] - INFO: epoch 002:    206 / 6136 loss=1.7, loss_v1=0, loss_v2=0, nll_loss=0.699, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=6320, lr=5.91262e-06, gnorm=3.4, loss_scale=0.002, train_wall=8, gb_free=13.7, wall=21980
2022-04-25 18:12:51 - progress_bar.py[line:272] - INFO: epoch 002:    216 / 6136 loss=1.762, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=6330, lr=5.91019e-06, gnorm=3.382, loss_scale=0.002, train_wall=8, gb_free=13.5, wall=21989
2022-04-25 18:13:00 - progress_bar.py[line:272] - INFO: epoch 002:    226 / 6136 loss=1.732, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=6340, lr=5.90777e-06, gnorm=2.95, loss_scale=0.002, train_wall=8, gb_free=11.5, wall=21997
2022-04-25 18:13:08 - progress_bar.py[line:272] - INFO: epoch 002:    236 / 6136 loss=1.745, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=6350, lr=5.90534e-06, gnorm=3.172, loss_scale=0.002, train_wall=8, gb_free=13.9, wall=22005
2022-04-25 18:13:16 - progress_bar.py[line:272] - INFO: epoch 002:    246 / 6136 loss=1.728, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=75.8, ups=1.19, wpb=64, bsz=64, num_updates=6360, lr=5.90291e-06, gnorm=2.769, loss_scale=0.002, train_wall=8, gb_free=13.8, wall=22014
2022-04-25 18:13:24 - progress_bar.py[line:272] - INFO: epoch 002:    256 / 6136 loss=1.751, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=6370, lr=5.90049e-06, gnorm=3.241, loss_scale=0.002, train_wall=8, gb_free=13.4, wall=22022
2022-04-25 18:13:25 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.0009765625
2022-04-25 18:13:34 - progress_bar.py[line:272] - INFO: epoch 002:    267 / 6136 loss=1.694, loss_v1=0, loss_v2=0, nll_loss=0.693, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=69.7, ups=1.09, wpb=64, bsz=64, num_updates=6380, lr=5.89806e-06, gnorm=3.128, loss_scale=0.001, train_wall=9, gb_free=12.3, wall=22031
2022-04-25 18:13:42 - progress_bar.py[line:272] - INFO: epoch 002:    277 / 6136 loss=1.76, loss_v1=0, loss_v2=0, nll_loss=0.758, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=76.7, ups=1.2, wpb=64, bsz=64, num_updates=6390, lr=5.89563e-06, gnorm=3.612, loss_scale=0.001, train_wall=8, gb_free=13.1, wall=22039
2022-04-25 18:13:51 - progress_bar.py[line:272] - INFO: epoch 002:    287 / 6136 loss=1.754, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=72.1, ups=1.13, wpb=64, bsz=64, num_updates=6400, lr=5.8932e-06, gnorm=3.321, loss_scale=0.001, train_wall=9, gb_free=13.9, wall=22048
2022-04-25 18:13:51 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:18:04 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7113 | wps 77.6 | wpb 16 | bsz 16 | num_updates 6400 | best_acc 0.7118
2022-04-25 18:18:12 - progress_bar.py[line:272] - INFO: epoch 002:    297 / 6136 loss=1.772, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=6410, lr=5.89078e-06, gnorm=2.867, loss_scale=0.001, train_wall=8, gb_free=11.1, wall=22310
2022-04-25 18:18:21 - progress_bar.py[line:272] - INFO: epoch 002:    307 / 6136 loss=1.728, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=6420, lr=5.88835e-06, gnorm=2.65, loss_scale=0.001, train_wall=8, gb_free=12.4, wall=22318
2022-04-25 18:18:29 - progress_bar.py[line:272] - INFO: epoch 002:    317 / 6136 loss=1.723, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=6430, lr=5.88592e-06, gnorm=3.121, loss_scale=0.001, train_wall=9, gb_free=13.5, wall=22327
2022-04-25 18:18:38 - progress_bar.py[line:272] - INFO: epoch 002:    327 / 6136 loss=1.696, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=6440, lr=5.8835e-06, gnorm=3.279, loss_scale=0.001, train_wall=8, gb_free=13.5, wall=22335
2022-04-25 18:18:46 - progress_bar.py[line:272] - INFO: epoch 002:    337 / 6136 loss=1.756, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=79.4, ups=1.24, wpb=64, bsz=64, num_updates=6450, lr=5.88107e-06, gnorm=3.451, loss_scale=0.001, train_wall=8, gb_free=13.9, wall=22343
2022-04-25 18:18:54 - progress_bar.py[line:272] - INFO: epoch 002:    347 / 6136 loss=1.722, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=73.2, ups=1.14, wpb=64, bsz=64, num_updates=6460, lr=5.87864e-06, gnorm=3.036, loss_scale=0.001, train_wall=9, gb_free=8.1, wall=22352
2022-04-25 18:19:03 - progress_bar.py[line:272] - INFO: epoch 002:    357 / 6136 loss=1.653, loss_v1=0, loss_v2=0, nll_loss=0.651, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.57, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=6470, lr=5.87621e-06, gnorm=2.985, loss_scale=0.001, train_wall=8, gb_free=13.5, wall=22360
2022-04-25 18:19:11 - progress_bar.py[line:272] - INFO: epoch 002:    367 / 6136 loss=1.71, loss_v1=0, loss_v2=0, nll_loss=0.709, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=6480, lr=5.87379e-06, gnorm=3.38, loss_scale=0.001, train_wall=8, gb_free=13.6, wall=22368
2022-04-25 18:19:19 - progress_bar.py[line:272] - INFO: epoch 002:    377 / 6136 loss=1.712, loss_v1=0, loss_v2=0, nll_loss=0.71, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=6490, lr=5.87136e-06, gnorm=3.061, loss_scale=0.001, train_wall=8, gb_free=13.2, wall=22377
2022-04-25 18:19:27 - progress_bar.py[line:272] - INFO: epoch 002:    387 / 6136 loss=1.731, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=6500, lr=5.86893e-06, gnorm=3.162, loss_scale=0.001, train_wall=8, gb_free=14.2, wall=22385
2022-04-25 18:19:27 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:23:42 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.682 | loss_v1 0 | loss_v2 0 | nll_loss 0.679 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.6 | acc 0.7121 | wps 77.1 | wpb 16 | bsz 16 | num_updates 6500 | best_acc 0.7121
2022-04-25 18:23:51 - progress_bar.py[line:272] - INFO: epoch 002:    397 / 6136 loss=1.721, loss_v1=0, loss_v2=0, nll_loss=0.719, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=6510, lr=5.8665e-06, gnorm=3.55, loss_scale=0.001, train_wall=8, gb_free=13.5, wall=22648
2022-04-25 18:23:59 - progress_bar.py[line:272] - INFO: epoch 002:    407 / 6136 loss=1.697, loss_v1=0, loss_v2=0, nll_loss=0.695, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=80.5, ups=1.26, wpb=64, bsz=64, num_updates=6520, lr=5.86408e-06, gnorm=3.286, loss_scale=0.001, train_wall=8, gb_free=13.7, wall=22656
2022-04-25 18:24:07 - progress_bar.py[line:272] - INFO: epoch 002:    417 / 6136 loss=1.716, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=6530, lr=5.86165e-06, gnorm=3.52, loss_scale=0.001, train_wall=8, gb_free=13.7, wall=22664
2022-04-25 18:24:15 - progress_bar.py[line:272] - INFO: epoch 002:    427 / 6136 loss=1.734, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=79.5, ups=1.24, wpb=64, bsz=64, num_updates=6540, lr=5.85922e-06, gnorm=3.193, loss_scale=0.001, train_wall=8, gb_free=13.8, wall=22672
2022-04-25 18:24:23 - progress_bar.py[line:272] - INFO: epoch 002:    437 / 6136 loss=1.704, loss_v1=0, loss_v2=0, nll_loss=0.702, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=6550, lr=5.8568e-06, gnorm=3.294, loss_scale=0.001, train_wall=8, gb_free=11.4, wall=22681
2022-04-25 18:24:32 - progress_bar.py[line:272] - INFO: epoch 002:    447 / 6136 loss=1.758, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=70.9, ups=1.11, wpb=64, bsz=64, num_updates=6560, lr=5.85437e-06, gnorm=3.558, loss_scale=0.001, train_wall=9, gb_free=14.1, wall=22690
2022-04-25 18:24:40 - progress_bar.py[line:272] - INFO: epoch 002:    457 / 6136 loss=1.762, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=6570, lr=5.85194e-06, gnorm=3.139, loss_scale=0.001, train_wall=8, gb_free=13.5, wall=22698
2022-04-25 18:24:49 - progress_bar.py[line:272] - INFO: epoch 002:    467 / 6136 loss=1.762, loss_v1=0, loss_v2=0, nll_loss=0.76, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=75.4, ups=1.18, wpb=64, bsz=64, num_updates=6580, lr=5.84951e-06, gnorm=3.513, loss_scale=0.001, train_wall=8, gb_free=13.6, wall=22706
2022-04-25 18:24:58 - progress_bar.py[line:272] - INFO: epoch 002:    477 / 6136 loss=1.687, loss_v1=0, loss_v2=0, nll_loss=0.685, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.61, wps=74, ups=1.16, wpb=64, bsz=64, num_updates=6590, lr=5.84709e-06, gnorm=3.182, loss_scale=0.001, train_wall=9, gb_free=12.9, wall=22715
2022-04-25 18:25:06 - progress_bar.py[line:272] - INFO: epoch 002:    487 / 6136 loss=1.701, loss_v1=0, loss_v2=0, nll_loss=0.699, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=72.5, ups=1.13, wpb=64, bsz=64, num_updates=6600, lr=5.84466e-06, gnorm=2.887, loss_scale=0.001, train_wall=9, gb_free=12.6, wall=22724
2022-04-25 18:25:06 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:29:20 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7089 | wps 77.6 | wpb 16 | bsz 16 | num_updates 6600 | best_acc 0.7118
2022-04-25 18:29:29 - progress_bar.py[line:272] - INFO: epoch 002:    497 / 6136 loss=1.766, loss_v1=0, loss_v2=0, nll_loss=0.765, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=6610, lr=5.84223e-06, gnorm=3.485, loss_scale=0.001, train_wall=9, gb_free=13.2, wall=22987
2022-04-25 18:29:38 - progress_bar.py[line:272] - INFO: epoch 002:    507 / 6136 loss=1.754, loss_v1=0, loss_v2=0, nll_loss=0.752, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=74.1, ups=1.16, wpb=64, bsz=64, num_updates=6620, lr=5.83981e-06, gnorm=3.305, loss_scale=0.001, train_wall=9, gb_free=12.7, wall=22995
2022-04-25 18:29:46 - progress_bar.py[line:272] - INFO: epoch 002:    517 / 6136 loss=1.788, loss_v1=0, loss_v2=0, nll_loss=0.786, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=78.7, ups=1.23, wpb=64, bsz=64, num_updates=6630, lr=5.83738e-06, gnorm=3.095, loss_scale=0.001, train_wall=8, gb_free=13.5, wall=23004
2022-04-25 18:29:54 - progress_bar.py[line:272] - INFO: epoch 002:    527 / 6136 loss=1.694, loss_v1=0, loss_v2=0, nll_loss=0.692, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=6640, lr=5.83495e-06, gnorm=3.033, loss_scale=0.001, train_wall=8, gb_free=12.7, wall=23012
2022-04-25 18:30:03 - progress_bar.py[line:272] - INFO: epoch 002:    537 / 6136 loss=1.744, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=76.7, ups=1.2, wpb=64, bsz=64, num_updates=6650, lr=5.83252e-06, gnorm=3.45, loss_scale=0.001, train_wall=8, gb_free=12.1, wall=23020
2022-04-25 18:30:11 - progress_bar.py[line:272] - INFO: epoch 002:    547 / 6136 loss=1.751, loss_v1=0, loss_v2=0, nll_loss=0.749, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=79.4, ups=1.24, wpb=64, bsz=64, num_updates=6660, lr=5.8301e-06, gnorm=3.018, loss_scale=0.001, train_wall=8, gb_free=12.9, wall=23028
2022-04-25 18:30:19 - progress_bar.py[line:272] - INFO: epoch 002:    557 / 6136 loss=1.742, loss_v1=0, loss_v2=0, nll_loss=0.74, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=6670, lr=5.82767e-06, gnorm=3.279, loss_scale=0.001, train_wall=8, gb_free=12.8, wall=23036
2022-04-25 18:30:27 - progress_bar.py[line:272] - INFO: epoch 002:    567 / 6136 loss=1.727, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=6680, lr=5.82524e-06, gnorm=3.182, loss_scale=0.001, train_wall=8, gb_free=14.1, wall=23044
2022-04-25 18:30:36 - progress_bar.py[line:272] - INFO: epoch 002:    577 / 6136 loss=1.722, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=72.3, ups=1.13, wpb=64, bsz=64, num_updates=6690, lr=5.82282e-06, gnorm=3.013, loss_scale=0.001, train_wall=9, gb_free=13, wall=23053
2022-04-25 18:30:44 - progress_bar.py[line:272] - INFO: epoch 002:    587 / 6136 loss=1.791, loss_v1=0, loss_v2=0, nll_loss=0.789, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=6700, lr=5.82039e-06, gnorm=3.242, loss_scale=0.001, train_wall=8, gb_free=13.3, wall=23062
2022-04-25 18:30:44 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:34:43 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7031 | wps 82.2 | wpb 16 | bsz 16 | num_updates 6700 | best_acc 0.7118
2022-04-25 18:34:51 - progress_bar.py[line:272] - INFO: epoch 002:    597 / 6136 loss=1.745, loss_v1=0, loss_v2=0, nll_loss=0.743, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=6710, lr=5.81796e-06, gnorm=4.022, loss_scale=0.001, train_wall=8, gb_free=13.6, wall=23309
2022-04-25 18:35:00 - progress_bar.py[line:272] - INFO: epoch 002:    607 / 6136 loss=1.738, loss_v1=0, loss_v2=0, nll_loss=0.736, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=73.9, ups=1.15, wpb=64, bsz=64, num_updates=6720, lr=5.81553e-06, gnorm=3.255, loss_scale=0.001, train_wall=9, gb_free=13.9, wall=23318
2022-04-25 18:35:09 - progress_bar.py[line:272] - INFO: epoch 002:    617 / 6136 loss=1.724, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=6730, lr=5.81311e-06, gnorm=3.078, loss_scale=0.001, train_wall=8, gb_free=14, wall=23326
2022-04-25 18:35:17 - progress_bar.py[line:272] - INFO: epoch 002:    627 / 6136 loss=1.723, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=6740, lr=5.81068e-06, gnorm=2.902, loss_scale=0.001, train_wall=8, gb_free=11.7, wall=23334
2022-04-25 18:35:25 - progress_bar.py[line:272] - INFO: epoch 002:    637 / 6136 loss=1.708, loss_v1=0, loss_v2=0, nll_loss=0.707, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=6750, lr=5.80825e-06, gnorm=3.359, loss_scale=0.001, train_wall=8, gb_free=13.2, wall=23343
2022-04-25 18:35:35 - progress_bar.py[line:272] - INFO: epoch 002:    647 / 6136 loss=1.68, loss_v1=0, loss_v2=0, nll_loss=0.678, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=69.1, ups=1.08, wpb=64, bsz=64, num_updates=6760, lr=5.80583e-06, gnorm=2.86, loss_scale=0.001, train_wall=9, gb_free=13.7, wall=23352
2022-04-25 18:35:43 - progress_bar.py[line:272] - INFO: epoch 002:    657 / 6136 loss=1.772, loss_v1=0, loss_v2=0, nll_loss=0.77, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=75, ups=1.17, wpb=64, bsz=64, num_updates=6770, lr=5.8034e-06, gnorm=3.403, loss_scale=0.001, train_wall=8, gb_free=12.3, wall=23361
2022-04-25 18:35:51 - progress_bar.py[line:272] - INFO: epoch 002:    667 / 6136 loss=1.744, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=6780, lr=5.80097e-06, gnorm=3.209, loss_scale=0.001, train_wall=8, gb_free=12.6, wall=23369
2022-04-25 18:36:00 - progress_bar.py[line:272] - INFO: epoch 002:    677 / 6136 loss=1.719, loss_v1=0, loss_v2=0, nll_loss=0.717, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=78.4, ups=1.22, wpb=64, bsz=64, num_updates=6790, lr=5.79854e-06, gnorm=3.067, loss_scale=0.001, train_wall=8, gb_free=13.3, wall=23377
2022-04-25 18:36:08 - progress_bar.py[line:272] - INFO: epoch 002:    687 / 6136 loss=1.736, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=6800, lr=5.79612e-06, gnorm=2.8, loss_scale=0.001, train_wall=8, gb_free=13.9, wall=23385
2022-04-25 18:36:08 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:40:22 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.673 | loss_v1 0 | loss_v2 0 | nll_loss 0.67 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.59 | acc 0.7156 | wps 77.4 | wpb 16 | bsz 16 | num_updates 6800 | best_acc 0.7156
2022-04-25 18:40:30 - progress_bar.py[line:272] - INFO: epoch 002:    697 / 6136 loss=1.731, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=6810, lr=5.79369e-06, gnorm=2.832, loss_scale=0.001, train_wall=8, gb_free=11.5, wall=23648
2022-04-25 18:40:38 - progress_bar.py[line:272] - INFO: epoch 002:    707 / 6136 loss=1.747, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=79.3, ups=1.24, wpb=64, bsz=64, num_updates=6820, lr=5.79126e-06, gnorm=3.255, loss_scale=0.001, train_wall=8, gb_free=13.7, wall=23656
2022-04-25 18:40:47 - progress_bar.py[line:272] - INFO: epoch 002:    717 / 6136 loss=1.7, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=78.4, ups=1.23, wpb=64, bsz=64, num_updates=6830, lr=5.78883e-06, gnorm=3.098, loss_scale=0.001, train_wall=8, gb_free=12.5, wall=23664
2022-04-25 18:40:55 - progress_bar.py[line:272] - INFO: epoch 002:    727 / 6136 loss=1.764, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=75.9, ups=1.19, wpb=64, bsz=64, num_updates=6840, lr=5.78641e-06, gnorm=3.324, loss_scale=0.001, train_wall=8, gb_free=13.6, wall=23673
2022-04-25 18:41:03 - progress_bar.py[line:272] - INFO: epoch 002:    737 / 6136 loss=1.729, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=6850, lr=5.78398e-06, gnorm=2.996, loss_scale=0.001, train_wall=8, gb_free=14, wall=23681
2022-04-25 18:41:12 - progress_bar.py[line:272] - INFO: epoch 002:    747 / 6136 loss=1.749, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=6860, lr=5.78155e-06, gnorm=3.571, loss_scale=0.001, train_wall=8, gb_free=13.2, wall=23689
2022-04-25 18:41:20 - progress_bar.py[line:272] - INFO: epoch 002:    757 / 6136 loss=1.717, loss_v1=0, loss_v2=0, nll_loss=0.715, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=74.8, ups=1.17, wpb=64, bsz=64, num_updates=6870, lr=5.77913e-06, gnorm=2.987, loss_scale=0.001, train_wall=9, gb_free=12.9, wall=23698
2022-04-25 18:41:29 - progress_bar.py[line:272] - INFO: epoch 002:    767 / 6136 loss=1.704, loss_v1=0, loss_v2=0, nll_loss=0.702, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=75.1, ups=1.17, wpb=64, bsz=64, num_updates=6880, lr=5.7767e-06, gnorm=3.301, loss_scale=0.001, train_wall=8, gb_free=13.5, wall=23706
2022-04-25 18:41:37 - progress_bar.py[line:272] - INFO: epoch 002:    777 / 6136 loss=1.726, loss_v1=0, loss_v2=0, nll_loss=0.725, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=6890, lr=5.77427e-06, gnorm=3.175, loss_scale=0.002, train_wall=8, gb_free=12.9, wall=23715
2022-04-25 18:41:45 - progress_bar.py[line:272] - INFO: epoch 002:    787 / 6136 loss=1.695, loss_v1=0, loss_v2=0, nll_loss=0.693, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=6900, lr=5.77184e-06, gnorm=3.112, loss_scale=0.002, train_wall=8, gb_free=13.7, wall=23723
2022-04-25 18:41:45 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:45:59 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7137 | wps 77.6 | wpb 16 | bsz 16 | num_updates 6900 | best_acc 0.7137
2022-04-25 18:46:07 - progress_bar.py[line:272] - INFO: epoch 002:    797 / 6136 loss=1.73, loss_v1=0, loss_v2=0, nll_loss=0.728, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=6910, lr=5.76942e-06, gnorm=3.303, loss_scale=0.002, train_wall=8, gb_free=13.4, wall=23985
2022-04-25 18:46:16 - progress_bar.py[line:272] - INFO: epoch 002:    807 / 6136 loss=1.752, loss_v1=0, loss_v2=0, nll_loss=0.75, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=6920, lr=5.76699e-06, gnorm=3.559, loss_scale=0.002, train_wall=8, gb_free=13.3, wall=23993
2022-04-25 18:46:24 - progress_bar.py[line:272] - INFO: epoch 002:    817 / 6136 loss=1.744, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=6930, lr=5.76456e-06, gnorm=3.29, loss_scale=0.002, train_wall=8, gb_free=12.8, wall=24002
2022-04-25 18:46:32 - progress_bar.py[line:272] - INFO: epoch 002:    827 / 6136 loss=1.77, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=6940, lr=5.76214e-06, gnorm=4.013, loss_scale=0.002, train_wall=8, gb_free=12.9, wall=24010
2022-04-25 18:46:41 - progress_bar.py[line:272] - INFO: epoch 002:    837 / 6136 loss=1.727, loss_v1=0, loss_v2=0, nll_loss=0.726, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=76, ups=1.19, wpb=64, bsz=64, num_updates=6950, lr=5.75971e-06, gnorm=2.873, loss_scale=0.002, train_wall=8, gb_free=13.8, wall=24018
2022-04-25 18:46:49 - progress_bar.py[line:272] - INFO: epoch 002:    847 / 6136 loss=1.75, loss_v1=0, loss_v2=0, nll_loss=0.748, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=6960, lr=5.75728e-06, gnorm=3.344, loss_scale=0.002, train_wall=8, gb_free=13.7, wall=24026
2022-04-25 18:46:57 - progress_bar.py[line:272] - INFO: epoch 002:    857 / 6136 loss=1.737, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=79, ups=1.23, wpb=64, bsz=64, num_updates=6970, lr=5.75485e-06, gnorm=3.374, loss_scale=0.002, train_wall=8, gb_free=14, wall=24035
2022-04-25 18:47:05 - progress_bar.py[line:272] - INFO: epoch 002:    867 / 6136 loss=1.681, loss_v1=0, loss_v2=0, nll_loss=0.68, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=6980, lr=5.75243e-06, gnorm=3.511, loss_scale=0.002, train_wall=8, gb_free=12.2, wall=24043
2022-04-25 18:47:14 - progress_bar.py[line:272] - INFO: epoch 002:    877 / 6136 loss=1.764, loss_v1=0, loss_v2=0, nll_loss=0.763, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=75.3, ups=1.18, wpb=64, bsz=64, num_updates=6990, lr=5.75e-06, gnorm=3.133, loss_scale=0.002, train_wall=8, gb_free=12.8, wall=24051
2022-04-25 18:47:23 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.0009765625
2022-04-25 18:47:23 - progress_bar.py[line:272] - INFO: epoch 002:    888 / 6136 loss=1.675, loss_v1=0, loss_v2=0, nll_loss=0.674, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.6, wps=67.1, ups=1.05, wpb=64, bsz=64, num_updates=7000, lr=5.74757e-06, gnorm=3.526, loss_scale=0.001, train_wall=9, gb_free=10.5, wall=24061
2022-04-25 18:47:23 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:51:38 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7109 | wps 77.1 | wpb 16 | bsz 16 | num_updates 7000 | best_acc 0.7118
2022-04-25 18:51:39 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 7000 updates
2022-04-25 18:51:39 - trainer.py[line:432] - INFO: Saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_2_7000.pt
2022-04-25 18:51:51 - trainer.py[line:442] - INFO: Finished saving checkpoint to ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_2_7000.pt
2022-04-25 18:52:00 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./fairseq_checkpoints/mnli/5_7e-6_4/checkpoint_2_7000.pt (epoch 2 @ 7000 updates, score 0.7109) (writing took 21.929612912237644 seconds)
2022-04-25 18:52:10 - progress_bar.py[line:272] - INFO: epoch 002:    898 / 6136 loss=1.72, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=2.2, ups=0.03, wpb=64, bsz=64, num_updates=7010, lr=5.74515e-06, gnorm=3.519, loss_scale=0.001, train_wall=9, gb_free=13.8, wall=24347
2022-04-25 18:52:18 - progress_bar.py[line:272] - INFO: epoch 002:    908 / 6136 loss=1.696, loss_v1=0, loss_v2=0, nll_loss=0.695, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=75.5, ups=1.18, wpb=64, bsz=64, num_updates=7020, lr=5.74272e-06, gnorm=3.333, loss_scale=0.001, train_wall=8, gb_free=12.6, wall=24356
2022-04-25 18:52:27 - progress_bar.py[line:272] - INFO: epoch 002:    918 / 6136 loss=1.734, loss_v1=0, loss_v2=0, nll_loss=0.732, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=7030, lr=5.74029e-06, gnorm=3.46, loss_scale=0.001, train_wall=8, gb_free=13.9, wall=24364
2022-04-25 18:52:35 - progress_bar.py[line:272] - INFO: epoch 002:    928 / 6136 loss=1.723, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=73.7, ups=1.15, wpb=64, bsz=64, num_updates=7040, lr=5.73786e-06, gnorm=3.477, loss_scale=0.001, train_wall=9, gb_free=14.1, wall=24373
2022-04-25 18:52:44 - progress_bar.py[line:272] - INFO: epoch 002:    938 / 6136 loss=1.736, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=79.3, ups=1.24, wpb=64, bsz=64, num_updates=7050, lr=5.73544e-06, gnorm=3.614, loss_scale=0.001, train_wall=8, gb_free=13.1, wall=24381
2022-04-25 18:52:52 - progress_bar.py[line:272] - INFO: epoch 002:    948 / 6136 loss=1.755, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=7060, lr=5.73301e-06, gnorm=3.573, loss_scale=0.001, train_wall=8, gb_free=9.7, wall=24389
2022-04-25 18:53:00 - progress_bar.py[line:272] - INFO: epoch 002:    958 / 6136 loss=1.696, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=7070, lr=5.73058e-06, gnorm=3.618, loss_scale=0.001, train_wall=8, gb_free=13.7, wall=24398
2022-04-25 18:53:09 - progress_bar.py[line:272] - INFO: epoch 002:    968 / 6136 loss=1.688, loss_v1=0, loss_v2=0, nll_loss=0.686, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.61, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=7080, lr=5.72816e-06, gnorm=3.074, loss_scale=0.001, train_wall=8, gb_free=13.5, wall=24406
2022-04-25 18:53:18 - progress_bar.py[line:272] - INFO: epoch 002:    978 / 6136 loss=1.673, loss_v1=0, loss_v2=0, nll_loss=0.671, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.59, wps=72.7, ups=1.14, wpb=64, bsz=64, num_updates=7090, lr=5.72573e-06, gnorm=3.12, loss_scale=0.001, train_wall=9, gb_free=12.8, wall=24415
2022-04-25 18:53:26 - progress_bar.py[line:272] - INFO: epoch 002:    988 / 6136 loss=1.762, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=7100, lr=5.7233e-06, gnorm=3.497, loss_scale=0.001, train_wall=8, gb_free=12, wall=24424
2022-04-25 18:53:26 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 18:57:41 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.672 | loss_v1 0 | loss_v2 0 | nll_loss 0.669 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.59 | acc 0.7174 | wps 77 | wpb 16 | bsz 16 | num_updates 7100 | best_acc 0.7174
2022-04-25 18:57:50 - progress_bar.py[line:272] - INFO: epoch 002:    998 / 6136 loss=1.713, loss_v1=0, loss_v2=0, nll_loss=0.711, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=7110, lr=5.72087e-06, gnorm=3.624, loss_scale=0.001, train_wall=9, gb_free=14, wall=24688
2022-04-25 18:57:58 - progress_bar.py[line:272] - INFO: epoch 002:   1008 / 6136 loss=1.759, loss_v1=0, loss_v2=0, nll_loss=0.757, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=78.4, ups=1.22, wpb=64, bsz=64, num_updates=7120, lr=5.71845e-06, gnorm=3.375, loss_scale=0.001, train_wall=8, gb_free=13.1, wall=24696
2022-04-25 18:58:07 - progress_bar.py[line:272] - INFO: epoch 002:   1018 / 6136 loss=1.741, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=75.1, ups=1.17, wpb=64, bsz=64, num_updates=7130, lr=5.71602e-06, gnorm=3.422, loss_scale=0.001, train_wall=8, gb_free=14.1, wall=24704
2022-04-25 18:58:15 - progress_bar.py[line:272] - INFO: epoch 002:   1028 / 6136 loss=1.758, loss_v1=0, loss_v2=0, nll_loss=0.756, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=76.8, ups=1.2, wpb=64, bsz=64, num_updates=7140, lr=5.71359e-06, gnorm=3.475, loss_scale=0.001, train_wall=8, gb_free=13.2, wall=24713
2022-04-25 18:58:24 - progress_bar.py[line:272] - INFO: epoch 002:   1038 / 6136 loss=1.733, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=76.9, ups=1.2, wpb=64, bsz=64, num_updates=7150, lr=5.71117e-06, gnorm=3.271, loss_scale=0.001, train_wall=8, gb_free=13.7, wall=24721
2022-04-25 18:58:32 - progress_bar.py[line:272] - INFO: epoch 002:   1048 / 6136 loss=1.711, loss_v1=0, loss_v2=0, nll_loss=0.709, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=72.2, ups=1.13, wpb=64, bsz=64, num_updates=7160, lr=5.70874e-06, gnorm=3.309, loss_scale=0.001, train_wall=9, gb_free=13.6, wall=24730
2022-04-25 18:58:41 - progress_bar.py[line:272] - INFO: epoch 002:   1058 / 6136 loss=1.732, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.4, ups=1.21, wpb=64, bsz=64, num_updates=7170, lr=5.70631e-06, gnorm=3.314, loss_scale=0.001, train_wall=8, gb_free=13, wall=24738
2022-04-25 18:58:50 - progress_bar.py[line:272] - INFO: epoch 002:   1068 / 6136 loss=1.743, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=72.4, ups=1.13, wpb=64, bsz=64, num_updates=7180, lr=5.70388e-06, gnorm=3.026, loss_scale=0.001, train_wall=9, gb_free=13.2, wall=24747
2022-04-25 18:58:58 - progress_bar.py[line:272] - INFO: epoch 002:   1078 / 6136 loss=1.704, loss_v1=0, loss_v2=0, nll_loss=0.703, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=76.5, ups=1.19, wpb=64, bsz=64, num_updates=7190, lr=5.70146e-06, gnorm=2.919, loss_scale=0.001, train_wall=8, gb_free=13.7, wall=24755
2022-04-25 18:59:00 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.00048828125
2022-04-25 18:59:07 - progress_bar.py[line:272] - INFO: epoch 002:   1089 / 6136 loss=1.744, loss_v1=0, loss_v2=0, nll_loss=0.742, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=70.4, ups=1.1, wpb=64, bsz=64, num_updates=7200, lr=5.69903e-06, gnorm=3.12, loss_scale=0.0005, train_wall=9, gb_free=12.9, wall=24765
2022-04-25 18:59:07 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:03:14 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.678 | loss_v1 0 | loss_v2 0 | nll_loss 0.676 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.6 | acc 0.7148 | wps 79.5 | wpb 16 | bsz 16 | num_updates 7200 | best_acc 0.7148
2022-04-25 19:03:23 - progress_bar.py[line:272] - INFO: epoch 002:   1099 / 6136 loss=1.732, loss_v1=0, loss_v2=0, nll_loss=0.73, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=7210, lr=5.6966e-06, gnorm=3, loss_scale=0.0005, train_wall=8, gb_free=12.6, wall=25020
2022-04-25 19:03:31 - progress_bar.py[line:272] - INFO: epoch 002:   1109 / 6136 loss=1.695, loss_v1=0, loss_v2=0, nll_loss=0.693, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=75.4, ups=1.18, wpb=64, bsz=64, num_updates=7220, lr=5.69417e-06, gnorm=2.97, loss_scale=0.0005, train_wall=8, gb_free=10.6, wall=25029
2022-04-25 19:03:39 - progress_bar.py[line:272] - INFO: epoch 002:   1119 / 6136 loss=1.73, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=78.7, ups=1.23, wpb=64, bsz=64, num_updates=7230, lr=5.69175e-06, gnorm=3.12, loss_scale=0.0005, train_wall=8, gb_free=13.9, wall=25037
2022-04-25 19:03:48 - progress_bar.py[line:272] - INFO: epoch 002:   1129 / 6136 loss=1.746, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=7240, lr=5.68932e-06, gnorm=3.118, loss_scale=0.0005, train_wall=8, gb_free=12, wall=25045
2022-04-25 19:03:56 - progress_bar.py[line:272] - INFO: epoch 002:   1139 / 6136 loss=1.711, loss_v1=0, loss_v2=0, nll_loss=0.709, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=78.9, ups=1.23, wpb=64, bsz=64, num_updates=7250, lr=5.68689e-06, gnorm=3.012, loss_scale=0.0005, train_wall=8, gb_free=13.2, wall=25053
2022-04-25 19:04:04 - progress_bar.py[line:272] - INFO: epoch 002:   1149 / 6136 loss=1.688, loss_v1=0, loss_v2=0, nll_loss=0.687, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.61, wps=79.1, ups=1.24, wpb=64, bsz=64, num_updates=7260, lr=5.68447e-06, gnorm=2.827, loss_scale=0.0005, train_wall=8, gb_free=14, wall=25061
2022-04-25 19:04:12 - progress_bar.py[line:272] - INFO: epoch 002:   1159 / 6136 loss=1.708, loss_v1=0, loss_v2=0, nll_loss=0.706, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=79.6, ups=1.24, wpb=64, bsz=64, num_updates=7270, lr=5.68204e-06, gnorm=2.976, loss_scale=0.0005, train_wall=8, gb_free=13.7, wall=25069
2022-04-25 19:04:20 - progress_bar.py[line:272] - INFO: epoch 002:   1169 / 6136 loss=1.703, loss_v1=0, loss_v2=0, nll_loss=0.701, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=7280, lr=5.67961e-06, gnorm=2.897, loss_scale=0.0005, train_wall=8, gb_free=12, wall=25078
2022-04-25 19:04:29 - progress_bar.py[line:272] - INFO: epoch 002:   1179 / 6136 loss=1.782, loss_v1=0, loss_v2=0, nll_loss=0.78, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=76.4, ups=1.19, wpb=64, bsz=64, num_updates=7290, lr=5.67718e-06, gnorm=3.829, loss_scale=0.0005, train_wall=8, gb_free=6.8, wall=25086
2022-04-25 19:04:37 - progress_bar.py[line:272] - INFO: epoch 002:   1189 / 6136 loss=1.689, loss_v1=0, loss_v2=0, nll_loss=0.688, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.61, wps=76.3, ups=1.19, wpb=64, bsz=64, num_updates=7300, lr=5.67476e-06, gnorm=3.194, loss_scale=0.0005, train_wall=8, gb_free=13.4, wall=25094
2022-04-25 19:04:37 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:08:49 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.67 | loss_v1 0 | loss_v2 0 | nll_loss 0.668 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.59 | acc 0.7175 | wps 78.1 | wpb 16 | bsz 16 | num_updates 7300 | best_acc 0.7175
2022-04-25 19:08:51 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.000244140625
2022-04-25 19:08:58 - progress_bar.py[line:272] - INFO: epoch 002:   1200 / 6136 loss=1.731, loss_v1=0, loss_v2=0, nll_loss=0.729, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=2.4, ups=0.04, wpb=64, bsz=64, num_updates=7310, lr=5.67233e-06, gnorm=3.202, loss_scale=0.0002, train_wall=9, gb_free=14.1, wall=25356
2022-04-25 19:09:07 - progress_bar.py[line:272] - INFO: epoch 002:   1210 / 6136 loss=1.721, loss_v1=0, loss_v2=0, nll_loss=0.72, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=7320, lr=5.6699e-06, gnorm=3.367, loss_scale=0.0002, train_wall=8, gb_free=13.5, wall=25364
2022-04-25 19:09:15 - progress_bar.py[line:272] - INFO: epoch 002:   1220 / 6136 loss=1.668, loss_v1=0, loss_v2=0, nll_loss=0.666, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.59, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=7330, lr=5.66748e-06, gnorm=2.939, loss_scale=0.0002, train_wall=8, gb_free=13.9, wall=25372
2022-04-25 19:09:23 - progress_bar.py[line:272] - INFO: epoch 002:   1230 / 6136 loss=1.711, loss_v1=0, loss_v2=0, nll_loss=0.71, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=7340, lr=5.66505e-06, gnorm=3.08, loss_scale=0.0002, train_wall=8, gb_free=13.3, wall=25381
2022-04-25 19:09:32 - progress_bar.py[line:272] - INFO: epoch 002:   1240 / 6136 loss=1.693, loss_v1=0, loss_v2=0, nll_loss=0.691, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.61, wps=76.7, ups=1.2, wpb=64, bsz=64, num_updates=7350, lr=5.66262e-06, gnorm=3.076, loss_scale=0.0002, train_wall=8, gb_free=13.6, wall=25389
2022-04-25 19:09:40 - progress_bar.py[line:272] - INFO: epoch 002:   1250 / 6136 loss=1.7, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=74.9, ups=1.17, wpb=64, bsz=64, num_updates=7360, lr=5.66019e-06, gnorm=3.108, loss_scale=0.0002, train_wall=8, gb_free=13.7, wall=25398
2022-04-25 19:09:48 - progress_bar.py[line:272] - INFO: epoch 002:   1260 / 6136 loss=1.763, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=77.8, ups=1.22, wpb=64, bsz=64, num_updates=7370, lr=5.65777e-06, gnorm=3.239, loss_scale=0.0002, train_wall=8, gb_free=13, wall=25406
2022-04-25 19:09:56 - progress_bar.py[line:272] - INFO: epoch 002:   1270 / 6136 loss=1.702, loss_v1=0, loss_v2=0, nll_loss=0.7, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=80.2, ups=1.25, wpb=64, bsz=64, num_updates=7380, lr=5.65534e-06, gnorm=3.188, loss_scale=0.0002, train_wall=8, gb_free=13.7, wall=25414
2022-04-25 19:10:05 - progress_bar.py[line:272] - INFO: epoch 002:   1280 / 6136 loss=1.777, loss_v1=0, loss_v2=0, nll_loss=0.775, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=78.6, ups=1.23, wpb=64, bsz=64, num_updates=7390, lr=5.65291e-06, gnorm=3.306, loss_scale=0.0002, train_wall=8, gb_free=13.4, wall=25422
2022-04-25 19:10:13 - progress_bar.py[line:272] - INFO: epoch 002:   1290 / 6136 loss=1.723, loss_v1=0, loss_v2=0, nll_loss=0.721, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=7400, lr=5.65049e-06, gnorm=3.168, loss_scale=0.0002, train_wall=8, gb_free=13.6, wall=25430
2022-04-25 19:10:13 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:14:16 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.692 | loss_v1 0 | loss_v2 0 | nll_loss 0.689 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.61 | acc 0.7097 | wps 80.8 | wpb 16 | bsz 16 | num_updates 7400 | best_acc 0.7118
2022-04-25 19:14:25 - progress_bar.py[line:272] - INFO: epoch 002:   1300 / 6136 loss=1.768, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=7410, lr=5.64806e-06, gnorm=3.19, loss_scale=0.0002, train_wall=9, gb_free=13.7, wall=25683
2022-04-25 19:14:34 - progress_bar.py[line:272] - INFO: epoch 002:   1310 / 6136 loss=1.716, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=74.9, ups=1.17, wpb=64, bsz=64, num_updates=7420, lr=5.64563e-06, gnorm=2.661, loss_scale=0.0002, train_wall=8, gb_free=13.8, wall=25691
2022-04-25 19:14:42 - progress_bar.py[line:272] - INFO: epoch 002:   1320 / 6136 loss=1.698, loss_v1=0, loss_v2=0, nll_loss=0.696, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=77.6, ups=1.21, wpb=64, bsz=64, num_updates=7430, lr=5.6432e-06, gnorm=2.613, loss_scale=0.0002, train_wall=8, gb_free=14.1, wall=25700
2022-04-25 19:14:50 - progress_bar.py[line:272] - INFO: epoch 002:   1330 / 6136 loss=1.729, loss_v1=0, loss_v2=0, nll_loss=0.727, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=7440, lr=5.64078e-06, gnorm=3.359, loss_scale=0.0002, train_wall=8, gb_free=13.9, wall=25708
2022-04-25 19:14:58 - progress_bar.py[line:272] - INFO: epoch 002:   1340 / 6136 loss=1.745, loss_v1=0, loss_v2=0, nll_loss=0.744, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=78.8, ups=1.23, wpb=64, bsz=64, num_updates=7450, lr=5.63835e-06, gnorm=4.164, loss_scale=0.0002, train_wall=8, gb_free=13.3, wall=25716
2022-04-25 19:15:07 - progress_bar.py[line:272] - INFO: epoch 002:   1350 / 6136 loss=1.724, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=7460, lr=5.63592e-06, gnorm=3.208, loss_scale=0.0002, train_wall=8, gb_free=13.6, wall=25724
2022-04-25 19:15:15 - progress_bar.py[line:272] - INFO: epoch 002:   1360 / 6136 loss=1.782, loss_v1=0, loss_v2=0, nll_loss=0.781, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.72, wps=74.5, ups=1.16, wpb=64, bsz=64, num_updates=7470, lr=5.6335e-06, gnorm=3.523, loss_scale=0.0002, train_wall=9, gb_free=10.7, wall=25733
2022-04-25 19:15:24 - progress_bar.py[line:272] - INFO: epoch 002:   1370 / 6136 loss=1.747, loss_v1=0, loss_v2=0, nll_loss=0.745, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=73.9, ups=1.15, wpb=64, bsz=64, num_updates=7480, lr=5.63107e-06, gnorm=3.501, loss_scale=0.0002, train_wall=9, gb_free=13.3, wall=25741
2022-04-25 19:15:32 - progress_bar.py[line:272] - INFO: epoch 002:   1380 / 6136 loss=1.7, loss_v1=0, loss_v2=0, nll_loss=0.698, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=74.7, ups=1.17, wpb=64, bsz=64, num_updates=7490, lr=5.62864e-06, gnorm=2.943, loss_scale=0.0002, train_wall=9, gb_free=13.7, wall=25750
2022-04-25 19:15:41 - progress_bar.py[line:272] - INFO: epoch 002:   1390 / 6136 loss=1.735, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=73.7, ups=1.15, wpb=64, bsz=64, num_updates=7500, lr=5.62621e-06, gnorm=3.413, loss_scale=0.0002, train_wall=9, gb_free=13.3, wall=25759
2022-04-25 19:15:41 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:19:42 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.688 | loss_v1 0 | loss_v2 0 | nll_loss 0.685 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.61 | acc 0.7116 | wps 81.8 | wpb 16 | bsz 16 | num_updates 7500 | best_acc 0.7118
2022-04-25 19:19:50 - progress_bar.py[line:272] - INFO: epoch 002:   1400 / 6136 loss=1.696, loss_v1=0, loss_v2=0, nll_loss=0.695, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=7510, lr=5.62379e-06, gnorm=2.988, loss_scale=0.0002, train_wall=8, gb_free=13.5, wall=26008
2022-04-25 19:19:58 - progress_bar.py[line:272] - INFO: epoch 002:   1410 / 6136 loss=1.747, loss_v1=0, loss_v2=0, nll_loss=0.746, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=78.8, ups=1.23, wpb=64, bsz=64, num_updates=7520, lr=5.62136e-06, gnorm=3.496, loss_scale=0.0002, train_wall=8, gb_free=13.8, wall=26016
2022-04-25 19:20:06 - progress_bar.py[line:272] - INFO: epoch 002:   1420 / 6136 loss=1.762, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=79.4, ups=1.24, wpb=64, bsz=64, num_updates=7530, lr=5.61893e-06, gnorm=3.226, loss_scale=0.0002, train_wall=8, gb_free=13.5, wall=26024
2022-04-25 19:20:14 - progress_bar.py[line:272] - INFO: epoch 002:   1430 / 6136 loss=1.734, loss_v1=0, loss_v2=0, nll_loss=0.733, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=79.5, ups=1.24, wpb=64, bsz=64, num_updates=7540, lr=5.6165e-06, gnorm=3.019, loss_scale=0.0002, train_wall=8, gb_free=13.5, wall=26032
2022-04-25 19:20:22 - progress_bar.py[line:272] - INFO: epoch 002:   1440 / 6136 loss=1.702, loss_v1=0, loss_v2=0, nll_loss=0.701, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=78.5, ups=1.23, wpb=64, bsz=64, num_updates=7550, lr=5.61408e-06, gnorm=3.332, loss_scale=0.0002, train_wall=8, gb_free=12.7, wall=26040
2022-04-25 19:20:31 - progress_bar.py[line:272] - INFO: epoch 002:   1450 / 6136 loss=1.755, loss_v1=0, loss_v2=0, nll_loss=0.753, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=77.2, ups=1.21, wpb=64, bsz=64, num_updates=7560, lr=5.61165e-06, gnorm=3.175, loss_scale=0.0002, train_wall=8, gb_free=13.5, wall=26048
2022-04-25 19:20:39 - progress_bar.py[line:272] - INFO: epoch 002:   1460 / 6136 loss=1.721, loss_v1=0, loss_v2=0, nll_loss=0.72, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=74.9, ups=1.17, wpb=64, bsz=64, num_updates=7570, lr=5.60922e-06, gnorm=2.954, loss_scale=0.0002, train_wall=8, gb_free=13.4, wall=26057
2022-04-25 19:20:48 - progress_bar.py[line:272] - INFO: epoch 002:   1470 / 6136 loss=1.748, loss_v1=0, loss_v2=0, nll_loss=0.747, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.68, wps=75, ups=1.17, wpb=64, bsz=64, num_updates=7580, lr=5.6068e-06, gnorm=3.39, loss_scale=0.0002, train_wall=8, gb_free=13.5, wall=26065
2022-04-25 19:20:56 - progress_bar.py[line:272] - INFO: epoch 002:   1480 / 6136 loss=1.694, loss_v1=0, loss_v2=0, nll_loss=0.692, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=7590, lr=5.60437e-06, gnorm=3.188, loss_scale=0.0002, train_wall=8, gb_free=13.8, wall=26074
2022-04-25 19:21:05 - progress_bar.py[line:272] - INFO: epoch 002:   1490 / 6136 loss=1.724, loss_v1=0, loss_v2=0, nll_loss=0.723, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=73.4, ups=1.15, wpb=64, bsz=64, num_updates=7600, lr=5.60194e-06, gnorm=2.985, loss_scale=0.0002, train_wall=9, gb_free=13.6, wall=26082
2022-04-25 19:21:05 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:25:16 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7159 | wps 78.3 | wpb 16 | bsz 16 | num_updates 7600 | best_acc 0.7159
2022-04-25 19:25:25 - progress_bar.py[line:272] - INFO: epoch 002:   1500 / 6136 loss=1.716, loss_v1=0, loss_v2=0, nll_loss=0.714, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=7610, lr=5.59951e-06, gnorm=3.118, loss_scale=0.0002, train_wall=9, gb_free=13.7, wall=26342
2022-04-25 19:25:33 - progress_bar.py[line:272] - INFO: epoch 002:   1510 / 6136 loss=1.77, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=76.7, ups=1.2, wpb=64, bsz=64, num_updates=7620, lr=5.59709e-06, gnorm=2.976, loss_scale=0.0002, train_wall=8, gb_free=13.9, wall=26351
2022-04-25 19:25:42 - progress_bar.py[line:272] - INFO: epoch 002:   1520 / 6136 loss=1.756, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=73.3, ups=1.15, wpb=64, bsz=64, num_updates=7630, lr=5.59466e-06, gnorm=3.442, loss_scale=0.0002, train_wall=9, gb_free=13, wall=26359
2022-04-25 19:25:50 - progress_bar.py[line:272] - INFO: epoch 002:   1530 / 6136 loss=1.711, loss_v1=0, loss_v2=0, nll_loss=0.71, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=75.6, ups=1.18, wpb=64, bsz=64, num_updates=7640, lr=5.59223e-06, gnorm=2.982, loss_scale=0.0002, train_wall=8, gb_free=13.5, wall=26368
2022-04-25 19:25:59 - progress_bar.py[line:272] - INFO: epoch 002:   1540 / 6136 loss=1.741, loss_v1=0, loss_v2=0, nll_loss=0.739, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=77.9, ups=1.22, wpb=64, bsz=64, num_updates=7650, lr=5.58981e-06, gnorm=3.125, loss_scale=0.0002, train_wall=8, gb_free=14.3, wall=26376
2022-04-25 19:26:07 - progress_bar.py[line:272] - INFO: epoch 002:   1550 / 6136 loss=1.704, loss_v1=0, loss_v2=0, nll_loss=0.703, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=77.7, ups=1.21, wpb=64, bsz=64, num_updates=7660, lr=5.58738e-06, gnorm=2.783, loss_scale=0.0002, train_wall=8, gb_free=13.5, wall=26384
2022-04-25 19:26:15 - progress_bar.py[line:272] - INFO: epoch 002:   1560 / 6136 loss=1.704, loss_v1=0, loss_v2=0, nll_loss=0.703, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=77.1, ups=1.21, wpb=64, bsz=64, num_updates=7670, lr=5.58495e-06, gnorm=2.913, loss_scale=0.0002, train_wall=8, gb_free=11, wall=26393
2022-04-25 19:26:23 - progress_bar.py[line:272] - INFO: epoch 002:   1570 / 6136 loss=1.768, loss_v1=0, loss_v2=0, nll_loss=0.766, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=77.4, ups=1.21, wpb=64, bsz=64, num_updates=7680, lr=5.58252e-06, gnorm=3.188, loss_scale=0.0002, train_wall=8, gb_free=12.4, wall=26401
2022-04-25 19:26:32 - progress_bar.py[line:272] - INFO: epoch 002:   1580 / 6136 loss=1.707, loss_v1=0, loss_v2=0, nll_loss=0.705, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=76.1, ups=1.19, wpb=64, bsz=64, num_updates=7690, lr=5.5801e-06, gnorm=3.147, loss_scale=0.0002, train_wall=8, gb_free=8.1, wall=26409
2022-04-25 19:26:33 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.0001220703125
2022-04-25 19:26:41 - progress_bar.py[line:272] - INFO: epoch 002:   1591 / 6136 loss=1.7, loss_v1=0, loss_v2=0, nll_loss=0.699, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=69.9, ups=1.09, wpb=64, bsz=64, num_updates=7700, lr=5.57767e-06, gnorm=2.805, loss_scale=0.0001, train_wall=9, gb_free=13.8, wall=26419
2022-04-25 19:26:41 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:30:42 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss nan | loss_v1 0 | loss_v2 0 | nll_loss nan | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl nan | acc 0.7124 | wps 81.6 | wpb 16 | bsz 16 | num_updates 7700 | best_acc 0.7124
2022-04-25 19:30:51 - progress_bar.py[line:272] - INFO: epoch 002:   1601 / 6136 loss=1.769, loss_v1=0, loss_v2=0, nll_loss=0.768, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=2.6, ups=0.04, wpb=64, bsz=64, num_updates=7710, lr=5.57524e-06, gnorm=3.174, loss_scale=0.0001, train_wall=8, gb_free=12.8, wall=26668
2022-04-25 19:30:59 - progress_bar.py[line:272] - INFO: epoch 002:   1611 / 6136 loss=1.723, loss_v1=0, loss_v2=0, nll_loss=0.722, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=74.4, ups=1.16, wpb=64, bsz=64, num_updates=7720, lr=5.57282e-06, gnorm=2.853, loss_scale=0.0001, train_wall=9, gb_free=13.3, wall=26677
2022-04-25 19:31:07 - progress_bar.py[line:272] - INFO: epoch 002:   1621 / 6136 loss=1.74, loss_v1=0, loss_v2=0, nll_loss=0.738, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=77.1, ups=1.2, wpb=64, bsz=64, num_updates=7730, lr=5.57039e-06, gnorm=2.888, loss_scale=0.0001, train_wall=8, gb_free=14, wall=26685
2022-04-25 19:31:16 - progress_bar.py[line:272] - INFO: epoch 002:   1631 / 6136 loss=1.739, loss_v1=0, loss_v2=0, nll_loss=0.737, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.67, wps=76.2, ups=1.19, wpb=64, bsz=64, num_updates=7740, lr=5.56796e-06, gnorm=2.692, loss_scale=0.0001, train_wall=8, gb_free=13, wall=26693
2022-04-25 19:31:24 - progress_bar.py[line:272] - INFO: epoch 002:   1641 / 6136 loss=1.771, loss_v1=0, loss_v2=0, nll_loss=0.769, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=75.8, ups=1.18, wpb=64, bsz=64, num_updates=7750, lr=5.56553e-06, gnorm=2.587, loss_scale=0.0001, train_wall=8, gb_free=13, wall=26702
2022-04-25 19:31:33 - progress_bar.py[line:272] - INFO: epoch 002:   1651 / 6136 loss=1.686, loss_v1=0, loss_v2=0, nll_loss=0.685, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.61, wps=75.2, ups=1.17, wpb=64, bsz=64, num_updates=7760, lr=5.56311e-06, gnorm=2.601, loss_scale=0.0001, train_wall=8, gb_free=12.2, wall=26710
2022-04-25 19:31:41 - progress_bar.py[line:272] - INFO: epoch 002:   1661 / 6136 loss=1.706, loss_v1=0, loss_v2=0, nll_loss=0.705, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.63, wps=76, ups=1.19, wpb=64, bsz=64, num_updates=7770, lr=5.56068e-06, gnorm=2.697, loss_scale=0.0001, train_wall=8, gb_free=13.3, wall=26719
2022-04-25 19:31:50 - progress_bar.py[line:272] - INFO: epoch 002:   1671 / 6136 loss=1.774, loss_v1=0, loss_v2=0, nll_loss=0.772, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=75.7, ups=1.18, wpb=64, bsz=64, num_updates=7780, lr=5.55825e-06, gnorm=3.12, loss_scale=0.0001, train_wall=8, gb_free=13.2, wall=26727
2022-04-25 19:31:58 - progress_bar.py[line:272] - INFO: epoch 002:   1681 / 6136 loss=1.792, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=76, ups=1.19, wpb=64, bsz=64, num_updates=7790, lr=5.55583e-06, gnorm=3.508, loss_scale=0.0001, train_wall=8, gb_free=14, wall=26736
2022-04-25 19:32:07 - progress_bar.py[line:272] - INFO: epoch 002:   1691 / 6136 loss=1.736, loss_v1=0, loss_v2=0, nll_loss=0.735, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=75.1, ups=1.17, wpb=64, bsz=64, num_updates=7800, lr=5.5534e-06, gnorm=3.037, loss_scale=0.0001, train_wall=8, gb_free=13, wall=26744
2022-04-25 19:32:07 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:36:12 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.678 | loss_v1 0 | loss_v2 0 | nll_loss 0.676 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.6 | acc 0.7157 | wps 80.2 | wpb 16 | bsz 16 | num_updates 7800 | best_acc 0.7157
2022-04-25 19:36:20 - progress_bar.py[line:272] - INFO: epoch 002:   1701 / 6136 loss=1.695, loss_v1=0, loss_v2=0, nll_loss=0.694, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.62, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=7810, lr=5.55097e-06, gnorm=2.871, loss_scale=0.0001, train_wall=8, gb_free=13.6, wall=26998
2022-04-25 19:36:28 - progress_bar.py[line:272] - INFO: epoch 002:   1711 / 6136 loss=1.756, loss_v1=0, loss_v2=0, nll_loss=0.755, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=78.3, ups=1.22, wpb=64, bsz=64, num_updates=7820, lr=5.54854e-06, gnorm=3.062, loss_scale=0.0001, train_wall=8, gb_free=14, wall=27006
2022-04-25 19:36:36 - progress_bar.py[line:272] - INFO: epoch 002:   1721 / 6136 loss=1.712, loss_v1=0, loss_v2=0, nll_loss=0.711, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.64, wps=80, ups=1.25, wpb=64, bsz=64, num_updates=7830, lr=5.54612e-06, gnorm=2.967, loss_scale=0.0001, train_wall=8, gb_free=14.2, wall=27014
2022-04-25 19:36:45 - progress_bar.py[line:272] - INFO: epoch 002:   1731 / 6136 loss=1.762, loss_v1=0, loss_v2=0, nll_loss=0.761, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.69, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=7840, lr=5.54369e-06, gnorm=2.796, loss_scale=0.0001, train_wall=8, gb_free=7.2, wall=27022
2022-04-25 19:36:53 - progress_bar.py[line:272] - INFO: epoch 002:   1741 / 6136 loss=1.733, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=7850, lr=5.54126e-06, gnorm=3.013, loss_scale=0.0001, train_wall=8, gb_free=13.6, wall=27030
2022-04-25 19:37:01 - progress_bar.py[line:272] - INFO: epoch 002:   1751 / 6136 loss=1.72, loss_v1=0, loss_v2=0, nll_loss=0.718, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.65, wps=77.3, ups=1.21, wpb=64, bsz=64, num_updates=7860, lr=5.53883e-06, gnorm=3.338, loss_scale=0.0001, train_wall=8, gb_free=11.5, wall=27039
2022-04-25 19:37:10 - progress_bar.py[line:272] - INFO: epoch 002:   1761 / 6136 loss=1.735, loss_v1=0, loss_v2=0, nll_loss=0.734, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=73.9, ups=1.15, wpb=64, bsz=64, num_updates=7870, lr=5.53641e-06, gnorm=2.869, loss_scale=0.0001, train_wall=9, gb_free=13.4, wall=27047
2022-04-25 19:37:18 - progress_bar.py[line:272] - INFO: epoch 002:   1771 / 6136 loss=1.772, loss_v1=0, loss_v2=0, nll_loss=0.771, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.71, wps=76.6, ups=1.2, wpb=64, bsz=64, num_updates=7880, lr=5.53398e-06, gnorm=3.039, loss_scale=0.0001, train_wall=8, gb_free=13.4, wall=27056
2022-04-25 19:37:26 - progress_bar.py[line:272] - INFO: epoch 002:   1781 / 6136 loss=1.732, loss_v1=0, loss_v2=0, nll_loss=0.731, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.66, wps=79.2, ups=1.24, wpb=64, bsz=64, num_updates=7890, lr=5.53155e-06, gnorm=2.77, loss_scale=0.0001, train_wall=8, gb_free=12.5, wall=27064
2022-04-25 19:37:34 - progress_bar.py[line:272] - INFO: epoch 002:   1791 / 6136 loss=1.763, loss_v1=0, loss_v2=0, nll_loss=0.762, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.7, wps=77.5, ups=1.21, wpb=64, bsz=64, num_updates=7900, lr=5.52913e-06, gnorm=3.111, loss_scale=0.0001, train_wall=8, gb_free=12.3, wall=27072
2022-04-25 19:37:34 - train.py[line:435] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:41 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - moe_layer.py[line:118] - WARNING: padding batch with unexpected size 15 (expected: 16)
2022-04-25 19:41:42 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 1.682 | loss_v1 0 | loss_v2 0 | nll_loss 0.68 | ntokens 15.999 | nsentences 15.999 | sample_size 15.999 | sample_size_v1 0 | sample_size_v2 0 | ppl 1.6 | acc 0.7155 | wps 79.6 | wpb 16 | bsz 16 | num_updates 7900 | best_acc 0.7155
2022-04-25 19:41:50 - progress_bar.py[line:272] - INFO: epoch 002:   1801 / 6136 loss=1.796, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.73, wps=2.5, ups=0.04, wpb=64, bsz=64, num_updates=7910, lr=5.5267e-06, gnorm=3.247, loss_scale=0.0001, train_wall=8, gb_free=13.1, wall=27327
2022-04-25 19:41:58 - progress_bar.py[line:272] - INFO: epoch 002:   1811 / 6136 loss=1.799, loss_v1=0, loss_v2=0, nll_loss=0.798, ntokens=64, nsentences=64, sample_size=64, sample_size_v1=0, sample_size_v2=0, ppl=1.74, wps=78, ups=1.22, wpb=64, bsz=64, num_updates=7920, lr=5.52427e-06, gnorm=3.946, loss_scale=0.0001, train_wall=8, gb_free=14.2, wall=27336
/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:787: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:752: UserWarning: Using non-full backward hooks on a Module that does not return a single Tensor or a tuple of Tensors is deprecated and will be removed in future versions. This hook will be missing some of the grad_output. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using non-full backward hooks on a Module that does not return a "
/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py:777: UserWarning: Using a non-full backward hook when outputs are generated by different autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_output. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when outputs are generated by different autograd Nodes "
Traceback (most recent call last):
  File "/workspace/OFA/trainer.py", line 871, in train_step
    grad_norm = self.clip_grad_norm(self.cfg.optimization.clip_norm)
  File "/workspace/OFA/trainer.py", line 1208, in clip_grad_norm
    return self.optimizer.clip_grad_norm(
  File "/workspace/OFA/fairseq/fairseq/optim/fp16_optimizer.py", line 200, in clip_grad_norm
    self.scaler.check_overflow(grad_norm)
  File "/workspace/OFA/fairseq/fairseq/optim/dynamic_loss_scaler.py", line 61, in check_overflow
    raise FloatingPointError(
FloatingPointError: Minimum loss scale reached (0.0001). Your loss is probably exploding. Try lowering the learning rate, using gradient clipping or increasing the batch size.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "../../train.py", line 527, in <module>
    cli_main()
  File "../../train.py", line 520, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/workspace/OFA/fairseq/fairseq/distributed/utils.py", line 379, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/workspace/OFA/fairseq/fairseq/distributed/utils.py", line 353, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 189, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/opt/conda/lib/python3.8/contextlib.py", line 75, in inner
    return func(*args, **kwds)
  File "../../train.py", line 300, in train
    log_output = trainer.train_step(samples)
  File "/opt/conda/lib/python3.8/contextlib.py", line 75, in inner
    return func(*args, **kwds)
  File "/workspace/OFA/trainer.py", line 910, in train_step
    self.task.train_step(
  File "/workspace/OFA/tasks/ofa_task.py", line 319, in train_step
    loss, sample_size, logging_output = criterion(model, sample, update_num=update_num)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 881, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/workspace/OFA/criterions/label_smoothed_cross_entropy.py", line 243, in forward
    net_output = model(**sample["net_input"])
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 881, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/workspace/OFA/models/ofa/ofa.py", line 89, in forward
    encoder_out = self.encoder(
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/modules/module.py", line 897, in _call_impl
    var = next((v for v in var.values() if isinstance(v, torch.Tensor)))
StopIteration
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/opt/conda/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 340, in <module>
    main()
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 326, in main
    sigkill_handler(signal.SIGTERM, None)  # not coming back
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 301, in sigkill_handler
    raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
subprocess.CalledProcessError: Command '['/opt/conda/bin/python3', '-u', '../../train.py', '--local_rank=0', '../../dataset/glue_data/mnli_train.tsv,../../dataset/glue_data/mnli_dev.tsv', '--selected-cols=0,1,2', '--bpe-dir=../../utils/BPE', '--user-dir=../../ofa_module', '--restore-file=../../checkpoints/ofa_base.pt', '--reset-optimizer', '--reset-dataloader', '--reset-meters', '--save-dir=./fairseq_checkpoints/mnli/5_7e-6_4', '--task=mnli', '--arch=ofa_resmo', '--criterion=adjust_label_smoothed_cross_entropy', '--label-smoothing=0.0', '--batch-size=16', '--update-freq=4', '--encoder-normalize-before', '--decoder-normalize-before', '--share-decoder-input-output-embed', '--share-all-embeddings', '--layernorm-embedding', '--patch-layernorm-embedding', '--code-layernorm-embedding', '--resnet-drop-path-rate=0.0', '--encoder-drop-path-rate=0.1', '--decoder-drop-path-rate=0.1', '--dropout=0.1', '--attention-dropout=0.0', '--weight-decay=0.01', '--optimizer=adam', '--adam-betas=(0.9,0.999)', '--adam-eps=1e-08', '--clip-norm=0.0', '--lr-scheduler=polynomial_decay', '--lr=7e-6', '--max-epoch=5', '--warmup-ratio=0.06', '--log-format=simple', '--log-interval=10', '--fixed-validation-seed=7', '--keep-best-checkpoints=1', '--save-interval=1000', '--validate-interval=1', '--save-interval-updates=1000', '--validate-interval-updates=100', '--best-checkpoint-metric=acc', '--maximize-best-checkpoint-metric', '--max-src-length=512', '--max-tgt-length=30', '--find-unused-parameters', '--add-type-embedding', '--scale-attn', '--scale-fc', '--scale-heads', '--disable-entangle', '--num-bins=1000', '--prompt-type=src', '--fp16', '--fp16-init-scale=16', '--fp16-scale-window=512', '--num-workers=0']' returned non-zero exit status 1.
Killing subprocess 39675
